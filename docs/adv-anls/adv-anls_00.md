# 序言

您将要踏上一段重要且值得称赞的学习旅程，这将涉及统计学、编程等。在深入之前，我想花点时间为您解释我的学习目标，我是如何来到这本书的，以及您应该期待什么。

# 学习目标

在本书结束时，您应该能够*使用编程语言进行探索性数据分析和假设检验*。探索和测试关系是分析的核心。通过本书您将掌握的工具和框架，将使您能够继续学习更高级的数据分析技术。

我们将使用 Excel、R 和 Python，因为这些工具强大且使学习过程更为顺畅。尽管许多书籍涵盖了这种组合，但从电子表格到编程的过渡对分析师（包括我自己）来说是常见的。

# 先决条件

为了实现这些目标，本书作出了一些技术和技术假设。

## 技术要求

我是在 Windows 计算机上，使用 Office 365 版本的 Excel 桌面版编写本书的。只要您在计算机上安装了付费版本的 Excel 2010 或更高版本（无论是 Windows 还是 Mac），您应该能够跟着本书的大部分指导进行学习，只有在数据透视表和数据可视化方面会有一些变化。

###### 注意

虽然 Excel 提供在线的免费和付费版本，但需要付费桌面版才能访问本书涵盖的一些功能。

R 和 Python 均为免费开源工具，适用于所有主要操作系统。本书将在后面介绍如何安装它们。

## 技术要求

本书假设您对 R 或 Python 没有任何先前知识；尽管如此，它确实依赖于对 Excel 的中等水平的了解，以便降低学习曲线。

您应该熟悉的 Excel 主题包括以下内容：

+   绝对、相对和混合单元格引用

+   条件逻辑和条件聚合（`IF()`语句、`SUMIF()`/`SUMIFS()`等）

+   合并数据源（`VLOOKUP()`、`INDEX()`/`MATCH()`等）

+   使用数据透视表对数据进行排序、筛选和汇总

+   基本绘图（条形图、折线图等）

如果您希望在继续之前对这些主题有更多练习，我建议阅读迈克尔·亚历山大等人编写的*Excel 2019 圣经*（Wiley 出版社）。

# 我的学习之路

像我们行业的许多人一样，我走向分析的道路曲折。在学校，数学成为我积极回避的科目；其中大部分似乎完全是理论的。我确实有一些统计学和计量经济学的课程引起了我的兴趣。将数学*应用*到某些具体的目标上，让我感到耳目一新。

对统计学的接触确实很少。我上的是文科学院，我掌握了扎实的写作和思维技能，但很少有数量上的技能。当我到达我的第一份全职工作时，我被委托管理的数据的深度和广度震惊了。其中许多数据存储在电子表格中，如果不经过深入的清理和准备，很难从中获得很多价值。

一些“数据整理”是可以预料的；*纽约时报* 曾报道数据科学家将 50% 到 80% 的时间[准备数据进行分析](https://oreil.ly/THah7)。但我想知道是否有更高效的方法来清理、管理和存储数据。特别是，我想这样做是为了能够花更多时间 *分析* 数据。毕竟，我总是觉得统计分析有些令人愉悦——手工操作和容易出错的电子表格数据准备则不是那么令人愉悦。

因为我喜欢写作（谢谢你，文科学位），我开始在博客上写关于我在 Excel 中学到的技巧。通过好的恩典和努力工作，博客逐渐受到关注，我将我的职业成功归功于此。欢迎访问 [*stringfestanalytics.com*](https://stringfestanalytics.com)；我仍然定期发布关于 Excel 和更广泛的分析主题的内容。

当我开始学习更多关于 Excel 的知识时，我的兴趣扩展到了其他分析工具和技术。此时，开源编程语言 R 和 Python 在数据领域获得了显著的流行。但是，尽管我在掌握这些语言的过程中感到了不必要的阻力。

# “Excel 不好，编程好”

我注意到对于 Excel 用户来说，大多数 R 或 Python 培训听起来都很像这样：

> 一直以来，你都在使用 Excel，而你真正应该学会编程。看看 Excel 带来的所有问题！是时候彻底改掉这个习惯了。

这种态度是错误的，原因有几个：

这不是准确的

编程和电子表格之间的选择通常被描述为一种善恶之间的斗争。实际上，更好的是将这些视为 *互补* 工具，而不是替代品。电子表格在分析中有其作用；编程也是如此。学习和使用一个并不排斥另一个。第五章讨论了这种关系。

这是一种糟糕的教学方法

Excel 用户直观地了解如何处理数据：他们可以对其进行排序、过滤、分组和连接。他们知道哪些排列方式便于分析，哪些意味着需要大量清理。这是一笔宝贵的知识可供借鉴。好的教学将利用它来弥合电子表格和编程之间的鸿沟。不幸的是，大多数教学却出于鄙视而焚毁了这座桥。

研究表明，将所学内容与已有知识联系起来是很有力的。正如彼得·C·布朗等人在《坚持到底：成功学习的科学》（Belknap Press）中所说的：

> 您能够解释新学习与先前知识的关系越多，您对新学习的掌握就越牢固，您创建的连接也越多，这些连接将帮助您以后记住它。

作为 Excel 用户，当你被错误地告知你已经掌握的东西是垃圾时，很难将新思想与你已经掌握的内容联系起来。这本书采取了不同的方法，建立在您对电子表格的先前知识基础上，这样在我们进入 R 和 Python 时，您将有一个清晰的框架。

###### 注意

电子表格和编程语言都是有价值的分析工具；一旦掌握了 R 和 Python，就没有必要放弃 Excel。

# Excel 的教学益处

实际上，Excel 是一个独特而绝妙的分析教学工具：

它减少了认知负担

认知负担是理解某事所需的逻辑连接或跳跃的数量。通常，分析学习之旅看起来像这样：

1.  学习全新的技术。

1.  学习如何使用全新的*编码*技术来实施全新的技术。

1.  进步到更高级的技术，而从未真正掌握基础知识。

学习分析的概念基础已经很困难了。在*同时*学习编程更是增加了极高的认知负担。基于我将要讨论的原因，通过编码进行分析练习确实具有很大的优点。但更好的方法是在掌握它们的同时隔离这些技能集。

这是一个视觉计算器

第一款大众市场上的电子表格软件被称为 VisiCalc——字面上是视觉计算器。这个名字指向了该应用程序最重要的卖点之一。特别是对于初学者来说，编程语言可能类似于“黑匣子”——输入魔术词，点击“运行”，咔嚓：结果出来了。程序很可能做对了，但对于新手来说，可能很难打开引擎盖看看是为什么（或者更为关键的是，为什么没有）。

相比之下，Excel 允许您在每一个步骤中观察分析的形成。它允许您进行可视化的计算和重新计算。与仅仅相信我的（或编程语言的）话不同，您将在 Excel 中构建演示来可视化关键的分析概念。

###### 注意

Excel 提供了学习数据分析基础的机会，而无需同时学习新的编程语言。这极大地减少了认知负担。

# 书籍概述

现在您已经理解了本书的精神和我希望您能够实现的目标，让我们来回顾一下它的结构。

第一部分，*Excel 中的分析基础*

分析建立在统计学基础之上。在这一部分中，您将学习如何使用 Excel 探索和测试变量之间的关系。您还将使用 Excel 构建一些最重要的统计和分析概念的引人注目的演示。这种统计理论的基础和分析框架将为您在数据编程中打下坚实的基础。

第二部分，*从 Excel 到 R*

现在你已经熟悉了数据分析的基础知识，是时候学习一两种编程语言了。我们将从 R 语言开始，这是一种专门用于统计分析的开源语言。你将学会如何将在 Excel 中处理数据的技能清晰地转移到 R 中。本节以 R 语言进行了一个端到端的封顶练习。

第三部分，*从 Excel 到 Python*

Python 是另一种值得学习的开源语言，用于分析。与第二部分相同的精神，你将学习如何将你的 Excel 数据技能转移到这种语言，并进行完整的数据分析。

# 章节末尾的练习

当我阅读书籍时，我倾向于跳过章节末尾的练习，因为我认为保持阅读的动力更有价值。*不要像我这样做！*

大多数章节末尾都提供了练习的机会。你可以在配套资源库的[*exercise-solutions*文件夹](https://oreil.ly/KVrIn)中找到这些练习的解答，每个章节的文件名即为对应的解答。完成这些练习，然后将你的答案与解答进行比较。这样做不仅会增加你对材料的理解，同时也为我提供了一个很好的示例。

###### 提示

最好是积极地学习；如果不立即将所读之物付诸实践，你很可能会忘记它。

# 这不是一个枯燥的清单

我喜欢分析的一点是几乎总会有多种方法来做同一件事情。当你熟悉另一种方法时，我可能会演示如何以一种方式做某事。

本书的重点是将 Excel 作为教学工具来进行分析，并帮助读者将这些知识转移到 R 和 Python 上。如果我让书籍成为给定数据清理或分析任务的大脑转储，那么它将失去围绕特定目标的焦点。

你可能更喜欢用另一种方式做某事；我甚至可能同意在不同情况下有更好的方法。然而，考虑到*本书*及其目标的情况，我决定覆盖某些技术并排除其他技术。否则，书籍可能会失去其针对性的指导，变成一本枯燥的操作手册。

# 不要惊慌

作为作者，我希望你觉得我很随和易接近。然而，对于这本书，我有一个规则：*不要惊慌！* 这里确实存在一个陡峭的学习曲线，因为你将不仅探索概率和统计，还将学习*两种*编程语言。本书将向你介绍统计学、计算机科学等概念。它们可能最初会让人感到不适，但随着时间的推移，你会逐渐内化它们。允许自己通过试错来学习。

我深信，凭借你对 Excel 的了解，这是一个可以实现的目标。可能会有挫折和冒名顶替的时刻；这种情况发生在我们每个人身上。不要让这些时刻掩盖你在这里取得的真正进步。

你准备好了吗？我会在第一章中见到你。

# 本书中使用的约定

本书中使用以下排版约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名、文件扩展名和数据集变量。

`等宽字体`

用于程序清单，以及在段落中用于引用程序元素，如代码变量或函数名称、数据库、数据类型、环境变量、语句和关键字。

###### 提示

此元素表示提示或建议。

###### 注

此元素表示一般说明。

###### 警告

此元素表示警告或注意。

# 使用代码示例

补充材料（代码示例、练习等）可在[*https://github.com/stringfestdata/advancing-into-analytics-book*](https://github.com/stringfestdata/advancing-into-analytics-book)下载。

您可以在计算机上下载并解压缩文件夹的副本，或者如果您熟悉 GitHub，可以克隆它。此存储库包含主文件夹中每个章节的脚本和工作簿的完成副本。需要跟随本书的所有数据集都位于*datasets*文件夹的一个单独子文件夹中，并附有有关其来源和获取和清理步骤的说明。建议您不要直接操作任何这些 Excel 工作簿，而是制作副本，因为操作源文件可能会影响后续步骤。章节结束的练习的所有解决方案都可以在*exercise-solutions*文件夹中找到。

如果您有技术问题或使用代码示例时遇到问题，请发送电子邮件至*bookquestions@oreilly.com*。

本书旨在帮助您完成工作。通常情况下，如果本书提供了示例代码，您可以在自己的程序和文档中使用它。除非您复制了代码的大部分内容，否则无需征得我们的许可。例如，编写一个使用本书中几个代码块的程序不需要许可。销售或分发 O'Reilly 图书中的示例代码需要许可。通过引用本书并引用示例代码来回答问题不需要许可。将本书中大量示例代码纳入产品文档需要许可。

我们感激，但通常不要求署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*进阶分析*，作者乔治·蒙特（O’Reilly）。版权所有 2021 乔治·蒙特，978-1-492-09434-0。”

如果您认为您对代码示例的使用超出了公平使用范围或上述许可，请随时与我们联系 *permissions@oreilly.com*。

# O’Reilly 在线学习

###### 注意

40 多年来，[*O’Reilly Media*](http://oreilly.com) 提供技术和商业培训、知识和见解，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专长。O’Reilly 的在线学习平台为您提供按需访问现场培训课程、深入学习路径、交互式编码环境以及来自 O’Reilly 和其他 200 多家出版商的大量文本和视频。有关更多信息，请访问 [*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

有关本书的评论和问题，请联系出版商：

+   O’Reilly Media，Inc.

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938（美国或加拿大）

+   707-829-0515（国际或当地）

+   707-829-0104（传真）

我们为这本书创建了一个网页，列出了勘误、示例和任何额外信息。您可以访问 [*https://oreil.ly/advancing-into-analytics*](https://oreil.ly/advancing-into-analytics)。

发送电子邮件至 *bookquestions@oreilly.com* 对本书进行评论或提出技术问题。

有关我们的书籍和课程的新闻和信息，请访问 [*http://oreilly.com*](http://oreilly.com)。

在 Facebook 上找到我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)。

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)。

在 YouTube 上观看我们：[*http://www.youtube.com/oreillymedia*](http://www.youtube.com/oreillymedia)。

# 致谢

首先，我要感谢上帝给了我这个机会培养和分享我的才能。在 O’Reilly，Michelle Smith 和 Jon Hassell 合作愉快，他们给我写书的邀请让我永远感激不尽。Corbin Collins 在书的编写过程中给予了我很大的支持。Danny Elfanbaum 和制作团队将原始手稿变成了一本真正的书。Aiden Johnson、Felix Zumstein 和 Jordan Goldmeier 提供了宝贵的技术审查。

让人们审阅一本书并不容易，所以我必须感谢 John Dennis、Tobias Zwingmann、Joe Balog、Barry Lilly、Nicole LaGuerre 和 Alex Bodle 的评论。我还要感谢那些使这项技术和知识可用的社区，他们通常没有直接的报酬。通过我的分析追求，我结交了一些了不起的朋友，他们非常愿意分享他们的时间和智慧。我在 Padua Franciscan High School 和 Hillsdale College 的教育者让我爱上了学习和写作。如果没有他们的影响，我怀疑我会写书。

我还要感谢我的母亲和父亲，他们给予我无比珍贵的爱和支持。最后，向我已故的爷爷致敬：感谢您与我分享了勤奋工作和正直的价值观。
