# 附录 D. R 中的矩阵代数

本书描述的许多函数都作用于矩阵。矩阵操作深深植根于 R 语言中。表 D.1 描述了特别重要的运算符和函数，用于解决线性代数问题。在表中，`A` 和 `B` 是矩阵，`x` 和 `b` 是向量，`k` 是标量。

表 D.1 矩阵代数函数和运算符

| 运算符或函数 | 描述 |
| --- | --- |
| `+ - * / ^` | 分别为逐元素加法、减法、乘法、除法和指数运算 |
| `A %*% B` | 矩阵乘法 |
| `A %o% B` | 外积：`AB'` |
| `cbind(A, B, ...)` | 水平组合矩阵或向量。返回一个矩阵。 |
| `chol(A)` | `A` 的 Cholesky 分解。如果 `R <- chol(A)`，那么 `chol(A)` 包含上三角因子，使得 `R'R = A`。 |
| `colMeans(A)` | 返回包含 `A` 的列平均值的向量 |
| `crossprod(A)` | 返回 `A'A` |
| `crossprod(A,B)` | 返回 `A'B` |
| `colSums(A)` | 返回包含 `A` 的列和的向量 |
| `diag(A)` | 返回包含主对角线元素的向量 |
| `diag(x)` | 创建一个主对角线元素为 `x` 的对角矩阵 |
| `diag(k)` | 如果 `k` 是一个标量，则创建一个 `k` × `k` 的单位矩阵。自己去想吧。 |

| `eigen(A)` | `A` 的特征值和特征向量。如果 `y <- eigen(A)`，那么

+   `y$val` 是 `A` 的特征值。

+   `y$vec` 是 `A` 的特征向量。

|

| `ginv(A)` | `A` 的摩尔-彭罗斯广义逆。 (需要 `MASS` 包。) |
| --- | --- |

| `qr(A)` | `A` 的 QR 分解。如果 `y <- qr(A)`，那么

+   `y$qr` 有一个包含分解的上三角和一个包含分解信息的下三角。

+   `y$rank` 是 `A` 的秩。

+   `y$qraux` 是一个包含 Q 的附加信息的向量。

+   `y$pivot` 包含有关旋转策略的信息。

|

| `rbind(A, B, ...)` | 垂直组合矩阵或向量。返回一个矩阵。 |
| --- | --- |
| `rowMeans(A)` | 返回包含 `A` 的行平均值的向量 |
| `rowSums(A)` | 返回包含 `A` 的行和的向量 |
| `solve(A)` | `A` 是一个方阵时，返回 `A` 的逆 |
| `solve(A, b)` | 求解方程 `b = Ax` 中的向量 `x` |

| `svd(A)` | `A` 的单值分解。如果 `y <- svd(A)`，那么

+   `y$d` 是包含 `A` 的奇异值的向量。

+   `y$u` 是一个矩阵，其列包含 `A` 的左奇异向量。

+   `y$v` 是一个矩阵，其列包含 `A` 的右奇异向量。

|

| `t(A)` | `A` 的转置 |
| --- | --- |

几个用户贡献的包特别适用于矩阵代数。`matlab` 包包含用于尽可能接近地复制 MATLAB 函数调用的包装函数和变量。这些函数可以帮助您将 MATLAB 应用程序和代码移植到 R。同时，还有一个有用的速查表，可以在 [`mathesaurus.sourceforge.net/octave-r.html`](http://mathesaurus.sourceforge.net/octave-r.html) 将 MATLAB 语句转换为 R 语句。

`Matrix` 包包含将 R 扩展到支持高度密集或稀疏矩阵的函数。它提供了对 BLAS（基本线性代数子程序）、LAPACK（密集矩阵）、TAUCS（稀疏矩阵）和 UMFPACK（稀疏矩阵）例程的高效访问。

最后，`matrixStats` 包提供了对矩阵的行和列进行操作的方法，包括计算计数、总和、乘积、中心趋势、离散度等函数。每个函数都针对速度和高效内存使用进行了优化。
