# 前置内容

## 前言

我第一次见到作者，维尔·图卢斯（Ville Tuulos），是在 2012 年，当时我正在试图理解围绕 Hadoop 的炒作。当时，维尔正在开发 Disco，这是一个基于 Erlang 的 map-reduce 解决方案，使得与 Python 交互变得容易。彼得·王（Peter Wang）和我刚刚开始创立 Continuum Analytics Inc.，维尔的工作是我们发布 Python 大数据发行版 Anaconda 的主要动机之一。

作为 NumPy 和 Anaconda 的创始人，我怀着极大的兴趣观察了过去六到七年中 ML Ops 工具的爆炸式增长，这是对机器学习带来的不可思议机会的回应。有令人难以置信的多种选择，许多营销资金被用来说服你选择这个工具而不是另一个。我在 Quansight 和 OpenTeams 的团队一直在评估新的工具和方法，以便向我们的客户提供推荐。

有像维尔和 Netflix 以及[outerbounds.co](https://outerbounds.com/)这样的团队这样的信任之人来创建和维护 Metaflow，这让人感到安慰。我对这本书感到兴奋，因为它详细介绍了 Metaflow，并提供了关于为什么在数据丰富的世界中数据基础设施和机器学习操作如此重要的卓越概述。无论你使用哪种 MLOps 框架，我都相信通过阅读和参考这本书，你将学会如何使你的机器学习操作更加高效和富有成效。

——特拉维斯·奥利弗特（Travis Oliphant），NumPy 的作者，Anaconda、PyData 和 NumFocus 的创始人

## 前言

作为一名青少年，我对人工智能深感兴趣。我在 13 岁时训练了我的第一个人工神经网络。我从零开始用 C 和 C++编写了简单的训练算法，这是 20 世纪 90 年代探索这个领域的唯一方式。我继续学习计算机科学、数学和心理学，以更好地理解这个庞大主题的基础。通常，机器学习（那时还没有“数据科学”这个术语）的应用似乎更像炼金术，而不是真正的科学或原则性的工程。

我的旅程带我从一个学术领域到大型公司和初创公司，我在那里不断构建支持机器学习的系统。我深受像 Linux 这样的开源项目以及当时新兴的 Python 数据生态系统的影响，这些项目提供了像 NumPy 这样的包，使得与 C 或 C++相比，构建高性能代码变得容易得多。除了开源技术的技术优势外，我还观察到围绕这些项目形成了多么创新、充满活力和欢迎的社区。

当我在 2017 年加入 Netflix，并受命从头开始构建新的机器学习基础设施时，我心中有三个原则。首先，我们需要对整个栈有一个原则性的理解——数据科学和机器学习需要成为真正的工程学科，而不是炼金术。其次，我确信 Python 是构建新平台正确的基石，这不仅因为其技术上的优势，也因为其庞大的包容性社区。第三，最终，数据科学和机器学习是供人类使用的工具。工具的唯一目的是让用户更有效率，并在成功时提供愉悦的用户体验。

工具是由创造它们的文化塑造的。Netflix 的文化在塑造我启动的开源工具 Metaflow 中发挥了高度的影响，Metaflow 已经成为一个充满活力的开源项目。Netflix 的进化压力确保了 Metaflow 以及我们对数据科学全栈的理解是基于实践数据科学家的实际需求。

Netflix 赋予其数据科学家很高的自主权，他们通常不是经过软件工程培训的。这迫使我们仔细思考数据科学家在开发项目和最终部署到生产中时面临的种种挑战，无论大小。我们对栈的理解也深受 Netflix 顶级工程团队的影响，这些团队已经使用云计算十多年，形成了一个关于其优势和劣势的巨大知识体系。

我想写这本书是为了与更广泛的世界分享这些经验。我从开源社区、令人惊叹的洞察力和无私的个人，以及非常聪明的数据科学家那里学到了很多，我觉得有义务尝试回馈。这本书肯定不是我的学习旅程的终点，而只是一个里程碑。因此，我很乐意听到您的意见。不要犹豫，随时联系我，分享您的经验、想法和反馈！

## 致谢

没有 Netflix 和其他许多公司的所有数据科学家和工程师的耐心解释他们的痛点、分享反馈，并允许我窥视他们的项目，这本书就不可能完成。谢谢！请继续提供反馈。

Metaflow 受到了一群有才华、热情和富有同理心的工程师的影响，并继续由他们开发：Savin Goyal、Romain Cledat、David Berg、Oleg Avdeev、Ravi Kiran Chirravuri、Valay Dave、Ferras Hamad、Jason Ge、Rob Hilton、Brett Rose、Abhishek Kapatkar 以及许多人。你们的手印遍布这本书！与你们所有人一起工作是一种特权，也是一种巨大的乐趣。此外，我想感谢自项目启动以来一直支持项目的 Kurt Brown、Julie Amundson、Ashish Rastogi、Faisal Siddiqi 和 Prasanna Padmanabhan。

我一直想和 Manning 合作编写这本书，因为他们以出版高质量的技术书籍而闻名。我没有失望！我很幸运能与经验丰富的编辑 Doug Rudder 合作，他让我成为了一名更好的作者，并将长达 1.5 年的写作过程变成了一个愉快的体验。我要向 Nick Watts 和 Al Krinker 表示衷心的感谢，他们的深刻技术评论，以及所有在早期访问期间提供反馈的读者和审稿人。

致所有审稿人：Abel Alejandro Coronado Iruegas、Alexander Jung、David Patschke、David Yakobovitch、Edgar Hassler、Fibinse Xavier、Hari Ravindran、Henry Chen、Ikechukwu Okonkwo、Jesús A. Juárez Guerrero、Matthew Copple、Matthias Busch、Max Dehaut、Mikael Dautrey、Ninoslav Cerkez、Obiamaka Agbaneje、Ravikanth Kompella、Richard Vaughan、Salil Athalye、Sarah Catanzaro、Sriram Macharla、Tuomo Kalliokoski 和 Xiangbo Mao，你们的建议帮助使这本书更加完善。

最后，我要感谢我的妻子和孩子们，他们始终如一地耐心和支持。孩子们——如果你读到这句话，我欠你一块冰淇淋！

## 关于这本书

如果考虑到支撑它们的软件和硬件的全栈，机器学习和数据科学应用是人类构建的最复杂的工程成果之一。从这个角度来看，今天在 2020 年代初，构建这样的应用程序并不容易，这并不令人惊讶。

机器学习和数据科学将长期存在。由先进的数据驱动技术支持的应用程序在各个行业中的应用越来越普遍。因此，有必要使构建和运营此类应用程序的过程更加痛苦和规范。正如阿尔弗雷德·怀特海德所说：“文明通过扩展我们可以在不思考的情况下执行的重要操作的数量而进步。”

本书教你如何构建一个有效的数据科学基础设施，使用户能够尝试创新的应用程序，将它们部署到生产环境中，并在不过多考虑技术细节的情况下持续改进。没有一种一刀切的方法适用于所有用例。因此，本书侧重于一般性的、基础性的原则和组件，你可以在你的环境中以有意义的方式实现它们。

### 应该阅读这本书的人？

本书有两个主要的目标受众：

+   想要在现实世界的商业环境中有效地开发和部署数据科学应用的全栈系统，并理解其工作原理的*数据科学家*。即使你没有基础设施工程、DevOps 或软件工程的一般背景，你也可以使用这本书来全面了解所有动态部分，并学到一些新知识。

+   被委派建立基础设施以帮助数据科学家的*基础设施工程师*。即使你在 DevOps 或系统工程方面有经验，你也可以使用这本书来全面了解数据科学的需求与传统软件工程的不同，以及相应地，为什么需要不同的基础设施堆栈来使数据科学家更有效率。

此外，数据科学和平台工程组织的领导者可以快速浏览本书，因为基础设施塑造组织，反之亦然。

### 本书是如何组织的：一个路线图

本书围绕数据科学基础设施的全栈进行组织，您可以在书的内封面上找到它。堆栈的结构是这样的，最基础、面向工程的层在底部，而与数据科学相关的更高层次的关注点在顶部。我们将从底部向上大致遍历堆栈，如下所示：

+   第一章解释了为什么首先需要数据科学基础设施。它还将激励我们以人为中心的基础设施方法。

+   第二章从基础知识开始：数据科学家每天进行的活动以及如何优化他们的工作环境的人体工程学。

+   第三章介绍了 Metaflow，这是一个开源框架，我们将用它来展示有效基础设施的概念。

+   第四章专注于可扩展的计算：所有数据科学应用都需要进行计算，有时在小规模，有时在大型规模。我们将通过云来实现这一点。

+   第五章专注于性能：众所周知，过早优化不是一个好主意。更好的方法是逐步优化代码，只在需要时增加复杂性。

+   第六章讨论了生产部署：原型环境和生产环境之间存在几个关键差异，但在这两者之间移动不应太难。

+   第七章深入探讨了数据科学的另一个基础问题：数据。我们将研究有效的方法来与现代数据仓库和数据工程团队合作。

+   第八章讨论了在周围业务系统背景下的数据科学应用。数据科学不应成为一个孤岛——我们将学习如何将其与其他系统连接起来，以产生真正的商业价值。

+   第九章通过一个现实、端到端的深度学习应用，将堆栈的所有层连接起来。

+   附录包括安装和配置 Metaflow 的 Conda 包管理器的说明。

从第三章开始，章节中包含了一些小但真实的机器学习应用，以展示这些概念。不需要机器学习或数据科学方面的先验知识——我们只是将这些技术用于说明。本书不会深入教授机器学习或数据科学技术——许多优秀的书籍已经做到了这一点。我们的重点是这些应用所依赖的基础设施。

完成前三个章节后，您可以自由地跳过与您无关的章节。例如，如果您只处理小规模数据，您可以专注于第三章、第六章和第八章。

### 关于代码

本书在所有示例中都使用了开源 Python 框架 Metaflow ([`metaflow.org`](https://metaflow.org))。然而，本书中提出的概念和原则并不特定于 Metaflow。特别是，第四章至第八章可以轻松地适应其他框架。您可以在[`github.com/outerbounds/dsbook`](https://github.com/outerbounds/dsbook)找到本书中展示的所有源代码。

您可以在 OS X 或 Linux 笔记本电脑上运行示例。您只需要一个代码编辑器和终端窗口。类似于这样的以# python 开头的行

```
# python taxi_regression_model.py --environment=conda run
```

这些示例旨在在终端上执行。可选地，许多示例受益于 AWS 账户，如第四章所述。

### liveBook 讨论论坛

购买 *有效数据科学基础设施* 包括免费访问 liveBook，曼宁的在线阅读平台。使用 liveBook 的独家讨论功能，您可以在全球范围内或针对特定章节或段落附加评论。为自己做笔记、提出和回答技术问题以及从作者和其他用户那里获得帮助都非常简单。要访问论坛，请访问[`livebook.manning.com/book/effective-data-science-infrastructure/discussion`](https://livebook.manning.com/book/effective-data-science-infrastructure/discussion)。您还可以在[`livebook.manning.com/discussion`](https://livebook.manning.com/discussion)了解更多关于曼宁论坛和行为准则的信息。

曼宁对读者的承诺是提供一个平台，让读者之间以及读者与作者之间可以进行有意义的对话。这不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您尝试向作者提出一些挑战性的问题，以免他的兴趣转移！只要本书仍在印刷中，论坛和先前讨论的存档将可通过出版社的网站访问。

### 其他在线资源

如果你在学习过程中遇到困难，需要额外的帮助，或者对本书的主题有任何反馈或想法，你非常欢迎加入我们友好的在线社区[`slack.outerbounds.co`](http://slack.outerbounds.co)。你也可以通过 LinkedIn ([`www.linkedin.com/in/villetuulos/`](https://www.linkedin.com/in/villetuulos/))或 Twitter (@vtuulos)联系作者。如果你认为你在 Metaflow 中发现了错误，请在此处打开一个问题[`github.com/Netflix/metaflow/issues.`](https://github.com/Netflix/metaflow/issues)

## 关于作者

![Tuulos_AuthorPhoto](img/Tuulos_AuthorPhoto.png)

维莱·图卢斯从事机器学习基础设施的开发已有二十多年。他的经历包括学术界、专注于数据和机器学习的初创公司，以及两家全球企业。他在 Netflix 领导了机器学习基础设施团队，在那里他启动了 Metaflow，这是一个开源框架，本书中有所介绍。他是 Outerbounds 的 CEO 和联合创始人，该公司专注于以人为本的数据科学基础设施。

## 关于封面插图

《有效数据科学基础设施》封面上的图像是“奥格斯堡夫人”，或称“奥格斯堡女士”，取自雅克·格拉塞·德·圣索沃尔的收藏，该收藏于 1797 年出版。每一幅插图都是手工精心绘制和着色的。

在那些日子里，仅凭人们的服饰就能轻易地识别出他们居住的地方以及他们的职业或社会地位。曼宁通过基于几个世纪前丰富多样的地域文化的书封面，庆祝计算机行业的创新精神和主动性，这些文化通过像这样的一些收藏品中的图片被重新带回生活。
