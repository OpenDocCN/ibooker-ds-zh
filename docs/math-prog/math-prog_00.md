# 前置内容

## 前言

我在 2017 年开始写这本书，当时我是 Tachyus 公司的 CTO，这是我创立的一家为石油和天然气公司构建预测分析软件的公司。到那时，我们已经完成了核心产品的构建：一个由物理和机器学习驱动的流体流动模拟器，以及一个优化引擎。这些工具让我们的客户能够看到他们石油储量的未来，并帮助他们发现数亿美元优化机会。

作为 CTO，我的任务是使这款软件产品化并扩展规模，因为世界上一些最大的公司开始使用它。挑战在于，这不仅是一个复杂的软件项目，而且代码非常数学化。大约在那个时期，我们开始招聘一个名为“科学软件工程师”的职位，我们的想法是需要有数学、物理和机器学习扎实背景的熟练专业软件工程师。在寻找和招聘科学软件工程师的过程中，我意识到这种组合既罕见又需求量大。我们的软件工程师也意识到了这一点，并渴望提高他们的数学技能，为我们的堆栈的专业后端组件做出贡献。在我们团队中已经有一些热切的数学学习者，以及在我们的招聘渠道中，我开始思考如何最好地训练一个强大的软件工程师，使他成为一个强大的数学使用者。

我意识到没有适合的数学书籍，以适当水平呈现。虽然关于线性代数和微积分等主题可能有数百本书和数千篇免费在线文章，但我不知道有任何一本书可以交给一个典型的专业软件工程师，并期望他们在几个月后掌握这些材料。我并不是说贬低软件工程师，我的意思是阅读和理解数学书籍是一项很难单独学会的技能。要做到这一点，你通常需要弄清楚你需要学习哪些具体主题（如果你对材料一无所知，这很困难！），阅读它们，然后选择一些高质量的练习来练习应用这些主题。如果你不那么挑剔，你可以阅读教科书中的每一个字，解决其所有的练习，但这可能需要几个月的全职学习才能完成！

通过《程序员数学》，我希望提供一个替代方案。我相信在合理的时间内，包括完成所有练习，可以通读这本书，然后带着掌握了一些关键数学概念离开。

### 本书的设计

2017 年秋季，我联系了 Manning 出版社，得知他们对出版这本书感兴趣。这开始了将我对这本书的愿景转化为具体计划的长过程，这比我想象的要困难得多，因为我是一个第一次当作者的人。Manning 对我的原始目录提出了一些棘手的问题，例如

+   会有任何人对这个主题感兴趣吗？

+   这会不会太抽象了？

+   你真的能在一章中教完一个学期的微积分吗？

所有这些问题都迫使我更加仔细地思考哪些是可实现的。我将分享我们回答这些问题的几种方法，因为这将帮助你确切地了解这本书是如何运作的。

首先，我决定将这本书的重点放在一个核心技能上——用代码表达数学思想。我认为这是一种学习数学的好方法，即使你不是程序员。当我还在高中时，我在我的 TI-84 图形计算器上学习编程。我有一个宏伟的想法，那就是我可以编写程序来做我的数学和科学作业，给出正确答案，并且在过程中输出步骤。正如你可能预料的那样，这比最初做作业要困难得多，但它给了我一些有用的视角。对于任何我想编程的问题，我必须清楚地理解输入和输出，以及解决方案的每个步骤中发生了什么。到最后，我确信我掌握了这些材料，并且有一个可以证明的运行程序。

这就是我在这本书中试图与你分享的经验。每一章都是围绕一个具体的示例程序组织的，为了使其工作，你需要正确地将所有的数学元素组合在一起。一旦完成，你将对自己理解了概念并且可以在将来再次应用它充满信心。我已经包括了大量的练习，帮助你检查我对数学和代码的理解，以及一些迷你项目，邀请你尝试对材料的新变体进行实验。

我还与曼宁讨论了另一个问题，那就是我应该使用哪种编程语言来编写示例。最初，我想用一种函数式编程语言来写这本书，因为数学本身就是一种函数式语言。毕竟，“函数”的概念起源于数学，在计算机甚至存在之前就已经存在了。在数学的各个部分，你都有函数，比如微积分中的积分和导数。然而，要求读者在学习新数学概念的同时学习像 LISP、Haskell 或 F#这样的不熟悉的语言，会使这本书更难懂，也更难接近。因此，我们决定使用 Python，这是一种流行、易于学习的语言，拥有出色的数学库。Python 也恰好是学术界和工业界“现实世界”数学用户的喜爱。

最后一个我必须与曼宁一起回答的问题是，我会包括哪些具体的数学主题，哪些主题不会入选。这是一个艰难的决定，但至少我们在标题上达成了共识，即《程序员数学》，这个标题的广泛性给了我们一些灵活性，关于可以包含什么内容。我的主要标准变成了以下这个：这将是一本“程序员数学”，而不是“计算机科学家数学”。考虑到这一点，我可以省略离散数学、组合数学、图论、逻辑、大 O 符号等主题，这些主题在计算机科学课程中有所涉及，并且主要用于*研究*程序。

即使做出了这个决定，仍有大量的数学可以选择。最终，我选择专注于线性代数和微积分。我对这些主题有一些强烈的教学法观点，而且在这两个主题中都有许多好的示例应用，这些应用可以是视觉的，也可以是交互式的。你可以单独写一本关于线性代数或微积分的大部头教科书，所以我必须更加具体。为了做到这一点，我决定这本书将逐步构建到机器学习这一热门领域的某些应用中。做出了这些决定后，本书的内容变得更加清晰。

### 我们涵盖的数学思想

本书涵盖了大量的数学主题，但有几个主要主题。以下是一些你在开始阅读时可以留意的内容：

+   *多维空间--*直观上，你可能对二维（2D）和三维（3D）这些词的含义有所了解。我们生活在一个三维世界中，而二维世界则是像一张纸或电脑屏幕那样平坦。二维空间中的一个位置可以用两个数字（通常称为 *x* 和 *y* 坐标）来描述，而在三维空间中识别一个位置则需要三个数字。我们无法想象 17 维空间，但我们可以用 17 个数字的列表来描述其点。这样的数字列表被称为 *向量*，向量数学有助于阐明“维度”的概念。

+   *函数空间--*有时，一组数字可以指定一个函数。例如，有两个数字 *a* = 5 和 *b* = 13，你可以创建一个（线性）函数，形式为 *f*(*x*) = *ax* + *b*，在这种情况下，函数将是 *f*(*x*) = 5*x* + 13。对于二维空间中的每一个点，用坐标 (a, b) 标记，都有一个与之对应的线性函数。因此，我们可以将所有线性函数的集合视为一个二维空间。

+   *导数和梯度*--这些是微积分运算，用于测量函数变化的速率。*导数*告诉你当输入值 *x* 增加时，函数 *f*(*x*) 是如何增加或减少的。一个三维函数可能看起来像 *f*(*x*, *y*)，并且当改变 *x* 或 *y* 的值时，它可能会增加或减少。将 (*x*, *y*) 对视为二维空间中的点，你可以问在这个二维空间中你可以朝哪个方向走，才能使 *f* 增加得最快。梯度回答了这个问题。

+   *优化函数--*对于一个形式为 *f*(*x*) 或 *f*(*x*, *y*) 的函数，你可以问一个更广泛的问题：哪些输入能够产生最大的输出？对于 *f*(*x*)，答案将是某个值 *x*，而对于 *f*(*x*, *y*)，它将是二维空间中的一个点。在二维情况下，梯度可以帮助我们。如果梯度告诉我们 *f*(*x*, *y*) 在某个方向上增加，那么如果我们朝那个方向探索，我们就可以找到 *f*(*x*, *y*) 的最大值。如果你想要找到一个函数的最小值，这个策略同样适用。

+   *使用函数预测数据--*假设你想预测一个数值，比如在特定时间点的股票价格。你可以创建一个函数 *p*(*t*)，它接受时间 *t* 并输出价格 *p*。你函数预测质量的标准是它如何接近实际数据。从这个意义上说，找到一个预测函数意味着最小化你的函数与实际数据之间的误差。为了做到这一点，你需要探索一个函数空间并找到一个最小值。这被称为 *回归*。

我认为这是一套对任何人来说都很有用的数学概念，可以放入他们的工具箱中。即使你对机器学习不感兴趣，这些概念——以及本书中的其他概念——在其他许多应用中都有丰富的用途。

我最遗憾的是在书中没有包含概率和统计学的内容。概率以及量化不确定性的概念在机器学习中同样重要。这本书已经很大了，所以实在没有时间或空间来为这些主题提供一个有意义的介绍。请期待这本书的续集。还有许多有趣且有用的数学知识，超出了我在这些页面所能涵盖的范围，我希望将来能够与大家分享。

## 致谢

从开始到结束，这本书的创建大约花费了三年时间。在那段时间里，我得到了很多帮助，因此我有很多要感谢和认可的人。

首先，我要感谢 Manning 出版社让这本书成为现实。我非常感激他们对我这个首次担任作者的人的信任，在我几次未能按时完成书稿时，他们展现出了极大的耐心。特别是，我要感谢 Marjan Bace 和 Michael Stephens 推动项目前进，并帮助定义了这本书的具体内容。我的原始开发编辑 Richard Wattenbarger 在保持书稿活力方面也至关重要。我认为他在我们确定书的结构之前，审阅了第一章和第二章的六稿。

我在 2019 年在我的第二位编辑 Jennifer Stout 的专家指导下写下了这本书的大部分内容，她不仅帮助项目顺利完成，还教了我很多关于技术写作的知识。我的技术编辑 Kris Athi 和技术审稿人 Mike Shepard 也与我们走到了最后，多亏了他们阅读了每一个字和每一行代码，我们发现了并修复了无数错误。在 Manning 之外，我还从 Michaela Leung 那里得到了很多编辑帮助，她还审阅了整本书的语法和技术准确性。我还要感谢 Manning 的市场营销团队。通过 MEAP 项目，我们能够验证这本书是人们感兴趣的。在努力完成出版前的最后阶段时，知道这本书至少会取得一定的商业成功是一个巨大的动力。

我目前在 Tachyus 的以及以前的同事教了我很多关于编程的知识，其中许多教训都融入了这本书中。我要感谢 Jack Fox，是他首先让我开始思考函数式编程与数学之间的联系，这一点在第四章和第五章中有所体现。Will Smith 教了我关于视频游戏设计，我们关于 3D 渲染的矢量几何学进行了许多有益的讨论。最值得一提的是，Stelios Kyriacou 教了我大部分关于优化算法的知识，并帮助我让这本书中的部分代码能够运行。他还向我介绍了“一切皆可优化”的哲学，这是书中后半部分的主题。

向所有审稿人致谢：Adhir Ramjiawan、Anto Aravinth、Christopher Haupt、Clive Harber、Dan Sheikh、David Ong、David Trimm、Emanuele Piccinelli、Federico Bertolucci、Frances Buontempo、German Gonzalez-Morris、James Nyika、Jens Christian B. Madsen、Johannes Van Nimwegen、Johnny Hopkins、Joshua Horwitz、Juan Rufes、Kenneth Fricklas、Laurence Giglio、Nathan Mische、Philip Best、Reka Horvath、Robert Walsh、Sébastien Portebois、Stefano Paluello 和 Vincent Zhu，你们的建议帮助使这本书更加完善。

我绝不是机器学习专家，所以我咨询了许多资源以确保我能够正确有效地介绍它。我最受 Andrew Ng 在 Coursera 上的“机器学习”课程以及 3Blue1Brown 在 YouTube 上的“深度学习”系列的影响。这些是极好的资源，如果你看过它们，你会注意到这本书的第三部分受到了它们介绍主题的方式的影响。我还要感谢 Dan Rathbone，他的实用网站 CarGraph.com 为我许多示例提供了数据来源。

我还想感谢我的妻子玛格丽特，一位天文学家，是她让我接触到了 Jupyter 笔记本。将本书的代码切换到 Jupyter 使得它更容易跟随。我的父母在撰写本书时也一直给予大力支持；在几次假期拜访他们时，我不得不匆忙完成一章。他们还亲自担保我会至少卖出至少一本（谢谢，妈妈！）。

最后，这本书献给我的父亲，是他在我五年级时教我如何用 APL 编程时，首先向我展示了如何在代码中做数学。如果这本书有第二版，我可能会请他帮忙将所有的 Python 代码重写为单行 APL 代码！

## 关于本书

《程序员数学》教您如何使用 Python 编程语言用代码解决数学问题。数学技能对于专业软件开发人员来说越来越重要，尤其是在公司为数据科学和机器学习配备团队时。数学在现代应用中也扮演着至关重要的角色，如游戏开发、计算机图形和动画、图像和信号处理、定价引擎和股市分析。

本书首先介绍二维和三维向量几何、向量空间、线性变换和矩阵；这些都是线性代数主题的精华。在第二部分，它介绍了以程序员特别有用的几个主题为重点的微积分：导数、梯度、欧拉方法和符号评估。最后，在第三部分，所有这些部分汇集在一起，向您展示一些重要的机器学习算法是如何工作的。到本书的最后一章，您将学会足够的数学知识，可以从头开始编写自己的神经网络。

这不是教科书！它旨在成为一个友好的介绍，介绍那些常常显得令人生畏、神秘或无聊的材料。每一章都包含一个完整的、现实世界的数学概念应用，辅以练习来帮助您检查您的理解，以及迷你项目来帮助您继续探索。

### 谁应该阅读这本书？

这本书是为任何有扎实编程背景的人而写的，他们想刷新他们的数学技能或了解更多关于数学在软件中的应用。它不需要任何先前的微积分或线性代数知识，只需要高中水平的代数和几何（即使那感觉已经很久远了！）本书旨在在您的键盘上阅读。如果您跟随示例并尝试所有练习，您将从中获得最大收益。

### 本书是如何组织的

第一章邀请您进入数学的世界。它涵盖了计算机编程中一些重要的数学应用，介绍了本书中的一些主题，并解释了编程如何成为数学学习者的宝贵工具。在此之后，本书分为三个部分：

+   第一部分重点介绍向量和线性代数。

    +   第二章介绍了二维向量数学，重点是使用坐标来定义二维图形。它还包含了一些基本三角学的复习。

    +   第三章将前一章的内容扩展到三维，其中点由三个坐标而不是两个坐标标记。它介绍了点积和叉积，这些有助于测量角度和渲染 3D 模型。

    +   第四章介绍了线性变换，这些函数以向量作为输入并返回向量，并且具有特定的几何效果，如旋转或反射。

    +   第五章介绍了矩阵，这些是编码线性向量变换的数字数组。

    +   第六章将二维和三维的思想扩展，以便你可以处理任何维度的向量集合。这些被称为向量空间。作为一个主要例子，它涵盖了如何使用向量数学处理图像。

    +   第七章专注于线性代数中最重要的计算问题：解线性方程组。它将此应用于一个简单视频游戏中的碰撞检测系统。

+   第二部分介绍了微积分及其在物理学中的应用。

    +   第八章介绍了函数变化率的概念。它涵盖了导数，它计算函数的变化率，以及积分，它从函数的变化率中恢复函数。

    +   第九章介绍了一种近似积分的重要技术，称为欧拉方法。它将第七章的游戏扩展到包括移动和加速的物体。

    +   第十章展示了如何在代码中操作代数表达式，包括自动找到函数的导数公式。它介绍了符号编程，这是一种与本书其他部分不同的在代码中执行数学的方法。

    +   第十一章将微积分主题扩展到二维，定义了梯度操作，并展示了如何用它来定义力场。

    +   第十二章展示了如何使用导数来找到函数的最大值或最小值。

    +   第十三章展示了如何将声波视为函数，以及如何将它们分解为其他更简单函数的和，这些函数称为傅里叶级数。它涵盖了如何编写 Python 代码来播放音符和和弦。

+   第三部分结合了前两部分的思路，介绍了机器学习的一些重要思想。

    +   第十四章介绍了如何将直线拟合到二维数据，这个过程被称为线性回归。我们探讨的例子是找到一个函数，根据汽车的里程数来最佳预测二手车价格。

    +   第十五章讨论了一个不同的机器学习问题：根据一些关于汽车的数据来确定其模型。确定数据点代表的是哪种类型的对象被称为分类。

    +   第十六章展示了如何设计和实现神经网络，这是一种特殊的数学函数，并使用它来对图像进行分类。这一章结合了几乎所有前面的章节的思想。

如果你已经阅读并理解了前面的章节，每一章都应该是可访问的。保持所有概念有序的成本是应用可能看起来很杂乱。希望各种示例使它成为一本有趣的读物，并展示了我们所涵盖数学的广泛应用范围。

### 关于代码

本书以（希望是）逻辑顺序呈现观点。你在第二章学到的观点适用于第三章，然后第二章和第三章的观点出现在第四章，依此类推。计算机代码并不总是像这样“按顺序”编写。也就是说，完成计算机程序中最简单的观点并不总是在源代码的第一个文件的第一行。这种差异使得以可理解的方式呈现书籍的源代码具有挑战性。

我的解决方案是为每一章包含一个“走查”代码文件，形式为 Jupyter 笔记本。Jupyter 笔记本类似于记录的 Python 交互会话，内置了如图表和图像等视觉元素。在 Jupyter 笔记本中，你输入一些代码，运行它，然后在你开发想法的过程中，也许会在会话中稍后覆盖它。每一章的笔记本都有每个部分和子部分的代码，按照它在书中的顺序运行。最重要的是，这意味着你可以在阅读书籍的同时运行代码。你不需要等到章节结束，你的代码就已经足够完整，可以工作。附录 A 介绍了如何设置 Python 和 Jupyter，附录 B 包含了一些如果你是 Python 语言新手的实用功能。

本书包含许多源代码示例，无论是编号列表还是与普通文本并列。在这两种情况下，源代码都使用 `fixed-width font like this` 这样的固定宽度字体格式化，以将其与普通文本区分开来。

此外，当代码在文本中描述时，源代码中的注释通常已从列表中删除。代码注释伴随着许多列表，突出显示重要概念。如果在线源代码中修复了勘误或错误，我将在那里包含注释，以解决与文本中打印的代码之间的任何差异。

在少数情况下，示例的代码是一个独立的 Python 脚本，而不是章节 Jupyter 笔记本中的单元格。你可以单独运行它，例如，`python script.py`，或者从 Jupyter 笔记本单元格中运行它，作为 `!python script.py`。我在一些 Jupyter 笔记本中包含了独立脚本的引用，这样你可以逐节跟随，并找到相关的源代码文件。

我在整本书中使用的约定是使用 Python 交互会话中会看到的 `>>>` 提示符号来表示单个 Python 命令的评估。我建议你使用 Jupyter 而不是 Python 交互，但无论如何，带有 `>>>` 的行代表输入，而没有 `>>>` 的行代表输出。以下是一个表示交互式评估 Python 代码片段“`2 + 2`”的代码块示例：

```
>>> 2 + 2 4
```

相比之下，下一个代码块没有 `>>>` 符号，所以它是普通的 Python 代码，而不是输入和输出的序列：

```
def square(x):     return x * x
```

本书包含数百个练习，这些练习旨在直接应用已覆盖的材料，以及小型项目，这些项目可能更复杂，需要更多创造力，或者引入新概念。本书中的大多数练习和微型项目都邀请您使用有效的 Python 代码解决一些数学问题。我几乎包括了所有问题的解决方案，除了某些更开放的小型项目。您可以在相应章节的 Jupyter notebook 的“漫步”中找到解决方案代码。

本书示例的代码可以从曼宁网站下载，网址为 [`www.manning.com/books/math-for-programmers`](https://www.manning.com/books/math-for-programmers)，以及 GitHub 上的 [`github.com/orlandpm/math-for-programmers`](https://github.com/orlandpm/math-for-programmers)。

### liveBook 讨论论坛

购买 *Math for Programmers* 包括免费访问由曼宁出版社运行的私人网络论坛，您可以在那里对书籍发表评论，提出技术问题，并从作者和其他用户那里获得帮助。要访问论坛，请访问 [`livebook.manning.com/#!/book/math-for-programmers/discussion`](https://livebook.manning.com/#!/book/math-for-programmers/discussion)。您还可以在 [`livebook.manning.com/#!/discussion`](https://livebook.manning.com/#!/discussion) 上了解更多关于曼宁论坛和行为准则的信息。

曼宁对读者的承诺是提供一个平台，在这里读者之间以及读者与作者之间可以进行有意义的对话。这并不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未支付报酬）。我们建议您尝试向作者提出一些挑战性的问题，以免他的兴趣转移！只要书籍在印刷中，论坛和先前讨论的存档将可通过出版社的网站访问。

## 关于作者

保罗·奥兰德是一位企业家、程序员和数学爱好者。在微软担任软件工程师后，他与他人共同创立了 Tachyus，这是一家初创公司，致力于为石油和天然气行业优化能源生产而构建预测分析。作为 Tachyus 的创始首席技术官，保罗领导了机器学习和基于物理的建模软件的产品化，后来作为首席执行官，他扩大了公司规模，为五大洲的客户提供服务。保罗拥有耶鲁大学的数学学士学位和华盛顿大学的物理学硕士学位。他的精神动物是龙虾。

## 关于封面插图

《程序员数学》封面上的插图名为“Femme Laponne”，或称拉普人女性，现称萨皮人，包括挪威北部、瑞典、芬兰和俄罗斯的部分地区。这幅插图取自雅克·格拉塞·德·圣索沃尔（1757-1810）的作品集，名为《不同国家的服饰》，于 1797 年在法国出版。每一幅插图都是手工精心绘制和着色的。格拉塞·德·圣索沃尔的收藏丰富多彩，生动地提醒我们，200 年前世界的城镇和地区在文化上有多么不同。人们彼此孤立，说着不同的方言和语言。在街道或乡村，仅凭他们的服饰就能轻易识别他们居住的地方以及他们的职业或社会地位。

自那以后，我们的着装方式已经改变，当时如此丰富的地区多样性已经消失。现在很难区分不同大陆、不同城镇、地区或国家的人们。也许我们用文化多样性换取了更加多样化的个人生活——当然，是为了更加多样化且节奏更快的技术生活。

在难以区分一本计算机书与另一本计算机书的今天，曼宁通过基于两百年前丰富多样的地区生活，并由格拉塞·德·圣索沃尔的图画使之重现的书封面，庆祝了计算机行业的创新精神和主动性。
