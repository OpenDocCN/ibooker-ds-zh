# 序言

欢迎来到 Excel 革命。通过更新您对 Excel 的思考方式和使用方法，您可以获得显著的生产力提升，并更强大地使用您的数据。本书介绍了“现代 Excel”套件的功能以及其他强大的分析工具。

# 学习目标

通过本书，您应能够使用现代 Excel 工具进行数据清洗、分析、报告和高级分析。特别是，您将使用 Power Query 清洗和转换数据，在 Power Pivot 中创建关系模型以构建复杂的分析，并探索 Excel 分析工具包以进一步自动化和增强您的工作。

# 先决条件

为实现这些目标，本书对技术和技术做了一些假设。

## 技术要求

为了充分利用本书，建议您使用 Windows 计算机，并安装桌面版 Microsoft 365 版 Excel。本书涵盖的功能相对较新，可能在旧版本的 Excel 中不可用。请注意，许多这些工具仍在为 Mac 开发，并且兼容性可能有所不同。由于 Excel 发展速度快，很难为每个版本提供精确的可用功能列表。

本书第七章简要解释了如何将 Excel 中的数据模型加载到 Power BI 中。它假定您作为 Windows 版 Microsoft 365 用户已经在计算机上安装了免费版 Power BI Desktop。第十二章深入探讨了如何将 Python 与 Excel 集成，指导您通过免费下载 Python 的过程。本书内的所有后续任务和练习均旨在完全在 Excel 中完成，无需外部程序。但是，作为过程的一部分，您将配置一些 Excel 加载项。

## 技术要求

本书专为希望探索可能不熟悉的现代功能的中级 Excel 用户设计。要充分受益，您应已熟悉以下 Excel 主题：

+   使用绝对引用、相对引用和混合单元格引用

+   构建条件逻辑和条件聚合函数（`IF()`语句、`SUMIF()`/`SUMIFS()`等）

+   结合数据源（`VLOOKUP()`、`INDEX()`/`MATCH()`或其他查找函数）

+   使用数据透视表进行数据排序、筛选和聚合

+   基本绘图（条形图、折线图等）

如果您希望在继续之前进一步练习这些主题，我推荐阅读 Michael Alexander 和 Dick Kusleika 合著的*Microsoft Excel 365 圣经*（Wiley, 2022）。

在书的第三部分中，您将探索统计学、编程及相关领域的高级概念。如果这些主题一开始看起来很具挑战性，请不要气馁。在获得熟练度方面有丰富的资源可供帮助，我将在必要时提供有用的参考资料。这本书的主要目标是展示 Excel 所提供的广阔可能性。

如果您希望在深入研究这些主题之前先增加知识，我建议阅读我的书籍[*进阶分析：从 Excel 到 Python 和 R*](https://www.oreilly.com/library/view/advancing-into-analytics/9781492094333)（O’Reilly，2021）。它提供了关于高级分析技术、Python 编程和其他与 Excel 中现代数据分析相关的主题的全面洞见和指导。

# 如何我到达这里

我进入数据世界的旅程始于 2010 年代初的 Excel，那时数据科学和人工智能尚未完全席卷世界。那个时候，Excel 常常感觉像是一个封闭的系统。如果你想进行高级分析，通常建议转向 Python 或 R。对于自助式关系数据模型，Access 是推荐的选择。我试图完成的许多复杂分析和自动化任务涉及繁琐的 VBA 模块和笨重的数组公式，使用户体验不太理想。

有一段时间，Excel 看起来可能最终会被淘汰。然而，如今的 Excel 在各种功能和应用的支持下经历了显著转变。

# “现代分析”是什么？为什么选择 Excel？

*现代分析* 指的是使用先进工具和技术来准备和分析数据，从简单的回顾性分析到预测建模和人工智能。在数据驱动决策日益演变的情境中，拥有多功能和可互操作的工具至关重要，使用户能够执行各种分析活动。

以前，Excel 在满足这些要求方面存在不足。然而，在过去的十年里，Excel 经历了重大转变，使其成为现代数据分析的真正强大工具。

本书旨在消除技术专业人员对 Excel 的常见误解，并展示其在现代分析领域的能力。通过展示 Power Pivot、Power Query 等工具的功能，本书挑战了 Excel 仅限于基本公式和函数的信念。它强调今天的 Excel 已经发展成为一个能够处理复杂数据分析任务的强大平台。

最终，这本书展示了 Excel 作为现代分析的强大而多功能的工具。它试图揭示谬论，指导技术专业人员和管理者充分利用 Excel 在有效数据分析和决策中的潜力。通过这样做，它使用户能够将 Excel 作为当代分析工具包的关键组成部分，为我们数据驱动的世界提供洞察并推动成功。

# 书籍概述

为了实现本书的学习目标和范围，我将内容分为三部分。

## 第一部分，使用 Power Query 进行数据清洗和转换

第一部分专注于 Excel 中用于数据清洗的 Power Query，以及它如何作为提取、转换和加载（ETL）工具使用。您将了解 Power Query 编辑器，学习数据剖析和各种转换技术，如过滤、拆分、聚合和合并数据。

## 第二部分，使用 Power Pivot 进行数据建模与分析

第二部分介绍了 Excel 的 Power Pivot，重点在于其在报告中的应用。您将学习如何定义关系、构建数据模型，并通过计算列、关键绩效指标（KPI）等增强数据模型，主要使用数据分析表达式（DAX）语言。

## 第三部分，Excel 数据分析工具包

本书的第三部分探讨了 Excel 中几个令人兴奋的数据分析新功能。您将学习关于动态数组函数的知识，这些函数可以实现快速和灵活的电子表格计算。此外，本书还提供了有关预测分析和人工智能的入门信息，讨论了它们在 Excel 中的潜在应用，并展示了程序的未来。书籍以一个高级主题结束：使用 Python 构建自动化工作簿。您将学习如何有效地利用 Python 和 Excel 结合，以增强您的分析能力。

# 章节末练习

当我阅读书籍时，我倾向于跳过章节末的练习，因为我认为保持阅读的动力更有价值。*不要像我这样！*

大多数章节结束时，我提供了通过实践应用所学知识的机会。练习及其解决方案位于附带库的*exercises*文件夹中，按章节号进行组织。我鼓励您完成这些练习，并将您的答案与提供的解决方案进行比较。通过这样做，您不仅可以增进对材料的理解，还可以为我树立一个积极的榜样。

# 这不是一份清单

Excel 的快速发展步伐和大量新工具可能会让人感到不知所措。为了避免失去焦点并使书籍变得难以驾驭，我精心挑选了一组特定的主题，这些主题对中级 Excel 用户具有广泛的潜力和实用性，这些选择源于我作为 Excel 顾问和培训师多年的经验。

如果您认为现代 Excel 中最喜欢或最有影响力的特性未在本书中介绍，请作为社区的重要成员分享您的见解。Excel 数据分析的领域超出了一本书的边界，Excel 社区渴望从您的见解和经验中学习。

您准备好开始现代 Excel 之旅了吗？我会在第一章中等你。

# 本书使用的约定

本书中使用以下印刷约定：

*斜体*

表示新术语、URL、电子邮件地址、文件名和文件扩展名。

`等宽`

用于程序列表，以及段落中引用程序元素，如变量或函数名、数据库、数据类型、环境变量、语句和关键字。

**`等宽粗体`**

显示用户应直接输入的命令或其他文本。

*`等宽斜体`*

显示应由用户提供值或根据上下文确定值的文本。

###### 提示

此元素表示提示或建议。

###### 注意

这个元素表示一般注释。

###### 警告

此元素表示警告或注意事项。

# 使用代码示例

可以下载补充材料（例如代码示例、练习等）：[*https://github.com/stringfestdata/modern-analytics-excel-book*](https://github.com/stringfestdata/modern-analytics-excel-book)。

本书旨在帮助您完成工作。通常情况下，如果本书提供了示例代码，您可以在您的程序和文档中使用它。除非您复制了代码的大部分内容，否则无需征得我们的许可。例如，编写一个使用本书中几个代码片段的程序不需要许可。出售或分发奥莱利图书中的示例则需要许可。引用本书并引用示例代码回答问题不需要许可。将本书中大量示例代码合并到产品文档中则需要许可。

我们感谢，但通常不要求署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*现代 Excel 中的数据分析* 由乔治·蒙特（奥莱利）著。2024 年版权所有 Candid World Consulting, LLC，978-1-098-14882-9。”

如果您觉得您对代码示例的使用超出了合理使用或上述许可，请随时通过*permissions@oreilly.com*与我们联系。

# 奥莱利在线学习

###### 注意

[*奥莱利媒体*](https://oreilly.com)已经提供了超过 40 年的技术和商业培训，知识和洞察力，帮助企业取得成功。

我们独特的专家和创新者网络通过书籍、文章和我们的在线学习平台分享他们的知识和专长。O’Reilly 的在线学习平台为您提供随需应变的现场培训课程、深入学习路径、交互式编码环境，以及来自 O’Reilly 和其他 200 多个出版商的广泛文本和视频资源。更多信息，请访问[*https://oreilly.com*](https://oreilly.com)。

# 如何联系我们

请将有关本书的评论和问题寄给出版商：

+   O’Reilly Media, Inc.

+   1005 Gravenstein Highway North

+   加利福尼亚州塞巴斯托波尔市，95472

+   800-889-8969（在美国或加拿大）

+   707-827-7019（国际或本地）

+   707-829-0104（传真）

+   *support@oreilly.com*

+   [*https://www.oreilly.com/about/contact.html*](https://www.oreilly.com/about/contact.html)

我们为这本书准备了一个网页，上面列出了勘误、示例和任何额外信息。你可以访问此页面：[*https://oreil.ly/modern-data-analytics-excel*](https://oreil.ly/modern-data-analytics-excel)。

想要获取关于我们的书籍和课程的新闻和信息，请访问[*https://oreilly.com*](https://oreilly.com)。

在 LinkedIn 上找到我们：[*https://linkedin.com/company/oreilly-media*](https://linkedin.com/company/oreilly-media)。

观看我们的 YouTube 频道：[*https://youtube.com/oreillymedia*](https://youtube.com/oreillymedia)。

# 致谢

写书最迷人的一个方面，尤其是致谢部分，是它记录了你生活中的一个时刻，并突出了那些在那个时期显著的人物。

我之前的书的致谢部分可以找到很多这些名字。我特别感谢 O’Reilly 的收购团队米歇尔·史密斯和乔恩·哈塞尔，他们批准我写另一本书。我的朋友兼 O’Reilly 作者托比亚斯·兹文格曼多年来相互审查了他的工作，为这个项目提供了极具帮助的技术审查。此外，我的父母乔纳森和安吉拉·芒特在支持方面始终如一，超出了我所能期望的。不确定有多少母亲希望自己的孩子成为 Excel 作者，但我的母亲一直给予了我难以置信的支持。

我还有机会通过这个项目深入了解一些人物。我要感谢艾伦·默里、约瑟夫·斯蒂克和梅根·芬利对本书额外技术审查的宝贵贡献。特别要感谢梅根，她不仅为本书带来了令人印象深刻的技术编辑经验，还在整个写作过程中作为我的女友给予了不可思议的支持。（正如任何作者所能告诉你的，写书不可避免地成为一个家庭的事务。）此外，我要感谢杰夫·斯蒂文斯、劳拉·塞佩西和马克·德波对手稿的反馈。

此外，我要感谢 O'Reilly 的编辑团队，他们在我撰写技术书籍的过程中给予了我大量指导。特别感谢 Sara Hunter，在我着手写第二本书时，她作为无价的编辑顾问给予了我很多帮助。

最后，我要向整个 Excel 社区表示感激，他们是如此热情和鼓舞人心的一群。这款电子表格程序为我打开了更多机会，让我结识了更多令人难以置信的人。希望这本书能在某种程度上为你在 Excel 中的卓越之旅贡献一些小小的帮助。
