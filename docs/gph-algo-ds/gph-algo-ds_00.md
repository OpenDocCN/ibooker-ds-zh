# 前置内容

## 前言

当你阅读这本书时，我希望你对关系的力量和关联信息的威力感到惊讶，就像我 15 年前在波罗的海的一次极客游轮上第一次遇见 Neo4j 的创始人之一 Emil Eifrém 时一样。十年后，当 Tomaž和我第一次在伦敦见面时，发生了一次同样鼓舞人心且影响深远的事件。他在 Neo4j 社区中已经活跃了一段时间。在那次会面之后，他的贡献急剧增加，最初帮助测试和记录图数据科学库的前身，同时成为与图、NLP 及其实际应用相关的数据科学主题的多产作者（[bratanic-tomaz.medium.com](http://bratanic-tomaz.medium.com)）。在我们被 Manning 联系讨论创作一本关于图分析的书——你现在手中的这本书——的时候，Tomaž肯定已经发表了数百篇文章。Tomaž显然是成为这本书作者的合适人选，并且他做得非常出色，将他的经验、教育写作风格和现实世界案例提炼成一本见解独到且引人入胜的书。这本书是一次探索连接数据隐藏深度的旅程，使用图算法和新的机器学习技术——如节点嵌入——以及图机器学习，如链接预测和节点分类，其中许多现在在向量搜索或基于转换器的 GPT 等大型语言模型等领域得到应用。

我经常说，在现实世界中，根本不存在孤立的事物；一切事物都是相互联系的——人物、事件、设备、内容与产品、艺术、历史、政治、市场、生物途径以及气候临界点，从最小的亚原子粒子（关系量子动力学）到宇宙中最大的结构（星系途径）。人类通过添加信息技术、互联网、社交网络、移动计算、物联网以及机器学习模型的广泛应用，加速了这些联系的数量和密度。我们的生活依赖于所有这些网络的正常运作，即使我们大多数时候对此浑然不觉。一个人如何理解所有这些明显和隐藏的关系，它们为所有单个数据点提供了上下文和意义？当然，你可以查询已知模式的模式，但未知未知的事物怎么办？这正是图分析和基于图的机器学习技术大放异彩的地方。它们帮助你找到所需的洞察力。我们从中心性或聚类算法开始，如 PageRank 或 Louvain，这些算法可以用于无监督学习关于你数据中元素的结构和重要性。我最喜欢的例子仍然是 Andrew Beveridge 的《权力的游戏》网络，他在《权力的游戏》书籍的自然语言处理文本中使用了角色的空间接近性来确定重要性、群体和依赖关系。这些算法实现了与人类阅读书籍时发现的结果惊人地相似的结果。使用这些算法的结果作为你的机器学习模型中的特征向量，已经提高了你预测的准确性，因为它们在结构和行为上捕捉了你的实体的上下文。但你甚至可以更进一步，基于图操作显式地计算节点的嵌入。这个领域中的第一个算法之一是 node2vec，它使用了从起点（一个与 PageRank 概念上相似的方法）出发的随机游走路径上的 word2vec 嵌入。现在，我们已经取得了长足的进步，知识图谱嵌入使用图作为输入和输出，可以真正利用连接数据的丰富性。在当前的机器学习论文和架构中，你经常会看到关于图结构和算法的提及，因此这现在是一种基础技术。Tomaž将带你开始学习之旅，从数据建模、摄取和查询开始；到图算法的第一个应用；再到使用自然语言处理从文本中提取知识图谱；最后，在机器学习训练应用中利用节点和图的嵌入。享受这次通往图灵顿启示的旅程，我希望你最终会成为一个图迷，就像我们所有人一样。  

Michael Hunger，Neo4j 用户创新高级总监

## 前言

大约七年前，我在职业道路上转向软件开发。仿佛宇宙为我安排了计划，我在第一份开发工作中被温柔地推向了图（graphs）。我可能是少数几个能声称 Cypher 查询语言是他们第一次接触并开始使用的语言的人，甚至在 SQL 或任何脚本语言（如 Python）之前。当时我的老板 Kristjan Pećanac 预见到了图，尤其是带标签属性的图，是未来的趋势。

当时，市场上并没有很多本地的图数据库，所以 Neo4j 看起来是一个明确的选择。我对图和 Neo4j 了解得越多，就越喜欢它们。然而，有一件事相当明显。尽管我可以用图做很多酷的事情，但文档可以做得更好。我开始写博客，展示人们可以用图做哪些令人瞩目的事情，并省去人们在网上和源代码中搜索如何实现各种功能和工作流程的努力。此外，我把博客当作一个代码库，我可以将其用于我的项目并复制其中的代码。

快进五年：在发表了超过 70 篇博客文章之后，我写了一篇关于结合自然语言处理和图的博客。这可能是我迄今为止最好的博客，有趣的是，我在摘要中写道，如果我有机会写一本书，那篇文章将成为其中的一章。生活是幸运巧合的结合。Michael Hunger 阅读了我的 NLP 博客，并问我是否认真考虑过写一本书。我半开玩笑地回答说，写一本书可能是个好主意，并且有助于我在职业生涯中取得进步。Michael 认真对待了这件事，我们下个月与 Manning 见面。剩下的就是历史，你面前的这本书是我为了使图和图数据科学更容易学习、理解和在你的项目中实现而进行旅程的结果。

## 致谢

起初，我没有意识到写一本书需要多少工作量。在写完这本书之后，我对任何出版过书籍的作者都产生了相当大的尊重。幸运的是，我周围有伟大的人，他们通过他们的想法、评论和反馈帮助改进了这本书。

首先，我要感谢 Manning 出版社的开发编辑 Dustin Archibald，他帮助我成为一名更好的作家，并引导我接触和了解许多使一本好书更加出色的概念。也要感谢我的项目编辑 Deirdre Hiam，我的校对编辑 Christian Berk，我的校对员 Katie Tennant，以及我的审稿编辑 Aleksandar Dragosavljević。我还要感谢以下这些人在不同程度上提供了他们的想法并帮助审稿：Ljubica Lazarevic，Gopi Krishna Phani Dathar，David Allen，Charles Tapley Hoyt，Pere-Lluís Huguet Cabot，Amy Hodler，Vlad Batushkov，Jaglan Gaurav，Megan Tomlin，Al Krinker，Andrea Paciolla，Atilla Ozgur，Avinash Tiwari，Carl Yu，Chris Allan，Clair Sullivan，Daivid Morgan，Dinesh Ghanta，Hakan Lofquist，Ian Long，Ioannis Atsonios，Jan Pieter Herweijer，Karthik Rajan，Katie Roberts，Lokesh Kumar，Marcin Sȩk，Mark Needham，Mike Fowler，Ninoslav Cerkez，Pethuru Raj，Philip Patterson，Prasad Seemakurthi，Richard Tobias，Sergio Govoni，Simone Sguazza，Subhash Talluri，Sumit Pal，Syed Nouman Hasany，Thomas Joseph Heiman，Tim Wooldridge，Tom Kelly，Viron Dadala，以及 Yogesh Kulkarni。我还要感谢 Jerry Kuch 和 Arturo Geigel，他们的宝贵技术评论是无价的。Arturo 是一位来自波多黎各的独立研究员。他在 Nova Southeastern 大学获得了计算机科学博士学位，因发明神经木马而闻名，目前从事机器学习、图论和技术分析的研究。

## 关于这本书

《数据科学中的图算法》这本书是为了帮助你将图分析工具包融入你的分析工作流程而编写的。这本书背后的想法是，从一个以前从未听说过图的人开始，引导他们了解他们的第一个图模型和图聚合，最终到达更高级的图和机器学习工作流程，如节点分类和链接预测。

### 谁应该阅读这本书

《数据科学中的图算法》旨在帮助那些希望通过结合图算法来探索数据点之间关系的数据分析师和开发者扩展他们的数据分析工具集。这本书非常适合那些对 Python 和机器学习概念（如分类模型）有基本理解，并渴望增强他们的数据分析能力的人。凭借其结构化的方法，这本书适合广泛的读者，帮助初级分析师在图算法方面打下坚实的基础，同时也为经验丰富的分析师提供新的视角和高级技术，从而拓宽他们的数据科学能力。

### 这本书的组织结构

本书分为 3 个部分，共 12 章。第一部分介绍了图，并引导你完成一个图建模任务：

+   第一章介绍了图的概念以及如何识别图形问题。它还介绍了你将在整本书中学到的图算法类型。

+   第二章首先介绍了你可以用来描述图的基图形术语。然后，它继续介绍一个带标签属性图模型，并引导你完成一个图建模任务。

第二部分介绍了 Cypher 查询语言和常用的图算法：

+   第三章涵盖了基本的 Cypher 查询语言语法和子句。它还演示了如何从 CSV 文件中导入图。

+   第四章引导你进行探索性图分析。你将学习如何使用 Cypher 查询语言检索、过滤和聚合数据。

+   第五章演示了如何使用 Cypher 查询语言和图算法来表征图。它还展示了如何使用 PageRank 算法找到最重要的节点。

+   第六章说明了如何将数据点之间的间接关系转换为直接关系，这可以用作图算法的输入。此外，它还介绍了某些图算法的加权变体，如节点度和 PageRank。

+   第七章展示了如何投影一个共现网络，其中一对节点之间的共同邻居数量定义了它们之间的相似程度。

+   第八章演示了如何使用各种特征和指标来表征网络中的节点角色。在章节的后面部分，你将学习如何构建一个 k-最近邻图，并找到具有相似角色的节点社区。

第三部分涵盖了更高级的图机器学习工作流程，例如节点分类和链接预测：

+   第九章介绍了节点嵌入模型，并引导你完成一个节点分类任务。

+   第十章引导你进行链接预测任务，你将使用 Cypher 查询语言提取相关特征，并使用它们来训练一个链接预测模型。

+   第十一章涵盖了简单图与复杂图中链接预测的区别，并介绍了知识图谱嵌入模型，这些模型可以用于预测复杂网络中的链接。

+   第十二章展示了如何使用自然语言处理技术，如命名实体识别和关系提取，来构建图。

总体来说，前两章介绍了基本的图理论和术语，同时讨论了将在第 3-8 章中使用的 Twitter 图模型。第三章和第四章旨在使你熟悉 Cypher 查询语言。接下来的章节被设计为单独的分析员作业，在需要时介绍相关的图算法。

### 关于代码

本书包含许多源代码示例，既有编号列表，也有与普通文本并行的代码。在这两种情况下，源代码都使用`固定宽度字体`如这样来格式化，以将其与普通文本区分开来。有时代码也会被**加粗**以突出显示与章节中先前步骤相比已更改的代码，例如当新功能添加到现有代码行时。在许多情况下，原始源代码已被重新格式化；我们添加了换行并重新整理缩进以适应书中的可用页面空间。在极少数情况下，即使这样也不够，列表中还包括行续续标记（➥）。此外，当代码在文本中描述时，源代码中的注释通常也会从列表中删除。代码注释伴随着许多列表，突出显示重要概念。

第三章至第八章的源代码仅作为本书的一部分提供，而第九章至第十二章的源代码则以 Jupyter 笔记本的形式提供在此 GitHub 仓库中：[`github.com/tomasonjo/graphs-network-science`](https://github.com/tomasonjo/graphs-network-science)。

### liveBook 讨论论坛

购买《数据科学中的图算法》包括免费访问 liveBook，Manning 的在线阅读平台。使用 liveBook 的独特讨论功能，您可以在全球范围内或针对特定章节或段落附加评论。为自己做笔记、提问和回答技术问题以及从作者和其他用户那里获得帮助都非常简单。要访问论坛，请访问[`livebook.manning.com/book/graph-algorithms-for-data-science/discussion`](https://livebook.manning.com/book/graph-algorithms-for-data-science/discussion)。您还可以在[`livebook.manning.com/discussion`](https://livebook.manning.com/discussion)了解更多关于 Manning 论坛和行为准则的信息。

Manning 对我们读者的承诺是提供一个场所，在那里个人读者之间以及读者与作者之间可以进行有意义的对话。这不是对作者参与特定数量承诺的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您尝试向他提出一些挑战性的问题，以免他的兴趣转移！只要本书有售，论坛和先前讨论的存档将从出版社的网站提供。

## 关于作者

托马什·布拉塔尼奇是一位内心深处热爱网络科学的科学家，他的工作领域在图和机器学习交叉点上。他已经将这些图技术应用于各个领域的项目，包括欺诈检测、生物医学、面向商业的分析和推荐。

## 关于封面插图

《数据科学中的图算法》封面上的图像是“利马女人”或“利马女性”，取自雅克·格拉塞·德·圣索沃尔的作品集，该作品集于 1797 年出版。每一幅插图都是手工精细绘制和着色的。

在那些日子里，仅凭人们的服饰就能轻易识别他们居住的地方以及他们的职业或社会地位。曼宁通过基于几个世纪前丰富多样的地域文化的书封面，庆祝计算机行业的创新精神和主动性，这些文化通过如这一系列图片的收藏得以重现。
