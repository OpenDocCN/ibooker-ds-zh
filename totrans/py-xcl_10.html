<html><head></head><body>
<p id="filepos863345" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Chapter 7. Excel File Manipulation with pandas</span></span></span></p><p class="calibre_16">After six chapters of intense introductions to tools, Python, and pandas, I will give you a break and start this chapter with a practical case study that allows you to put your newly acquired skills to good use: with just ten lines of pandas code, you will consolidate dozens of Excel files into an Excel report, ready to be sent to your managers. After the case study, I’ll give you a more in-depth introduction to the tools that pandas offers to work with Excel files: the <tt class="calibre6">read_excel</tt> function and the <tt class="calibre6">ExcelFile</tt> class for reading, and the <tt class="calibre6">to_excel</tt> method and the <tt class="calibre6">ExcelWriter</tt> class for writing Excel files. pandas does not rely on the Excel application to read and write Excel files, which means that all code samples in this chapter run everywhere Python runs, including Linux.</p><p id="filepos864355" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Case Study: Excel Reporting</span></span></span></p><p class="calibre_6">This <a id="filepos864531"/>case study is inspired by a few real-world reporting projects I was involved in over the last few years. Even though the projects took place in completely different industries—including telecommunication, digital marketing, and finance—they were still remarkably similar: the starting point is usually a directory with Excel files that need to be processed into an Excel report—often on a monthly, weekly, or daily basis. In the companion repository, in the <span class="italic">sales_data</span> directory, you will find Excel files with fictitious sales transactions for a telecommunication provider selling different plans (Bronze, Silver, Gold) in a few stores throughout the United States. For every month, there are two files, one in the <span class="italic">new</span> subfolder for new contracts and one in the <span class="italic">existing</span> subfolder for existing customers. As the reports come from different systems, they come in different formats: the new customers are delivered as <span class="italic">xlsx</span> files, while the existing customers arrive in the older <span class="italic">xls</span> format. Each of the files has up to 10,000 transactions, and our goal is to produce an Excel report that shows the total sales per store and month. To get started, let’s have a look at the <span class="italic">January.xlsx</span> file from the <span class="italic">new</span> subfolder in <a href="#filepos865924"><span class="calibre_7">Figure 7-1</span></a>.</p><p class="calibre_21"><img src="images/00080.jpg" id="filepos865924" class="calibre_81"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 7-1. The first few rows of January.xlsx</span></span></span></p><p class="calibre_24">The Excel files in the <span class="italic">existing</span> subfolder look practically the same, except that they are missing the <tt class="calibre6">status</tt> column and are stored in the legacy <span class="italic">xls</span> format. As a first step, let’s read the new transactions from January <a id="filepos866436"/>with pandas’ <tt class="calibre6">read_excel</tt> function:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"sales_data/new/January.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">info</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">&lt;class 'pandas.core.frame.DataFrame'&gt;<br class="calibre1"/>RangeIndex: 9493 entries, 0 to 9492<br class="calibre1"/>Data columns (total 7 columns):<br class="calibre1"/> #   Column            Non-Null Count  Dtype<br class="calibre1"/>---  ------            --------------  -----<br class="calibre1"/> 0   transaction_id    9493 non-null   object<br class="calibre1"/> 1   store             9493 non-null   object<br class="calibre1"/> 2   status            9493 non-null   object<br class="calibre1"/> 3   transaction_date  9493 non-null   datetime64[ns]<br class="calibre1"/> 4   plan              9493 non-null   object<br class="calibre1"/> 5   contract_type     9493 non-null   object<br class="calibre1"/> 6   amount            9493 non-null   float64<br class="calibre1"/>dtypes: datetime64[ns](1), float64(1), object(5)<br class="calibre1"/>memory usage: 519.3+ KB</tt></span></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">THE READ_EXCEL FUNCTION WITH PYTHON 3.9</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">This is the same warning as in </span><a href="index_split_015.html#filepos482650"><span class="calibre5"><span class="calibre_7">Chapter 5</span></span></a><span class="calibre5">: if you are running </span><span class="calibre5"><tt class="calibre6">pd.read_excel</tt></span><span class="calibre5"> with Python 3.9 or above, make sure to use at least pandas 1.2 or you will get an error when reading </span><span class="calibre5"><span class="italic">xlsx</span></span><span class="calibre5"> files.</span></blockquote><p class="calibre_16">As you can see, pandas has properly recognized the data types of all columns, including the date format of <tt class="calibre6">transaction_date</tt>. This allows us to work with the data without further preparation. As this sample is deliberately simple, we can move on with creating a short script called <span class="italic">sales_report_pandas.py</span> as shown in <a href="#filepos871029"><span class="calibre_7">Example 7-1</span></a>. This script will read in all Excel files from both directories, aggregate the data, and write the summary table into a new Excel file. Use VS Code to write the script yourself, or open it from the companion repository. For a refresher on how to create or open files in VS Code, have another look at <a href="index_split_008.html#filepos96824"><span class="calibre_7">Chapter 2</span></a>. If you create it yourself, make sure to place it next to the <span class="italic">sales_data</span> folder—this will allow you to run the script without having to adjust any<a id="filepos871006"/> file paths.</p><p id="filepos871029" class="calibre_6"><span class="italic">Example 7-1. sales_report_pandas.py</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pathlib</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Path</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Directory of this file</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">this_dir</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Path</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6">__file__</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">resolve</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">parent</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Read in all Excel files from all subfolders of sales_data</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">parts</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">for</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">path</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">this_dir</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">/</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"sales_data"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">rglob</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"*.xls*"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00039.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">'Reading {path.name}'</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">part</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">path</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index_col</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"transaction_id"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">parts</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">append</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">part</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Combine the DataFrames from each file into a single DataFrame</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># pandas takes care of properly aligning the columns</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">concat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">parts</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Pivot each store into a column and sum up all transactions per date</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pivot</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pivot_table</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                       </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"transaction_date"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">columns</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"store"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                       </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">values</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"amount"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">aggfunc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"sum"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Resample to end of month and assign an index name</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">summary</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pivot</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">resample</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"M"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sum</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">summary</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Month"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Write summary report to Excel file</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">summary</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">to_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">this_dir</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">/</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"sales_report_pandas.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></p><p class="calibre_32"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">Up to this chapter, I was using strings to specify file paths. By using the <tt class="calibre6">Path</tt> class from the standard library’s <tt class="calibre6">pathlib</tt> module instead, you get access to a powerful set of tools: path objects enable you to easily construct paths by concatenating individual parts via forward slashes, as it’s done four lines below with <tt class="calibre6">this_dir / "sales_data"</tt>. These paths work across platforms and allow you to apply filters like <tt class="calibre6">rglob</tt> as explained under the next point. <tt class="calibre6">__file__</tt> resolves to the path of the source code file when you run it—using its <tt class="calibre6">parent</tt> will give you therefore the name of the directory of this file. The <tt class="calibre6">resolve</tt> method that we use before calling <tt class="calibre6">parent</tt> turns the path into an absolute path. If you would run this from a Jupyter notebook instead, you would have to replace this line with <tt class="calibre6">this_dir = Path(".").resolve()</tt>, with the dot representing the current directory. In most cases, functions and classes that accept a path in the form of a string also accept a path object.</blockquote><a id="filepos882885"/></blockquote><p class="calibre_20"><img src="images/00039.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The easiest way to read in all Excel files recursively from within a certain directory is to use the <tt class="calibre6">rglob</tt> method of the path object. <tt class="calibre6">glob</tt> is short for <span class="italic">globbing</span>, which refers to pathname expansion using wildcards. The <tt class="calibre6">?</tt> wildcard represents exactly one character, while <tt class="calibre6">*</tt> stands for any number of characters (including zero). The <span class="italic">r</span> in <tt class="calibre6">rglob</tt> means <span class="italic">recursive</span> globbing, i.e., it will look for matching files across all subdirectories—accordingly, <tt class="calibre6">glob</tt> would ignore subdirectories. Using <tt class="calibre6">*.xls*</tt> as the globbing expression makes sure that the old and new Excel files are found, as it matches both <tt class="calibre6">.xls</tt> and <tt class="calibre6">.xlsx</tt>. It’s usually a good idea to slightly enhance the expression like this: <tt class="calibre6">[!~$]*.xls*</tt>. This ignores temporary Excel files (their file name starts with <tt class="calibre6">~$</tt>). For more background on how to use globbing in Python, see the <a href="https://oreil.ly/fY0qG"><span class="calibre_7">Python docs</span></a>.</blockquote><a id="filepos884117"/></blockquote><p class="calibre_16">Run the script, for example, by clicking the Run File button at the top right of VS Code. The script will take a moment to complete and once done, the Excel workbook <span class="italic">sales_report_pandas.xlsx</span> will show up in the same directory as the script. The content of Sheet1 should look like in <a href="#filepos884738"><span class="calibre_7">Figure 7-2</span></a>. That’s quite an impressive result for only ten lines of code—even if you will need to adjust the width of the first column to be able to see the dates!</p><p class="calibre_21"><img src="images/00005.jpg" id="filepos884738" class="calibre_82"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 7-2. sales_report_pandas.xlsx (as-is, without adjusting any column width)</span></span></span></p><p class="calibre_24">For simple cases like this one, pandas offers a really easy solution to work with Excel files. However, we can do much better—after all, a title, some formatting (including column width and a consistent number of decimals), and a chart wouldn’t hurt. That’s exactly what we will take care of in the next chapter by directly using the writer libraries that pandas uses under the hood. Before we get there, however, let’s have a more detailed look at how we can read and<a id="filepos885516"/> write Excel files with pandas.</p><p id="filepos885558" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Reading and Writing Excel Files with pandas</span></span></span></p><p class="calibre_6">The case study was using <tt class="calibre6">read_excel</tt> and <tt class="calibre6">to_excel</tt> with their default arguments to keep things simple. In this section, I will show you the most commonly used arguments and options when reading and writing Excel files with pandas. We’ll start with the <tt class="calibre6">read_excel</tt> function and the <tt class="calibre6">ExcelFile</tt> class before looking at the <tt class="calibre6">to_excel</tt> method and the <tt class="calibre6">ExcelWriter</tt> class. Along the way, I’ll also introduce Python’s <tt class="calibre6">with</tt> statement.</p><p id="filepos886236" class="calibre_17"><span class="calibre3"><span class="bold">The read_excel Function and ExcelFile Class</span></span></p><p class="calibre_6">The <a id="filepos886398"/>case study used Excel workbooks where the data was conveniently in cell A1 of the first sheet. In reality, your Excel files are probably not so well organized. In this case, pandas offers parameters to fine-tune the reading process. For the next few samples, we’re going to use the <span class="italic">stores.xlsx</span> file that you will find in the <span class="italic">xl</span> folder of the companion repository. The first sheet is shown in <a href="#filepos886927"><span class="calibre_7">Figure 7-3</span></a>.</p><p class="calibre_21"><img src="images/00012.jpg" id="filepos886927" class="calibre_83"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 7-3. The first sheet of stores.xlsx</span></span></span></p><p class="calibre_24">By using the parameters <tt class="calibre6">sheet_name</tt>, <tt class="calibre6">skiprows</tt>, and <tt class="calibre6">usecols</tt>, we can tell pandas about the cell range that we want to read in. As usual, it’s a good idea to have a look at the data types of the returned DataFrame by running <a id="filepos887441"/>the <tt class="calibre6">info</tt> method:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2019"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B:F"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[3]:            Store  Employees    Manager      Since Flagship<br class="calibre1"/>        0       New York         10      Sarah 2018-07-20    False<br class="calibre1"/>        1  San Francisco         12     Neriah 2019-11-02  MISSING<br class="calibre1"/>        2        Chicago          4    Katelin 2020-01-31      NaN<br class="calibre1"/>        3         Boston          5  Georgiana 2017-04-01     True<br class="calibre1"/>        4  Washington DC          3       Evan        NaT    False<br class="calibre1"/>        5      Las Vegas         11       Paul 2020-01-06    False</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">info</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">&lt;class 'pandas.core.frame.DataFrame'&gt;<br class="calibre1"/>RangeIndex: 6 entries, 0 to 5<br class="calibre1"/>Data columns (total 5 columns):<br class="calibre1"/> #   Column     Non-Null Count  Dtype<br class="calibre1"/>---  ------     --------------  -----<br class="calibre1"/> 0   Store      6 non-null      object<br class="calibre1"/> 1   Employees  6 non-null      int64<br class="calibre1"/> 2   Manager    6 non-null      object<br class="calibre1"/> 3   Since      5 non-null      datetime64[ns]<br class="calibre1"/> 4   Flagship   5 non-null      object<br class="calibre1"/>dtypes: datetime64[ns](1), int64(1), object(3)<br class="calibre1"/>memory usage: 368.0+ bytes</tt></span></blockquote><p class="calibre_32">Everything looks good except for the <tt class="calibre6">Flagship</tt> column—its data type should be <tt class="calibre6">bool</tt> rather than <tt class="calibre6">object</tt>. To fix this, we <a id="filepos891785"/>can provide a converter function that deals with the offensive cells in that column (instead of writing the <tt class="calibre6">fix_missing</tt> function, we could have also provided a lambda expression instead):</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">fix_missing</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">False</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">""</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"MISSING"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">else</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">6</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2019"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B:F"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">converters</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">{</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Flagship"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">fix_missing</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">})</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[6]:            Store  Employees    Manager      Since  Flagship<br class="calibre1"/>        0       New York         10      Sarah 2018-07-20     False<br class="calibre1"/>        1  San Francisco         12     Neriah 2019-11-02     False<br class="calibre1"/>        2        Chicago          4    Katelin 2020-01-31     False<br class="calibre1"/>        3         Boston          5  Georgiana 2017-04-01      True<br class="calibre1"/>        4  Washington DC          3       Evan        NaT     False<br class="calibre1"/>        5      Las Vegas         11       Paul 2020-01-06     False</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">7</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># The Flagship column now has Dtype "bool"</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">info</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">&lt;class 'pandas.core.frame.DataFrame'&gt;<br class="calibre1"/>RangeIndex: 6 entries, 0 to 5<br class="calibre1"/>Data columns (total 5 columns):<br class="calibre1"/> #   Column     Non-Null Count  Dtype<br class="calibre1"/>---  ------     --------------  -----<br class="calibre1"/> 0   Store      6 non-null      object<br class="calibre1"/> 1   Employees  6 non-null      int64<br class="calibre1"/> 2   Manager    6 non-null      object<br class="calibre1"/> 3   Since      5 non-null      datetime64[ns]<br class="calibre1"/> 4   Flagship   6 non-null      bool<br class="calibre1"/>dtypes: bool(1), datetime64[ns](1), int64(1), object(2)<br class="calibre1"/>memory usage: 326.0+ bytes</tt></span></blockquote><p class="calibre_32">The <tt class="calibre6">read_excel</tt> function also accepts a list of sheet names. In this case, it returns a dictionary with the DataFrame as value and the name of the sheet as key. To read in all sheets, you would need to provide <tt class="calibre6">sheet_name=None</tt>. Also, note the slight variation of how I am using <tt class="calibre6">usecols</tt> by providing the column names of the table:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">8</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheets</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2019"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2020"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">],</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                               </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Store"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Employees"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">])</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheets</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2019"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">head</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[8]:            Store  Employees<br class="calibre1"/>        0       New York         10<br class="calibre1"/>        1  San Francisco         12</tt></span></blockquote><p class="calibre_32">If the source file doesn’t have column headers, set <tt class="calibre6">header=None</tt> and provide them via <tt class="calibre6">names</tt>. Note that <tt class="calibre6">sheet_name</tt> also accepts sheet indices:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">9</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skipfooter</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B:C,F"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">header</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">names</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Branch"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Employee_Count"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Is_Flagship"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">])</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[9]:           Branch  Employee_Count Is_Flagship<br class="calibre1"/>        0       New York              10       False<br class="calibre1"/>        1  San Francisco              12     MISSING<br class="calibre1"/>        2        Chicago               4         NaN</tt></span></blockquote><p class="calibre_32">To handle <tt class="calibre6">NaN</tt> values,<a id="filepos906409"/> use a combination of <tt class="calibre6">na_values</tt> and <tt class="calibre6">keep_default_na</tt>. The next sample tells pandas to only interpret cells with the word <tt class="calibre6">MISSING</tt> as <tt class="calibre6">NaN</tt> and nothing else:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2019"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                            </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B,C,F"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skipfooter</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                            </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">na_values</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"MISSING"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">keep_default_na</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">False</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[10]:            Store  Employees Flagship<br class="calibre1"/>         0       New York         10    False<br class="calibre1"/>         1  San Francisco         12      NaN<br class="calibre1"/>         2        Chicago          4<br class="calibre1"/>         3         Boston          5     True</tt></span></blockquote><p class="calibre_32">pandas offers an alternative way to read Excel files by using the <tt class="calibre6">ExcelFile</tt> class. This mostly makes a difference if you want to read in multiple sheets from a file in the legacy <span class="italic">xls</span> format: in this case, using <tt class="calibre6">ExcelFile</tt> will be faster as it prevents pandas from reading in the whole file multiple times. <tt class="calibre6">ExcelFile</tt> can be used as a context manager (see sidebar) so the file is properly closed again.</p><blockquote id="filepos910476" class="calibre_39"><span class="bold">CONTEXT MANAGERS AND THE WITH STATEMENT</span></blockquote><blockquote class="calibre_27">First of all, <a id="filepos910651"/>the <tt class="calibre6">with</tt> statement in Python doesn’t have anything to do with the <tt class="calibre6">With</tt> statement in VBA: in VBA, it is used to run a series of statements on the same object, while in Python, it is used to manage resources like files or database connections. If you want to load the latest sales data to be able to analyze it, you may have to open a file or establish a connection to a database. After you’re done reading the data, it’s best practice to close the file or connection as soon as possible again. Otherwise, you may run into situations where you can’t open another file or can’t establish another connection to the database—file handlers and database connections are limited resources. Opening and closing a text file manually works like this (<tt class="calibre6">w</tt> stands for opening the file in <tt class="calibre6">write</tt> mode, which replaces the file if it already exists):</blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">11</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">open</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"output.txt"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"w"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">write</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Some text"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">close</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31">Running this code will create a file called <span class="italic">output.txt</span> in the same directory as the notebook you are running it from and write “some text” to it. To <span class="italic">read</span> a file, you would use <tt class="calibre6">r</tt> instead of <tt class="calibre6">w</tt>, and to <span class="italic">append</span> to the end of the file, use <tt class="calibre6">a</tt>. Since files can also be manipulated from outside of your program, such an operation could fail. You could handle this by using the try/except mechanism that I will introduce in <a href="index_split_027.html#filepos1487255"><span class="calibre_7">Chapter 11</span></a>. However, since this is such a common operation, Python is providing the <tt class="calibre6">with</tt> statement to make things easier:</blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">12</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">with</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">open</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"output.txt"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"w"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">write</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Some text"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31">When code execution leaves the body of the <tt class="calibre6">with</tt> statement, the file is automatically closed, whether or not there is an exception happening. This guarantees that the resources are properly cleaned up. Objects that support the <tt class="calibre6">with</tt> statement are called <span class="italic">context managers</span>; this includes the <tt class="calibre6">ExcelFile</tt> and <tt class="calibre6">ExcelWriter</tt> objects in this chapter, as well as database connection objects that we will look at in <a href="index_split_027.html#filepos1487255"><span class="calibre_7">Chapter 11</span></a>.</blockquote><p class="calibre_17">Let’s see the <tt class="calibre6">ExcelFile</tt> class in action:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">13</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">with</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">ExcelFile</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xls"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df1</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2019"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B:F"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">nrows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"2020"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B:F"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">nrows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df1</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[13]:            Store  Employees Manager      Since Flagship<br class="calibre1"/>         0       New York         10   Sarah 2018-07-20    False<br class="calibre1"/>         1  San Francisco         12  Neriah 2019-11-02  MISSING</tt></span></blockquote><p class="calibre_32"><tt class="calibre6">ExcelFile</tt> also gives you access to the names of all sheets:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">14</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">stores</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">ExcelFile</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">stores</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_names</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[14]: ['2019', '2020', '2019-2020']</tt></span></blockquote><p class="calibre_32">Finally, pandas allows you to read Excel files<a id="filepos922687"/> from a URL, similar to how we did it with CSV files in <a href="index_split_015.html#filepos482650"><span class="calibre_7">Chapter 5</span></a>. Let’s read it directly from the companion repo:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">15</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">url</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"https://raw.githubusercontent.com/fzumstein/"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"python-for-excel/1st-edition/xl/stores.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">url</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">skiprows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">usecols</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"B:E"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">nrows</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[15]:            Store  Employees Manager      Since<br class="calibre1"/>         0       New York         10   Sarah 2018-07-20<br class="calibre1"/>         1  San Francisco         12  Neriah 2019-11-02</tt></span></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">READING XLSB FILES VIA PANDAS</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">If you use pandas with a version below 1.3, reading </span><a id="filepos925712"/><span class="calibre5"><span class="italic">xlsb</span></span><span class="calibre5"> files requires you to explicitly specify the engine in the </span><span class="calibre5"><tt class="calibre6">read_excel</tt></span><span class="calibre5"> function or </span><span class="calibre5"><tt class="calibre6">ExcelFile</tt></span><span class="calibre5"> class:</span></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">read_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"xl/stores.xlsb"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">engine</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"pyxlsb"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote></blockquote><blockquote class="calibre_31"><span class="calibre5">This requires the pyxlsb package to be installed, as it isn’t part of Anaconda—we’ll get to that as well as to the other engines in the next chapter.</span><a id="filepos926988"/></blockquote><p class="calibre_16">To summarize, <a href="#filepos927326"><span class="calibre_7">Table 7-1</span></a> shows you the most commonly used <tt class="calibre6">read_excel</tt> parameters. You will find the complete list in the <a href="https://oreil.ly/v8Yes"><span class="calibre_7">official docs</span></a>.</p><p class="calibre1" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" id="filepos927326" class="calibre_47"><caption valign="top" class="calibre_48"><span class="italic">Table 7-1. Selected parameters for read_excel</span></caption><tr valign="top" class="calibre_49"><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Parameter </span></span><span class="bold">
</span></th><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Description </span></span><span class="bold">
</span></th></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">sheet_name</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Instead of providing a sheet name, you could also provide the index of the sheet (zero-based), e.g.,  </span><span class="calibre5"><tt class="calibre6">sheet_name=0</tt></span><span class="calibre5">. If you set </span><span class="calibre5"><tt class="calibre6">sheet_name=None</tt></span><span class="calibre5">, pandas will read the whole workbook and return a dictionary in the form of </span><span class="calibre5"><tt class="calibre6">{"sheetname": df}</tt></span><span class="calibre5">. To read a selection of sheets, provide a list with sheet names or indices.</span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">skiprows</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">This allows you to skip over the indicated number of rows. </span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">usecols</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">If the Excel file includes the names of the column headers, provide them in a list to select the columns, e.g.,  </span><span class="calibre5"><tt class="calibre6">["Store", "Employees"]</tt></span><span class="calibre5">. Alternatively, it can also be a list of column indices, e.g., </span><span class="calibre5"><tt class="calibre6">[1, 2]</tt></span><span class="calibre5">, or a string (not a list!) of Excel column names, including ranges, e.g., </span><span class="calibre5"><tt class="calibre6">"B:D,G"</tt></span><span class="calibre5">. You can also provide a function: as an example, to only include the columns that start with </span><span class="calibre5"><tt class="calibre6">Manager</tt></span><span class="calibre5">, use: </span><span class="calibre5"><tt class="calibre6">usecols=lambda x: x.startswith("Manager")</tt></span><span class="calibre5">.</span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">nrows</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Number of rows you want to read. </span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">index_col</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Indicates which column should be the index, accepts a column name or an index, e.g.,  </span><span class="calibre5"><tt class="calibre6">index_col=0</tt></span><span class="calibre5">. If you provide a list with multiple columns, a hierarchical index will be created.</span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">header</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">If you set  </span><span class="calibre5"><tt class="calibre6">header=None</tt></span><span class="calibre5">, the default integer headers are assigned except if you provide the desired names via the </span><span class="calibre5"><tt class="calibre6">names</tt></span><span class="calibre5"> parameter. If you provide a list of indices, hierarchical column headers will be created.</span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">names</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Provide the desired names of your columns as list. </span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">na_values</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Pandas interprets the following cell values as  </span><span class="calibre5"><tt class="calibre6">NaN</tt></span><span class="calibre5"> by default (I introduced </span><span class="calibre5"><tt class="calibre6">NaN</tt></span><span class="calibre5"> in </span><a href="index_split_015.html#filepos482650"><span class="calibre5"><span class="calibre_7">Chapter 5</span></span></a><span class="calibre5">): empty cells, </span><span class="calibre5"><tt class="calibre6">#NA</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">NA</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">null</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">#N/A</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">N/A</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">NaN</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">n/a</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">-NaN</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">1.#IND</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">nan</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">#N/A N/A</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">-1.#QNAN</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">-nan</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">NULL</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">-1.#IND</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">&lt;NA&gt;</tt></span><span class="calibre5">, </span><span class="calibre5"><tt class="calibre6">1.#QNAN</tt></span><span class="calibre5">. If you’d like to add one or more values to that list, provide them via </span><span class="calibre5"><tt class="calibre6">na_values</tt></span><span class="calibre5">.</span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">keep_default_na</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">If you’d like to ignore the default values that pandas interprets as  </span><span class="calibre5"><tt class="calibre6">NaN</tt></span><span class="calibre5">, set </span><span class="calibre5"><tt class="calibre6">keep_default_na=False</tt></span><span class="calibre5">.</span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">convert_float</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Excel stores all numbers internally as floats and by default, pandas transforms numbers without meaningful decimals to integers. If you want to change that behavior, set  </span><span class="calibre5"><tt class="calibre6">convert_float=False</tt></span><span class="calibre5"> (this may be a bit faster).</span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">converters</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Allows you to provide a function per column to convert its values. For example, to make the text in a certain column uppercase, use the following:  </span><span class="calibre5"><tt class="calibre6">converters={"column_name": lambda x: x.upper()}</tt></span></p></td></tr></table><p class="calibre_17">So much for<a id="filepos935481"/> reading Excel files with pandas—let’s now switch sides and learn about writing Excel files in the next section!</p><p id="filepos935608" class="calibre_17"><span class="calibre3"><span class="bold">The to_excel Method and ExcelWriter Class</span></span></p><p class="calibre_6">The <a id="filepos935768"/>easiest way to write an Excel file with pandas is to use a DataFrame’s <tt class="calibre6">to_excel</tt> method. It allows you to specify to which cell of which sheet you want to write the DataFrame to. You can also decide whether or not to include the column headers and the index of the DataFrame and how to treat data types like <tt class="calibre6">np.nan</tt> and <tt class="calibre6">np.inf</tt> that don’t have an equivalent representation in Excel. Let’s start by creating a DataFrame with different data types and use its <tt class="calibre6">to_excel</tt> method:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">16</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">numpy</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">np</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">datetime</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">dt</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">17</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">data</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2020</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">13</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">),</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2.222</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">],</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>               </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2020</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">),</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">nan</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">False</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">],</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>               </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2020</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">),</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">inf</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">data</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">data</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">columns</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Dates"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Floats"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Integers"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Booleans"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">])</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"index"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[17]:                     Dates  Floats  Integers  Booleans<br class="calibre1"/>         index<br class="calibre1"/>         0     2020-01-01 10:13:00   2.222         1      True<br class="calibre1"/>         1     2020-01-02 00:00:00     NaN         2     False<br class="calibre1"/>         2     2020-01-02 00:00:00     inf         3      True</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">18</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">to_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"written_with_pandas.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Output"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                     </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">startrow</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">startcol</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">header</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                     </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">na_rep</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"&lt;NA&gt;"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">inf_rep</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"&lt;INF&gt;"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">Running the <tt class="calibre6">to_excel</tt> command will create the Excel file as shown in <a href="#filepos948095"><span class="calibre_7">Figure 7-4</span></a> (you will need to make column <tt class="calibre6">C</tt> wider to see the dates properly):</p><p class="calibre_21"><img src="images/00062.jpg" id="filepos948095" class="calibre_84"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 7-4. written_with_pandas.xlsx</span></span></span></p><p class="calibre_24">If you want to write multiple DataFrames to the same or different sheets, you will need to use the <tt class="calibre6">ExcelWriter</tt> class. The following sample writes the same DataFrame to two different locations on Sheet1 and one more time to Sheet2:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">19</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">with</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">ExcelWriter</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"written_with_pandas2.xlsx"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">writer</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">to_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">writer</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Sheet1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">startrow</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">startcol</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">to_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">writer</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Sheet1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">startrow</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">startcol</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">to_excel</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">writer</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet_name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Sheet2"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">Since we’re using the <tt class="calibre6">ExcelWriter</tt> class as a context manager, the file is automatically written to disk when it exits the context manager, i.e., when the indentation stops. Otherwise, you will have to call <tt class="calibre6">writer.save()</tt> explicitly. For a summary of the most commonly used parameters that <tt class="calibre6">to_excel</tt> accepts, have a look at <a href="#filepos953686"><span class="calibre_7">Table 7-2</span></a>. You will find the full list of <a id="filepos953568"/>parameters in the <a href="https://oreil.ly/ESKAG"><span class="calibre_7">official docs</span></a>.</p><p class="calibre1" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" id="filepos953686" class="calibre_47"><caption valign="top" class="calibre_48"><span class="italic">Table 7-2. Selected parameters for to_excel</span></caption><tr valign="top" class="calibre_49"><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Parameter </span></span><span class="bold">
</span></th><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Description </span></span><span class="bold">
</span></th></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">sheet_name</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Name of the sheet to write to. </span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">startrow</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">startcol</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">startrow</tt></span><span class="calibre5"> is the first row where the DataFrame will be written to and </span><span class="calibre5"><tt class="calibre6">startcol</tt></span><span class="calibre5"> is the first column. This uses zero-based indexing, so if you want to write your DataFrame into cell B3, use </span><span class="calibre5"><tt class="calibre6">startrow=2</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">startcol=1</tt></span><span class="calibre5">.</span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">index</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">header</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">If you want to hide the index and/or header, set them to  </span><span class="calibre5"><tt class="calibre6">index=False</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">header=False</tt></span><span class="calibre5">, respectively.</span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">na_rep</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">inf_rep</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">By default,  </span><span class="calibre5"><tt class="calibre6">np.nan</tt></span><span class="calibre5"> will be converted to an empty cell, while </span><span class="calibre5"><tt class="calibre6">np.inf</tt></span><span class="calibre5">, NumPy’s representation of infinity, will be converted to the string </span><span class="calibre5"><tt class="calibre6">inf</tt></span><span class="calibre5">. Providing values allows you to change this behavior.</span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">freeze_panes</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Freeze the first couple of rows and columns by supplying a tuple: for example  </span><span class="calibre5"><tt class="calibre6">(2, 1)</tt></span><span class="calibre5"> will freeze the first two rows and the first column.</span></p></td></tr></table><p class="calibre_17">As you can see, reading and writing simple Excel files with pandas works well. There are limitations, though—let’s see which ones!</p><p id="filepos957296" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></span></span></p><p class="calibre_6">Using the<a id="filepos957495"/> pandas interface to read and write Excel files works great for simple cases, but there are limits:</p><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">When writing DataFrames to files, you can’t include a title or a chart.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">There is no way to change the default format of the header and index in Excel.</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">When reading files, pandas automatically transforms cells with errors like <tt class="calibre6">#REF!</tt> or <tt class="calibre6">#NUM!</tt> into <tt class="calibre6">NaN</tt>, making it impossible to search for specific errors in your spreadsheets.</blockquote></blockquote></blockquote></blockquote></li><li value="4" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Working with big Excel files may require extra settings that are easier to control by using the reader and writer packages directly, as we will see in the next chapter.</blockquote></blockquote></blockquote></blockquote></li></ul><p id="filepos958961" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Conclusion</span></span></span></p><p class="calibre_6">The nice thing about pandas is that it offers a consistent interface to work with all supported Excel file formats, whether that’s <span class="italic">xls</span>, <span class="italic">xlsx</span>, <span class="italic">xlsm</span>, or <span class="italic">xlsb</span>. This made it easy for us to read a directory of Excel files, aggregate the data, and dump the summary into an Excel report—in only ten lines of code.</p><p class="calibre_6">pandas, however, doesn’t do the heavy lifting itself: under the hood, it selects a reader or writer package to do the job. In the next chapter, I will show you which reader and writer packages pandas uses and how you use them directly or in combination with pandas. This will allow us to work around the limitations we saw in the previous section.</p><div class="mbp_pagebreak" id="calibre_pb_16"/>
</body></html>