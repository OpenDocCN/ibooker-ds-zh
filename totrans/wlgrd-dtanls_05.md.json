["```py\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nsurvey = pd.read_csv(\"./data/survey_results_public.csv.gz\")\nprint(survey.shape)\nsurvey.head()\n```", "```py\nsurvey.isnull().sum()\n```", "```py\ndata_dict = pd.read_csv(\"./data/survey_results_schema.csv\")\ndata_dict.head(10)\n```", "```py\nlen(set(survey.columns).intersection(set(data_dict[\"qname\"])))\n```", "```py\nset(survey.columns) - set(data_dict[\"qname\"])\n```", "```py\ndata_dict[data_dict[\"force_resp\"] == True]\n```", "```py\nsurvey[survey[\"EdLevel\"].isnull()]\n```", "```py\nsurvey[survey[\"EdLevel\"].isnull()].isnull().sum(axis=1).sort_values()\n```", "```py\nsurvey = survey.dropna(subset=survey.columns[4:], how=\"all\")\n```", "```py\nsurvey.isnull().sum().loc[lambda x: x==0]\n```", "```py\nsurvey[survey[\"Currency\"].isnull()].isnull().sum(axis=1)\n```", "```py\nfig, axis = plt.subplots()\n\n(\n    survey[\"AISelect\"]\n    .value_counts(dropna=False)\n    .plot\n    .barh(ax=axis)\n)\n\naxis.set(title=\"Answers to the question:\\n'Do you currently\n↪ use AI tools in your development process?'\",\n         xlabel=\"Number of responses\")\n\nplt.show()\n```", "```py\nsurvey[\"AISent\"].value_counts(dropna=False)\n```", "```py\nsurvey[\"AISent\"] = (\n    pd.Categorical(\n        survey[\"AISent\"].fillna(\"No answer given\"),\n        categories=['No answer given', 'Unsure',\n                    'Very unfavorable', 'Unfavorable',\n                    'Indifferent', 'Favorable', 'Very favorable'],\n        ordered=True)\n)\n\nsurvey[\"AISent\"].value_counts(dropna=False).sort_index()\n```", "```py\npd.crosstab(\n    index=survey[\"AISelect\"],      #1\n    columns=survey[\"AISent\"]      #2\n)\n```", "```py\nfig, axis = plt.subplots()\n\nsns.heatmap(\n    data=pd.crosstab(\n        index=survey.loc[survey[\"AISelect\"]\n↪ != \"No, and I don't plan to\", \"AISelect\"],\n        columns=survey.loc[survey[\"AISelect\"]\n↪ != \"No, and I don't plan to\", \"AISent\"],\n        normalize=\"index\"\n    ),\n    cmap=\"Greys\",\n    vmin=0,\n    vmax=1,\n    square=True,\n    annot=True,\n    ax=axis\n)\n\nfig.suptitle(\"How favorably do different people view AI tools?\")\n\naxis.set(\n    xlabel=\"How favorable is your stance on using AI tools?\",\n    ylabel=\"Do you currently use AI tools?\"\n)\n\nplt.show()\n```", "```py\ndef create_heatmap(data, square=True):     #1\n    fig, axis = plt.subplots()\n\n    sns.heatmap(\n        data=data,\n        cmap=\"Greys\",\n        vmin=0,\n        vmax=1,\n        square=square,\n        annot=True,\n        ax=axis\n    )\n\n    return fig, axis     #2\n\nfig, axis = create_heatmap(\n    pd.crosstab(\n        index=survey.loc[survey[\"AISelect\"]\n↪ != \"No, and I don't plan to\", \"AISelect\"],\n        columns=survey.loc[survey[\"AISelect\"]\n↪ != \"No, and I don't plan to\", \"AISent\"],\n        normalize=\"index\"\n    )\n)\n\nfig.suptitle(\"How favorably do different people view AI tools?\")\n\naxis.set(\n    xlabel=\"How favorable is your stance on using AI tools?\",\n    ylabel=\"Do you currently use AI tools?\"\n)\n\nplt.show()\n```", "```py\nsurvey[\"AIBen\"] = (\n    pd.Categorical(\n        survey[\"AIBen\"].fillna(\"No answer given\"),\n        categories=['No answer given', 'Highly distrust',\n                    'Somewhat distrust', 'Neither trust nor distrust',\n                    'Somewhat trust', 'Highly trust'],\n        ordered=True\n    )\n)\n\nsurvey[\"AIBen\"].value_counts(dropna=False).sort_index()\n```", "```py\npd.crosstab(\n    index=survey[\"AISelect\"],\n    columns=survey[\"AIBen\"]\n)\n```", "```py\nfig, axis = create_heatmap(\n    pd.crosstab(\n        index=survey.loc[survey[\"AISelect\"]\n↪ != \"No, and I don't plan to\", \"AISelect\"],\n        columns=survey.loc[survey[\"AISelect\"]\n↪ != \"No, and I don't plan to\", \"AIBen\"],\n        normalize=\"index\"\n    )\n)\n\nfig.suptitle(\"How much do different people trust the output of AI tools?\")\n\naxis.set(\n  xlabel=\"How much do you trust the accuracy of the output from AI tools?\",\n  ylabel=\"Do you currently use AI tools?\"\n)\n\nplt.show()\n```", "```py\n(\n    survey.loc[survey[\"AISelect\"] == \"Yes\", \"AIToolCurrently Using\"]\n    .dropna()\n    .head(10)\n)\n```", "```py\nai_tool_indicators = (\n    survey.loc[survey[\"AISelect\"] == \"Yes\", \"AIToolCurrently Using\"]\n    .str.get_dummies(sep=\";\")\n)\nai_tool_indicators\n```", "```py\nai_tool_indicators.columns = [c.strip() for c in ai_tool_indicators.columns]\n```", "```py\nfig, axis = plt.subplots()\n\n(\n    ai_tool_indicators\n    .mean()\n    .sort_values()\n    .plot\n    .barh(ax=axis)\n)\n\naxis.set(\n    title=\"What are AI users using their AI tools for?\",\n    xlabel=\"% of users who ticked that option\"\n)\n\nplt.show()\n```", "```py\nsurvey_ai_users = (\n    pd.concat([survey, ai_tool_indicators], axis=1) #1\n    .dropna(subset=ai_tool_indicators.columns, how=\"any\")\n)\nassert len(survey[survey[\"AISelect\"] == \"Yes\"]) == len(survey_ai_users)\n\nsurvey_ai_users.head()\n```", "```py\n(\n    survey_ai_users[survey_ai_users[\"Collaborating with teammates\"] == 1]\n    .groupby(\"AISent\")\n    .size()\n    .reset_index(name=\"count\")\n    .assign(option=\"Collaborating with teammates\")\n)\n```", "```py\ntool_favorability_dfs = []\nfor col in ai_tool_indicators.columns:      #1\n    option_df = (\n        survey_ai_users[survey_ai_users[col] == 1]\n        .groupby(\"AISent\")\n        .size()\n        .reset_index(name=\"count\")\n        .assign(option=col)\n    )\n    tool_favorability_dfs.append(option_df)     #2\n\noptions_vs_favorability = pd.concat(     #3\n    tool_favorability_dfs,\n    axis=0,\n    ignore_index=True\n)\n\nprint(options_vs_favorability.shape)\n```", "```py\nfavorability_crosstab = (\n    pd.crosstab(index=options_vs_favorability[\"option\"],\n                columns=options_vs_favorability[\"AISent\"],\n                values=options_vs_favorability[\"count\"],\n                aggfunc=\"sum\",\n                normalize=\"index\")\n)\nfavorability_crosstab\n```", "```py\nfig, axis = create_heatmap(\n    favorability_crosstab.round(2)\n)\n\nfig.suptitle(\"How favorably do people who use AI for different purposes\n↪ view AI tools?\")\n\naxis.set(xlabel=None, ylabel=None)\n\nplt.show()\n```", "```py\ntool_trust_dfs = []\nfor col in ai_tool_indicators.columns:\n    option_df = (\n        survey_ai_users[survey_ai_users[col] == 1]\n        .groupby(\"AIBen\")\n        .size()\n        .reset_index(name=\"count\")\n        .assign(option=col)\n    )\n    tool_trust_dfs.append(option_df)\n\noptions_vs_trust = pd.concat(tool_trust_dfs, axis=0, ignore_index=True)\n\nprint(options_vs_trust.shape)\noptions_vs_trust.head()\n```", "```py\ntrust_crosstab = (\n    pd.crosstab(index=options_vs_trust[\"option\"],\n                columns=options_vs_trust[\"AIBen\"],\n                values=options_vs_trust[\"count\"],\n                aggfunc=\"sum\",\n                normalize=\"index\")\n)\n\nfig, axis = create_heatmap(\n    trust_crosstab.round(2)\n)\n\nfig.suptitle(\"How much do people who use AI for different purposes\n↪ trust the output of AI tools?\")\n\naxis.set(xlabel=None, ylabel=None)\n\nplt.show()\n```", "```py\nsurvey_ai_users['DevType'].value_counts(dropna=False)\n```", "```py\ndevtypes = (\n    survey_ai_users\n    .dropna(subset=[\"DevType\"])\n    .query(\"DevType.str.startswith('Developer')\")\n    .loc[:,\"DevType\"]\n)\n\ndevtypes.value_counts()\n```", "```py\ndevtype_map = {}\n\ndev_exclusions = [\"Developer Experience\", \"Developer Advocate\"]\n\ndev_devtypes = [col for col in devtypes.value_counts().index\n↪ if col not in dev_exclusions]\n\nfor col in dev_devtypes:\n    devtype_map[col] = \"Developer\"\n```", "```py\neng_devtypes = (\n    survey_ai_users\n    .dropna(subset=[\"DevType\"])\n    .query(\"DevType.str.contains('engineer', case=False)\")\n    .loc[:,\"DevType\"]\n)\n\neng_devtypes.value_counts()\n```", "```py\nfor col in ['Engineer, data', 'Cloud infrastructure engineer',\n            'Engineer, site reliability', 'Hardware Engineer']:\n    devtype_map[col] = \"Engineer\"\n\nsurvey_ai_users[\"job_category\"]\n↪ = survey_ai_users[\"DevType\"].replace(devtype_map)\n\nsurvey_ai_users[\"job_category\"].value_counts(dropna=False)\n```", "```py\ntool_job_dfs = []\n\nfor col in ai_tool_indicators.columns:      #1\n    option_df = (\n        survey_ai_users[survey_ai_users[col] == 1]\n        .dropna(subset=\"job_category\")\n        .groupby(\"job_category\")\n        .size()\n        .reset_index(name=\"count\")\n        .assign(option=col)\n    )\n    tool_job_dfs.append(option_df)\n\noptions_vs_jobs = pd.concat(tool_job_dfs, axis=0, ignore_index=True)\njob_crosstab = (     #2\n    pd.crosstab(index=options_vs_jobs[\"option\"],\n                columns=options_vs_jobs[\"job_category\"],\n                values=options_vs_jobs[\"count\"],\n                aggfunc=\"sum\",\n                normalize=\"columns\")\n    .transpose()\n)\n\nfig, axis = create_heatmap(      #3\n    job_crosstab.round(2),\n    square=False\n)\n\nfig.suptitle(\"What do different job roles use AI for?\")\n\naxis.set(xlabel=None, ylabel=None)\n\nplt.show()\n```", "```py\nsurvey.to_parquet(\"../chapter-7/data/survey.parquet.gz\",\n↪compression=\"gzip\", index=False)\nsurvey_ai_users.to_parquet(\"../chapter-7/data/survey_ai_users.parquet.gz\",\n↪compression=\"gzip\", index=False)\n```"]