<html><head></head><body>
<p id="filepos433313" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Chapter 4. NumPy Foundations</span></span></span></p><p class="calibre_16">As you may recall<a id="filepos433502"/> from <a href="index_split_007.html#filepos32075"><span class="calibre_7">Chapter 1</span></a>, NumPy is the core package for scientific computing in Python, providing support for array-based calculations and linear algebra. As NumPy is the backbone of pandas, I am going to introduce its basics in this chapter: after explaining what a NumPy array is, we will look into vectorization and broadcasting, two important concepts that allow you to write concise mathematical code and that you will find again in pandas. After that, we’re going to see why NumPy offers special functions called universal functions before we wrap this chapter up by learning how to get and set values of an array and by explaining the difference between a view and a copy of a NumPy array. Even if we will hardly use NumPy directly in this book, knowing its basics will make it easier to learn pandas in the next chapter.</p><p id="filepos434390" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Getting Started with NumPy</span></span></span></p><p class="calibre_6">In this section, we’ll learn about one- and two-dimensional NumPy arrays and what’s behind the technical terms <span class="italic">vectorization</span>, <span class="italic">broadcasting</span>, and <span class="italic">universal function</span>.</p><p id="filepos434752" class="calibre_17"><span class="calibre3"><span class="bold">NumPy Array</span></span></p><p class="calibre_6">To <a id="filepos434881"/>perform array-based calculations with nested lists, as we met them in the last chapter, you would have to write some sort of loop. For example, to add a number to every element in a nested list, you can use the following <a id="filepos435109"/>nested list comprehension:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">matrix</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">],</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                  </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">6</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">],</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                  </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">7</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">8</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">9</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]]</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">i</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">for</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">i</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">row</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">for</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">row</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">matrix</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[2]: [[2, 3, 4], [5, 6, 7], [8, 9, 10]]</tt></span></blockquote><p class="calibre_32">This isn’t very readable and more importantly, if you do this with big arrays, looping through each element becomes very slow. Depending on your use case and the size of the arrays, calculating with NumPy arrays instead of Python lists can make your calculations from a couple of times to around a hundred times faster. NumPy achieves this performance by making use of code that was written in C or Fortran—these are compiled programming languages that are much faster than Python. A NumPy array is an N-dimensional array <a id="filepos439635"/>for <span class="italic">homogenous data</span>. Homogenous means that all elements in the array need to be of the same data type. Most commonly, you are dealing with one- and two-dimensional arrays of floats as schematically displayed in <a href="#filepos439974"><span class="calibre_7">Figure 4-1</span></a>.</p><p class="calibre_21"><img src="images/00042.jpg" id="filepos439974" class="calibre_67"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 4-1. A one-dimensional and two-dimensional NumPy array</span></span></span></p><p class="calibre_24">Let’s create a one- and two-dimensional array to work with throughout this chapter:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># First, let's import NumPy</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">numpy</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">np</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Constructing an array with a simple list results in a 1d array</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array1</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">([</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">100</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1000.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">])</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Constructing an array with a nested list results in a 2d array</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">([[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">],</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                           </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">6.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]])</span></tt></span></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">ARRAY DIMENSION</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">It’s important to note the difference between a one- and two-dimensional array: a one-dimensional array has only one axis and hence does not have an explicit column or row orientation. While this behaves like arrays in VBA, you may have to get used to it if you come from a language like MATLAB, where one-dimensional arrays always have a column or row orientation.</span></blockquote><p class="calibre_16">Even if <tt class="calibre6">array1</tt> consists of integers except for the last element (which is a float), the homogeneity of NumPy arrays forces<a id="filepos445451"/> the data type of the array to be <tt class="calibre6">float64</tt>, which is capable of accommodating all elements. To learn about an array’s data type, access its <tt class="calibre6">dtype</tt> attribute:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">6</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dtype</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[6]: dtype('float64')</tt></span></blockquote><p class="calibre_32">Since <tt class="calibre6">dtype</tt> gives you back <tt class="calibre6">float64</tt> instead of <tt class="calibre6">float</tt> which we met in the last chapter, you may have guessed that NumPy uses its own numerical data types, which are more granular than Python’s data types. This usually isn’t an issue though, as most of the time, conversion between the different data types in Python and NumPy happens automatically. If you ever need to explicitly convert a NumPy data type to one of Python’s basic data types, simply use the corresponding<a id="filepos446866"/> constructor (I will say more about accessing an element from an array shortly):</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">7</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">float</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">])</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[7]: 10.0</tt></span></blockquote><p class="calibre_32">For a full list of NumPy’s data types, <a id="filepos447897"/>see the <a href="https://oreil.ly/irDyH"><span class="calibre_7">NumPy docs</span></a>. With NumPy arrays, you can write simple code to perform array-based calculations, as we will <a id="filepos448083"/>see next.</p><p id="filepos448103" class="calibre_17"><span class="calibre3"><span class="bold">Vectorization and Broadcasting</span></span></p><p class="calibre_6">If you<a id="filepos448254"/> build the sum of a scalar and a NumPy array, NumPy will perform an element-wise operation, which means that you don’t have to loop through the elements yourself. The NumPy community refers to this as <span class="italic">vectorization</span>. It allows you to write concise code, practically representing the mathematical notation:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">8</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[8]: array([[2., 3., 4.],<br class="calibre1"/>               [5., 6., 7.]])</tt></span></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">SCALAR</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5"><span class="italic">Scalar</span></span><span class="calibre5"> refers to a basic Python data type like a float or a string. This is to differentiate them from data structures with multiple elements like lists and dictionaries or one- and two-dimensional NumPy arrays.</span><a id="filepos449798"/></blockquote><p class="calibre_16">The same principle applies when you work with two arrays: NumPy performs the operation element-wise:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">9</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">*</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[9]: array([[ 1.,  4.,  9.],<br class="calibre1"/>               [16., 25., 36.]])</tt></span></blockquote><p class="calibre_32">If you use two arrays with different shapes in an arithmetic operation, NumPy extends—if possible—the smaller array automatically across the larger array so that their shapes become compatible. This is <a id="filepos451025"/>called <span class="italic">broadcasting</span>:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">*</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array1</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[10]: array([[  10.,  200., 3000.],<br class="calibre1"/>                [  40.,  500., 6000.]])</tt></span></blockquote><p class="calibre_32">To perform<a id="filepos451947"/> matrix multiplications or dot products, use the <tt class="calibre6">@</tt> operator:<a id="filepos452023"/><a href="#filepos482316"><span class="calibre5"><span class="calibre_7">1</span></span></a></p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">11</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_40">@</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">T</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># array2.T is a shortcut for array2.transpose()</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[11]: array([[14., 32.],<br class="calibre1"/>                [32., 77.]])</tt></span></blockquote><p class="calibre_32">Don’t be intimidated by the terminology I’ve introduced in this section such as scalar, vectorization, or broadcasting! If you have ever worked with arrays in Excel, <a id="filepos453400"/>this should all feel very natural as shown in <a href="#filepos453704"><span class="calibre_7">Figure 4-2</span></a>. The screenshot is taken from <span class="italic">array_calculations.xlsx</span>, which you will find in the <span class="italic">xl</span> directory of the companion repository.</p><p class="calibre_21"><img src="images/00052.jpg" id="filepos453704" class="calibre_68"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 4-2. Array-based calculations in Excel</span></span></span></p><p class="calibre_24">You know now<a id="filepos453983"/> that arrays perform arithmetic operations element-wise, but how can you apply a function on every element in an array? This is what universal functions are here for.</p><p id="filepos454160" class="calibre_17"><span class="calibre3"><span class="bold">Universal Functions (ufunc)</span></span></p><p class="calibre_6"><span class="italic">Universal functions</span> (ufunc) <a id="filepos454337"/>work on every element in a NumPy array. For example, if you use Python’s standard square root function from the <tt class="calibre6">math</tt> module on a NumPy array, you will get an error:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">12</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">math</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">13</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">math</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sqrt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># This will raise en Error</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">---------------------------------------------------------------------------<br class="calibre1"/>TypeError                                 Traceback (most recent call last)<br class="calibre1"/>&lt;ipython-input-13-5c37e8f41094&gt; in &lt;module&gt;<br class="calibre1"/>----&gt; 1 math.sqrt(array2)  # This will raise en Error<br class="calibre1"/><br class="calibre1"/>TypeError: only size-1 arrays can be converted to Python scalars</tt></span></blockquote><p class="calibre_32">You could, of course, write a nested loop to get the square root of every element, then build a NumPy array again from the result:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">14</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">([[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">math</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sqrt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">i</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">for</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">i</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">row</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">for</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">row</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">])</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[14]: array([[1.        , 1.41421356, 1.73205081],<br class="calibre1"/>                [2.        , 2.23606798, 2.44948974]])</tt></span></blockquote><p class="calibre_32">This will work in cases where NumPy doesn’t offer a ufunc and the array is small enough. However, if NumPy has a ufunc, use it, as it will be much faster with big arrays—apart from being easier to type and read:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">15</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sqrt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[15]: array([[1.        , 1.41421356, 1.73205081],<br class="calibre1"/>                [2.        , 2.23606798, 2.44948974]])</tt></span></blockquote><p class="calibre_32">Some of NumPy’s ufuncs, like <tt class="calibre6">sum</tt>, are<a id="filepos460116"/> additionally available as array methods: if you want the sum of each column, do the following:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">16</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sum</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">axis</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Returns a 1d array</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[16]: array([5., 7., 9.])</tt></span></blockquote><p class="calibre_32">The argument <tt class="calibre6">axis=0</tt> refers to the axis along the rows while <tt class="calibre6">axis=1</tt> refers to the axis along the columns, as depicted in <a href="#filepos439974"><span class="calibre_7">Figure 4-1</span></a>. Leaving the <tt class="calibre6">axis</tt> argument away sums up the whole array:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">17</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sum</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[17]: 21.0</tt></span></blockquote><p class="calibre_32">You will meet more NumPy ufuncs throughout this book, as they can be used with pandas DataFrames.</p><p class="calibre_6">So far, <a id="filepos462582"/>we’ve always worked with the entire array. The next section shows you how to manipulate parts of an array and introduces a few helpful array constructors.</p><p id="filepos462749" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Creating and Manipulating Arrays</span></span></span></p><p class="calibre_6">I’ll start this section by getting and setting specific elements of an array before introducing a few useful array constructors, including one to create pseudorandom numbers that you could use for a Monte Carlo simulation. I’ll wrap this section up by explaining the difference between a view and a copy of an array.</p><p id="filepos463249" class="calibre_17"><span class="calibre3"><span class="bold">Getting and Setting Array Elements</span></span></p><p class="calibre_6">In the<a id="filepos463404"/> last chapter, I showed you how to index and slice lists to get access to specific elements. When you work with nested lists like <tt class="calibre6">matrix</tt> from the first example in this chapter, you can <a id="filepos463605"/>use <span class="italic">chained indexing</span>: <tt class="calibre6">matrix[0][0]</tt> will get you the first element of the first row. With NumPy arrays, however, you provide the index and slice arguments for both dimensions in a single pair of square brackets:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">numpy_array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">row_selection</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">column_selection</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span></blockquote><p class="calibre_32">For one-dimensional arrays, this simplifies to <tt class="calibre6">numpy_array[selection]</tt>. When you select a single element, you will get back a scalar; otherwise, you will get back a one- or two-dimensional array. Remember that slice notation uses a start index (included) and an end index (excluded) with a colon in between, as in <tt class="calibre6">start:end</tt>. By leaving away the start and end index, you are left with a colon, which therefore stands for all rows or all columns in a two-dimensional array. I have visualized a few examples in <a href="#filepos465331"><span class="calibre_7">Figure 4-3</span></a>, but you may also want to give <a href="#filepos439974"><span class="calibre_7">Figure 4-1</span></a> another look, as the indices and axes are labeled there. Remember, by slicing a column or row of a two-dimensional array, you end up with a one-dimensional array, not with a two-dimensional column or row vector!</p><p class="calibre_21"><img src="images/00061.jpg" id="filepos465331" class="calibre_69"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 4-3. Selecting elements of a NumPy array</span></span></span></p><p class="calibre_24">Play around with the examples shown in <a href="#filepos465331"><span class="calibre_7">Figure 4-3</span></a> by running the following code:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">18</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Returns a scalar</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[18]: 1000.0</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">19</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Returns a scalar</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[19]: 1.0</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">20</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[:,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:]</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Returns a 2d array</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[20]: array([[2., 3.],<br class="calibre1"/>                [5., 6.]])</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">21</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[:,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Returns a 1d array</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[21]: array([2., 5.])</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">22</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Returns a 1d array</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[22]: array([4., 5.])</tt></span></blockquote><p class="calibre_32">So far, I<a id="filepos470575"/> have constructed the sample arrays by hand, i.e., by providing numbers in a list. But NumPy also offers a few useful functions to construct arrays.</p><p id="filepos470734" class="calibre_17"><span class="calibre3"><span class="bold">Useful Array Constructors</span></span></p><p class="calibre_6">NumPy <a id="filepos470880"/>offers a few ways to construct arrays that will also be helpful to create pandas DataFrames, as we will see in <a href="index_split_015.html#filepos482650"><span class="calibre_7">Chapter 5</span></a>. One way to easily create arrays is to use the <tt class="calibre6">arange</tt> function. This <a id="filepos471142"/>stands for <span class="italic">array range</span> and is similar to the built-in <tt class="calibre6">range</tt> that we met in the previous chapter—with the difference that <tt class="calibre6">arange</tt> returns a NumPy array. Combining it with <tt class="calibre6">reshape</tt> allows<a id="filepos471368"/> us to quickly generate an array with the desired dimensions:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">23</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">arange</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">*</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">reshape</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># 2 rows, 5 columns</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[23]: array([[0, 1, 2, 3, 4],<br class="calibre1"/>                [5, 6, 7, 8, 9]])</tt></span></blockquote><p class="calibre_32">Another common need, for example for Monte Carlo simulations, is to generate arrays of normally <a id="filepos473280"/>distributed pseudorandom numbers. NumPy makes this easy:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">24</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">random</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">randn</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># 2 rows, 3 columns</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[24]: array([[-0.30047275, -1.19614685, -0.13652283],<br class="calibre1"/>                [ 1.05769357,  0.03347978, -1.2153504 ]])</tt></span></blockquote><p class="calibre_32">Other helpful constructors worth exploring are <tt class="calibre6">np.ones</tt> and <tt class="calibre6">np.zeros</tt> to create arrays with ones and zeros, respectively, and <tt class="calibre6">np.eye</tt> to create an identity matrix. We’ll come across some of these constructors again in the next chapter, but for now, let’s learn about the difference between a view and a copy of a NumPy array.</p><p id="filepos475126" class="calibre_17"><span class="calibre3"><span class="bold">View vs. Copy</span></span></p><p class="calibre_6">NumPy<a id="filepos475259"/> arrays return <span class="italic">views</span> when you slice them. This means that you are working with a subset of the original array without copying the data. Setting a value on a view will therefore also change the original array:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">25</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[25]: array([[1., 2., 3.],<br class="calibre1"/>                [4., 5., 6.]])</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">26</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">subset</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[:,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">subset</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[26]: array([[1., 2.],<br class="calibre1"/>                [4., 5.]])</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">27</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">subset</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1000</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">28</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">subset</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[28]: array([[1000.,    2.],<br class="calibre1"/>                [   4.,    5.]])</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">29</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[29]: array([[1000.,    2.,    3.],<br class="calibre1"/>                [   4.,    5.,    6.]])</tt></span></blockquote><p class="calibre_32">If that’s not what you want, you would have to change <tt class="calibre6">In [26]</tt> as follows:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">subset</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[:,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">copy</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><p class="calibre_32">Working on a copy will leave the original array <a id="filepos480562"/>unchanged.</p><p id="filepos480583" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Conclusion</span></span></span></p><p class="calibre_6">In this chapter, I showed you how to work with NumPy arrays and what’s behind expressions such as vectorization and broadcasting. Putting these technical terms aside, working with arrays should feel quite intuitive given that they follow the mathematical notation very closely. While NumPy is an incredibly powerful library, there are two main issues when you want to use<a id="filepos481110"/> it for data analysis:</p><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">The whole NumPy array needs to be of the same data type. This, for example, means that you can’t perform any of the arithmetic operations we did in this chapter when your array contains a mix of text and numbers. As soon as text is involved, the array will have the data type <tt class="calibre6">object</tt>, which will not allow mathematical operations.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Using NumPy arrays for data analysis makes it hard to know what each column or row refers to because you typically select columns via their position, such as in <tt class="calibre6">array2[:, 1]</tt>.</blockquote></blockquote></blockquote></blockquote></li></ul><p class="calibre_14">pandas has solved these issues by providing smarter data structures on top of NumPy arrays. What they are and how they work is the topic of the next chapter.</p><blockquote id="filepos482316" class="calibre_33"><a href="#filepos452023"><span class="calibre5"><span class="calibre_7">1  </span></span></a><span class="calibre5"> If it’s been a while since your last linear algebra class, you can skip this example—matrix multiplication is not something this book builds upon.</span></blockquote><div class="mbp_pagebreak" id="calibre_pb_12"/>
</body></html>