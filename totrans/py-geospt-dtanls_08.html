<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 8. Data Cleaning" data-type="chapter" epub:type="chapter"><div class="chapter" id="data_cleaning">
<h1><span class="label">Chapter 8. </span>Data Cleaning</h1>
<p>A universal problem when working with data is understanding the completeness of your data.<a contenteditable="false" data-primary="data cleaning" data-type="indexterm" id="ix_dacln"/> Data engineering depends on the ability to clean, process, and visualize data. Now that you’re familiar with the basic functionality of and integration of data with notebook-based code editors, either locally in a Jupyter Notebook or in the cloud with Google Colab, it’s time to learn how to clean your data.<a contenteditable="false" data-primary="missing data" data-type="indexterm" id="idm45433739933184"/> Data is frequently incomplete (missing), inconsistently formatted, or otherwise inaccurate—problems often called <em>messy data. Data cleaning</em> is the process of addressing these problems and preparing the data for analysis.<a contenteditable="false" data-primary="messy data" data-type="indexterm" id="idm45433740807904"/></p>
<p>In this chapter, we’ll explore some publicly available datasets, finding and cleaning up messes with a few packages that you can load into a Colab notebook.<a contenteditable="false" data-primary="NYPD_Complaint_Data_Historic dataset" data-type="indexterm" id="idm45433740809440"/><a contenteditable="false" data-primary="datasets" data-secondary="NYPD_Complaint_Data_Historic" data-type="indexterm" id="idm45433739996112"/> You’re going to work with NYPD_Complaint_Data_Historic, a dataset from the open data portal for New York City, <a href="https://oreil.ly/W8sNI">NYC Open Data</a>, updated on July 7, 2021. I filtered the data for 2020 to make it a little more manageable for viewing and manipulating. You can filter the data based on your data question and <a href="https://oreil.ly/7J4Kj">export it as a CSV file</a>. This chapter will show you how to manage, remove, update, and consolidate data and process it with a few useful Python packages. Data analysis is only as accurate as the quality of the dataset or database, and this chapter will provide tools to assess and address common inconsistencies.</p>
<section data-pdf-bookmark="Checking for Missing Data" data-type="sect1"><div class="sect1" id="checking_for_missing_data">
<h1>Checking for Missing Data</h1>
<p>If you’ve ever<a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-type="indexterm" id="ix_daclnckmiss"/> participated in a <a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-type="indexterm" id="ix_missda"/>data competition, like those available on <a href="https://www.kaggle.com">Kaggle</a>, you may have noticed that the datasets are engineered to help you focus your attention on a specific task, such as building a visualization. Often, the data has already been cleaned for you. Real life is a little more complicated, and missing data is a persistent problem. Let’s see how you can make your data world a little tidier.</p>
<p>With spreadsheets and tabular data formats, evaluating the shape of your data is a straightforward task. A little bit of scrolling can easily reveal rows and/or columns that are missing data. <a contenteditable="false" data-primary="nullity or null data" data-type="indexterm" id="idm45433740981360"/>When you review datasets for patterns of missing data, you are actually evaluating them for <em>nullity,</em> or the presence of null data (missing values). Geospatial analysis, like analysis in general, often involves multiple tables, so it’s important to learn how to identify patterns in the data residing between these tabular datasets.</p>
<section data-pdf-bookmark="Uploading to Colab" data-type="sect2"><div class="sect2" id="uploading_to_colab">
<h2>Uploading to Colab</h2>
<p>I am using <a href="https://oreil.ly/J8wam">Google Colab</a> for this example, but feel free to use whatever environment you prefer. <a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-tertiary="uploading to Colab" data-type="indexterm" id="ix_daclckmissuplCol"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-tertiary="uploading NYPD Complaint Data Historic CSV file to" data-type="indexterm" id="ix_missdauplCol"/><a contenteditable="false" data-primary="Colab" data-secondary="uploading NYPD Complaint Data Historic CSV file to" data-type="indexterm" id="ix_Colabupl"/>Upload the <a href="https://oreil.ly/kv3Pe">NYPD Complaint Data Historic</a> CSV file to your notebook and click the dots next to the filename. This will give you the path to include in the notebook (<a data-type="xref" href="#uploading_a_file_to_colab">Figure 8-1</a>).</p>
<figure><div class="figure" id="uploading_a_file_to_colab"><img alt="Uploading a file to Colab" height="933" src="assets/pgda_0801.png" width="1024"/>
<h6><span class="label">Figure 8-1. </span>Uploading a file to Colab</h6>
</div></figure>
<p><a href="https://oreil.ly/ps5JI">Missingno</a> is a Python library that detects<a contenteditable="false" data-primary="Missingno library (Python)" data-type="indexterm" id="idm45433739892720"/> missing values in a dataset and visualizes how they are distributed within the dataframe, which makes it easier to spot patterns.<sup><a data-type="noteref" href="ch08.xhtml#ch01fn11" id="ch01fn11-marker">1</a></sup> Missingno has NumPy, pandas, SciPy, matplotlib, and seaborn running under the hood, bringing familiarity to the underlying code snippets. Install missingno:</p>
<pre data-type="programlisting">
pip install missingno</pre>
<p>Depending on the size of your dataset, you can adjust the sample size. Here I’ve set the sample to <code>1000</code>. <a contenteditable="false" data-primary="pandas" data-secondary="importing to use in data cleaning" data-type="indexterm" id="idm45433739887120"/>Importing the Python library pandas will allow you to begin a little data cleaning and preparation along the way:</p>
<pre data-type="programlisting">
<strong>import</strong> pandas <strong>as</strong> pd
NYPD = pd.read_csv(<span>"/content/NYPD_Complaint_Data_Historic.csv"</span>)
<strong>import</strong> missingno <strong>as</strong> msno
%matplotlib inline
msno.matrix(NYPD.sample(<span>1000</span>))</pre>
<p>Once you upload the dataset, you will need to review the data dictionary to see what the column headings indicate.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="converting_spaces_to_underscores">
<h5>Converting Spaces to Underscores</h5>
<p>You’ll often see spaces in the column headings instead of underscores (_). <a contenteditable="false" data-primary="underscores (_), converting spaces to" data-type="indexterm" id="idm45433739878736"/><a contenteditable="false" data-primary="spaces, converting to underscores (_)" data-type="indexterm" id="idm45433739877712"/><a contenteditable="false" data-primary="dataframes" data-secondary="converting spaces to underscores in" data-type="indexterm" id="idm45433739876640"/>To convert the spaces to underscores, run the following code:</p>
<pre data-type="programlisting">
df.columns = df.columns.str.replace(<span>' '</span>, <span>'_'</span>)</pre>
<p>In many cases (though not with the current data), you will need to convert some columns in datasets in order to identify them and manipulate them in your code. The <code>df</code> in the code is a placeholder for whatever you named the dataframe (<code>df</code>). In the current example, the <code>df</code> is named NYPD.</p>
</div></aside>
<p>The columns listed in our dataframe <a contenteditable="false" data-primary="dataframes" data-secondary="NYPD Complaint dataset" data-type="indexterm" id="idm45433739871728"/>are shown in <a data-type="xref" href="#data_dictionary_for_the_nypd_complaint">Table 8-1</a>. CMPLNT_NUM appears to be the key identifier for each row. This is important because each row is a record of one incident in the dataset.<a contenteditable="false" data-primary="data dictionaries" data-secondary="for NYPD Complaint dataset" data-secondary-sortas="NYPD" data-type="indexterm" id="idm45433739869248"/></p>
<table class="border" id="data_dictionary_for_the_nypd_complaint">
<caption><span class="label">Table 8-1. </span>Data dictionary for the NYPD Complaint dataset</caption>
<thead>
<tr>
<th>Field name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CMPLNT_NUM</td>
<td>Randomly generated persistent ID for each complaint</td>
</tr>
<tr>
<td>CMPLNT_FR_DT</td>
<td>Exact date of occurrence for the reported event (or starting date of occurrence, if CMPLNT_TO_DT exists)</td>
</tr>
<tr>
<td>CMPLNT_FR_TM</td>
<td>Exact time of occurrence for the reported event (or starting time of occurrence, if CMPLNT_TO_TM exists)</td>
</tr>
<tr>
<td>CMPLNT_TO_DT</td>
<td>Ending date of occurrence for the reported event, if exact time of occurrence is unknown</td>
</tr>
<tr>
<td>CMPLNT_TO_TM</td>
<td>Ending time of occurrence for the reported event, if exact time of occurrence is unknown</td>
</tr>
<tr>
<td>ADDR_PCT_CD</td>
<td>Precinct in which the incident occurred</td>
</tr>
<tr>
<td>RPT_DT</td>
<td>Date event was reported to police</td>
</tr>
<tr>
<td>KY_CD</td>
<td>Three-digit offense classification code</td>
</tr>
<tr>
<td>OFNS_DESC</td>
<td>Description of offense corresponding with the key code</td>
</tr>
<tr>
<td>PD_CD</td>
<td>Three-digit internal classification code (more granular than the key code)</td>
</tr>
<tr>
<td>PD_DESC</td>
<td>Description of internal classification corresponding with the PD code (more granular than the offense description)</td>
</tr>
<tr>
<td>CRM_ATPT_CPTD_CD</td>
<td>Indicator of whether the crime was successfully completed, attempted but failed, or interrupted prematurely</td>
</tr>
<tr>
<td>LAW_CAT_CD</td>
<td>Level of offense: felony, misdemeanor, or violation</td>
</tr>
<tr>
<td>BORO_NM</td>
<td>Name of the borough in which the incident occurred</td>
</tr>
<tr>
<td>LOC_OF_OCCUR_DESC</td>
<td>Specific location of occurrence in or around the premises: inside, opposite of, front of, or rear of</td>
</tr>
<tr>
<td>PREM_TYP_DESC</td>
<td>Specific description of the premises: grocery store, residence, street, etc.</td>
</tr>
<tr>
<td>JURIS_DESC</td>
<td>Description of the jurisdiction code</td>
</tr>
<tr>
<td>JURISDICTION_CODE</td>
<td>Jurisdiction responsible for the incident: either internal, like Police (0), Transit (1), and Housing (2), or external (3), like Correction, Port Authority, etc.</td>
</tr>
<tr>
<td>PARKS_NM</td>
<td>Name of New York City park, playground, or greenspace of occurrence, if applicable (state parks are not included)</td>
</tr>
<tr>
<td>HADEVELOPT</td>
<td>Name of New York City Housing Authority housing development of occurrence, if applicable</td>
</tr>
<tr>
<td>HOUSING_PSA</td>
<td>Development-level code</td>
</tr>
<tr>
<td>X_COORD_CD</td>
<td><em>x</em>-coordinate for New York State Plane Coordinate System, Long Island Zone, NAD 83, units feet (FIPS 3104)</td>
</tr>
<tr>
<td>Y_COORD_CD</td>
<td><em>y</em>-coordinate for New York State Plane Coordinate System, Long Island Zone, NAD 83, units feet (FIPS 3104)</td>
</tr>
<tr>
<td>SUSP_AGE_GROUP</td>
<td>Suspect’s age group</td>
</tr>
<tr>
<td>SUSP_RACE</td>
<td>Suspect’s race description</td>
</tr>
<tr>
<td>SUSP_SEX</td>
<td>Suspect’s sex description</td>
</tr>
<tr>
<td>TRANSIT_DISTRICT</td>
<td>Transit district in which the offense occurred</td>
</tr>
<tr>
<td>Latitude</td>
<td>Midblock latitude coordinate for Global Coordinate System, WGS 1984, decimal degrees (EPSG 4326)</td>
</tr>
<tr>
<td>Longitude</td>
<td>Midblock longitude coordinate for Global Coordinate System, WGS 1984, decimal degrees (EPSG 4326)</td>
</tr>
<tr>
<td>Lat_Lon</td>
<td>Geospatial location point (latitude and longitude combined)</td>
</tr>
<tr>
<td>PATROL_BORO</td>
<td>The name of the patrol borough in which the incident occurred</td>
</tr>
<tr>
<td>STATION_NAME</td>
<td>Transit station name</td>
</tr>
<tr>
<td>VIC_AGE_GROUP</td>
<td>Victim’s age group</td>
</tr>
<tr>
<td>VIC_RACE</td>
<td>Victim’s race description</td>
</tr>
<tr>
<td>VIC_SEX</td>
<td>Victim’s sex description</td>
</tr>
</tbody>
</table>
<p>The variables in a dataset need to be called exactly as they are presented in the dataframe. If they are all capitalized or separated by underscores, you need to be sure to copy them (or you can rename them similarly to how you renamed the columns in the census data in <a data-type="xref" href="ch07.xhtml#geopandas_and_spatial_statistics">Chapter 7</a>).</p>
<p>Next, there are other considerations to examine in a dataset.<a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-startref="ix_daclckmissuplCol" data-tertiary="uploading to Colab" data-type="indexterm" id="idm45433741076272"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-startref="ix_missdauplCol" data-tertiary="uploading NYPD Complaint Data Historic CSV file to Colab" data-type="indexterm" id="idm45433739808608"/><a contenteditable="false" data-primary="Colab" data-secondary="uploading NYPD Complaint Data Historic CSV file to" data-startref="ix_Colabupl" data-type="indexterm" id="idm45433739806720"/></p>
</div></section>
<section data-pdf-bookmark="Nulls and Non-Nulls" data-type="sect2"><div class="sect2" id="nulls_and_non_nulls">
<h2>Nulls and Non-Nulls</h2>
<p>You’ll first need to examine the dataset for missing values.<a contenteditable="false" data-primary="nulls and non-nulls in dataset, checking for" data-type="indexterm" id="idm45433739804464"/><a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-tertiary="nulls and non-nulls" data-type="indexterm" id="idm45433739801824"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-tertiary="nulls and non-nulls" data-type="indexterm" id="idm45433739800208"/> Start by quickly reviewing the data with pandas features such as <code>NYPD.info()</code> and <code>NYPD.describe()</code> (see Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="#dataframe_summary_of_nypddotinfoleft_pa">8-2</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#the_dfdotdescribeleft_parenthesisright">8-4</a>).</p>
<p>Using <code>.info()</code> can show you column names, the number of non-nulls, and data types (<code>Dtype</code>):</p>
<pre data-type="programlisting">
NYPD.info()</pre>
<p>The range index in this dataset is 1,115 entries; therefore, any columns with fewer than 1,115 values are missing data. The column non-null count allows you to view missing data and decide which columns have not captured enough data to provide insights.</p>
<p>This dataset’s <a href="https://oreil.ly/nhqvO">documentation</a> states that the null values are likely attributable to changes in department forms and to data being collected inconsistently. In addition, if information was unavailable for 2020 (the year I selected to filter the data) or was unknown at the point of collection, it was classified as Unknown/Not Available/Not Reported. It is important to read the supporting documentation to discover the limits of the data, which might in turn limit the questions you can usefully ask.</p>
</div></section>
<section data-pdf-bookmark="Data Types" data-type="sect2"><div class="sect2" id="data_types">
<h2>Data Types</h2>
<p>One of your top priorities in data cleaning should be examining the data type of each column in your dataset.<a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-tertiary="data types" data-type="indexterm" id="idm45433740843456"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-tertiary="data types" data-type="indexterm" id="idm45433740060880"/><a contenteditable="false" data-primary="data types" data-secondary="examining for each column in your dataset" data-type="indexterm" id="idm45433740838928"/> The most common data types, which you should definitely be familiar with, are <a href="https://oreil.ly/WLzh0">boolean, integer, float, object, and datetime</a>.</p>
<p>The most problematic of these data types is the object.<a contenteditable="false" data-primary="object type" data-type="indexterm" id="idm45433739797712"/> Python objects can include a wide variety of data types. <a contenteditable="false" data-primary="float type" data-type="indexterm" id="idm45433739780720"/><a contenteditable="false" data-primary="integer type" data-type="indexterm" id="idm45433739779520"/><a contenteditable="false" data-primary="boolean type" data-type="indexterm" id="idm45433739778416"/><a contenteditable="false" data-primary="datetime object (Python)" data-type="indexterm" id="idm45433739777312"/>Most often they are strings, but you should know that they can also include integers, floats, lists, and dictionaries.<a contenteditable="false" data-primary="pandas" data-secondary="NaN (not a number)" data-type="indexterm" id="idm45433739775728"/> In the pandas library, different data types are detected and classified<a contenteditable="false" data-primary="NaN (not a number)" data-type="indexterm" id="idm45433739781424"/> as NaN (the default marker for “not a number”) or NaT for missing datetimes. The output of <code>NYPD.info</code> includes the data type (<code>Dtype</code>), or you can use the <code>dtypes</code> DataFrame attribute by appending it with a dot: <code>NYPD.dtypes</code>.</p>
</div></section>
<section data-pdf-bookmark="Metadata" data-type="sect2"><div class="sect2" id="metadata">
<h2>Metadata</h2>
<p>You can also return information about the shape of the data. <a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-tertiary="metadata" data-type="indexterm" id="idm45433739768592"/><a contenteditable="false" data-primary="shape of data" data-type="indexterm" id="idm45433739767696"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-tertiary="metadata" data-type="indexterm" id="ix_missdameta"/><a contenteditable="false" data-primary="metadata" data-secondary="for NYPD Complaint dataset" data-secondary-sortas="NYPD" data-type="indexterm" id="ix_meta"/>This, along with the data type information, is what we call <em>metadata</em>, or data about your data. To see the shape of the NYPD data, run:</p>
<pre data-type="programlisting">
NYPD.shape
(<span>7375993</span>, <span>35</span>)</pre>
<p>For simplicity in this example, I filtered the data <a contenteditable="false" data-primary="dataframes" data-secondary="summary of NYPD.info function" data-type="indexterm" id="idm45433739760720"/>at the source to include only 2020 data so that we are working with a smaller number of records: 1,115 entries (<a data-type="xref" href="#dataframe_summary_of_nypddotinfoleft_pa">Figure 8-2</a>).</p>
<figure><div class="figure" id="dataframe_summary_of_nypddotinfoleft_pa"><img alt="Dataframe summary of NYPD.info()" height="1000" src="assets/pgda_0802.png" width="677"/>
<h6><span class="label">Figure 8-2. </span>Dataframe summary of <code>NYPD.info()</code></h6>
</div></figure>
<p class="pagebreak-before less_space">The exact time of each complaint’s occurrence, or CMPLNT_FR_TM, is listed as an object or string in <a data-type="xref" href="#dataframe_summary_of_nypddotinfoleft_pa">Figure 8-2</a>. Pandas will often guess the type of data in a column when a datetime or other data type is assigned as a string or object. <a contenteditable="false" data-primary="data types" data-type="indexterm" id="idm45433739754864"/>This is often complicated by defaults such as the <code>low_memory=True</code> argument. Large files are “chunked,” and the file often generates columns with multiple dtypes. I would resist simply switching arguments to <code>False</code>, however. It is much more efficient to simply change the <code>dtype</code> manually, as shown in the following code cell:</p>
<pre data-type="programlisting">
<span>NYPD = pd.read_csv(<span>'/content/drive/MyDrive/NYPD_Complaint_Data_Historic.csv'</span>,
                   parse_dates=[<span>'CMPLNT_FR_TM'</span>])
NYPD.dtypes.head()</span>

CMPLNT_NUM               int64
CMPLNT_FR_DT            object
CMPLNT_FR_TM    datetime64[ns]

NYPD<span><span> = NYPD.drop(columns =[</span>'CMPLNT_TO_DT'<span>,</span>'CMPLNT_FR_TM'<span>,</span>'PARKS_NM'<span>,</span>'HADEVELOPT'<span>,
</span>'HOUSING_PSA'<span>])</span></span></pre>
<p><code>NYPD.head()</code> will update the columns you retain and confirm that your “dropped” columns no longer appear in the dataframe.</p>
<p>You can eliminate columns with incomplete data if they are not relevant to what you are interested in exploring. However, I strongly discourage you from <em>deleting</em> data. Often, the reason for some data being missing is as compelling or significant as the data selected for inclusion.</p>
<p>Let’s try this out by identifying a few sample<a contenteditable="false" data-primary="metadata" data-secondary="for NYPD Complaint dataset" data-secondary-sortas="NYPD" data-type="indexterm" id="idm45433739752944"/> columns <a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-startref="ix_missdameta" data-tertiary="metadata" data-type="indexterm" id="idm45433739741872"/>to drop from the dataframe.</p>
</div></section>
<section data-pdf-bookmark="Summary Statistics" data-type="sect2"><div class="sect2" id="summary_statistics">
<h2>Summary Statistics</h2>
<p>You can examine <em>summary statistics</em>, or statistics that summarize your sample data, using <code>.describe()</code>.<a contenteditable="false" data-primary="summary statistics" data-type="indexterm" id="ix_summstat"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-tertiary="examining summary statistics" data-type="indexterm" id="ix_missdasummstat"/><a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-tertiary="examining summary statistics" data-type="indexterm" id="ix_daclckmisssumm"/></p>
<p>Look at row counts for another opportunity to identify missing data of the different features in the dataframe.<a contenteditable="false" data-primary="dataframes" data-secondary="df.describe function" data-type="indexterm" id="idm45433739730192"/> In the output of <code>df.describe()</code>, the NaN values are excluded so that you can see the actual distribution of the data as well as the count of values in each column.<a contenteditable="false" data-primary="distribution of data" data-type="indexterm" id="idm45433739731088"/></p>
<div data-type="tip">
<h1>Measures of Central Tendency</h1>
<p>A normal <a contenteditable="false" data-primary="measures of central tendency" data-type="indexterm" id="idm45433739726464"/>distribution is when the mean, mode, and median are all the same value. <a contenteditable="false" data-primary="probability distribution" data-type="indexterm" id="idm45433739723696"/>A <em>probability</em> distribution, or <em>measure of central tendency</em>, describes the central value in a distribution when the distribution is not normal, as shown in <a data-type="xref" href="#a_review_of_measures_of_central_tendenc">Figure 8-3</a>.</p>
</div>
<figure><div class="figure" id="a_review_of_measures_of_central_tendenc"><img alt="A review of measures of central tendency" height="473" src="assets/pgda_0803.png" width="1201"/>
<h6><span class="label">Figure 8-3. </span>A review of measures of central tendency</h6>
</div></figure>
<p>There are also certain measures that can indicate the <a contenteditable="false" data-primary="skewed distributions" data-type="indexterm" id="idm45433739718576"/>presence of skewed distributions and outliers. <a data-type="xref" href="#the_dfdotdescribeleft_parenthesisright">Figure 8-4</a> is a snapshot of <a href="https://oreil.ly/vOcv7">Energy and Water Data Disclosure for Local Law 84 2021 (Data for Calendar Year 2020)</a>, a large dataset that examines energy and water usage in private buildings in New York City. The median or second quartile (Q2), the 50% measure in the table, indicates the <em>median value</em>, the point at which half the values are above and half the values are below.</p>
<figure><div class="figure" id="the_dfdotdescribeleft_parenthesisright"><img alt="The df.describe() function provides descriptive statistics for columns with numerical data" height="501" src="assets/pgda_0804.png" width="1889"/>
<h6><span class="label">Figure 8-4. </span>The <code>df.describe()</code> function provides descriptive statistics for columns with numerical data</h6>
</div></figure>
<p>A quick way to look at the shape of your data is to observe where the Q2, or median, is located. If you look at the second column in <a data-type="xref" href="#the_dfdotdescribeleft_parenthesisright">Figure 8-4</a>, you can determine if the value of the median is closer to 25% or 75%. If it is closer to 25% or Q1, the data is right-skewed, meaning that 25% of the values are below the value for Q1. Think of Q1 as values between the minimum value and the median. The Q3 value is between the median and the maximum values, indicating that 75% of the reported values will be below the Q3. This will result in data with a left skew.</p>
<p>You can have a quick view of the numeric values in your dataset with a <code>df.describe()</code> function.  Enter the code snippet into your notebook to view below:</p>
<pre data-type="programlisting">
df.describe()</pre>
<p>Plotting a histogram makes it easier to visualize the shape of the data. <a contenteditable="false" data-primary="distribution of data" data-secondary="histogram visualization of" data-type="indexterm" id="idm45433739709856"/>There is a right-sided tail, or positive skew, as shown in <a data-type="xref" href="#visualization_of_distribution_of_the_da">Figure 8-5</a>. This indicates that the mean is greater than the median, which is greater than the mode.</p>
<figure><div class="figure" id="visualization_of_distribution_of_the_da"><img alt="Visualization of distribution of the data" height="731" src="assets/pgda_0805.png" width="1024"/>
<h6><span class="label">Figure 8-5. </span>Visualization of distribution of the data</h6>
</div></figure>
<p>Let’s return to the NYPD data. We can visualize the data and see its distribution:</p>
<pre data-type="programlisting">
size, scale = <span>1000</span>, <span>10</span>
Complaints = pd.Series(np.random.gamma(scale, size=size) ** <span>1.5</span>)

Complaints.plot.hist(grid=<strong>True</strong>, bins=<span>20</span>, rwidth=<span>0.9</span>,
                 color=<span>'#607c8e'</span>)
plt.title(<span>'Distribution of Complaint Types'</span>)
plt.xlabel(<span>'CMPLNT_NUM'</span>)
plt.ylabel(<span>'OFNS_DESC'</span>)
plt.grid(axis=<span>'y'</span>, alpha=<span>0.75</span>)size, scale = <span>1000</span>, <span>10</span>
Complaints = pd.Series(np.random.gamma(scale, size=size) ** <span>1.5</span>)

Complaints.plot.hist(grid=<strong>True</strong>, bins=<span>20</span>, rwidth=<span>0.9</span>,
                 color=<span>'#607c8e'</span>)
plt.title(<span>'Distribution of Complaint Types'</span>)
plt.xlabel(<span>'PATROL_BORO'</span>)
plt.ylabel(<span>'OFNS_DESC'</span>)
plt.grid(axis=<span>'y'</span>, alpha=<span>0.75</span>)</pre>
<p>The visualization also indicates a rightward skew of the data in the distribution of complaint types (<a data-type="xref" href="#visualization_of_distribution_of_the_da">Figure 8-5</a>).</p>
<p><a data-type="xref" href="#nypddotisnaleft_parenthesisright_parent">Figure 8-6</a> is simply a tally of how many values are missing in each column. Knowing when records are missing before analyzing data provides a level of transparency, and it’s critical to communicate that information when you share your data visualizations.</p>
<figure><div class="figure" id="nypddotisnaleft_parenthesisright_parent"><img alt="NYPD.isna().sum() lists missing values tally for columns in dataset" height="996" src="assets/pgda_0806.png" width="400"/>
<h6><span class="label">Figure 8-6. </span><code>NYPD.isna().sum()</code> lists missing values tally for columns in dataset</h6>
</div></figure>
<p><code>NYPD.isna()</code> returns the dataframe with Boolean<a contenteditable="false" data-primary="dataframes" data-secondary="NYPD.isna function" data-type="indexterm" id="idm45433739688928"/> values <a contenteditable="false" data-primary="Boolean values" data-type="indexterm" id="idm45433739688800"/>indicating missing values, as shown in <a data-type="xref" href="#dataframe_nypddotisnaleft_parenthesisri">Figure 8-7</a>. In computation, Boolean values have only two possible values: <code>True</code> and <code>False</code>, often represented as <code>1</code> and <code>0</code>. <code>True</code> in this case indicates missing data. At a glance, you can see where the data is missing.</p>
<figure><div class="figure" id="dataframe_nypddotisnaleft_parenthesisri"><img alt="Dataframe NYPD.isna()" height="617" src="assets/pgda_0807.png" width="1700"/>
<h6><span class="label">Figure 8-7. </span>Dataframe <code>NYPD.isna()</code></h6>
</div></figure>
<p>These are just a few of the options available for exploring a dataframe and understanding the scope of the completeness or nullity of the data.<a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-startref="ix_daclckmisssumm" data-tertiary="examining summary statistics" data-type="indexterm" id="idm45433739681056"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-startref="ix_missdasummstat" data-tertiary="examining summary statistics" data-type="indexterm" id="idm45433739679200"/><a contenteditable="false" data-primary="summary statistics" data-startref="ix_summstat" data-type="indexterm" id="idm45433739677408"/></p>
<p>Now that you’ve found your missing data, what should you do next?</p>
</div></section>
<section data-pdf-bookmark="Replacing Missing Values" data-type="sect2"><div class="sect2" id="replacing_missing_values">
<h2>Replacing Missing Values</h2>
<p>An additional reason for examining the dataframe is to review missing values and identify how they’re characterized.<a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-tertiary="replacing missing values" data-type="indexterm" id="idm45433739672720"/><a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-tertiary="replacing missing values" data-type="indexterm" id="idm45433739673872"/> Once you know how missing values are recorded in the table, you can replace them with a variable of your selection, for example <code>NaN</code>, <code>unknown</code>, or another value of interest, using the <code>na_values</code> parameter:</p>
<pre data-type="programlisting">
<span>df_test = pd.read_csv(</span>"/content/NYPD_Complaint_Data_Historic.csv", 
na_values = 'NaN'<span>)</span>
print<span>(df)</span></pre>
<p>Exploring the dataset often reveals inconsistent reporting of missing values in the data tables.<a contenteditable="false" data-primary="missing data" data-secondary="checking for" data-startref="ix_missda" data-type="indexterm" id="idm45433739664704"/><a contenteditable="false" data-primary="data cleaning" data-secondary="checking for missing data" data-startref="ix_daclnckmiss" data-type="indexterm" id="idm45433739663520"/> The code snippet will query alternative variables, such as <code>?</code> and <code>999</code>.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Visualizing Data with Missingno" data-type="sect1"><div class="sect1" id="visualizing_data_with_missingno">
<h1>Visualizing Data with Missingno</h1>
<p>In this section, we’ll work with missingno again. <a contenteditable="false" data-primary="data cleaning" data-secondary="visualizing data with Missingno" data-type="indexterm" id="ix_daclnvisMissno"/><a contenteditable="false" data-primary="Missingno library (Python)" data-secondary="visualizing data with" data-type="indexterm" id="ix_Missno"/>Missingno can convert tabular data matrices into B<em>oolean masks</em>, so called because <em>masking</em> returns data based on certain criteria of the underlying manipulated data. <a contenteditable="false" data-primary="Boolean masks, converting tabular data matrices to" data-type="indexterm" id="idm45433739654192"/>The data returns a True/False Boolean according to the indicated criteria. In computation, Boolean values have only two possible values. Missingno marks cells that contain data as <code>True</code> and empty cells as <code>False</code>. <a contenteditable="false" data-primary="nullity matrix for NYPD Complaint dataset" data-type="indexterm" id="idm45433739715056"/>It can visualize these in a <em>nullity matrix</em> (<a data-type="xref" href="#nullity_matrix_for_the_nypd_complaint_d">Figure 8-8</a>), a chart that uses white spaces to visually represent missing data and reveal patterns. Where data is present, it will be shaded.</p>
<figure class="width-90"><div class="figure" id="nullity_matrix_for_the_nypd_complaint_d"><img alt="Nullity matrix for the NYPD Complaint dataset" height="512" src="assets/pgda_0808.png" width="1097"/>
<h6><span class="label">Figure 8-8. </span>Nullity matrix for the NYPD Complaint dataset</h6>
</div></figure>
<p>In <a data-type="xref" href="#nullity_matrix_for_the_nypd_complaint_d">Figure 8-8</a>, each column represents a feature in the data, and each row represents an observation. The sparkline at the far right of the matrix shows how much data is missing in each record.</p>
<p>Do you see any patterns in the missing data here? I notice that the fourth and fifth bars, which represent complaint ending dates and times, have the same pattern: when one of those two values is missing, the other one is too. You can use <code>msno.bar</code> to display the same<a contenteditable="false" data-primary="nullity shown by column" data-type="indexterm" id="idm45433739652960"/> information as a column instead of a simplified matrix:</p>
<pre data-type="programlisting">
msno.bar(NYPD.sample(<span>1000</span>))</pre>
<p>The height of the bar equals the nullity, or level of missing data (<a data-type="xref" href="#nullity_shown_by_column">Figure 8-9</a>). Taller columns indicate that the value is complete (not missing data) or almost complete.</p>
<figure class="width-90"><div class="figure" id="nullity_shown_by_column"><img alt="Nullity shown by column" height="539" src="assets/pgda_0809.png" width="1126"/>
<h6><span class="label">Figure 8-9. </span>Nullity shown by column</h6>
</div></figure>
<p>Evaluating <code>msno.heatmap(NYPD)</code> examines <em>nullity correlation</em>, or the<a contenteditable="false" data-primary="heatmaps" data-type="indexterm" id="idm45433739637008"/> absence<a contenteditable="false" data-primary="nullity correlation" data-type="indexterm" id="idm45433739636080"/> or presence of a variable, and how strongly this affects the presence of the other variable. Correlation is measured on a scale from –1 to 1, as shown in <a data-type="xref" href="#heatmap_of_nullity_data_left_parenthesi">Figure 8-10</a>. <em>Zero correlation</em> means <a contenteditable="false" data-primary="zero correlation" data-type="indexterm" id="idm45433739633056"/>that the presence of one variable appears to be unrelated to whether another variable is present; a correlation score of 1 means that one variable appears whenever the other is present. Negative values indicate <em>negative correlation:</em> the presence of one variable indicates that the other variable will not be present.<a contenteditable="false" data-primary="negative correlation" data-type="indexterm" id="idm45433740118048"/></p>
<figure><div class="figure" id="heatmap_of_nullity_data_left_parenthesi"><img alt="Heatmap of nullity data (NYPD)" height="1233" src="assets/pgda_0810.png" width="1817"/>
<h6><span class="label">Figure 8-10. </span>Heatmap of nullity data (NYPD)</h6>
</div></figure>
<p>Values that are either always present or never present are not visualized in the heatmap. For example, there are two columns—RPT_DT (the date of the report to police) and JURIS_DESC (jurisdiction description)—that report no missing data, and they are not visualized in the heatmap. Other values that don’t appear to be measuring anything might be generated from erroneous data. A closer examination of the data might reveal something of interest. Pay attention to values that are below 1: the value of –0.3 in <a data-type="xref" href="#heatmap_of_nullity_data_left_parenthesi">Figure 8-10</a>, for instance, is worth a closer look. For example, a value of less than –1 means the correlation is almost 100% negative.</p>
<p><em>Dendrograms</em>, or tree diagrams, are branching diagrams that visually represent relationships between different groups.<a contenteditable="false" data-primary="dendrograms" data-type="indexterm" id="idm45433739649520"/><a contenteditable="false" data-primary="clades (dendrograms)" data-type="indexterm" id="idm45433739648880"/><a contenteditable="false" data-primary="leaves (dendrograms)" data-type="indexterm" id="idm45433740278816"/> The branches are called <em>clades</em>, and the terminal ends are called <em>leaves</em>. The arrangement of the clades tells us which leaves are most similar to one another based on how close together they are. The height of the branch points indicates how similar or different they are from one another: the greater the height, the greater the difference. The closer to 0 the groupings are in the dendrogram, the more closely the presence of nulls in one column is related to the presence or absence of nulls in the other columns.</p>
<p>The <a href="https://oreil.ly/3Pxln"><em>scipy.cluster.hierarchy.dendrogram</em></a> composes clusters by <a contenteditable="false" data-primary="hierarchical clustering in dendrogram" data-type="indexterm" id="idm45433740424480"/>drawing a U-shaped link that joins clades. The dendrogram’s orientation defaults to top-down if there are 50 or fewer columns and to left-right when there are more than 50.</p>
<p>In <a data-type="xref" href="#dendrogram_relationships_in_nypd_datase">Figure 8-11</a>, the columns denoting the race and sex of the suspect (SUSP_RACE and SUSP_SEX) are more similar to each other than are the columns denoting suspect age group and transit district (SUSP_AGE_GROUP and TRANSIT_DISTRICT).</p>
<figure><div class="figure" id="dendrogram_relationships_in_nypd_datase"><img alt="Dendrogram relationships in NYPD dataset" height="1008" src="assets/pgda_0811.png" width="2240"/>
<h6><span class="label">Figure 8-11. </span>Dendrogram relationships in NYPD dataset</h6>
</div></figure>
<p>To view hierarchical clustering, write the following code snippet into your code cell:</p>
<pre data-type="programlisting">
msno.dendrogram(NYPD)</pre>
<p>Dendrograms are useful when focusing on the distribution of data within the dataset. <a contenteditable="false" data-primary="distribution of data" data-secondary="dendrograms useful for focusing on" data-type="indexterm" id="idm45433739608576"/>The hierarchical clustering quantitatively estimates the relationship of each data point to every other point in the dataset. Cluster distance is on the vertical axis, and the distinct data points are shown horizontally. The highest level of granularity is at the level of the data sample, and the dendrogram is a way to visualize this quickly.<a contenteditable="false" data-primary="data cleaning" data-secondary="visualizing data with Missingno" data-startref="ix_daclnvisMissno" data-type="indexterm" id="idm45433739609472"/><a contenteditable="false" data-primary="Missingno library (Python)" data-secondary="visualizing data with" data-startref="ix_Missno" data-type="indexterm" id="idm45433740819952"/></p>
</div></section>
<section data-pdf-bookmark="Mapping Patterns" data-type="sect1"><div class="sect1" id="mapping_patterns">
<h1>Mapping Patterns</h1>
<p>QGIS is an additional way to view data and look for patterns in the data. <a contenteditable="false" data-primary="data cleaning" data-secondary="mapping patterns" data-type="indexterm" id="ix_daclmappatt"/><a contenteditable="false" data-primary="patterns in data, mapping" data-type="indexterm" id="ix_pattda"/><a contenteditable="false" data-primary="mapping patterns" data-type="indexterm" id="ix_mappatt"/>The data in <a data-type="xref" href="#visualizing_nypd_filtered_crime_data_on">Figure 8-12</a> is filtered to show only burglaries in order to help guide additional insights based on location. Let’s look at how to generate such a map.<a contenteditable="false" data-primary="data cleaning" data-secondary="mapping patterns" data-tertiary="visualizing NYPD filtered crime data on a map" data-type="indexterm" id="idm45433742748992"/><a contenteditable="false" data-primary="patterns in data, mapping" data-secondary="visualizing NYPD filtered crime data on a map" data-type="indexterm" id="idm45433739595152"/><a contenteditable="false" data-primary="mapping patterns" data-secondary="visualizing NYPD filtered crime data on a map" data-type="indexterm" id="idm45433739593936"/></p>
<figure><div class="figure" id="visualizing_nypd_filtered_crime_data_on"><img alt="Visualizing NYPD filtered crime data on a map" height="1972" src="assets/pgda_0812.png" width="3114"/>
<h6><span class="label">Figure 8-12. </span>Visualizing NYPD filtered crime data on a map</h6>
</div></figure>
<section data-pdf-bookmark="Latitude and Longitude" data-type="sect2"><div class="sect2" id="latitude_and_longitude">
<h2>Latitude and Longitude</h2>
<p>The dataset has Latitude and Longitude columns. <a contenteditable="false" data-primary="longitude and latitude" data-secondary="in NYPD filtered crime dataset" data-secondary-sortas="NYPD" data-type="indexterm" id="idm45433739588176"/><a contenteditable="false" data-primary="mapping patterns" data-secondary="longitude and latitude" data-type="indexterm" id="idm45433739586496"/><a contenteditable="false" data-primary="patterns in data, mapping" data-secondary="longitude and latitude" data-type="indexterm" id="idm45433739585120"/>You can convert these to point out features, then use GeoPandas to create a map. Let’s use the same file to import data and add a shapefile. <a contenteditable="false" data-primary="pandas" data-secondary="importing" data-type="indexterm" id="idm45433739591200"/>First, import pandas:</p>
<pre data-type="programlisting">
<strong>import</strong> pandas <strong>as</strong> pd</pre>
<p>Next, <code>read_csv</code> reads the datafile into your notebook:</p>
<pre data-type="programlisting">
<span>df = pd.read_csv(</span>'/content/drive/MyDrive/NYPD_Complaint_Data_Historic.csv'<span>)</span></pre>
<p>Upload the file directly to Google Colab if that’s what you’re using.<a contenteditable="false" data-primary="Colab" data-secondary="uploading NYPD Complaint Data Historic CSV file to" data-type="indexterm" id="idm45433739576784"/> You can modify the <code>df</code> variable to whatever you prefer. <a contenteditable="false" data-primary="dataframes" data-secondary="df.head function" data-type="indexterm" id="idm45433739575248"/>The <code>df.head()</code> function will return the first rows in each column:</p>
<pre data-type="programlisting">
df.head()</pre>
<p>As a best practice, make sure to capture spellings and capitalizations exactly as they appear in your data, and always list longitude before latitude when writing code.</p>
</div></section>
<section class="pagebreak-before" data-pdf-bookmark="Shapefiles" data-type="sect2"><div class="sect2" id="shapefiles">
<h2 class="less_space">Shapefiles</h2>
<p>You will use the Python library <a href="https://oreil.ly/KE75Y">Shapely</a> for <em>computational geometry,</em> or working with geometric objects like points, curves, and surfaces. <a contenteditable="false" data-primary="data cleaning" data-secondary="mapping patterns" data-tertiary="shapefiles" data-type="indexterm" id="ix_daclmappattshp"/><a contenteditable="false" data-primary="patterns in data, mapping" data-secondary="shapefiles" data-type="indexterm" id="ix_pattmapshpf"/><a contenteditable="false" data-primary="shapefiles (.shp)" data-secondary="mapping data patterns from" data-type="indexterm" id="ix_shpmap"/><a contenteditable="false" data-primary="mapping patterns" data-secondary="shapefiles" data-type="indexterm" id="ix_mappattshpf"/><a contenteditable="false" data-primary="computational geometry" data-type="indexterm" id="idm45433739559792"/><a contenteditable="false" data-primary="Shapely library (Python)" data-type="indexterm" id="idm45433739558688"/>When uploading a shapefile, be sure to upload all of the files associated with the shapefile (they’ll have the extensions <em>.dbf</em>, <em>.shx</em>, and <em>.prj</em>) into the same directory. <a contenteditable="false" data-primary="NYC Open Data Borough Boundaries" data-type="indexterm" id="idm45433739556688"/>The shapefile in <a data-type="xref" href="#nyc_open_data_borough_boundaries">Figure 8-13</a> is from <a href="https://oreil.ly/LYjNT">NYC Open Data Borough Boundaries</a>.</p>
<figure><div class="figure" id="nyc_open_data_borough_boundaries"><img alt="NYC Open Data borough boundaries" height="1460" src="assets/pgda_0813.png" width="1896"/>
<h6><span class="label">Figure 8-13. </span>NYC Open Data borough boundaries</h6>
</div></figure>
<p>First, import <a contenteditable="false" data-primary="GeoPandas" data-secondary="importing into notebook" data-type="indexterm" id="idm45433739552064"/>your libraries<a contenteditable="false" data-primary="matplotlib" data-secondary="importing" data-type="indexterm" id="idm45433739550560"/> and packages:</p>
<pre data-type="programlisting">
!pip install geopandas
<strong>import</strong> geopandas <strong>as</strong> gpd
<strong>from</strong> shapely.geometry <strong>import</strong> Point, Polygon
<strong>import</strong> matplotlib.pyplot <strong>as</strong> plt
street_map = gpd.read_file(<span>'/content/tl_2021_36_place.shp'</span>)</pre>
<div data-type="tip"><h6>Tip</h6>
<p>Python libraries are often abbreviated in code.<a contenteditable="false" data-primary="pd (pandas)" data-seealso="pandas" data-type="indexterm" id="idm45433739544128"/> You’ve seen that pandas is abbreviated as <code>pd</code> and GeoPandas as <code>gpd</code>.<a contenteditable="false" data-primary="gpd (GeoPandas)" data-type="indexterm" id="idm45433739541328"/> You will notice <code>plt</code> used for matplotlib—don’t mistake this for part of a function or argument.<a contenteditable="false" data-primary="plt (matplotlib)" data-type="indexterm" id="idm45433739538432"/><a contenteditable="false" data-primary="matplotlib" data-secondary="abbreviated as plt" data-type="indexterm" id="idm45433739537264"/></p>
</div>
<p class="pagebreak-before less_space">Now Python simply needs to know how to apply the coordinates in a defined space—so you need to define it:</p>
<pre data-type="programlisting">
<span># designate coordinate system</span>
crs = {<span>'init'</span>: <span>'epsg:4326'</span>}
<span># zip x and y coordinates into single feature</span>
geometry = [Point(xy) <strong>for</strong> xy <strong>in</strong> zip(df[<span>'Longitude'</span>], df[<span>'Latitude'</span>])]
<span># create GeoPandas dataframe</span>
geo_df = gpd.GeoDataFrame(df,
crs = crs,
geometry = geometry)</pre>
<p>GeoPandas is a <em>Cartesian coordinate reference system,</em> which means <a contenteditable="false" data-primary="Cartesian coordinate reference systems" data-type="indexterm" id="idm45433739530160"/>that<a contenteditable="false" data-primary="GeoPandas" data-secondary="Cartesian CRS" data-type="indexterm" id="idm45433739528896"/> each <a contenteditable="false" data-primary="CRS (coordinate reference system)" data-secondary="Cartesian" data-type="indexterm" id="idm45433739527360"/>point is defined by a pair of numerical coordinates, such as latitude and longitude in our example. It assigns geographic data to pandas objects. The GeoPandas dataframe has been created from defining our CRS and combining our Longitude and Latitude columns.<a contenteditable="false" data-primary="Point function (Shapely)" data-type="indexterm" id="idm45433739525872"/> The <code>Point</code> function in Shapely <a contenteditable="false" data-primary="geometry" data-secondary="adding new geometry column" data-type="indexterm" id="idm45433739791968"/>uses the Longitude and Latitude columns to create a new column labeled geometry in <a data-type="xref" href="#adding_a_new_columncomma_geometry">Figure 8-14</a>.</p>
<figure><div class="figure" id="adding_a_new_columncomma_geometry"><img alt="Adding a new column, geometry" height="1024" src="assets/pgda_0814.png" width="253"/>
<h6><span class="label">Figure 8-14. </span>Adding a new column, geometry</h6>
</div></figure>
<p>In the preceding code cell, we defined <code>geo_df</code>, and now we can view<a contenteditable="false" data-primary="geometry" data-secondary="viewing newly created geometry column" data-type="indexterm" id="idm45433739518416"/> the newly created geometry column:</p>
<pre data-type="programlisting">
geo_df.head()</pre>
<p class="pagebreak-before less_space">Here I have enlarged the <code>figsize</code> for better visibility, but it will load more quickly at a smaller size. The default units are inches, but <a href="https://oreil.ly/1PeVm">conversions are available</a> for centimeters and pixels as well. The <code>street_map</code> is assigned to the axes as that is where we assigned our shapefile:</p>
<pre data-type="programlisting">
# create figure and define axes, assign to subplot (matplotlib)<span>
fig, ax = plt.subplots(figsize=(</span><span>30</span><span>,</span><span>30</span><span>))</span>
# add .shp mapfile to axes<span>
street_map.plot(ax=ax, alpha=</span><span>0.4</span><span>,color=</span><span>'grey'</span><span>)</span>
# add geodataframe to axes
# assign 'OFNS_DESC' variable to represent coordinates on graph
# add legend
# make data points transparent using alpha
# assign size of points using markersize<span>
geo_df.plot(column=</span><span>'OFNS_DESC'</span><span>,ax=ax,alpha=</span><span>0.5</span><span>, legend=<strong>True</strong>,markersize=</span><span>10</span><span>)</span>
# add title to graph<span>
plt.title(</span><span>'Reported Offenses'</span><span>, fontsize=</span><span>15</span><span>,fontweight=</span><span>'bold'</span><span>)</span>
# set Latitude and Longitude boundaries for map display<span>
plt.xlim(</span><span>-74.02</span><span>,</span><span>-73.925</span><span>)
plt.ylim(</span> <span>40.7</span><span>,</span><span>40.8</span><span>)</span>
# show map<span>
plt.show()</span></pre>
<p><a data-type="xref" href="#geopandas_dataframe_visualized_on_a_map">Figure 8-15</a> is a map created from a GeoPandas dataframe. <a contenteditable="false" data-primary="GeoPandas" data-secondary="dataframe visualized on map of New Your City boroughs" data-type="indexterm" id="idm45433739499520"/>You can filter and edit the reported incidents to create a more tailored map. (Refer to the <a href="https://oreil.ly/9ADWy">Jupyter Notebook</a> for additional options.) The <code>plt.xlim</code> and <code>plt.ylim</code> commands let you select a specific boundary to further edit your projection.<a contenteditable="false" data-primary="plt.ylim command" data-type="indexterm" id="idm45433739494848"/><a contenteditable="false" data-primary="plt.xlim command" data-type="indexterm" id="idm45433739494016"/></p>
<p>If you would like to select a type of crime from the dataset, use the <code>df.loc</code> function to locate all instances. <a contenteditable="false" data-primary="dataframes" data-secondary="df.loc function" data-type="indexterm" id="idm45433739496096"/>Here is an example showing burglaries:</p>
<pre data-type="programlisting">
fig, ax = plt.subplots(figsize=(<span>15</span>,<span>15</span>))
street_map.plot(ax=ax, alpha=<span>0.4</span>,color=<span>'grey'</span>,legend=<strong>True</strong>,markersize=<span>20</span>)
geo_df.loc[df[<span>'OFNS_DESC'</span>] == <span>'BURGLARY'</span>]
geo_df.plot(ax=ax, alpha=<span>0.5</span>,)
plt.xlim(<span>-74.02</span>,<span>-73.925</span>)
plt.ylim( <span>40.7</span>,<span>40.8</span>)
plt.show()</pre>
<p>Or perhaps you want to list a few different offenses:</p>
<pre data-type="programlisting">
df.loc[df[<span>'OFNS_DESC'</span>].isin([value1, value2, value3, ...])]</pre>
<p>Or a combination of parameters:</p>
<pre data-type="programlisting">
df.loc[(df[<span>'OFNS_DESC'</span>] == value) &amp; (df[<span>'TRANSIT_DISTRICT'</span>] == value)]</pre>
<figure><div class="figure" id="geopandas_dataframe_visualized_on_a_map"><img alt="GeoPandas dataframe visualized on a map of New York City boroughs" height="1850" src="assets/pgda_0815.png" width="1142"/>
<h6><span class="label">Figure 8-15. </span>GeoPandas dataframe visualized on a map of New York City boroughs</h6>
</div></figure>
<p>Experiment <a contenteditable="false" data-primary="mapping patterns" data-secondary="shapefiles" data-startref="ix_mappattshpf" data-type="indexterm" id="idm45433739479760"/><a contenteditable="false" data-primary="shapefiles (.shp)" data-secondary="mapping data patterns from" data-startref="ix_shpmap" data-type="indexterm" id="idm45433739477280"/><a contenteditable="false" data-primary="patterns in data, mapping" data-secondary="shapefiles" data-startref="ix_pattmapshpf" data-type="indexterm" id="idm45433739475664"/><a contenteditable="false" data-primary="data cleaning" data-secondary="mapping patterns" data-startref="ix_daclmappattshp" data-tertiary="shapefiles" data-type="indexterm" id="idm45433739474048"/>with<a contenteditable="false" data-primary="data cleaning" data-secondary="mapping patterns" data-startref="ix_daclmappatt" data-type="indexterm" id="idm45433739472000"/> asking <a contenteditable="false" data-primary="mapping patterns" data-startref="ix_mappatt" data-type="indexterm" id="idm45433739470192"/>different <a contenteditable="false" data-primary="patterns in data, mapping" data-startref="ix_pattda" data-type="indexterm" id="idm45433739468656"/>questions!</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="summary-id00023">
<h1>Summary</h1>
<p>You have learned a variety of methods useful for cleaning your data. This is important, especially when working with open source data. For example, community-level data is often entered manually, and misspellings, missing dates, and the absence of geometry variables can limit the utility of these valuable resources.<a contenteditable="false" data-primary="data cleaning" data-startref="ix_dacln" data-type="indexterm" id="idm45433739925376"/></p>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="ch01fn11"><sup><a href="ch08.xhtml#ch01fn11-marker">1</a></sup> Bilogur, Aleksey. 2018. “Missingno: A Missing Data Visualization Suite.” <em>Journal of Open Source Software</em> 3 (22): 547. <a href="https://doi.org/10.21105/joss.00547"><em>https://doi.org/10.21105/joss.00547</em></a></p></div></div></section></div></body></html>