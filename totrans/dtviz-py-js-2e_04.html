<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 2. A Language-Learning Bridge Between Python and JavaScript" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter_language_bridge">
<h1><span class="label">Chapter 2. </span>A Language-Learning Bridge Between Python and JavaScript</h1>
<p>Probably the most ambitious aspect of this book is that it deals with two
programming languages.<a data-primary="Python" data-type="indexterm" id="idm45607814870864"/><a data-primary="JavaScript" data-type="indexterm" id="idm45607814870160"/> Moreover, it only requires that you are competent in one of
these languages. This is only possible because Python and JavaScript (JS)
are fairly simple languages with much in common. The aim of this chapter is to
draw out those commonalities and use them to make a learning bridge between the two languages
such that core skills acquired in one can easily be applied to the
other.</p>
<p>After showing the key similarities and differences between the two languages,
I’ll show how to set up a learning environment for Python and JS. The bulk of the
chapter will then
deal with core syntactical and conceptual differences, followed by a selection of patterns and idioms that I use often while
doing data visualization work.</p>
<section data-pdf-bookmark="Similarities and Differences" data-type="sect1"><div class="sect1" id="idm45607814868848">
<h1>Similarities and Differences</h1>
<p>Syntax differences aside, Python and JavaScript actually have a lot in common. After a short while, switching between them can be almost seamless.<sup><a data-type="noteref" href="ch02.xhtml#idm45607814867312" id="idm45607814867312-marker">1</a></sup> Let’s compare the two from a data visualizer’s <span class="keep-together">perspective</span>:</p>
<p>These are the chief <a data-primary="Python" data-secondary="similarities to JavaScript" data-type="indexterm" id="idm45607814863408"/><a data-primary="JavaScript" data-secondary="similarities to Python" data-type="indexterm" id="idm45607814862432"/>similarities:</p>
<ul>
<li>
<p>They both work without needing a compilation step (i.e., they are interpreted).</p>
</li>
<li>
<p>You can use both with an interactive interpreter, which means you can type in lines of code and see the results right away.</p>
</li>
<li>
<p>Both have <a href="https://oreil.ly/3QDQA">garbage collection</a>, which means they manage program memory <span class="keep-together">automatically</span>.</p>
</li>
<li>
<p>Neither language has header files, package boilerplate, and so on, as compared to languages like C++, Java, etc.</p>
</li>
<li>
<p>Both can happily be developed with a text editor or lightweight IDE.</p>
</li>
<li>
<p>In both, functions are first-class citizens, which can be passed as arguments.</p>
</li>
</ul>
<p>These are the key <a data-primary="JavaScript" data-secondary="differences from Python" data-type="indexterm" id="idm45607814853648"/><a data-primary="Python" data-secondary="differences from JavaScript" data-type="indexterm" id="idm45607814852640"/>differences:</p>
<ul>
<li>
<p>Possibly the biggest difference is that JavaScript is <a href="https://oreil.ly/Ja0FW">single-threaded and non-blocking</a>, using asynchronous I/O. This means that simple things like file access involve the use of a <a href="https://oreil.ly/L9DA5">callback function</a>, passed to another function and called on completion of some code, usually asynchronously.</p>
</li>
<li>
<p>JS is used essentially in web development and until relatively recently was browser-bound,<sup><a data-type="noteref" href="ch02.xhtml#idm45607814847776" id="idm45607814847776-marker">2</a></sup> but Python is used almost everywhere.</p>
</li>
<li>
<p>JS is the only<a data-primary="web browsers" data-secondary="JavaScript in" data-type="indexterm" id="idm45607814845536"/> first-class language in web browsers, Python being excluded.</p>
</li>
<li>
<p>Python has a comprehensive standard library, whereas JS has a limited set of utility objects (e.g., JSON, Math).</p>
</li>
<li>
<p>Python has fairly classical object-oriented classes, whereas JS uses prototype objects.</p>
</li>
<li>
<p>JS lacks heavyweight general-purpose data-processing libs.<sup><a data-type="noteref" href="ch02.xhtml#idm45607814841712" id="idm45607814841712-marker">3</a></sup></p>
</li>
</ul>
<p>The differences here emphasize the need for this book to be
bilingual. The <span class="keep-together">JavaScript</span> monopoly on browser dataviz needs the complement of a
conventional data-processing stack. And Python has the best there is.</p>
</div></section>
<section data-pdf-bookmark="Interacting with the Code" data-type="sect1"><div class="sect1" id="idm45607814838304">
<h1>Interacting with the Code</h1>
<p>One of the great advantages of Python and JavaScript is that because they are
interpreted on the fly, you can interact with them.<a data-primary="Python" data-secondary="interacting with the code" data-type="indexterm" id="ix_Pyinter"/> Python’s interpreter can be
run from the command line, whereas JavaScript’s is generally accessed from the
web browser through a console, usually available from the built-in development
tools. In this section, we’ll see how to fire up a session with the interpreter and start trying out your code.</p>
<section data-pdf-bookmark="Python" data-type="sect2"><div class="sect2" id="idm45607814835648">
<h2>Python</h2>
<p>By far, the best command-line Python interpreter is <a href="https://ipython.org">IPython</a>, which comes in three shades: the basic terminal version, an enhanced graphical version, and a browser-based notebook.<a data-primary="IPython" data-type="indexterm" id="idm45607814833072"/><a data-primary="Jupyter notebooks" data-type="indexterm" id="idm45607814832368"/><a data-primary="interpreters" data-secondary="Python" data-type="indexterm" id="idm45607814831696"/> Since IPython version 4.0, the latter two have been spun out into project <a href="https://jupyter.org">Jupyter</a>. The Jupyter notebook is a rather brilliant and fairly recent innovation, providing a browser-based interactive computational environment.  The great boon of the notebook is
session persistence and the possibility of web access.<sup><a data-type="noteref" href="ch02.xhtml#idm45607814829968" id="idm45607814829968-marker">4</a></sup> The ease with which one can share programming sessions, complete with embedded data visualizations, makes the notebook a fantastic teaching tool as well as a great way to recover programming context. That’s why the Python chapters of this book have accompanying Jupyter notebooks.</p>
<p>To start a Jupyter notebook just run <code>jupyter</code> at the <a data-primary="Jupyter notebooks" data-secondary="starting" data-type="indexterm" id="idm45607814828608"/>command line:</p>
<pre data-type="programlisting">$ jupyter notebook
[I 15:27:44.553 NotebookApp] Serving notebooks from local
directory:
...
[I 15:27:44.553 NotebookApp] http://localhost:8888/?token=5e09...</pre>
<p>Then open a browser tab at the URL specified (<em>http://localhost:8888</em> in this case) and start reading or writing Python notebooks.</p>
</div></section>
<section data-pdf-bookmark="JavaScript" data-type="sect2"><div class="sect2" id="bridge_js_interact">
<h2>JavaScript</h2>
<p>There are lots of options for trying out JavaScript code without starting a server, though the latter isn’t that difficult.<a data-primary="Python" data-secondary="interacting with the code" data-startref="ix_Pyinter" data-type="indexterm" id="idm45607814823280"/><a data-primary="JavaScript" data-secondary="interacting with the code" data-type="indexterm" id="ix_JSinter"/> Because the JavaScript interpreter comes embedded in all modern web browsers, there are a number of sites that let you try out bits of JavaScript along with HTML and CSS and see the results. <a href="https://oreil.ly/ZtROX">CodePen</a> is a good option. These sites are great for sharing code and trying out snippets, and usually allow you to add libraries such as <em>D3.js</em> with a few mouse-clicks.</p>
<p>If you want to try out code one-liners or quiz the state of live code, browser-based consoles are your best bet. <a data-primary="consoles (browser-based)" data-type="indexterm" id="idm45607814818992"/><a data-primary="web browsers" data-secondary="consoles, using to try out JavaScript code" data-type="indexterm" id="idm45607814818320"/><a data-primary="Chrome" data-secondary="accessing the console" data-type="indexterm" id="idm45607814817408"/>With Chrome, you can access the console with the key combo Ctrl-Shift-J (Command + Option + J on a Mac). As well as trying little JS snippets, the console allows you to drill down into any objects in scope, revealing their methods and properties. This is a great way to quiz the state of a live object and search for bugs.</p>
<p>One disadvantage of using<a data-primary="editors" data-secondary="JavaScript" data-type="indexterm" id="idm45607814815952"/> online JavaScript editors is losing the power of your
favorite editing environment, with linting, familiar keyboard shortcuts, and the
like (see <a data-type="xref" href="ch04.xhtml#chapter_webdev101">Chapter 4</a>). Online editors tend to be rudimentary, to say
the least. If you anticipate an extensive JavaScript session and want to use
your favorite editor, the best bet is to run a local server.</p>
<p>First, create a project directory—called <em>sandpit</em>, for example—and add a minimal HTML file that includes a JS script:</p>
<pre data-code-language="bash" data-type="programlisting">sandpit
├── index.xhtml
└── script.js</pre>
<p>The <em>index.xhtml</em> file need only be a few lines long, with an optional <code>div</code> placeholder on which to start building your visualization or just trying out a little DOM <span class="keep-together">manipulation</span>:</p>
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- index.xhtml --&gt;</code>
<code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>

<code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">'viz'</code><code class="p">&gt;&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

<code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"script.js"</code> <code class="na">async</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre>
<p>You can then add a little JavaScript to your <em>script.js</em> file:</p>
<pre data-code-language="js" data-type="programlisting"><code class="c1">// script.js</code>
<code class="kd">let</code> <code class="nx">data</code> <code class="o">=</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">7</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">9</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">11</code><code class="p">];</code>
<code class="kd">let</code> <code class="nx">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
<code class="nx">data</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">d</code><code class="p">){</code>
    <code class="nx">sum</code> <code class="o">+=</code> <code class="nx">d</code><code class="p">;</code>
<code class="p">});</code>

<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Sum = '</code> <code class="o">+</code> <code class="nx">sum</code><code class="p">);</code>
<code class="c1">// outputs 'Sum = 33'</code></pre>
<p>Start your <a data-primary="http module (Python)" data-type="indexterm" id="idm45607814637360"/>development server in the project directory using Python’s <code>http</code> module:</p>
<pre data-type="programlisting">$ python -m http.server 8000
Serving HTTP on 0.0.0.0 port 8000 ...</pre>
<p>Then open your browser at <em>http://localhost:8000</em>, press Ctrl-Shift-J (Cmd-Opt-J on OS X) to access the console and you should see <a data-type="xref" href="#langbridge_sum33">Figure 2-1</a>, showing the logged output of the script (see <a data-type="xref" href="ch04.xhtml#chapter_webdev101">Chapter 4</a> for further details).</p>
<figure><div class="figure" id="langbridge_sum33">
<img alt="dpj2 0201" height="139" src="assets/dpj2_0201.png" width="1092"/>
<h6><span class="label">Figure 2-1. </span>Outputting to the Chrome console</h6>
</div></figure>
<p>Now that we’ve established how to run the demo code, let’s start building a bridge between Python and JavaScript. First, we’ll cover the basic differences in syntax. As you’ll see, they’re fairly minor and easily absorbed.<a data-primary="JavaScript" data-secondary="interacting with the code" data-startref="ix_JSinter" data-type="indexterm" id="idm45607814630704"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Basic Bridge Work" data-type="sect1"><div class="sect1" id="idm45607814629360">
<h1>Basic Bridge Work</h1>
<p>In this section, I’ll contrast the basic nuts and bolts of programming in the two
languages.<a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-type="indexterm" id="ix_JSbrPy"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-type="indexterm" id="ix_PybrJS"/></p>
<section data-pdf-bookmark="Style Guidelines, PEP 8, and use strict" data-type="sect2"><div class="sect2" id="use_strict">
<h2>Style Guidelines, PEP 8, and use strict</h2>
<p>Where JavaScript style guidelines are a bit of a free-for-all (with people often defaulting to those used by a big library like React), Python has a Python Enhancement Proposal (PEP) dedicated to it.<a data-primary="style guidelines, Python versus JavaScript" data-type="indexterm" id="idm45607814608704"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="style guidelines, PEP 8 and use strict" data-type="indexterm" id="idm45607814607968"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="style guidelines, PEP 8 and use strict" data-type="indexterm" id="idm45607814606816"/><a data-primary="Python Enhancement Proposal (PEP), version 8" data-type="indexterm" id="idm45607814605664"/><a data-primary="PEP (Python Enhancement Proposal), version 8" data-type="indexterm" id="idm45607814604960"/> I’d recommend getting acquainted with PEP-8 but not submitting totally to its leadership. It’s right about most things, but there’s room for some personal choice here.<a data-primary="the Black Python code formatter" data-primary-sortas="Black" data-type="indexterm" id="idm45607814604128"/> There’s a handy online checker called <a href="http://pep8online.com">PEP8 Online</a>, which will pick up any infractions of PEP-8. Many Pythonistas are turning to <a href="https://oreil.ly/C9xWO">the Black Python code formatter</a>, which takes over formatting duties in accordance with PEP-8.</p>
<p>In Python, you should use four spaces to indent a code block. JavaScript is less strict, but two spaces is the most common indent.</p>
<p>One recent addition to JavaScript (ECMAScript 5) is the <code>'use strict'</code> directive, which imposes strict mode. <a data-primary="ECMAScript" data-secondary="strict mode in ECMAScript 5" data-type="indexterm" id="idm45607814600608"/>This mode enforces some good JavaScript practice, which includes catching accidental global declarations, and I thoroughly recommend its use. To use it, just place the string at the top of your function or module:</p>
<pre data-code-language="js" data-type="programlisting"><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">foo</code><code class="p">){</code>
  <code class="s1">'use strict'</code><code class="p">;</code>
  <code class="c1">// ...</code>
<code class="p">}(</code><code class="nb">window</code><code class="p">.</code><code class="nx">foo</code> <code class="o">=</code> <code class="nb">window</code><code class="p">.</code><code class="nx">foo</code> <code class="o">||</code> <code class="p">{}));</code></pre>
</div></section>
<section data-pdf-bookmark="CamelCase Versus Underscore" data-type="sect2"><div class="sect2" id="idm45607814574576">
<h2>CamelCase Versus Underscore</h2>
<p>JS conventionally<a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="CamelCase versus underscore" data-type="indexterm" id="idm45607814592880"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="CamelCase versus underscore" data-type="indexterm" id="idm45607814570336"/><a data-primary="variables" data-secondary="names of in JavaScript and Python" data-type="indexterm" id="idm45607814569184"/><a data-primary="CamelCase in variable names" data-type="indexterm" id="idm45607814568272"/><a data-primary="underscore (_)" data-secondary="in Python variable names" data-type="indexterm" id="idm45607814567632"/> uses CamelCase (e.g., <code>processStudentData</code>) for its variables, whereas Python, in accordance with PEP-8, uses underscores (e.g., <code>process_student_data</code>) in its variable names (see Section B in Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a>). By convention (and convention is more important in the Python ecosystem than it is in JS), Python uses capitalized CamelCase for class declarations (see the following example), uppercase for constants, and underscores for everything else:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">FOO_CONST</code> <code class="o">=</code> <code class="mi">10</code>
<code class="k">class</code> <code class="nc">FooBar</code><code class="p">(</code><code class="nb">object</code><code class="p">):</code> <code class="c1"># ...</code>
<code class="k">def</code> <code class="nf">foo_bar</code><code class="p">():</code>
    <code class="n">baz_bar</code> <code class="o">=</code> <code class="s1">'some string'</code></pre>
</div></section>
<section data-pdf-bookmark="Importing Modules, Including Scripts" data-type="sect2"><div class="sect2" id="idm45607817493520">
<h2>Importing Modules, Including Scripts</h2>
<p>Using other libraries in your code, either your own or third-party, is
fundamental to modern programming, which makes it all the more surprising that until relatively recently
JavaScript didn’t have a dedicated way of doing it.<sup><a data-type="noteref" href="ch02.xhtml#idm45607817504464" id="idm45607817504464-marker">5</a></sup> Python has a simple import system that, on the whole, works pretty
well.<a data-primary="imports" data-secondary="importing modules, including scripts" data-type="indexterm" id="idm45607817503728"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="importing modules, including scripts" data-type="indexterm" id="idm45607817502816"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="importing modules, including scripts" data-type="indexterm" id="idm45607817501664"/></p>
<p>The good news on the JavaScript front is that since ECMAScript 6,  JavaScript has addressed this issue, with the addition of <code>import</code> and <code>export</code> statements for encapsulated modules.<a data-primary="modules" data-secondary="importing in JavaScript and Python" data-type="indexterm" id="idm45607817499040"/><a data-primary="import and export statements in ECMAScript 6" data-type="indexterm" id="idm45607817498096"/><a data-primary="export and import statements in ECMAScript 6" data-type="indexterm" id="idm45607817497392"/><a data-primary="ECMAScript" data-secondary="import and export statements in ECMAScript 6" data-type="indexterm" id="idm45607817467968"/> We now have JavaScript modules (typically with the <code>.mjs</code> suffix) that can import and export encapsulated functions and objects, a huge step forward. In <a data-type="xref" href="part05.xhtml#part_viz">Part V</a>, we’ll see how easy these are to work with.</p>
<p>While getting comfortable with JS you’ll probably want to import third-party libraries using the <code>script</code> tag, which will typically see them added to the global namespace as an object. <a data-primary="script tags" data-secondary="importing third-party libraries using" data-type="indexterm" id="idm45607817464688"/><a data-primary="D3 library" data-secondary="importing using script tag" data-type="indexterm" id="idm45607817463744"/>For example, in order to use D3 you add the following <code>script</code> tag  to your HTML entry file (typically <em>index.xhtml</em>):</p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"http://d3js.org/d3.v7.min.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre>
<p>You can now use the D3 library like this:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">r</code> <code class="o">=</code> <code class="nx">d3</code><code class="p">.</code><code class="nx">range</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">r</code><code class="p">)</code>
<code class="c1">// out: [0, 2, 4, 6, 8]</code></pre>
<p>Python comes with “batteries included,” a comprehensive set of libraries covering everything from extended data containers (collections) to working with the family of CSV files (csv). <a data-primary="imports" data-secondary="import keyword in Python" data-type="indexterm" id="idm45607817396384"/>If you want to use one of these, just import it using the <code>import</code> keyword:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">sys</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">sys</code><code class="o">.</code><code class="n">platform</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="s1">'linux'</code></pre>
<p>If you <a data-primary="as keyword (Python)" data-type="indexterm" id="idm45607817350368"/><a data-primary="from keyword (Python)" data-type="indexterm" id="idm45607817349760"/>don’t want to import the whole library or want to use an alias, you can use the <code>as</code> and <code>from</code> keywords instead:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="k">as</code><code> </code><code class="nn">pd</code><code>
</code><code class="kn">from</code><code> </code><code class="nn">csv</code><code> </code><code class="kn">import</code><code> </code><code class="n">DictWriter</code><code class="p">,</code><code> </code><code class="n">DictReader</code><code>
</code><code class="kn">from</code><code> </code><code class="nn">numpy</code><code> </code><code class="kn">import</code><code> </code><code class="o">*</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO1-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO1-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>
</code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="s1">'</code><code class="s1">data.json</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="n">reader</code><code> </code><code class="o">=</code><code> </code><code class="n">DictReader</code><code class="p">(</code><code class="s1">'</code><code class="s1">data.csv</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="n">md</code><code> </code><code class="o">=</code><code> </code><code class="n">median</code><code class="p">(</code><code class="p">[</code><code class="mi">12</code><code class="p">,</code><code> </code><code class="mi">56</code><code class="p">,</code><code> </code><code class="mi">44</code><code class="p">,</code><code> </code><code class="mi">33</code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO1-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO1-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>This imports all the variables from the module into the current namespace and is almost always a bad idea. One of the variables could mask an existing one, and it goes against the Python best practice of explicit being better than implicit. One exception to this rule is if you are using the Python interpreter interactively. In this limited context, it may make sense to import all functions from a library to cut down on key presses; for example, importing all the math functions (<code>from math import *</code>) if doing some Python math hacking.<a data-primary="sys.path (Python)" data-type="indexterm" id="idm45607817266144"/></p></dd>
</dl>
<p>If you import a nonstandard library, Python uses <code>sys.path</code> to try to find it. <code>sys.path</code> consists of:</p>
<ul>
<li>
<p>The directory containing the importing module (current <span class="keep-together">directory</span>)</p>
</li>
<li>
<p>The <code>PYTHONPATH</code> variable, containing a list of directories</p>
</li>
<li>
<p>The installation-dependent default, where libraries installed using <code>pip</code> or <code>easy_install</code> will usually be placed</p>
</li>
</ul>
<p>Big libraries are often packaged, divided into submodules.<a data-primary="dot notation (.)" data-secondary="accessing submodules in large libraries" data-type="indexterm" id="idm45607817229808"/> These submodules are accessed by dot notation:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code></pre>
<p>Packages <a data-primary="packages, building in Python" data-type="indexterm" id="idm45607817225056"/>are constructed from the filesystem via <em>__init__.py</em> files, usually empty, as shown in <a data-type="xref" href="#pyjs_import">Example 2-1</a>. The presence of an init file makes the directory visible to Python’s import system.</p>
<div data-type="example" id="pyjs_import">
<h5><span class="label">Example 2-1. </span>Building a Python package</h5>
<pre data-code-language="bash" data-type="programlisting"><code>mypackage</code><code>
</code><code>├──</code><code> </code><code>__init__.py</code><code>
</code><code>...</code><code>
</code><code>├──</code><code> </code><code>core</code><code>
</code><code>│</code><code>   </code><code>└──</code><code> </code><code>__init__.py</code><code>
</code><code>│</code><code>   </code><code>...</code><code>
</code><code>...</code><code>
</code><code>└──</code><code> </code><code>io</code><code>
    </code><code>├──</code><code> </code><code>__init__.py</code><code>
    </code><code>└──</code><code> </code><code>api.py</code><code>
    </code><code>...</code><code>
    </code><code>└──</code><code> </code><code>tests</code><code>
        </code><code>└──</code><code> </code><code>__init__.py</code><code>
        </code><code>└──</code><code> </code><code>test_data.py</code><code>
        </code><code>└──</code><code> </code><code>test_excel.py</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO2-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO2-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
        </code><code>...</code><code>
</code><code>...</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO2-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO2-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>You would import this module using <code>from mypackage.io.tests import test_excel</code>.</p></dd>
</dl></div>
<p>You can access packages on <code>sys.path</code> from the root directory (that’s <code>mypackage</code> in <a data-type="xref" href="#pyjs_import">Example 2-1</a>) using dot notation. A special case of <code>import</code> is intrapackage references. <a data-primary="intrapackage references (Python imports)" data-type="indexterm" id="idm45607817162848"/>The <code>test_excel.py</code> submodule in <a data-type="xref" href="#pyjs_import">Example 2-1</a> can import submodules from the <code>mypackage</code> package both absolutely and relatively:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code><code> </code><code class="nn">mypackage</code><code class="nn">.</code><code class="nn">io</code><code class="nn">.</code><code class="nn">tests</code><code> </code><code class="kn">import</code><code> </code><code class="n">test_data</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO3-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO3-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="kn">from</code><code> </code><code class="nn">.</code><code> </code><code class="kn">import</code><code> </code><code class="n">test_data</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO3-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO3-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="kn">import</code><code> </code><code class="nn">test_data</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO3-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO3-3"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="kn">from</code><code> </code><code class="nn">.</code><code class="nn">.</code><code class="nn">io</code><code> </code><code class="kn">import</code><code> </code><code class="n">api</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO3-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO3-4"><img alt="3" height="12" src="assets/3.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO3-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO3-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Imports the <code>test_data.py</code> module absolutely, from the package’s head directory.<a data-primary="explicit imports (Python)" data-type="indexterm" id="idm45607817101776"/><a data-primary="relative imports (Python)" data-type="indexterm" id="idm45607817101104"/></p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO3-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO3-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>An explicit (<code>. import</code>) and implicit relative import.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO3-4" id="callout_a_language_learning_bridge_between_python_and_javascript_CO3-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>A relative import from a sibling package of <code>tests</code>.</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="JavaScript Modules" data-type="sect2"><div class="sect2" id="sect_js_modules">
<h2>JavaScript Modules</h2>
<p>JavaScript now has modules with import and export of encapsulated variables.<a data-primary="modules" data-secondary="JavaScript" data-tertiary="importing and exporting" data-type="indexterm" id="idm45607817067232"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="modules" data-type="indexterm" id="idm45607817065984"/> JS cherry-picked its import syntax, using a lot of stuff that will be familiar to Pythonistas but, in my opinion, improving on it. Here’s a brief run-down:</p>
<p>Let’s say we have a JS entry-point module <code>index.js</code>, which wants to use some functions or objects from a library module <code>libFoo.js</code> in a <code>lib</code> directory. The file structure looks like this:</p>
<pre data-type="programlisting">.
├── index.mjs
└── lib
    └── libFoo.mjs</pre>
<p>In <code>libFoo.mjs</code> we export a dummy function and can use <code>export default</code> to export a single object for the module, typically an API with, for example, utility methods:</p>
<pre data-code-language="js" data-type="programlisting"><code class="c1">// lib/libFoo.mjs
</code><code class="kr">export</code><code> </code><code class="kd">let</code><code> </code><code class="nx">findOdds</code><code> </code><code class="o">=</code><code> </code><code class="p">(</code><code class="nx">a</code><code class="p">)</code><code> </code><code class="o">=&gt;</code><code> </code><code class="p">{</code><code>
  </code><code class="k">return</code><code> </code><code class="nx">a</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">x</code><code> </code><code class="o">=&gt;</code><code> </code><code class="nx">x</code><code class="o">%</code><code class="mi">2</code><code class="p">)</code><code>
</code><code class="p">}</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">api</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="nx">findOdds</code><code class="p">}</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO4-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO4-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>

</code><code class="kr">export</code><code> </code><code class="k">default</code><code> </code><code class="nx">api</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO4-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO4-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>An example of object creation with shorthand property name, equivalent to <code>{findOdds: findOdds}</code></p></dd>
</dl>
<p>To import the exported functions and objects from our index module we use the <code>import</code> statement, which allows us to import the default API or select exported variables by name <a data-primary="curly braces ({})" data-secondary="using in JavaScript imports" data-type="indexterm" id="idm45607817016176"/>using curly brackets:</p>
<pre data-code-language="js" data-type="programlisting"><code class="c1">// index.mjs</code>
<code class="kr">import</code> <code class="nx">api</code> <code class="nx">from</code> <code class="s1">'./lib/libFoo.mjs'</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">findOdds</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./lib/libFoo.mjs'</code>

<code class="kd">let</code> <code class="nx">odds</code> <code class="o">=</code> <code class="nx">findOdds</code><code class="p">([</code><code class="mi">2</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">24</code><code class="p">,</code> <code class="mi">33</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">66</code><code class="p">,</code> <code class="mi">24</code><code class="p">])</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Odd numbers: '</code><code class="p">,</code> <code class="nx">odds</code><code class="p">)</code>

<code class="nx">odds</code> <code class="o">=</code> <code class="nx">api</code><code class="p">.</code><code class="nx">findOdds</code><code class="p">([</code><code class="mi">12</code><code class="p">,</code> <code class="mi">43</code><code class="p">,</code> <code class="mi">22</code><code class="p">,</code> <code class="mi">39</code><code class="p">,</code> <code class="mi">52</code><code class="p">,</code> <code class="mi">21</code><code class="p">])</code>
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Odd numbers: '</code><code class="p">,</code> <code class="nx">odds</code><code class="p">)</code></pre>
<p>JS imports also support <a data-primary="aliasing in JavaScript imports" data-type="indexterm" id="idm45607816968688"/>aliasing, which can be a great code sanitizer:</p>
<pre data-code-language="js" data-type="programlisting"><code class="c1">// index.mjs</code>
<code class="kr">import</code> <code class="nx">api</code> <code class="nx">as</code> <code class="nx">foo</code> <code class="nx">from</code> <code class="s1">'./lib/libFoo.mjs'</code>
<code class="kr">import</code> <code class="p">{</code> <code class="nx">findOdds</code> <code class="nx">as</code> <code class="nx">odds</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'./lib/libFoo.mjs'</code>
<code class="c1">// ...</code></pre>
<p>As you can see, JavaScript imports and exports are very similar to Python’s, though a little more user-friendly in my experience. You can see more details in Mozilla’s documentation for <a href="https://oreil.ly/J0aDV">exports</a> and <a href="https://oreil.ly/slsT5">imports</a>.</p>
</div></section>
<section data-pdf-bookmark="Keeping Your Namespaces Clean" data-type="sect2"><div class="sect2" id="sect_namespaces">
<h2>Keeping Your Namespaces Clean</h2>
<p>The variables defined in Python modules are encapsulated, which means that unless you import them explicitly (e.g., <code>from foo import baa</code>), you will be accessing them from the imported module’s namespace using dot notation (e.g., <code>foo.baa</code>). <a data-primary="dot notation (.)" data-secondary="in namespaces" data-secondary-sortas="namespaces" data-type="indexterm" id="idm45607819376432"/><a data-primary="namespaces, keeping clean" data-type="indexterm" id="idm45607819374896"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="keeping namespaces clean" data-type="indexterm" id="idm45607819374256"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="keeping namespaces clean" data-type="indexterm" id="idm45607819373104"/>This modularization of the global namespace is quite rightly seen as a very good thing and plays to one of Python’s key tenets: the importance of explicit statements over implicit. When analyzing someone’s Python code you should be able to see exactly where a class, function, or variable has come from. Just as importantly, preserving the namespace limits the chance of conflicting or masking variables—a big potential problem as codebases get larger.</p>
<p>In the past one of the main criticisms of JavaScript, and a fair one, was that it played fast
and loose with namespace conventions. The most egregious example of this is that
variables declared outside of functions or missing the <code>var</code>
keyword<sup><a data-type="noteref" href="ch02.xhtml#idm45607819371024" id="idm45607819371024-marker">6</a></sup> are global rather than confined to the
script in which they are declared.  With modern, modular JavaScript you get Python-like encapsulation with imported and exported variables.<a data-primary="var keyword (JavaScript)" data-type="indexterm" id="idm45607819369472"/></p>
<p>JS modules are a relatively recent game changer—a common pattern used in the past and one that you may well run into is the creation of a self-calling function in order to isolate local variables from the global namespace.<a data-primary="modules" data-secondary="JavaScript" data-tertiary="pattern for encapsulated module" data-type="indexterm" id="idm45607819368416"/><a data-primary="let keyword (JavaScript)" data-secondary="using in preference to var" data-type="indexterm" id="idm45607819367200"/>
This makes all variables declared via <code>var</code> local to the script/function, preventing them from polluting the global namespace. The JavaScript <a href="https://oreil.ly/cTxOy"><code>let</code></a> keyword, which is block-scoped, is pretty much always preferable to <code>var</code>. Any objects, functions, and variables you want to make available to other scripts can be attached to an object that is part of the global namespace.</p>
<p><a data-type="xref" href="#pyjs_module">Example 2-2</a> demonstrates a module pattern. The boilerplate head and tail (labeled <img alt="1" height="12" src="assets/1.png" width="12"/> and <img alt="3" height="12" src="assets/3.png" width="12"/>) effectively create an encapsulated module. This pattern is far from a perfect solution to modular JavaScript but was the best compromise I knew of until ECMAScript 6’s dedicated import system was adopted by all major browsers.</p>
<div data-type="example" id="pyjs_module">
<h5><span class="label">Example 2-2. </span>A module pattern for JavaScript</h5>
<pre data-code-language="js" data-type="programlisting"><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">nbviz</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO5-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO5-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="s1">'use strict'</code><code class="p">;</code><code>
    </code><code class="c1">// ...
</code><code>    </code><code class="nx">nbviz</code><code class="p">.</code><code class="nx">updateTimeChart</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">data</code><code class="p">)</code><code> </code><code class="p">{</code><code class="p">.</code><code class="p">.</code><code class="p">}</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO5-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO5-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
    </code><code class="c1">// ...
</code><code class="p">}</code><code class="p">(</code><code class="nb">window</code><code class="p">.</code><code class="nx">nbviz</code><code> </code><code class="o">=</code><code> </code><code class="nb">window</code><code class="p">.</code><code class="nx">nbviz</code><code> </code><code class="o">||</code><code> </code><code class="p">{</code><code class="p">}</code><code class="p">)</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO5-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO5-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO5-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO5-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Receives the global <code>nbviz</code> object.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO5-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO5-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Attaches the <code>updateTimeChart</code> method to the global <code>nbviz</code> object, effectively <em>exporting</em> it.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO5-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO5-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>If an <code>nbviz</code> object exists in the global (window) namespace, pass it into the module function; otherwise, add it to the global namespace.</p></dd>
</dl></div>
</div></section>
<section data-pdf-bookmark="Outputting “Hello World!”" data-type="sect2"><div class="sect2" id="idm45607819262192">
<h2>Outputting “Hello World!”</h2>
<p>By far the most popular initial demonstration of any programming language is
getting it to print or communicate “Hello World!” in some form, so let’s start
with getting output from Python and <span class="keep-together">JavaScript</span>.</p>
<p>Python’s output couldn’t be much simpler:</p>
<pre data-code-language="python" data-type="programlisting"><code class="nb">print</code><code class="p">(</code><code class="s1">'Hello World!'</code><code class="p">)</code></pre>
<p>JavaScript has no print function, but you can log output to the browser console:</p>
<pre data-code-language="js" data-type="programlisting"><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Hello World!'</code><code class="p">)</code></pre>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Simple Data Processing" data-type="sect2"><div class="sect2" id="idm45607819248064">
<h2>Simple Data Processing</h2>
<p>A good way to get an overview of the language differences is to see the same function written in both.<a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="data transformation, simple example" data-type="indexterm" id="idm45607819246400"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="data transformation, simple example" data-type="indexterm" id="idm45607819245216"/><a data-primary="data processing" data-secondary="simple data processing example in Python versus JavaScript" data-type="indexterm" id="idm45607819223872"/> Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a> show a small, contrived example of data munging in Python and JavaScript, respectively. We’ll use these to compare Python and JS syntax and label them with capital letters (A, B…​) to allow comparison of the code blocks.</p>
<div data-type="example" id="ex1_py">
<h5><span class="label">Example 2-3. </span>Simple data transformation with Python</h5>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># A</code>
<code class="n">student_data</code> <code class="o">=</code> <code class="p">[</code>
    <code class="p">{</code><code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Bob'</code><code class="p">,</code> <code class="s1">'id'</code><code class="p">:</code><code class="mi">0</code><code class="p">,</code> <code class="s1">'scores'</code><code class="p">:[</code><code class="mi">68</code><code class="p">,</code> <code class="mi">75</code><code class="p">,</code> <code class="mi">56</code><code class="p">,</code> <code class="mi">81</code><code class="p">]},</code>
    <code class="p">{</code><code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Alice'</code><code class="p">,</code> <code class="s1">'id'</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code>  <code class="s1">'scores'</code><code class="p">:[</code><code class="mi">75</code><code class="p">,</code> <code class="mi">90</code><code class="p">,</code> <code class="mi">64</code><code class="p">,</code> <code class="mi">88</code><code class="p">]},</code>
    <code class="p">{</code><code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Carol'</code><code class="p">,</code> <code class="s1">'id'</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code> <code class="s1">'scores'</code><code class="p">:[</code><code class="mi">59</code><code class="p">,</code> <code class="mi">74</code><code class="p">,</code> <code class="mi">71</code><code class="p">,</code> <code class="mi">68</code><code class="p">]},</code>
    <code class="p">{</code><code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Dan'</code><code class="p">,</code> <code class="s1">'id'</code><code class="p">:</code><code class="mi">3</code><code class="p">,</code> <code class="s1">'scores'</code><code class="p">:[</code><code class="mi">64</code><code class="p">,</code> <code class="mi">58</code><code class="p">,</code> <code class="mi">53</code><code class="p">,</code> <code class="mi">62</code><code class="p">]},</code>
<code class="p">]</code>

<code class="c1"># B</code>
<code class="k">def</code> <code class="nf">process_student_data</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">pass_threshold</code><code class="o">=</code><code class="mi">60</code><code class="p">,</code>
                         <code class="n">merit_threshold</code><code class="o">=</code><code class="mi">75</code><code class="p">):</code>
    <code class="sd">""" Perform some basic stats on some student data. """</code>

    <code class="c1"># C</code>
    <code class="k">for</code> <code class="n">sdata</code> <code class="ow">in</code> <code class="n">data</code><code class="p">:</code>
        <code class="n">av</code> <code class="o">=</code> <code class="nb">sum</code><code class="p">(</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'scores'</code><code class="p">])</code><code class="o">/</code><code class="nb">float</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'scores'</code><code class="p">]))</code>

        <code class="k">if</code> <code class="n">av</code> <code class="o">&gt;</code> <code class="n">merit_threshold</code><code class="p">:</code>
            <code class="n">sdata</code><code class="p">[</code><code class="s1">'assessment'</code><code class="p">]</code> <code class="o">=</code> <code class="s1">'passed with merit'</code>
        <code class="k">elif</code> <code class="n">av</code> <code class="o">&gt;=</code> <code class="n">pass_threshold</code><code class="p">:</code>
            <code class="n">sdata</code><code class="p">[</code><code class="s1">'assessment'</code><code class="p">]</code> <code class="o">=</code> <code class="s1">'passed'</code>
        <code class="k">else</code><code class="p">:</code>
            <code class="n">sdata</code><code class="p">[</code><code class="s1">'assessment'</code><code class="p">]</code> <code class="o">=</code> <code class="s1">'failed'</code>
        <code class="c1"># D</code>
        <code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s2">"</code><code class="si">{</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'name'</code><code class="p">]</code><code class="si">}</code><code class="s2">'s (id: </code><code class="si">{</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'id'</code><code class="p">]</code><code class="si">}</code><code class="s2">) final assessment is:</code><code class="se">\</code>
<code class="s2">        </code><code class="si">{</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'assessment'</code><code class="p">]</code><code class="o">.</code><code class="n">upper</code><code class="p">()</code><code class="si">}</code><code class="s2">"</code><code class="p">)</code>
        <code class="c1"># For Python versions before 3.7, the old-style string formatting is equivalent</code>
        <code class="c1"># print("%s's (id: %d) final assessment is: %s"%(sdata['name'],\</code>
        <code class="c1"># sdata['id'], sdata['assessment'].upper()))     sdata['name'], sdata['id'],\</code>
        <code class="c1"># sdata['assessment'].upper()))</code>
        <code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s2">"</code><code class="si">{</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'name'</code><code class="p">]</code><code class="si">}</code><code class="s2">'s (id: </code><code class="si">{</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'id'</code><code class="p">]</code><code class="si">}</code><code class="s2">) final assessment is:</code><code class="se">\</code>
<code class="s2">         </code><code class="si">{</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'assessment'</code><code class="p">]</code><code class="o">.</code><code class="n">upper</code><code class="p">()</code><code class="si">}</code><code class="s2">"</code><code class="p">)</code>

        <code class="n">sdata</code><code class="p">[</code><code class="s1">'average'</code><code class="p">]</code> <code class="o">=</code> <code class="n">av</code>

<code class="c1"># E</code>
<code class="k">if</code> <code class="vm">__name__</code> <code class="o">==</code> <code class="s1">'__main__'</code><code class="p">:</code>
    <code class="n">process_student_data</code><code class="p">(</code><code class="n">student_data</code><code class="p">)</code></pre></div>
<div data-type="example" id="ex1_js">
<h5><span class="label">Example 2-4. </span>Simple data munging with JavaScript</h5>
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">studentData</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO6-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO6-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="p">{</code><code class="nx">name</code><code class="o">:</code><code> </code><code class="s1">'Bob'</code><code class="p">,</code><code> </code><code class="nx">id</code><code class="o">:</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="s1">'scores'</code><code class="o">:</code><code class="p">[</code><code class="mi">68</code><code class="p">,</code><code> </code><code class="mi">75</code><code class="p">,</code><code> </code><code class="mi">76</code><code class="p">,</code><code> </code><code class="mi">81</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
    </code><code class="p">{</code><code class="nx">name</code><code class="o">:</code><code> </code><code class="s1">'Alice'</code><code class="p">,</code><code> </code><code class="nx">id</code><code class="o">:</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'scores'</code><code class="o">:</code><code class="p">[</code><code class="mi">75</code><code class="p">,</code><code> </code><code class="mi">90</code><code class="p">,</code><code> </code><code class="mi">64</code><code class="p">,</code><code> </code><code class="mi">88</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
    </code><code class="p">{</code><code class="s1">'name'</code><code class="o">:</code><code> </code><code class="s1">'Carol'</code><code class="p">,</code><code> </code><code class="nx">id</code><code class="o">:</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'scores'</code><code class="o">:</code><code class="p">[</code><code class="mi">59</code><code class="p">,</code><code> </code><code class="mi">74</code><code class="p">,</code><code> </code><code class="mi">71</code><code class="p">,</code><code> </code><code class="mi">68</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
    </code><code class="p">{</code><code class="s1">'name'</code><code class="o">:</code><code> </code><code class="s1">'Dan'</code><code class="p">,</code><code> </code><code class="nx">id</code><code class="o">:</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="s1">'scores'</code><code class="o">:</code><code class="p">[</code><code class="mi">64</code><code class="p">,</code><code> </code><code class="mi">58</code><code class="p">,</code><code> </code><code class="mi">53</code><code class="p">,</code><code> </code><code class="mi">62</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
</code><code class="p">]</code><code class="p">;</code><code>

</code><code class="c1">// B
</code><code class="kd">function</code><code> </code><code class="nx">processStudentData</code><code class="p">(</code><code class="nx">data</code><code class="p">,</code><code> </code><code class="nx">passThreshold</code><code class="p">,</code><code> </code><code class="nx">meritThreshold</code><code class="p">)</code><code class="p">{</code><code>
    </code><code class="nx">passThreshold</code><code> </code><code class="o">=</code><code> </code><code class="k">typeof</code><code> </code><code class="nx">passThreshold</code><code> </code><code class="o">!==</code><code> </code><code class="s1">'undefined'</code><code class="o">?</code><code class="o">\</code><code>
    </code><code class="nx">passThreshold</code><code class="o">:</code><code> </code><code class="mi">60</code><code class="p">;</code><code>
    </code><code class="nx">meritThreshold</code><code> </code><code class="o">=</code><code> </code><code class="k">typeof</code><code> </code><code class="nx">meritThreshold</code><code> </code><code class="o">!==</code><code> </code><code class="s1">'undefined'</code><code class="o">?</code><code class="o">\</code><code>
    </code><code class="nx">meritThreshold</code><code class="o">:</code><code> </code><code class="mi">75</code><code class="p">;</code><code>

    </code><code class="c1">// C
</code><code>    </code><code class="nx">data</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">sdata</code><code class="p">)</code><code class="p">{</code><code>
        </code><code class="kd">let</code><code> </code><code class="nx">av</code><code> </code><code class="o">=</code><code> </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">scores</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">prev</code><code class="p">,</code><code> </code><code class="nx">current</code><code class="p">)</code><code class="p">{</code><code>
            </code><code class="k">return</code><code> </code><code class="nx">prev</code><code class="o">+</code><code class="nx">current</code><code class="p">;</code><code>
        </code><code class="p">}</code><code class="p">,</code><code class="mi">0</code><code class="p">)</code><code> </code><code class="o">/</code><code> </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">scores</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code><code>

        </code><code class="k">if</code><code class="p">(</code><code class="nx">av</code><code> </code><code class="o">&gt;</code><code> </code><code class="nx">meritThreshold</code><code class="p">)</code><code class="p">{</code><code>
            </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">assessment</code><code> </code><code class="o">=</code><code> </code><code class="s1">'passed with merit'</code><code class="p">;</code><code>
        </code><code class="p">}</code><code>
        </code><code class="k">else</code><code> </code><code class="k">if</code><code class="p">(</code><code class="nx">av</code><code> </code><code class="o">&gt;=</code><code> </code><code class="nx">passThreshold</code><code class="p">)</code><code class="p">{</code><code>
            </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">assessment</code><code> </code><code class="o">=</code><code> </code><code class="s1">'passed'</code><code class="p">;</code><code>
        </code><code class="p">}</code><code>
        </code><code class="k">else</code><code class="p">{</code><code>
            </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">assessment</code><code> </code><code class="o">=</code><code> </code><code class="s1">'failed'</code><code class="p">;</code><code>
        </code><code class="p">}</code><code>
        </code><code class="c1">// D
</code><code>        </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sdata</code><code class="p">.</code><code class="nx">name</code><code> </code><code class="o">+</code><code> </code><code class="s2">"'s (id: "</code><code> </code><code class="o">+</code><code> </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">id</code><code> </code><code class="o">+</code><code>
          </code><code class="s2">") final assessment is: "</code><code> </code><code class="o">+</code><code>
            </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">assessment</code><code class="p">.</code><code class="nx">toUpperCase</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code class="p">;</code><code>
        </code><code class="nx">sdata</code><code class="p">.</code><code class="nx">average</code><code> </code><code class="o">=</code><code> </code><code class="nx">av</code><code class="p">;</code><code>
    </code><code class="p">}</code><code class="p">)</code><code class="p">;</code><code>

</code><code class="p">}</code><code>

</code><code class="c1">// E
</code><code class="nx">processStudentData</code><code class="p">(</code><code class="nx">studentData</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO6-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO6-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Note the deliberate and valid inconsistency in the object keys with some quoted and some unquoted.</p></dd>
</dl></div>
</div></section>
<section data-pdf-bookmark="String Construction" data-type="sect2"><div class="sect2" id="idm45607813466800">
<h2>String Construction</h2>
<p>The D sections in Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a> show the standard way to print output to the console or terminal. <a data-primary="strings" data-secondary="constructing in JavaScript versus Python" data-type="indexterm" id="idm45607813462576"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="string construction" data-type="indexterm" id="idm45607813598096"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="string construction" data-type="indexterm" id="idm45607813596912"/>JavaScript has no <code>print</code> statement but will log to the browser’s console through the <code>console</code> object:</p>
<pre data-code-language="js" data-type="programlisting"><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">sdata</code><code class="p">.</code><code class="nx">name</code> <code class="o">+</code> <code class="s2">"'s (id: "</code> <code class="o">+</code> <code class="nx">sdata</code><code class="p">.</code><code class="nx">id</code> <code class="o">+</code>
  <code class="s2">") final assessment is: "</code> <code class="o">+</code> <code class="nx">sdata</code><code class="p">.</code><code class="nx">assessment</code><code class="p">.</code><code class="nx">toUpperCase</code><code class="p">());</code></pre>
<p>Note that the integer variable <code>id</code> is coerced to a string, allowing concatenation. Python doesn’t perform this implicit coercion, so attempting to add a string to an integer in this way gives an error. Instead, explicit conversion to string form is achieved through one of the <code>str</code> or <code>repr</code> functions.</p>
<p>In section A of <a data-type="xref" href="#ex1_py">Example 2-3</a>, the output string is constructed with C type formatting. String (<code>%s</code>) and integer (<code>%d</code>) placeholders are provided by a final tuple (<code>%(…​)</code>):</p>
<pre data-code-language="python" data-type="programlisting"><code class="nb">print</code><code class="p">(</code><code class="s2">"</code><code class="si">%s</code><code class="s2">'s (id: </code><code class="si">%d</code><code class="s2">) final assessment is: </code><code class="si">%s</code><code class="s2">"</code>
  <code class="o">%</code><code class="p">(</code><code class="n">sdata</code><code class="p">[</code><code class="s1">'name'</code><code class="p">],</code> <code class="n">sdata</code><code class="p">[</code><code class="s1">'id'</code><code class="p">],</code> <code class="n">sdata</code><code class="p">[</code><code class="s1">'assessment'</code><code class="p">]</code><code class="o">.</code><code class="n">upper</code><code class="p">()))</code></pre>
<p>These days, I rarely use Python’s <code>print</code> statement, opting for the much more powerful and flexible <code>logging</code> module, which is demonstrated in the following code block.  <a data-primary="print function (Python), using logging module instead of" data-type="indexterm" id="idm45607813521936"/><a data-primary="logging module (Python)" data-type="indexterm" id="idm45607813521328"/>It takes a little more effort to use, but it is worth it. Logging gives you the flexibility to direct output to a file and/or the screen, adjusting the logging level to prioritize certain information, and a whole load of other useful things. Check out the details in the <a href="https://oreil.ly/aJzyx">Python documentation</a>.</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code><code> </code><code class="nn">logging</code><code>
</code><code class="n">logger</code><code> </code><code class="o">=</code><code> </code><code class="n">logging</code><code class="o">.</code><code class="n">getLogger</code><code class="p">(</code><code class="vm">__name__</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO7-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO7-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="o">/</code><code class="o">/</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>
</code><code class="n">logger</code><code class="o">.</code><code class="n">debug</code><code class="p">(</code><code class="s1">'</code><code class="s1">Some useful debugging output</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="n">logger</code><code class="o">.</code><code class="n">info</code><code class="p">(</code><code class="s1">'</code><code class="s1">Some general information</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>
</code><code class="o">/</code><code class="o">/</code><code> </code><code class="n">IN</code><code> </code><code class="n">INITIAL</code><code> </code><code class="n">MODULE</code><code>
</code><code class="n">logging</code><code class="o">.</code><code class="n">basicConfig</code><code class="p">(</code><code class="n">level</code><code class="o">=</code><code class="n">logging</code><code class="o">.</code><code class="n">DEBUG</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO7-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO7-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO7-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO7-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Creates a logger with the name of this module.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO7-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO7-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Setting the logging level to “debug” provides the most detailed information available (see the <a href="https://oreil.ly/xAiP1">Python documentation</a> for further details).</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="Significant Whitespace Versus Curly Brackets" data-type="sect2"><div class="sect2" id="idm45607813667344">
<h2>Significant Whitespace Versus Curly Brackets</h2>
<p>The syntactic <a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="significant whitespaces versus curly brackets" data-type="indexterm" id="idm45607813741408"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="significant whitespaces versus curly brackets" data-type="indexterm" id="idm45607813740304"/><a data-primary="whitespace in Python versus JavaScript" data-type="indexterm" id="idm45607813739152"/>feature most associated with Python is significant whitespace. Whereas languages like C and JavaScript use whitespace for readability and could easily be condensed into one line,<sup><a data-type="noteref" href="ch02.xhtml#idm45607813738384" id="idm45607813738384-marker">7</a></sup> in Python leading spaces are used to indicate code blocks and removing them changes the meaning of the code. The extra effort required to maintain correct code alignment is  more than compensated for by increased readability—you spend far longer reading than writing code, and the easy reading of Python is probably the main reason why the Python library ecosystem is so healthy. <a data-primary="soft tabs" data-type="indexterm" id="idm45607813737616"/>Four spaces is pretty much mandatory (see PEP-8) and my personal preference is for what are known as <em>soft tabs</em>, where your editor inserts (and deletes) multiple spaces instead of a tab character.<sup><a data-type="noteref" href="ch02.xhtml#idm45607813736320" id="idm45607813736320-marker">8</a></sup></p>
<p>In the following code, the indentation of the <code>return</code> statement must be four spaces by convention:<sup><a data-type="noteref" href="ch02.xhtml#idm45607813735088" id="idm45607813735088-marker">9</a></sup></p>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code> <code class="nf">doubler</code><code class="p">(</code><code class="n">x</code><code class="p">):</code>
    <code class="k">return</code> <code class="n">x</code> <code class="o">*</code> <code class="mi">2</code>
<code class="c1">#  |&lt;-this spacing is important</code></pre>
<p>JavaScript doesn’t care <a data-primary="curly braces ({})" data-secondary="delimiting code blocks in JavaScript" data-type="indexterm" id="idm45607814003888"/>about the number of spaces between statements and variables, using curly brackets to demark code blocks; the two doubler functions in this code are equivalent:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">doubler</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">){</code>
  <code class="k">return</code> <code class="nx">x</code> <code class="o">*</code> <code class="mi">2</code><code class="p">;</code>
<code class="p">}</code>

<code class="kd">let</code> <code class="nx">doubler</code><code class="o">=</code><code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">){</code><code class="k">return</code> <code class="nx">x</code><code class="o">*</code><code class="mi">2</code><code class="p">;}</code></pre>
<p>Much is made of Python’s whitespace, but most good coders I know set up their editors to enforce indented code blocks and a consistent look and feel. Python merely enforces this good practice. And, to reiterate,  I believe the extreme readability of Python code contributes as much to Python’s supremely healthy ecosystem as its simple syntax.</p>
</div></section>
<section data-pdf-bookmark="Comments and Doc-Strings" data-type="sect2"><div class="sect2" id="idm45607813976816">
<h2>Comments and Doc-Strings</h2>
<p>To add <a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="comments and doc-strings" data-type="indexterm" id="idm45607813957920"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="comments and doc-strings" data-type="indexterm" id="idm45607813956704"/><a data-primary="comments" data-secondary="syntax differences between Python and JavaScript" data-type="indexterm" id="idm45607813955552"/>comments to code, Python uses hashes, <em>#</em>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># ex.py, a single informative comment</code>

<code class="n">data</code> <code class="o">=</code> <code class="p">{}</code> <code class="c1"># Our main data-ball</code></pre>
<p>By contrast, JavaScript uses the C language convention of double backslashes (<em>//</em>) or <em>/* …​ */</em> for multiline comments:</p>
<pre data-code-language="js" data-type="programlisting"><code class="c1">// script.js, a single informative comment</code>
<code class="cm">/* A multiline comment block for</code>
<code class="cm">function descriptions, library script</code>
<code class="cm">headers, and the like */</code>
<code class="kd">let</code> <code class="nx">data</code> <code class="o">=</code> <code class="p">{};</code> <code class="c1">// Our main data-ball</code></pre>
<p class="pagebreak-before">In addition to comments, and in keeping with its philosophy of readability and transparency, Python has documentation strings (doc-strings) by convention.<a data-primary="doc-strings (documentation strings) in Python" data-type="indexterm" id="idm45607813910384"/> The <code>process_student_data</code> function in <a data-type="xref" href="#ex1_py">Example 2-3</a> has a triple-quoted line of text at its top that will automatically be assigned to the function’s <code>__doc__</code> attribute. You can also use multiline doc-strings:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code> <code class="nf">doubler</code><code class="p">(</code><code class="n">x</code><code class="p">):</code>
    <code class="sd">"""This function returns double its input."""</code>
    <code class="k">return</code> <code class="mi">2</code> <code class="o">*</code> <code class="n">x</code>

<code class="k">def</code> <code class="nf">sanitize_string</code><code class="p">(</code><code class="n">s</code><code class="p">):</code>
    <code class="sd">"""This function replaces any string spaces</code>
<code class="sd">    with '-' after stripping any whitespace</code>
<code class="sd">    """</code>
    <code class="k">return</code> <code class="n">s</code><code class="o">.</code><code class="n">strip</code><code class="p">()</code><code class="o">.</code><code class="n">replace</code><code class="p">(</code><code class="s1">' '</code><code class="p">,</code> <code class="s1">'-'</code><code class="p">)</code></pre>
<p>Doc-strings are a great habit to get into, particularly if you are working collaboratively. They are understood by most decent Python editing toolsets and are also used by  such automated documentation libraries as <a href="http://sphinx-doc.org">Sphinx</a>. The string-literal doc-string is accessible as the <code>doc</code> property of a function or class.</p>
</div></section>
<section data-pdf-bookmark="Declaring Variables Using let or var" data-type="sect2"><div class="sect2" id="idm45607813829776">
<h2>Declaring Variables Using let or var</h2>
<p>JavaScript uses <code>let</code> or <code>var</code> to declare variables. Generally speaking, <code>let</code> is almost always the right choice.<a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="declaring variables using let or var in JavaScript" data-type="indexterm" id="idm45607813805200"/><a data-primary="variables" data-secondary="declaring in JavaScript using let or var" data-type="indexterm" id="idm45607813803888"/><a data-primary="let keyword (JavaScript)" data-secondary="declaring variables with" data-type="indexterm" id="idm45607813802912"/><a data-primary="var keyword (JavaScript)" data-secondary="declaring variables with" data-type="indexterm" id="idm45607813802032"/></p>
<p>Strictly speaking, JS statements should be terminated with a semicolon as opposed to Python’s newline. You will see examples where the semicolon is dispensed with, and modern browsers will usually  do the right thing here. There are a few edge cases that could necessitate the use of a semicolon (e.g., it can trip up code minifiers and compressors that remove whitespace), but generally I find that the loss of clutter and improvement in readability are a worthwhile compromise to coding without the semicolons.</p>
<div data-type="tip"><h6>Tip</h6>
<p>JavaScript has <em>variable hoisting</em>, which means variables declared with <code>var</code> are processed before any other code. <a data-primary="variable hoisting in JavaScript" data-type="indexterm" id="idm45607813798800"/>This means declaring them anywhere in the function is equivalent to declaring them at the top. This can result in weird errors and confusion. Explicitly placing <code>var</code>s at the top avoids this, but it’s better to use the modern <code>let</code> and have scoped declarations.</p>
</div>
</div></section>
<section data-pdf-bookmark="Strings and Numbers" data-type="sect2"><div class="sect2" id="idm45607813796816">
<h2>Strings and Numbers</h2>
<p>The <em>name</em> strings used in the <a data-primary="numbers, differences in Python and JavaScript" data-type="indexterm" id="idm45607813794576"/><a data-primary="strings" data-secondary="differences in Python and JavaScript" data-type="indexterm" id="idm45607813793872"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="strings and numbers" data-type="indexterm" id="idm45607813792960"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="strings and numbers" data-type="indexterm" id="idm45607813791728"/>student data (see Section A of Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a>) will be interpreted as UCS-2 (the parent of unicode UTF-16) in JavaScript,<sup><a data-type="noteref" href="ch02.xhtml#idm45607813787904" id="idm45607813787904-marker">10</a></sup> and Unicode (UTF-8 by default) in Python 3.<sup><a data-type="noteref" href="ch02.xhtml#idm45607813786288" id="idm45607813786288-marker">11</a></sup></p>
<p>Both languages allow single and double quotes for strings. If you want to include a single or double quote in the string, then enclose with the alternative, like so:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">pub_name</code> <code class="o">=</code> <code class="s2">"The Brewer's Tap"</code></pre>
<p>The <code>scores</code> in Section A of <a data-type="xref" href="#ex1_js">Example 2-4</a> are stored as JavaScript’s one numeric type, double-precision 64-bit (IEEE 754) floating-point numbers. <a data-primary="floating-point numbers (JavaScript)" data-type="indexterm" id="idm45607813780880"/>Although JavaScript has a <code>parseInt</code> conversion function, when used with floats,<sup><a data-type="noteref" href="ch02.xhtml#idm45607813779728" id="idm45607813779728-marker">12</a></sup> it is really just a rounding operator, similar to <code>floor</code>. The type of the parsed <code>number</code> is still <code>number</code>:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">x</code> <code class="o">=</code> <code class="nb">parseInt</code><code class="p">(</code><code class="mf">3.45</code><code class="p">);</code> <code class="c1">// 'cast' x to 3</code>
<code class="k">typeof</code><code class="p">(</code><code class="nx">x</code><code class="p">);</code> <code class="c1">// "number"</code></pre>
<p>Python has two numeric types: the 32-bit <code>int</code>, to which the student scores are cast, and a <code>float</code> equivalent (IEE 754) to JS’s <code>number</code>. <a data-primary="int type (Python)" data-type="indexterm" id="idm45607815621472"/><a data-primary="float type (Python)" data-type="indexterm" id="idm45607815620768"/>This means that Python can represent any integer, whereas JavaScript is more limited.<sup><a data-type="noteref" href="ch02.xhtml#idm45607815619968" id="idm45607815619968-marker">13</a></sup>  Python’s casting changes type:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">foo</code> <code class="o">=</code> <code class="mf">3.4</code> <code class="c1"># type(foo) -&gt; float</code>
<code class="n">bar</code> <code class="o">=</code> <code class="nb">int</code><code class="p">(</code><code class="mf">3.4</code><code class="p">)</code> <code class="c1"># type(bar) -&gt; int</code></pre>
<p>The nice thing about Python and JavaScript numbers is that they are easy to work with and usually do what you want.<a data-primary="NumPy" data-type="indexterm" id="idm45607815589552"/> If you need something more efficient, Python has the NumPy library, which allows fine-grained control of your numeric types (you’ll learn more about NumPy in <a data-type="xref" href="ch07.xhtml#chapter_numpy">Chapter 7</a>). In JavaScript, aside from some cutting-edge projects, you’re pretty much stuck with 64-bit floats.</p>
</div></section>
<section data-pdf-bookmark="Booleans" data-type="sect2"><div class="sect2" id="idm45607815584960">
<h2>Booleans</h2>
<p>Python differs from the JavaScript and the C class languages in using named Boolean operators. <a data-primary="Boolean operators" data-secondary="use in Python versus JavaScript" data-type="indexterm" id="idm45607815583312"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="Booleans" data-type="indexterm" id="idm45607815582368"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="Booleans" data-type="indexterm" id="idm45607815581184"/>Other than that, they work pretty much as expected. This table gives a comparison:</p>
<table>
<tbody>
<tr>
<td><p><strong>Python</strong></p></td>
<td><p><code>bool</code></p></td>
<td><p><code>True</code></p></td>
<td><p><code>False</code></p></td>
<td><p><code>not</code></p></td>
<td><p><code>and</code></p></td>
<td><p><code>or</code></p></td>
</tr>
<tr>
<td><p><strong>JavaScript</strong></p></td>
<td><p><code>boolean</code></p></td>
<td><p><code>true</code></p></td>
<td><p><code>false</code></p></td>
<td><p><code>!</code></p></td>
<td><p><code>&amp;&amp;</code></p></td>
<td><p>||</p></td>
</tr>
</tbody>
</table>
<p>Python’s capitalized <code>True</code> and <code>False</code> is an obvious trip-up for any JavaScripter and vice versa, but any decent syntax highlighting should catch that, as should your code linter.<a data-primary="true or false (Boolean)" data-type="indexterm" id="idm45607815542992"/></p>
<p>Rather than always returning Boolean true or false, both Python and JavaScript <code>and</code>/<code>or</code> expressions return the result of one of the arguments, which may of course be a Boolean value. <a data-type="xref" href="#table0201">Table 2-1</a> shows how this works, using Python to demonstrate.</p>
<table id="table0201">
<caption><span class="label">Table 2-1. </span>Python’s Boolean operators</caption>
<thead>
<tr>
<th>Operation</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>x or y</p></td>
<td><p>if x is false, then y, else x</p></td>
</tr>
<tr>
<td><p>x and y</p></td>
<td><p>if x is false, then x, else y</p></td>
</tr>
<tr>
<td><p>not x</p></td>
<td><p>if x is false, then <code>True</code>, else <code>False</code></p></td>
</tr>
</tbody>
</table>
<p>This fact allows for <a data-primary="variables" data-secondary="assignments, using Boolean operators" data-type="indexterm" id="idm45607815530864"/>some occasionally useful variable assignments:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">rocket_launch</code> <code class="o">=</code> <code class="kc">True</code>
<code class="p">(</code><code class="n">rocket_launch</code> <code class="o">==</code> <code class="kc">True</code> <code class="ow">and</code> <code class="s1">'All OK'</code><code class="p">)</code> <code class="ow">or</code> <code class="s1">'We have a problem!'</code>
<code class="n">Out</code><code class="p">:</code>
<code class="s1">'All OK'</code>

<code class="n">rocket_launch</code> <code class="o">=</code> <code class="kc">False</code>
<code class="p">(</code><code class="n">rocket_launch</code> <code class="o">==</code> <code class="kc">True</code> <code class="ow">and</code> <code class="s1">'All OK'</code><code class="p">)</code> <code class="ow">or</code> <code class="s1">'We have a problem!'</code>
<code class="n">Out</code><code class="p">:</code>
<code class="s1">'We have a problem!'</code></pre>
</div></section>
<section data-pdf-bookmark="Data Containers: dicts, objects, lists, Arrays" data-type="sect2"><div class="sect2" id="idm45607815508112">
<h2>Data Containers: dicts, objects, lists, Arrays</h2>
<p>Roughly speaking, JavaScript <code>objects</code> can be used like Python <code>dict</code>s, and Python <code>list</code>s like JavaScript arrays.<a data-primary="data containers (dicts, objects, lists, arrays)" data-type="indexterm" id="idm45607815466208"/><a data-primary="tuples" data-type="indexterm" id="idm45607815465536"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="dicts, objects, lists, arrays" data-type="indexterm" id="idm45607815464864"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="dicts, objects, lists, arrays" data-type="indexterm" id="idm45607815463712"/> Python also has a tuple container, which functions like an immutable list. Here are some examples:</p>
<pre class="pagebreak-before" data-code-language="python" data-type="programlisting"><code class="c1"># Python</code>
<code class="n">d</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'name'</code><code class="p">:</code> <code class="s1">'Groucho'</code><code class="p">,</code> <code class="s1">'occupation'</code><code class="p">:</code> <code class="s1">'Ruler of Freedonia'</code><code class="p">}</code>
<code class="n">l</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'Harpo'</code><code class="p">,</code> <code class="s1">'Groucho'</code><code class="p">,</code> <code class="mi">99</code><code class="p">]</code>
<code class="n">t</code> <code class="o">=</code> <code class="p">(</code><code class="s1">'an'</code><code class="p">,</code> <code class="s1">'immutable'</code><code class="p">,</code> <code class="s1">'container'</code><code class="p">)</code></pre>
<pre data-code-language="js" data-type="programlisting"><code class="c1">// JavaScript</code>
<code class="nx">d</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'name'</code><code class="o">:</code> <code class="s1">'Groucho'</code><code class="p">,</code> <code class="s1">'occupation'</code><code class="o">:</code> <code class="s1">'Ruler of Freedonia'</code><code class="p">}</code>
<code class="nx">l</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'Harpo'</code><code class="p">,</code> <code class="s1">'Groucho'</code><code class="p">,</code> <code class="mi">99</code><code class="p">]</code></pre>
<p>As shown in Section A of Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a>, while Python’s <code>dict</code> keys must be quote-marked strings (or hashable types), JavaScript allows you to omit the quotes if the property is a valid identifier (i.e., not containing special characters such as spaces and dashes).<a data-primary="dictionaries (dicts)" data-type="indexterm" id="idm45607815372304"/> So in our <code>studentData</code> objects, JS implicitly converts the property <code>'name'</code> to string form.</p>
<p>The student data declarations look pretty much the same and, in practice, are used pretty much the same too. <a data-primary="objects" data-type="indexterm" id="idm45607815370128"/>The key difference to note is that while the curly-bracketed containers in the JS <code>studentData</code> look like Python <code>dict</code>s, they are actually a shorthand declaration of JS <a href="https://oreil.ly/QTlNc">objects</a>, a somewhat different data container.</p>
<p>In JS data visualization, we tend to use arrays of objects as the chief data container and here, JS objects function much as a Pythonista would expect.<a data-primary="arrays" data-secondary="of objects in JavaScript" data-type="indexterm" id="idm45607815367296"/> In fact, as demonstrated in the following code, we get the advantage of both dot notation and key-string access, the former being preferred where applicable (keys with spaces or dashes needing quoted strings):</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">foo</code> <code class="o">=</code> <code class="p">{</code><code class="nx">bar</code><code class="o">:</code><code class="mi">3</code><code class="p">,</code> <code class="nx">baz</code><code class="o">:</code><code class="mi">5</code><code class="p">};</code>
<code class="nx">foo</code><code class="p">.</code><code class="nx">bar</code><code class="p">;</code> <code class="c1">// 3</code>
<code class="nx">foo</code><code class="p">[</code><code class="s1">'baz'</code><code class="p">];</code> <code class="c1">// 5, same as Python</code></pre>
<p>It’s good to be aware that although they can be used like Python dictionaries, JavaScript objects are much more than just containers (aside from primitives like strings and numbers, pretty much everything in JavaScript is an object).<sup><a data-type="noteref" href="ch02.xhtml#idm45607815328112" id="idm45607815328112-marker">14</a></sup> But in most dataviz examples you see, they are used very much like Python <code>dict</code>s.<a data-primary="lists" data-type="indexterm" id="idm45607815326480"/></p>
<p><a data-type="xref" href="#table0202">Table 2-2</a> converts basic list operations.</p>
<table class="pagebreak-before" id="table0202">
<caption><span class="label">Table 2-2. </span>Lists and arrays</caption>
<thead>
<tr>
<th>JavaScript array (a)</th>
<th>Python list (l)</th>
</tr>
</thead>
<tbody>
<tr>
<td><p><code>a.length</code></p></td>
<td><p><code>len(l)</code></p></td>
</tr>
<tr>
<td><p><code>a.push(item)</code></p></td>
<td><p><code>l.append(item)</code></p></td>
</tr>
<tr>
<td><p><code>a.pop()</code></p></td>
<td><p><code>l.pop()</code></p></td>
</tr>
<tr>
<td><p><code>a.shift()</code></p></td>
<td><p><code>l.pop(0)</code></p></td>
</tr>
<tr>
<td><p><code>a.unshift(item)</code></p></td>
<td><p><code>l.insert(0, item)</code></p></td>
</tr>
<tr>
<td><p><code>a.slice(start, end)</code></p></td>
<td><p><code>l[start:end]</code></p></td>
</tr>
<tr>
<td><p><code>a.splice(start, howMany, i1,  …​)</code></p></td>
<td><p><code>l[start:end] = [i1, …​]</code></p></td>
</tr>
</tbody>
</table>
</div></section>
<section data-pdf-bookmark="Functions" data-type="sect2"><div class="sect2" id="idm45607815468656">
<h2>Functions</h2>
<p>The B sections of Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a> show a function declaration.  <a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="functions" data-type="indexterm" id="idm45607815278880"/><a data-primary="functions" data-secondary="syntax differences in JavaScript and Python" data-type="indexterm" id="idm45607815277664"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="functions" data-type="indexterm" id="idm45607815276752"/>Python uses <code>def</code> to indicate a function:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code> <code class="nf">process_student_data</code><code class="p">(</code><code class="n">data</code><code class="p">,</code> <code class="n">pass_threshold</code><code class="o">=</code><code class="mi">60</code><code class="p">,</code>
                         <code class="n">merit_threshold</code><code class="o">=</code><code class="mi">75</code><code class="p">):</code>
    <code class="sd">""" Perform some basic stats on some student data. """</code>
    <code class="o">...</code></pre>
<p>whereas JavaScript uses <code>function</code>:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">function</code> <code class="nx">processStudentData</code><code class="p">(</code><code class="nx">data</code><code class="p">,</code> <code class="nx">passThreshold</code><code class="o">=</code><code class="mi">60</code><code class="p">,</code> <code class="nx">meritThreshold</code><code class="o">=</code><code class="mi">75</code><code class="p">){</code>
    <code class="p">...</code>
<code class="p">}</code></pre>
<p>Both have a list of parameters. With JS, the function code block is indicated by the curly brackets { …​ }; with Python, the code block is defined by a colon and indentation.<a data-primary="curly braces ({})" data-secondary="enclosing function code block in JavaScript" data-type="indexterm" id="idm45607815259248"/><a data-primary="parameters" data-type="indexterm" id="idm45607815258272"/></p>
<p>JS has an alternative way of defining a function called the <em>function expression</em>, which you may see in this example:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">processStudentData</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code> <code class="p">...){...}</code></pre>
<p>There is now a shortened form, which is becoming more popular:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">processStudentData</code> <code class="o">=</code> <code class="p">(</code> <code class="p">...)</code> <code class="o">=&gt;</code> <code class="p">{...}</code></pre>
<p>The differences are subtle enough not to worry about for now.<sup><a data-type="noteref" href="ch02.xhtml#idm45607815158832" id="idm45607815158832-marker">15</a></sup></p>
<p>Function parameters is an area where Python’s handling is more sophisticated than JavaScript’s. As you can see in <code>process_student_data</code> (Section B in <a data-type="xref" href="#ex1_py">Example 2-3</a>), Python allows default arguments for the parameters. In JavaScript, all parameters not used in the function call are declared as <em>undefined</em>.</p>
</div></section>
<section data-pdf-bookmark="Iterating: for Loops and Functional Alternatives" data-type="sect2"><div class="sect2" id="idm45607815307328">
<h2>Iterating: for Loops and Functional Alternatives</h2>
<p>The C sections in Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a> shows our first key difference between Python and JavaScript—their handling of <code>for</code> loops.<a data-primary="iterating, for loops and functional alternatives in Python and JavaScript" data-type="indexterm" id="idm45607815134096"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="iterations, for loops and functional alternatives" data-type="indexterm" id="idm45607815133392"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="iterations, for loops and functional alternatives" data-type="indexterm" id="idm45607815132112"/><a data-primary="for loops, differences in Python and JavaScript" data-type="indexterm" id="idm45607815130896"/></p>
<p>Python’s <code>for</code> loops are simple, intuitive, and effective on any iterator, such as arrays and <code>dict</code>s. <a data-primary="dictionaries (dicts)" data-secondary="iteration by key, not by item" data-type="indexterm" id="idm45607815129072"/>One gotcha with <code>dict</code>s is that standard iteration is by key, not items. For example:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">foo</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'a'</code><code class="p">:</code><code class="mi">3</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">:</code><code class="mi">2</code><code class="p">}</code>
<code class="k">for</code> <code class="n">x</code> <code class="ow">in</code> <code class="n">foo</code><code class="p">:</code>
    <code class="nb">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>
<code class="c1"># outputs 'a' 'b'</code></pre>
<p>To iterate over the key-value pairs, use the <code>dict</code>’s <code>items</code> method like so:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">for</code> <code class="n">x</code> <code class="ow">in</code> <code class="n">foo</code><code class="o">.</code><code class="n">items</code><code class="p">():</code>
    <code class="nb">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>
<code class="c1"># outputs key-value tuples ('a', 3) ('b' 2)</code></pre>
<p>You can assign the key-values in the <code>for</code> statement for convenience. For example:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">for</code> <code class="n">key</code><code class="p">,</code> <code class="n">value</code> <code class="ow">in</code> <code class="n">foo</code><code class="o">.</code><code class="n">items</code><code class="p">():</code></pre>
<p>Because Python’s <code>for</code> loop works on anything with the correct iterator plumbing, you can do cool things like loop over file lines:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">for</code> <code class="n">line</code> <code class="ow">in</code> <code class="nb">open</code><code class="p">(</code><code class="s1">'data.txt'</code><code class="p">):</code>
    <code class="nb">print</code><code class="p">(</code><code class="n">line</code><code class="p">)</code></pre>
<p>Coming from Python, JS’s <code>for</code> loop is a pretty horrible, unintuitive thing. Here’s an example:</p>
<pre data-code-language="js" data-type="programlisting"><code class="k">for</code><code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="k">in</code> <code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">]){</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code><code class="p">)</code>
<code class="p">}</code>
<code class="c1">// outputs 1, 2, 3</code></pre>
<p>JS’s <code>for .. in</code> returns the index of the array’s items, not the items themselves.<a data-primary="for .. in loops (JavaScript)" data-type="indexterm" id="idm45607802792928"/> To compound matters, for the Pythonista, the order of iteration is not guaranteed, so the indices could be returned in nonconsecutive order.</p>
<p>Shifting between Python and JS <code>for</code> loops is hardly seamless, demanding you keep on the ball. The good news is that you hardly need to use JS <code>for</code> loops these days. In fact, I almost never find the need. <a data-primary="JavaScript" data-secondary="functional alternatives to for loops" data-type="indexterm" id="idm45607802790880"/><a data-primary="functional methods in modern JavaScript" data-type="indexterm" id="idm45607802789936"/>That’s because JS has recently acquired some very powerful first-class functional abilities, which have more expressive power and less scope for confusion with Python and, once you get used to them, quickly become indispensable.<sup><a data-type="noteref" href="ch02.xhtml#idm45607802789056" id="idm45607802789056-marker">16</a></sup></p>
<p>Section C in <a data-type="xref" href="#ex1_js">Example 2-4</a>   demonstrates <code>forEach()</code>, one of the <em>functional</em> methods available to modern JavaScript arrays.<sup><a data-type="noteref" href="ch02.xhtml#idm45607802786192" id="idm45607802786192-marker">17</a></sup> <code>forEach()</code> iterates<a data-primary="forEach method (JavaScript)" data-type="indexterm" id="idm45607802785088"/> over the array’s items, sending them in turn to an anonymous callback function defined in the first argument, where they can be processed. The true expressive power of these functional methods comes from chaining them (maps, filters, etc.), but already we have a cleaner, more elegant iteration with none of the awkward bookkeeping of old.</p>
<p>The callback function receives the index and the original array as an optional second argument:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">data</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">currentValue</code><code class="p">,</code> <code class="nx">index</code><code class="p">){...})</code></pre>
<p>Until recently even iterating over an <code>object</code>’s key-value pairs was fairly tricky. <a data-primary="objects" data-secondary="iterating over key-value pairs in JavaScript" data-type="indexterm" id="idm45607802744992"/>Unlike Python’s <code>dict</code>s, <code>object</code>s could have inherited properties from the prototyping chain, so you had to use a <code>hasOwnProperty</code> guard to filter these out. You may well come across code like this:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">obj</code> <code class="o">=</code> <code class="p">{</code><code class="nx">a</code><code class="o">:</code><code class="mi">3</code><code class="p">,</code> <code class="nx">b</code><code class="o">:</code><code class="mi">2</code><code class="p">,</code> <code class="nx">c</code><code class="o">:</code><code class="mi">4</code><code class="p">};</code>
<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">prop</code> <code class="k">in</code> <code class="nx">obj</code><code class="p">)</code> <code class="p">{</code>
  <code class="k">if</code><code class="p">(</code> <code class="nx">obj</code><code class="p">.</code><code class="nx">hasOwnProperty</code><code class="p">(</code> <code class="nx">prop</code> <code class="p">)</code> <code class="p">)</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"o."</code> <code class="o">+</code> <code class="nx">prop</code> <code class="o">+</code> <code class="s2">" = "</code> <code class="o">+</code> <code class="nx">obj</code><code class="p">[</code><code class="nx">prop</code><code class="p">]);</code>
  <code class="p">}</code>
<code class="p">}</code>
<code class="c1">// out: o.a = 3, o.b = 2, o.c = 4</code></pre>
<p>Whereas JS<a data-primary="arrays" data-secondary="JavaScript" data-tertiary="native functional iterator methods" data-type="indexterm" id="idm45607802701216"/> arrays have a set of native functional iterator methods (<code>map</code>, <code>reduce</code>, <code>filter</code>, <code>every</code>, <code>sum</code>, <code>reduceRight</code>), <code>object</code>s—in their guise as pseudodictionaries—don’t. The good news is that the <code>object</code> class has recently acquired some useful additional methods that fill this gap.<a data-primary="entries method (JavaScript)" data-type="indexterm" id="idm45607802641184"/>  So you can iterate through the key-value pairs using the <code>entries</code> method:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">obj</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="nx">a</code><code class="o">:</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="nx">b</code><code class="o">:</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="nx">c</code><code class="o">:</code><code class="mi">4</code><code class="p">}</code><code class="p">;</code><code>
</code><code class="k">for</code><code> </code><code class="p">(</code><code class="kr">const</code><code> </code><code class="p">[</code><code class="nx">key</code><code class="p">,</code><code> </code><code class="nx">value</code><code class="p">]</code><code> </code><code class="k">of</code><code> </code><code class="nb">Object</code><code class="p">.</code><code class="nx">entries</code><code class="p">(</code><code class="nx">object1</code><code class="p">)</code><code class="p">)</code><code> </code><code class="p">{</code><code>
  </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="si">${</code><code class="nx">key</code><code class="si">}</code><code class="sb">: </code><code class="si">${</code><code class="nx">value</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO8-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO8-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="p">}</code><code>
</code><code class="c1">// out: a: 3
</code><code class="c1">//      b: 2 ...</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO8-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO8-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Note the string template form <code>${foo}</code> for printing variables.</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="Conditionals: if, else, elif, switch" data-type="sect2"><div class="sect2" id="idm45607815154592">
<h2>Conditionals: if, else, elif, switch</h2>
<p>Section C in Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_py">2-3</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#ex1_js">2-4</a> shows Python and JavaScript conditionals in action. <a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="conditionals (if, else, elif, switch)" data-type="indexterm" id="idm45607802585280"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="conditionals (if, else, elif, switch)" data-type="indexterm" id="idm45607802584096"/><a data-primary="conditionals, differences in Python and JavaScript" data-type="indexterm" id="idm45607802582944"/><a data-primary="if statements" data-type="indexterm" id="idm45607802545648"/><a data-primary="else statements" data-type="indexterm" id="idm45607802545040"/><a data-primary="elif statements (Python)" data-type="indexterm" id="idm45607802544432"/>Aside from JavaScript’s use of brackets, the statements are very similar; the only real difference being Python’s extra <code>elif</code> keyword, a convenient conjunction of <code>else if</code>.</p>
<p>Though much requested, Python does not have the <code>switch</code> statement found in most high-level languages.<a data-primary="switch statement (JavaScript)" data-type="indexterm" id="idm45607802542288"/> JS does, allowing you to do this:</p>
<pre data-code-language="js" data-type="programlisting"><code class="k">switch</code><code class="p">(</code><code class="nx">expression</code><code class="p">){</code>
  <code class="k">case</code> <code class="nx">value1</code><code class="o">:</code>
    <code class="c1">// execute if expression === value1</code>
    <code class="k">break</code><code class="p">;</code> <code class="c1">// optional end expression</code>
  <code class="k">case</code> <code class="nx">value2</code><code class="o">:</code>
    <code class="c1">//...</code>
  <code class="k">default</code><code class="o">:</code>
    <code class="c1">// if other matches fail</code>
<code class="p">}</code></pre>
<p>The good news for Pythonistas is <a data-primary="pattern-matching conditional (Python 3.10)" data-type="indexterm" id="idm45607802522528"/>that with 3.10 Python gets a very powerful pattern-matching conditional that can function as a <code>switch</code> statement but do a <a href="https://oreil.ly/5x76a">whole lot more</a>. So we can do this to switch between cases:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">for</code> <code class="n">value</code> <code class="ow">in</code> <code class="p">[</code><code class="n">value1</code><code class="p">,</code> <code class="n">value2</code><code class="p">,</code> <code class="n">value3</code><code class="p">]:</code>
    <code class="k">match</code> <code class="n">value</code><code class="p">:</code>
        <code class="k">case</code> <code class="n">value1</code><code class="p">:</code>
            <code class="c1"># do foo</code>
        <code class="k">case</code> <code class="n">value2</code><code class="p">:</code>
            <code class="c1"># do baa</code>
        <code class="k">case</code> <code class="n">value3</code><code class="p">:</code>
            <code class="c1"># do baz</code></pre>
</div></section>
<section data-pdf-bookmark="File Input and Output" data-type="sect2"><div class="sect2" id="idm45607802474704">
<h2>File Input and Output</h2>
<p>Browser-based JavaScript has no real equivalent <a data-primary="file input and output" data-type="indexterm" id="idm45607802437344"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="file input and output" data-type="indexterm" id="idm45607802466864"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="file input and output" data-type="indexterm" id="idm45607802465680"/>of file input and output (I/O), but Python’s is as simple as could be:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># READING A FILE</code>
<code class="n">f</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s2">"data.txt"</code><code class="p">)</code> <code class="c1"># open file for reading</code>

<code class="k">for</code> <code class="n">line</code> <code class="ow">in</code> <code class="n">f</code><code class="p">:</code> <code class="c1"># iterate over file lines</code>
    <code class="nb">print</code><code class="p">(</code><code class="n">line</code><code class="p">)</code>

<code class="n">lines</code> <code class="o">=</code> <code class="n">f</code><code class="o">.</code><code class="n">readlines</code><code class="p">()</code> <code class="c1"># grab all lines in file into array</code>
<code class="n">data</code> <code class="o">=</code> <code class="n">f</code><code class="o">.</code><code class="n">read</code><code class="p">()</code> <code class="c1"># read all of file as single string</code>

<code class="c1"># WRITING TO A FILE</code>
<code class="n">f</code> <code class="o">=</code> <code class="nb">open</code><code class="p">(</code><code class="s2">"data.txt"</code><code class="p">,</code> <code class="s1">'w'</code><code class="p">)</code>
<code class="c1"># use 'w' to write, 'a' to append to file</code>
<code class="n">f</code><code class="o">.</code><code class="n">write</code><code class="p">(</code><code class="s2">"this will be written as a line to the file"</code><code class="p">)</code>
<code class="n">f</code><code class="o">.</code><code class="n">close</code><code class="p">()</code> <code class="c1"># explicitly close the file</code></pre>
<p>One much recommended best practice is to use Python’s <code>with</code>, <code>as</code> context manager when opening files. <a data-primary="with, as context manager, opening files" data-type="indexterm" id="idm45607802382960"/>This ensures they are closed automatically when leaving the block, essentially providing <a href="https://oreil.ly/DPxaM">syntactic sugar</a> for a <code>try</code>, <code>except</code>, <code>finally</code> block. Here’s how to open a file using <code>with</code>, <code>as</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">with</code> <code class="nb">open</code><code class="p">(</code><code class="s2">"data.txt"</code><code class="p">)</code> <code class="k">as</code> <code class="n">f</code><code class="p">:</code>
    <code class="n">lines</code> <code class="o">=</code> <code class="n">f</code><code class="o">.</code><code class="n">readlines</code><code class="p">()</code>
    <code class="o">...</code></pre>
<p>JavaScript does, however, have the roughly analogous <code>fetch</code> method for fetching a resource from the network, based on its URL. <a data-primary="fetch method (JavaScript)" data-type="indexterm" id="idm45607802317568"/>So to fetch a dataset from the website’s server, in the <em>static/data</em> directory you do this:</p>
<pre data-code-language="js" data-type="programlisting"><code class="nx">fetch</code><code class="p">(</code><code class="s1">'/static/data/nobel_winners.json'</code><code class="p">)</code>
  <code class="p">.</code><code class="nx">then</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">response</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">response</code><code class="p">.</code><code class="nx">json</code><code class="p">())</code>
<code class="p">})</code>
<code class="nx">Out</code><code class="o">:</code>
<code class="p">[{</code><code class="nx">name</code><code class="o">:</code> <code class="s1">'Albert Einstein'</code><code class="p">,</code> <code class="nx">category</code><code class="o">:</code> <code class="s1">'Physics'</code><code class="p">...},]</code></pre>
<p>The <a href="https://oreil.ly/OFjns">Fetch API</a> is thoroughly documented at Mozilla.</p>
</div></section>
<section data-pdf-bookmark="Classes and Prototypes" data-type="sect2"><div class="sect2" id="idm45607802269872">
<h2>Classes and Prototypes</h2>
<p>Possibly the cause of more confusion that any other topic is <span class="keep-together">JavaScript’s</span> choice of prototypes rather than classical classes as its chief object-oriented programming (OOP) element.<a data-primary="prototypes, comparison to classes" data-type="indexterm" id="ix_prototyp"/><a data-primary="classes, comparison to prototypes" data-type="indexterm" id="ix_clsprt"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-tertiary="classes and prototypes" data-type="indexterm" id="ix_JSbrPycls"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-tertiary="classes and prototypes" data-type="indexterm" id="ix_PybrJScls"/> This does require some adaption for a Pythonista, where classes are ubiquitous, but in practice this learning curve is, in my experience, short and fairly shallow.</p>
<p>I remember, when I first started my forays into more advanced languages like C++, falling for the promise of OOP, particularly class-based inheritance. Polymorphism was all the rage and shape classes were being subclassed to rectangles and ellipses, which were in turn subclassed to more specialized squares and circles.</p>
<p>It didn’t take long to realize that the clean class divisions found in the textbooks were rarely found in real programming and that trying to balance generic and specific APIs quickly became fraught. In this sense, I find composition and mix-ins much more useful as programming concepts than attempts at extended subclassing, and often avoid all these by using functional programming techniques, particularly in JavaScript.  Nevertheless, the class/prototype distinction is an obvious difference between the two languages, and the more you understand its nuances, the better you’ll code.<sup><a data-type="noteref" href="ch02.xhtml#idm45607802261472" id="idm45607802261472-marker">18</a></sup></p>
<p>Python’s classes are fairly simple affairs and, as with most of the language, easy to use. I tend to think of them these days as a handy way to encapsulate data with a convenient API, and rarely extend subclassing beyond one generation. Here’s a simple example:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">class</code><code> </code><code class="nc">Citizen</code><code class="p">(</code><code class="nb">object</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="k">def</code><code> </code><code class="fm">__init__</code><code class="p">(</code><code class="bp">self</code><code class="p">,</code><code> </code><code class="n">name</code><code class="p">,</code><code> </code><code class="n">country</code><code class="p">)</code><code class="p">:</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO9-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO9-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>        </code><code class="bp">self</code><code class="o">.</code><code class="n">name</code><code> </code><code class="o">=</code><code> </code><code class="n">name</code><code>
</code><code>        </code><code class="bp">self</code><code class="o">.</code><code class="n">country</code><code> </code><code class="o">=</code><code> </code><code class="n">country</code><code>
</code><code>
</code><code>     </code><code class="k">def</code><code> </code><code class="fm">__str__</code><code class="p">(</code><code class="bp">self</code><code class="p">)</code><code class="p">:</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO9-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO9-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code>        </code><code class="k">return</code><code> </code><code class="sa">f</code><code class="s1">'</code><code class="s1">Citizen </code><code class="si">{</code><code class="bp">self</code><code class="o">.</code><code class="n">name</code><code class="si">}</code><code class="s1"> from </code><code class="si">{</code><code class="bp">self</code><code class="o">.</code><code class="n">country</code><code class="si">}</code><code class="s1">'</code><code>
</code><code>
</code><code>     </code><code class="k">def</code><code> </code><code class="nf">print_details</code><code class="p">(</code><code class="bp">self</code><code class="p">)</code><code class="p">:</code><code>
</code><code>         </code><code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s1">'</code><code class="s1">Citizen </code><code class="si">{</code><code class="bp">self</code><code class="o">.</code><code class="n">name</code><code class="si">}</code><code class="s1"> from </code><code class="si">{</code><code class="bp">self</code><code class="o">.</code><code class="n">country</code><code class="si">}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>
</code><code class="n">groucho</code><code> </code><code class="o">=</code><code> </code><code class="n">Citizen</code><code class="p">(</code><code class="s1">'</code><code class="s1">Groucho M.</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Freedonia</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO9-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO9-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">groucho</code><code class="p">)</code><code> </code><code class="c1"># or groucho.print_details()</code><code>
</code><code class="c1"># Out:</code><code>
</code><code class="c1"># Citizen Groucho M. from Freedonia</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO9-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO9-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Python classes have a number of double-underscored special methods, <code>__init__</code> being the most common, called when the class instance is created. All instance methods have a first, explicit <code>self</code> argument (you could name it something else, but it’s a very bad idea), which refers to the instance.<a data-primary="__init__ method (Python)" data-primary-sortas="init" data-type="indexterm" id="idm45607802130608"/><a data-primary="underscore (_)" data-secondary="double underscore in Python special method names" data-type="indexterm" id="idm45607802129664"/> In this case, we use it to set name and country properties.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO9-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO9-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>You can override the class’s string method, which is used when the <code>print</code> function is called on an instance.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO9-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO9-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Creates a new <code>Citizen</code> instance, initialized with name and country.</p></dd>
</dl>
<p>Python follows a fairly classical pattern of class inheritance.<a data-primary="inheritance" data-secondary="class inheritance in Python" data-type="indexterm" id="idm45607802073760"/> It’s easy to do, which is probably why Pythonistas make a lot of use of it. Let’s customize the <code>Citizen</code> class to create a (Nobel Prize) <code>Winner</code> class with a couple of extra properties:</p>
<pre class="pagebreak-before" data-code-language="python" data-type="programlisting"><code class="k">class</code><code> </code><code class="nc">Winner</code><code class="p">(</code><code class="n">Citizen</code><code class="p">)</code><code class="p">:</code><code>
</code><code>
</code><code>    </code><code class="k">def</code><code> </code><code class="fm">__init__</code><code class="p">(</code><code class="bp">self</code><code class="p">,</code><code> </code><code class="n">name</code><code class="p">,</code><code> </code><code class="n">country</code><code class="p">,</code><code> </code><code class="n">category</code><code class="p">,</code><code> </code><code class="n">year</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><code class="nb">super</code><code class="p">(</code><code class="p">)</code><code class="o">.</code><code class="fm">__init__</code><code class="p">(</code><code class="n">name</code><code class="p">,</code><code> </code><code class="n">country</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO10-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO10-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>        </code><code class="bp">self</code><code class="o">.</code><code class="n">category</code><code> </code><code class="o">=</code><code> </code><code class="n">category</code><code>
</code><code>        </code><code class="bp">self</code><code class="o">.</code><code class="n">year</code><code> </code><code class="o">=</code><code> </code><code class="n">year</code><code>
</code><code>
</code><code>    </code><code class="k">def</code><code> </code><code class="fm">__str__</code><code class="p">(</code><code class="bp">self</code><code class="p">)</code><code class="p">:</code><code>
</code><code>        </code><code class="k">return</code><code> </code><code class="s1">'</code><code class="s1">Nobel winner </code><code class="si">%s</code><code class="s1"> from </code><code class="si">%s</code><code class="s1">, category </code><code class="si">%s</code><code class="s1">, year </code><code class="si">%s</code><code class="s1">'</code><code>\
</code><code>        </code><code class="o">%</code><code class="p">(</code><code class="bp">self</code><code class="o">.</code><code class="n">name</code><code class="p">,</code><code> </code><code class="bp">self</code><code class="o">.</code><code class="n">country</code><code class="p">,</code><code> </code><code class="bp">self</code><code class="o">.</code><code class="n">category</code><code class="p">,</code><code>\
</code><code>        </code><code class="nb">str</code><code class="p">(</code><code class="bp">self</code><code class="o">.</code><code class="n">year</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code class="n">w</code><code> </code><code class="o">=</code><code> </code><code class="n">Winner</code><code class="p">(</code><code class="s1">'</code><code class="s1">Albert E.</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Switzerland</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Physics</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">1921</code><code class="p">)</code><code>
</code><code class="n">w</code><code class="o">.</code><code class="n">print_details</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="c1"># Out:</code><code>
</code><code class="c1"># Nobel prizewinner Albert E. from Switzerland, category Physics,</code><code>
</code><code class="c1"># year 1921</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO10-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO10-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>We want to reuse the superclass <code>Citizen’s</code> <code>__init__</code> method, using this <code>Winner</code> instance as <code>self</code>. The <code>super</code> method scales the inheritance tree one branch from its first argument, supplying the second as instance to the class-instance method.</p></dd>
</dl>
<p>I think the best article I have read on the key difference between <span class="keep-together">JavaScript’s</span> prototypes and classical classes is Reginald Braithwaite’s  <a href="https://oreil.ly/92Kxk">“OOP, JavaScript, and so-called Classes”</a>. This quote sums up the difference between classes and prototypes as nicely as any I’ve found:</p>
<blockquote>
<p>The difference between a prototype and a class is similar to the difference between a model home and a blueprint for a home.</p></blockquote>
<p>When you instantiate a C++ or Python class, a blueprint is followed, creating an object and calling its various constructors in the inheritance tree. In other words, you start from scratch and build a nice, pristine new class instance.</p>
<p>With JavaScript prototypes, you start with a model home (object) that has rooms (methods). If you want a new living room, you can just replace the old one with something in better colors. If you want a new conservatory, then just make an extension. But rather than building from scratch with a blueprint, you’re adapting and extending an existing object.</p>
<p>With that <a data-primary="objects" data-secondary="simple JavaScript object" data-type="indexterm" id="idm45607801950432"/>necessary theory out of the way and the reminder that object inheritance is useful to know but hardly ubiquitous in dataviz, let’s see a simple JavaScript prototype object in <a data-type="xref" href="#bridge_citizen_js">Example 2-5</a>.</p>
<div class="pagebreak-before" data-type="example" id="bridge_citizen_js">
<h5><span class="label">Example 2-5. </span>A simple JavaScript object</h5>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">Citizen</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code><code> </code><code class="nx">country</code><code class="p">)</code><code class="p">{</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO11-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO11-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
  </code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code> </code><code class="o">=</code><code> </code><code class="nx">name</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO11-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO11-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
  </code><code class="k">this</code><code class="p">.</code><code class="nx">country</code><code> </code><code class="o">=</code><code> </code><code class="nx">country</code><code class="p">;</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="nx">Citizen</code><code class="p">.</code><code class="nx">prototype</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO11-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO11-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
  </code><code class="nx">logDetails</code><code class="o">:</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="p">)</code><code class="p">{</code><code>
    </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`</code><code class="sb">Citizen </code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="si">}</code><code class="sb"> from </code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">country</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code><code class="p">;</code><code>
  </code><code class="p">}</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">c</code><code> </code><code class="o">=</code><code> </code><code class="k">new</code><code> </code><code class="nx">Citizen</code><code class="p">(</code><code class="s1">'Groucho M.'</code><code class="p">,</code><code> </code><code class="s1">'Freedonia'</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO11-4" id="co_a_language_learning_bridge_between_python_and_javascript_CO11-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a><code>

</code><code class="nx">c</code><code class="p">.</code><code class="nx">logDetails</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="nx">Out</code><code class="o">:</code><code>
</code><code class="nx">Citizen</code><code> </code><code class="nx">Groucho</code><code> </code><code class="nx">M</code><code class="p">.</code><code> </code><code class="nx">from</code><code> </code><code class="nx">Freedonia</code><code>

</code><code class="k">typeof</code><code class="p">(</code><code class="nx">c</code><code class="p">)</code><code> </code><code class="err">#</code><code> </code><code class="nx">object</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO11-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO11-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>This function is essentially an initializer, invoked by the <code>new</code> operator.<a data-primary="new operator (JavaScript)" data-type="indexterm" id="idm45607801796608"/><a data-primary="calling context, reference to" data-see="this keyword" data-type="indexterm" id="idm45607801795904"/></p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO11-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO11-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p><code>this</code> is an implicit reference to the <em>calling context</em> of the function. For now, it behaves as you would expect and even though it looks a little like Python’s <code>self</code>, the two are quite different, as we’ll see.<a data-primary="this keyword (JavaScript)" data-type="indexterm" id="idm45607801791312"/><a data-primary="self (Python)" data-type="indexterm" id="idm45607801790640"/></p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO11-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO11-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>The methods specified here will both override any prototypical methods up the inheritance chain and be inherited by any objects derived from <code>Citizen</code>.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO11-4" id="callout_a_language_learning_bridge_between_python_and_javascript_CO11-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></dt>
<dd><p><code>new</code> is used to create a new object, set its prototype to that of the <code>Citizen</code> constructor function, and then call the <code>Citizen</code> constructor function on the new object.</p></dd>
</dl></div>
<p>JavaScript has recently acquired some <a href="https://oreil.ly/43NXG">syntactic sugar</a> allowing classes to be declared. This essentially wraps the object-based form (see <a data-type="xref" href="#bridge_citizen_js">Example 2-5</a>) in something more familiar to programmers coming from <code>class</code>-based languages like Java and C#. I think it’s fair to say that classes haven’t really taken off in frontend, browser-based JavaScript, having been usurped somewhat by new frameworks with an emphasis on reusable components (e.g., React, Vue, Svelte). Here’s how we would implement the <code>Citizen</code> <code>Object</code> shown in <a data-type="xref" href="#bridge_citizen_js">Example 2-5</a>:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kr">class</code> <code class="nx">Citizen</code> <code class="p">{</code>
  <code class="nx">constructor</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code> <code class="nx">country</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">name</code> <code class="o">=</code> <code class="nx">name</code>
    <code class="k">this</code><code class="p">.</code><code class="nx">country</code> <code class="o">=</code> <code class="nx">country</code>
  <code class="p">}</code>

  <code class="nx">logDetails</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`Citizen </code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code class="si">}</code><code class="sb"> from </code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">country</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>
  <code class="p">}</code>
<code class="p">}</code>

<code class="kr">const</code> <code class="nx">c</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Citizen</code><code class="p">(</code><code class="s1">'Groucho M.'</code><code class="p">,</code> <code class="s1">'Freedonia'</code><code class="p">)</code></pre>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45607801702576">
<h5>self Versus this</h5>
<p>At first glance, it would be easy enough to assume that Python’s <code>self</code> and JavaScript’s <code>this</code> are essentially the same, the latter being an implicit version of the former, which is supplied to all class instance methods. Actually, <code>this</code> and <code>self</code> are significantly different.<a data-primary="self (Python)" data-secondary="versus this (JavaScript)" data-secondary-sortas="this" data-type="indexterm" id="idm45607801680464"/><a data-primary="this keyword (JavaScript)" data-secondary="versus self (Python)" data-secondary-sortas="self" data-type="indexterm" id="idm45607801679248"/> Let’s use our bilingual <code>Citizen</code> class to demonstrate.</p>
<p>Python’s <code>self</code> is a variable supplied to each class method (you can call it anything you like, but it’s not advisable), representing the class instance. But <code>this</code> is a keyword that refers to the object calling the method. This calling object can be different from the method’s object instance, and JavaScript provides the <a href="https://oreil.ly/ONAkj"><code>call</code>, <code>bind</code>, and <code>apply</code> function methods</a> to allow you to exploit this fact.<a data-primary="call method (JavaScript)" data-type="indexterm" id="idm45607801630736"/><a data-primary="bind method (JavaScript)" data-type="indexterm" id="idm45607801630128"/><a data-primary="apply method (JavaScript)" data-type="indexterm" id="idm45607801629520"/></p>
<p>Let’s use the <code>call</code> method to change the calling object of a <code>print_details</code> method and therefore the reference for <code>this</code>, used in the method to get the citizen’s name:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">groucho</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Citizen</code><code class="p">(</code><code class="s1">'Groucho M.'</code><code class="p">,</code> <code class="s1">'Freedonia'</code><code class="p">);</code>
<code class="kd">let</code> <code class="nx">harpo</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Citizen</code><code class="p">(</code><code class="s1">'Harpo M.'</code><code class="p">,</code> <code class="s1">'Freedonia'</code><code class="p">);</code>

<code class="nx">groucho</code><code class="p">.</code><code class="nx">logDetails</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">harpo</code><code class="p">);</code>
<code class="c1">// Out:</code>
<code class="c1">// "Citizen Harpo M. from Freedonia"</code></pre>
<p>So JavaScript’s <code>this</code> is a much more malleable proxy than Python’s <code>self</code>, offering more freedom but also the responsibility of tracking calling context<a data-primary="new operator (JavaScript)" data-secondary="use with this keyword" data-type="indexterm" id="idm45607801602176"/> and, should you use it, making sure <code>new</code> is always used in creating objects.<sup><a data-type="noteref" href="ch02.xhtml#idm45607801599376" id="idm45607801599376-marker">19</a></sup></p>
</div></aside>
<p>I included  <a data-type="xref" href="#bridge_citizen_js">Example 2-5</a>, which shows <code>new</code> in JavaScript object instantiation, because you will run into its use a fair deal. But the syntax is already a little awkward and gets quite a bit worse when you try to do inheritance. ECMAScript 5 introduced the <code>Object.create</code> method, a better way to create objects and to implement inheritance. I’d recommend using it in your own code, but <code>new</code> will probably crop up in some third-party libraries.<a data-primary="inheritance" data-secondary="prototypes in JavaScript" data-type="indexterm" id="idm45607801595776"/></p>
<p>Let’s use <code>Object.create</code> to create a <code>Citizen</code> and its <code>Winner</code> inheritor. To emphasize, JavaScript has many ways to do this, but <a data-type="xref" href="#bridge_prototype_inheritance">Example 2-6</a> shows the cleanest I have found and my personal <span class="keep-together">pattern</span>.</p>
<div data-type="example" id="bridge_prototype_inheritance">
<h5><span class="label">Example 2-6. </span>Prototypical inheritance with <code>Object.create</code></h5>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">Citizen</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO12-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO12-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="nx">setCitizen</code><code class="o">:</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code><code> </code><code class="nx">country</code><code class="p">)</code><code class="p">{</code><code>
        </code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code> </code><code class="o">=</code><code> </code><code class="nx">name</code><code class="p">;</code><code>
        </code><code class="k">this</code><code class="p">.</code><code class="nx">country</code><code> </code><code class="o">=</code><code> </code><code class="nx">country</code><code class="p">;</code><code>
        </code><code class="k">return</code><code> </code><code class="k">this</code><code class="p">;</code><code>
    </code><code class="p">}</code><code class="p">,</code><code>
    </code><code class="nx">printDetails</code><code class="o">:</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="p">)</code><code class="p">{</code><code>
        </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Citizen '</code><code> </code><code class="o">+</code><code> </code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code> </code><code class="o">+</code><code> </code><code class="s1">' from '</code><code class="p">,</code><code class="o">\</code><code>
        </code><code class="o">+</code><code> </code><code class="k">this</code><code class="p">.</code><code class="nx">country</code><code class="p">)</code><code class="p">;</code><code>
    </code><code class="p">}</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">Winner</code><code> </code><code class="o">=</code><code> </code><code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="nx">Citizen</code><code class="p">)</code><code class="p">;</code><code>

</code><code class="nx">Winner</code><code class="p">.</code><code class="nx">setWinner</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code><code> </code><code class="nx">country</code><code class="p">,</code><code> </code><code class="nx">category</code><code class="p">,</code><code> </code><code class="nx">year</code><code class="p">)</code><code class="p">{</code><code>
    </code><code class="k">this</code><code class="p">.</code><code class="nx">setCitizen</code><code class="p">(</code><code class="nx">name</code><code class="p">,</code><code> </code><code class="nx">country</code><code class="p">)</code><code class="p">;</code><code>
    </code><code class="k">this</code><code class="p">.</code><code class="nx">category</code><code> </code><code class="o">=</code><code> </code><code class="nx">category</code><code class="p">;</code><code>
    </code><code class="k">this</code><code class="p">.</code><code class="nx">year</code><code> </code><code class="o">=</code><code> </code><code class="nx">year</code><code class="p">;</code><code>
    </code><code class="k">return</code><code> </code><code class="k">this</code><code class="p">;</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="nx">Winner</code><code class="p">.</code><code class="nx">logDetails</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="p">)</code><code class="p">{</code><code>
    </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Nobel winner '</code><code> </code><code class="o">+</code><code> </code><code class="k">this</code><code class="p">.</code><code class="nx">name</code><code> </code><code class="o">+</code><code> </code><code class="s1">' from '</code><code> </code><code class="o">+</code><code>
    </code><code class="k">this</code><code class="p">.</code><code class="nx">country</code><code> </code><code class="o">+</code><code> </code><code class="s1">', category '</code><code> </code><code class="o">+</code><code> </code><code class="k">this</code><code class="p">.</code><code class="nx">category</code><code> </code><code class="o">+</code><code> </code><code class="s1">', year '</code><code> </code><code class="o">+</code><code>
    </code><code class="k">this</code><code class="p">.</code><code class="nx">year</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">albert</code><code> </code><code class="o">=</code><code> </code><code class="nb">Object</code><code class="p">.</code><code class="nx">create</code><code class="p">(</code><code class="nx">Winner</code><code class="p">)</code><code>
    </code><code class="p">.</code><code class="nx">setWinner</code><code class="p">(</code><code class="s1">'Albert Einstein'</code><code class="p">,</code><code> </code><code class="s1">'Switzerland'</code><code class="p">,</code><code> </code><code class="s1">'Physics'</code><code class="p">,</code><code> </code><code class="mi">1921</code><code class="p">)</code><code class="p">;</code><code>

</code><code class="nx">albert</code><code class="p">.</code><code class="nx">logDetails</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="c1">// Out:
</code><code class="c1">// Nobel winner Albert Einstein from Switzerland, category
</code><code class="c1">// Physics, year 1921</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO12-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO12-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p><code>Citizen</code> is now an object rather than a constructor function. Think of this as the base house for any new buildings such as <code>Winner</code>.</p></dd>
</dl></div>
<p>To reiterate, prototypical inheritance is not seen that often in JavaScript dataviz, particularly the 800-pound gorilla D3 with its emphasis on declarative and functional patterns, with <em>raw</em> unencapsulated data being used to stamp its impression on the web page.</p>
<p>The tricky class/prototype comparison concludes this section on basic syntactic differences. Now let’s look at some common patterns seen in dataviz work with Python and JS.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Differences in Practice" data-type="sect1"><div class="sect1" id="idm45607802268832">
<h1>Differences in Practice</h1>
<p>The syntactic differences between JS and Python are important to know and are thankfully outweighed by their syntactic similarities.<a data-primary="prototypes, comparison to classes" data-startref="ix_prototyp" data-type="indexterm" id="idm45607801532272"/><a data-primary="classes, comparison to prototypes" data-startref="ix_clsprt" data-type="indexterm" id="idm45607801531328"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-startref="ix_JSbrPycls" data-tertiary="classes and prototypes" data-type="indexterm" id="idm45607801530416"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-startref="ix_PybrJScls" data-tertiary="classes and prototypes" data-type="indexterm" id="idm45607801528960"/><a data-primary="JavaScript" data-secondary="differences in syntax from Python" data-startref="ix_JSbrPy" data-type="indexterm" id="idm45607801527504"/><a data-primary="Python" data-secondary="differences in syntax from JavaScript" data-startref="ix_PybrJS" data-type="indexterm" id="idm45607801526320"/> The meat and potatoes of imperative programming, loops, conditionals, data declaration, and manipulation is much the same. This is all the more so in the specialized domain of data processing and data visualization where the languages’ first-class functions allow common idioms.<a data-primary="JavaScript" data-secondary="differences in practice from Python" data-type="indexterm" id="ix_JSprac"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-type="indexterm" id="ix_Pyprac"/></p>
<p>What follows is a less-than-comprehensive list of some important patterns and idioms seen in Python and JavaScript, from the perspective of a data visualizer. Where possible, a translation between the two languages is given.</p>
<section data-pdf-bookmark="Method Chaining" data-type="sect2"><div class="sect2" id="idm45607801522080">
<h2>Method Chaining</h2>
<p>A common JavaScript idiom is <em>method chaining</em>, popularized by its most-used library, jQuery, and much used in D3. <a data-primary="method chaining" data-type="indexterm" id="idm45607801520096"/><a data-primary="JavaScript" data-secondary="differences in practice from Python" data-tertiary="method chaining" data-type="indexterm" id="idm45607801519392"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="method chaining" data-type="indexterm" id="idm45607801518112"/><a data-primary="jQuery" data-type="indexterm" id="idm45607801516880"/><a data-primary="dot notation (.)" data-secondary="in JavaScript method chaining" data-secondary-sortas="JavaScript" data-type="indexterm" id="idm45607801516208"/>Method chaining involves returning an object from its own method in order to call another method on the result, using dot notation:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">sel</code><code> </code><code class="o">=</code><code> </code><code class="nx">d3</code><code class="p">.</code><code class="nx">select</code><code class="p">(</code><code class="s1">'#viz'</code><code class="p">)</code><code>
    </code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'width'</code><code class="p">,</code><code> </code><code class="s1">'600px'</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO13-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO13-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'height'</code><code class="p">,</code><code> </code><code class="s1">'400px'</code><code class="p">)</code><code>
    </code><code class="p">.</code><code class="nx">style</code><code class="p">(</code><code class="s1">'background'</code><code class="p">,</code><code> </code><code class="s1">'lightgray'</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO13-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO13-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>The <code>attr</code> method returns the D3 selection that called it, which is then used to call another <code>attr</code> method.</p></dd>
</dl>
<p>Method chaining is not much seen in Python, which generally advocates one statement per line in keeping with simplicity and <span class="keep-together">readability</span>.</p>
</div></section>
<section data-pdf-bookmark="Enumerating a List" data-type="sect2"><div class="sect2" id="idm45607801477040">
<h2>Enumerating a List</h2>
<p>Often it’s useful to iterate through a list while keeping track of the item’s index.<a data-primary="JavaScript" data-secondary="differences in practice from Python" data-tertiary="enumerating a list" data-type="indexterm" id="idm45607801475488"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="enumerating a list" data-type="indexterm" id="idm45607801474224"/><a data-primary="lists" data-secondary="enumerating" data-type="indexterm" id="idm45607801472992"/><a data-primary="enumerate function (Python)" data-type="indexterm" id="idm45607801446912"/> Python has the very handy built-in <code>enumerate</code> function for just this reason:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">names</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'Alice'</code><code class="p">,</code> <code class="s1">'Bob'</code><code class="p">,</code> <code class="s1">'Carol'</code><code class="p">]</code>

<code class="k">for</code> <code class="n">i</code><code class="p">,</code> <code class="n">n</code> <code class="ow">in</code> <code class="nb">enumerate</code><code class="p">(</code><code class="n">names</code><code class="p">):</code>
    <code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s1">'</code><code class="si">{</code><code class="n">i</code><code class="si">}</code><code class="s1">: </code><code class="si">{</code><code class="n">n</code><code class="si">}</code><code class="s1">'</code><code class="p">)</code></pre>
<pre data-type="programlisting">Out:
0: Alice
1: Bob
2: Carol</pre>
<p>JavaScript’s list methods, such as <code>forEach</code> and the functional <code>map</code>, <code>reduce</code>, and <code>filter</code>, supply the iterated item and its index to the callback function:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">names</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'Alice'</code><code class="p">,</code> <code class="s1">'Bob'</code><code class="p">,</code> <code class="s1">'Carol'</code><code class="p">];</code>

<code class="nx">names</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="kd">function</code><code class="p">(</code><code class="nx">n</code><code class="p">,</code> <code class="nx">i</code><code class="p">){</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">i</code> <code class="o">+</code> <code class="s1">': '</code> <code class="o">+</code> <code class="nx">n</code><code class="p">);</code>
<code class="p">});</code></pre>
<pre data-type="programlisting">Out:
0: Alice
1: Bob
2: Carol</pre>
</div></section>
<section data-pdf-bookmark="Tuple Unpacking" data-type="sect2"><div class="sect2" id="idm45607801084240">
<h2>Tuple Unpacking</h2>
<p>One of the first cool tricks Python initiates uses <a data-primary="tuples" data-secondary="tuple unpacking" data-type="indexterm" id="idm45607801082400"/><a data-primary="variables" data-secondary="switching in tuple unpacking" data-type="indexterm" id="idm45607801081424"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="tuple unpacking" data-type="indexterm" id="idm45607801080512"/>tuple unpacking to switch variables:</p>
<pre data-code-language="python" data-type="programlisting"><code class="p">(</code><code class="n">a</code><code class="p">,</code> <code class="n">b</code><code class="p">)</code> <code class="o">=</code> <code class="p">(</code><code class="n">b</code><code class="p">,</code> <code class="n">a</code><code class="p">)</code></pre>
<p>Note that the brackets are optional. This can be put to more practical purpose as a way of reducing the temporary variables, such as in a <a href="https://oreil.ly/OAT8Q">Fibonacci function</a>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code> <code class="nf">fibonacci</code><code class="p">(</code><code class="n">n</code><code class="p">):</code>
    <code class="n">x</code><code class="p">,</code> <code class="n">y</code> <code class="o">=</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code>
    <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="n">n</code><code class="p">):</code>
        <code class="nb">print</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>
        <code class="n">x</code><code class="p">,</code> <code class="n">y</code> <code class="o">=</code> <code class="n">y</code><code class="p">,</code> <code class="n">x</code> <code class="o">+</code> <code class="n">y</code>
<code class="c1"># fibonacci(6) -&gt; 0, 1, 1, 2, 3, 5</code></pre>
<p>If you want to ignore one of the unpacked variables, use an <span class="keep-together">underscore</span>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">winner</code><code> </code><code class="o">=</code><code> </code><code class="s1">'</code><code class="s1">Albert Einstein</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Physics</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">1921</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Swiss</code><code class="s1">'</code><code>
</code><code>
</code><code class="n">name</code><code class="p">,</code><code> </code><code class="n">_</code><code class="p">,</code><code> </code><code class="n">_</code><code class="p">,</code><code> </code><code class="n">nationality</code><code> </code><code class="o">=</code><code> </code><code class="n">winner</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO14-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO14-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="nb">print</code><code class="p">(</code><code class="sa">f</code><code class="s1">'</code><code class="si">{</code><code class="n">name</code><code class="si">}</code><code class="s1">, </code><code class="si">{</code><code class="n">nationality</code><code class="si">}</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="c1"># Albert Einstein, Swiss</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO14-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO14-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Python 3 has an <a href="https://oreil.ly/MFjiR">* operator</a> that means, in this case, we could unpack our variables with this: <code>name, *_, nationality = winner</code></p></dd>
</dl>
<p>The JavaScript language is adapting rapidly and has recently acquired some very powerful <a href="https://oreil.ly/97rbT">destructuring abilities</a>. <a data-primary="destructuring capabilities in JavaScript" data-type="indexterm" id="idm45607800937744"/><a data-primary="spread operator (…​) in Java Script" data-type="indexterm" id="idm45607800937040"/><a data-primary="JavaScript" data-secondary="differences in practice from Python" data-tertiary="tuple unpacking" data-type="indexterm" id="idm45607800936400"/>With the addition of the <em>spread operator</em> (<code>...</code>), this enables some very succinct data manipulation:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">a</code><code class="p">,</code><code> </code><code class="nx">b</code><code class="p">,</code><code> </code><code class="nx">rem</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO15-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO15-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>

</code><code class="p">[</code><code class="nx">a</code><code class="p">,</code><code> </code><code class="nx">b</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">]</code><code>
</code><code class="c1">// swap variables
</code><code class="p">[</code><code class="nx">a</code><code class="p">,</code><code> </code><code class="nx">b</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="nx">b</code><code class="p">,</code><code> </code><code class="nx">a</code><code class="p">]</code><code>
</code><code class="c1">// using the spread operator
</code><code class="p">[</code><code class="nx">a</code><code class="p">,</code><code> </code><code class="nx">b</code><code class="p">,</code><code> </code><code class="p">...</code><code class="nx">rem</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">,</code><code class="p">]</code><code> </code><code class="c1">// rem = [3, 4, 5, 6]</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO15-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO15-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Unlike in Python, you still need to declare any variables you are going to use.</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="Collections" data-type="sect2"><div class="sect2" id="idm45607801083648">
<h2>Collections</h2>
<p>One of the most useful Python “batteries” is the <code>collections</code> module. <a data-primary="collections (Python)" data-type="indexterm" id="idm45607800839488"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="collections" data-type="indexterm" id="idm45607800838752"/><a data-primary="dictionaries (dicts)" data-secondary="specialized datatypes for handling in Python" data-type="indexterm" id="idm45607800837568"/>This provides some specialized container datatypes to augment Python’s standard set. It has a <code>deque</code>, which provides a list-like container with fast appends and pops at either end; an <code>OrderedDict</code>, which remembers the order entries were added; a <code>defaultdict</code>, which provides a factory function to set the dictionary’s default; and a <code>Counter</code> container for counting hashable objects, among others. I find myself using the last three a lot.<a data-primary="defaultdict type (Python)" data-type="indexterm" id="idm45607800834576"/><a data-primary="OrderedDict type (Python)" data-type="indexterm" id="idm45607800797952"/><a data-primary="Counter type (Python)" data-type="indexterm" id="idm45607800797344"/> Here are a few examples:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code><code> </code><code class="nn">collections</code><code> </code><code class="kn">import</code><code> </code><code class="n">Counter</code><code class="p">,</code><code> </code><code class="n">defaultdict</code><code class="p">,</code><code> </code><code class="n">OrderedDict</code><code>
</code><code>
</code><code class="n">items</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'</code><code class="s1">F</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">B</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">E</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">F</code><code class="s1">'</code><code class="p">]</code><code>
</code><code>
</code><code class="n">cntr</code><code> </code><code class="o">=</code><code> </code><code class="n">Counter</code><code class="p">(</code><code class="n">items</code><code class="p">)</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">cntr</code><code class="p">)</code><code>
</code><code class="n">cntr</code><code class="p">[</code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">-</code><code class="o">=</code><code class="mi">1</code><code>
</code><code class="nb">print</code><code class="p">(</code><code class="n">cntr</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code class="n">Counter</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">F</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">B</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">E</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">}</code><code class="p">)</code><code>
</code><code class="n">Counter</code><code class="p">(</code><code class="p">{</code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">F</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">B</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">E</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">}</code><code class="p">)</code><code>
</code><code>
</code><code>
</code><code class="n">d</code><code> </code><code class="o">=</code><code> </code><code class="n">defaultdict</code><code class="p">(</code><code class="nb">int</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO16-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO16-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>
</code><code class="k">for</code><code> </code><code class="n">item</code><code> </code><code class="ow">in</code><code> </code><code class="n">items</code><code class="p">:</code><code>
</code><code>    </code><code class="n">d</code><code class="p">[</code><code class="n">item</code><code class="p">]</code><code> </code><code class="o">+</code><code class="o">=</code><code> </code><code class="mi">1</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO16-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO16-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code>
</code><code class="n">d</code><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code class="n">defaultdict</code><code class="p">(</code><code class="o">&lt;</code><code class="nb">type</code><code> </code><code class="s1">'</code><code class="s1">int</code><code class="s1">'</code><code class="o">&gt;</code><code class="p">,</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">B</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">E</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">F</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">}</code><code class="p">)</code><code>
</code><code>
</code><code>
</code><code class="n">OrderedDict</code><code class="p">(</code><code class="nb">sorted</code><code class="p">(</code><code class="n">d</code><code class="o">.</code><code class="n">items</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">key</code><code class="o">=</code><code class="k">lambda</code><code> </code><code class="n">i</code><code class="p">:</code><code> </code><code class="n">i</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO16-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO16-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code class="n">OrderedDict</code><code class="p">(</code><code class="p">[</code><code class="p">(</code><code class="s1">'</code><code class="s1">B</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">E</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">A</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">F</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'</code><code class="s1">C</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">)</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO16-4" id="co_a_language_learning_bridge_between_python_and_javascript_CO16-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO16-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO16-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Sets the dictionary default to an integer, with value 0 by default.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO16-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO16-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>If the item-key doesn’t exist, its value is set to the default of 0 and 1 added to that.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO16-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO16-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Gets the list of items in the dictionary <code>d</code> as key-value tuple pairs, sorts using the integer value, and then creates an <code>OrderedDict</code> with the sorted list.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO16-4" id="callout_a_language_learning_bridge_between_python_and_javascript_CO16-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></dt>
<dd><p>The <code>OrderedDict</code> remembers the (sorted) order of the items as they were added to it.</p></dd>
</dl>
<p>You can get more details on the <code>collections</code> module in the <a href="https://oreil.ly/IOK7c">Python documentation</a>.</p>
<p>If you want to replicate some of Python’s <code>collections</code> function using more conventional JavaScript libraries, Underscore (or its functionally identical replacement Lodash<sup><a data-type="noteref" href="ch02.xhtml#idm45607800747696" id="idm45607800747696-marker">20</a></sup>) is a good place to start. These libraries offer some enhanced functional programming utilities. Let’s take a quick look at this very handy tool.</p>
</div></section>
<section data-pdf-bookmark="Underscore" data-type="sect2"><div class="sect2" id="idm45607800746880">
<h2>Underscore</h2>
<p>Underscore is probably the most popular JavaScript library after the ubiquitous jQuery and offers a bevy of functional programming utilities for the JavaScript dataviz programmer. <a data-primary="JavaScript" data-secondary="differences in practice from Python" data-tertiary="replicating Python collections functionality with Underscore" data-type="indexterm" id="idm45607800745184"/><a data-primary="Underscore library (JavaScript)" data-type="indexterm" id="idm45607800744000"/>The easiest way to use Underscore is to use a content delivery network (CDN) to load it remotely (these loads will be cached by your browser, making things very efficient for common libraries), like so:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"https://cdnjs.cloudflare.com/ajax/libs/</code>
<code class="s">             underscore.js/1.13.1/underscore-min.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre>
<p>Underscore has loads of useful functions. There is, for example, a <code>countBy</code> method, which serves the same purpose as the Python’s <code>collections</code> counter just discussed:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">items</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="s1">'F'</code><code class="p">,</code><code> </code><code class="s1">'C'</code><code class="p">,</code><code> </code><code class="s1">'C'</code><code class="p">,</code><code> </code><code class="s1">'A'</code><code class="p">,</code><code> </code><code class="s1">'B'</code><code class="p">,</code><code> </code><code class="s1">'A'</code><code class="p">,</code><code> </code><code class="s1">'C'</code><code class="p">,</code><code> </code><code class="s1">'E'</code><code class="p">,</code><code> </code><code class="s1">'F'</code><code class="p">]</code><code class="p">;</code><code>

</code><code class="nx">_</code><code class="p">.</code><code class="nx">countBy</code><code class="p">(</code><code class="nx">items</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO17-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO17-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="nx">Out</code><code class="o">:</code><code>
</code><code class="nb">Object</code><code> </code><code class="p">{</code><code class="nx">F</code><code class="o">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="nx">C</code><code class="o">:</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="nx">A</code><code class="o">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="nx">B</code><code class="o">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="nx">E</code><code class="o">:</code><code> </code><code class="mi">1</code><code class="p">}</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO17-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO17-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Now you see why the library is called Underscore.</p></dd>
</dl>
<p>As we’ll now see, the inclusion in modern JavaScript of native functional methods (<code>map</code>, <code>reduce</code>, <code>filter</code>) and a <code>forEach</code> iterator for arrays has made Underscore slightly less indispensable, but it still has some great utilities to augment vanilla JS. With a little chaining, you can produce extremely terse but very powerful code. Underscore was my introduction to functional programming in JavaScript, and the idioms are just as appealing today.  Check out Underscore’s repertoire of utilities on <a href="https://underscorejs.org">their website</a>.</p>
<p>Let’s have a look at Underscore in action, tackling a more involved task:</p>
<pre data-code-language="js" data-type="programlisting"><code class="nx">journeys</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code>
  </code><code class="p">{</code><code class="nx">period</code><code class="o">:</code><code class="s1">'morning'</code><code class="p">,</code><code> </code><code class="nx">times</code><code class="o">:</code><code class="p">[</code><code class="mi">44</code><code class="p">,</code><code> </code><code class="mi">34</code><code class="p">,</code><code> </code><code class="mi">56</code><code class="p">,</code><code> </code><code class="mi">31</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
  </code><code class="p">{</code><code class="nx">period</code><code class="o">:</code><code class="s1">'evening'</code><code class="p">,</code><code> </code><code class="nx">times</code><code class="o">:</code><code class="p">[</code><code class="mi">35</code><code class="p">,</code><code> </code><code class="mi">33</code><code class="p">]</code><code class="p">,</code><code class="p">}</code><code class="p">,</code><code>
  </code><code class="p">{</code><code class="nx">period</code><code class="o">:</code><code class="s1">'morning'</code><code class="p">,</code><code> </code><code class="nx">times</code><code class="o">:</code><code class="p">[</code><code class="mi">33</code><code class="p">,</code><code> </code><code class="mi">29</code><code class="p">,</code><code> </code><code class="mi">35</code><code class="p">,</code><code> </code><code class="mi">41</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
  </code><code class="p">{</code><code class="nx">period</code><code class="o">:</code><code class="s1">'evening'</code><code class="p">,</code><code> </code><code class="nx">times</code><code class="o">:</code><code class="p">[</code><code class="mi">24</code><code class="p">,</code><code> </code><code class="mi">45</code><code class="p">,</code><code> </code><code class="mi">27</code><code class="p">]</code><code class="p">}</code><code class="p">,</code><code>
  </code><code class="p">{</code><code class="nx">period</code><code class="o">:</code><code class="s1">'morning'</code><code class="p">,</code><code> </code><code class="nx">times</code><code class="o">:</code><code class="p">[</code><code class="mi">18</code><code class="p">,</code><code> </code><code class="mi">23</code><code class="p">,</code><code> </code><code class="mi">28</code><code class="p">]</code><code class="p">}</code><code>
</code><code class="p">]</code><code class="p">;</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">groups</code><code> </code><code class="o">=</code><code> </code><code class="nx">_</code><code class="p">.</code><code class="nx">groupBy</code><code class="p">(</code><code class="nx">journeys</code><code class="p">,</code><code> </code><code class="s1">'period'</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="kd">let</code><code> </code><code class="nx">mTimes</code><code> </code><code class="o">=</code><code> </code><code class="nx">_</code><code class="p">.</code><code class="nx">pluck</code><code class="p">(</code><code class="nx">groups</code><code class="p">[</code><code class="s1">'morning'</code><code class="p">]</code><code class="p">,</code><code> </code><code class="s1">'times'</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="nx">mTimes</code><code> </code><code class="o">=</code><code> </code><code class="nx">_</code><code class="p">.</code><code class="nx">flatten</code><code class="p">(</code><code class="nx">mTimes</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO18-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO18-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="kd">let</code><code> </code><code class="nx">average</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">l</code><code class="p">)</code><code class="p">{</code><code>
  </code><code class="kd">let</code><code> </code><code class="nx">sum</code><code> </code><code class="o">=</code><code> </code><code class="nx">_</code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code><code class="nx">l</code><code class="p">,</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">a</code><code class="p">,</code><code class="nx">b</code><code class="p">)</code><code class="p">{</code><code class="k">return</code><code> </code><code class="nx">a</code><code class="o">+</code><code class="nx">b</code><code class="p">}</code><code class="p">,</code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code>
  </code><code class="k">return</code><code> </code><code class="nx">sum</code><code class="o">/</code><code class="nx">l</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code><code>
</code><code class="p">}</code><code class="p">;</code><code>
</code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Average morning time is '</code><code> </code><code class="o">+</code><code> </code><code class="nx">average</code><code class="p">(</code><code class="nx">mTimes</code><code class="p">)</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="nx">Out</code><code class="o">:</code><code>
</code><code class="nx">Average</code><code> </code><code class="nx">morning</code><code> </code><code class="nx">time</code><code> </code><code class="nx">is</code><code> </code><code class="mf">33.81818181818182</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO18-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO18-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Our array of morning times arrays (<code>[[44, 34, 56, 31], [33...]]</code>) needs to be <em>flattened</em> into a single array of numbers.</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="Functional Array Methods and List Comprehensions" data-type="sect2"><div class="sect2" id="idm45607800746288">
<h2>Functional Array Methods and List Comprehensions</h2>
<p>I find myself using Underscore a lot less since the addition, with ECMAScript 5,  of functional methods to JavaScript arrays.<a data-primary="JavaScript" data-secondary="differences in practice from Python" data-tertiary="functional array methods and list comprehensions" data-type="indexterm" id="idm45607800197072"/><a data-primary="arrays" data-secondary="functional array methods in JavaScript" data-type="indexterm" id="idm45607800195888"/><a data-primary="lists" data-secondary="list comprehensions in JavaScript and Python" data-type="indexterm" id="idm45607800194976"/> I don’t think I’ve used a conventional <code>for</code> loop since then, which, given the ugliness of JS <code>for</code> loops, is a very good thing.</p>
<p>Once you get used to processing arrays functionally, it’s hard to consider going back. Combined with JS’s anonymous functions, it makes for very fluid, expressive programming. It’s also an area where method chaining seems very natural. Let’s look at a highly contrived example:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code><code> </code><code class="nx">nums</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">,</code><code> </code><code class="mi">7</code><code class="p">,</code><code> </code><code class="mi">8</code><code class="p">,</code><code> </code><code class="mi">9</code><code class="p">,</code><code> </code><code class="mi">10</code><code class="p">]</code><code class="p">;</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">sum</code><code> </code><code class="o">=</code><code> </code><code class="nx">nums</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">x</code><code> </code><code class="o">=&gt;</code><code> </code><code class="nx">x</code><code class="o">%</code><code class="mi">2</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO19-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO19-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
  </code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">x</code><code> </code><code class="o">=&gt;</code><code> </code><code class="nx">x</code><code> </code><code class="o">*</code><code> </code><code class="nx">x</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO19-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO19-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
  </code><code class="p">.</code><code class="nx">reduce</code><code class="p">(</code><code class="p">(</code><code class="nx">total</code><code class="p">,</code><code> </code><code class="nx">current</code><code class="p">)</code><code> </code><code class="o">=&gt;</code><code> </code><code class="nx">total</code><code> </code><code class="o">+</code><code> </code><code class="nx">current</code><code class="p">,</code><code> </code><code class="mi">0</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO19-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO19-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>

</code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Sum of the odd squares is '</code><code> </code><code class="o">+</code><code> </code><code class="nx">sum</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO19-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO19-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Filters the list for odd numbers (i.e., returning <code>1</code> for the <code>modulus (%) 2</code> <span class="keep-together">operation</span>).<a data-primary="filter method (JavaScript)" data-type="indexterm" id="idm45607799919200"/></p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO19-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO19-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p><code>map</code> produces a new list by applying a function to each member (i.e., <code>[1, 3, 5...]</code> → <code>[1, 9, 25...]</code>).<a data-primary="map method (JavaScript)" data-type="indexterm" id="idm45607799915088"/></p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO19-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO19-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p><code>reduce</code> processes the resultant mapped list in sequence, providing the current (in this case, summed) value (<code>total</code>) and the item value (<code>current</code>). By default, the initial value of the first argument (<code>total</code>) is <code>0</code> but we provide it explicitly here, as the second argument.<a data-primary="reduce method (JavaScript)" data-type="indexterm" id="idm45607799862800"/></p></dd>
</dl>
<p class="pagebreak-before">Python’s powerful list <a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="list comprehensions" data-type="indexterm" id="idm45607799861808"/><a data-primary="range function (Python)" data-type="indexterm" id="idm45607799860720"/>comprehensions can emulate the previous example easily enough:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">nums</code><code> </code><code class="o">=</code><code> </code><code class="nb">range</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO20-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO20-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>
</code><code class="n">odd_squares</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="n">x</code><code> </code><code class="o">*</code><code> </code><code class="n">x</code><code> </code><code class="k">for</code><code> </code><code class="n">x</code><code> </code><code class="ow">in</code><code> </code><code class="n">nums</code><code> </code><code class="k">if</code><code> </code><code class="n">x</code><code class="o">%</code><code class="mi">2</code><code class="p">]</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO20-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO20-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="nb">sum</code><code class="p">(</code><code class="n">odd_squares</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO20-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO20-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code class="mi">165</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO20-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO20-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Python has a handy built-in <code>range</code> function, which can also take a start, end, and step (e.g., range(2, 8, 2) → (2, 4, 6)).</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO20-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO20-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>The <code>if</code> condition tests for oddness of <code>x</code>, and any numbers passing this filter are squared and inserted into the list.<a data-primary="sum statement (Python)" data-type="indexterm" id="idm45607799819296"/></p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO20-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO20-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Python also has a built-in and often used <code>sum</code> statement.</p></dd>
</dl>
<div data-type="tip"><h6>Tip</h6>
<p>Python’s list comprehensions can use recursive control structures, such as applying a second <code>for</code>/<code>if</code> expression to the iterated items.<a data-primary="recursive control structures in Python list comprehensions" data-type="indexterm" id="idm45607799779664"/> Although this can create terse and powerful lines of code, it goes against the grain of Python’s readability and I discourage its use. Even simple list comprehensions are less than intuitive and, as much as it appeals to the leet hacker in all of us, you risk creating incomprehensible code.</p>
</div>
<p>Python’s list comprehensions work well for basic filtering and mapping. They do lack the convenience of JavaScript’s anonymous<a data-primary="anonymous functions (JavaScript)" data-type="indexterm" id="idm45607799778336"/> functions (which are fully fledged, with their own scope, control blocks, exception handling, etc.), but there are arguments against the use of anonymous functions. For example, they are not reusable and, being unnamed, they make it hard to follow exceptions and debug. See <a href="https://oreil.ly/7u1j6">Ultimate Courses</a> for some persuasive arguments. Having said that, for libraries like D3, replacing the small, throwaway anonymous functions used to set <a href="https://oreil.ly/hYN27">DOM attributes</a> and properties with named ones would be far too onerous and would just add to the boilerplate.</p>
<p>Python does have functional lambda expressions, which we’ll look at in the next section, but for full functional processing in Python by necessity and JavaScript for best practice, we can use named functions to increase our control scope. For our simple odd-squares example, named functions are a contrivance—but note that they increase the first-glance readability of the list comprehension, which becomes much more important as your functions get more complex:</p>
<pre class="pagebreak-before" data-code-language="python" data-type="programlisting"><code class="n">items</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">]</code>

<code class="k">def</code> <code class="nf">is_odd</code><code class="p">(</code><code class="n">x</code><code class="p">):</code>
    <code class="k">return</code> <code class="n">x</code><code class="o">%</code><code class="mi">2</code>

<code class="k">def</code> <code class="nf">sq</code><code class="p">(</code><code class="n">x</code><code class="p">):</code>
    <code class="k">return</code> <code class="n">x</code> <code class="o">*</code> <code class="n">x</code>

<code class="nb">sum</code><code class="p">([</code><code class="n">sq</code><code class="p">(</code><code class="n">x</code><code class="p">)</code> <code class="k">for</code> <code class="n">x</code> <code class="ow">in</code> <code class="n">items</code> <code class="k">if</code> <code class="n">is_odd</code><code class="p">(</code><code class="n">x</code><code class="p">)])</code></pre>
<p>With JavaScript, a similar contrivance can also increase readability and facilitate DRY code:<sup><a data-type="noteref" href="ch02.xhtml#idm45607799695392" id="idm45607799695392-marker">21</a></sup></p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">let</code> <code class="nx">isOdd</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">x</code><code class="p">){</code> <code class="k">return</code> <code class="nx">x</code><code class="o">%</code><code class="mi">2</code><code class="p">;</code> <code class="p">};</code>

<code class="nx">sum</code> <code class="o">=</code> <code class="nx">l</code><code class="p">.</code><code class="nx">filter</code><code class="p">(</code><code class="nx">isOdd</code><code class="p">)</code>
<code class="p">...</code></pre>
</div></section>
<section data-pdf-bookmark="Map, Reduce, and Filter with Python’s Lambdas" data-type="sect2"><div class="sect2" id="idm45607799685392">
<h2>Map, Reduce, and Filter with Python’s Lambdas</h2>
<p>Although Python lacks anonymous functions, it does have <em>lambdas</em>, which are nameless expressions that take arguments.<a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="map, reduce, and filter with Python lambdas" data-type="indexterm" id="idm45607799668640"/><a data-primary="lambdas (Python), map, reduce, and filter with" data-type="indexterm" id="idm45607799667456"/><a data-primary="map method (Python)" data-type="indexterm" id="idm45607799666816"/><a data-primary="reduce method (Python)" data-type="indexterm" id="idm45607799666144"/><a data-primary="filter method (Python)" data-type="indexterm" id="idm45607799665472"/> Though lacking the bells and whistles of <span class="keep-together">JavaScript’s</span> anonymous functions, these are a powerful addition to Python’s functional programming repertoire, especially when combined with its functional <span class="keep-together">methods</span>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Python’s functional built-ins (<code>map</code>, <code>reduce</code>, <code>filter</code> methods, and lambda expressions) have a checkered past. It’s no secret that the creator of Python wanted to remove them from the language. The clamor of disapproval led to their reluctant preservation. With the recent trend toward functional programming, this looks like a very good thing. They’re not perfect but are far better than nothing. And given JavaScript’s strong functional emphasis, they’re a good way to leverage skills acquired in that language.</p>
</div>
<p>Python’s lambdas take a number of parameters and return an operation on them, using a colon separator to define the function block, in much the same way that standard Python functions, only pared to the bare essentials and with an implicit return. The following example shows a few lambdas employed in functional programming:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code><code> </code><code class="nn">functools</code><code> </code><code class="kn">import</code><code> </code><code class="n">reduce</code><code> </code><code class="c1"># if using Python 3+</code><code>
</code><code>
</code><code class="n">nums</code><code> </code><code class="o">=</code><code> </code><code class="p">[</code><code class="mi">0</code><code class="p">,</code><code> </code><code class="mi">1</code><code class="p">,</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="mi">3</code><code class="p">,</code><code> </code><code class="mi">4</code><code class="p">,</code><code> </code><code class="mi">5</code><code class="p">,</code><code> </code><code class="mi">6</code><code class="p">,</code><code> </code><code class="mi">7</code><code class="p">,</code><code> </code><code class="mi">8</code><code class="p">,</code><code> </code><code class="mi">9</code><code class="p">]</code><code>
</code><code>
</code><code class="n">odds</code><code> </code><code class="o">=</code><code> </code><code class="nb">filter</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">%</code><code> </code><code class="mi">2</code><code class="p">,</code><code> </code><code class="n">nums</code><code class="p">)</code><code>
</code><code class="n">odds_sq</code><code> </code><code class="o">=</code><code> </code><code class="nb">map</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">*</code><code> </code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">odds</code><code class="p">)</code><code>
</code><code class="n">reduce</code><code class="p">(</code><code class="k">lambda</code><code> </code><code class="n">x</code><code class="p">,</code><code> </code><code class="n">y</code><code class="p">:</code><code> </code><code class="n">x</code><code> </code><code class="o">+</code><code> </code><code class="n">y</code><code class="p">,</code><code> </code><code class="n">odds_sq</code><code class="p">)</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO21-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO21-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code class="mi">165</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO21-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO21-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Here, the <code>reduce</code> method provides two arguments to the lambda, which uses them to return the expression after the colon.</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="JavaScript Closures and the Module Pattern" data-type="sect2"><div class="sect2" id="idm45607799551328">
<h2>JavaScript Closures and the Module Pattern</h2>
<p>One of the key concepts in JavaScript is that of the <em>closure</em>, which is essentially a nested function declaration that uses variables declared in an outer (but not global) scope that are <em>kept alive</em> after the function is returned.<a data-primary="JavaScript" data-secondary="differences in practice from Python" data-tertiary="closures and the module pattern" data-type="indexterm" id="idm45607799548512"/><a data-primary="closures" data-secondary="in JavaScript" data-type="indexterm" id="idm45607799547328"/> Closures allow for a number of very useful programming patterns and are a common feature of the language.</p>
<p>Let’s look at possibly the most common usage of closures and one we’ve already seen exploited in our module pattern (<a data-type="xref" href="#pyjs_module">Example 2-2</a>): exposing a limited API while having access to essentially private member variables.</p>
<p>A simple example of a closure is this little counter:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">function</code><code> </code><code class="nx">Counter</code><code class="p">(</code><code class="nx">inc</code><code class="p">)</code><code> </code><code class="p">{</code><code>
  </code><code class="kd">let</code><code> </code><code class="nx">count</code><code> </code><code class="o">=</code><code> </code><code class="mi">0</code><code class="p">;</code><code>
  </code><code class="kd">let</code><code> </code><code class="nx">add</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO22-1" id="co_a_language_learning_bridge_between_python_and_javascript_CO22-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="nx">count</code><code> </code><code class="o">+=</code><code> </code><code class="nx">inc</code><code class="p">;</code><code>
    </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Current count: '</code><code> </code><code class="o">+</code><code> </code><code class="nx">count</code><code class="p">)</code><code class="p">;</code><code>
  </code><code class="p">}</code><code>
  </code><code class="k">return</code><code> </code><code class="nx">add</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><code class="kd">let</code><code> </code><code class="nx">inc2</code><code> </code><code class="o">=</code><code> </code><code class="nx">Counter</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO22-2" id="co_a_language_learning_bridge_between_python_and_javascript_CO22-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="nx">inc2</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code> </code><a class="co" href="#callout_a_language_learning_bridge_between_python_and_javascript_CO22-3" id="co_a_language_learning_bridge_between_python_and_javascript_CO22-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code class="nx">Out</code><code class="o">:</code><code>
</code><code class="nx">Current</code><code> </code><code class="nx">count</code><code class="o">:</code><code> </code><code class="mi">2</code><code>
</code><code class="nx">inc2</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="nx">Out</code><code class="o">:</code><code>
</code><code class="nx">Current</code><code> </code><code class="nx">count</code><code class="o">:</code><code> </code><code class="mi">4</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO22-1" id="callout_a_language_learning_bridge_between_python_and_javascript_CO22-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>The <code>add</code> function gets access to the essentially private, outer-scope <code>count</code> and <code>inc</code> variables.</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO22-2" id="callout_a_language_learning_bridge_between_python_and_javascript_CO22-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>This returns an <code>add</code> function with the closure variables, <code>count</code> (<code>0</code>) and <code>inc</code> (<code>2</code>).</p></dd>
<dt><a class="co" href="#co_a_language_learning_bridge_between_python_and_javascript_CO22-3" id="callout_a_language_learning_bridge_between_python_and_javascript_CO22-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Calling <code>inc2</code> calls <code>add</code>, updating the <em>closed</em> <code>count</code> variable.</p></dd>
</dl>
<p>We can extend the <code>Counter</code> to add a little API. <a data-primary="modules" data-secondary="module pattern in JavaScript" data-type="indexterm" id="idm45607799373696"/>This technique is the basis of JavaScript modules and many simple libraries, particularly when using script-based JavaScript.<sup><a data-type="noteref" href="ch02.xhtml#idm45607799372592" id="idm45607799372592-marker">22</a></sup> In essence, it selectively exposes public methods while hiding private methods and variables, which is generally seen as good practice in the programming world:</p>
<pre data-code-language="js" data-type="programlisting"><code class="kd">function</code> <code class="nx">Counter</code><code class="p">(</code><code class="nx">inc</code><code class="p">)</code> <code class="p">{</code>
  <code class="kd">let</code> <code class="nx">count</code> <code class="o">=</code> <code class="mi">0</code>
  <code class="kd">let</code> <code class="nx">api</code> <code class="o">=</code> <code class="p">{}</code>
  <code class="nx">api</code><code class="p">.</code><code class="nx">add</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">count</code> <code class="o">+=</code> <code class="nx">inc</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Current count: '</code> <code class="o">+</code> <code class="nx">count</code><code class="p">);</code>
  <code class="p">}</code>
  <code class="nx">api</code><code class="p">.</code><code class="nx">sub</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">count</code> <code class="o">-=</code> <code class="nx">inc</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Current count: '</code> <code class="o">+</code> <code class="nx">count</code><code class="p">)</code>
  <code class="p">}</code>
  <code class="nx">api</code><code class="p">.</code><code class="nx">reset</code> <code class="o">=</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{</code>
    <code class="nx">count</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Count reset to 0'</code><code class="p">)</code>
  <code class="p">}</code>

  <code class="k">return</code> <code class="nx">api</code>
<code class="p">}</code>

<code class="nx">cntr</code> <code class="o">=</code> <code class="nx">Counter</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>
<code class="nx">cntr</code><code class="p">.</code><code class="nx">add</code><code class="p">()</code> <code class="c1">// Current count: 3</code>
<code class="nx">cntr</code><code class="p">.</code><code class="nx">add</code><code class="p">()</code> <code class="c1">// Current count: 6</code>
<code class="nx">cntr</code><code class="p">.</code><code class="nx">sub</code><code class="p">()</code> <code class="c1">// Current count: 3</code>
<code class="nx">cntr</code><code class="p">.</code><code class="nx">reset</code><code class="p">()</code> <code class="c1">// Count reset to 0</code></pre>
<p>Closures have all sorts of uses in JavaScript and I’d recommend getting your head around them—you’ll see them a lot as you start investigating other people’s code. These are three particularly good web articles that provide a lot of good use cases for closures:</p>
<ul>
<li>
<p><a href="https://oreil.ly/T6itS">Mozilla’s introduction</a></p>
</li>
<li>
<p><a href="https://oreil.ly/0P2EI">“JavaScript Module Pattern: In-Depth”</a> by Ben Cherry</p>
</li>
<li>
<p><a href="https://oreil.ly/xz4G5">“Use Cases for JavaScript Closures”</a> by Juriy Zaytsev</p>
</li>
</ul>
<p>Python has closures, but they are not used nearly<a data-primary="closures" data-secondary="in Python" data-type="indexterm" id="idm45607799308736"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-tertiary="closures" data-type="indexterm" id="idm45607799307760"/> as much as <span class="keep-together">JavaScript’s</span>, perhaps because of a few quirks that, though surmountable, make for some slightly awkward code. To demonstrate, <a data-type="xref" href="#pyjs_pyclosure_1">Example 2-7</a> tries to replicate the previous JavaScript counter.</p>
<div data-type="example" id="pyjs_pyclosure_1">
<h5><span class="label">Example 2-7. </span>A first-pass attempt at a Python counter closure</h5>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code> <code class="nf">get_counter</code><code class="p">(</code><code class="n">inc</code><code class="p">):</code>
    <code class="n">count</code> <code class="o">=</code> <code class="mi">0</code>
    <code class="k">def</code> <code class="nf">add</code><code class="p">():</code>
        <code class="n">count</code> <code class="o">+=</code> <code class="n">inc</code>
        <code class="nb">print</code><code class="p">(</code><code class="s1">'Current count: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="n">count</code><code class="p">))</code>
    <code class="k">return</code> <code class="n">add</code></pre></div>
<p>If you create a counter with <code>get_counter</code> (<a data-type="xref" href="#pyjs_pyclosure_1">Example 2-7</a>) and try to run it, you’ll get an <code>UnboundLocalError</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">cntr</code> <code class="o">=</code> <code class="n">get_counter</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code>
<code class="n">cntr</code><code class="p">()</code>
<code class="n">Out</code><code class="p">:</code>
<code class="o">...</code>
<code class="ne">UnboundLocalError</code><code class="p">:</code> <code class="n">local</code> <code class="n">variable</code> <code class="s1">'count'</code> <code class="n">referenced</code> <code class="n">before</code>
<code class="n">assignment</code></pre>
<p>Interestingly, although we can read the value of <code>count</code> within the <code>add</code> function (comment out the  <code>count += inc</code> line to try it), attempts to change it throw an error. This is because attempts to assign a value to something in Python assume it is local in scope. There is no <code>count</code> local to the <code>add</code> function and so an error is thrown.<a data-primary="nonlocal keyword (Python)" data-type="indexterm" id="idm45607799121472"/></p>
<p>In Python 3, we can get around the error in <a data-type="xref" href="#pyjs_pyclosure_1">Example 2-7</a> by using the <code>nonlocal</code> keyword to tell Python that <code>count</code> is in a nonlocal scope:</p>
<pre data-code-language="python" data-type="programlisting"><code class="o">...</code>
<code class="k">def</code> <code class="nf">add</code><code class="p">():</code>
    <code class="k">nonlocal</code> <code class="n">count</code>
    <code class="n">count</code> <code class="o">+=</code> <code class="n">inc</code>
<code class="o">...</code></pre>
<p>If you are obliged to use Python 2+ (please try and upgrade), we can use a little dictionary hack to allow mutation of our closed variables:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code> <code class="nf">get_counter</code><code class="p">(</code><code class="n">inc</code><code class="p">):</code>
    <code class="nb">vars</code> <code class="o">=</code> <code class="p">{</code><code class="s1">'count'</code><code class="p">:</code> <code class="mi">0</code><code class="p">}</code>
    <code class="k">def</code> <code class="nf">add</code><code class="p">():</code>
        <code class="nb">vars</code><code class="p">[</code><code class="s1">'count'</code><code class="p">]</code> <code class="o">+=</code> <code class="n">inc</code>
        <code class="nb">print</code><code class="p">(</code><code class="s1">'Current count: '</code> <code class="o">+</code> <code class="nb">str</code><code class="p">(</code><code class="nb">vars</code><code class="p">[</code><code class="s1">'count'</code><code class="p">]))</code>
    <code class="k">return</code> <code class="n">add</code></pre>
<p>This hack works because we are not assigning a new value to <code>vars</code> but are instead mutating an existing container, which is perfectly valid even if it is out of local scope.</p>
<p>As you can see, with a bit of effort, JavaScripters can transfer their closure skills to Python. The use cases are similar, but Python, being a richer language with lots of useful batteries included, has more options to apply to the same problem. Probably the most common use of closures is in Python’s decorators.<a data-primary="decorators (Python)" data-type="indexterm" id="idm45607799044336"/></p>
<p><em>Decorators</em> are essentially function wrappers that extend the function’s utility without having to alter the function itself. They’re a relatively advanced concept, but you can find a user-friendly introduction <a href="https://oreil.ly/Skz8b">on The Code Ship website</a>.</p>
<p>This concludes my cherry-picked selection of patterns and hacks that I find myself using a lot in dataviz work. You’ll doubtless acquire your own, but I hope these give you a leg up.<a data-primary="JavaScript" data-secondary="differences in practice from Python" data-startref="ix_JSprac" data-type="indexterm" id="idm45607799041952"/><a data-primary="Python" data-secondary="differences in practice from JavaScript" data-startref="ix_Pyprac" data-type="indexterm" id="idm45607799040736"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="A Cheat Sheet" data-type="sect1"><div class="sect1" id="idm45607799550288">
<h1>A Cheat Sheet</h1>
<p>As a handy reference guide, Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="#build_cheat_basic">2-2</a> to <a data-type="xref" data-xrefstyle="select:labelnumber" href="#build_cheat_classes">2-7</a> include a set of cheat sheets to translate basic operations between Python and JavaScript.<a data-primary="Python" data-secondary="translating basic operations between Python and JavaScript, cheat sheet for" data-type="indexterm" id="idm45607799001248"/><a data-primary="JavaScript" data-secondary="translating basic operations between Python and JavaScript, cheat sheet for" data-type="indexterm" id="idm45607799000400"/></p>
<figure><div class="figure" id="build_cheat_basic">
<img alt="dpj2 0202" height="883" src="assets/dpj2_0202.png" width="1444"/>
<h6><span class="label">Figure 2-2. </span>Some basic syntax</h6>
</div></figure>
<figure><div class="figure" id="build_cheat_bools">
<img alt="dpj2 0203" height="345" src="assets/dpj2_0203.png" width="1218"/>
<h6><span class="label">Figure 2-3. </span>Booleans</h6>
</div></figure>
<figure><div class="figure" id="build_cheat_loops">
<img alt="dpj2 0204" height="1119" src="assets/dpj2_0204.png" width="1440"/>
<h6><span class="label">Figure 2-4. </span>Loops and iterations</h6>
</div></figure>
<figure><div class="figure" id="build_cheat_conds">
<img alt="dpj2 0205" height="832" src="assets/dpj2_0205.png" width="1435"/>
<h6><span class="label">Figure 2-5. </span>Conditionals</h6>
</div></figure>
<figure><div class="figure" id="build_cheat_containers">
<img alt="dpj2 0206" height="870" src="assets/dpj2_0206.png" width="1424"/>
<h6><span class="label">Figure 2-6. </span>Containers</h6>
</div></figure>
<figure><div class="figure" id="build_cheat_classes">
<img alt="dpj2 0207" height="720" src="assets/dpj2_0207.png" width="1409"/>
<h6><span class="label">Figure 2-7. </span>Classes and prototypes</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="idm45607798987584">
<h1>Summary</h1>
<p>I hope this chapter has shown that JavaScript and Python have a lot of common syntax and that most common idioms and patterns from one of the languages can be expressed in the other without too much fuss. The meat and potatoes of <span class="keep-together">programming</span>—iteration, conditionals, and basic data manipulation—is simple in both languages, and the translation of functions is straightforward.  If you can program in one to any degree of competency, the threshold to entry for the other is low. That’s the huge appeal of these simple scripting languages, which have a lot of common heritage.</p>
<p>I provided a list of patterns, hacks, and idioms I find myself using frequently in dataviz work. I’m sure this list has its idiosyncrasies, but I’ve tried to tick the obvious boxes.</p>
<p>Treat this as part tutorial, part reference for the chapters to come. Anything not covered here will be dealt with when introduced.</p>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm45607814867312"><sup><a href="ch02.xhtml#idm45607814867312-marker">1</a></sup> One particularly annoying little gotcha is that while Python uses <code>pop</code> to remove a list item, it uses <code>append</code>—not <code>push</code>—to add an item. JavaScript uses <code>push</code> to add an item, whereas <code>append</code> is used to concatenate arrays.</p><p data-type="footnote" id="idm45607814847776"><sup><a href="ch02.xhtml#idm45607814847776-marker">2</a></sup> The ascent of <a href="https://nodejs.org/en">node.js</a> has extended JavaScript to the server.</p><p data-type="footnote" id="idm45607814841712"><sup><a href="ch02.xhtml#idm45607814841712-marker">3</a></sup> This is changing with libraries like <a href="https://oreil.ly/kDw6M">TensorFlow.js</a> and <a href="https://oreil.ly/dJnOl">Danfo.js</a> (a JavaScript pandas-alike based on TensorFlow), but JS is still well behind Python, R, and others.</p><p data-type="footnote" id="idm45607814829968"><sup><a href="ch02.xhtml#idm45607814829968-marker">4</a></sup> At the cost of running a Python interpreter on the server.</p><p data-type="footnote" id="idm45607817504464"><sup><a href="ch02.xhtml#idm45607817504464-marker">5</a></sup> The constraint of having to deliver JS scripts over the web via HTTP is largely responsible for this.</p><p data-type="footnote" id="idm45607819371024"><sup><a href="ch02.xhtml#idm45607819371024-marker">6</a></sup> You can eliminate the possibility of a missing <code>var</code> by using the ECMAScript 5 <code>'use strict'</code> directive.</p><p data-type="footnote" id="idm45607813738384"><sup><a href="ch02.xhtml#idm45607813738384-marker">7</a></sup> This is actually done by JavaScript compressors to reduce the file size of downloaded web pages.</p><p data-type="footnote" id="idm45607813736320"><sup><a href="ch02.xhtml#idm45607813736320-marker">8</a></sup> The soft versus hard tab debate generates controversy, with much heat and little light. PEP-8 stipulates spaces, which is good enough for me.</p><p data-type="footnote" id="idm45607813735088"><sup><a href="ch02.xhtml#idm45607813735088-marker">9</a></sup> It could be two or even three spaces, but this number must be consistent throughout the module.</p><p data-type="footnote" id="idm45607813787904"><sup><a href="ch02.xhtml#idm45607813787904-marker">10</a></sup> The quite fair assumption that JavaScript uses UTF-16 has been the cause of much bug-driven misery. See <a href="https://oreil.ly/9otVB">this blog post by Mathias Bynens</a> for an interesting analysis.</p><p data-type="footnote" id="idm45607813786288"><sup><a href="ch02.xhtml#idm45607813786288-marker">11</a></sup> The change to Unicode strings in Python 3 is a big one. Given the confusion that often attends Unicode de/encoding, it’s worth reading <a href="https://oreil.ly/5FNwi">a little bit about it</a>. Python 2 used strings of bytes.</p><p data-type="footnote" id="idm45607813779728"><sup><a href="ch02.xhtml#idm45607813779728-marker">12</a></sup> <code>parseInt</code> can do quite a bit more than round. For example, <code>parseInt(<em>12.5px</em>)</code> gives 12, first removing the <em><code>px</code></em> and then casting the string to a number. It also has a second <code>radix</code> argument to specify the base of the cast. See <a href="https://oreil.ly/ZtA4n">the Mozilla documentation</a> for the specifics.</p><p data-type="footnote" id="idm45607815619968"><sup><a href="ch02.xhtml#idm45607815619968-marker">13</a></sup> Because all numbers in JavaScript are floating point, it can only support 53-bit integers. Using larger integers (such as the commonly used 64-bit) can result in discontinuous integers. See this <a href="https://oreil.ly/hBxvS">2ality blog post</a> for further information.</p><p data-type="footnote" id="idm45607815328112"><sup><a href="ch02.xhtml#idm45607815328112-marker">14</a></sup> This makes iterating over their properties a little trickier than it might be. See <a href="https://oreil.ly/3kJW3">this Stack Overflow thread</a> for more details.</p><p data-type="footnote" id="idm45607815158832"><sup><a href="ch02.xhtml#idm45607815158832-marker">15</a></sup> For the curious, there’s a nice summation in a <a href="https://oreil.ly/YyUyx">blog post by Angus Croll</a>.</p><p data-type="footnote" id="idm45607802789056"><sup><a href="ch02.xhtml#idm45607802789056-marker">16</a></sup> This is one area where JS beats Python hands-down and which finds many of us wishing for similar functionality in Python.</p><p data-type="footnote" id="idm45607802786192"><sup><a href="ch02.xhtml#idm45607802786192-marker">17</a></sup> Added with  ECMAScript 5 and available on all modern browsers.</p><p data-type="footnote" id="idm45607802261472"><sup><a href="ch02.xhtml#idm45607802261472-marker">18</a></sup> I mentioned to a talented programmer friend that I was faced with the challenge of explaining prototypes to Python programmers, and he pointed out that most JavaScripters could probably do with some pointers too. There’s a lot of truth in this and many JSers do manage to be productive by using prototypes in a <em>classy</em> way, hacking their way around the edge cases.</p><p data-type="footnote" id="idm45607801599376"><sup><a href="ch02.xhtml#idm45607801599376-marker">19</a></sup> This is another reason to use ECMAScript 5’s  <code>'use strict;'</code> injunction, which calls attention to such mistakes.</p><p data-type="footnote" id="idm45607800747696"><sup><a href="ch02.xhtml#idm45607800747696-marker">20</a></sup> My personal choice for performance reasons.</p><p data-type="footnote" id="idm45607799695392"><sup><a href="ch02.xhtml#idm45607799695392-marker">21</a></sup> Don’t Repeat Yourself (DRY) is a solid coding convention.</p><p data-type="footnote" id="idm45607799372592"><sup><a href="ch02.xhtml#idm45607799372592-marker">22</a></sup> Modern JavaScript has proper modules that can import and export encapsulated variables. There is an overhead to using these as they currently require a build phase to make ready for the browser.</p></div></div></section></div></body></html>