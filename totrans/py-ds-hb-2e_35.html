<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 31. Multiple Subplots" data-type="chapter" epub:type="chapter"><div class="chapter" id="section-0408-multiple-subplots">
<h1><span class="label">Chapter 31. </span>Multiple Subplots</h1>
<p><a data-primary="Matplotlib" data-secondary="multiple subplots" data-type="indexterm" id="ix_ch31-asciidoc0"/><a data-primary="plotting" data-secondary="multiple subplots" data-type="indexterm" id="ix_ch31-asciidoc1"/><a data-primary="subplots" data-secondary="multiple" data-type="indexterm" id="ix_ch31-asciidoc2"/>Sometimes it is helpful to compare different views of data side by side.
To this end, Matplotlib has the concept of <em>subplots</em>: groups of smaller
axes that can exist together within a single figure. These subplots
might be insets, grids of plots, or other more complicated layouts. In
this chapter we’ll explore four routines for creating
subplots in Matplotlib. We’ll start by importing the
packages we will use:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="k">matplotlib</code> inline
        <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-white'</code><code class="p">)</code>
        <code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code></pre>
<section data-pdf-bookmark="plt.axes: Subplots by Hand" data-type="sect1"><div class="sect1" id="ch_0408-multiple-subplots_plt.axes-subplots-by-hand">
<h1>plt.axes: Subplots by Hand</h1>
<p><a data-primary="plt.axes() function" data-type="indexterm" id="ix_ch31-asciidoc3"/><a data-primary="subplots" data-secondary="manual customization" data-type="indexterm" id="ix_ch31-asciidoc4"/><a data-primary="subplots" data-secondary="plt.axes() for" data-type="indexterm" id="ix_ch31-asciidoc5"/>The most basic method of creating an axes is to use the <code>plt.axes</code>
function. As we’ve seen previously, by default this creates
a standard axes object that fills the entire figure. <code>plt.axes</code> also
takes an optional argument that is a list of four numbers in the figure
coordinate system (<code>[<em>left</em>, <em>bottom</em>, <em>width</em>, <em>height</em>]</code>), which ranges from 0
at the bottom left of the figure to 1 at the top right of the figure.</p>
<p>For example, we might create an inset axes at the top-right corner of
another axes by setting the <em>x</em> and <em>y</em> position to 0.65 (that is,
starting at 65% of the width and 65% of the height of the figure) and
the <em>x</em> and <em>y</em> extents to 0.2 (that is, the size of the axes is 20% of
the width and 20% of the height of the figure).
<a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_4_0">Figure 31-1</a> shows the result:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">ax1</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">()</code>  <code class="c1"># standard axes</code>
        <code class="n">ax2</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">axes</code><code class="p">([</code><code class="mf">0.65</code><code class="p">,</code> <code class="mf">0.65</code><code class="p">,</code> <code class="mf">0.2</code><code class="p">,</code> <code class="mf">0.2</code><code class="p">])</code></pre>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_4_0">
<img alt="output 4 0" height="194" src="assets/output_4_0.png" width="600"/>
<h6><span class="label">Figure 31-1. </span>Example of an inset axes</h6>
</div></figure>
<p>The equivalent of this command within the object-oriented interface is
<code>fig.add_axes</code>. Let’s use this to create two vertically
stacked axes, as seen in <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_6_0">Figure 31-2</a>.</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
        <code class="n">ax1</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_axes</code><code class="p">([</code><code class="mf">0.1</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.8</code><code class="p">,</code> <code class="mf">0.4</code><code class="p">],</code>
                           <code class="n">xticklabels</code><code class="o">=</code><code class="p">[],</code> <code class="n">ylim</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mf">1.2</code><code class="p">,</code> <code class="mf">1.2</code><code class="p">))</code>
        <code class="n">ax2</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_axes</code><code class="p">([</code><code class="mf">0.1</code><code class="p">,</code> <code class="mf">0.1</code><code class="p">,</code> <code class="mf">0.8</code><code class="p">,</code> <code class="mf">0.4</code><code class="p">],</code>
                           <code class="n">ylim</code><code class="o">=</code><code class="p">(</code><code class="o">-</code><code class="mf">1.2</code><code class="p">,</code> <code class="mf">1.2</code><code class="p">))</code>

        <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">)</code>
        <code class="n">ax1</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
        <code class="n">ax2</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>
<p>We now have two axes (the top with no tick labels) that are just
touching: the bottom of the upper panel (at position 0.5) matches the
top of the lower panel (at position 
<span class="keep-together">0.1 + 0.4</span>).<a data-startref="ix_ch31-asciidoc5" data-type="indexterm" id="idm45858756576592"/><a data-startref="ix_ch31-asciidoc4" data-type="indexterm" id="idm45858756422064"/><a data-startref="ix_ch31-asciidoc3" data-type="indexterm" id="idm45858756421392"/></p>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_6_0">
<img alt="output 6 0" height="383" src="assets/output_6_0.png" width="600"/>
<h6><span class="label">Figure 31-2. </span>Vertically stacked axes example</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="plt.subplot: Simple Grids of Subplots" data-type="sect1"><div class="sect1" id="ch_0408-multiple-subplots_plt.subplot-simple-grids-of-subplots">
<h1>plt.subplot: Simple Grids of Subplots</h1>
<p><a data-primary="plt.subplot() function" data-type="indexterm" id="ix_ch31-asciidoc6"/><a data-primary="subplots" data-secondary="plt.subplot() for" data-type="indexterm" id="ix_ch31-asciidoc7"/>Aligned columns or rows of subplots are a common enough need that
Matplotlib has several convenience routines that make them easy to
create. The lowest level of these is <code>plt.subplot</code>, which creates a
single subplot within a grid. As you can see, this command takes three
integer arguments—the number of rows, the number of columns, and the
index of the plot to be created in this scheme, which runs from the
upper left to the bottom right (see <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_9_0">Figure 31-3</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">7</code><code class="p">):</code>
            <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)</code>
            <code class="n">plt</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="nb">str</code><code class="p">((</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)),</code>
                     <code class="n">fontsize</code><code class="o">=</code><code class="mi">18</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">)</code></pre>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_9_0">
<img alt="output 9 0" height="398" src="assets/output_9_0.png" width="600"/>
<h6><span class="label">Figure 31-3. </span>A plt.subplot example</h6>
</div></figure>
<p>The command <code>plt.subplots_adjust</code> can be used to adjust the spacing
between these plots. The following code uses the equivalent
object-oriented command, <code>fig.add_subplot</code>; <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_11_0">Figure 31-4</a> shows
the result:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
        <code class="n">fig</code><code class="o">.</code><code class="n">subplots_adjust</code><code class="p">(</code><code class="n">hspace</code><code class="o">=</code><code class="mf">0.4</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mf">0.4</code><code class="p">)</code>
        <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">7</code><code class="p">):</code>
            <code class="n">ax</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)</code>
            <code class="n">ax</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="nb">str</code><code class="p">((</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">i</code><code class="p">)),</code>
                   <code class="n">fontsize</code><code class="o">=</code><code class="mi">18</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">)</code></pre>
<p>Here we’ve used the <code>hspace</code> and <code>wspace</code> arguments of
<code>plt.subplots_adjust</code>, which specify the spacing along the height and
width of the figure, in units of the subplot size (in this case, the
space is 40% of the subplot width and height).<a data-startref="ix_ch31-asciidoc7" data-type="indexterm" id="idm45858756293856"/><a data-startref="ix_ch31-asciidoc6" data-type="indexterm" id="idm45858756293264"/></p>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_11_0">
<img alt="output 11 0" height="200" src="assets/output_11_0.png" width="600"/>
<h6><span class="label">Figure 31-4. </span>plt.subplot with adjusted margins</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="plt.subplots: The Whole Grid in One Go" data-type="sect1"><div class="sect1" id="ch_0408-multiple-subplots_plt.subplots-the-whole-grid-in-one-go">
<h1>plt.subplots: The Whole Grid in One Go</h1>
<p><a data-primary="plt.subplots() function" data-type="indexterm" id="ix_ch31-asciidoc8"/><a data-primary="subplots" data-secondary="plt.subplots() for" data-type="indexterm" id="ix_ch31-asciidoc9"/>The approach just described quickly becomes tedious when creating a
large grid of subplots, especially if you’d like to hide the
x- and y-axis labels on the inner plots. For this purpose,
<code>plt.subplots</code> is the easier tool to use (note the <code>s</code> at the end of

<span class="keep-together"><code>subplots</code></span>). Rather than creating a single subplot, this function
creates a full grid of subplots in a single line, returning them in a
NumPy array. The arguments are the number of rows and number of columns,
along with optional keywords <code>sharex</code> and <code>sharey</code>, which allow you to
specify the relationships between different axes.</p>
<p>Let’s create a <math alttext="2 times 3">
<mrow>
<mn>2</mn>
<mo>×</mo>
<mn>3</mn>
</mrow>
</math> grid of subplots,
where all axes in the same row share their y-axis scale, and all axes in
the same column share their x-axis scale (see <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_14_0">Figure 31-5</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">sharex</code><code class="o">=</code><code class="s1">'col'</code><code class="p">,</code> <code class="n">sharey</code><code class="o">=</code><code class="s1">'row'</code><code class="p">)</code></pre>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_14_0">
<img alt="output 14 0" height="395" src="assets/output_14_0.png" width="600"/>
<h6><span class="label">Figure 31-5. </span>Shared x and y axes in plt.subplots</h6>
</div></figure>
<p>By specifying <code>sharex</code> and <code>sharey</code>, we’ve automatically
removed inner labels on the grid to make the plot cleaner. The resulting
grid of axes instances is returned within a NumPy array, allowing for
convenient specification of the desired axes using standard array
indexing notation (see <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_16_0">Figure 31-6</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="c1"># axes are in a two-dimensional array, indexed by [row, col]</code>
        <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">2</code><code class="p">):</code>
            <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="mi">3</code><code class="p">):</code>
                <code class="n">ax</code><code class="p">[</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">]</code><code class="o">.</code><code class="n">text</code><code class="p">(</code><code class="mf">0.5</code><code class="p">,</code> <code class="mf">0.5</code><code class="p">,</code> <code class="nb">str</code><code class="p">((</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">)),</code>
                              <code class="n">fontsize</code><code class="o">=</code><code class="mi">18</code><code class="p">,</code> <code class="n">ha</code><code class="o">=</code><code class="s1">'center'</code><code class="p">)</code>
        <code class="n">fig</code></pre>
<p>In comparison to <code>plt.subplot</code>, <code>plt.subplots</code> is more consistent with
Python’s conventional zero-based indexing, whereas
<code>plt.subplot</code> uses MATLAB-style one-based indexing.<a data-startref="ix_ch31-asciidoc9" data-type="indexterm" id="idm45858756129072"/><a data-startref="ix_ch31-asciidoc8" data-type="indexterm" id="idm45858756128368"/></p>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_16_0">
<img alt="output 16 0" height="398" src="assets/output_16_0.png" width="600"/>
<h6><span class="label">Figure 31-6. </span>Identifying plots in a subplot grid</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="plt.GridSpec: More Complicated Arrangements" data-type="sect1"><div class="sect1" id="ch_0408-multiple-subplots_plt.gridspec-more-complicated-arrangements">
<h1>plt.GridSpec: More Complicated Arrangements</h1>
<p><a data-primary="plt.GridSpec() function" data-type="indexterm" id="ix_ch31-asciidoc10"/><a data-primary="subplots" data-secondary="plt.GridSpec() for" data-type="indexterm" id="ix_ch31-asciidoc11"/>To go beyond a regular grid to subplots that span multiple rows and
columns, <code>plt.GridSpec</code> is the best tool. <code>plt.GridSpec</code> does not create
a plot by itself; it is rather a convenient interface that is recognized
by the <code>plt.subplot</code> command. For example, a <code>GridSpec</code> for a grid of
two rows and three columns with some specified width and height space
looks like this:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">grid</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">GridSpec</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mf">0.4</code><code class="p">,</code> <code class="n">hspace</code><code class="o">=</code><code class="mf">0.3</code><code class="p">)</code></pre>
<p>From this we can specify subplot locations and extents using the
familiar Python slicing syntax (see <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_21_0">Figure 31-7</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">])</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">:])</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="p">:</code><code class="mi">2</code><code class="p">])</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]);</code></pre>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_21_0">
<img alt="output 21 0" height="392" src="assets/output_21_0.png" width="600"/>
<h6><span class="label">Figure 31-7. </span>Irregular subplots with <code>plt.GridSpec</code></h6>
</div></figure>
<p>This type of flexible grid alignment has a wide range of uses. I most
often use it when creating multiaxes histogram plots like the ones shown
in <a data-type="xref" href="#fig_0408-multiple-subplots_files_in_output_23_0">Figure 31-8</a>.</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="c1"># Create some normally distributed data</code>
         <code class="n">mean</code> <code class="o">=</code> <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code>
         <code class="n">cov</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">]]</code>
         <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">default_rng</code><code class="p">(</code><code class="mi">1701</code><code class="p">)</code>
         <code class="n">x</code><code class="p">,</code> <code class="n">y</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">multivariate_normal</code><code class="p">(</code><code class="n">mean</code><code class="p">,</code> <code class="n">cov</code><code class="p">,</code> <code class="mi">3000</code><code class="p">)</code><code class="o">.</code><code class="n">T</code>

         <code class="c1"># Set up the axes with GridSpec</code>
         <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">(</code><code class="n">figsize</code><code class="o">=</code><code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">6</code><code class="p">))</code>
         <code class="n">grid</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">GridSpec</code><code class="p">(</code><code class="mi">4</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="n">hspace</code><code class="o">=</code><code class="mf">0.2</code><code class="p">,</code> <code class="n">wspace</code><code class="o">=</code><code class="mf">0.2</code><code class="p">)</code>
         <code class="n">main_ax</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[:</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">:])</code>
         <code class="n">y_hist</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[:</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code> <code class="n">xticklabels</code><code class="o">=</code><code class="p">[],</code> <code class="n">sharey</code><code class="o">=</code><code class="n">main_ax</code><code class="p">)</code>
         <code class="n">x_hist</code> <code class="o">=</code> <code class="n">fig</code><code class="o">.</code><code class="n">add_subplot</code><code class="p">(</code><code class="n">grid</code><code class="p">[</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">:],</code> <code class="n">yticklabels</code><code class="o">=</code><code class="p">[],</code> <code class="n">sharex</code><code class="o">=</code><code class="n">main_ax</code><code class="p">)</code>

         <code class="c1"># Scatter points on the main axes</code>
         <code class="n">main_ax</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'ok'</code><code class="p">,</code> <code class="n">markersize</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.2</code><code class="p">)</code>

         <code class="c1"># Histogram on the attached axes</code>
         <code class="n">x_hist</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="mi">40</code><code class="p">,</code> <code class="n">histtype</code><code class="o">=</code><code class="s1">'stepfilled'</code><code class="p">,</code>
                     <code class="n">orientation</code><code class="o">=</code><code class="s1">'vertical'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
         <code class="n">x_hist</code><code class="o">.</code><code class="n">invert_yaxis</code><code class="p">()</code>

         <code class="n">y_hist</code><code class="o">.</code><code class="n">hist</code><code class="p">(</code><code class="n">y</code><code class="p">,</code> <code class="mi">40</code><code class="p">,</code> <code class="n">histtype</code><code class="o">=</code><code class="s1">'stepfilled'</code><code class="p">,</code>
                     <code class="n">orientation</code><code class="o">=</code><code class="s1">'horizontal'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
         <code class="n">y_hist</code><code class="o">.</code><code class="n">invert_xaxis</code><code class="p">()</code></pre>
<figure><div class="figure" id="fig_0408-multiple-subplots_files_in_output_23_0">
<img alt="output 23 0" height="398" src="assets/output_23_0.png" width="600"/>
<h6><span class="label">Figure 31-8. </span>Visualizing multidimensional distributions with <code>plt.GridSpec</code></h6>
</div></figure>
<p>This type of distribution plotted alongside its margins is common enough
that it has its own plotting API in the Seaborn package; see
<a data-type="xref" href="ch36.xhtml#section-0414-visualization-with-seaborn">Chapter 36</a>
for more details<a data-startref="ix_ch31-asciidoc11" data-type="indexterm" id="idm45858755710000"/><a data-startref="ix_ch31-asciidoc10" data-type="indexterm" id="idm45858755709296"/>.<a data-startref="ix_ch31-asciidoc2" data-type="indexterm" id="idm45858755708496"/><a data-startref="ix_ch31-asciidoc1" data-type="indexterm" id="idm45858755707792"/><a data-startref="ix_ch31-asciidoc0" data-type="indexterm" id="idm45858755707120"/></p>
</div></section>
</div></section></div></body></html>