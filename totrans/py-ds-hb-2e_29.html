<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 25. General Matplotlib Tips" data-type="chapter" epub:type="chapter"><div class="chapter" id="idm45858763407696">
<h1><span class="label">Chapter 25. </span>General Matplotlib Tips</h1>
<p><a data-primary="Matplotlib" data-secondary="general tips" data-type="indexterm" id="ix_ch25-asciidoc0"/>Before we dive into the details of creating visualizations with
Matplotlib, there are a few useful things you should know about using
the package.</p>
<section data-pdf-bookmark="Importing Matplotlib" data-type="sect1"><div class="sect1" id="ch_0400-introduction-to-matplotlib_importing-matplotlib">
<h1>Importing Matplotlib</h1>
<p><a data-primary="Matplotlib" data-secondary="importing" data-type="indexterm" id="idm45858763403392"/>Just as we use the <code>np</code> shorthand for NumPy and the <code>pd</code> shorthand for
Pandas, we will use some standard shorthands for Matplotlib imports:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib</code> <code class="k">as</code> <code class="nn">mpl</code>
        <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code></pre>
<p>The <code>plt</code> interface is what we will use most often, as you shall see
throughout this part of the book.</p>
</div></section>
<section data-pdf-bookmark="Setting Styles" data-type="sect1"><div class="sect1" id="ch_0400-introduction-to-matplotlib_setting-styles">
<h1>Setting Styles</h1>
<p><a data-primary="Matplotlib" data-secondary="setting styles" data-type="indexterm" id="idm45858763385392"/>We will use the <code>plt.style</code> directive to choose appropriate aesthetic
styles for our figures. Here we will set the <code>classic</code> style, which
ensures that the plots we create use the classic Matplotlib style:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'classic'</code><code class="p">)</code></pre>
<p>Throughout this chapter, we will adjust this style as needed. For more
information on stylesheets, see
<a data-type="xref" href="ch34.xhtml#section-0411-settings-and-stylesheets">Chapter 34</a>.</p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="show or No show? How to Display Your Plots" data-type="sect1"><div class="sect1" id="ch_0400-introduction-to-matplotlib_show-or-no-show-how-to-display-your-plots">
<h1>show or No show? How to Display Your Plots</h1>
<p><a data-primary="Matplotlib" data-secondary="plot display contexts" data-type="indexterm" id="ix_ch25-asciidoc1"/><a data-primary="plotting" data-secondary="display contexts" data-type="indexterm" id="ix_ch25-asciidoc2"/>A visualization you can’t see won’t be of much
use, but just how you view your Matplotlib plots depends on the context.
The best use of Matplotlib differs depending on how you are using it;
roughly, the three applicable contexts are using Matplotlib in a script,
in an IPython terminal, or in a Jupyter notebook.</p>
<section data-pdf-bookmark="Plotting from a Script" data-type="sect2"><div class="sect2" id="ch_0400-introduction-to-matplotlib_plotting-from-a-script">
<h2>Plotting from a Script</h2>
<p><a data-primary="Matplotlib" data-secondary="plotting from a script" data-type="indexterm" id="idm45858763331792"/><a data-primary="plotting" data-secondary="from script" data-secondary-sortas="script" data-type="indexterm" id="idm45858763330816"/><a data-primary="script" data-secondary="plotting from" data-type="indexterm" id="idm45858763329600"/>If you are using Matplotlib from within a script, the function
<code>plt.show</code> is your friend. <code>plt.show</code> starts an event loop, looks for
all currently active <code>Figure</code> objects, and opens one or more interactive
windows that display your figure or figures.</p>
<p>So, for example, you may have a file called <em>myplot.py</em> containing the
following:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># file: myplot.py</code>
<code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>
<code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>

<code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">100</code><code class="p">)</code>

<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
<code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>

<code class="n">plt</code><code class="o">.</code><code class="n">show</code><code class="p">()</code></pre>
<p>You can then run this script from the command-line prompt, which will
result in a window opening with your figure displayed:</p>
<pre data-type="programlisting">
$ <strong>python myplot.py</strong>
</pre>
<p>The <code>plt.show</code> command does a lot under the hood, as it must interact
with your system’s interactive graphical backend. The
details of this operation can vary greatly from system to system and
even installation to installation, but Matplotlib does its best to hide
all these details from you.</p>
<p>One thing to be aware of: the <code>plt.show</code> command should be used <em>only
once</em> per Python session, and is most often seen at the very end of the
script. Multiple <code>show</code> commands can lead to unpredictable
backend-dependent behavior, and should mostly be avoided.</p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Plotting from an IPython Shell" data-type="sect2"><div class="sect2" id="ch_0400-introduction-to-matplotlib_plotting-from-an-ipython-shell">
<h2>Plotting from an IPython Shell</h2>
<p><a data-primary="IPython" data-secondary="plotting from shell" data-type="indexterm" id="idm45858763225200"/><a data-primary="Matplotlib" data-secondary="plotting from IPython shell" data-type="indexterm" id="idm45858763224000"/><a data-primary="plotting" data-secondary="from an IPython shell" data-secondary-sortas="IPython shell" data-type="indexterm" id="idm45858763223088"/>Matplotlib also works seamlessly within an IPython shell (see
<a data-type="xref" href="part01.xhtml#section-0100-ipython-beyond-normal-python">Part I</a>). IPython is built to work well with Matplotlib if you specify
Matplotlib mode. <a data-primary="%matplotlib" data-primary-sortas="matplotlib" data-type="indexterm" id="idm45858763220976"/>To enable this mode, you can use the <code>%matplotlib</code>
magic command after starting <code>ipython</code>:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="k">matplotlib</code>
<code class="n">Using</code> <code class="n">matplotlib</code> <code class="n">backend</code><code class="p">:</code> <code class="n">TkAgg</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code></pre>
<p>At this point, any <code>plt</code> plot command will cause a figure window to
open, and further commands can be run to update the plot. Some changes
(such as modifying properties of lines that are already drawn) will not
draw automatically: to force an update, use <code>plt.draw</code>. Using <code>plt.show</code>
in IPython’s Matplotlib mode is not required.</p>
</div></section>
<section data-pdf-bookmark="Plotting from a Jupyter Notebook" data-type="sect2"><div class="sect2" id="ch_0400-introduction-to-matplotlib_plotting-from-a-jupyter-notebook">
<h2>Plotting from a Jupyter Notebook</h2>
<p><a data-primary="Jupyter notebook" data-secondary="plotting from" data-type="indexterm" id="idm45858763171360"/><a data-primary="Matplotlib" data-secondary="plotting from IPython notebook" data-type="indexterm" id="idm45858763170384"/><a data-primary="plotting" data-secondary="IPython notebook" data-type="indexterm" id="idm45858763169472"/>The Jupyter notebook is a browser-based interactive data analysis tool
that can combine narrative, code, graphics, HTML elements, and much more
into a single executable document (see
<a data-type="xref" href="part01.xhtml#section-0100-ipython-beyond-normal-python">Part I</a>).</p>
<p>Plotting interactively within a Jupyter notebook can be done with the
<code>%matplotlib</code> command, and works in a similar way to the IPython shell.
You also have the option of embedding graphics directly in the notebook,
with two possible options:</p>
<ul>
<li>
<p><code>%matplotlib inline</code> will lead to <em>static</em> images of your plot
embedded in the notebook.</p>
</li>
<li>
<p><code>%matplotlib notebook</code> will lead to <em>interactive</em> plots embedded
within the notebook.</p>
</li>
</ul>
<p>For this book, we will generally stick with the default, with figures
rendered as static images (see <a data-type="xref" href="#fig_0400-introduction-to-matplotlib_files_in_output_15_0">Figure 25-1</a> for the result of
this basic plotting example):</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="o">%</code><code class="k">matplotlib</code> inline</pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>
        <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">100</code><code class="p">)</code>

        <code class="n">fig</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'-'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">),</code> <code class="s1">'--'</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0400-introduction-to-matplotlib_files_in_output_15_0">
<img alt="output 15 0" height="401" src="assets/output_15_0.png" width="600"/>
<h6><span class="label">Figure 25-1. </span>Basic plotting example</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="Saving Figures to File" data-type="sect2"><div class="sect2" id="ch_0400-introduction-to-matplotlib_saving-figures-to-file">
<h2>Saving Figures to File</h2>
<p><a data-primary="Matplotlib" data-secondary="saving figures to file" data-type="indexterm" id="idm45858763047840"/>One nice feature of Matplotlib is the ability to save figures in a wide
variety of formats. Saving a figure can be done using the <code>savefig</code>
command. For example, to save the previous figure as a PNG file, we can
run this:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">fig</code><code class="o">.</code><code class="n">savefig</code><code class="p">(</code><code class="s1">'my_figure.png'</code><code class="p">)</code></pre>
<p>We now have a file called <em>my_figure.png</em> in the current working
directory:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="o">!</code>ls -lh my_figure.png
<code class="n">Out</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="o">-</code><code class="n">rw</code><code class="o">-</code><code class="n">r</code><code class="o">--</code><code class="n">r</code><code class="o">--</code>  <code class="mi">1</code> <code class="n">jakevdp</code>  <code class="n">staff</code>    <code class="mi">26</code><code class="n">K</code> <code class="n">Feb</code>  <code class="mi">1</code> <code class="mi">06</code><code class="p">:</code><code class="mi">15</code> <code class="n">my_figure</code><code class="o">.</code><code class="n">png</code></pre>
<p>To confirm that it contains what we think it contains, let’s
use the IPython <code>Image</code> object to display the contents of this file (see
<a data-type="xref" href="#fig_0400-introduction-to-matplotlib_files_in_output_21_0">Figure 25-2</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">IPython.display</code> <code class="kn">import</code> <code class="n">Image</code>
        <code class="n">Image</code><code class="p">(</code><code class="s1">'my_figure.png'</code><code class="p">)</code></pre>
<figure><div class="figure" id="fig_0400-introduction-to-matplotlib_files_in_output_21_0">
<img alt="output 21 0" height="392" src="assets/output_21_0.png" width="600"/>
<h6><span class="label">Figure 25-2. </span>PNG rendering of the basic plot</h6>
</div></figure>
<p>In <code>savefig</code>, the file format is inferred from the extension of the
given filename. Depending on what backends you have installed, many
different file formats are available. The list of supported file types
can be found for your system by using the following method of the figure
canvas object:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">fig</code><code class="o">.</code><code class="n">canvas</code><code class="o">.</code><code class="n">get_supported_filetypes</code><code class="p">()</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="p">{</code><code class="s1">'eps'</code><code class="p">:</code> <code class="s1">'Encapsulated Postscript'</code><code class="p">,</code>
         <code class="s1">'jpg'</code><code class="p">:</code> <code class="s1">'Joint Photographic Experts Group'</code><code class="p">,</code>
         <code class="s1">'jpeg'</code><code class="p">:</code> <code class="s1">'Joint Photographic Experts Group'</code><code class="p">,</code>
         <code class="s1">'pdf'</code><code class="p">:</code> <code class="s1">'Portable Document Format'</code><code class="p">,</code>
         <code class="s1">'pgf'</code><code class="p">:</code> <code class="s1">'PGF code for LaTeX'</code><code class="p">,</code>
         <code class="s1">'png'</code><code class="p">:</code> <code class="s1">'Portable Network Graphics'</code><code class="p">,</code>
         <code class="s1">'ps'</code><code class="p">:</code> <code class="s1">'Postscript'</code><code class="p">,</code>
         <code class="s1">'raw'</code><code class="p">:</code> <code class="s1">'Raw RGBA bitmap'</code><code class="p">,</code>
         <code class="s1">'rgba'</code><code class="p">:</code> <code class="s1">'Raw RGBA bitmap'</code><code class="p">,</code>
         <code class="s1">'svg'</code><code class="p">:</code> <code class="s1">'Scalable Vector Graphics'</code><code class="p">,</code>
         <code class="s1">'svgz'</code><code class="p">:</code> <code class="s1">'Scalable Vector Graphics'</code><code class="p">,</code>
         <code class="s1">'tif'</code><code class="p">:</code> <code class="s1">'Tagged Image File Format'</code><code class="p">,</code>
         <code class="s1">'tiff'</code><code class="p">:</code> <code class="s1">'Tagged Image File Format'</code><code class="p">}</code></pre>
<p>Note that when saving your figure, it is not necessary to use <code>plt.show</code>
or related commands discussed earlier.</p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Two Interfaces for the Price of One" data-type="sect2"><div class="sect2" id="ch_0400-introduction-to-matplotlib_two-interfaces-for-the-price-of-one">
<h2>Two Interfaces for the Price of One</h2>
<p><a data-primary="Matplotlib" data-secondary="interfaces" data-type="indexterm" id="ix_ch25-asciidoc3"/>A potentially confusing feature of Matplotlib is its dual interfaces: a
convenient MATLAB-style state-based interface, and a more powerful
object-oriented interface. I’ll quickly highlight the
differences between the two here.</p>
<section data-pdf-bookmark="MATLAB-style Interface" data-type="sect3"><div class="sect3" id="ch_0400-introduction-to-matplotlib_matlab-style-interface">
<h3>MATLAB-style Interface</h3>
<p><a data-primary="MATLAB-style interface" data-type="indexterm" id="idm45858762881280"/><a data-primary="Matplotlib" data-secondary="MATLAB-style interfaces" data-type="indexterm" id="idm45858762880576"/>Matplotlib was originally conceived as a Python alternative for MATLAB
users, and much of its syntax reflects that fact. The MATLAB-style tools
are contained in the <code>pyplot</code> (<code>plt</code>) interface. For example, the
following code will probably look quite familiar to MATLAB users (<a data-type="xref" href="#fig_0400-introduction-to-matplotlib_files_in_output_27_0">Figure 25-3</a> shows the result).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">figure</code><code class="p">()</code>  <code class="c1"># create a plot figure</code>

        <code class="c1"># create the first of two panels and set current axis</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">)</code> <code class="c1"># (rows, columns, panel number)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>

        <code class="c1"># create the second panel and set current axis</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">subplot</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>
<figure><div class="figure" id="fig_0400-introduction-to-matplotlib_files_in_output_27_0">
<img alt="output 27 0" height="383" src="assets/output_27_0.png" width="600"/>
<h6><span class="label">Figure 25-3. </span>Subplots using the MATLAB-style interface</h6>
</div></figure>
<p>It is important to recognize that this interface is <em>stateful</em>: it keeps
track of the “current” figure and axes, which are where all <code>plt</code>
commands are applied. You can get a reference to these using the
<code>plt.gcf</code> (get current figure) and <code>plt.gca</code> (get current axes)
routines.</p>
<p>While this stateful interface is fast and convenient for simple plots,
it is easy to run into problems. For example, once the second panel is
created, how can we go back and add something to the first? This is
possible within the MATLAB-style interface, but a bit clunky.
Fortunately, there is a better way.</p>
</div></section>
<section data-pdf-bookmark="Object-oriented interface" data-type="sect3"><div class="sect3" id="ch_0400-introduction-to-matplotlib_object-oriented-interface">
<h3>Object-oriented interface</h3>
<p><a data-primary="Matplotlib" data-secondary="object-oriented interfaces" data-type="indexterm" id="idm45858762701360"/><a data-primary="object-oriented interface" data-type="indexterm" id="idm45858762700192"/>The object-oriented interface is available for these more complicated
situations, and for when you want more control over your figure. Rather
than depending on some notion of an “active” figure or axes, in the
object-oriented interface the plotting functions are <em>methods</em> of
explicit <code>Figure</code> and <code>Axes</code> objects. To re-create the previous plot
using this style of plotting, as shown in <a data-type="xref" href="#fig_0400-introduction-to-matplotlib_files_in_output_30_0">Figure 25-4</a>, you
might do the following:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="c1"># First create a grid of plots</code>
         <code class="c1"># ax will be an array of two Axes objects</code>
         <code class="n">fig</code><code class="p">,</code> <code class="n">ax</code> <code class="o">=</code> <code class="n">plt</code><code class="o">.</code><code class="n">subplots</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code>

         <code class="c1"># Call plot() method on the appropriate object</code>
         <code class="n">ax</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">))</code>
         <code class="n">ax</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">np</code><code class="o">.</code><code class="n">cos</code><code class="p">(</code><code class="n">x</code><code class="p">));</code></pre>
<figure><div class="figure" id="fig_0400-introduction-to-matplotlib_files_in_output_30_0">
<img alt="output 30 0" height="377" src="assets/output_30_0.png" width="600"/>
<h6><span class="label">Figure 25-4. </span>Subplots using the object-oriented interface</h6>
</div></figure>
<p>For simpler plots, the choice of which style to use is largely a matter
of preference, but the object-oriented approach can become a necessity
as plots become more complicated. Throughout the following chapters, we
will switch between the MATLAB-style and object-oriented interfaces,
depending on what is most convenient. In most cases, the difference is
as small as switching <code>plt.plot</code> to <code>ax.plot</code>, but there are a few
gotchas that I will highlight as they come up in the following<a data-startref="ix_ch25-asciidoc3" data-type="indexterm" id="idm45858762616992"/> chapters<a data-startref="ix_ch25-asciidoc2" data-type="indexterm" id="idm45858762616160"/><a data-startref="ix_ch25-asciidoc1" data-type="indexterm" id="idm45858762615456"/>.<a data-startref="ix_ch25-asciidoc0" data-type="indexterm" id="idm45858762614656"/></p>
</div></section>
</div></section>
</div></section>
</div></section></div></body></html>