<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Preface" data-type="preface" epub:type="preface"><div class="preface" id="idm45607823164976">
<h1>Preface</h1>
<p>The chief ambition of this book is to describe a data visualization (dataviz) toolchain that, in the era of the internet, is starting to predominate.<a data-primary="dataviz" data-type="indexterm" id="idm45607823288832"/> The guiding principle of this toolchain is that whatever insightful nuggets you have managed to mine from your data deserve a home on the web browser. Being on the web means you can easily choose to distribute your dataviz to a select few (using authentication or restricting to a local network) or the whole world. This is the big idea of the internet and one that dataviz is embracing at a rapid pace. And that means that the future of dataviz involves JavaScript, the only first-class language of the web browser. <a data-primary="JavaScript" data-secondary="raw data and" data-type="indexterm" id="idm45607825526976"/>But JavaScript does not yet have the data-processing stack needed to refine raw data, which means data visualization is inevitably a multilanguage affair. I hope this book provides support for my belief that Python is the natural complementary language to JavaScript’s monopoly of browser visualizations.<a data-primary="data visualization" data-see="dataviz" data-type="indexterm" id="idm45607823975920"/></p>
<p>Although this book is a big one (that fact is felt most keenly by the author right now), it has had to be very selective, leaving out a lot of really cool Python and JavaScript dataviz tools and focusing on the ones that provide the best building blocks. The number of helpful libraries I couldn’t cover reflects the enormous vitality of the Python and JavaScript data science ecosystems. Even while the book was being written, brilliant new Python and JavaScript libraries were being introduced, and the pace continues.<a data-primary="Python" data-type="indexterm" id="idm45607826946240"/><a data-primary="JavaScript" data-type="indexterm" id="idm45607823161632"/></p>
<p>All data visualization is essentially transformative, and showing the journey from one reflection of a dataset (HTML tables and lists) to a more modern, engaging, interactive, and, fundamentally, browser-based one provides a good way to introduce key data visualization tools in a working context. The challenge is to transform a basic Wikipedia list of Nobel Prize winners into a modern, interactive, browser-based visualization. Thus, the same dataset is presented in a more accessible, engaging form.</p>
<p>The journey from unprocessed data to a fairly rich, user-driven visualization informs the choice of best-of-breed tools. First, we need to get our dataset. Often this is provided by a colleague or client, but to increase the challenge and learn some pretty vital dataviz skills along the way, we learn how to <em>scrape</em> the dataset from the web (Wikipedia’s Nobel Prize pages) using Python’s powerful Scrapy library. This unprocessed dataset then needs to be refined and explored, and there isn’t a much better ecosystem for this than Python’s pandas. <a data-primary="Matplotlib" data-type="indexterm" id="idm45607823130576"/><a data-primary="Jupyter notebooks" data-type="indexterm" id="idm45607823156448"/><a data-primary="pandas" data-type="indexterm" id="idm45607823129744"/>Along with Matplotlib in support and driven by a Jupyter notebook, pandas is becoming the gold standard for this kind of forensic data work.  With clean data stored (to SQL with SQLAlchemy and SQLLite) and explored, the cherry-picked data stories can be visualized. <a data-primary="SQL" data-secondary="SQLAlchemy and SQLite" data-type="indexterm" id="idm45607823209376"/>I cover the use of Matplotlib and Plotly to embed static and dynamic charts from Python to a web page. But for something  more ambitious, the supreme dataviz library for the web is the JavaScript-based D3.<a data-primary="JavaScript" data-secondary="JavaScript-based D3 library" data-type="indexterm" id="idm45607813294016"/><a data-primary="D3 library" data-type="indexterm" id="idm45607825876352"/> We cover the essentials of D3 while using them to produce our showpiece Nobel data visualization.</p>
<p>This book is a collection of tools forming a chain, with the creation of the Nobel visualization providing a guiding narrative. You should be able to dip into relevant chapters when and if the need arises; the different parts of the book are self-contained so you can quickly review what you’ve learned when required.</p>
<p>This book is divided into five parts. The first part introduces a basic Python and JavaScript dataviz toolkit, while the next four show how to retrieve raw data, clean it, explore it, and finally transform it into a modern web visualization. Let’s summarize the key lessons of each part now.</p>
<section data-pdf-bookmark="Part I: Basic Toolkit" data-type="sect2"><div class="sect2" id="idm45607823131600">
<h2>Part I: Basic Toolkit</h2>
<p>Our basic toolkit consists of:</p>
<ul>
<li>
<p>A language-learning bridge between Python and JavaScript.<a data-primary="dataviz" data-secondary="basic toolkit" data-type="indexterm" id="idm45607823192416"/> This is designed to smooth the transition between the two languages, highlighting their many similarities and setting the scene for the bilingual process of modern dataviz. With the advent of the latest JavaScript,<sup><a data-type="noteref" href="preface01.xhtml#idm45607823284352" id="idm45607823284352-marker">1</a></sup> Python and JavaScript have even more in common, making switching between them that much less stressful.</p>
</li>
<li>
<p>Being able to read from and write to the key data formats (e.g., JSON and CSV) and databases (both SQL and NoSQL) with ease is one of Python’s great strengths.<a data-primary="databases" data-type="indexterm" id="idm45607813257696"/><a data-primary="data formats" data-type="indexterm" id="idm45607813256960"/> We see how easy it is to pass data around in Python, translating formats and changing databases as we go. This fluid movement of data is the main lubricant of any dataviz toolchain.</p>
</li>
<li>
<p>We cover the basic web development (webdev) skills needed to start producing modern, interactive, browser-based dataviz. By focusing on the concept of the <a href="https://oreil.ly/yqv6C">single-page application</a> rather than building whole websites, we minimize conventional webdev and place the emphasis on <span class="keep-together">programming</span> your visual creations in JavaScript.<a data-primary="SVG (Scalable Vector Graphics)" data-type="indexterm" id="idm45607822076336"/> An introduction to Scalable Vector Graphics (SVG), the chief building block of D3 visualizations, sets the scene for the creation of our Nobel Prize visualization in <a data-type="xref" href="part05.xhtml#part_viz">Part V</a>.</p>
</li>
</ul>
</div></section>
<section data-pdf-bookmark="Part II: Getting Your Data" data-type="sect2"><div class="sect2" id="idm45607823169632">
<h2>Part II: Getting Your Data</h2>
<p>In this part of the book, we look at how to get data from the web using Python, assuming a nice, clean data file hasn’t <a data-primary="data" data-secondary="getting from the web using Python" data-type="indexterm" id="idm45607823174384"/>been provided to the data visualizer:</p>
<ul>
<li>
<p>If you’re lucky, a clean file in an easily usable data format (i.e., JSON or CSV) is at an open URL, a simple HTTP request away. Alternatively, there may be a dedicated web API for your dataset, with any luck a RESTful one. As an example, we look at using the Twitter API (via Python’s Tweepy library). We also see how to use Google spreadsheets, a widely used data-sharing resource in dataviz.</p>
</li>
<li>
<p>Things get more involved when the data of interest is present on the web in human-readable form, often in HTML tables, lists, or hierarchical content blocks.<a data-primary="scraping data" data-type="indexterm" id="idm45607823345136"/> In this case, you have to resort to <em>scraping</em>, getting the raw HTML content and then using a parser to make its embedded content available. We see how to use Python’s lightweight Beautiful Soup scraping library and the much more featureful and heavyweight Scrapy, the biggest star in the Python scraping firmament.</p>
</li>
</ul>
</div></section>
<section data-pdf-bookmark="Part III: Cleaning and Exploring Data with pandas" data-type="sect2"><div class="sect2" id="idm45607823201536">
<h2>Part III: Cleaning and Exploring Data with pandas</h2>
<p>In this part, we turn the <a data-primary="data" data-secondary="cleaning and exploring with pandas" data-type="indexterm" id="idm45607823179824"/><a data-primary="pandas" data-secondary="cleaning and exploring data with" data-type="indexterm" id="idm45607823178880"/>big guns of pandas, Python’s powerful programmatic spreadsheet, onto the problem of cleaning and then exploring datasets. We first see how pandas is part of Python’s NumPy ecosystem, which leverages the power of very fast, powerful low-level array processing libraries, while making them accessible. The focus is on using pandas to clean and then explore our Nobel Prize dataset:</p>
<ul>
<li>
<p>Most data, even that which comes from official web APIs, is dirty. And making it clean and usable will occupy far more of your time as a data visualizer than you probably anticipated. Taking the Nobel dataset as an example, we progressively clean it, searching for dodgy dates, anomalous datatypes, missing fields, and all the common grime that needs cleaning before you can start to explore and then transform your data into a visualization.</p>
</li>
<li>
<p>With our clean (as we can make it) Nobel Prize dataset in hand, we see how easy it is to use pandas and Matplotlib to interactively explore data, easily creating inline charts, slicing the data every which way, and generally getting a feel for it, while looking for those interesting nuggets you want to deliver with visualization.</p>
</li>
</ul>
</div></section>
<section data-pdf-bookmark="Part IV: Delivering the Data" data-type="sect2"><div class="sect2" id="idm45607821719632">
<h2>Part IV: Delivering the Data</h2>
<p>In this part, we see how easy it is to create a minimal data API using Flask, to deliver data both statically <a data-primary="Flask" data-type="indexterm" id="idm45607823076864"/>and dynamically to the web browser:</p>
<p>First, we see how to use Flask to serve static files and then how to roll your own basic data API, serving data from a local database. Flask’s minimalism allows you to create a very thin data-serving layer between the fruits of your Python data processing and their eventual visualization on the browser.</p>
<p>The glory of open source software is that you can often find robust, easy-to-use libraries that solve your problem better than you could. In the second chapter of this part, we see how easy it is to use best-of-breed Python (Flask) libraries to craft a robust, flexible RESTful API, ready to serve your data online.<a data-primary="RESTful APIs" data-secondary="creation with Flask" data-type="indexterm" id="idm45607816893664"/> We also cover the easy online deployment of this data server using Heroku, a favorite of Pythonistas.</p>
</div></section>
<section data-pdf-bookmark="Part V: Visualizing Your Data with D3 and Plotly" data-type="sect2"><div class="sect2" id="idm45607822886464">
<h2>Part V: Visualizing Your Data with D3 and Plotly</h2>
<p>In the first chapter of this part, we see how to take the fruits of your pandas-driven <a data-primary="D3 library" data-secondary="data visualization using D3 and Plotly" data-type="indexterm" id="idm45607822885200"/><a data-primary="Plotly charting library" data-type="indexterm" id="idm45607820037440"/><a data-primary="Matplotlib" data-type="indexterm" id="idm45607820036768"/>exploration, in the form of charts or maps, and put them on the web, where they belong. Matplotlib can produce publication-standard static charts while Plotly brings user controls and dynamic charts to the table. We see how to take a Plotly chart directly from a Jupyter notebook and put it in a web page.</p>
<p>The part of the book that covers D3 is some of the most challenging, but you may well end up being employed to construct the kind of multielement visualizations it produces. One of the joys of D3 is the <a href="https://oreil.ly/AIWkI">huge number of examples</a> that can easily be found online, but most of them demonstrate a single technique and there are few showing how to orchestrate multiple visual elements. In these D3 chapters, we see how to synchronize the update of a timeline (featuring all the Nobel Prizes), a map, a bar chart, and a list as the user filters the Nobel Prize dataset or changes the prize-winning metric (absolute or per capita).</p>
<p>Mastery of the core themes demonstrated in these chapters should allow you to let loose your imagination and learn by doing. I’d recommend choosing some data close to your heart and designing a D3 creation around it.</p>
</div></section>
<section data-pdf-bookmark="The Second Edition" data-type="sect1"><div class="sect1" id="idm45607823151936">
<h1>The Second Edition</h1>
<p>I was a little reluctant when O’Reilly offered me the opportunity of writing a second edition of this book. The first edition ended up larger than anticipated, and updating and augmenting it was potentially a lot of work. However, after reviewing the status of the libraries covered and changes to the Python and JavaScript dataviz ecosystem, it was clear that most of the libraries used (e.g., Scrapy, NumPy, pandas) were still solid choices and needed fairly small updates.</p>
<p>D3 was the library that had changed the most, but these changes had made D3 both easier to use and easier to teach. JavaScript modules were also solidly in place, making the code cleaner and more familiar to a Pythonista.</p>
<p>A few Python libraries no longer seemed like solid choices and a couple had been deprecated. The first edition dealt fairly extensively with MongoDB, a NoSQL database. I now think that good old-fashioned SQL is a better fit for dataviz work and that the minimal file-based, serverless SQLite represents a dataviz sweet spot if a database is required.</p>
<p>Rather than replace the deprecated RESTful data server with another Python library, I thought it would be particularly instructive to build a simple one from scratch, demonstrating the use of some brilliant Python libraries, such as marshmallow, which are useful in many dataviz scenarios.</p>
<p>With the time available for updating the book, I made the decision to use the first book’s dataset for demonstrating exploration and analysis with Matplotlib and pandas, focusing on updating all the libraries to their current (as of mid-2022) versions. This allowed time to be spent on new material, chief of which is a chapter dedicated to Python’s Plotly library, which allows you to easily transfer exploratory work from a Jupyter notebook to a web presentation with user interactions. A particular strength of this approach is the availability of Mapbox maps, a rich mapping ecosystem.</p>
<p>The main thrust of the second edition was:</p>
<ul>
<li>
<p>To bring all the libraries up to date.</p>
</li>
<li>
<p>To remove and/or replace libraries that hadn’t stood the test of time.</p>
</li>
<li>
<p>To add some new material suggested by changes in the fast-developing world of Python and JavaScript dataviz.</p>
</li>
</ul>
<p>The metaphor of the dataviz toolchain still holds good, I think, and <a data-primary="dataviz" data-secondary="toolchain and transformative pipeline" data-type="indexterm" id="idm45607822868688"/>the transformative pipeline, from raw, unprocessed web data through exploratory dataviz-driven analysis to polished web visualization, remains a good way to learn the key tools of the job.</p>
</div></section>
<section data-pdf-bookmark="Conventions Used in This Book" data-type="sect1"><div class="sect1" id="idm45607822867360">
<h1>Conventions Used in This Book</h1>
<p>The following typographical conventions are used in this book:</p>
<dl>
<dt><em>Italic</em></dt>
<dd>
<p>Indicates new terms, URLs, email addresses, filenames, and file extensions.</p>
</dd>
<dt><code>Constant width</code></dt>
<dd>
<p>Used for program listings, as well as within paragraphs to refer to program elements such as variable or function names, databases, datatypes, environment variables, statements, and <span class="keep-together">keywords</span>.</p>
</dd>
<dt><strong><code>Constant width bold</code></strong></dt>
<dd>
<p>Shows commands or other text that should be typed literally by the user.</p>
</dd>
<dt><em><code>Constant width italic</code></em></dt>
<dd>
<p>Shows text that should be replaced with user-supplied values or by values determined by context.</p>
</dd>
</dl>
<div data-type="tip"><h6>Tip</h6>
<p>This element signifies a tip or suggestion.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>This element signifies a general note.</p>
</div>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>This element indicates a warning or caution.</p>
</div>
</div></section>
<section data-pdf-bookmark="Using Code Examples" data-type="sect1"><div class="sect1" id="idm45607822961056">
<h1>Using Code Examples</h1>
<!--PROD: Please reach out to author to find out if they will be uploading code examples to oreilly.com or their own site (e.g.,, GitHub). If there is no code download, delete this whole section. If there is, when you email digidist with the link, let them know what you filled in for title_title (should be as close to book title as possible, i.e., learning_python_2e). This info will determine where digidist loads the files.-->
<p>Supplemental material (code examples, exercises, etc.) is available for download at <a class="bare" href="https://github.com/Kyrand/dataviz-with-python-and-js-ed-2"><em class="hyperlink">https://github.com/Kyrand/dataviz-with-python-and-js-ed-2</em></a>.</p>
<p>This book is here to help you get your job done. <a data-primary="code examples from this book" data-type="indexterm" id="idm45607823145632"/>In general, if example code is offered with this book, you may use it in your programs and documentation. You do not need to contact us for permission unless you’re reproducing a significant portion of the code. For example, writing a program that uses several chunks of code from this book does not require permission. Selling or distributing a CD-ROM of examples from O’Reilly books does require permission. Answering a question by citing this book and quoting example code does not require permission. Incorporating a significant amount of example code from this book into your product’s documentation does require permission.</p>
<p>We appreciate, but do not require, attribution. An attribution usually includes the title, author, publisher, and ISBN. For example: “<em>Data Visualization with Python and JavaScript</em>, second edition, by Kyran Dale (O’Reilly). Copyright 2023 Kyran Dale Limited, 978-1-098-11187-8.”</p>
<p>If you feel your use of code examples falls outside fair use or the permission given above, feel free to contact us at <a class="email" href="mailto:permissions@oreilly.com"><em>permissions@oreilly.com</em></a>.</p>
</div></section>
<section data-pdf-bookmark="O’Reilly Online Learning" data-type="sect1"><div class="sect1" id="idm45607821726144">
<h1>O’Reilly Online Learning</h1>
<div class="ormenabled" data-type="note" epub:type="note"><h6>Note</h6>
<p>For more than 40 years, <a class="orm:hideurl" href="https://oreilly.com"><em class="hyperlink">O’Reilly Media</em></a> has provided technology and business training, knowledge, and insight to help companies succeed.</p>
</div>
<p>Our unique network of experts and innovators share their knowledge and expertise through books, articles, and our online learning platform. O’Reilly’s online learning platform gives you on-demand access to live training courses, in-depth learning paths, interactive coding environments, and a vast collection of text and video from O’Reilly and 200+ other publishers. For more information, visit <a class="orm:hideurl" href="https://oreilly.com"><em>https://oreilly.com</em></a>.</p>
</div></section>
<section data-pdf-bookmark="How to Contact Us" data-type="sect1"><div class="sect1" id="idm45607802947296">
<h1>How to Contact Us</h1>
<p>Please address comments and questions concerning this book to the publisher:</p>
<ul class="simplelist">
<li>O’Reilly Media, Inc.</li>
<li>1005 Gravenstein Highway North</li>
<li>Sebastopol, CA 95472</li>
<li>800-998-9938 (in the United States or Canada)</li>
<li>707-829-0515 (international or local)</li>
<li>707-829-0104 (fax)</li>
</ul>
<p>We have a <a data-primary="web page for this book" data-type="indexterm" id="idm45607822864848"/>web page for this book, where we list errata, examples, and any additional information. You can access this page at <a class="bare" href="https://oreil.ly/dvpj_2e"><em class="hyperlink">https://oreil.ly/dvpj_2e</em></a>.</p>
<p>Email <a class="email" href="mailto:bookquestions@oreilly.com"><em>bookquestions@oreilly.com</em></a> to comment or ask technical questions about this book.</p>
<p>For news and information about our books and courses, visit <a class="bare" href="https://oreilly.com"><em class="hyperlink">https://oreilly.com</em></a>.</p>
<p>Find us on LinkedIn: <a class="bare" href="https://linkedin.com/company/oreilly-media"><em class="hyperlink">https://linkedin.com/company/oreilly-media</em></a></p>
<p>Follow us on Twitter: <a class="bare" href="https://twitter.com/oreillymedia"><em class="hyperlink">https://twitter.com/oreillymedia</em></a></p>
<p>Watch us on YouTube: <a class="bare" href="https://www.youtube.com/oreillymedia"><em class="hyperlink">https://www.youtube.com/oreillymedia</em></a></p>
</div></section>
<section data-pdf-bookmark="Acknowledgments" data-type="sect1"><div class="sect1" id="idm45607818871520">
<h1>Acknowledgments</h1>
<p>Thanks first to Meghan Blanchette, who set the ball rolling and steered that ball through its first very rough chapters. Dawn Schanafelt then took the helm and did the bulk of the very necessary editing. Kristen Brown did a brilliant job taking the book through production, aided by Gillian McGarvey’s impressively tenacious copyediting. Working with such talented, dedicated professionals has been an honor and a privilege—and an education: the book would have been so much easier to write if I’d known then what I know now. Isn’t that always the way?</p>
<p>Many thanks to Amy Zielinski for making the author look better than he deserves.</p>
<p>The book benefited from some very helpful feedback. So many thanks to Christophe Viau, Tom Parslow, Peter Cook, Ian Macinnes, and Ian Ozsvald.</p>
<p>I’d also like to thank the valiant bug hunters who answered my appeal during this book’s early release. At time of writing, these are Douglas Kelley, Pavel Suk, Brigham Hausman, Marco Hemken, Noble Kennamer, Manfredi Biasutti, Matthew Maldonado, and Geert Bauwens.</p>
<section data-pdf-bookmark="Second Edition" data-type="sect2"><div class="sect2" id="idm45607818868192">
<h2>Second Edition</h2>
<p>Primary thanks must go to Shira Evans for shepherding the book from conception to realization. Gregory Hyman did a great job keeping me abreast of early releases and providing feedback. Once again, I was lucky to have Kristen Brown bring the book through production.</p>
<p>I’d also like to thank my tech reviewers Jordan Goldmeier, Drew Winstel, and Jess Males for great advice.</p>
</div></section>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm45607823284352"><sup><a href="preface01.xhtml#idm45607823284352-marker">1</a></sup> There are many versions of JavaScript based on <a href="https://oreil.ly/0uwuN">ECMAScript</a>, but the most significant version, which provides the bulk of new functionality, is <a href="https://oreil.ly/owrsZ">ECMAScript 6</a>.</p></div></div></section></div></body></html>