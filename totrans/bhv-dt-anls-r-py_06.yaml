- en: Chapter 4\. Building Causal Diagrams from Scratch
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第四章。从头开始建立因果图
- en: At this point, you may be wondering where the [causal diagram] comes from. It’s
    an excellent question. It may be the question. A [CD] is supposed to be a theoretical
    representation of the state-of-the-art knowledge about the phenomena you’re studying.
    It’s what an expert would say is the thing itself, and that expertise comes from
    a variety of sources. Examples include economic theory, other scientific models,
    conversations with experts, your own observations and experiences, literature
    reviews, as well as your own intuition and hypotheses.
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 此时，您可能会想知道[因果图]的来源。这是一个很好的问题。这可能是一个问题。 [CD]应该是您研究的现象的关于其最先进知识的理论表示。这是一个专家认为是事物本身的东西，这种专业知识来自于多种来源。例如，经济理论，其他科学模型，与专家的交流，您自己的观察和经验，文献综述，以及您自己的直觉和假设。
- en: ''
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Scott Cunningham, *Causal Inference: The Mixtape* (2021)'
  id: totrans-3
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Scott Cunningham，《因果推断：混音带》（2021）
- en: Our goal in this book is always to measure the impact of one variable on another,
    which we can represent as a “starter” CD ([Figure 4-1](#the_simplest_possible_cd)).
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的目标始终是衡量一个变量对另一个变量的影响，我们可以将其表示为“起始”CD（[图4-1](#the_simplest_possible_cd)）。
- en: '![The simplest possible CD](Images/BEDA_0401.png)'
  id: totrans-5
  prefs: []
  type: TYPE_IMG
  zh: '![最简单的CD](Images/BEDA_0401.png)'
- en: Figure 4-1\. The simplest possible CD
  id: totrans-6
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-1。最简单的CD
- en: Once you have drawn that relationship, what comes next? How can you know what
    other variables you should include or not? Many authors say you should rely on
    expert knowledge, which is fine if you work in an established field like economics
    or epidemiology. But my perspective in this book is that you’re likely “behavioral
    scientist number one” in your organization and therefore you need to be able to
    start from a blank slate.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你画出那种关系，接下来会发生什么？你如何知道你应该包括哪些其他变量或不包括哪些变量？许多作者说你应该依靠专家知识，如果你在像经济学或流行病学这样的已建立领域工作的话，这是可以的。但在本书中，我的观点是，你很可能是你组织中的“行为科学家第一人”，因此你需要能够从一张空白的画布开始。
- en: 'In this chapter, I’ll outline a recipe to get you from the basic CD in [Figure 4-1](#the_simplest_possible_cd)
    to a workable CD. As we go through the process, please keep in mind our ultimate
    goal of understanding what drives behaviors so that we can draw relevant and actionable
    conclusions for our business. Our objective is not to build a complete and precise
    knowledge of the whole world. Shortcuts and approximations are fair game, and
    everything should be assessed according to a single criterion: is this helping
    me with my business goal?'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我将概述一种配方，帮助您从[图4-1](#the_simplest_possible_cd)的基本CD到一个可行的CD。在我们进行这个过程的同时，请记住我们的最终目标是理解是什么推动行为，以便我们可以为我们的业务得出相关和可操作的结论。我们的目标不是建立对整个世界的完整和精确的知识。捷径和近似是公平的游戏，一切都应根据一个标准评估：这是否有助于我实现我的业务目标？
- en: 'In addition, the recipe I’ll outline is not a mechanical algorithm that you
    could follow blindly to get to the right CD. On the contrary, business sense,
    common sense, and data insights will be crucial. We’ll go back and forth between
    our qualitative understanding of the causal situation at hand and the quantitative
    relationships present in the data, cross-checking one with the other until we
    feel that we have a satisfactory result. “Satisfactory” is an important word here:
    in applied settings, you usually can’t tell your manager that you’ll give them
    the right answer in three years. You need to give them the least bad answer possible
    in the short term, while planning the data collection work that will improve your
    answer over the years.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我将概述的配方不是一个机械算法，你可以盲目地遵循到正确的CD。相反，商业常识，常识和数据见解将是至关重要的。我们将在我们对手头因果关系的定性理解和数据中的定量关系之间来回反复，相互核对，直到我们觉得我们有一个令人满意的结果。在这里，“令人满意”是一个重要的词：在应用环境中，通常你不能告诉你的经理，你将在三年内给他们正确的答案。你需要在短期内给他们最不坏的答案，同时规划数据收集工作，以改进多年来的答案。
- en: 'In the next section, I’ll present the business problem for this chapter and
    the corresponding variables of interest. We’ll then progressively build out the
    corresponding CD along the following recipe, with one section per step:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分中，我将为本章的业务问题及相关的兴趣变量提供介绍。然后，我们将按照以下步骤逐步构建相应的CD，并逐步进行各个部分的描述：
- en: Identify variables that could/should potentially be included in the CD.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定可能/应该包含在CD中的变量。
- en: Determine if the variables should be included.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定是否应该包含变量。
- en: Iterate the process as needed.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据需要迭代这个过程。
- en: Simplify the diagram.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 简化图表。
- en: Let’s get started!
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始吧！
- en: Business Problem and Data Setup
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 业务问题和数据设置
- en: For this section, we’ll be working with a real-world data set of hotel bookings
    for two hotels located within the same city.^([1](ch04.xhtml#ch01fn8)) The data
    and packages that we’ll use are described in the next subsection, and we’ll then
    do a deeper dive to understand the relationship of interest.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将使用一个位于同一城市内的两家酒店的实际预订数据集。数据和我们将使用的包将在下一小节中描述，并且我们将深入研究理解感兴趣的关系。
- en: Data and Packages
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据和包
- en: The [GitHub folder for this chapter](https://oreil.ly/BehavioralDataAnalysisCh4)
    contains the CSV file *chap4-hotel_booking_case_study.csv* with the variable listed
    in [Table 4-1](#variables_in_data_file).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的[GitHub文件夹](https://oreil.ly/BehavioralDataAnalysisCh4)包含名为*chap4-hotel_booking_case_study.csv*的CSV文件，其中列出了[表 4-1](#variables_in_data_file)中的变量。
- en: Table 4-1\. Variables in data file
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 表 4-1\. 数据文件中的变量
- en: '| Variable name | Variable description |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '| 变量名 | 变量描述 |'
- en: '| --- | --- |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| *NRDeposit* (NRD) | Binary 0/1, whether the reservation had a nonrefundable
    deposit |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| *NRDeposit* (NRD) | 二进制 0/1，预订是否有不可退还押金 |'
- en: '| *IsCanceled* | Binary 0/1, whether the reservation was canceled or not |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| *IsCanceled* | 二进制 0/1，预订是否取消 |'
- en: '| *DistributionChannel* | Categorical variable with values “Direct,” “Corporate,”
    “TA/TO” (travel agent/travel organization), “Other” |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| *DistributionChannel* | 分类变量，取值为“直接”，“公司”，“TA/TO”（旅行代理/旅行组织），“其他” |'
- en: '| *CustomerType* | Categorical variable with values “Transient,” “Transient-Party,”
    “Contract,” “Group” |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| *CustomerType* | 分类变量，取值为“瞬时”，“瞬时-团体”，“合同”，“团体” |'
- en: '| *MarketSegment* | Categorical variable with values “Direct,” “Corporate,”
    “Online TA,” “Offline TA/TO,” “Groups,” “Other” |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| *MarketSegment* | 分类变量，取值为“直接”，“公司”，“在线TA”，“离线TA/TO”，“团体”，“其他” |'
- en: '| *Children* | Integer, number of children in the reservation |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| *Children* | 整数，预订中的儿童人数 |'
- en: '| *ADR* | Numeric, average daily rate, total reservation amount/number of days
    |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| *ADR* | 数值，平均每日费率，总预订金额/天数 |'
- en: '| *PreviousCancellation* | Binary 0/1, whether the customer previously canceled
    a reservation or not |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| *PreviousCancellation* | 二进制 0/1，客户之前是否取消过预订 |'
- en: '| *IsRepeatedGuest* | Binary 0/1, whether the customer has previously made
    a reservation at the hotel |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| *IsRepeatedGuest* | 二进制 0/1，客户是否之前曾在酒店预订过 |'
- en: '| *Country* | Categorical, country of origin of the customer |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| *Country* | 分类，客户的国家/地区 |'
- en: '| *Quarter* | Categorical, quarter of year for the reservation |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| *Quarter* | 分类，预订季度 |'
- en: '| *Year* | Integer, year of the reservation |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| *Year* | 整数，预订年份 |'
- en: 'In this chapter, we’ll use the following packages in addition to the standard
    ones called out in the preface:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，除了前言中提到的标准包装外，我们还将使用以下包装：
- en: '[PRE0]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Understanding the Relationship of Interest
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解感兴趣的关系
- en: We’ll try to answer the question, “Does the type of deposit impact the cancellation
    rate of bookings?” as expressed in [Figure 4-2](#causal_relationship_of_interest).
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将尝试回答这个问题：“押金类型是否影响预订的取消率？”正如[图 4-2](#causal_relationship_of_interest)所述。
- en: '![Causal relationship of interest](Images/BEDA_0402.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![感兴趣的因果关系](Images/BEDA_0402.png)'
- en: Figure 4-2\. Causal relationship of interest
  id: totrans-41
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-2\. 感兴趣的因果关系
- en: 'Let’s start by looking at the base cancellation rate by deposit type (I like
    to look at both the absolute numbers and the percentages, in case some categories
    have very small numbers):'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从按押金类型分类的基础取消率开始（我喜欢同时查看绝对数和百分比，以防某些类别的数值非常小）：
- en: '[PRE2]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: We can see that the overwhelming majority of bookings have no deposit, with
    a cancellation rate of about 27%. On the other hand, bookings with nonrefundable
    deposits (*NRDeposit*) have a very high cancellation rate. On the face of it,
    this correlation is surprising. Would changing our policy to “no deposit” for
    everyone reduce cancellation rates? Behavioral common sense tells us that more
    likely, the hotels are requesting nonrefundable deposits for “high risk” bookings
    and there is a confounder, as represented in [Figure 4-3](#the_causal_relationship_is_likely_confo).
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，绝大多数预订没有押金，取消率约为27%。另一方面，有不可退还押金（*NRDeposit*）的预订取消率非常高。乍看之下，这种相关性令人惊讶。如果我们将政策改为对所有人“无需押金”，能减少取消率吗？行为常识告诉我们，更有可能的是，酒店为“高风险”预订请求不可退还押金，并且存在混杂变量，如[图 4-3](#the_causal_relationship_is_likely_confo)中所示。
- en: '![The causal relationship is likely confounded](Images/BEDA_0403.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![因果关系可能会受到干扰](Images/BEDA_0403.png)'
- en: Figure 4-3\. The causal relationship is likely confounded
  id: totrans-47
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-3。因果关系可能会受到干扰
- en: 'We went pretty quickly from [Figure 4-2](#causal_relationship_of_interest)
    to [Figure 4-3](#the_causal_relationship_is_likely_confo), but it was an important
    step: the CD in [Figure 4-2](#causal_relationship_of_interest) represents a basic
    business analytics question, “What is the causal relationship between deposit
    type and cancellation rate?” On the other hand, the CD in [Figure 4-3](#the_causal_relationship_is_likely_confo)
    represents a more informed behavioral hypothesis: “A nonrefundable deposit seems
    to increase cancellation rate, but that relationship is probably confounded by
    factors we’ll need to determine.”'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们很快就从[Figure 4-2](#causal_relationship_of_interest)转到[Figure 4-3](#the_causal_relationship_is_likely_confo)，但这是一个重要的步骤：[Figure 4-2](#causal_relationship_of_interest)中的CD代表了一个基本的商业分析问题，“押金类型与取消率之间的因果关系是什么？”另一方面，[Figure 4-3](#the_causal_relationship_is_likely_confo)中的CD代表了一个更加明智的行为假设：“不可退还的押金似乎会增加取消率，但这种关系可能会受到我们需要确定的因素的干扰。”
- en: A nice aspect of using CDs for behavioral data analysis is that they are a great
    collaboration tool. Anyone in your organization with minimal knowledge of CDs
    can look at [Figure 4-3](#the_causal_relationship_is_likely_confo) and say, “Well
    yeah, we require nonrefundable deposits for holiday bookings and these often get
    canceled because of weather,” or any other tidbit of behavioral knowledge that
    you couldn’t get otherwise.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 使用CD进行行为数据分析的一个好处是它们是一个很好的协作工具。你组织中任何对CD有最基本了解的人都可以看到[Figure 4-3](#the_causal_relationship_is_likely_confo)，并说，“嗯，是的，我们要求假期预订支付不可退还的押金，这些押金经常因为天气原因而被取消，”或者其他任何行为知识的片段，否则你无法得到。
- en: 'At this point, the best next step would be a randomized experiment: assign
    refundable or nonrefundable deposits to a random sample of customers and you’ll
    be able to confirm or disprove your behavioral hypothesis. However, you may not
    be able to do so, or not yet. In the meantime, we’ll try to deconfound the relationship
    by identifying relevant variables to include.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，最好的下一步是进行随机实验：将可退还或不可退还的押金分配给一组随机样本的客户，您将能够确认或否定您的行为假设。然而，您可能无法这样做，或者还没有准备好。与此同时，我们将尝试通过确定要包括的相关变量来解除关系的混淆。
- en: Identify Candidate Variables to Include
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 确定要包括的候选变量
- en: When trying to identify potential variables to include, a natural inclination
    is to start with the data you have available. This inclination is misleading,
    akin to the drunk person who looks for their house keys not where they lost them,
    but under a streetlamp because there is more light there. By doing so, you may
    be ignoring the most important variables simply because they’re not under your
    nose. You’re also more likely to take the variables in your data at face value,
    and not question whether they are the best representation of what’s happening
    in the real world.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试确定要包括的潜在变量时，自然的倾向是从您可以获得的数据开始。这种倾向是误导性的，类似于醉酒的人不是在他们丢失的地方找钥匙，而是在路灯下找，因为那里更亮。这样做可能会忽略最重要的变量，因为它们不在你的视线范围内。你也更可能只是看到数据中的变量，并不质疑它们是否是现实世界中发生情况的最佳表示。
- en: For instance, categorical variables in your data are likely to represent a business-centric
    perspective rather than a customer-centric perspective, and it may be more appropriate
    to aggregate some categories together, or even to merge different variables into
    new ones. In our case, we have a variable *MarketSegment* and one for the number
    of children in the reservation. We can confirm by looking at the data that very
    few corporate customers bring children with them. Therefore we could consider
    creating a new categorical variable with categories “corporate without children,”
    “noncorporate without children,” and “noncorporate with children,” setting aside
    the corporate customers with children as outliers worthy of a separate investigation
    (maybe the seed for tailored services?).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，数据中的分类变量很可能代表的是业务中心的观点，而不是客户中心的观点，因此将一些类别聚合在一起或甚至将不同变量合并为新变量可能更合适。在我们的案例中，有一个变量*MarketSegment*和一个用于预订中儿童数量的变量。通过查看数据，我们可以确认很少有公司客户会带着孩子来。因此，我们可以考虑创建一个新的分类变量，其中包括“没有孩子的公司”，“没有孩子的非公司”和“有孩子的非公司”，将带有孩子的公司客户视为值得进行单独调查的异常值（也许是量身定制服务的基础？）。
- en: 'Instead of falling for this “What You See Is All There Is” bias,^([2](ch04.xhtml#ch01fn9))
    we’ll start with the behavioral categories outlined in [Chapter 2](ch02.xhtml#understanding_behavioral_data),
    from the action backward:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从行为类别开始，而不是陷入“你看到的就是所有”的偏见^[2](ch04.xhtml#ch01fn9)，从动作向后开始，详细了解[第二章](ch02.xhtml#understanding_behavioral_data)中概述的行为类别。
- en: Actions
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行动
- en: Intentions
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 意图
- en: Cognition and emotions
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 认知与情绪
- en: Personal characteristics
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 个人特征
- en: Business behaviors
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 业务行为
- en: Finally, variables in each one of these categories may be affected by time trends
    such as linear trends or seasonality, so we’ll add these by default at the end
    of this section. In order to reinforce the focus on qualitative intuitions, we
    won’t look at any data until the next section, about validating relationships.
    Replacing our a priori cancellation risk (as well as other potential confounders)
    by these categories, our CD now looks like [Figure 4-4](#updated_cd_with_categories_of_potential),
    with a bunch of unobserved variables added to our two variables of interest.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，每个类别中的变量可能受到时间趋势的影响，如线性趋势或季节性，因此我们将在本节末尾默认添加这些内容。为了加强对定性直觉的关注，我们不会在下一节关于验证关系的内容之前查看任何数据。通过这些类别替换我们的先验取消风险（以及其他潜在混杂因素），我们的
    CD 现在看起来像是 [图 4-4](#updated_cd_with_categories_of_potential)，其中添加了一堆未观察到的变量到我们的两个感兴趣的变量中。
- en: '![Updated CD with categories of potential variables to include](Images/BEDA_0404.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![包含潜在变量类别的更新 CD](Images/BEDA_0404.png)'
- en: Figure 4-4\. Updated CD with categories of potential variables to include
  id: totrans-62
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-4\. 包含潜在变量类别的更新 CD
- en: For each of these categories, we’ll now look for variables that may be a cause
    of either of our two variables of interest.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个类别，我们现在将寻找可能成为我们两个感兴趣的变量之一的原因的变量。
- en: Actions
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 行动
- en: When looking for variables to include in the actions category, we’re usually
    trying to identify past behaviors from the customer that may affect whether the
    hotel required a nonrefundable deposit (NRD).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在寻找要包含在操作类别中的变量时，我们通常试图识别客户过去的行为，这些行为可能会影响酒店是否需要非退款押金（NRD）。
- en: An obvious candidate in this case is whether the customer previously canceled.
    Maybe the hotel is more likely to request an NRD from customers who flaked in
    the past. It is also conceivable that whatever caused them to cancel in the past
    is also more likely to make them cancel in the future.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，一个明显的候选者是客户是否以前取消过。也许酒店更有可能要求那些过去曾经取消的客户支付非退款押金。同样可以想象，导致他们过去取消的原因也更可能导致他们将来取消。
- en: 'More generally, when one of our variables of interest is itself an action,
    past behavior is often a good predictive variable to include, even just as a proxy
    for unobserved personal characteristics. We have two variables related to past
    behavior in our data: *PreviousCancellation* and *IsRepeatedGuest*. [Figure 4-5](#updated_cd_at_the_end_of_the_actions_st)
    shows our updated CD, with the unchanged portions in gray.'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 更普遍地说，当我们感兴趣的变量之一本身就是一个行为时，过去的行为通常是一个很好的预测变量，即使只是作为未观察到的个人特征的代理。我们的数据中有两个与过去行为相关的变量：*PreviousCancellation*
    和 *IsRepeatedGuest*。[图 4-5](#updated_cd_at_the_end_of_the_actions_st) 展示了我们更新的
    CD，未更改的部分为灰色。
- en: '![Updated CD at the end of the actions step](Images/BEDA_0405.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![在操作步骤结束时更新的 CD](Images/BEDA_0405.png)'
- en: Figure 4-5\. Updated CD at the end of the actions step
  id: totrans-69
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-5\. 在操作步骤结束时更新的 CD
- en: This is not to say that these are the only relevant past behaviors; they just
    happen to be the only ones I thought of and that we had data for. Hopefully, you
    can think of others!
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不意味着这些是唯一相关的过去行为；它们只是我想到的并且我们有数据的唯一一些。希望你能想到其他的！
- en: Intentions
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 意图
- en: Intentions are easy to overlook in data analysis, because they are often missing
    from our existing data. However, they are one of the most important drivers of
    behaviors, and they can often be revealed by interviewing customers and employees.
    They thus represent one of the best illustrations of the benefits of not just
    looking at existing, available data, but adopting a “behaviors first” approach.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 意图在数据分析中很容易被忽视，因为它们通常在我们现有的数据中丢失。然而，它们是行为的最重要驱动因素之一，而且通常可以通过对客户和员工进行访谈来揭示。因此，它们代表了不仅仅查看现有可用数据，而是采用“首先关注行为”的方法的好处的最佳例证。
- en: 'In this case, there are two intentions I can think of: the reason for the trip
    and the reason for the cancellation ([Figure 4-6](#adding_intentions_to_our_cd)).'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我能想到两个意图：旅行的原因和取消的原因（[图 4-6](#adding_intentions_to_our_cd)）。
- en: '![Adding intentions to our CD](Images/BEDA_0406.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![将意图添加到我们的CD](Images/BEDA_0406.png)'
- en: Figure 4-6\. Adding intentions to our CD
  id: totrans-75
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-6\. 将意图添加到我们的CD
- en: Note that I represented *TripReason* as a potential confounder, i.e., with an
    arrow to both of our variables of interest, whereas *CancellationReason* affects
    only *IsCanceled*. At this point, this is just a behavioral hunch, namely that
    the reason for the cancellation doesn’t affect the type of deposit. My rationale
    is that the reason for cancellation is not known at the time of the deposit.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我将*TripReason*表示为潜在混杂因素，即，它与我们感兴趣的两个变量都有箭头相连，而*CancellationReason*只影响*IsCanceled*。此时，这只是一个行为直觉，即取消原因不会影响押金类型。我的理由是，在存款时并不知道取消原因。
- en: '[Figure 4-6](#adding_intentions_to_our_cd) also shows the versatility of CDs
    for behavioral analysis: we can put down these two potential variables in our
    CD even without knowing the actual list of reasons in either case, which we’ll
    determine later through interviews. For the time being, we can note that three
    of the variables available in our data appear to be affected by trip reason and
    can be included as such: *CustomerType*, *MarketSegment,* and *DistributionChannel*
    ([Figure 4-7](#updated_cd_at_the_end_of_the_intention)). We’ll also revisit these
    variables in the subsection about personal characteristics.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-6](#adding_intentions_to_our_cd)还展示了CD在行为分析中的多功能性：即使我们不知道任一情况下的具体原因列表，我们也可以在CD中记录这两个潜在变量，稍后我们将通过访谈确定它们。暂时来看，我们可以注意到我们数据中的三个变量似乎受到旅行原因的影响，并可以作为这样包括进去：*CustomerType*、*MarketSegment*
    和 *DistributionChannel* ([图 4-7](#updated_cd_at_the_end_of_the_intention))。我们也将在个人特征的小节中重新审视这些变量。'
- en: '![Updated CD at the end of the intention step](Images/BEDA_0407.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![意图步骤结束时更新的CD](Images/BEDA_0407.png)'
- en: Figure 4-7\. Updated CD at the end of the intention step
  id: totrans-79
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-7\. 意图步骤结束时更新的CD
- en: Cognition and Emotions
  id: totrans-80
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 认知与情感
- en: When trying to identify relevant social, psychological, or cognitive phenomena
    for an analysis, I like to zoom in on specific decision points. Here that would
    be when the customer makes the reservation and when they cancel it.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试为分析确定相关社会、心理或认知现象时，我喜欢放大特定的决策点。在这里，客户进行预订和取消预订时就是这样的决策点。
- en: At the first decision point, customers may not understand that their deposit
    is nonrefundable, or they may forget it. At the second decision point, they may
    treat their deposit as a sunk cost and not make efforts to keep their reservations
    ([Figure 4-8](#updated_cd_at_the_end_of_the_cognition)).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一个决策点，顾客可能不明白他们的押金是不可退的，或者他们可能会忘记。在第二个决策点，他们可能将押金视为沉没成本，不会努力保留他们的预订 ([图 4-8](#updated_cd_at_the_end_of_the_cognition))。
- en: '![Updated CD at the end of the cognition and emotions step](Images/BEDA_0408.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![认知与情感步骤结束时更新的CD](Images/BEDA_0408.png)'
- en: Figure 4-8\. Updated CD at the end of the cognition and emotions step
  id: totrans-84
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-8\. 认知与情感步骤结束时更新的CD
- en: Personal Characteristics
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 个人特征
- en: As mentioned in [Chapter 2](ch02.xhtml#understanding_behavioral_data), demographic
    variables are often valuable not so much for themselves but as proxies for other
    personal characteristics such as personality traits. The challenge at this step
    is therefore to resist the pull of whatever demographic variables are present
    in our data, and stick with our causal-behavioral mindset. A good way to do so
    is to think about traits first, before looking at demographic variables.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如 [第二章](ch02.xhtml#understanding_behavioral_data) 中所述，人口统计变量通常并非因其本身而有价值，而是作为其他个人特征（如人格特质）的代理。因此，在这一步骤中的挑战是抵制数据中存在的任何人口统计变量的影响，并坚持我们的因果行为思维模式。在查看人口统计变量之前，首先考虑特质是一个很好的方法。
- en: Traits
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 特质
- en: 'Based on our knowledge of personality psychology, good candidate traits to
    cause our cancellation behavior are conscientiousness and neuroticism: it seems
    plausible that less organized and more carefree people are more likely to end
    up cancelling a reservation ([Figure 4-9](#cd_updated_with_personality_traits)).'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 基于我们对人格心理学的了解，导致取消行为的良好候选特质是责任心和神经质：似乎不太有组织和更为放松的人更有可能取消预订 ([图 4-9](#cd_updated_with_personality_traits))。
- en: '![CD updated with personality traits](Images/BEDA_0409.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![具有个性特征更新的CD](Images/BEDA_0409.png)'
- en: Figure 4-9\. CD updated with personality traits
  id: totrans-90
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-9\. 具有个性特征更新的CD
- en: Demographic variables
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 人口统计变量
- en: We noted earlier that we have corporate and noncorporate customers making reservations
    at the hotels. Beyond the reasons for the trip and for the cancellation, this
    also affects some other personal characteristics such as price elasticity and
    income, both of which would affect our two variables of interest. Let’s group
    these under the heading “financial characteristics.” They are probably somewhat
    captured by the three variables we saw earlier, *CustomerType*, *MarketSegment,*
    and *DistributionChannel*, as well as by a few other variables in our data such
    as *Children*, *ADR* (the average daily rate, i.e., the price for a night), and
    *Country* ([Figure 4-10](#cd_updated_with_demographic_variables)).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们早前注意到，我们的酒店有企业客户和非企业客户预订。除了旅行和取消的原因外，这还影响一些其他个人特征，例如价格弹性和收入，这两者会影响我们感兴趣的两个变量。让我们将这些归为“财务特征”类别。它们可能在我们的数据中有所体现，例如*CustomerType*、*MarketSegment*和*DistributionChannel*，以及其他几个变量，如*Children*、*ADR*（即每晚的平均价格）和*Country*（[图 4-10](#cd_updated_with_demographic_variables)）。
- en: '![CD updated with demographic variables](Images/BEDA_0410.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![使用人口统计变量更新的CD](Images/BEDA_0410.png)'
- en: Figure 4-10\. CD updated with demographic variables
  id: totrans-94
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-10\. 使用人口统计变量更新的CD
- en: Business Behaviors
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 商业行为
- en: Business behaviors often play a big role in the relationships we’re investigating,
    but they can easily be overlooked and tricky to integrate.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 商业行为在我们调查的关系中往往起着重要作用，但很容易被忽视和难以整合。
- en: In this example, business rules obviously play an important role, as they determine
    which customers will have to provide an NRD. In that sense, they influence *all*
    the arrows in the CD going into *NRDeposit*. We can account for this influence
    in several ways, depending on the forms it takes.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，业务规则显然起着重要作用，因为它们决定了哪些客户需要提供NRD。从这个意义上说，它们影响*CD*中进入*NRDeposit*的*所有*箭头。我们可以根据它采取多种方式来考虑这种影响的形式。
- en: 'A business rule may explicitly connect two observable variables (possibly including
    our variables of interest). Here for instance, we can imagine a business rule
    stating that all customers who have previously canceled must now provide an NRD.
    By listing all such rules, we can confirm or disprove all arrows from an observed
    variable directly into *NRDeposit*. This may also surface variables that are involved
    in business rules but are not yet in our data: for example, we could imagine that
    customers who don’t provide a proof of ID at the time of the reservation must
    pay an NRD. I said “not yet in our data” because by definition any criterion that
    is part of a business rule is observable, even if it’s not captured in a database.^([3](ch04.xhtml#idm45968166298152))'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 一个业务规则可以明确地连接两个可观察变量（可能包括我们感兴趣的变量）。例如，在这里，我们可以想象一个业务规则，规定所有之前取消预订的客户现在必须提供NRD。通过列出所有这些规则，我们可以确认或否认从一个观察变量直接进入*NRDeposit*的所有箭头。这也可能揭示涉及业务规则但尚未包含在我们数据中的变量：例如，我们可以想象，如果客户在预订时未提供身份证明，则必须支付NRD。我说“尚未包含在我们数据中”，因为根据定义，任何作为业务规则一部分的标准都是可观察的，即使它没有被数据库捕获。^([3](ch04.xhtml#idm45968166298152))
- en: Alternatively, a business rule may be best represented as an additional intermediary
    variable. For instance, if all reservations during the Christmas holidays must
    be backed by an NRD, we could create a *ChristmasHolidays* binary variable with
    an arrow to *NRDeposit*. That variable would then mediate the effect of other
    variables such as *CustomerType* or *Children* on *NRDeposit*.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，一个业务规则可能最好表示为一个额外的中介变量。例如，如果在圣诞节期间的所有预订必须由NRD支持，我们可以创建一个*ChristmasHolidays*二元变量，该变量与*NRDeposit*相互作用。那个变量将会调节其他变量（如*CustomerType*或*Children*）对*NRDeposit*的影响。
- en: We don’t know what business rules the two hotels in our example apply so we
    have to leave that subsection as something that we would want to explore through
    later interviews.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不知道我们示例中的两家酒店应用了什么业务规则，因此我们必须将该子部分留作我们希望通过后续访谈探索的内容。
- en: Time Trends
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 时间趋势
- en: Finally, there might be some global time trends in our data, such as a progressive
    increase in the number of reservations requiring an NRD paralleled by a progressive,
    but unrelated, increase in the cancellation rate. In addition, given how seasonal
    the hotel industry is, there are probably some cyclical aspects that we would
    want to capture ([Figure 4-11](#updated_cd_at_the_end_of_the_time_trend)).
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们的数据中可能存在一些全局时间趋势，例如需求 NRD 的预订数量逐步增加，以及与此同时的取消率逐步增加，但二者无关。此外，酒店行业的季节性非常强烈，可能存在一些周期性方面，我们希望能够捕捉到（[图 4-11](#updated_cd_at_the_end_of_the_time_trend)）。
- en: '![Updated CD at the end of the time trends step](Images/BEDA_0411.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![时间趋势步骤结束时的更新 CD](Images/BEDA_0411.png)'
- en: Figure 4-11\. Updated CD at the end of the time trends step
  id: totrans-104
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-11\. 时间趋势步骤结束时的更新 CD
- en: Note
  id: totrans-105
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: In the present case, the *Year* and *Quarter* variables only capture trends
    and cycles. Sometimes it can also make sense to include binary variables to account
    for specific events that make a certain year stand out or mark a permanent change.
    An obvious example is COVID-19, which, when the dust settles, will turn out to
    have been a temporary blip in certain sectors but the beginning of a sea change
    in others.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，*年份* 和 *季度* 变量仅捕捉趋势和周期。有时，也可以考虑包括二元变量以解释使某年突出或标志性变化的特定事件。一个明显的例子是 COVID-19，在灰尘落定后，它将被证明在某些行业是暂时的起伏，但在其他行业则是根本性的变革的开始。
- en: With that final addition, [Figure 4-11](#updated_cd_at_the_end_of_the_time_trend)
    now has a raft of candidate variables, some observable and some not. In the next
    section, we’ll see how to confirm which observable variables to keep.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 加上这最后一个变量之后，[图 4-11](#updated_cd_at_the_end_of_the_time_trend) 现在有一系列候选变量，一些是可观察的，一些不是。在下一节中，我们将看到如何确认保留哪些可观察变量。
- en: Validate Observable Variables to Include Based on Data
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 根据数据验证要包含的可观察变量
- en: Let’s look at the observable variables we have as candidates at the end of the
    identification phase ([Figure 4-12](#observable_variables_in_our_cdcomma_spl)).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看我们在识别阶段结束时作为候选的可观察变量（[图 4-12](#observable_variables_in_our_cdcomma_spl)）。
- en: '![Observable variables in our CD, split by categorical (left) and numeric (right)](Images/BEDA_0412.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![我们 CD 中的可观察变量，按类别（左）和数字（右）分割](Images/BEDA_0412.png)'
- en: Figure 4-12\. Observable variables in our CD, split by categorical (left) and
    numeric (right)
  id: totrans-111
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-12\. 我们 CD 中的可观察变量，按类别（左）和数字（右）分割
- en: In this specific example, all of these observable variables are tentatively
    connected to both of our variables of interest. This is the default situation,
    but in some cases you may have a very strong a priori rationale to connect a predictor
    variable to only one of your variables of interest (that was the case, for example,
    with some of our unobserved variables). When in doubt, I would err on the side
    of caution and include both connections.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个具体的例子中，所有这些可观察变量暂时都与我们感兴趣的两个变量有关。这是默认情况，但在某些情况下，您可能有非常强的先验理由，只将预测变量与您感兴趣的一个变量连接起来（例如，这是我们一些未观察到的变量的情况）。如果有疑问，我会谨慎一些，并包括这两种连接。
- en: In [Figure 4-12](#observable_variables_in_our_cdcomma_spl), the observable variables
    are split between categorical (on the left of the CD) and numeric (on the right
    of the CD). These two types of data call for different quantitative tools, so
    we’ll see them in turn.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [图 4-12](#observable_variables_in_our_cdcomma_spl) 中，可观察变量被分为分类（CD 左侧）和数字（CD
    右侧）。这两种数据类型需要不同的定量工具，因此我们将依次查看它们。
- en: Relationships Between Numeric Variables
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数字变量之间的关系
- en: Our first step will be to look at the correlation matrix for all the numeric
    variables in our data. A useful but dirty trick is to convert binary variables
    to 0/1 (if they’re not already in that format) so that you can treat them as numeric.
    It allows you to get a sense of the correlation between variables, but don’t tell
    your statistician friends!
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第一步将是查看数据中所有数字变量的相关矩阵。一个有用但不那么干净的技巧是将二元变量转换为 0/1（如果它们还没有以这种格式存在），这样你可以将它们视为数字变量。这使你能够了解变量之间的相关性，但不要告诉你的统计学朋友！
- en: Looking at the rows for your two variables of interest will allow you to see
    how correlated they are with all the numeric variables in your data set. At a
    glance, it will also show you any large correlation between these other variables.
    The strength of the correlation with the cause and effect of interest can then
    help us determine what to do with a given variable.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 查看你感兴趣的两个变量的行，可以让你看到它们与数据集中所有数值变量的相关性如何。一眼就能看到它还会显示出这些其他变量之间的任何大相关性。与感兴趣的因果相关性的强度可以帮助我们决定如何处理特定变量。
- en: How strong is strong? It depends. Remember that our goal is to correctly measure
    the causal effect of our cause of interest on our effect of interest; as a rule
    of thumb, you can consider as “strong” any correlation that is of the same order
    of magnitude (i.e., the same number of zeros between the comma and the first nonzero
    digit) as the correlation between your cause of interest and your effect of interest.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: “强有多强？”这取决于情况。记住我们的目标是正确测量我们感兴趣的原因对我们感兴趣的效果的因果效应；作为一个经验法则，你可以认为与你感兴趣的原因和效果之间具有相同数量级（即逗号后第一个非零数字之间的零个数）的任何相关性都是“强”的。
- en: As you can see in [Figure 4-13](#correlation_matrix_for_numeric_and_bina), the
    correlation coefficient between our two variables of interest is 0.16\. The first
    column indicates the correlations with *NRDeposit* and the second column the correlations
    with *IsCanceled*. *PreviousCancellation* has correlation coefficients with our
    variables of interest that are of the same order of magnitude (0.15 and 0.13,
    respectively). Similarly, *ADR* has a correlation coefficient with *IsCanceled*
    that is significant by that criterion (0.13).
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你在 [图 4-13](#correlation_matrix_for_numeric_and_bina) 中所看到的，我们感兴趣的两个变量之间的相关系数为
    0.16。第一列指示了与 *NRDeposit* 的相关性，第二列指示了与 *IsCanceled* 的相关性。*PreviousCancellation*
    与我们感兴趣的变量的相关系数相同数量级（分别为 0.15 和 0.13）。类似地，*ADR* 与 *IsCanceled* 的相关系数在该标准下是显著的（0.13）。
- en: The “order of magnitude” threshold for inclusion is not scientific in the least,
    and it can be tightened or loosened depending on how many variables you have at
    hand. If you have few variables passing the threshold and some other variables
    are close to it, it is perfectly fine to include them.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: “数量级”阈值的包含并不科学，可以根据手头变量的数量来调节松紧程度。如果少数变量通过了阈值而其他变量接近该阈值，那么包含它们是完全可以接受的。
- en: You may object that a variable could have a low correlation with either of our
    variables of interest but still be a confounder that needs to be accounted for.
    This is true, and you can include a variable even if it is only feebly correlated
    with our variables of interest, based on a strong theoretical rationale. However,
    for practical purposes, you should usually focus on variables having at least
    a moderate level of correlation with our variables of interest.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会反对说，一个变量与我们感兴趣的变量之一的相关性可能很低，但仍然是需要考虑的混杂因素。这是正确的，根据强有力的理论基础，即使与我们感兴趣的变量的相关性很弱，你也可以包含一个变量。然而，为了实际目的，通常应重点关注与我们感兴趣的变量至少具有中等相关水平的变量。
- en: '![Correlation matrix for numeric and binary variables](Images/BEDA_0413.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![数字和二进制变量的相关性矩阵](Images/BEDA_0413.png)'
- en: Figure 4-13\. Correlation matrix for numeric and binary variables
  id: totrans-122
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-13\. 数字和二进制变量的相关性矩阵
- en: If we include all the correlations that are 0.1 or above in absolute value in
    [Figure 4-13](#correlation_matrix_for_numeric_and_bina) and exclude the others,
    our CD is now as in [Figure 4-14](#cd_with_updated_arrows_for_the_numeric).
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在 [图 4-13](#correlation_matrix_for_numeric_and_bina) 中包括所有绝对值为 0.1 或以上的相关性，并排除其他相关性，那么我们的
    CD 现在就如同 [图 4-14](#cd_with_updated_arrows_for_the_numeric) 中所示。
- en: '![CD with updated arrows for the numeric and binary observable variables](Images/BEDA_0414.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![更新后的数字和二进制可观察变量的CD](Images/BEDA_0414.png)'
- en: Figure 4-14\. CD with updated arrows for the numeric and binary observable variables
  id: totrans-125
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-14\. CD，更新了数字和二进制可观察变量的箭头
- en: While the correlation matrix only gives us symmetrical coefficients that could
    represent arrows in either direction, I have used some common sense and business
    knowledge to assume the direction of the arrows. The hotel company has no mastery
    of time, so we can assume that *Years* is the cause and not the effect of variables
    it’s correlated with, although that effect may go through intermediary variables
    such as trends in society over time. *IsRepeatedGuest* is a prerequisite for *PreviousCancellation*;
    because it refers to a past event, it must also be the cause of *ADR* or they
    both share a common cause.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然相关矩阵只给出了对称系数，可以代表任何方向的箭头，但我运用了一些常识和业务知识来假设箭头的方向。酒店公司对时间没有掌控，所以我们可以假设*Years*是与它相关的变量的原因而不是结果，尽管这种影响可能通过中间变量（如随时间的社会趋势）传递。*IsRepeatedGuest*是*PreviousCancellation*的先决条件；因为它涉及过去事件，它也必须是*ADR*的原因或它们共享一个共同的原因。
- en: Note
  id: totrans-127
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'Don’t forget that this is a *tentative* CD:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 不要忘记这只是一个*暂时的*CD：
- en: Some of these correlations are likely false positives (the coefficient appears
    stronger than it really is, out of sheer randomness) and conversely, some of the
    smaller correlations may be false negatives.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些相关性中有一些可能是假阳性（系数看起来比实际强，纯粹是因为随机性），反之亦然，一些较小的相关性可能是假阴性。
- en: At this stage, we’re tentatively treating correlations as evidence of causation.
    Some of the arrows we’ve drawn in [Figure 4-14](#cd_with_updated_arrows_for_the_numeric)
    may themselves reflect relationships that are confounded. After adequately measuring
    the relationship between *NRDeposit* and *IsCanceled*, we may want or need to
    do the same for other relationships (e.g., the one between *IsRepeatedGuest* and
    *ADR*).
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在这个阶段，我们暂时将相关性视为因果关系的证据。我们在[图 4-14](#cd_with_updated_arrows_for_the_numeric)中画的一些箭头本身可能反映了混杂关系。在充分衡量*NRDeposit*与*IsCanceled*之间的关系之后，我们可能希望或需要对其他关系（例如*IsRepeatedGuest*和*ADR*之间的关系）做同样的事情。
- en: Relationships Between Categorical Variables
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分类变量之间的关系
- en: 'The same logic applies for categorical variables, with the only complication
    that we can’t use Pearson’s correlation coefficient. However, a variant of it,
    [Cramer’s V](https://oreil.ly/KAoIa), has been developed for categorical variables.
    In R, it is implemented in the `rcompanion` package:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 对于分类变量，同样的逻辑适用，唯一的复杂之处在于我们不能使用皮尔逊相关系数。然而，已经为分类变量开发了一个变体，[克莱默V](https://oreil.ly/KAoIa)。在R中，它是在`rcompanion`包中实现的：
- en: '[PRE4]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'You can see that in the case of binary variables, it yields a result that is
    quite close to the direct application of Pearson’s correlation coefficient. Unfortunately,
    it is not implemented in Python, but I provide a function to calculate it:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到，在二元变量的情况下，它产生的结果与直接应用皮尔逊相关系数的结果非常接近。不幸的是，它在Python中没有实现，但我提供了一个计算它的函数：
- en: '[PRE5]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[Figure 4-15](#correlation_matrix_for_categorical_and) shows the corresponding
    correlation matrix.'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-15](#correlation_matrix_for_categorical_and)显示了相应的相关矩阵。'
- en: This correlation yields a variety of insights. Looking at the bottom row, we
    can see that *Quarter* is not meaningfully correlated with anything else. This
    suggests that seasonality is not a relevant factor for our analysis. Conversely,
    it is possible that a quarter is too coarse a unit of time and that we need to
    zoom in on very specific time periods such as the Christmas holidays. We can drop
    *Quarter* from our CD and replace it with an unobserved variable *Seasonality*
    as a cue for future research.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这种相关性产生了多种见解。查看底部行，我们可以看到*Quarter*与其他任何东西都没有明显相关性。这表明季节性对我们的分析不是一个相关因素。相反，可能一个季度作为时间单位太粗略，我们需要放大到特定的时间段，如圣诞节假期。我们可以从我们的CD中删除*Quarter*，并用一个未观察到的变量*Seasonality*替换它，作为未来研究的线索。
- en: 'Our three variables for customer segments, *CustomerType*, *MarketSegment,*
    and *DistributionChannel,* show a mixed pattern, with some very strong and some
    weak correlations between them. Similarly, their correlations with other variables
    are all over the place: all three of them have correlations with *Country* in
    the 0.1X digits for example, but two of them have high correlations with *RepeatedGuest*
    (0.35 and 0.4) whereas the third one has a correlation of only 0.11\. This suggests
    that these variables are not just interchangeable, but that they are capturing
    some aspects of the same behaviors. This calls for further investigation and most
    likely creating new variables.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的三个客户段变量 *CustomerType*、*MarketSegment* 和 *DistributionChannel* 显示出混合模式，它们之间有些非常强的和一些弱的相关性。同样，它们与其他变量的相关性也参差不齐：例如，这三个变量中的每一个与
    *Country* 的相关性都在 0.1X 数字范围内，但其中两个与 *RepeatedGuest* 的相关性较高（0.35 和 0.4），而第三个的相关性仅为
    0.11。这表明这些变量不仅可以互换，而且它们捕捉了相同行为的某些方面。这需要进一步调查，并很可能创建新的变量。
- en: '![Correlation matrix for categorical and binary variables](Images/BEDA_0415.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![用于分类和二进制变量的相关矩阵](Images/BEDA_0415.png)'
- en: Figure 4-15\. Correlation matrix for categorical and binary variables
  id: totrans-140
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-15\. 用于分类和二进制变量的相关矩阵
- en: Applying these insights and the same criterion of including only correlations
    above 0.1, our CD now looks like [Figure 4-16](#cd_with_updated_arrows_for_the_categori).
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 应用这些见解和仅包含大于 0.1 的相关性的相同标准后，我们的 CD 现在看起来像是 [Figure 4-16](#cd_with_updated_arrows_for_the_categori)。
- en: '![CD with updated arrows for the categorical and binary observable variables](Images/BEDA_0416.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![用于分类和二进制可观察变量的更新箭头的CD](Images/BEDA_0416.png)'
- en: Figure 4-16\. CD with updated arrows for the categorical and binary observable
    variables
  id: totrans-143
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-16\. 用于分类和二进制可观察变量的更新箭头的CD
- en: 'Our CD is starting to get moderately complex, but it can for the most part
    be summarized in a few behavioral arguments:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的 CD 开始变得适度复杂，但大部分可以通过几个行为参数来总结：
- en: 'Our four variables on the left reflect personal characteristics and they are
    significantly correlated with each other. I have chosen to reflect these correlations
    with double-headed arrows because trying to determine the direction of arrows
    would be pointless: *CustomerType* doesn’t cause *MarketSegment* any more than
    the other way around. In reality, after doing the necessary interviews, we should
    create new variables that capture the deeper personal characteristics at play.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 左侧的四个变量反映个人特征，它们彼此之间显著相关。我选择用双向箭头来反映这些相关性，因为试图确定箭头的方向是毫无意义的：*CustomerType* 不会比
    *MarketSegment* 更多地导致另一种情况发生。实际上，在进行必要的访谈后，我们应该创建捕捉更深层次个人特征的新变量。
- en: Personal characteristics appear to affect our variables of interest, potentially
    causing some confounding.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 个人特征似乎会影响我们感兴趣的变量，可能导致一些混杂。
- en: Personal characteristics appear to have affected past behaviors *IsRepeatedGuest*
    and *PreviousCancellation.* (Again, I’m making assumptions on the direction of
    the effects based on business knowledge. On the face of it, it seems unlikely
    that having canceled a previous reservation would make someone change country
    or market segment.) Once we have clarified the nature of the deeper personal characteristics
    at play, we may decide to fold these past behaviors under some personal characteristics
    variables, implicitly creating behavioral personas (e.g., “recurring business
    traveler (Y/N)”).
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 个人特征似乎影响了过去的行为 *IsRepeatedGuest* 和 *PreviousCancellation*。（同样，我基于业务知识对效果的方向做出假设。乍看之下，取消先前预订是否会导致某人改变国家或市场细分似乎不太可能。）一旦我们澄清了发挥作用的更深层个人特征的性质，我们可能决定将这些过去的行为纳入某些个人特征变量之下，隐式地创建行为人物（例如，“经常出差的商旅者（Y/N）”）。
- en: Relationships Between Numeric and Categorical Variables
  id: totrans-148
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数值和分类变量之间的关系
- en: Measuring correlations between numeric and categorical variables is a more cumbersome
    process than measuring correlations within a homogenous category.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 测量数值和分类变量之间的相关性比在同质类别内测量相关性更加繁琐。
- en: 'Saying that there is a correlation between a numeric and a categorical variable
    is equivalent to saying that the values of the numeric variable are different
    on average across the categories of the categorical variable. We can check if
    this is the case by comparing the mean of the numeric variable across the categories
    of the categorical variable. For example, we expect that the financial characteristics
    of the customer may impact the average daily rate for the reservation. It would
    be best to explore that relationship after having built better variables for customer
    segmentation, but for the sake of the argument we can use *CustomerType*:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 说数值变量与分类变量之间存在相关性等同于说数值变量在分类变量的各类别间平均值不同。我们可以通过比较数值变量在分类变量的各类别间的平均值来检查是否如此。例如，我们预计客户的财务特征可能会影响预订的平均每日费率。最好在构建更好的客户分割变量之后再探索这种关系，但为了论证的目的，我们可以使用*CustomerType*：
- en: '[PRE6]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We can see that the average daily rate varies substantially between customer
    types.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，平均每日费率在不同客户类型之间有显著变化。
- en: Note
  id: totrans-154
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: If you’re unsure whether the variations are truly substantial or if they only
    reflect random sampling errors, you can build confidence intervals for them using
    the Bootstrap, as explained later in [Chapter 7](ch07.xhtml#measuring_uncertainty_with_the_bootstra).
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不确定这些变化是否真正显著，或者它们只是反映了随机抽样误差，你可以使用Bootstrap为它们建立置信区间，如后文在[第7章](ch07.xhtml#measuring_uncertainty_with_the_bootstra)中解释的那样。
- en: 'In our example, there are two numeric variables whose correlation with categorical
    variables we may want to check: *ADR* and *Year*. We find that *ADR* varies substantially
    across customer types but that these are reasonably stable over time, which brings
    us to our final CD for observable variables ([Figure 4-17](#final_cd_for_observable_variables)).'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，有两个数值变量，我们可能想要检查它们与分类变量的相关性：*ADR*和*Year*。我们发现*ADR*在不同客户类型之间有显著变化，但这些变化在时间上相对稳定，这就导致了我们的最终可观测变量的CD（[图 4-17](#final_cd_for_observable_variables)）。
- en: 'At this point, I’d like to reiterate and expand on my earlier warning: in the
    process of validating observable variables, I have implicitly assumed that correlation
    was causation. But maybe these relationships are themselves confounded: the correlation
    between personal characteristics variables and *PreviousCancellation* might be
    entirely caused by the relationship between personal characteristics variables
    and *IsRepeatedGuest*.'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，我想重申并扩展我早些时候的警告：在验证可观测变量时，我已经默认假设相关性等于因果关系。但也许这些关系本身是混杂的：个人特征变量与*PreviousCancellation*之间的相关性可能完全是由个人特征变量与*IsRepeatedGuest*之间的关系造成的。
- en: '![Final CD for observable variables](Images/BEDA_0417.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![可观测变量的最终CD](Images/BEDA_0417.png)'
- en: Figure 4-17\. Final CD for observable variables
  id: totrans-159
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-17. 可观测变量的最终CD
- en: Let’s imagine for instance that business customers are more likely to be repeated
    guests. They may then also appear to have a higher rate of previous cancellation
    than leisure customers even though among repeated guests, business and leisure
    customers have the exact same rate of previous cancellations.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 举例来说，假设商务客户更有可能是重复客户。因此，他们看起来也可能比休闲客户有更高的取消率，即使在重复客户中，商务客户和休闲客户的取消率完全相同。
- en: 'You can think of these causality assumptions as white lies: they’re not true,
    but it’s OK, because we’re not trying to build the true, complete CD, we’re trying
    to deconfound the relationship between NRD and cancellation rate. From that perspective,
    it is *much* more important to get the direction of arrows right than to have
    unconfounded relationships between variables outside of our variables of interest.
    If you’re still skeptical, one of the exercises in the next chapter explores this
    question further.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以把这些因果假设看作是善意的谎言：它们并非真实，但没关系，因为我们并不试图构建真实完整的CD，我们只是试图解开**NRD**与取消率之间的关系。从这个角度来看，把箭头的方向搞对比有关联变量的不相关关系*重要得多。如果你仍然持怀疑态度，下一章的一个练习将进一步探讨这个问题。
- en: Expand Causal Diagram Iteratively
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 逐步扩展因果图
- en: After confirming or disproving relationships between observable variables based
    on data, we have a tentatively complete CD ([Figure 4-18](#tentatively_complete_cd_with_observable)).
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在确认或否定基于数据的可观测变量之间的关系之后，我们得到了一个初步完整的CD（[图 4-18](#tentatively_complete_cd_with_observable)）。
- en: '![Tentatively complete CD with observable and unobservable variables, grouping
    personal characteristics variables under one heading for readability](Images/BEDA_0418.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![暂时完成的CD，包括可观察和不可观察的变量，在可读性上将个人特征变量分组到一个标题下](Images/BEDA_0418.png)'
- en: Figure 4-18\. Tentatively complete CD with observable and unobservable variables,
    grouping personal characteristics variables under one heading for readability
  id: totrans-165
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-18\. 暂时完成的CD，包括可观察和不可观察的变量，在可读性上将个人特征变量分组到一个标题下
- en: From there, we’ll expand our CD iteratively by identifying proxies for unobserved
    variables and identifying further causes of the current variables.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里开始，我们将通过识别未观察到的变量的代理，以及进一步识别当前变量的原因，来迭代地扩展我们的CD。
- en: Identify Proxies for Unobserved Variables
  id: totrans-167
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 识别未观察到的变量的代理
- en: Unobserved variables represent a challenge, because even if they are confirmed
    through interviews or UX research, they can’t be accounted for directly in the
    regression analysis.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 未观察到的变量代表一种挑战，因为即使通过访谈或UX研究确认了它们，也不能直接在回归分析中考虑它们。
- en: We can still try to mitigate them somewhat by identifying potential proxies
    through interviews and research. For example, we may find that conscientiousness
    is indeed correlated with a lower rate of cancellation, but also with requesting
    a confirmation email ([Figure 4-19](#identifying_proxies_for_unobserved_vari)).
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 我们仍然可以通过访谈和研究来尝试在一定程度上减轻它们。例如，我们可能会发现，责任心确实与取消率较低相关，但同时也与请求确认电子邮件相关（[图4-19](#identifying_proxies_for_unobserved_vari)）。
- en: '![Identifying proxies for unobserved variables](Images/BEDA_0419.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![识别未观察到的变量的代理](Images/BEDA_0419.png)'
- en: Figure 4-19\. Identifying proxies for unobserved variables
  id: totrans-171
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-19\. 识别未观察到的变量的代理
- en: Of course, requesting a confirmation email is not caused only by conscientiousness—it
    may also reflect the seriousness of the intent, lack of ease with digital channels,
    etc. And conversely, it may reduce the cancellation rate by itself, by providing
    easily accessible information on the reservation. Regardless, if we find that
    this behavior is negatively correlated with cancellation rate, we may leverage
    that insight by, for example, sending an SMS reminder to customers who didn’t
    choose to receive a confirmation email.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，请求确认电子邮件并不仅仅是由责任心引起的——它也可能反映出意图的严肃性，对数字渠道的不熟悉等等。反过来，它可能通过提供有关预订的易于获取的信息而单独降低取消率。无论如何，如果我们发现这种行为与取消率呈负相关，我们可以利用这一洞察，例如向没有选择接收确认电子邮件的客户发送短信提醒。
- en: By brainstorming and validating through research potential proxies for unobserved
    variables, we’re providing meaningful connections between observable variables.
    Knowing that *RequestedConfirmation* is connected with *IsCanceled* through *Conscientiousness*
    provides a behavioral rationale for what would otherwise be a raw statistical
    regularity.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 通过头脑风暴和通过研究验证潜在未观察到的变量的代理，我们为可观察变量之间提供了有意义的连接。知道*RequestedConfirmation*通过*Conscientiousness*与*IsCanceled*相连接，为否则将是原始统计规律的行为基础提供了理由。
- en: Identify Further Causes
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 识别进一步的原因
- en: We’ll also expand our CD by identifying causes of the “outer” variables in our
    CD, i.e., the variables that currently don’t have any parent in our CD. In particular,
    when we have a variable *A* that affects our cause of interest (possibly indirectly)
    but not our effect of interest, and another variable *B* that conversely affects
    our effect of interest but not our cause of interest, any joint cause of *A* and
    *B* introduces confounding in our CD, because that joint cause is also a joint
    cause of our two variables of interest.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还将通过识别“外部”变量的原因来扩展我们的CD，即当前在我们的CD中没有任何父变量的变量。特别是，当我们有一个影响我们感兴趣的原因（可能间接影响）但不影响我们感兴趣的效果的变量*A*，以及另一个相反地影响我们感兴趣的效果但不影响我们感兴趣的原因的变量*B*时，*A*和*B*的任何联合原因会在我们的CD中引入混淆，因为该联合原因也是我们两个感兴趣变量的联合原因。
- en: In our example, the only observable variable without any parent (observable
    or not) is *Year*, and obviously it can’t have one (apart maybe from the laws
    of physics?), so this step doesn’t apply.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，唯一没有任何父变量（可观察或不可观察）的可观察变量是*Year*，显然它不能有一个（除了可能是物理定律？），所以这一步不适用。
- en: Iterate
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 迭代
- en: As you introduce new variables, you create new opportunities for proxies and
    further causes. For example, our newly introduced *RequestedConfirmation* may
    be affected by *Conscientiousness* but also by *TripReason*. This means you should
    continue to expand your CD until it appears to account for all the relevant variables
    that you can think of and their interconnections.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 当您引入新变量时，您将为代理和进一步的原因创造新的机会。例如，我们新引入的*RequestedConfirmation*可能会受到*Conscientiousness*和*TripReason*的影响。这意味着您应继续扩展您的CD，直到看起来能够涵盖您能想到的所有相关变量及其相互关系。
- en: 'There are however significant decreasing returns to this process: as you expand
    your CD “outward,” the newly added variables will tend to have smaller and smaller
    correlations with your variables of interest, because of all the noise along the
    way. This means that accounting for them will deconfound your relationship of
    interest in smaller and smaller quantities.'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这一过程存在显著的递减回报：随着您将CD“向外扩展”，新添加的变量往往与您感兴趣的变量之间的相关性越来越小，因为沿途的噪声太多。这意味着考虑它们将逐渐解除您感兴趣的关系。
- en: Simplify Causal Diagram
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简化因果图
- en: 'The final step once you’ve decided to stop iteratively expanding the CD is
    to simplify it. Indeed, you now have a diagram that is hopefully accurate and
    complete for practical purposes, but it might not be structured in the way that
    would be most helpful to meet the needs of the business. Therefore I would recommend
    the following simplification steps:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦决定停止迭代扩展CD，最终步骤就是对其进行简化。事实上，您现在有一个希望准确而完整的图表，用于实际目的，但可能结构不一定最有助于满足业务需求。因此，我建议进行以下简化步骤：
- en: Collapse chains when the intermediary variables are not of interest or are unobserved.
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当中间变量不重要或未被观察时，请折叠链条。
- en: Expand chains when you need to find observed variables or if you want to track
    the way another variable relates to the diagram.
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当您需要查找观察变量或想要跟踪另一个变量与图表的关系方式时，请扩展链条。
- en: Slice variables when you think the individual variables would contain interesting
    information (e.g., the correlation with one of your variables of interest is really
    driven by only one slice in particular).
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当您认为单个变量会包含有趣信息时（例如，与您感兴趣的变量的相关性主要由特定切片驱动），请切片变量。
- en: Combine variables for clarity when reading the diagram or when variation between
    types does not matter.
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结合变量以增强图表的可读性或当不同类型之间的变化并不重要时。
- en: Break cycles wherever you find them by introducing intermediary steps or identifying
    the aspect of the relationship that is important.
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当您发现循环时，请通过引入中间步骤或确定重要关系的方面来打破它们。
- en: In our example, we may decide that *IsRepeatedGuest*, *Children,* and *Year*
    do not add value beyond what is captured through *PreviousCancellation* and *ADR*.
    Indeed, we can dispense with these three variables because they can’t confound
    our relationship of interest ([Figure 4-20](#final_cd_after_simplification)).
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的示例中，我们可能会决定*IsRepeatedGuest*、*Children*和*Year*并未提供比*PreviousCancellation*和*ADR*更多的价值。事实上，我们可以放弃这三个变量，因为它们不会混淆我们感兴趣的关系（[图 4-20](#final_cd_after_simplification)）。
- en: '![Final CD after simplification](Images/BEDA_0420.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![简化后的最终CD](Images/BEDA_0420.png)'
- en: Figure 4-20\. Final CD after simplification
  id: totrans-189
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-20\. 简化后的最终CD
- en: You should be left with a clean and (somewhat!) readable diagram, although it
    might be somewhat larger than those we have seen so far.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该得到一个干净且（在某种程度上！）可读的图表，尽管它可能比我们迄今见过的图表要大一些。
- en: If this process seems long and somewhat tedious, that’s because it is. Understanding
    your business very well is the price to pay to be able to draw causal inferences
    on customer (or employee) behavior that are at least somewhat valid when you are
    not able to run experiments.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这一过程看起来很长而有些乏味，那是因为它确实如此。深入了解您的业务非常重要，这是能够在无法进行实验时进行客户（或员工）行为因果推断的代价。
- en: Fortunately, this process is extremely cumulative and transferable. Once you’ve
    done it for a certain analysis, your knowledge of the causal relationships that
    matter for your business can be reused for another analysis. Even if you don’t
    go very deep the first time you go through this process, you can just focus on
    one category of confounders and causes; the next time you run this analysis or
    a similar one, you can pick up where you left and do a deeper dive on another
    category, maybe interviewing customers about a different aspect of their experience.
    Similarly, once someone has gone through the process, a new team member or employee
    can very easily and quickly acquire the corresponding knowledge and pick up where
    they left off by looking at the resulting CD or even just the list of relevant
    variables to keep in mind.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，这个过程是非常累积和可转移的。一旦您为某项分析完成了这个过程，您对于对您业务重要的因果关系的认识就可以被重用于另一个分析。即使您第一次进行这个过程时不深入，您也可以只专注于一类混杂因素和原因；下一次您运行这个分析或类似的分析时，您可以从离开的地方继续，并对另一类进行更深入的挖掘，也许是关于客户体验的不同方面进行访谈。同样，一旦有人经历了这个过程，新的团队成员或员工可以非常容易和快速地获得相应的知识，并通过查看结果CD甚至只是记住要牢记的相关变量列表继续工作。
- en: Conclusion
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: 'To use the cliche phrase, building a CD is an art and a science. I have done
    my best to provide as clear a recipe as possible to do so:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 用陈词滥调的话来说，构建CD是一门艺术和一门科学。我已尽力提供尽可能清晰的配方来实现这一点：
- en: Start with the relationship that you’re trying to measure.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从您试图衡量的关系开始。
- en: Identify candidate variables to include. Namely, use your behavioral science
    knowledge and business expertise to identify variables that are likely affecting
    either of your variables of interest.
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定要包括的候选变量。也就是说，利用您的行为科学知识和业务专业知识来识别可能会影响您感兴趣的任一变量的变量。
- en: Confirm which observable variables to include based on their correlations in
    the data.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据数据中的相关性确认要包括哪些可观察变量。
- en: Iteratively expand your CD by adding proxies for unobserved variables where
    possible and adding further causes of the variables included so far.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过不断添加可能的未观察变量的代理以及进一步增加到目前为止已包含的变量的进一步原因，逐步扩展您的CD。
- en: Finally, simplify your CD by removing irrelevant relationships and variables.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，通过删除无关的关系和变量来简化您的CD。
- en: 'As you do so, always keep in mind your ultimate goal: measuring the causal
    impact of your cause of interest on your effect of interest. We’ll see in the
    next chapter how to use a CD to remove confounding in your analysis and obtain
    an unbiased estimate for that impact. Thus, the best CD is the one that allows
    you to make the best use of the data you currently have available and that drives
    fruitful further research.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在这样做的过程中，始终牢记您的最终目标：衡量您感兴趣的原因对您感兴趣的效果的因果影响。我们将在下一章中看到如何使用CD来消除分析中的混杂因素，并获得对该影响的无偏估计。因此，最好的CD是那种能让您充分利用当前可用数据并推动有益的进一步研究的CD。
- en: ^([1](ch04.xhtml#ch01fn8-marker)) Nuno Antonio, Ana de Almeida, and Luis Nunes,
    “Hotel booking demand data sets,” *Data in Brief*, 2019\. [*https://doi.org/10.1016/j.dib.2018.11.126*](https://doi.org/10.1016/j.dib.2018.11.126)
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: ^([1](ch04.xhtml#ch01fn8-marker)) Nuno Antonio, Ana de Almeida, 和 Luis Nunes,
    “Hotel booking demand data sets,” *Data in Brief*, 2019\. [*https://doi.org/10.1016/j.dib.2018.11.126*](https://doi.org/10.1016/j.dib.2018.11.126)
- en: ^([2](ch04.xhtml#ch01fn9-marker)) This colorful label was popularized by behavioral
    scientist Daniel Kahneman.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: ^([2](ch04.xhtml#ch01fn9-marker)) 这个色彩缤纷的标签是行为科学家丹尼尔·卡内曼推广的。
- en: '^([3](ch04.xhtml#idm45968166298152-marker)) Think about it: how would the rule
    be implemented otherwise?'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: ^([3](ch04.xhtml#idm45968166298152-marker)) 想一想：否则规则会如何实施？
