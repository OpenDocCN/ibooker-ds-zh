- en: Chapter 10\. Exploratory Data Analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章。探索性数据分析
- en: 'More than 50 years ago, John Tukey avidly promoted an alternative type of data
    analysis that broke from the formal world of confidence intervals, hypothesis
    tests, and modeling. Today Tukey’s [*exploratory data analysis*](https://oreil.ly/Himzi)
    (EDA) is widely practiced. Tukey [describes EDA](https://oreil.ly/UO9F8) as a
    philosophical approach to working with data:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 50多年前，John Tukey热情推广了一种与置信区间、假设检验和建模的正式世界不同的数据分析方法。今天，Tukey的[*探索性数据分析*](https://oreil.ly/Himzi)（EDA）被广泛应用。Tukey
    [描述EDA](https://oreil.ly/UO9F8)为处理数据的哲学方法：
- en: Exploratory data analysis is actively incisive, rather than passively descriptive,
    with real emphasis on the discovery of the unexpected.
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 探索性数据分析是积极的，而不是被动的描述，真正强调发现意外的重要性。
- en: As a data scientist, you will want to use EDA in every stage of the data lifecycle,
    from checking the quality of your data to preparing for formal modeling to confirming
    that your model is reasonable. Indeed, the work described in [Chapter 9](ch09.html#ch-wrangling)
    to clean and transform the data relied heavily on EDA to guide our quality checks
    and transformations.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一名数据科学家，您将希望在数据生命周期的每个阶段中使用EDA，从检查数据质量到准备形式建模，再到确认您的模型是否合理。确实，在描述的工作中[第9章](ch09.html#ch-wrangling)清理和转换数据过程中，EDA在指导我们的质量检查和转换中起到了重要作用。
- en: In EDA, we enter a process of discovery, continually asking questions and diving
    into uncharted territory to explore ideas. We use plots to uncover features of
    the data, examine distributions of values, and reveal relationships that cannot
    be detected from simple numerical summaries. This exploration involves transforming,
    visualizing, and summarizing data to build and confirm our understanding, identify
    and address potential issues with the data, and inform subsequent analysis.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在EDA中，我们进入一个发现的过程，不断提出问题，深入探讨未知领域来探索想法。我们使用图表来揭示数据的特征，检查值的分布，并揭示不能从简单的数值摘要中检测到的关系。这种探索包括转换、可视化和总结数据，以建立和确认我们的理解，识别和解决数据可能存在的问题，并为随后的分析提供信息。
- en: EDA is fun! But it takes practice. One of the best ways to learn how to carry
    out EDA is to learn from others as they describe their thought process while they
    explore data, and we attempt to reveal EDA thinking in our examples and case studies
    in this book.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: EDA很有趣！但需要实践。学习如何进行EDA的最佳方法之一是从他人那里学习，因为他们描述他们在探索数据时的思维过程，我们在本书的例子和案例研究中试图揭示EDA思维。
- en: EDA can provide valuable insights, but you need to be cautious about the conclusions
    that you draw. It is important to recognize that EDA can bias your analysis. EDA
    is a winnowing process and a decision-making process that can impact the replicability
    of your later, model-based findings. With enough data and if you look hard, you
    often can dredge up something interesting that is entirely spurious.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: EDA（探索性数据分析）可以提供宝贵的见解，但您需要谨慎对待您所得出的结论。重要的是要认识到，EDA可能会影响您分析的偏见。EDA是一个筛选过程和决策过程，可能会影响您后续基于模型的发现的可复制性。有足够的数据，如果您仔细观察，通常可以挖掘出一些完全虚假的有趣内容。
- en: 'The role of EDA in the scientific reproducibility crisis has been noted, and
    data scientists have cautioned against overdoing it. For example, [Gelman and
    Loken](https://doi.org/10.1511/2014.111.460) note:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: EDA在科学可重复性危机中的角色已被注意到，数据科学家已经警告不要过度使用它。例如，[Gelman 和 Loken](https://doi.org/10.1511/2014.111.460)指出：
- en: Even in settings where a single analysis has been carried out on the given data,
    the issue of multiple comparisons [data dredging] emerges because different choices
    about combining variables, inclusion and exclusion of cases, transformations of
    variables, tests for interactions in the absence of main effects, and many other
    steps in the analysis could well have occurred with different data.
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 即使在已对给定数据进行了单一分析的情况下，多重比较[数据挖掘]的问题也会出现，因为对变量组合、案例包含和排除、变量转换、在没有主效应的情况下进行交互测试以及分析中的许多其他步骤的不同选择都可能与不同的数据发生。
- en: It’s a good practice to report and provide the code from your EDA so that others
    are aware of the choices you made and the paths you took in learning about your
    data.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 最佳实践是报告并提供您的EDA代码，以便他人了解您所做的选择和您在了解数据过程中采取的路径。
- en: The topic of visualization is split across three chapters. In [Chapter 9](ch09.html#ch-wrangling),
    we used plots to inform us in our data wrangling. The plots there were basic and
    the findings straightforward. We didn’t dwell on interpretations and choices of
    plots. In this chapter, we spend more time learning how to choose the right plot
    and interpret it. We usually take the default parameter settings of the plotting
    functions since our goal is to make plots quickly as we carry out EDA. In [Chapter 11](ch11.html#ch-viz),
    we’ll provide guidelines for making effective and informative plots and give advice
    on how to make our visual argument clear and compelling.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 关于可视化的主题分布在三章之间。在[第9章](ch09.html#ch-wrangling)中，我们使用图表来辅助我们进行数据整理。那里的图表很基础，发现也很直接。我们没有深入探讨解释和选择图表的问题。在本章中，我们将花更多时间学习如何选择合适的图表并进行解释。由于我们的目标是在执行探索性数据分析时快速生成图表，通常采用绘图函数的默认参数设置。在[第11章](ch11.html#ch-viz)，我们将提供制作有效和信息丰富的图表的指南，并提供建议，说明如何使我们的视觉论证清晰和令人信服。
- en: 'According to [Tukey](https://oreil.ly/AIWW5), visualization is central to EDA:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 根据[Tukey](https://oreil.ly/AIWW5)，可视化在探索性数据分析中是核心：
- en: The greatest gains from data come from surprises… The unexpected is best brought
    to our attention by pictures.
  id: totrans-12
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 数据中最大的收益来自于惊喜……意外的情况最好通过图片来引起我们的注意。
- en: To make these pictures, we need to choose an appropriate type of plot, and our
    choice depends on the kinds of data that have been collected. This mapping between
    feature type and plot choice is the topic of the next section. From there, we
    go on to describe how to “read” a plot, what to look for, and how to interpret
    what you see. We first discuss what to look for in a one-feature plot, then focus
    on reading relationships between two features, and finally describe plots for
    three or more features. After we have introduced the visualization tools for EDA,
    we provide guidelines for carrying out an EDA and then walk through an example
    as we follow these guidelines.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 要制作这些图片，我们需要选择适当类型的图表，我们的选择取决于已收集的数据类型。特征类型与图表选择之间的映射是下一节的主题。然后，我们详细描述如何“读取”图表，要查找的内容以及如何解释所见内容。我们首先讨论单特征图表要查找的内容，然后关注两个特征之间的关系，最后描述三个或更多特征的图表。在介绍了探索性数据分析的可视化工具后，我们提供了执行探索性数据分析的指南，并按照这些指南的步骤进行示例演练。
- en: Feature Types
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 特征类型
- en: 'Before making an exploratory plot, or any plot for that matter, it’s a good
    idea to examine the feature (or features) and decide on its *feature type*. (Sometimes
    we refer to a feature as a *variable* and its type as *variable type*.) Although
    there are multiple ways of categorizing feature types, in this book we consider
    three basic ones. Ordinal and nominal data are subtypes of *categorical* data.
    Another name for categorical data is *qualitative*. In contrast, we also have
    *quantitative* features:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在制作探索性图表或任何图表之前，检查特征（或特征），并确定其*特征类型*是个好主意。（有时我们将特征称为*变量*，其类型称为*变量类型*。）尽管有多种分类特征类型的方法，在本书中，我们考虑三种基本类型。有序和名义数据是*分类*数据的子类型。分类数据的另一个名称是*定性*。相反，我们还有*定量*特征：
- en: '*Nominal*'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '*名义*'
- en: A feature that represents “named” categories, where the categories do not have
    a natural ordering, is called nominal. Examples include political party affiliation
    (Democrat, Republican, Green, other); dog type (herding, hound, non-sporting,
    sporting, terrier, toy, working); and computer operating system (Windows, macOS,
    Linux).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 代表“命名”类别的特征，其中类别没有自然顺序，称为名义。例如政党隶属（民主党、共和党、绿党、其他）、狗的类型（牧群、猎犬、非体育、体育、梗类、玩具、工作类）和计算机操作系统（Windows、macOS、Linux）。
- en: '*Ordinal*'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '*有序*'
- en: Measurements that represent ordered categories are called ordinal. Examples
    of ordinal features are T-shirt size (small, medium, large), Likert-scale response
    (disagree, neutral, agree), and level of education (high school, college, graduate
    school). It is important to note that with an ordinal feature, the difference
    between, say, small and medium need not be the same as the difference between
    medium and large. Also, the differences between consecutive categories may not
    even be quantifiable. Think of the number of stars in a restaurant review and
    what one star means in comparison to two stars.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 表示有序类别的测量称为有序测量。有序特征的例子包括 T 恤尺寸（小号、中号、大号）、Likert 量表响应（不同意、中立、同意）和教育水平（高中、大学、研究生院）。重要的是要注意，对于有序特征，例如小号和中号之间的差异不一定等同于中号和大号之间的差异。此外，连续类别之间的差异可能甚至无法量化。考虑餐厅评论中的星级数量及一颗星的含义与两颗星之间的含义。
- en: '*Quantitative*'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '*定量*'
- en: Data that represent numeric measurements or quantities are called quantitative.
    Examples include height measured to the nearest cm, price reported in USD, and
    distance measured to the nearest km. Quantitative features can be further divided
    into *discrete*, meaning that only a few values of the feature are possible, and
    *continuous*, meaning that the quantity could in principle be measured to arbitrary
    precision. The number of siblings in a family takes on a discrete set of values
    (such as 0, 1, 2, …, 8). In contrast, height can theoretically be reported to
    any number of decimal places, so we consider it continuous. There is no hard and
    fast rule to determine whether a quantity is discrete or continuous. In some cases,
    it can be a judgment call, and in others, we may want to purposefully consider
    a continuous feature to be discrete.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 代表数值测量或数量的数据被称为定量数据。例如，以厘米为单位测量的身高，以美元报告的价格和以公里为单位测量的距离。定量特征可以进一步分为*离散*，意味着特征只能有几个可能值，以及*连续*，意味着理论上数量可以测量到任意精度。家庭中兄弟姐妹的数量采用离散的值集（例如
    0, 1, 2, …, 8）。相比之下，身高理论上可以报告到任意数量的小数位数，因此我们认为它是连续的。确定数量是离散还是连续没有硬性规定。在某些情况下，这可能是一种判断，而在其他情况下，我们可能希望有意将连续特征视为离散特征。
- en: A feature type is not the same thing as a data storage type. Each column in
    a `pandas` `DataFrame` has its own *storage type*. These types can be integer,
    floating point, boolean, date-time format, category, and object (strings of varying
    length are stored as objects in Python with pointers to the strings). We use the
    term *feature type* to refer to a conceptual notion of the information and the
    term *storage type* to refer to the representation of the information in the computer.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 特征类型与数据存储类型不同。`pandas` 的每一列 `DataFrame` 都有自己的*存储类型*。这些类型可以是整数、浮点数、布尔值、日期时间格式、类别和对象（Python
    中以指向字符串的指针存储可变长度的字符串）。我们使用术语*特征类型*来指代信息的概念性概念，使用术语*存储类型*来指代计算机中信息的表示。
- en: A feature stored as an integer can represent nominal data, strings can be quantitative
    (like `"\$100.00"`), and, in practice, boolean values often represent nominal
    features that have only two possible values.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 一个以整数存储的特征可以代表名义数据，字符串可以是定量的（比如 `"\$100.00"`），在实践中，布尔值通常表示只有两种可能值的名义特征。
- en: Note
  id: totrans-24
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: '`pandas` calls the storage type `dtype`, which is short for data type. We refrain
    from using the term *data type* here because it can be confused with both storage
    type and feature type.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '`pandas` 将存储类型称为 `dtype`，这是数据类型的简称。我们在这里避免使用 *数据类型* 这个术语，因为它可能会与存储类型和特征类型混淆。'
- en: In order to determine a feature type, we often need to consult a dataset’s *data
    dictionary* or *codebook*. A data dictionary is a document included with the data
    that describes what each column in the data table represents. In the following
    example, we take a look at the storage and feature types of the columns in a dataframe
    about various dog breeds, and we find that the storage type is often not a good
    indicator of the kind of information contained in a field.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确定特征类型，我们经常需要查阅数据集的*数据字典*或*代码簿*。数据字典是与数据一起包含的文件，描述了数据表中每一列代表的内容。在以下示例中，我们查看了关于各种狗品种的数据框的列的存储和特征类型，并且发现存储类型通常不能很好地指示字段中包含的信息类型。
- en: 'Example: Dog Breeds'
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 示例：狗品种
- en: We use the [American Kennel Club (AKC)](https://www.akc.org) data on registered
    dog breeds to introduce the various concepts related to EDA. The AKC, a nonprofit
    that was founded in 1884, has the stated mission to “advance the study, breeding,
    exhibiting, running and maintenance of purebred dogs.” The AKC organizes events
    like the National Championship, Agility Invitational, and Obedience Classic, and
    mixed-breed dogs are welcome to participate in most events. The [Information Is
    Beautiful](https://informationisbeautiful.net) website provides a dataset with
    information from the AKC on 172 breeds. Its visualization, [Best in Show](https://oreil.ly/amksD),
    incorporates many features of the breeds and is fun to look at.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 我们使用 [美国肯尼尔俱乐部 (AKC)](https://www.akc.org) 的注册狗品种数据来介绍与探索数据分析相关的各种概念。成立于1884年的非营利组织AKC的宗旨是“推动纯种狗的研究、繁殖、展示、运动和维护”。AKC组织了诸如全国锦标赛、敏捷邀请赛和服从经典等活动，混种狗在大多数活动中也可以参与。[信息美化](https://informationisbeautiful.net)
    网站提供了来自AKC关于172种狗品种的信息数据集。其可视化作品 [最佳展示](https://oreil.ly/amksD) 包含了多种品种的特征，非常有趣。
- en: 'The AKC dataset contains several different kinds of features, and we have extracted
    a handful of them that show a variety of types of information. These features
    include the name of the breed; its longevity, weight, and height; and other information
    such as its suitability for children and the number of repetitions needed to learn
    a new trick. Each record in the dataset is a breed of dog, and the information
    provided is meant to be typical of that breed. Let’s read the data into a dataframe:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: AKC 数据集包含多种不同类型的特征，我们已提取了一些显示各种信息类型的特征。这些特征包括品种的名称；其寿命、体重和身高；以及其他信息，例如其适合儿童的程度和学习新技巧所需的重复次数。数据集中的每条记录都是一种狗的品种，提供的信息意在典型代表该品种。让我们将数据读入数据框中：
- en: '[PRE0]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '|   | breed | group | score | longevity | ... | size | weight | height | repetition
    |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '|   | 品种 | 组 | 得分 | 寿命 | ... | 大小 | 重量 | 身高 | 重复次数 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **0** | Border Collie | herding | 3.64 | 12.52 | ... | medium | NaN | 51.0
    | <5 |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| **0** | 边境牧羊犬 | 牧羊 | 3.64 | 12.52 | ... | 中型 | NaN | 51.0 | <5 |'
- en: '| **1** | Border Terrier | terrier | 3.61 | 14.00 | ... | small | 6.0 | NaN
    | 15-25 |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| **1** | 边境梗 | 梗类犬 | 3.61 | 14.00 | ... | 小型 | 6.0 | NaN | 15-25 |'
- en: '| **2** | Brittany | sporting | 3.54 | 12.92 | ... | medium | 16.0 | 48.0 |
    5-15 |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| **2** | 布列塔尼犬 | 狩猎 | 3.54 | 12.92 | ... | 中型 | 16.0 | 48.0 | 5-15 |'
- en: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... | ... |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... | ... |'
- en: '| **169** | Wire Fox Terrier | terrier | NaN | 13.17 | ... | small | 8.0 |
    38.0 | 25-40 |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| **169** | 电线狐狸梗 | 梗类犬 | NaN | 13.17 | ... | 小型 | 8.0 | 38.0 | 25-40 |'
- en: '| **170** | Wirehaired Pointing Griffon | sporting | NaN | 8.80 | ... | medium
    | NaN | 56.0 | 25-40 |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| **170** | 硬毛指示格里芬猎犬 | 狩猎 | NaN | 8.80 | ... | 中型 | NaN | 56.0 | 25-40 |'
- en: '| **171** | Xoloitzcuintli | non-sporting | NaN | NaN | ... | medium | NaN
    | 42.0 | NaN |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| **171** | 墨西哥无毛犬 | 非狩猎 | NaN | NaN | ... | 中型 | NaN | 42.0 | NaN |'
- en: '[PRE1]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'A cursory glance at the table shows us that breed, group, and size appear to
    be strings, and the other columns are numbers. The summary of the dataframe, shown
    here, provides the index, name, count of non-null values, and `dtype` for each
    column:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 粗略看一下表格，品种、组和大小似乎是字符串，其他列则是数字。这里显示的数据框摘要提供了索引、名称、非空值计数和每列的`dtype`：
- en: '[PRE2]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Several columns of this dataframe have a numeric computational type, as signified
    by `float64`, which means that the column can contain numbers other than integers.
    We also confirm that `pandas` encodes the string columns as the `object` `dtype`,
    rather than a `string` `dtype`. Notice that we guessed incorrectly that `repetition`
    is quantitative. Looking a bit more carefully at the data table, we see that `repetition`
    contains string values for ranges, such as `"<5"`, `"15-25"`, and `"25-40"`, so
    this feature is ordinal.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 这个数据框的几列具有数值计算类型，如`float64`，这意味着该列可以包含除整数以外的数字。我们还确认`pandas`将字符串列编码为`object`类型，而不是`string`类型。请注意，我们错误地猜测`重复次数`是定量的。仔细观察数据表后，我们发现`重复次数`包含范围的字符串值，如`"<5"`、`"15-25"`和`"25-40"`，因此这个特征是有序的。
- en: Note
  id: totrans-45
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: In computer architecture, a floating-point number, or “float” for short, refers
    to a number that can have a decimal component. We won’t go in depth into computer
    architecture in this book, but we will point it out when it affects terminology,
    as in this case. The `dtype` `float64` says that the column contains decimal numbers
    that each take up 64 bits of space when stored in computer memory.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在计算机体系结构中，浮点数或简称“float”指的是可以具有小数部分的数。我们不会在本书中深入探讨计算机体系结构，但在影响术语时，我们会指出它，就像在这种情况下一样。`dtype`
    `float64` 表示该列包含的是在计算机内存中存储时每个占用 64 位空间的十进制数。
- en: Additionally, `pandas` uses optimized storage types for numeric data, like `float64`
    or `int64`. However, it doesn’t have optimizations for Python objects like strings,
    dictionaries, or sets, so these are all stored as the `object` `dtype`. This means
    that the storage type is ambiguous, but in most settings we know whether `object`
    columns contain strings or some other Python type.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，`pandas` 使用了优化的存储类型来存储数值数据，如 `float64` 或 `int64`。然而，对于像字符串、字典或集合这样的 Python
    对象，它没有优化，因此这些数据类型都存储为 `object` `dtype`。这意味着存储类型是不明确的，但在大多数情况下，我们知道 `object` 列包含字符串或其他某种
    Python 类型。
- en: 'Looking at the column storage types, we might guess `ailments` and `children`
    are quantitative features because they are stored as `float64` `dtype`s. But let’s
    tally their unique values:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在查看列存储类型时，我们可能会猜测 `ailments` 和 `children` 是定量特征，因为它们存储为 `float64` `dtype`。但让我们统计它们的唯一值：
- en: '[PRE4]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[PRE6]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[PRE7]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Both `ailments` and `children` only take on a few integer values. What does
    a value of `3.0` for `children` or `9.0` for `ailments` mean? We need more information
    to figure this out. The name of the column and how the information is stored in
    the dataframe is not enough. Instead, we consult  the data dictionary shown in
    [Table 10-1](#akc-codebook).
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '`ailments` 和 `children` 都只接受几个整数值。`children` 的值为 `3.0` 或 `ailments` 的值为 `9.0`
    代表什么意思？我们需要更多信息才能搞清楚。列名及其在数据框中的存储方式不足以解释。因此，我们需要查阅表 10-1 中显示的数据字典。'
- en: Table 10-1\. AKC dog breed codebook
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 表 10-1\. AKC 狗品种代码手册
- en: '| Feature | Description |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| 特征 | 描述 |'
- en: '| --- | --- |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `breed` | Dog breed, e.g., Border Collie, Dalmatian, Vizsla |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| `breed` | 犬品种，例如边境牧羊犬、达尔马提亚犬、威尔士波音犬 |'
- en: '| `group` | American Kennel Club grouping (herding, hound, non-sporting, sporting,
    terrier, toy, working) |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| `group` | 美国典狗俱乐部分组（牧羊犬、猎犬、非运动犬、运动犬、梗类犬、玩具犬、工作犬） |'
- en: '| `score` | AKC score |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| `score` | AKC 评分 |'
- en: '| `longevity` | Typical lifetime (years) |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| `longevity` | 典型寿命（年） |'
- en: '| `ailments` | Number of serious genetic ailments |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| `ailments` | 严重遗传疾病的数量 |'
- en: '| `purchase_price` | Average purchase price from [puppyfind.com](http://puppyfind.com)
    |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| `purchase_price` | 从 [puppyfind.com](http://puppyfind.com) 平均购买价格 |'
- en: '| `grooming` | Grooming required once every: 1 = day, 2 = week, 3 = few weeks
    |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| `grooming` | 每次需要的美容频率：1 = 天，2 = 周，3 = 几周 |'
- en: '| `children` | Suitability for children: 1 = high, 2 = medium, 3 = low |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| `children` | 对儿童的适合度：1 = 高，2 = 中，3 = 低 |'
- en: '| `size` | Size: small, medium, large |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| `size` | 尺寸：小型、中型、大型 |'
- en: '| `weight` | Typical weight (kg) |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| `weight` | 典型体重（公斤） |'
- en: '| `height` | Typical height from the shoulder (cm) |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| `height` | 肩膀高度（厘米） |'
- en: '| `repetition` | Number of repetitions to understand a new command: <5, 5–15,
    15–25, 25–40, 40–80, >80 |'
  id: totrans-68
  prefs: []
  type: TYPE_TB
  zh: '| `repetition` | 理解新命令所需的重复次数：＜5，5-15，15-25，25-40，40-80，＞80 |'
- en: Although the data dictionary does not explicitly specify the feature types,
    the description is enough for us to figure out that the feature `children` represents
    the suitability of the breed for children, and a value of `1.0` corresponds to
    “high” suitability. We also find that the feature `ailments` is a count of the
    number of serious genetic ailments that dogs of this breed tend to have. Based
    on the codebook, we treat `children` as a categorical feature, even though it
    is stored as a floating-point number, and since low < medium < high, the feature
    is ordinal. Since `ailments` is a count, we treat it as a quantitative (numeric)
    type, and for some analyses we further define it as discrete because there are
    only a few possible values that `ailments` can take on.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管数据字典未明确指定特征类型，但描述足以让我们了解到，`children` 特征代表品种对儿童的适合程度，`1.0` 的值对应于“高”适合度。我们还发现
    `ailments` 特征表示该品种狗犬通常具有的严重遗传疾病的数量。根据代码手册，我们将 `children` 视为分类特征，即使它存储为浮点数，由于低
    < 中 < 高，该特征是有序的。由于 `ailments` 是一个计数，我们将其视为定量（数值）类型，并且对于某些分析，我们进一步定义它为离散型，因为 `ailments`
    可能的取值只有几个。
- en: 'The codebook also confirms that the features `score`, `longevity`, `purchase_price`,
    `weight`, and `height` are quantitative. The idea here is that numeric features
    have values that can be compared through differences. It makes sense to say that
    chihuahuas typically live about four years longer than dachshunds (16.5 versus
    12.6 years). Another check is whether it makes sense to compare ratios of values:
    a dachshund is usually about five times heavier than a chihuahua (11 kg versus
    2 kg). All of these quantitative features are continuous; only `ailments` is discrete.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 数据代码表还确认了`score`、`longevity`、`purchase_price`、`weight`和`height`特征是定量的。这里的想法是，数值特征具有可以通过差异进行比较的值。可以说吉娃娃的寿命通常比腊肠犬长大约四年（16.5年对12.6年）。另一个检查是是否有意义比较值的比率：一只腊肠犬通常比吉娃娃重大约五倍（11公斤对2公斤）。所有这些定量特征都是连续的；只有`ailments`是离散的。
- en: 'The data dictionary descriptions for `breed`, `group`, `size`, and `repetition`
    suggest that these features are qualitative. Each variable has different, and
    yet commonly found, characteristics that are worth exploring a bit more. We do
    this by examining the counts of each unique value for the various features. We
    begin with `breed`:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 对于`breed`、`group`、`size`和`repetition`，数据字典描述表明这些特征是定性的。每个变量具有不同但常见的特征，值得进一步探索。我们通过检查各个特征的唯一值计数来做到这一点。我们从`breed`开始：
- en: '[PRE8]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The `breed` feature has 172 unique values—that’s the same as the number of records
    in the dataframe—so we can think of `breed` as the *primary key* for the data
    table. By design, each dog breed has one record, and this `breed` feature determines
    the dataset’s granularity. Although `breed` is also considered a nominal feature,
    it doesn’t really make sense to analyze it. We do want to confirm that all values
    are unique and clean, but otherwise we would only use it to, say, label unusual
    values in a plot.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '`breed`特征有172个唯一值，与数据框中的记录数相同，因此我们可以将`breed`视为数据表的*主键*。按设计，每个犬种有一条记录，而这个`breed`特征决定了数据集的粒度。虽然`breed`也被视为名义特征，但分析它没有真正的意义。我们确实希望确认所有值都是唯一且干净的，但除此之外，我们只会用它来标记绘图中的异常值。'
- en: 'Next, we examine the feature `group`:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们检查`group`特征：
- en: '[PRE10]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This feature has seven unique values. Since a dog breed labeled as “sporting”
    and another considered to be “toy” differ from each other in several ways, the
    categories cannot be easily reduced to an ordering. So we consider `group` a nominal
    feature. Nominal features do not provide meaning in even the direction of the
    differences.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 该特征有七个唯一值。由于被标记为“运动型”的犬种与被认为是“玩具型”的犬种在多方面有所不同，这些类别不能轻易归纳为一种顺序。因此，我们将`group`视为名义特征。名义特征甚至不提供差异方向上的含义。
- en: 'Next, we examine the unique values and their counts for `size`:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们检查`size`的唯一值及其计数：
- en: '[PRE12]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The `size` feature has a natural ordering: small < medium < large, so it is
    ordinal. We don’t know how the category “small” is determined, but we do know
    that a small breed is in some sense smaller than a medium-sized breed, which is
    smaller than a large one. We have an ordering, but differences and ratios don’t
    make sense conceptually for this feature.'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '`size`特征具有自然的顺序：小 < 中 < 大，因此它是序数的。我们不知道“小”类别是如何确定的，但我们知道小型品种在某种意义上比中型品种小，而中型品种又比大型品种小。我们有一个顺序，但概念上差异和比率没有意义。'
- en: 'The `repetition` feature is an example of a quantitative variable that has
    been collapsed into categories to become ordinal. The codebook tells us that `repetition`
    is the number of times a new command needs to be repeated before the dog understands
    it:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '`repetition`特征是定量变量的一个示例，已经被折叠成类别，变为序数。数据代码表告诉我们，`repetition`是新命令需要重复几次才能让狗理解的次数：'
- en: '[PRE14]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '[PRE15]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The numeric values have been lumped together as `<5`, `5-15`, `15-25`, `25-40`,
    `40-80`, `80-100`, and notice that these categories have different widths. The
    first has 5 repetitions, while others are 10, 15, and 40 repetitions wide. The
    ordering is clear, but the gaps from one category to the next are not of the same
    magnitude.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 数值值已被汇总为`<5`、`5-15`、`15-25`、`25-40`、`40-80`、`80-100`，注意这些类别的宽度不同。第一个有5次重复，而其他的宽度为10、15和40次重复。顺序清晰，但从一个类别到下一个的间隔不是相同大小。
- en: Now that we have double-checked the values in the variables against the descriptions
    in the codebook, we can augment the data dictionary to include this additional
    information about the feature types. Our revised dictionary appears in [Table 10-2](#revised-akc-codebook).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经再次检查了变量中的值与代码手册中描述的值，我们可以扩充数据字典，包括关于特征类型的额外信息。我们修订后的字典出现在[表 10-2](#revised-akc-codebook)中。
- en: Table 10-2\. Revised AKC dog breed codebook
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 表 10-2\. 修订后的AKC犬种代码手册
- en: '| Feature | Description | Feature type | Storage type |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| 特征 | 描述 | 特征类型 | 存储类型 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| `breed` | Dog breed, e.g., Border Collie, Dalmatian, Vizsla | primary key
    | string |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| `breed` | 犬种，例如边境牧羊犬、达尔马提亚犬、威尔士激罗犬 | 主键 | 字符串 |'
- en: '| `group` | AKC group (herding, hound, non-sporting, sporting, terrier, toy,
    working) | qualitative - nominal | string |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| `group` | AKC分组（牧羊犬、猎犬、非运动犬、运动犬、梗类犬、玩具犬、工作犬） | 定性 - 名义 | 字符串 |'
- en: '| score | AKC `score` | quantitative | floating point |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| score | AKC `score` | 定量 | 浮点数 |'
- en: '| `longevity` | Typical lifetime (years) | quantitative | floating point |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| `longevity` | 典型寿命（年） | 定量 | 浮点数 |'
- en: '| `ailments` | Number of serious genetic ailments (0, 1, …, 9) | quantitative
    - discrete | floating point |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
  zh: '| `ailments` | 严重遗传疾病数量（0, 1, …, 9） | 定量 - 离散 | 浮点数 |'
- en: '| `purchase_price` | Average purchase price from [puppyfind.com](http://puppyfind.com)
    | quantitative | floating point |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '| `purchase_price` | 从[puppyfind.com](http://puppyfind.com)平均购买价格 | 定量 | 浮点数
    |'
- en: '| `grooming` | Groom once every: 1 = day, 2 = week, 3 = few weeks | qualitative
    - ordinal | floating point |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '| `grooming` | 每隔多久梳理一次：1 = 天、2 = 周、3 = 几周 | 定性 - 序数 | 浮点数 |'
- en: '| `children` | Suitability for children: 1 = high, 2 = medium, 3 = low | qualitative
    - ordinal | floating point |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '| `children` | 适合儿童程度：1 = 高、2 = 中、3 = 低 | 定性 - 序数 | 浮点数 |'
- en: '| `size` | Size: small, medium, large | qualitative - ordinal | string |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '| `size` | 尺寸：小、中、大 | 定性 - 序数 | 字符串 |'
- en: '| `weight` | Typical weight (kg) | quantitative | floating point |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| `weight` | 典型体重（公斤） | 定量 | 浮点数 |'
- en: '| `height` | Typical height from the shoulder (cm) | quantitative | floating
    point |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '| `height` | 肩膀高度（厘米） | 定量 | 浮点数 |'
- en: '| `repetition` | Number of repetitions to understand a new command: <5, 5–15,
    15–25, 25–40, 40–80, 80–100 | qualitative - ordinal | string |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| `repetition` | 理解新指令所需的重复次数：＜5、5–15、15–25、25–40、40–80、80–100 | 定性 - 序数 |
    字符串 |'
- en: This sharper understanding of the feature types of the AKC data helps us make
    quality checks and transformations. We discussed transformations in [Chapter 9](ch09.html#ch-wrangling),
    but there are a few additional transformations that were not covered. These pertain
    to categories of qualitative features, and we describe them next.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 对AKC数据特征类型的更清晰理解有助于我们进行质量检查和转换。我们在[第9章](ch09.html#ch-wrangling)中讨论了转换，但还有一些未涉及的额外转换。这些与定性特征的类别有关，我们接下来将对其进行描述。
- en: Transforming Qualitative Features
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 转换定性特征
- en: Whether a feature is nominal or ordinal, we may find it useful to relabel categories
    so that they are more informative, collapse categories to simplify a visualization,
    and even convert a numeric feature to ordinal to focus on particular transition
    points. We explain when we may want to make each of these transformations and
    give examples.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 无论特征是名义还是序数，我们可能会发现重新标记类别使其更具信息性，合并类别以简化可视化，甚至将数值特征转换为序数以便专注于特定的过渡点都是有用的。我们解释了何时进行每种转换，并给出了示例。
- en: Relabel categories
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 重新标记类别
- en: 'Summary statistics, like the mean and the median, make sense for quantitative
    data, but typically not for qualitative data. For example, the average price for
    toy breeds makes sense to calculate ($687), but the “average” breed suitability
    for children doesn’t. However, `pandas` will happily compute the mean of the values
    in the `children` column if we ask it to:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 摘要统计数据，如平均值和中位数，对定量数据是有意义的，但通常对定性数据不是。例如，计算玩具品种的平均价格（$687）是有意义的，但是关于儿童的“平均”适合性不是。然而，如果我们要求它，`pandas` 将乐意计算`children`列中值的平均值：
- en: '[PRE16]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[PRE17]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Instead, we want to consider the distribution of 1s, 2s, and 3s of `children`.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，我们希望考虑`children`的1、2和3的分布。
- en: Note
  id: totrans-111
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: The key difference between storage types and feature types is that storage types
    say what operations we can write code to *compute*, while feature types say what
    operations *make sense for the data*.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 存储类型和特征类型之间的主要区别在于，存储类型表示我们可以编写代码来*计算*哪些操作，而特征类型表示对于数据*何种操作是有意义*的。
- en: 'We can transform `children` by replacing the numbers with their string descriptions.
    Changing 1, 2, and 3 into high, medium, and low makes it easier to recognize that
    `children` is categorical. With strings, we would not be tempted to compute a
    mean, the categories would be connected to their meaning, and labels for plots
    would have reasonable values by default. For example, let’s focus on just the
    toy breeds and make a bar plot of suitability for children. First, we create a
    new column with the categories of suitability as strings:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过用它们的字符串描述替换数字来转换`孩子们`。将1、2和3改为高、中和低，使得很容易识别出`孩子们`是分类的。使用字符串，我们不会被诱惑计算平均值，类别会与它们的含义相联系，并且绘图的标签默认具有合理的值。例如，让我们只关注玩具品种，并制作适合儿童的酒吧图。首先，我们创建一个新的列，用字符串表示适合性的类别：
- en: '[PRE18]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '[PRE19]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '|   | breed | group | score | longevity | ... | weight | height | repetition
    | kids |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '|   | 品种 | 分组 | 得分 | 寿命 | ... | 重量 | 身高 | 重复 | 孩子们 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **0** | Border Collie | herding | 3.64 | 12.52 | ... | NaN | 51.0 | <5 |
    low |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| **0** | 边境牧羊犬 | 牧羊犬 | 3.64 | 12.52 | ... | NaN | 51.0 | <5 | 低 |'
- en: '| **1** | Border Terrier | terrier | 3.61 | 14.00 | ... | 6.0 | NaN | 15-25
    | high |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| **1** | 边境泰瑞尔 | 梗犬 | 3.61 | 14.00 | ... | 6.0 | NaN | 15-25 | 高 |'
- en: '| **2** | Brittany | sporting | 3.54 | 12.92 | ... | 16.0 | 48.0 | 5-15 | medium
    |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| **2** | 布列塔尼 | 运动型 | 3.54 | 12.92 | ... | 16.0 | 48.0 | 5-15 | 中等 |'
- en: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... | ... |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... | ... |'
- en: '| **169** | Wire Fox Terrier | terrier | NaN | 13.17 | ... | 8.0 | 38.0 | 25-40
    | NaN |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| **169** | 线毛福克斯梗 | 梗犬 | NaN | 13.17 | ... | 8.0 | 38.0 | 25-40 | NaN |'
- en: '| **170** | Wirehaired Pointing Griffon | sporting | NaN | 8.80 | ... | NaN
    | 56.0 | 25-40 | NaN |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| **170** | 线毛指示格里芬 | 运动型 | NaN | 8.80 | ... | NaN | 56.0 | 25-40 | NaN |'
- en: '| **171** | Xoloitzcuintli | non-sporting | NaN | NaN | ... | NaN | 42.0 |
    NaN | NaN |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| **171** | 什么狗品种 | 非运动型 | NaN | NaN | ... | NaN | 42.0 | NaN | NaN |'
- en: '[PRE20]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Then we can make the bar plot of counts of each category of suitability among
    the toy breeds:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们可以制作玩具品种中每个适合性类别的计数条形图：
- en: '[PRE21]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![](assets/leds_10in01.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in01.png)'
- en: We do not always want to have categorical data represented by strings. Strings
    generally take up more space to store, which can greatly increase the size of
    a dataset if it contains many categorical features.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 我们并不总是希望用字符串表示分类数据。字符串通常需要更多的存储空间，如果数据集包含许多分类特征，可能会大大增加数据集的大小。
- en: At times, a qualitative feature has many categories and we prefer a higher-level
    view of the data, so we collapse categories.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 有时候，一个定性特征有许多类别，我们更喜欢对数据进行更高级别的查看，因此我们会合并类别。
- en: Collapse categories
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 折叠类别
- en: 'Let’s create a new column, called `play`, to represent the groups of dogs whose
    “purpose” is to play (or not). (This is a fictitious distinction used for demonstration
    purposes.) This category consists of the toy and non-sporting breeds. The new
    feature, `play`, is a transformation of the feature `group` that collapses categories:
    toy and non-sporting are combined into one category, and the remaining categories
    are placed in a second, non-play category. The boolean (`bool`) storage type is
    useful to indicate the presence or absence of this characteristic:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们创建一个名为`play`的新列，以表示“目的”是玩耍的狗的组（或不是）。 （这是一个虚构的区分，用于演示目的。）此类别由玩具和非运动品种组成。 新特征`play`是将特征`group`折叠的转换：将玩具和非运动组合成一个类别，剩下的类别放在第二个非玩耍类别中。
    布尔（`bool`）存储类型对于指示此特征的存在或不存在非常有用：
- en: '[PRE22]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Representing a two-category qualitative feature as a boolean has a few advantages.
    For example, the mean of `play` makes sense because it returns the fraction of
    `True` values. When booleans are used for numeric calculations, `True` becomes
    1 and `False` becomes 0:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 将一个两类定性特征表示为布尔值有一些优点。 例如，`play`的平均值是有意义的，因为它返回`True`值的比例。 当布尔值用于数字计算时，`True`变为1，`False`变为0：
- en: '[PRE23]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: This storage type gives us a shortcut to compute counts and averages of boolean
    values. In [Chapter 15](ch15.html#ch-linear), we’ll see that it’s also a handy
    encoding for modeling.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 此存储类型为我们提供了计算布尔值的计数和平均值的快捷方式。 在[第15章](ch15.html#ch-linear)中，我们将看到它对建模也是一个方便的编码。
- en: There are also times, like when a discrete quantitative feature has a long tail,
    that we want to truncate the higher values, which turns the quantitative feature
    into an ordinal. We describe this next.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 有时候，例如当一个离散的定量特征有一个长尾时，我们希望截断更高的值，这将定量特征转化为序数。接下来我们将描述这一点。
- en: Convert quantitative to ordinal
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将定量转换为序数
- en: 'Finally, another transformation that we sometimes find useful is to convert
    numeric values into categories. For example, we might collapse the values in `ailments`
    into categories: 0, 1, 2, 3, 4+. In other words, we turn `ailments` from a quantitative
    feature into an ordinal feature with the mapping 0→0, 1→1, 2→2, 3→3, and any value
    4 or larger→4+. We might want to make this transformation because few breeds have
    more than three genetic ailments. This simplification can be clearer and adequate
    for an investigation.'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们有时会发现另一种有用的转换是将数值转换为类别。例如，我们可以将`ailments`中的值合并为类别：0, 1, 2, 3, 4+。换句话说，我们将`ailments`从定量特征转换为序数特征，映射为
    0→0, 1→1, 2→2, 3→3，任何值大于等于4→4+。我们可能希望进行这种转换，因为几乎没有品种有三种以上的遗传疾病。这种简化可以更清晰和足够用于调查。
- en: Note
  id: totrans-141
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: As of this writing (late 2022), `pandas` also implements a `category` `dtype`
    that is designed to work with qualitative data. However, this storage type is
    not yet widely adopted by the visualization and modeling libraries, which limits
    its usefulness. For that reason, we do not transform our qualitative variables
    into the `category` `dtype`. We expect that future readers may want to use the
    `category` `dtype` as more libraries support it.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 截至2022年底，`pandas`也实现了一个设计用于定性数据的`category` `dtype`。然而，这种存储类型目前在可视化和建模库中尚未广泛采用，限制了其实用性。因此，我们不将定性变量转换为`category`
    `dtype`。我们预计将来的读者可能会希望在更多库支持它之后使用`category` `dtype`。
- en: When we convert a quantitative feature to ordinal, we lose information. We can’t
    go back. That is, if we know the number of ailments for a breed is four or more,
    we can’t re-create the actual numeric value. The same thing happens when we collapse
    categories. For this reason, it’s a good practice to keep the original feature.
    If we need to check our work or change categories, we can document and re-create
    our steps.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们将定量特征转换为序数时，我们会丢失信息。我们无法回到原来的状态。也就是说，如果我们知道某品种的疾病数为四个或更多，我们无法重新创建实际的数值。当我们合并类别时也是同样的情况。因此，保留原始特征是一个良好的实践。如果需要检查我们的工作或更改类别，我们可以记录和重新创建我们的步骤。
- en: In general, the feature type helps us figure out what kind of plot is most appropriate.
    We discuss the mapping between feature type and plots next.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，特征类型帮助我们确定哪种绘图最合适。接下来我们讨论特征类型与绘图之间的映射。
- en: The Importance of Feature Types
  id: totrans-145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 特征类型的重要性
- en: Feature types guide us in our data analysis. They help specify the operations,
    visualizations, and models we can meaningfully apply to the data. [Table 10-3](#feature-plot)
    matches the feature type(s) to the various kinds of plots that are typically good
    options. Whether the variable(s) are quantitative or qualitative generally determines
    the set of viable plots to make, although there are exceptions. Other factors
    that enter into the decision are the number of observations and whether the feature
    takes on only a few distinct values. For example, we might make a bar chart, rather
    than a histogram, for a discrete quantitative variable.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 特征类型指导我们进行数据分析。它们有助于指定我们可以对数据应用的操作、可视化和模型。[表 10-3](#feature-plot) 将特征类型匹配到通常适合的各种绘图类型。变量是定量还是定性通常决定了可以制作的可选绘图集，尽管也有例外情况。决策的其他因素包括观察数量以及特征是否仅取几个不同的值。例如，对于离散定量变量，我们可能制作柱状图而不是直方图。
- en: Table 10-3\. Mapping feature types to plots
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 表10-3. 将特征类型映射到绘图
- en: '| Feature type | Dimension | Plot |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| 特征类型 | 维度 | 绘图 |'
- en: '| --- | --- | --- |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Quantitative | One feature | Rug plot, histogram, density curve, box plot,
    violin plot |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| 定量 | 一个特征 | 地毯图，直方图，密度曲线，箱线图，小提琴图 |'
- en: '| Qualitative | One feature | Bar plot, dot plot, line plot, pie chart |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| 定性 | 一个特征 | 柱状图，点图，线图，饼图 |'
- en: '| Quantitative | Two features | Scatterplot, smooth curve, contour plot, heat
    map, quantile-quantile plot |'
  id: totrans-152
  prefs: []
  type: TYPE_TB
  zh: '| 定量 | 两个特征 | 散点图，平滑曲线，等高线图，热力图，分位数-分位数图 |'
- en: '| Qualitative | Two features | Side-by-side bar plots, mosaic plot, overlaid
    lines |'
  id: totrans-153
  prefs: []
  type: TYPE_TB
  zh: '| 定性 | 两个特征 | 并排柱状图，马赛克图，叠加线条 |'
- en: '| Mixed | Two features | Overlaid density curves, side-by-side box plots, overlaid
    smooth curves, quantile-quantile plot |'
  id: totrans-154
  prefs: []
  type: TYPE_TB
  zh: '| 混合 | 两个特征 | 叠加密度曲线，并排箱线图，叠加平滑曲线，分位数-分位数图 |'
- en: The feature type also helps us decide the kind of summary statistics to calculate.
    With qualitative data, we usually don’t compute means or standard deviations,
    and instead compute the count, fraction, or percentage of records in each category.
    With a quantitative feature, we compute the mean or median as a measure of center,
    and, respectively, the standard deviation or inner quartile range (75th percentile
    to 25th percentile) as a measure of spread. In addition to the quartiles, we may
    find other percentiles informative.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 特征类型还帮助我们决定计算哪种摘要统计数据。对于定性数据，我们通常不计算均值或标准差，而是计算每个类别中记录的数量、比例或百分比。对于定量特征，我们计算均值或中位数作为中心测量，以及标准差或四分位间距（第75百分位至第25百分位）作为扩展测量。除了四分位数外，我们可能还会发现其他百分位数有信息意义。
- en: Note
  id: totrans-156
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: The *n*th percentile is that value *q* such that *n% of the data values fall
    at or below it.* The value *q* might not be unique, and there are several approaches
    to select a unique value from the possibilities. With enough data, there should
    be little difference between these definitions.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 第*n*百分位数是使得*n%的数据值不超过它*的值*q*。值*q*可能不唯一，有几种方法可以选择可能的唯一值。有足够的数据时，这些定义之间应该几乎没有区别。
- en: 'To compute percentiles in Python, we prefer using:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在Python中计算百分位数时，我们更喜欢使用：
- en: '[PRE25]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: When exploring data, we need to know how to interpret the shapes that our plots
    reveal. The next three sections give guidance with this interpretation. We also
    introduce many of the types of plots listed in [Table 10-3](#feature-plot) through
    the examples. Others are introduced in [Chapter 11](ch11.html#ch-viz).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 当探索数据时，我们需要知道如何解释我们的图形显示的形状。接下来的三节将指导这种解释。我们还通过示例介绍了表格[10-3](#feature-plot)中列出的许多图表类型。其他类型在[第11章](ch11.html#ch-viz)中介绍。
- en: What to Look For in a Distribution
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何选择分布特征
- en: 'Visual displays of a feature can help us see patterns in observations; they
    are often much better than direct examination of the numbers or strings themselves.
    The simple rug plot locates each observation as a “yarn” in a “rug” along an axis.
    The rug plot can be useful when we have a handful of observations, but it soon
    gets difficult to distinguish high-density (most-populated) regions with, say,
    even 100 values. The following figure shows a rug plot with about 150 longevity
    values for dog breeds along the top of a histogram:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 特征的视觉展示可以帮助我们看到观察结果中的模式；它们通常比直接检查数字或字符串本身要好得多。简单的毯子图将每个观察结果定位为沿轴上的“纱线”。“毯子”图在我们有少量观察结果时可能很有用，但是当我们有100个值时，很快就难以区分高密度（人口最多）区域，比如说。以下图显示了大约150个品种寿命值沿直方图顶部的毯子图：
- en: '[PRE26]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '![](assets/leds_10in02.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in02.png)'
- en: 'Although we can see an unusually large value that’s greater than 16 in the
    rug plot, it’s hard to compare the density of yarns in the other regions. Instead,
    the histogram gives a much better sense of the density of observations for various
    longevity values. Similarly, the *density curve* shown in the following figure
    gives a picture of the regions of high and low density:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们可以看到一个异常大的值大于16在毯子图中，但很难比较其他区域的纱线密度。相反，直方图为各种寿命值的观察密度提供了更好的感知。类似地，下图中显示的*密度曲线*描绘了高低密度区域的图像：
- en: '![](assets/leds_10in03.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in03.png)'
- en: In both the histogram and density curve, we can see that the distribution of
    longevity is asymmetric. There is one main mode around 12 years and a shoulder
    in the 9-to-11-year range, meaning that while 12 is the most common longevity,
    many breeds have a longevity one to three years shorter than 12\. We also see
    a small secondary mode around 7, and a few breeds with longevity as long as 14
    to 16 years.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在直方图和密度曲线中，我们可以看到寿命分布是不对称的。在大约12年处有一个主要模式，9到11年的范围内有一个肩膀，这意味着虽然12年是最常见的寿命，但许多品种的寿命比12年短一到三年。我们还看到大约7岁的小次要模式，以及一些寿命长达14到16年的品种。
- en: When interpreting a histogram or density curve, we examine the symmetry and
    skewness of the distribution; the number, location, and size of high-frequency
    regions (modes); the length of tails (often in comparison to a bell-shaped curve);
    gaps where no values are observed; and unusually large or anomalous values. [Figure 10-1](#example-density-plot)
    provides a characterization of a distribution with several of these features.
    When we read a distribution, we connect the features that we see in the plot to
    the quantity measured.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 当解读直方图或密度曲线时，我们会检查分布的对称性和偏斜度；高频区域（模式）的数量、位置和大小；尾部长度（通常与钟形曲线进行比较）；未观察到值的间隙；以及异常大或异常值。[图 10-1](#example-density-plot)
    提供了一个具有这些特征的分布的描述。当我们读取分布时，我们将在图中看到的特征与所测量的数量联系起来。
- en: '![](assets/leds_1001.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_1001.png)'
- en: Figure 10-1\. Example density plot identifying qualities of a distribution based
    on its shape
  id: totrans-170
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-1\. 示例密度图，根据其形状识别分布的特征
- en: 'As another example, the distribution of the number of ailments in dog breeds
    appears in the following histogram:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 作为另一个例子，犬种中遗传病数量的分布如下直方图所示：
- en: '[PRE27]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '![](assets/leds_10in04.png)'
  id: totrans-173
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in04.png)'
- en: A value of 0 means this breed has no genetic ailments, 1 corresponds to one
    genetic ailment, and so on. From the histogram, we see that the distribution of
    ailments is unimodal with a peak at 0\. We also see that the distribution is heavily
    skewed to the right, with a long right tail indicating that few breeds have between
    four and nine genetic ailments. Although quantitative, ailments is discrete because
    only a few integer values are possible. For this reason, we centered the bins
    on the integers so that the bin from 1.5 to 2.5 contains only those breeds with
    two ailments. We also made the rightmost bin wider. We lumped into one bin all
    of the breeds with four to nine ailments. When bin counts are small, we use wider
    bins to further smooth the distribution because we do not want to read too much
    into the fluctuations of small numbers. In this case, none of the breeds have
    six or seven ailments, but some have four, five, eight, or nine.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 当遗传病数量为0时，意味着这个品种没有遗传病，当为1时对应一个遗传病，以此类推。从直方图中可以看出，遗传病的分布是单峰的，峰值在0处。我们还可以看到，分布向右严重倾斜，右尾长，表明很少的品种有四到九种遗传病。虽然是定量的，但遗传病是离散的，因为只有少数整数值是可能的。因此，我们将区间设定在整数上，例如从1.5到2.5的区间只包含有两种病的品种。我们还扩宽了最右边的区间。我们将所有有四到九种病的品种归为一组。当区间计数较小时，我们使用更宽的区间进一步平滑分布，因为我们不想过多关注小数字的波动。在这种情况下，没有品种有六或七种病，但有些有四、五、八或九种病。
- en: 'Next, we point out three key aspects of histograms and density curves: the
    y-axis should be on a density scale, smoothing hides unimportant details, and
    histograms are fundamentally different from bar plots. We describe each in turn:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们指出直方图和密度曲线的三个关键方面：y轴应该使用密度刻度，平滑隐藏了不重要的细节，直方图与条形图基本上是不同的。我们依次描述每个方面：
- en: Density in the y-axis
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: y轴上的密度
- en: 'The y-axes in the histograms of longevity and ailments are both labeled “density.”
    This label implies that the total area of the bars in the histogram equals 1\.
    To explain, we can think of the histogram as a skyline with tall buildings having
    denser populations, and we find the fraction of observations in any bin from the
    area of the rectangle. For example, the rectangle that runs from 3.5 to 9.5 in
    the ailments histogram contains about 10% of the breeds: 6 (width) × 0.017 (height)
    is roughly 0.10\. If all of the bins are the same width, then the “skyline” will
    look the same whether the y-axis represents counts or density. But changing the
    y-axis to counts in this histogram would give a misleading picture of a very large
    rectangle in the right tail.'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 长寿和遗传病直方图中的y轴都标记为“密度”。这个标签意味着直方图中条的总面积等于1。简单来说，我们可以把直方图想象成一个天际线，高楼密集的地方人口更多，我们可以从矩形的面积中找到任意区间的观察比例。例如，在遗传病直方图中，从3.5到9.5的矩形大约包含了10%的品种：6（宽度）×
    0.017（高度）大约是0.10。如果所有的区间宽度相同，那么无论y轴表示计数还是密度，天际线看起来都会一样。但是在这个直方图中将y轴改为计数会给出一个误导性的图片，右尾的一个非常大的矩形。
- en: Smoothing
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 平滑处理
- en: With a histogram we hide the details of individual yarns in a rug plot in order
    to view the general features of the distribution. Smoothing refers to this process
    of replacing sets of points with rectangles; we choose not to show every single
    point in the dataset in order to reveal broader trends. We might want to smooth
    out these points because this is a sample and we believe that other values near
    the ones we observed are reasonable, and/or we want to focus on general structure
    rather than individual observations. Without the rug, we can’t tell where the
    points are in a bin. Smooth density curves, like the one we showed earlier for
    longevity, also have the property that the total area under the curve sums to
    1\. The density curve uses a smooth *kernel* function to spread out the individual
    yarns and is sometimes referred to as a *kernel density estimate* (KDE).
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 使用直方图时，我们隐藏了地毯图中个别纱线的细节，以便查看分布的一般特征。平滑是指这个过程，将点集替换为矩形；我们选择不展示数据集中的每个点，以揭示更广泛的趋势。我们可能希望平滑这些点，因为这是一个样本，我们相信观察到的值附近的其他值是合理的，和/或者我们想要关注的是一般结构而不是个别观测值。没有地毯，我们无法确定一个箱子中的点在哪里。平滑的密度曲线，就像我们之前展示的关于寿命的那个，也具有总面积和为1的属性。密度曲线使用平滑的*核*函数来展开个别纱线，有时被称为*核密度估计*（KDE）。
- en: Bar plot ≠ histogram
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 条形图 ≠ 直方图
- en: 'With qualitative data, the bar plot serves a similar role to the histogram.
    The bar plot gives a visual presentation of the “popularity” or frequency of different
    groups. However, we cannot interpret the shape of the bar plot in the same way
    as a histogram. Tails and symmetry do not make sense in this setting. Also, the
    frequency of a category is represented by the height of the bar, and the width
    carries no information. The two bar charts that follow display identical information
    about the number of breeds in a category; the only difference is in the width
    of the bars. In the extreme, the rightmost plot eliminates the bars entirely and
    represents each count by a single dot. (Without the connecting lines, this figure
    is called a *dot plot*.) Reading this line plot, we see that only a few breeds
    are unsuitable for children:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 对于定性数据，条形图与直方图起着类似的作用。条形图以视觉方式展示不同组的“流行度”或频率。然而，我们不能像直方图那样解释条形图的形状。在此设置中，尾部和对称性没有意义。此外，类别的频率由条的高度表示，宽度不包含信息。接下来的两个条形图显示了关于各个类别品种数量的相同信息；它们唯一的区别在于条的宽度。在极端情况下，最右边的图表完全消除了条，并通过单个点来表示每个计数。在没有连接线的情况下，这种图称为*点图*。阅读这个线图时，我们可以看到只有少数品种不适合儿童：
- en: '[PRE28]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![](assets/leds_10in05.png)'
  id: totrans-183
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in05.png)'
- en: Now that we have covered how to examine distributions of single features, we
    turn to the situation when we want to look at two features and how they relate.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经讨论了如何检查单个特征的分布情况，接下来我们转向当我们想要查看两个特征及其关系时的情况。
- en: What to Look For in a Relationship
  id: totrans-185
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 关系中要寻找的内容
- en: When we investigate  multiple variables, we examine the relationships between
    them, in addition to their distributions. In this section, we consider pairs of
    features and describe what to look for. [Table 10-3](#feature-plot) provides guidelines
    for the type of plot to make based on the feature types. For two features, the
    combination of types (both quantitative, both qualitative, or a mix) matters.
    We consider each combination in turn.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们研究多个变量时，我们不仅要检查它们的分布，还要检查它们之间的关系。在这一部分中，我们考虑特征对并描述需要寻找的内容。根据特征类型，[表 10-3](#feature-plot)
    提供了绘制图表类型的指南。对于两个特征来说，类型的组合（全是定量、全是定性或混合）很重要。我们逐个考虑每种组合。
- en: Two Quantitative Features
  id: totrans-187
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 两个定量特征
- en: If both features are quantitative, then we often examine their relationship
    with a scatterplot. Each point in a scatterplot marks the position of a pair of
    values for an observation. So we can think of a scatterplot as a two-dimensional
    rug plot.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 如果两个特征都是定量的，那么我们通常用散点图来考察它们的关系。散点图中的每个点表示一个观测值的一对数值的位置。因此，我们可以将散点图视为一个二维的地毯图。
- en: With scatter plots, we look for linear and simple nonlinear relationships, and
    we examine the strength of the relationships. We also look to see if a transformation
    of one or the other or both features leads to a linear relationship.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 在散点图中，我们寻找线性和简单的非线性关系，并检查这些关系的强度。我们还要看看是否将一个或两个特征进行变换会导致线性关系。
- en: 'The following scatterplot displays the weight and height of dog breeds (both
    are quantitative):'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的散点图展示了狗品种的体重和身高（两者都是定量的）：
- en: '[PRE29]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '![](assets/leds_10in06.png)'
  id: totrans-192
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in06.png)'
- en: 'We observe that dogs that are above average in height tend to be above average
    in weight. This relationship appears nonlinear: the change in weight for taller
    dogs grows faster than for shorter dogs. Indeed, that makes sense if we think
    of a dog as basically shaped like a box: for similarly proportioned boxes, the
    weight of the contents of the box has a cubic relationship to its length.'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 我们观察到，身高高于平均水平的狗往往体重也高于平均水平。这种关系呈非线性：对于较高的狗，体重的变化速度比对于较矮的狗要快。事实上，如果我们将狗看作基本上呈盒状，那么对于类似比例的盒子，盒子内的内容的重量与其长度呈立方关系是有道理的。
- en: It’s important to note that two univariate plots are missing information found
    in a bivariate plot—information about how the two features vary together. Practically,
    histograms for two quantitative features do not contain enough information to
    create a scatterplot of the features. We must exercise caution and not read too
    much into a pair of univariate plots. Instead, we need to use one of the plots
    listed in the appropriate row of [Table 10-3](#feature-plot) (scatterplot, smooth
    curve, contour plot, heat map, quantile–quantile plot) to get a sense of the relationship
    between two quantitative features.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，两个单变量图缺少双变量图中的信息——关于两个特征如何一起变化的信息。实际上，两个定量特征的直方图不包含足够的信息来创建特征的散点图。我们必须谨慎行事，不要过多解读一对单变量图。相反，我们需要使用[表 10-3](#feature-plot)
    中适当行中列出的图之一（散点图，平滑曲线，等高线图，热图，分位数-分位数图），以了解两个定量特征之间的关系。
- en: When one feature is numeric and the other qualitative, [Table 10-3](#feature-plot)
    makes different recommendations. We describe them next.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 当一个特征是数值的而另一个是定性的时候，[表 10-3](#feature-plot) 提出了不同的建议。我们接下来描述它们。
- en: One Qualitative and One Quantitative Variable
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一个定性和一个定量变量
- en: 'To examine the relationship between a quantitative and a qualitative feature,
    we often use the qualitative feature to divide the data into groups and compare
    the distribution of the quantitative feature across these groups. For example,
    we can compare the distribution of height for small, medium, and large dog breeds
    with three overlaid density curves:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 要检验定量和定性特征之间的关系，我们通常使用定性特征将数据分成组，并比较这些组中定量特征的分布。例如，我们可以比较小型、中型和大型狗品种的身高分布，同时绘制三个重叠的密度曲线：
- en: '![](assets/leds_10in07.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in07.png)'
- en: We see that the distribution of height for the small and medium breeds both
    appear bimodal, with the left mode the larger in each group. Also, the small and
    medium groups have a larger spread in height than the large group of breeds.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到小型和中型品种的身高分布都呈双峰性，每组左峰较大。此外，小型和中型组的身高范围比大型品种组要大。
- en: 'Side-by-side box plots offer a similar comparison of distributions across groups.
    The box plot offers a simpler approach that can give a crude understanding of
    a distribution. Likewise, violin plots sketch density curves along an axis for
    each group. The curve is flipped to create a symmetric “violin” shape. The violin
    plot aims to bridge the gap between the density curve and box plot. We create
    box plots (left) and violin plots (right) for the height of breeds given the size
    labeling:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 并排的箱线图提供了跨组分布的类似比较。箱线图提供了一种简单的方法，可以粗略了解分布情况。同样，小提琴图沿轴为每个组绘制密度曲线。曲线被翻转以创建对称的“小提琴”形状。小提琴图旨在弥合密度曲线和箱线图之间的差距。我们为品种的高度创建了箱线图（左）和小提琴图（右），给出了大小标签：
- en: '![](assets/leds_10in08.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in08.png)'
- en: The three box plots of height, one for each size of dog, make it clear that
    the size categorization is based on height because there is almost no overlap
    in height ranges for the groups. (This was not evident in the density curves due
    to the smoothing.) What we don’t see in these box plots is the bimodality in the
    small and medium groups, but we can still see that the large dogs have a narrower
    spread compared to the other two groups.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 狗的三个身高箱线图，每种大小的狗一个，清楚地表明大小分类是基于身高的，因为组间的身高范围几乎没有重叠。（由于平滑处理，这在密度曲线中并不明显。）在这些箱线图中我们看不到小型和中型狗群体的双峰性，但我们仍然可以看到大型狗与其他两组相比具有较窄的分布。
- en: Box plots (also known as box-and-whisker plots) give a visual summary of a few
    important statistics of a distribution. The box denotes the 25th percentile, median,
    and 75th percentile, the whiskers show the tails, and unusually large or small
    values are also plotted. Box plots cannot reveal as much shape as a histogram
    or density curve. They primarily show symmetry and skew, long/short tails, and
    unusually large/small values (also known as *outliers*).
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 箱线图（也称为箱线图）是对分布的几个重要统计数据的视觉总结。箱子代表第25百分位数、中位数和第75百分位数，箱须显示尾部，还绘制了异常大或小的值。箱线图不能像直方图或密度曲线那样显示形状。它们主要显示对称性和偏斜、长/短尾巴以及异常大/小的值（也称为*异常值*）。
- en: '[Figure 10-2](#box-plot) is a visual explanation of the parts of a box plot.
    Asymmetry is evident from the median not being in the middle of the box, the sizes
    of the tails are shown by the length of the whiskers, and outliers are shown by
    the points that appear beyond the whiskers. The maximum is considered an outlier
    because it appears beyond the whisker on the right.'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 10-2](#box-plot) 是对箱线图各部分的视觉解释。从中位数不在箱子中间可以看出不对称性，箱须的长度显示了尾部的大小，超出箱须的点显示了异常值。最大值被视为异常值，因为它出现在右侧箱须之外。'
- en: '![](assets/leds_1002.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_1002.png)'
- en: Figure 10-2\. Diagram of a box plot with the summary statistics labeled
  id: totrans-206
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-2\. 带有标记的箱线图摘要统计的图示
- en: When we examine the relationship between two qualitative features, our focus
    is on proportions, as we explain next.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们研究两个定性特征之间的关系时，我们的重点在于比例，接下来我们会详细解释。
- en: Two Qualitative Features
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 两个定性特征
- en: With two qualitative features, we often compare the distribution of one feature
    across subgroups defined by the other feature. In effect, we hold one feature
    constant and plot the distribution of the other one. To do this, we can use some
    of the same plots we used to display the distribution of one qualitative feature,
    such as a line plot or bar plot. As an example, let’s examine the relationship
    between the suitability of a breed for children and the size of the breed.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 对于两个定性特征，我们经常比较一个特征在另一个特征定义的子组中的分布。实际上，我们保持一个特征不变，并绘制另一个特征的分布。为此，我们可以使用用于显示一个定性特征分布的一些相同图表，例如线图或条形图。举个例子，让我们来研究品种对儿童适宜性和品种大小之间的关系。
- en: 'To examine the relationship between these two qualitative features, we calculate
    three sets of proportions (one each for low, medium, and high suitability). Within
    each suitability category, we find the proportion of small, medium, and large
    dogs. These proportions are displayed in the following table. Notice that each
    column sums to 1 (equivalent to 100%):'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 要研究这两个定性特征之间的关系，我们计算三组比例（分别对应低、中、高适宜性）。在每个适宜性类别中，我们找出小型、中型和大型狗的比例。这些比例显示在下表中。注意，每列总和为1（相当于100%）：
- en: '[PRE30]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '| kids | high | medium | low |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| 儿童 | 高 | 中 | 低 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| size |   |   |   |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| 大小 |   |   |   |'
- en: '| --- | --- | --- | --- |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| **large** | 0.37 | 0.29 | 0.1 |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| **大型** | 0.37 | 0.29 | 0.1 |'
- en: '| **medium** | 0.36 | 0.34 | 0.2 |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| **中等** | 0.36 | 0.34 | 0.2 |'
- en: '| **small** | 0.27 | 0.37 | 0.7 |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| **小型** | 0.27 | 0.37 | 0.7 |'
- en: 'The line plot that follows provides a visualization of these proportions. There
    is one “line” (set of connected dots) for each suitability level. The connected
    dots give the breakdown of size within a suitability category. We see that breeds
    with low suitability for kids are primarily small:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的线图提供了这些比例的可视化。每个适宜性级别都有一条“线”（连接的点集）。连接的点显示了适宜性类别内大小的分布。我们看到，适宜性低的品种主要是小型犬：
- en: '[PRE31]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '![](assets/leds_10in09.png)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in09.png)'
- en: 'We can also present these proportions as a collection of side-by-side bar plots,
    as shown here:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以将这些比例呈现为一组并列条形图，如下所示：
- en: '[PRE32]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '![](assets/leds_10in10.png)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in10.png)'
- en: So far, we’ve covered visualizations that incorporate one or two features. In
    the next section, we discuss visualizations that incorporate more than two features.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经涵盖了包含一个或两个特征的可视化。在下一节中，我们将讨论涵盖超过两个特征的可视化。
- en: Comparisons in Multivariate Settings
  id: totrans-226
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多元设置中的比较
- en: When we examine a distribution or relationship, we often want to compare it
    across subgroups of the data. This process of conditioning on additional factors
    often leads to visualizations that involve three or more variables. In this section,
    we explain how to read plots that are commonly used to visualize multiple variables.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们检查一个分布或者关系时，我们经常希望能够跨数据子群组进行比较。这个在额外因素的条件下进行的过程通常导致涉及三个或更多变量的可视化。在这一节中，我们将解释如何阅读用于可视化多个变量的常用图表。
- en: 'As an example, let’s compare the relationship between height and longevity
    across repetition categories. First, we collapse repetition (the typical number
    of times it takes for a dog to learn a new command) from six categories into four:
    <15, 15–25, 25–40, and 40+:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，让我们比较重复类别之间身高和寿命之间的关系。首先，我们将重复（狗学习新命令的典型次数）从六个类别合并为四个：<15、15-25、25-40和40+：
- en: '[PRE33]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Now each group has about 30 breeds in it, and having fewer categories makes
    it easier to decipher relationships. These categories are conveyed by differently
    shaped symbols in a scatterplot:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 现在每个组大约有30种品种，并且更少的类别使关系更容易解读。这些类别在散点图中由不同形状的符号表示：
- en: '[PRE34]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '![](assets/leds_10in11.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in11.png)'
- en: This plot would be challenging to interpret if there were more levels within
    the `repetition` feature.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 如果“重复”特征内部有更多级别，这种图表将很难解释。
- en: 'Facet plots offer an alternative approach to display these three features:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 分面图提供了显示这三个特征的另一种方法：
- en: '[PRE35]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '![](assets/leds_10in12.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in12.png)'
- en: Each of the four scatterplots shows the relationship between longevity and height
    for a different range of repetitions. By separating the scatterplots, we can better
    assess how the relationship between two quantitative features changes across the
    subgroups. And we can more easily see the range of height and longevity for each
    repetition range. We can see that the larger breeds tend to have shorter lifespans.
    Another interesting feature is that the lines are similar in slope, but the line
    for the 40+ repetitions sits about 1.5 years below the others. Those breeds tend
    to live about 1.5 years less on average than the other repetition categories,
    no matter the height.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 这四个散点图中的每一个展示了不同重复范围内寿命与身高之间的关系。通过分离散点图，我们可以更好地评估两个定量特征之间的关系如何随着子组的变化而变化。我们还可以更轻松地看到每个重复范围内身高和寿命的范围。我们可以看到，较大的品种往往寿命较短。另一个有趣的特征是，这些线的斜率相似，但40+重复的线大约比其他线低1.5年。这些品种的平均寿命比其他重复类别低约1.5年，无论其身高如何。
- en: 'Here we summarize the various plotting techniques for making comparisons when
    we have three (or more) features:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们总结了当我们有三个（或更多）特征时进行比较的各种绘图技术：
- en: Two quantitative and one qualitative
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 两个定量和一个定性
- en: We demonstrated this case already with a scatterplot that varies the markers
    according to the qualitative feature’s categories, or by the panels of scatterplots,
    with one for each category.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经通过散点图演示了这种情况，根据定性特征的类别变化标记，或者通过每个类别的散点图面板。
- en: Two qualitative and one quantitative feature
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 两个定性和一个定量特征
- en: We have seen in the collections of box plots of height according to breed size
    that we can compare the basic shape of a distribution across subgroups with side-by-side
    box plots. When we have two or more qualitative features, we can organize the
    box plots into groups according to one of the qualitative features.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经看到了根据品种大小的箱线图集合中，我们可以通过并排箱线图比较不同子组的分布的基本形状。当我们有两个或更多定性特征时，我们可以根据其中一个定性特征将箱线图组织成组。
- en: Three quantitative features
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 三个定量特征
- en: We can use a similar technique when we plot two quantitative features and one
    qualitative. This time, we convert one of the quantitative features into an ordinal
    feature, where each category typically has roughly the same number of records.
    Then we make faceted scatterplots of the other two features. We again look for
    similarities in relationships across the facets.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们绘制两个定量特征和一个定性特征时，我们可以使用类似的技术。这次，我们将其中一个定量特征转换为序数特征，其中每个类别通常具有大致相同数量的记录。然后，我们制作其他两个特征的分面散点图。我们再次寻找跨分面的关系相似性。
- en: Three qualitative features
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 三个定性特征
- en: When we examine relationships between qualitative features, we examine proportions
    of one feature within subgroups defined by another. In the previous section, the
    three line plots in one figure and the side-by-side bar plots both display such
    comparisons. With three (or more) qualitative features, we can continue to subdivide
    the data according to the combinations of levels of the features and compare these
    proportions using line plots, dot plots, side-by-side bar charts, and so forth.
    But these plots tend to get increasingly difficult to understand with further
    subdivisions.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们检查定性特征之间的关系时，我们会检查在另一个定性特征定义的子组内一个特征的比例。 在上一节中，一个图中的三条线图和并排的条形图都显示了这些比较。
    对于三（或更多）个定性特征，我们可以继续根据特征级别的组合细分数据，并使用线图、点图、并排条形图等比较这些比例。 但是这些图往往在进一步细分时变得越来越难以理解。
- en: Note
  id: totrans-247
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: It’s a good practice to break down a visualization to see whether a relationship
    changes for subgroups of the data determined by a qualitative feature. This technique
    is called *controlling for* a feature. You might get a surprise when, for example,
    a linear relationship in a scatterplot that has an upward trend reverses to downward
    trends in some or all facets of the scatterplot. This phenomenon is known as *Simpson’s
    paradox*. The paradox can happen with qualitative features as well. A [famous
    case](https://oreil.ly/h9tMw) occurred at Berkeley when the admissions to graduate
    school for men were higher than for women, but when examined within each program
    the rates favored women. The issue was that women were applying in greater numbers
    to programs that had lower admission rates.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 将可视化分解以查看由定性特征确定的数据子组是否会改变关系是一种良好的做法。 这种技术称为对特征进行“控制”。 当您在散点图中看到一个线性关系有上升趋势，但在散点图的一些或全部方面中却逆转为下降趋势时，您可能会感到惊讶。
    这种现象称为“辛普森悖论”。 这种悖论也可能发生在定性特征中。 在伯克利，男性的研究生院录取率高于女性的情况曾是一个[著名案例](https://oreil.ly/h9tMw)，但在每个项目中单独检查时，录取率更青睐于女性。
    问题在于，女性更多地申请了录取率较低的项目。
- en: Comparisons that involve more than one categorical variable can quickly become
    cumbersome as the number of possible combinations of categories grows. For example,
    there are 3 × 4 = 12 size-repetition combinations (if we had kept the original
    categories for repetitions, we would have 18 combinations). Examining a distribution
    across 12 subgroups can be difficult. Further, we come up against the problem
    of having too few observations in subgroups. Although there are nearly 200 rows
    in the dogs dataframe, half of the size-repetition combinations have 10 or fewer
    observations. (This is compounded by losing an observation when one feature has
    a missing value.) This *curse of dimensionality* also arises when we compare relationships
    with quantitative data. With just three quantitative variables, some of the scatterplots
    in a facet plot can easily have too few observations to confirm the shape of the
    relationship between two variables for the subgroups.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 涉及多个分类变量的比较可能会很快变得复杂，因为类别组合的可能性增多。例如，有 3 × 4 = 12 种大小重复的组合（如果我们保留原始的重复类别，会有
    18 种组合）。检查 12 个子组的分布可能会很困难。此外，我们面临的问题是子组中观察数太少。尽管狗数据框中有近 200 行，但一半的大小重复组合观察次数为
    10 或更少。 （当一个特征具有缺失值时，会丢失一个观察。）当我们比较与定量数据的关系时，也会出现这种“维度灾难”。仅仅三个定量变量在多面图中的一些散点图很容易观察到有太少的观察以确认两个变量在子组之间的关系形状。
- en: Now that we’ve seen practical examples of visualizations that are commonly used
    in exploratory data analysis, we proceed to discuss some high-level guidelines
    for EDA.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经看到了在探索性数据分析中常用的可视化实例，我们继续讨论一些EDA的高级指导原则。
- en: Guidelines for Exploration
  id: totrans-251
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索指南
- en: So far in this chapter, we have introduced the notion of feature types, seen
    how the feature type can help to figure out what plot to make, and described how
    to read distributions and relationships in a visualization. EDA relies on building
    these skills and flexibly developing your understanding of the data.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，在本章中，我们介绍了特征类型的概念，看到了特征类型如何帮助确定要制作的图表，并描述了如何在可视化中读取分布和关系。 EDA依赖于建立这些技能和灵活地发展对数据的理解。
- en: 'You saw EDA in action in [Chapter 9](ch09.html#ch-wrangling) when we developed
    checks for data quality and feature transformations to improve their usefulness
    in data analysis. Following are questions to guide you when making plots to explore
    the data:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第9章](ch09.html#ch-wrangling)中，我们开发了数据质量检查和特征转换，以提高它们在数据分析中的实用性，从而展示了EDA的实际应用。接下来是一些指导你进行绘图探索数据时的问题：
- en: How are the values of Feature X distributed?
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征X的值是如何分布的？
- en: How do Feature X and Feature Y relate to each other?
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征X和特征Y之间的关系如何？
- en: Is the distribution of Feature X the same across subgroups defined by Feature
    Z?
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征X的分布在由特征Z定义的子组中是否相同？
- en: Are there any unusual observations in X? In the combination of (X,Y)? In X for
    a subgroup of Z?
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征X中是否存在任何不寻常的观察？（X，Y）的组合中是否存在？在Z的子组中的X中是否存在？
- en: 'As you answer each of these questions, it is important to tie your answer back
    to the features measured and the context. It is also important to adopt an active,
    inquisitive approach to the investigation. To guide your explorations, ask yourself
    “what next” and “so what” questions, such as the following:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 当回答每个问题时，重要的是将你的答案与测量的特征和上下文联系起来。采用积极好奇的探索方法也很重要。为了指导你的探索，问自己“接下来怎么办”和“这对于什么有意义”的问题，例如以下问题：
- en: Do you have reason to expect that one group/observation might be different?
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你有理由期望一个组/观察结果可能不同吗？
- en: Why might your finding about shape matter?
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为什么你对形状的发现很重要？
- en: What additional comparison might bring added value to the investigation?
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 哪些额外的比较可能为调查增加价值？
- en: Are there any potentially important features to create comparisons with/against?
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有任何重要的特征可以进行比较/对比？
- en: In this process, it’s important to step away from the computer at times to mull
    over your work. You may want to read additional literature on the subject or go
    to an expert in the field to discuss your findings. For example, there could be
    good reasons for an unusual observation, and someone in the field can help clear
    up and provide more background.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个过程中，重要的是偶尔离开电脑，深思熟虑你的工作。你可能想要阅读关于这个主题的额外文献，或者去找领域内的专家讨论你的发现。例如，对于一个不寻常的观察可能有很好的理由，领域内的人可以帮助澄清并提供更多背景。
- en: We put these guidelines into practice with a concrete example of EDA next.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在接下来的具体EDA示例中将这些准则付诸实践。
- en: 'Example: Sale Prices for Houses'
  id: totrans-265
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 示例：房屋销售价格
- en: In this final section, we carry out an exploratory analysis using the questions
    in the previous section to direct our investigations. Although EDA typically begins
    in the data wrangling stage, for demonstration purposes the data we work with
    here have already been partially cleaned so that we can focus on exploring the
    features of interest. Note also that we do not discuss refining the visualizations
    in much detail; that topic is covered in [Chapter 11](ch11.html#ch-viz).
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 在最后一节中，我们使用前一节的问题进行探索性分析来引导我们的调查。尽管EDA通常从数据整理阶段开始，但出于演示目的，我们处理的数据已经部分清理，以便我们可以专注于探索感兴趣的特征。还要注意，我们没有详细讨论优化可视化的细节；该主题在[第11章](ch11.html#ch-viz)中有涵盖。
- en: Our data were scraped from the [*San Francisco Chronicle*](https://oreil.ly/tP9Xp)
    (SFChron) website. The data comprise a complete list of homes sold in the area
    from April 2003 to December 2008\. Since we have no plans to generalize our findings
    beyond the time period and the location and we are working with a census, the
    population matches the access frame and the sample consists of the entire population.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据来自[*旧金山纪事报*](https://oreil.ly/tP9Xp)（SFChron）网站。该数据包括2003年4月至2008年12月旧金山地区出售的所有房屋的完整列表。由于我们没有计划将我们的发现推广到时间段和位置之外，我们正在使用的是普查，人口与访问框架相匹配，样本包括整个人口。
- en: As for granularity, each record represents a sale of a home in the SF Bay Area
    during the specified time period. This means that if a home was sold twice during
    this time, then there are two records in the table. And if a home in the Bay Area
    was not up for sale during this time, then it does not appear in the dataset.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 至于粒度，每条记录代表了在指定时间段内在旧金山湾区销售的房屋。这意味着如果一套房在这段时间内销售了两次，那么表中将有两条记录。如果旧金山湾区的一套房在此期间没有上市出售，则它不会出现在数据集中。
- en: 'The data are in the dataframe `sfh_df`:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 数据位于数据帧`sfh_df`中：
- en: '[PRE36]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '|   | city | zip | street | price | br | lsqft | bsqft | timestamp |'
  id: totrans-271
  prefs: []
  type: TYPE_TB
  zh: '|   | 城市 | 邮政编码 | 街道 | 价格 | 卧室数 | 居住面积 | 建筑面积 | 时间戳 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-272
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **0** | Alameda | 94501.0 | 1001 Post Street | 689000.0 | 4.0 | 4484.0 |
    1982.0 | 2004-08-29 |'
  id: totrans-273
  prefs: []
  type: TYPE_TB
  zh: '| **0** | Alameda | 94501.0 | 1001 Post Street | 689000.0 | 4.0 | 4484.0 |
    1982.0 | 2004-08-29 |'
- en: '| **1** | Alameda | 94501.0 | 1001 Santa Clara Avenue | 880000.0 | 7.0 | 5914.0
    | 3866.0 | 2005-11-06 |'
  id: totrans-274
  prefs: []
  type: TYPE_TB
  zh: '| **1** | Alameda | 94501.0 | 1001 Santa Clara Avenue | 880000.0 | 7.0 | 5914.0
    | 3866.0 | 2005-11-06 |'
- en: '| **2** | Alameda | 94501.0 | 1001 Shoreline Drive \#102 | 393000.0 | 2.0 |
    39353.0 | 1360.0 | 2003-09-21 |'
  id: totrans-275
  prefs: []
  type: TYPE_TB
  zh: '| **2** | Alameda | 94501.0 | 1001 Shoreline Drive \#102 | 393000.0 | 2.0 |
    39353.0 | 1360.0 | 2003-09-21 |'
- en: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... |'
  id: totrans-276
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... |'
- en: '| **521488** | Windsor | 95492.0 | 9998 Blasi Drive | 392500.0 | NaN | 3111.0
    | NaN | 2008-02-17 |'
  id: totrans-277
  prefs: []
  type: TYPE_TB
  zh: '| **521488** | 温莎 | 95492.0 | 9998 Blasi Drive | 392500.0 | NaN | 3111.0 |
    NaN | 2008-02-17 |'
- en: '| **521489** | Windsor | 95492.0 | 9999 Blasi Drive | 414000.0 | NaN | 2915.0
    | NaN | 2008-02-17 |'
  id: totrans-278
  prefs: []
  type: TYPE_TB
  zh: '| **521489** | 温莎 | 95492.0 | 9999 Blasi Drive | 414000.0 | NaN | 2915.0 |
    NaN | 2008-02-17 |'
- en: '| **521490** | Windsor | 95492.0 | 999 Gemini Drive | 325000.0 | 3.0 | 7841.0
    | 1092.0 | 2003-09-21 |'
  id: totrans-279
  prefs: []
  type: TYPE_TB
  zh: '| **521490** | 温莎 | 95492.0 | 999 Gemini Drive | 325000.0 | 3.0 | 7841.0 |
    1092.0 | 2003-09-21 |'
- en: '[PRE37]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The dataset does not have an accompanying codebook, but we can determine the
    features and their storage types by inspection:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 'The dataset does not have an accompanying codebook, but we can determine the
    features and their storage types by inspection:'
- en: '[PRE38]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '[PRE39]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Based on the names of the fields, we expect the primary key to consist of some
    combination of city, zip code, street address, and date.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: Based on the names of the fields, we expect the primary key to consist of some
    combination of city, zip code, street address, and date.
- en: Sale price is our focus, so let’s begin by exploring its distribution. To develop
    your intuition about distributions, make a guess about the shape of the distribution
    before you start reading the next section. Don’t worry about the range of prices,
    just sketch the general shape.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: Sale price is our focus, so let’s begin by exploring its distribution. To develop
    your intuition about distributions, make a guess about the shape of the distribution
    before you start reading the next section. Don’t worry about the range of prices,
    just sketch the general shape.
- en: Understanding Price
  id: totrans-286
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Understanding Price
- en: 'It seems that a good guess for the shape of the distribution of sale price
    might be highly skewed to the right with a few very expensive houses. The following
    summary statistics confirm this skewness:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 'It seems that a good guess for the shape of the distribution of sale price
    might be highly skewed to the right with a few very expensive houses. The following
    summary statistics confirm this skewness:'
- en: '[PRE40]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '|   | price |'
  id: totrans-289
  prefs: []
  type: TYPE_TB
  zh: '|   | price |'
- en: '| --- | --- |'
  id: totrans-290
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| **0** | 22000.00 |'
  id: totrans-291
  prefs: []
  type: TYPE_TB
  zh: '| **0** | 22000.00 |'
- en: '| **25** | 410000.00 |'
  id: totrans-292
  prefs: []
  type: TYPE_TB
  zh: '| **25** | 410000.00 |'
- en: '| **50** | 555000.00 |'
  id: totrans-293
  prefs: []
  type: TYPE_TB
  zh: '| **50** | 555000.00 |'
- en: '| **75** | 744000.00 |'
  id: totrans-294
  prefs: []
  type: TYPE_TB
  zh: '| **75** | 744000.00 |'
- en: '| **100** | 20000000.00 |'
  id: totrans-295
  prefs: []
  type: TYPE_TB
  zh: '| **100** | 20000000.00 |'
- en: 'The median is closer to the lower quartile than the upper quartile. Also, the
    maximum is 40 times the median! We might wonder whether that $20M sale price is
    simply an anomalous value or whether there are many houses that sold at such a
    high price. To find out, we can zoom in on the right tail of the distribution
    and compute a few high percentiles:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 'The median is closer to the lower quartile than the upper quartile. Also, the
    maximum is 40 times the median! We might wonder whether that $20M sale price is
    simply an anomalous value or whether there are many houses that sold at such a
    high price. To find out, we can zoom in on the right tail of the distribution
    and compute a few high percentiles:'
- en: '[PRE41]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '|   | price |'
  id: totrans-298
  prefs: []
  type: TYPE_TB
  zh: '|   | price |'
- en: '| --- | --- |'
  id: totrans-299
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| **95.00** | 1295000.00 |'
  id: totrans-300
  prefs: []
  type: TYPE_TB
  zh: '| **95.00** | 1295000.00 |'
- en: '| **97.00** | 1508000.00 |'
  id: totrans-301
  prefs: []
  type: TYPE_TB
  zh: '| **97.00** | 1508000.00 |'
- en: '| **98.00** | 1707000.00 |'
  id: totrans-302
  prefs: []
  type: TYPE_TB
  zh: '| **98.00** | 1707000.00 |'
- en: '| **99.00** | 2110000.00 |'
  id: totrans-303
  prefs: []
  type: TYPE_TB
  zh: '| **99.00** | 2110000.00 |'
- en: '| **99.50** | 2600000.00 |'
  id: totrans-304
  prefs: []
  type: TYPE_TB
  zh: '| **99.50** | 2600000.00 |'
- en: '| **99.90** | 3950000.00 |'
  id: totrans-305
  prefs: []
  type: TYPE_TB
  zh: '| **99.90** | 3950000.00 |'
- en: 'We see that 99.9% of the houses sold for under $4M, so the $20M sale is indeed
    a rarity. Let’s examine the histogram of sale prices below $4M:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 'We see that 99.9% of the houses sold for under $4M, so the $20M sale is indeed
    a rarity. Let’s examine the histogram of sale prices below $4M:'
- en: '[PRE42]'
  id: totrans-307
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '[PRE43]'
  id: totrans-308
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '![](assets/leds_10in13.png)'
  id: totrans-309
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in13.png)'
- en: 'Even without the top 0.1%, the distribution remains highly skewed to the right,
    with a single mode around $500,000\. Let’s plot the histogram of the log-transformed
    sale price. The logarithm transformation often does a good job at converting a
    right-skewed distribution into one that is more symmetric:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 'Even without the top 0.1%, the distribution remains highly skewed to the right,
    with a single mode around $500,000\. Let’s plot the histogram of the log-transformed
    sale price. The logarithm transformation often does a good job at converting a
    right-skewed distribution into one that is more symmetric:'
- en: '[PRE44]'
  id: totrans-311
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '[PRE45]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '![](assets/leds_10in14.png)'
  id: totrans-313
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in14.png)'
- en: We see that the distribution of log-transformed sale price is roughly symmetric.
    Now that we have an understanding of the distribution of sale price, let’s consider
    the so-what questions posed in the previous section on EDA guidelines.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: We see that the distribution of log-transformed sale price is roughly symmetric.
    Now that we have an understanding of the distribution of sale price, let’s consider
    the so-what questions posed in the previous section on EDA guidelines.
- en: What Next?
  id: totrans-315
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: What Next?
- en: We have a description of the shape of the sale price, but we need to consider
    why the shape matters and look for comparison groups where distributions might
    differ.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经描述了销售价格的形状，但我们需要考虑形状的重要性，并寻找可能有所不同的分布的比较组。
- en: Shape matters because models and statistics based on symmetric distributions
    tend to have more robust and stable properties than highly skewed distributions.
    (We address this issue more when we cover linear models in [Chapter 15](ch15.html#ch-linear).)
    For this reason, we primarily work with the log-transformed sale price. And we
    might also choose to limit our analysis to sale prices under $4M since the super-expensive
    houses may behave quite differently.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 形状很重要，因为基于对称分布的模型和统计性质往往比高度偏斜的分布更具有稳健和稳定的特性（我们在[第15章](ch15.html#ch-linear)中详细讨论这个问题）。因此，我们主要使用对数转换后的销售价格进行分析。而且，我们可能还会选择限制分析范围在400万美元以下的销售价格，因为超级昂贵的房屋可能表现出截然不同的行为。
- en: As for possible comparisons to make, we look to the context. The housing market
    rose rapidly during this time and then the bottom fell out of the market. So the
    distribution of sale price in, say, 2004 might be quite different than in 2008,
    right before the crash. To explore this notion further, we can examine the behavior
    of prices over time. Alternatively, we can fix time, and examine the relationships
    between price and the other features of interest. Both approaches are potentially
    worthwhile.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 至于可能进行的比较，我们需要看背景情况。房地产市场在此期间迅速上涨，然后市场崩溃。因此，比如说，2004年的销售价格分布可能与2008年市场崩盘前的情况有很大不同。为了进一步探索这一观点，我们可以分析价格随时间的变化。或者，我们可以固定时间，分析价格与其他感兴趣特征之间的关系。这两种方法都可能是有价值的。
- en: 'We narrow our focus to one year (in [Chapter 11](ch11.html#ch-viz) we look
    at the time dimension). We reduce the data to sales made in 2004, so rising prices
    should have a limited impact on the distributions and relationships that we examine.
    To limit the influence of the very expensive and large houses, we also restrict
    the dataset to sales below $4M and houses smaller than 12,000 ft². This subset
    still contains large and expensive houses, but not outrageously so. Later, we
    further narrow our exploration to a few cities of interest:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将焦点缩小到一年（在[第11章](ch11.html#ch-viz)中我们将研究时间维度）。我们将数据限制在2004年的销售情况，因此上涨的房价对我们研究的分布和关系的影响应该是有限的。为了限制非常昂贵和大型的房屋的影响，我们还将数据集限制在售价低于400万美元和面积小于12,000平方英尺的房屋范围内。这个子集仍然包含大型和昂贵的房屋，但不会过于夸张。稍后，我们将进一步限制我们的研究范围到几个感兴趣的城市：
- en: '[PRE46]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '|   | city | zip | street | price | br | lsqft | bsqft | timestamp |'
  id: totrans-321
  prefs: []
  type: TYPE_TB
  zh: '|   | 城市 | 邮政编码 | 街道 | 价格 | 卧室数量 | 生活面积 | 建筑面积 | 时间戳 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-322
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **0** | Alameda | 94501.00 | 1001 Post Street | 689000.00 | 4.00 | 4484.00
    | 1982.00 | 2004-08-29 |'
  id: totrans-323
  prefs: []
  type: TYPE_TB
  zh: '| **0** | 阿拉米达 | 94501.00 | 1001 Post Street | 689000.00 | 4.00 | 4484.00 |
    1982.00 | 2004-08-29 |'
- en: '| **3** | Alameda | 94501.00 | 1001 Shoreline Drive \#108 | 485000.00 | 2.00
    | 39353.00 | 1360.00 | 2004-09-05 |'
  id: totrans-324
  prefs: []
  type: TYPE_TB
  zh: '| **3** | 阿拉米达 | 94501.00 | 1001 Shoreline Drive \#108 | 485000.00 | 2.00 |
    39353.00 | 1360.00 | 2004-09-05 |'
- en: '| **10** | Alameda | 94501.00 | 1001 Shoreline Drive \#306 | 390000.00 | 2.00
    | 39353.00 | 1360.00 | 2004-01-25 |'
  id: totrans-325
  prefs: []
  type: TYPE_TB
  zh: '| **10** | 阿拉米达 | 94501.00 | 1001 Shoreline Drive \#306 | 390000.00 | 2.00
    | 39353.00 | 1360.00 | 2004-01-25 |'
- en: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... |'
  id: totrans-326
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... |'
- en: '| **521467** | Windsor | 95492.00 | 9960 Herb Road | 439000.00 | 3.00 | 9583.00
    | 1626.00 | 2004-04-04 |'
  id: totrans-327
  prefs: []
  type: TYPE_TB
  zh: '| **521467** | 温莎 | 95492.00 | 9960 Herb Road | 439000.00 | 3.00 | 9583.00
    | 1626.00 | 2004-04-04 |'
- en: '| **521471** | Windsor | 95492.00 | 9964 Troon Court | 1200000.00 | 3.00 |
    20038.00 | 4281.00 | 2004-10-31 |'
  id: totrans-328
  prefs: []
  type: TYPE_TB
  zh: '| **521471** | 温莎 | 95492.00 | 9964 Troon Court | 1200000.00 | 3.00 | 20038.00
    | 4281.00 | 2004-10-31 |'
- en: '| **521478** | Windsor | 95492.00 | 9980 Brooks Road | 650000.00 | 3.00 | 45738.00
    | 1200.00 | 2004-10-24 |'
  id: totrans-329
  prefs: []
  type: TYPE_TB
  zh: '| **521478** | 温莎 | 95492.00 | 9980 Brooks Road | 650000.00 | 3.00 | 45738.00
    | 1200.00 | 2004-10-24 |'
- en: '[PRE47]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: For these data, the shape of the distribution of sale price remains the same—price
    is still highly skewed to the right. We continue to work with this subset to address
    the question of whether there are any potentially important features to study
    along with price.
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这些数据，销售价格分布的形状保持不变——价格仍然高度右偏。我们继续使用这个子集来解决是否有任何重要特征需要与价格一起研究的问题。
- en: Examining Other Features
  id: totrans-332
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 研究其他特征
- en: In addition to the sale price, which is our main focus, a few other features
    that might be important to our investigation are the size of the house, lot (or
    property) size, and number of bedrooms. We explore the distributions of these
    features and their relationship to sale price and to each other.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 除了销售价格外，这是我们的主要关注点，还有一些可能对我们的调查很重要的其他特征，例如房屋大小、地块（或物业）大小和卧室数量。我们探索这些特征的分布以及它们与销售价格和彼此之间的关系。
- en: 'Since the size of the house and the property are likely related to its price,
    it seems reasonable to guess that these features are also skewed to the right,
    so we apply a log transformation to the building size:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 由于房屋和地产的大小可能与其价格有关，因此猜测这些特征也可能向右倾斜，因此我们对建筑物大小进行对数转换是合理的：
- en: '[PRE48]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'We compare the distribution of building size on the regular and logged scales:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 我们比较了常规和对数比例尺上建筑面积的分布：
- en: '[PRE49]'
  id: totrans-337
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '![](assets/leds_10in15.png)'
  id: totrans-338
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in15.png)'
- en: 'The distribution is unimodal with a peak at about 1,500 ft², and many houses
    are over 2,500 ft² in size. We have confirmed our intuition: the log-transformed
    building size is nearly symmetric, although it maintains a slight skew. The same
    is the case for the distribution of lot size.'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 分布是单峰的，峰值约为1,500平方英尺，许多房屋的面积超过2,500平方英尺。我们已经确认了我们的直觉：对数转换后的建筑面积几乎是对称的，尽管保持了轻微的倾斜。对于地块面积的分布也是如此。
- en: 'Given that both house and lot size have skewed distributions, a scatterplot
    of the two should most likely be on log scale too:'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于房屋和地块面积都呈现偏斜分布，两者的散点图很可能也应采用对数比例尺：
- en: '[PRE50]'
  id: totrans-341
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'We compare the plot with and without the log transformation:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 我们比较了有和没有对数转换的图形：
- en: '![](assets/leds_10in16.png)'
  id: totrans-343
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in16.png)'
- en: 'The scatterplot on the left is in the original units, which makes it difficult
    to discern the relationship because most of the points are crowded into the bottom
    of the plotting region. In contrast, the scatterplot on the right reveals a few
    interesting features: there is a horizontal line along the bottom of the scatterplot,
    where it appears that many houses have the same lot size, no matter the building
    size; and there appears to be a slight positive log–log linear association between
    lot and building size.'
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 左边的散点图是以原始单位表示的，这使得很难辨别它们之间的关系，因为大多数点都挤在绘图区域的底部。相比之下，右边的散点图显示了一些有趣的特征：沿着散点图底部有一条水平线，看起来许多房屋的地块大小相同，无论建筑物的大小如何；而且似乎地块和建筑物大小之间存在轻微的正对数线性关系。
- en: 'Let’s look at some lower quantiles of lot size to try to figure out this unusual
    value:'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看一下地块大小的一些较低分位数，试图弄清这个异常值：
- en: '[PRE51]'
  id: totrans-346
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '|   | lot_size |'
  id: totrans-347
  prefs: []
  type: TYPE_TB
  zh: '|   | lot_size |'
- en: '| --- | --- |'
  id: totrans-348
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| **0.50** | 436.00 |'
  id: totrans-349
  prefs: []
  type: TYPE_TB
  zh: '| **0.50** | 436.00 |'
- en: '| **1.00** | 436.00 |'
  id: totrans-350
  prefs: []
  type: TYPE_TB
  zh: '| **1.00** | 436.00 |'
- en: '| **1.50** | 436.00 |'
  id: totrans-351
  prefs: []
  type: TYPE_TB
  zh: '| **1.50** | 436.00 |'
- en: '| **2.00** | 436.00 |'
  id: totrans-352
  prefs: []
  type: TYPE_TB
  zh: '| **2.00** | 436.00 |'
- en: '| **2.50** | 436.00 |'
  id: totrans-353
  prefs: []
  type: TYPE_TB
  zh: '| **2.50** | 436.00 |'
- en: '| **3.00** | 782.00 |'
  id: totrans-354
  prefs: []
  type: TYPE_TB
  zh: '| **3.00** | 782.00 |'
- en: 'We found something interesting: about 2.5% of the houses have a lot size of
    436 ft². This is tiny and makes little sense, so we make a note of the anomaly
    for further investigation.'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 我们发现了一些有趣的东西：大约有2.5%的房屋的地块面积为436平方英尺。这太小了，几乎没有意义，因此我们记录下这个异常值以供进一步调查。
- en: Another measure of house size is the number of bedrooms. Since this is a discrete
    quantitative variable, we can treat it as a qualitative feature and make a bar
    plot.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种衡量房屋大小的方法是卧室数量。由于这是一个离散的定量变量，我们可以将其视为定性特征并制作条形图。
- en: 'Houses in the Bay Area tend to be on the smaller side, so we venture to guess
    that the distribution will have a peak at three and skew to the right, with a
    few houses having five or six bedrooms. Let’s check:'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 旧金山湾区的房屋往往比较小，所以我们猜测分布会在三处达到峰值，并向右倾斜，有些房屋有五六间卧室。让我们来检查一下：
- en: '[PRE52]'
  id: totrans-358
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '![](assets/leds_10in17.png)'
  id: totrans-359
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in17.png)'
- en: The bar plot confirms that we generally had the right idea. However, we find
    that there are some houses with over 30 bedrooms! That’s a bit hard to believe
    and points to another possible data quality problem. Since the records include
    the addresses of the houses, we can double-check theses values on a real estate
    app.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 条形图证实了我们一般的想法。然而，我们发现有些房屋有超过30间卧室！这有点难以置信，也指向另一个可能的数据质量问题。由于记录包括房屋的地址，我们可以在房地产应用程序上再次检查这些值。
- en: 'In the meantime, let’s just transform the number of bedrooms into an ordinal
    feature by reassigning all values larger than 8 to 8+, and re-create the bar plot
    with the transformed data:'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 与此同时，让我们将卧室数量转换为有序特征，将所有大于8的值重新分配为8+，并使用转换后的数据重新创建条形图：
- en: '[PRE53]'
  id: totrans-362
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '![](assets/leds_10in18.png)'
  id: totrans-363
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in18.png)'
- en: We can see that even if we lump all of the houses with 8+ bedrooms together,
    they do not amount to many. The distribution is nearly symmetric with a peak at
    3, nearly the same proportion of houses have two or four bedrooms, and nearly
    the same have one or five. There is asymmetry present, with a few houses having
    six or more bedrooms.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，即使我们将所有具有8个或更多卧室的房屋归为一类，它们的数量也不多。分布几乎对称，高峰出现在3个卧室，大约有相同比例的房屋有两个或四个卧室，同样有一个或五个卧室的房屋。存在不对称性，有少数房屋拥有六个或更多卧室。
- en: 'Now we examine the relationship between the number of bedrooms and sale price.
    Before we proceed, we save the transformations done thus far:'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来研究卧室数量与销售价格之间的关系。在我们继续之前，我们先保存目前已经完成的转换：
- en: '[PRE54]'
  id: totrans-366
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: Now we’re ready to consider relationships between the number of bedrooms and
    other variables.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们准备考虑卧室数量与其他变量之间的关系。
- en: Delving Deeper into Relationships
  id: totrans-368
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 深入探讨关系
- en: 'Let’s begin by examining how the distribution of price changes for houses with
    different numbers of bedrooms. We can do this with box plots:'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从检查不同卧室数量的房屋价格分布开始。我们可以通过箱线图来完成这个任务：
- en: '[PRE55]'
  id: totrans-370
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '![](assets/leds_10in19.png)'
  id: totrans-371
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in19.png)'
- en: The median sale price increases with the number of bedrooms from one to five,
    but for the largest houses (those with more than six bedrooms), the distribution
    of log-transformed sale price appears nearly the same.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 中位数销售价格随着卧室数量从一增加到五而增加，但对于最大的房屋（超过六个卧室的房屋），对数转换后的销售价格分布几乎相同。
- en: 'We would expect houses with one bedroom to be smaller than houses with, say,
    four bedrooms. We might also guess that houses with six or more bedrooms are similar
    in size and price. To dive deeper, we consider a kind of transformation that divides
    price by building size to give us the price per square foot. We want to check
    if this feature is constant for all houses; in other words, if price is primarily
    determined by size. To do this we look at the relationship between the two pairs
    of size and price, and price per square foot and size:'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 我们预期一居室的房屋比四居室的房屋小。我们还可能猜想，六个或更多卧室的房屋在大小和价格上是类似的。为了深入了解，我们考虑一种将价格除以建筑面积的转换，得到每平方英尺价格的方法。我们想要检查这个特征是否对所有房屋都是恒定的；换句话说，价格是否主要由房屋大小决定。为此，我们查看了大小和价格、每平方英尺价格和大小之间的关系：
- en: '[PRE56]'
  id: totrans-374
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'We create two scatterplots. The one on the left shows price against building
    size (both log-transformed), and the plot on the right shows price per square
    foot (log-transformed) against building size. In addition, each plot has an added
    smooth curve that reflects the local average price or price per square foot for
    buildings of roughly the same size:'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 我们创建了两个散点图。左侧图显示价格与建筑面积（都进行了对数转换），右侧图显示每平方英尺价格（进行了对数转换）与建筑面积之间的关系。此外，每个图中都添加了一个平滑曲线，反映了大致相同大小建筑的局部平均价格或每平方英尺价格：
- en: '![](assets/leds_10in20.png)'
  id: totrans-376
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in20.png)'
- en: The lefthand plot shows what we expect—larger houses cost more. We also see
    that there is roughly a log–log association between these features.
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 左侧图表显示了我们的预期—更大的房屋成本更高。我们还看到这些特征之间大致存在对数关联。
- en: 'The righthand plot in this figure is interestingly nonlinear. We see that smaller
    houses cost more per square foot than larger ones, and the price per square foot
    for larger houses is relatively flat. This feature appears to be quite interesting,
    so we save the price per square foot transforms into `sfh`:'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 此图中的右侧图表非常有趣地呈现了非线性特征。我们看到较小的房屋每平方英尺的成本比较大的房屋更高，而较大房屋的每平方英尺价格相对平稳。这一特征似乎非常有趣，因此我们将每平方英尺价格转换保存为`sfh`：
- en: '[PRE57]'
  id: totrans-379
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: So far we haven’t considered the relationship between prices and location. There
    are house sales from over 150 different cities in this dataset. Some cities have
    a handful of sales and others have thousands. We continue our narrowing down of
    the data and examine relationships for a few cities next.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们还没有考虑价格与位置之间的关系。这个数据集中来自150多个不同城市的房屋销售数据。有些城市只有少数销售记录，而其他城市则有数千条。我们继续缩小数据范围，并在接下来的几个城市中研究关系。
- en: Fixing Location
  id: totrans-381
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 修正位置
- en: 'You may have heard the expression: there are three things that matter in real
    estate—*location, location, location.* Comparing prices across cities might bring
    additional insights to our investigation.'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能听过这样的表达：房地产有三个重要因素—*位置、位置、位置*。比较不同城市的房价可能会为我们的调查带来额外的见解。
- en: 'We examine data for some cities in the San Francisco East Bay: Richmond, El
    Cerrito, Albany, Berkeley, Walnut Creek, Lamorinda (which is a combination of
    Lafayette, Moraga, and Orinda, three neighboring bedroom communities), and Piedmont.'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 我们检查了旧金山东湾一些城市的数据：里士满、埃尔塞里托、奥尔巴尼、伯克利、核桃溪、拉莫林达（这是拉斐特、莫拉加和奥林达三个相邻的卧室社区的组合），以及皮德蒙特。
- en: 'Let’s begin by comparing the distribution of sale price for these cities:'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始比较这些城市的销售价格分布：
- en: '[PRE58]'
  id: totrans-385
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '![](assets/leds_10in21.png)'
  id: totrans-386
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in21.png)'
- en: The box plots show that Lamorinda and Piedmont tend to have more expensive homes
    and Richmond has the least expensive, but there is overlap in sale price for many
    cities.
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 箱线图显示，拉莫林达和皮德蒙特的房屋更昂贵，里士满最便宜，但许多城市的销售价格存在重叠。
- en: 'Next, we examine the relationship between price per square foot and house size
    more closely with faceted scatterplots, one for each of four cities:'
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将使用分面散点图更仔细地检查每个四个城市的房价与房屋大小之间的关系：
- en: '[PRE59]'
  id: totrans-389
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '![](assets/leds_10in22.png)'
  id: totrans-390
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_10in22.png)'
- en: The relationship between price per square foot and building size is roughly
    log-linear, with a negative association for each of the four locations. While
    not parallel, it does appear that there is a location boost for houses, regardless
    of size, where, say, a house in Berkeley costs about $250 more per square foot
    than a house in Richmond. We also see that Piedmont and Lamorinda are more expensive
    cities, and in both cities there is not the same reduction in price per square
    foot for larger houses in comparison to smaller ones. These plots support the
    “location, location, location” adage.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 价格每平方英尺与建筑面积的关系大致呈对数线性，对于这四个地点每个都存在负相关。虽然不是平行的，但似乎在房子方面存在地理位置的提升，例如伯克利的房屋每平方英尺比里士满的房屋贵约250美元。我们还看到皮德蒙特和拉莫林达是更昂贵的城市，在这两个城市中，与较小房屋相比，较大房屋每平方英尺的价格没有同样的降低。这些图表支持“地段，地段，地段”的格言。
- en: In EDA, we often revisit earlier plots to check whether new findings add insights
    to previous visualizations. It is important to continually take stock of our findings
    and use them to guide us in further explorations. Let’s summarize our findings
    so far.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 在探索性数据分析（EDA）中，我们经常回顾早期的图表，以检查新发现是否为先前的可视化增添了新的见解。持续盘点我们的发现并利用它们指导我们进一步的探索至关重要。让我们总结一下到目前为止我们的发现。
- en: EDA Discoveries
  id: totrans-393
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: EDA 发现
- en: 'Our EDA has uncovered several interesting phenomena. Briefly, some of the most
    notable are:'
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的EDA揭示了几个有趣的现象。简而言之，其中一些最显著的是：
- en: Sale price and building size are highly skewed to the right with one mode.
  id: totrans-395
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 销售价格和建筑面积呈右偏分布，有一个主模式。
- en: Price per square foot decreases nonlinearly with building size, with smaller
    houses costing more per square foot than larger houses and price per square foot
    being roughly constant for large houses.
  id: totrans-396
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每平方英尺价格随建筑面积的增加呈非线性下降趋势，较小的房屋每平方英尺的成本高于较大的房屋，并且每平方英尺的价格在大房屋中大致保持不变。
- en: More desirable locations add a bump in sale price that is roughly the same amount
    for houses of different sizes.
  id: totrans-397
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更理想的地理位置为房屋的销售价格增加了一点，对于不同大小的房屋增加的金额大致相同。
- en: There are many additional explorations we can (and should) perform, and there
    are several checks that we should make. These include investigating the 436 value
    for lot size and cross-checking unusual houses, like the 30-bedroom house and
    the $20M house, with online real estate apps.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以（也应该）进行许多其他探索，还有几个我们应该进行的检查。这些包括调查占地面积436的价值和用在线房地产应用程序交叉检查异常房屋，例如30卧室房屋和2000万美元的房屋。
- en: We narrowed our investigation down to one year and later to a few cities. This
    narrowing helped us control for features that might interfere with finding simple
    relationships. For example, since the data were collected over several years,
    the date of sale may confound the relationship between sale price and number of
    bedrooms. At other times, we want to consider the effect of time on prices. To
    examine price changes over time, we often make line plots, and we adjust for inflation.
    We revisit these data in [Chapter 11](ch11.html#ch-viz) when we consider data
    scope and look more closely at trends in time.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将我们的调查限制在一年内，后来又缩小到几个城市。这种缩小帮助我们控制可能干扰发现简单关系的特征。例如，由于数据是在几年内收集的，销售日期可能混淆了销售价格和卧室数量之间的关系。在其他时候，我们希望考虑时间对价格的影响。为了检查随时间的价格变化，我们经常制作折线图，并对通货膨胀进行调整。我们在[第11章](ch11.html#ch-viz)重新审视这些数据时，考虑数据范围并更仔细地观察时间趋势。
- en: Despite being brief, this section conveys the basic approach of EDA in action.
    For an extended case study on a different dataset, see [Chapter 12](ch12.html#ch-pa).
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管简短，本节传达了EDA实践的基本方法。有关不同数据集的扩展案例研究，请参阅[第12章](ch12.html#ch-pa)。
- en: Summary
  id: totrans-401
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we introduced the nominal, ordinal, and numerical feature types
    and their importance for data analysis. When presented with a dataset, we demonstrated
    how to consult the data dictionary and the data itself to determine the feature
    types for each column. We also explained how the storage type is not to be confused
    with feature type. Since much of EDA is carried out with statistical graphs, we
    described how to recognize and interpret the shapes and patterns that emerge and
    how to connect these to the data being plotted. Finally, we provided guidelines
    for how you might conduct an EDA, and provided an example.
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了名义、序数和数值特征类型及其在数据分析中的重要性。当面对数据集时，我们展示了如何查阅数据字典和数据本身，以确定每列的特征类型。我们还解释了存储类型与特征类型不应混淆。由于大部分EDA是通过统计图表进行的，我们描述了如何识别和解释出现的形状和模式，以及如何将其与正在绘制的数据联系起来。最后，我们提供了进行EDA的指导方针，并提供了一个示例。
- en: One approach that you may find helpful in developing your intuition about distributions
    and relationships of features is to make a guess about what you will see before
    you make the plot. Try to sketch or describe what you think the shape of distribution
    will be, and then make the plot. For example, variables that have a natural lower/upper
    bound on their values tend to have a long tail on the opposite of the bound. The
    distribution of income (bounded below by 0) tends to have a long right tail, and
    exam scores (bounded above by 100) tend to have a long left tail. You can make
    similar guesses for the shape of a relationship. We saw that price and house size
    had nearly a log–log linear relationship. As you gain intuition about shapes,
    it becomes easier to carry out an EDA; you can more easily identify when a plot
    shows a surprising shape.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 有一种方法可能对你在开发关于特征分布和关系直觉很有帮助，那就是在绘制图表之前先对你将看到的内容进行猜测。试着草拟或描述你认为分布形状会是什么样子，然后再绘制图表。例如，具有自然下限/上限值的变量往往在边界的对面有一个长尾。收入分布（下限为0）往往有一个长尾在右侧，而考试成绩（上限为100）往往有一个长尾在左侧。你可以对关系的形状做类似的猜测。我们发现价格和房屋大小几乎呈对数-对数线性关系。当你对形状有了直觉后，进行探索性数据分析（EDA）就变得更容易；你可以更容易地识别出图表显示出令人惊讶的形状。
- en: Our focus in this chapter was on “reading” visualizations. In [Chapter 11](ch11.html#ch-viz),
    we provide style guidelines for how to create informative, effective, and beautiful
    graphs. Many of the ideas in that chapter were followed here, but we have not
    called attention to them.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的重点是“阅读”可视化结果。在[第11章](ch11.html#ch-viz)中，我们提供了如何创建信息丰富、有效和美观的图表的样式指南。这一章中许多思想也在这里得到了遵循，但我们并未特别指出它们。
