<html><head></head><body><section data-pdf-bookmark="Chapter 4. Linear Algebra" data-type="chapter" epub:type="chapter"><div class="chapter" id="linear_algebra">&#13;
<h1><span class="label">Chapter 4. </span>Linear Algebra</h1>&#13;
&#13;
<blockquote data-type="epigraph" epub:type="epigraph">&#13;
<p>Is there anything more useless or less useful than algebra?</p>&#13;
<p data-type="attribution">Billy Connolly</p>&#13;
</blockquote>&#13;
&#13;
<p>Linear algebra<a data-primary="mathematics" data-secondary="linear algebra" data-type="indexterm" id="Malg04"/> is the branch of mathematics that deals with <em>vector spaces</em>. Although I can’t hope to teach you linear algebra in a brief chapter, it underpins a large number of data science concepts and techniques, which means I owe it to you to at least try.  What we learn in this chapter we’ll use heavily throughout the rest of the book.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Vectors" data-type="sect1"><div class="sect1" id="idm45635760492664">&#13;
<h1>Vectors</h1>&#13;
&#13;
<p>Abstractly, <em>vectors</em> are objects<a data-primary="linear algebra" data-secondary="vectors" data-type="indexterm" id="LAvec04"/><a data-primary="vectors" data-type="indexterm" id="vec04"/><a data-primary="scalar multiplication" data-type="indexterm" id="idm45635760487944"/> that can be added together to form new vectors and that can be multiplied by <em>scalars</em> (i.e., numbers), also to form new vectors.</p>&#13;
&#13;
<p>Concretely (for us), vectors are points in some finite-dimensional space.  Although you might not think of your data as vectors, they are often a useful way to represent numeric data.</p>&#13;
&#13;
<p>For example, if you have the heights, weights, and ages of a large number of people, you can treat your data as three-dimensional vectors <code>[height, weight, age]</code>.  If you’re teaching a class with four exams, you can treat student grades as four-dimensional vectors <code>[exam1, exam2, exam3, exam4]</code>.</p>&#13;
&#13;
<p>The simplest from-scratch approach is to represent vectors as lists of numbers.  A list of three numbers corresponds to a vector in three-dimensional space, and vice versa.</p>&#13;
&#13;
<p>We’ll accomplish this with a type alias that says a <code>Vector</code> is just a <code>list</code> of <code>float</code>s:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="kn">from</code> <code class="nn">typing</code> <code class="kn">import</code> <code class="n">List</code>&#13;
&#13;
<code class="n">Vector</code> <code class="o">=</code> <code class="n">List</code><code class="p">[</code><code class="nb">float</code><code class="p">]</code>&#13;
&#13;
<code class="n">height_weight_age</code> <code class="o">=</code> <code class="p">[</code><code class="mi">70</code><code class="p">,</code>  <code class="c1"># inches,</code>&#13;
                     <code class="mi">170</code><code class="p">,</code> <code class="c1"># pounds,</code>&#13;
                     <code class="mi">40</code> <code class="p">]</code> <code class="c1"># years</code>&#13;
&#13;
<code class="n">grades</code> <code class="o">=</code> <code class="p">[</code><code class="mi">95</code><code class="p">,</code>   <code class="c1"># exam1</code>&#13;
          <code class="mi">80</code><code class="p">,</code>   <code class="c1"># exam2</code>&#13;
          <code class="mi">75</code><code class="p">,</code>   <code class="c1"># exam3</code>&#13;
          <code class="mi">62</code> <code class="p">]</code>  <code class="c1"># exam4</code></pre>&#13;
&#13;
<p>We’ll<a data-primary="arithmetic operations" data-type="indexterm" id="idm45635760341848"/> also want to perform <em>arithmetic</em> on vectors.  Because Python <code>list</code>s aren’t vectors (and hence provide no facilities for vector arithmetic), we’ll need to build these arithmetic tools ourselves.  So let’s start with that.</p>&#13;
&#13;
<p>To begin with, we’ll frequently need to add two vectors.  Vectors add <em>componentwise</em>.  This means that if two vectors <code>v</code> and <code>w</code> are the same length, their sum is just the vector whose first element is <code>v[0] + w[0]</code>, whose second element is <code>v[1] + w[1]</code>, and so on.  (If they’re not the same length, then we’re not allowed to add them.)</p>&#13;
&#13;
<p>For example, adding the vectors <code>[1, 2]</code> and <code>[2, 1]</code> results in <code>[1 + 2, 2 + 1]</code> or <code>[3, 3]</code>, as shown in <a data-type="xref" href="#adding_two_vectors">Figure 4-1</a>.</p>&#13;
&#13;
<figure><div class="figure" id="adding_two_vectors">&#13;
<img alt="Adding two vectors." src="assets/dsf2_0401.png"/>&#13;
<h6><span class="label">Figure 4-1. </span>Adding two vectors</h6>&#13;
</div></figure>&#13;
&#13;
<p>We can easily implement this by <code>zip</code>-ing the vectors together and using a list comprehension to add the corresponding elements:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">add</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">,</code> <code class="n">w</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Adds corresponding elements"""</code>&#13;
    <code class="k">assert</code> <code class="nb">len</code><code class="p">(</code><code class="n">v</code><code class="p">)</code> <code class="o">==</code> <code class="nb">len</code><code class="p">(</code><code class="n">w</code><code class="p">),</code> <code class="s2">"vectors must be the same length"</code>&#13;
&#13;
    <code class="k">return</code> <code class="p">[</code><code class="n">v_i</code> <code class="o">+</code> <code class="n">w_i</code> <code class="k">for</code> <code class="n">v_i</code><code class="p">,</code> <code class="n">w_i</code> <code class="ow">in</code> <code class="nb">zip</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">w</code><code class="p">)]</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">add</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code> <code class="o">==</code> <code class="p">[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">7</code><code class="p">,</code> <code class="mi">9</code><code class="p">]</code></pre>&#13;
&#13;
<p>Similarly, to subtract two vectors we just subtract the corresponding elements:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">subtract</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">,</code> <code class="n">w</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Subtracts corresponding elements"""</code>&#13;
    <code class="k">assert</code> <code class="nb">len</code><code class="p">(</code><code class="n">v</code><code class="p">)</code> <code class="o">==</code> <code class="nb">len</code><code class="p">(</code><code class="n">w</code><code class="p">),</code> <code class="s2">"vectors must be the same length"</code>&#13;
&#13;
    <code class="k">return</code> <code class="p">[</code><code class="n">v_i</code> <code class="o">-</code> <code class="n">w_i</code> <code class="k">for</code> <code class="n">v_i</code><code class="p">,</code> <code class="n">w_i</code> <code class="ow">in</code> <code class="nb">zip</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">w</code><code class="p">)]</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">subtract</code><code class="p">([</code><code class="mi">5</code><code class="p">,</code> <code class="mi">7</code><code class="p">,</code> <code class="mi">9</code><code class="p">],</code> <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code> <code class="o">==</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]</code></pre>&#13;
&#13;
<p>We’ll also sometimes want to componentwise sum a list of vectors—that is, create a new vector whose first element is the sum of all the first elements, whose second element is the sum of all the second elements, and so on:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">vector_sum</code><code class="p">(</code><code class="n">vectors</code><code class="p">:</code> <code class="n">List</code><code class="p">[</code><code class="n">Vector</code><code class="p">])</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Sums all corresponding elements"""</code>&#13;
    <code class="c1"># Check that vectors is not empty</code>&#13;
    <code class="k">assert</code> <code class="n">vectors</code><code class="p">,</code> <code class="s2">"no vectors provided!"</code>&#13;
&#13;
    <code class="c1"># Check the vectors are all the same size</code>&#13;
    <code class="n">num_elements</code> <code class="o">=</code> <code class="nb">len</code><code class="p">(</code><code class="n">vectors</code><code class="p">[</code><code class="mi">0</code><code class="p">])</code>&#13;
    <code class="k">assert</code> <code class="nb">all</code><code class="p">(</code><code class="nb">len</code><code class="p">(</code><code class="n">v</code><code class="p">)</code> <code class="o">==</code> <code class="n">num_elements</code> <code class="k">for</code> <code class="n">v</code> <code class="ow">in</code> <code class="n">vectors</code><code class="p">),</code> <code class="s2">"different sizes!"</code>&#13;
&#13;
    <code class="c1"># the i-th element of the result is the sum of every vector[i]</code>&#13;
    <code class="k">return</code> <code class="p">[</code><code class="nb">sum</code><code class="p">(</code><code class="n">vector</code><code class="p">[</code><code class="n">i</code><code class="p">]</code> <code class="k">for</code> <code class="n">vector</code> <code class="ow">in</code> <code class="n">vectors</code><code class="p">)</code>&#13;
            <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="n">num_elements</code><code class="p">)]</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">vector_sum</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="p">[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code> <code class="p">[</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">]])</code> <code class="o">==</code> <code class="p">[</code><code class="mi">16</code><code class="p">,</code> <code class="mi">20</code><code class="p">]</code></pre>&#13;
&#13;
<p>We’ll also need to be able to multiply a vector by a scalar, which we do simply by multiplying each element of the vector by that number:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">scalar_multiply</code><code class="p">(</code><code class="n">c</code><code class="p">:</code> <code class="nb">float</code><code class="p">,</code> <code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Multiplies every element by c"""</code>&#13;
    <code class="k">return</code> <code class="p">[</code><code class="n">c</code> <code class="o">*</code> <code class="n">v_i</code> <code class="k">for</code> <code class="n">v_i</code> <code class="ow">in</code> <code class="n">v</code><code class="p">]</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">scalar_multiply</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code> <code class="o">==</code> <code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">6</code><code class="p">]</code></pre>&#13;
&#13;
<p>This allows us to compute the componentwise means of a list of (same-sized) vectors:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">vector_mean</code><code class="p">(</code><code class="n">vectors</code><code class="p">:</code> <code class="n">List</code><code class="p">[</code><code class="n">Vector</code><code class="p">])</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Computes the element-wise average"""</code>&#13;
    <code class="n">n</code> <code class="o">=</code> <code class="nb">len</code><code class="p">(</code><code class="n">vectors</code><code class="p">)</code>&#13;
    <code class="k">return</code> <code class="n">scalar_multiply</code><code class="p">(</code><code class="mi">1</code><code class="o">/</code><code class="n">n</code><code class="p">,</code> <code class="n">vector_sum</code><code class="p">(</code><code class="n">vectors</code><code class="p">))</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">vector_mean</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="p">[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code> <code class="o">==</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">]</code></pre>&#13;
&#13;
<p>A<a data-primary="dot product" data-type="indexterm" id="idm45635759996968"/> less obvious tool is the <em>dot product</em>.  The dot product of two vectors is the sum of their componentwise products:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">dot</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">,</code> <code class="n">w</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">float</code><code class="p">:</code>&#13;
    <code class="sd">"""Computes v_1 * w_1 + ... + v_n * w_n"""</code>&#13;
    <code class="k">assert</code> <code class="nb">len</code><code class="p">(</code><code class="n">v</code><code class="p">)</code> <code class="o">==</code> <code class="nb">len</code><code class="p">(</code><code class="n">w</code><code class="p">),</code> <code class="s2">"vectors must be same length"</code>&#13;
&#13;
    <code class="k">return</code> <code class="nb">sum</code><code class="p">(</code><code class="n">v_i</code> <code class="o">*</code> <code class="n">w_i</code> <code class="k">for</code> <code class="n">v_i</code><code class="p">,</code> <code class="n">w_i</code> <code class="ow">in</code> <code class="nb">zip</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">w</code><code class="p">))</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">dot</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code> <code class="o">==</code> <code class="mi">32</code>  <code class="c1"># 1 * 4 + 2 * 5 + 3 * 6</code></pre>&#13;
&#13;
<p>If <code>w</code> has magnitude 1, the dot product measures how far the vector <code>v</code> extends in the <code>w</code> direction. For example, if <code>w = [1, 0]</code>, then <code>dot(v, w)</code> is just the first component of <code>v</code>.  Another way of saying this is that it’s the length of the vector you’d get if you <em>projected</em> <code>v</code> onto <code>w</code> (<a data-type="xref" href="#dot_product_as_vector_projection">Figure 4-2</a>).</p>&#13;
&#13;
<figure><div class="figure" id="dot_product_as_vector_projection">&#13;
<img alt="Dot product as a vector projection." src="assets/dsf2_0402.png"/>&#13;
<h6><span class="label">Figure 4-2. </span>The dot product as vector projection</h6>&#13;
</div></figure>&#13;
&#13;
<p>Using this, it’s<a data-primary="sum of squares, computing" data-type="indexterm" id="idm45635759758552"/> easy to compute a vector’s <em>sum of squares</em>:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">sum_of_squares</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">float</code><code class="p">:</code>&#13;
    <code class="sd">"""Returns v_1 * v_1 + ... + v_n * v_n"""</code>&#13;
    <code class="k">return</code> <code class="n">dot</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">v</code><code class="p">)</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">sum_of_squares</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code> <code class="o">==</code> <code class="mi">14</code>  <code class="c1"># 1 * 1 + 2 * 2 + 3 * 3</code></pre>&#13;
&#13;
<p>which<a data-primary="magnitude, computing" data-type="indexterm" id="idm45635759734072"/> we can use to compute its <em>magnitude</em> (or length):</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="kn">import</code> <code class="nn">math</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">magnitude</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">float</code><code class="p">:</code>&#13;
    <code class="sd">"""Returns the magnitude (or length) of v"""</code>&#13;
    <code class="k">return</code> <code class="n">math</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">sum_of_squares</code><code class="p">(</code><code class="n">v</code><code class="p">))</code>   <code class="c1"># math.sqrt is square root function</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">magnitude</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">])</code> <code class="o">==</code> <code class="mi">5</code></pre>&#13;
&#13;
<p>We now have all the pieces we need to compute the distance between two vectors, defined as:</p>&#13;
<div data-type="equation">&#13;
<math alttext="StartRoot left-parenthesis v 1 minus w 1 right-parenthesis squared plus ellipsis plus left-parenthesis v Subscript n Baseline minus w Subscript n Baseline right-parenthesis squared EndRoot" display="block">&#13;
  <msqrt>&#13;
    <mrow>&#13;
      <msup><mrow><mo>(</mo><msub><mi>v</mi> <mn>1</mn> </msub><mo>-</mo><msub><mi>w</mi> <mn>1</mn> </msub><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
      <mo>+</mo>&#13;
      <mo>...</mo>&#13;
      <mo>+</mo>&#13;
      <msup><mrow><mo>(</mo><msub><mi>v</mi> <mi>n</mi> </msub><mo>-</mo><msub><mi>w</mi> <mi>n</mi> </msub><mo>)</mo></mrow> <mn>2</mn> </msup>&#13;
    </mrow>&#13;
  </msqrt>&#13;
</math>&#13;
</div>&#13;
&#13;
<p>In code:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">squared_distance</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">,</code> <code class="n">w</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">float</code><code class="p">:</code>&#13;
    <code class="sd">"""Computes (v_1 - w_1) ** 2 + ... + (v_n - w_n) ** 2"""</code>&#13;
    <code class="k">return</code> <code class="n">sum_of_squares</code><code class="p">(</code><code class="n">subtract</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">w</code><code class="p">))</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">distance</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">,</code> <code class="n">w</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">float</code><code class="p">:</code>&#13;
    <code class="sd">"""Computes the distance between v and w"""</code>&#13;
    <code class="k">return</code> <code class="n">math</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">squared_distance</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">w</code><code class="p">))</code></pre>&#13;
&#13;
<p>This is possibly clearer if we write it as (the equivalent):</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">distance</code><code class="p">(</code><code class="n">v</code><code class="p">:</code> <code class="n">Vector</code><code class="p">,</code> <code class="n">w</code><code class="p">:</code> <code class="n">Vector</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="nb">float</code><code class="p">:</code>&#13;
    <code class="k">return</code> <code class="n">magnitude</code><code class="p">(</code><code class="n">subtract</code><code class="p">(</code><code class="n">v</code><code class="p">,</code> <code class="n">w</code><code class="p">))</code></pre>&#13;
&#13;
<p>That should be plenty to get us started.  We’ll be using these functions heavily throughout the book.<a data-primary="" data-startref="LAvec04" data-type="indexterm" id="idm45635759446920"/><a data-primary="" data-startref="vec04" data-type="indexterm" id="idm45635759446072"/></p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Using<a data-primary="lists" data-secondary="using as vectors" data-type="indexterm" id="idm45635759444184"/> lists as vectors is great for exposition but terrible for performance.</p>&#13;
&#13;
<p>In<a data-primary="NumPy library" data-type="indexterm" id="idm45635759442664"/> production code, you would want to use the NumPy library,&#13;
which includes a high-performance array class with all sorts of arithmetic operations included.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Matrices" data-type="sect1"><div class="sect1" id="idm45635760491720">&#13;
<h1>Matrices</h1>&#13;
&#13;
<p>A <em>matrix</em> is<a data-primary="linear algebra" data-secondary="matrices" data-type="indexterm" id="LAmat04"/><a data-primary="matrices" data-type="indexterm" id="mat04"/> a two-dimensional collection of numbers.  We will represent matrices as lists of lists, with each inner list having the same size and representing a <em>row</em> of the matrix.  If <code>A</code> is a matrix, then <code>A[i][j]</code> is the element in the <em>i</em>th row and the <em>j</em>th column.  Per mathematical convention, we will frequently use capital letters to represent matrices.  For example:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="c1"># Another type alias</code>&#13;
<code class="n">Matrix</code> <code class="o">=</code> <code class="n">List</code><code class="p">[</code><code class="n">List</code><code class="p">[</code><code class="nb">float</code><code class="p">]]</code>&#13;
&#13;
<code class="n">A</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>  <code class="c1"># A has 2 rows and 3 columns</code>&#13;
     <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]]</code>&#13;
&#13;
<code class="n">B</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">],</code>     <code class="c1"># B has 3 rows and 2 columns</code>&#13;
     <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code>&#13;
     <code class="p">[</code><code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]]</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>In mathematics, you would usually name the first row of the matrix “row 1” and the first column “column 1.”  Because we’re representing matrices with Python <code>list</code>s, which are zero-indexed, we’ll call the first row of a matrix “row 0” and the first column “column 0.”</p>&#13;
</div>&#13;
&#13;
<p>Given this list-of-lists representation, the matrix <code>A</code> has <code>len(A)</code> rows and <code>len(A[0])</code> columns, which we consider its <code>shape</code>:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="kn">from</code> <code class="nn">typing</code> <code class="kn">import</code> <code class="n">Tuple</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">shape</code><code class="p">(</code><code class="n">A</code><code class="p">:</code> <code class="n">Matrix</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Tuple</code><code class="p">[</code><code class="nb">int</code><code class="p">,</code> <code class="nb">int</code><code class="p">]:</code>&#13;
    <code class="sd">"""Returns (# of rows of A, # of columns of A)"""</code>&#13;
    <code class="n">num_rows</code> <code class="o">=</code> <code class="nb">len</code><code class="p">(</code><code class="n">A</code><code class="p">)</code>&#13;
    <code class="n">num_cols</code> <code class="o">=</code> <code class="nb">len</code><code class="p">(</code><code class="n">A</code><code class="p">[</code><code class="mi">0</code><code class="p">])</code> <code class="k">if</code> <code class="n">A</code> <code class="k">else</code> <code class="mi">0</code>   <code class="c1"># number of elements in first row</code>&#13;
    <code class="k">return</code> <code class="n">num_rows</code><code class="p">,</code> <code class="n">num_cols</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">shape</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code> <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code> <code class="o">==</code> <code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code>  <code class="c1"># 2 rows, 3 columns</code></pre>&#13;
&#13;
<p>If a matrix has <em>n</em> rows and <em>k</em> columns, we will refer to it as an <em>n × k matrix</em>.  We can (and sometimes will) think of each row of an <em>n × k</em> matrix as a vector of length <em>k</em>, and each column as a vector of length <em>n</em>:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">get_row</code><code class="p">(</code><code class="n">A</code><code class="p">:</code> <code class="n">Matrix</code><code class="p">,</code> <code class="n">i</code><code class="p">:</code> <code class="nb">int</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Returns the i-th row of A (as a Vector)"""</code>&#13;
    <code class="k">return</code> <code class="n">A</code><code class="p">[</code><code class="n">i</code><code class="p">]</code>             <code class="c1"># A[i] is already the ith row</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">get_column</code><code class="p">(</code><code class="n">A</code><code class="p">:</code> <code class="n">Matrix</code><code class="p">,</code> <code class="n">j</code><code class="p">:</code> <code class="nb">int</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Vector</code><code class="p">:</code>&#13;
    <code class="sd">"""Returns the j-th column of A (as a Vector)"""</code>&#13;
    <code class="k">return</code> <code class="p">[</code><code class="n">A_i</code><code class="p">[</code><code class="n">j</code><code class="p">]</code>          <code class="c1"># jth element of row A_i</code>&#13;
            <code class="k">for</code> <code class="n">A_i</code> <code class="ow">in</code> <code class="n">A</code><code class="p">]</code>   <code class="c1"># for each row A_i</code></pre>&#13;
&#13;
<p>We’ll also want to be able to create a matrix given its shape and a function for generating its elements.  We can do this using a nested list comprehension:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="kn">from</code> <code class="nn">typing</code> <code class="kn">import</code> <code class="n">Callable</code>&#13;
&#13;
<code class="k">def</code> <code class="nf">make_matrix</code><code class="p">(</code><code class="n">num_rows</code><code class="p">:</code> <code class="nb">int</code><code class="p">,</code>&#13;
                <code class="n">num_cols</code><code class="p">:</code> <code class="nb">int</code><code class="p">,</code>&#13;
                <code class="n">entry_fn</code><code class="p">:</code> <code class="n">Callable</code><code class="p">[[</code><code class="nb">int</code><code class="p">,</code> <code class="nb">int</code><code class="p">],</code> <code class="nb">float</code><code class="p">])</code> <code class="o">-&gt;</code> <code class="n">Matrix</code><code class="p">:</code>&#13;
    <code class="sd">"""</code>&#13;
<code class="sd">    Returns a num_rows x num_cols matrix</code>&#13;
<code class="sd">    whose (i,j)-th entry is entry_fn(i, j)</code>&#13;
<code class="sd">    """</code>&#13;
    <code class="k">return</code> <code class="p">[[</code><code class="n">entry_fn</code><code class="p">(</code><code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">)</code>             <code class="c1"># given i, create a list</code>&#13;
             <code class="k">for</code> <code class="n">j</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="n">num_cols</code><code class="p">)]</code>  <code class="c1">#   [entry_fn(i, 0), ... ]</code>&#13;
            <code class="k">for</code> <code class="n">i</code> <code class="ow">in</code> <code class="nb">range</code><code class="p">(</code><code class="n">num_rows</code><code class="p">)]</code>   <code class="c1"># create one list for each i</code></pre>&#13;
&#13;
<p>Given<a data-primary="identity matrix" data-type="indexterm" id="idm45635759233560"/> this function, you could make a 5 × 5 <em>identity matrix</em> (with 1s on the diagonal and 0s elsewhere) like so:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">def</code> <code class="nf">identity_matrix</code><code class="p">(</code><code class="n">n</code><code class="p">:</code> <code class="nb">int</code><code class="p">)</code> <code class="o">-&gt;</code> <code class="n">Matrix</code><code class="p">:</code>&#13;
    <code class="sd">"""Returns the n x n identity matrix"""</code>&#13;
    <code class="k">return</code> <code class="n">make_matrix</code><code class="p">(</code><code class="n">n</code><code class="p">,</code> <code class="n">n</code><code class="p">,</code> <code class="k">lambda</code> <code class="n">i</code><code class="p">,</code> <code class="n">j</code><code class="p">:</code> <code class="mi">1</code> <code class="k">if</code> <code class="n">i</code> <code class="o">==</code> <code class="n">j</code> <code class="k">else</code> <code class="mi">0</code><code class="p">)</code>&#13;
&#13;
<code class="k">assert</code> <code class="n">identity_matrix</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code> <code class="o">==</code> <code class="p">[[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>&#13;
                              <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>&#13;
                              <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>&#13;
                              <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>&#13;
                              <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">]]</code></pre>&#13;
&#13;
<p>Matrices will be important to us for several reasons.</p>&#13;
&#13;
<p>First, we can use a matrix to represent a dataset consisting of multiple vectors, simply by considering each vector as a row of the matrix.  For example, if you had the heights, weights, and ages of 1,000 people, you could put them in a 1,000 × 3 matrix:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="n">data</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">70</code><code class="p">,</code> <code class="mi">170</code><code class="p">,</code> <code class="mi">40</code><code class="p">],</code>&#13;
        <code class="p">[</code><code class="mi">65</code><code class="p">,</code> <code class="mi">120</code><code class="p">,</code> <code class="mi">26</code><code class="p">],</code>&#13;
        <code class="p">[</code><code class="mi">77</code><code class="p">,</code> <code class="mi">250</code><code class="p">,</code> <code class="mi">19</code><code class="p">],</code>&#13;
        <code class="c1"># ....</code>&#13;
       <code class="p">]</code></pre>&#13;
&#13;
<p>Second, as we’ll see later, we can use an <em>n × k</em> matrix to represent a linear function that maps <em>k</em>-dimensional vectors to <em>n</em>-dimensional vectors.  Several of our techniques and concepts will involve such functions.</p>&#13;
&#13;
<p>Third, matrices can be used to represent binary relationships.  In <a data-type="xref" href="ch01.html#introduction">Chapter 1</a>, we represented the edges of a network as a collection of pairs <code>(i, j)</code>.  An alternative representation would be to create a matrix <code>A</code> such that <code>A[i][j]</code> is 1 if nodes <code>i</code> and <code>j</code> are connected and 0 otherwise.</p>&#13;
&#13;
<p>Recall that before we had:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="n">friendships</code> <code class="o">=</code> <code class="p">[(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">),</code> <code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">),</code> <code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">),</code> <code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">),</code> <code class="p">(</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">),</code> <code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">),</code>&#13;
               <code class="p">(</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">),</code> <code class="p">(</code><code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">),</code> <code class="p">(</code><code class="mi">5</code><code class="p">,</code> <code class="mi">7</code><code class="p">),</code> <code class="p">(</code><code class="mi">6</code><code class="p">,</code> <code class="mi">8</code><code class="p">),</code> <code class="p">(</code><code class="mi">7</code><code class="p">,</code> <code class="mi">8</code><code class="p">),</code> <code class="p">(</code><code class="mi">8</code><code class="p">,</code> <code class="mi">9</code><code class="p">)]</code></pre>&#13;
&#13;
<p>We could also represent this as:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="c1">#            user 0  1  2  3  4  5  6  7  8  9</code>&#13;
<code class="c1">#</code>&#13;
<code class="n">friend_matrix</code> <code class="o">=</code> <code class="p">[[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 0</code>&#13;
                 <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 1</code>&#13;
                 <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 2</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 3</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 4</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 5</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 6</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">],</code>  <code class="c1"># user 7</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">],</code>  <code class="c1"># user 8</code>&#13;
                 <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">0</code><code class="p">]]</code>  <code class="c1"># user 9</code></pre>&#13;
&#13;
<p>If there are very few connections, this is a much more inefficient representation, since you end up having&#13;
to store a lot of zeros.&#13;
However, with the matrix representation it is much quicker to check whether two nodes are connected—you just have to do a matrix lookup instead of (potentially) inspecting every edge:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="k">assert</code> <code class="n">friend_matrix</code><code class="p">[</code><code class="mi">0</code><code class="p">][</code><code class="mi">2</code><code class="p">]</code> <code class="o">==</code> <code class="mi">1</code><code class="p">,</code> <code class="s2">"0 and 2 are friends"</code>&#13;
<code class="k">assert</code> <code class="n">friend_matrix</code><code class="p">[</code><code class="mi">0</code><code class="p">][</code><code class="mi">8</code><code class="p">]</code> <code class="o">==</code> <code class="mi">0</code><code class="p">,</code> <code class="s2">"0 and 8 are not friends"</code></pre>&#13;
&#13;
<p>Similarly, to find a node’s connections, you only need to inspect the column (or the row) corresponding to that node:</p>&#13;
&#13;
<pre data-code-language="py" data-type="programlisting"><code class="c1"># only need to look at one row</code>&#13;
<code class="n">friends_of_five</code> <code class="o">=</code> <code class="p">[</code><code class="n">i</code>&#13;
                   <code class="k">for</code> <code class="n">i</code><code class="p">,</code> <code class="n">is_friend</code> <code class="ow">in</code> <code class="nb">enumerate</code><code class="p">(</code><code class="n">friend_matrix</code><code class="p">[</code><code class="mi">5</code><code class="p">])</code>&#13;
                   <code class="k">if</code> <code class="n">is_friend</code><code class="p">]</code></pre>&#13;
&#13;
<p>With a small graph you could just add a list of connections to each node object to speed up this process; but for a large, evolving graph that would probably be too expensive and difficult to maintain.</p>&#13;
&#13;
<p>We’ll revisit matrices throughout the book.<a data-primary="" data-startref="LAmat04" data-type="indexterm" id="idm45635758464008"/><a data-primary="" data-startref="mat04" data-type="indexterm" id="idm45635758463160"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="For Further Exploration" data-type="sect1"><div class="sect1" id="idm45635759520088">&#13;
<h1>For Further Exploration</h1>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Linear algebra<a data-primary="linear algebra" data-secondary="resources for learning" data-type="indexterm" id="idm45635758427176"/> is widely used by data scientists (frequently implicitly, and not infrequently by people who don’t understand it).  It wouldn’t be a bad idea to read a textbook. You can find several freely available online:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a href="http://joshua.smcvt.edu/linearalgebra/"><em>Linear Algebra</em></a>, by Jim Hefferon (Saint Michael’s College)</p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://www.math.ucdavis.edu/~linear/linear-guest.pdf"><em>Linear Algebra</em></a>, by David Cherney, Tom Denton, Rohit Thomas, and Andrew Waldron (UC Davis)</p>&#13;
</li>&#13;
<li>&#13;
<p>If you are feeling adventurous, <a href="https://www.math.brown.edu/~treil/papers/LADW/LADW_2017-09-04.pdf"><em>Linear Algebra Done Wrong</em></a>, by Sergei Treil (Brown University), is a more advanced introduction.</p>&#13;
</li>&#13;
</ul>&#13;
</li>&#13;
<li>&#13;
<p>All<a data-primary="NumPy library" data-type="indexterm" id="idm45635758419560"/><a data-primary="linear algebra" data-secondary="tools for" data-type="indexterm" id="idm45635758418824"/> of the machinery we built in this chapter you get for free if you use <a href="http://www.numpy.org">NumPy</a>.  (You get a lot more too, including much better performance.)<a data-primary="" data-startref="Malg04" data-type="indexterm" id="idm45635758417096"/></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>