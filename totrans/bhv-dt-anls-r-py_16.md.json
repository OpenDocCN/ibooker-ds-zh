["```py\n## Python (output not shown)\nols(\"duration~play_area * children\", data=hist_data_df).fit().summary()\n```", "```py\n## R\n> summary(lm(duration~play_area * children, data=hist_data))\n...\nCoefficients:\n                     Estimate Std. Error t value Pr(>|t|)    \n(Intercept)          19.98760    0.01245  1605.5   <2e-16 ***\nplay_area1            3.95907    0.02097   188.8   <2e-16 ***\nchildren1            10.01527    0.02017   496.6   <2e-16 ***\nplay_area1:children1 20.98663    0.03343   627.8   <2e-16 ***\n...\n```", "```py\n## R \nsummary(lm(Purchases ~ Emails + I(Emails^2), data=dat))\n```", "```py\n## Python\nmodel = ols(\"Purchases ~ Emails + I(Emails**2)\", data=dat_df)\nprint(model.fit().summary())\n```", "```py\n## R\nhist_data <- hist_data %>% mutate(age_quart = ntile(age, 4))\n```", "```py\n## Python\nhist_data_df['age_quart'] = pd.cut(hist_data_df['age'], 4, \n                                   labels=['q4', 'q3', 'q2', 'q1'],\n                                   include_lowest=True)\n```", "```py\n## R (output not shown)\n> hist_data %>% group_by(play_area) %>% summarize(mean = mean(duration), \n                                               sd = sd(duration))\n```", "```py\n## Python\n hist_data_df.groupby('play_area').agg(M = ('duration', lambda x: x.mean()),\n    SD = ('duration', lambda x: x.std()))\nOut[22]: \n                   M         SD\nplay_area                      \n0          23.803928   6.970786\n1          36.360939  17.111469\n```", "```py\n## R (output not shown)\n> summary(lm(duration~play_area * children * age, data=hist_data))\n```", "```py\n## Python\nols(\"duration~play_area * children * age\", data=hist_data_df).fit().summary()\n\n...\n                        coef     std err    t        P>|t|    [0.025   0.975]\n-----------------------------------------------------------------------------\nIntercept              20.0166    0.037  534.906    0.000    19.943    20.090\nplay_area               3.9110    0.063   62.014    0.000     3.787     4.035\nchildren                9.9983    0.061  165.012    0.000     9.880    10.117\nplay_area:children     29.1638    0.101  290.105    0.000    28.967    29.361\nage                    -0.0006    0.001   -0.820    0.412    -0.002     0.001\nplay_area:age           0.0010    0.001    0.806    0.420    -0.001     0.003\nchildren:age            0.0003    0.001    0.297    0.767    -0.002     0.003\nplay_area:children:age -0.1637    0.002  -86.139    0.000    -0.167    -0.160\n...\n```", "```py\n## R\n> centered_data <- hist_data %>% mutate(age = age - mean(age))\n```", "```py\n## Python\ncentered_data_df = hist_data_df.copy()\ncentered_data_df['age'] = centered_data_df['age'] \\\n    .subtract(centered_data_df['age'].mean())\n```", "```py\n## R\n> centered_data <- hist_data %>%\n    mutate(play_area = factor(play_area, levels=c('1','0')))\n```", "```py\n## Python\ncentered_data_df['play_area'] = centered_data_df['play_area']\n```", "```py\n## Python (output not shown)\ndef business_metric_fun(dat_df):\n    model =  ols(\"duration~play_area * (children + age)\", data=dat_df) ![1](Images/1.png)\n    res = model.fit(disp=0)\n    action_dat_df = dat_df[dat_df.play_area == 0].copy() ![2](Images/2.png)          \n    action_dat_df['pred_dur0'] = res.predict(action_dat_df) ![3](Images/3.png)  \n    action_dat_df.play_area = 1 ![4](Images/4.png)                                  \n    action_dat_df['pred_dur1'] = res.predict(action_dat_df) ![5](Images/5.png)        \n    action_dat_df['pred_dur_diff'] = \\  ![6](Images/6.png)                           \n        action_dat_df.pred_dur1 - action_dat_df.pred_dur0\n    action_res_df = action_dat_df.groupby(['store_id']) \\  ![7](Images/7.png)  \n        .agg(mean_dur_diff=('pred_dur_diff', 'mean'), \n             tot_dur_diff=('pred_dur_diff', 'sum'))\n    return action_res_df\naction_res_df = business_metric_fun(hist_data_df)\naction_res_df.describe()\n```", "```py\n## R\nbusiness_metric_fun <- function(dat){\n  mod_model <- lm(duration~play_area * (children + age), data=dat) ![1](Images/1.png) \n  action_dat <- dat %>%\n    filter(play_area == 0) ![2](Images/2.png)   \n  action_dat <- action_dat %>%\n    mutate(pred_dur0 = predict(mod_model, action_dat)) %>%  ![3](Images/3.png)\n    mutate(play_area = factor('1', levels=c('0', '1'))) ![4](Images/4.png)  \n  action_dat <- action_dat %>%\n    mutate(pred_dur1 = predict(mod_model, action_dat)) %>% ![5](Images/5.png)\n    mutate(pred_dur_diff = pred_dur1 - pred_dur0) %>%  ![6](Images/6.png) \n    dplyr::group_by(store_id) %>%  ![7](Images/7.png)   \n    summarise(mean_d = mean(pred_dur_diff), sum_d = sum(pred_dur_diff))\n  return(action_dat)}\naction_summ_dat <- business_metric_fun(hist_data)\nsummary(action_summ_dat)\n\n    store_id      mean_d          sum_d       \n 3      : 1   Min.   :10.41   Min.   :109941  \n 4      : 1   1st Qu.:11.26   1st Qu.:129817  \n 5      : 1   Median :11.80   Median :143079  \n 7      : 1   Mean   :11.95   Mean   :144616  \n 8      : 1   3rd Qu.:12.25   3rd Qu.:155481  \n 9      : 1   Max.   :14.43   Max.   :207647  \n (Other):27\n```"]