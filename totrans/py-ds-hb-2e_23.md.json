["```py\nIn [1]: import numpy as np\n        import pandas as pd\n\n        class display(object):\n            \"\"\"Display HTML representation of multiple objects\"\"\"\n            template = \"\"\"<div style=\"float: left; padding: 10px;\">\n <p style='font-family:\"Courier New\", Courier, monospace'>{0}{1}\n \"\"\"\n            def __init__(self, *args):\n                self.args = args\n\n            def _repr_html_(self):\n                return '\\n'.join(self.template.format(a, eval(a)._repr_html_())\n                                 for a in self.args)\n\n            def __repr__(self):\n                return '\\n\\n'.join(a + '\\n' + repr(eval(a))\n                                   for a in self.args)\n```", "```py\nIn [2]: import seaborn as sns\n        planets = sns.load_dataset('planets')\n        planets.shape\nOut[2]: (1035, 6)\n```", "```py\nIn [3]: planets.head()\nOut[3]:             method  number  orbital_period   mass  distance  year\n        0  Radial Velocity       1         269.300   7.10     77.40  2006\n        1  Radial Velocity       1         874.774   2.21     56.95  2008\n        2  Radial Velocity       1         763.000   2.60     19.84  2011\n        3  Radial Velocity       1         326.030  19.40    110.62  2007\n        4  Radial Velocity       1         516.220  10.50    119.47  2009\n```", "```py\nIn [4]: rng = np.random.RandomState(42)\n        ser = pd.Series(rng.rand(5))\n        ser\nOut[4]: 0    0.374540\n        1    0.950714\n        2    0.731994\n        3    0.598658\n        4    0.156019\n        dtype: float64\n```", "```py\nIn [5]: ser.sum()\nOut[5]: 2.811925491708157\n```", "```py\nIn [6]: ser.mean()\nOut[6]: 0.5623850983416314\n```", "```py\nIn [7]: df = pd.DataFrame({'A': rng.rand(5),\n                           'B': rng.rand(5)})\n        df\nOut[7]:           A         B\n        0  0.155995  0.020584\n        1  0.058084  0.969910\n        2  0.866176  0.832443\n        3  0.601115  0.212339\n        4  0.708073  0.181825\n```", "```py\nIn [8]: df.mean()\nOut[8]: A    0.477888\n        B    0.443420\n        dtype: float64\n```", "```py\nIn [9]: df.mean(axis='columns')\nOut[9]: 0    0.088290\n        1    0.513997\n        2    0.849309\n        3    0.406727\n        4    0.444949\n        dtype: float64\n```", "```py\nIn [10]: planets.dropna().describe()\nOut[10]:           number  orbital_period        mass    distance         year\n         count  498.00000      498.000000  498.000000  498.000000   498.000000\n         mean     1.73494      835.778671    2.509320   52.068213  2007.377510\n         std      1.17572     1469.128259    3.636274   46.596041     4.167284\n         min      1.00000        1.328300    0.003600    1.350000  1989.000000\n         25%      1.00000       38.272250    0.212500   24.497500  2005.000000\n         50%      1.00000      357.000000    1.245000   39.940000  2009.000000\n         75%      2.00000      999.600000    2.867500   59.332500  2011.000000\n         max      6.00000    17337.500000   25.000000  354.000000  2014.000000\n```", "```py\nIn [11]: df = pd.DataFrame({'key': ['A', 'B', 'C', 'A', 'B', 'C'],\n                            'data': range(6)}, columns=['key', 'data'])\n         df\nOut[11]:  key  data\n         0   A     0\n         1   B     1\n         2   C     2\n         3   A     3\n         4   B     4\n         5   C     5\n```", "```py\nIn [12]: df.groupby('key')\nOut[12]: <pandas.core.groupby.generic.DataFrameGroupBy object at 0x11d241e20>\n```", "```py\nIn [13]: df.groupby('key').sum()\nOut[13]:      data\n         key\n         A       3\n         B       5\n         C       7\n```", "```py\nIn [14]: planets.groupby('method')\nOut[14]: <pandas.core.groupby.generic.DataFrameGroupBy object at 0x11d1bc820>\n```", "```py\nIn [15]: planets.groupby('method')['orbital_period']\nOut[15]: <pandas.core.groupby.generic.SeriesGroupBy object at 0x11d1bcd60>\n```", "```py\nIn [16]: planets.groupby('method')['orbital_period'].median()\nOut[16]: method\n         Astrometry                         631.180000\n         Eclipse Timing Variations         4343.500000\n         Imaging                          27500.000000\n         Microlensing                      3300.000000\n         Orbital Brightness Modulation        0.342887\n         Pulsar Timing                       66.541900\n         Pulsation Timing Variations       1170.000000\n         Radial Velocity                    360.200000\n         Transit                              5.714932\n         Transit Timing Variations           57.011000\n         Name: orbital_period, dtype: float64\n```", "```py\nIn [17]: for (method, group) in planets.groupby('method'):\n             print(\"{0:30s} shape={1}\".format(method, group.shape))\nOut[17]: Astrometry                     shape=(2, 6)\n         Eclipse Timing Variations      shape=(9, 6)\n         Imaging                        shape=(38, 6)\n         Microlensing                   shape=(23, 6)\n         Orbital Brightness Modulation  shape=(3, 6)\n         Pulsar Timing                  shape=(5, 6)\n         Pulsation Timing Variations    shape=(1, 6)\n         Radial Velocity                shape=(553, 6)\n         Transit                        shape=(397, 6)\n         Transit Timing Variations      shape=(4, 6)\n```", "```py\nIn [18]: planets.groupby('method')['year'].describe().unstack()\nOut[18]:        method\n         count  Astrometry                          2.0\n                Eclipse Timing Variations           9.0\n                Imaging                            38.0\n                Microlensing                       23.0\n                Orbital Brightness Modulation       3.0\n                                                  ...\n         max    Pulsar Timing                    2011.0\n                Pulsation Timing Variations      2007.0\n                Radial Velocity                  2014.0\n                Transit                          2014.0\n                Transit Timing Variations        2014.0\n         Length: 80, dtype: float64\n```", "```py\nIn [19]: rng = np.random.RandomState(0)\n         df = pd.DataFrame({'key': ['A', 'B', 'C', 'A', 'B', 'C'],\n                            'data1': range(6),\n                            'data2': rng.randint(0, 10, 6)},\n                            columns = ['key', 'data1', 'data2'])\n         df\nOut[19]:   key  data1  data2\n         0   A      0      5\n         1   B      1      0\n         2   C      2      3\n         3   A      3      3\n         4   B      4      7\n         5   C      5      9\n```", "```py\nIn [20]: df.groupby('key').aggregate(['min', np.median, max])\nOut[20]:     data1            data2\n               min median max   min median max\n         key\n         A       0    1.5   3     3    4.0   5\n         B       1    2.5   4     0    3.5   7\n         C       2    3.5   5     3    6.0   9\n```", "```py\nIn [21]: df.groupby('key').aggregate({'data1': 'min',\n                                      'data2': 'max'})\nOut[21]:      data1  data2\n         key\n         A        0      5\n         B        1      7\n         C        2      9\n```", "```py\nIn [22]: def filter_func(x):\n             return x['data2'].std() > 4\n\n         display('df', \"df.groupby('key').std()\",\n                 \"df.groupby('key').filter(filter_func)\")\nOut[22]: df                         df.groupby('key').std()\n           key  data1  data2           data1     data2\n         0   A      0      5        key\n         1   B      1      0        A    2.12132  1.414214\n         2   C      2      3        B    2.12132  4.949747\n         3   A      3      3        C    2.12132  4.242641\n         4   B      4      7\n         5   C      5      9\n\n         df.groupby('key').filter(filter_func)\n           key  data1  data2\n         1   B      1      0\n         2   C      2      3\n         4   B      4      7\n         5   C      5      9\n```", "```py\nIn [23]: def center(x):\n             return x - x.mean()\n         df.groupby('key').transform(center)\nOut[23]:    data1  data2\n         0   -1.5    1.0\n         1   -1.5   -3.5\n         2   -1.5   -3.0\n         3    1.5   -1.0\n         4    1.5    3.5\n         5    1.5    3.0\n```", "```py\nIn [24]: def norm_by_data2(x):\n             # x is a DataFrame of group values\n             x['data1'] /= x['data2'].sum()\n             return x\n\n         df.groupby('key').apply(norm_by_data2)\nOut[24]:   key     data1  data2\n         0   A  0.000000      5\n         1   B  0.142857      0\n         2   C  0.166667      3\n         3   A  0.375000      3\n         4   B  0.571429      7\n         5   C  0.416667      9\n```", "```py\nIn [25]: L = [0, 1, 0, 1, 2, 0]\n         df.groupby(L).sum()\nOut[25]:    data1  data2\n         0      7     17\n         1      4      3\n         2      4      7\n```", "```py\nIn [26]: df.groupby(df['key']).sum()\nOut[26]:      data1  data2\n         key\n         A        3      8\n         B        5      7\n         C        7     12\n```", "```py\nIn [27]: df2 = df.set_index('key')\n         mapping = {'A': 'vowel', 'B': 'consonant', 'C': 'consonant'}\n         display('df2', 'df2.groupby(mapping).sum()')\nOut[27]: df2                    df2.groupby(mapping).sum()\n             data1  data2                  data1  data2\n         key                    key\n         A        0      5      consonant     12     19\n         B        1      0      vowel          3      8\n         C        2      3\n         A        3      3\n         B        4      7\n         C        5      9\n```", "```py\nIn [28]: df2.groupby(str.lower).mean()\nOut[28]:      data1  data2\n         key\n         a      1.5    4.0\n         b      2.5    3.5\n         c      3.5    6.0\n```", "```py\nIn [29]: df2.groupby([str.lower, mapping]).mean()\nOut[29]:                data1  data2\n         key key\n         a   vowel        1.5    4.0\n         b   consonant    2.5    3.5\n         c   consonant    3.5    6.0\n```", "```py\nIn [30]: decade = 10 * (planets['year'] // 10)\n         decade = decade.astype(str) + 's'\n         decade.name = 'decade'\n         planets.groupby(['method', decade])['number'].sum().unstack().fillna(0)\nOut[30]: decade                         1980s  1990s  2000s  2010s\n         method\n         Astrometry                       0.0    0.0    0.0    2.0\n         Eclipse Timing Variations        0.0    0.0    5.0   10.0\n         Imaging                          0.0    0.0   29.0   21.0\n         Microlensing                     0.0    0.0   12.0   15.0\n         Orbital Brightness Modulation    0.0    0.0    0.0    5.0\n         Pulsar Timing                    0.0    9.0    1.0    1.0\n         Pulsation Timing Variations      0.0    0.0    1.0    0.0\n         Radial Velocity                  1.0   52.0  475.0  424.0\n         Transit                          0.0    0.0   64.0  712.0\n         Transit Timing Variations        0.0    0.0    0.0    9.0\n```"]