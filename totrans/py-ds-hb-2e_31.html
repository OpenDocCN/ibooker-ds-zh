<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 27. Simple Scatter Plots" data-type="chapter" epub:type="chapter"><div class="chapter" id="section-0402-simple-scatter-plots">
<h1><span class="label">Chapter 27. </span>Simple Scatter Plots</h1>
<p><a data-primary="Matplotlib" data-secondary="simple scatter plots" data-type="indexterm" id="ix_ch27-asciidoc0"/><a data-primary="simple scatter plots" data-type="indexterm" id="ix_ch27-asciidoc1"/>Another commonly used plot type is the simple scatter plot, a close
cousin of the line plot. Instead of points being joined by line
segments, here the points are represented individually with a dot,
circle, or other shape. We’ll start by setting up the notebook for
plotting and importing the packages we will use:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="k">matplotlib</code> inline
        <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
        <code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code></pre>
<section data-pdf-bookmark="Scatter Plots with plt.plot" data-type="sect1"><div class="sect1" id="ch_0402-simple-scatter-plots_scatter-plots-with-plt.plot">
<h1>Scatter Plots with plt.plot</h1>
<p><a data-primary="plt.plot() function" data-secondary="scatter plots with" data-type="indexterm" id="ix_ch27-asciidoc2"/><a data-primary="simple scatter plots" data-secondary="plt.plot" data-type="indexterm" id="ix_ch27-asciidoc3"/>In the previous chapter we looked at using <code>plt.plot</code>/<code>ax.plot</code> to
produce line plots. It turns out that this same function can produce
scatter plots as well (see <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_4_0">Figure 27-1</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">30</code><code class="p">)</code>
        <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'o'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_4_0">
<img alt="output 4 0" height="194" src="assets/output_4_0.png" width="600"/>
<h6><span class="label">Figure 27-1. </span>Scatter plot example</h6>
</div></figure>
<p>The third argument in the function call is a character that represents
the type of symbol used for the plotting. Just as you can specify
options such as <code>'-'</code> or
<code>'--'</code> to control the line style, the marker
style has its own set of short string codes. The full list of available
symbols can be seen in the documentation of <code>plt.plot</code>, or in
Matplotlib’s
<a href="https://oreil.ly/tmYIL">online
documentation</a>. Most of the possibilities are fairly intuitive, and a
number of the more common ones are demonstrated here (see <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_6_0">Figure 27-2</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">default_rng</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
        <code class="k">for</code> <code class="n">marker</code> <code class="ow">in</code> <code class="p">[</code><code class="s1">'o'</code><code class="p">,</code> <code class="s1">'.'</code><code class="p">,</code> <code class="s1">','</code><code class="p">,</code> <code class="s1">'x'</code><code class="p">,</code> <code class="s1">'+'</code><code class="p">,</code> <code class="s1">'v'</code><code class="p">,</code> <code class="s1">'^'</code><code class="p">,</code> <code class="s1">'&lt;'</code><code class="p">,</code> <code class="s1">'&gt;'</code><code class="p">,</code> <code class="s1">'s'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">]:</code>
            <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">2</code><code class="p">),</code> <code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">2</code><code class="p">),</code> <code class="n">marker</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code>
                     <code class="n">label</code><code class="o">=</code><code class="s2">"marker='</code><code class="si">{0}</code><code class="s2">'"</code><code class="o">.</code><code class="n">format</code><code class="p">(</code><code class="n">marker</code><code class="p">))</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">legend</code><code class="p">(</code><code class="n">numpoints</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code> <code class="n">fontsize</code><code class="o">=</code><code class="mi">13</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">xlim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mf">1.8</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_6_0">
<img alt="output 6 0" height="383" src="assets/output_6_0.png" width="600"/>
<h6><span class="label">Figure 27-2. </span>Demonstration of point numbers</h6>
</div></figure>
<p>For even more possibilities, these character codes can be used together
with line and color codes to plot points along with a line connecting
them (see <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_8_0">Figure 27-3</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'-ok'</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_8_0">
<img alt="output 8 0" height="392" src="assets/output_8_0.png" width="600"/>
<h6><span class="label">Figure 27-3. </span>Combining line and point markers</h6>
</div></figure>
<p class="pagebreak-before less_space">Additional keyword arguments to <code>plt.plot</code> specify a wide range of
properties of the lines and markers, as you can see in <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_10_0">Figure 27-4</a>.</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="s1">'-p'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code>
                 <code class="n">markersize</code><code class="o">=</code><code class="mi">15</code><code class="p">,</code> <code class="n">linewidth</code><code class="o">=</code><code class="mi">4</code><code class="p">,</code>
                 <code class="n">markerfacecolor</code><code class="o">=</code><code class="s1">'white'</code><code class="p">,</code>
                 <code class="n">markeredgecolor</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code>
                 <code class="n">markeredgewidth</code><code class="o">=</code><code class="mi">2</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">ylim</code><code class="p">(</code><code class="o">-</code><code class="mf">1.2</code><code class="p">,</code> <code class="mf">1.2</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_10_0">
<img alt="output 10 0" height="398" src="assets/output_10_0.png" width="600"/>
<h6><span class="label">Figure 27-4. </span>Customizing line and point markers</h6>
</div></figure>
<p>These kinds of options make <code>plt.plot</code> the primary workhorse for
two-dimensional plots in Matplotlib. For a full description of the
options available, refer to the
<a href="https://oreil.ly/ON1xj"><code>plt.plot</code>
documentation</a>.<a data-startref="ix_ch27-asciidoc3" data-type="indexterm" id="idm45858761023312"/><a data-startref="ix_ch27-asciidoc2" data-type="indexterm" id="idm45858761022576"/></p>
</div></section>
<section data-pdf-bookmark="Scatter Plots with plt.scatter" data-type="sect1"><div class="sect1" id="ch_0402-simple-scatter-plots_scatter-plots-with-plt.scatter">
<h1>Scatter Plots with plt.scatter</h1>
<p>A second, more powerful method of creating scatter plots is the
<code>plt.scatter</code> function, which can be used very similarly to the
<code>plt.plot</code> function (see <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_13_0">Figure 27-5</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">marker</code><code class="o">=</code><code class="s1">'o'</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_13_0">
<img alt="output 13 0" height="392" src="assets/output_13_0.png" width="600"/>
<h6><span class="label">Figure 27-5. </span>A simple scatter plot</h6>
</div></figure>
<p><a data-primary="plt.plot() function" data-secondary="plt.scatter versus" data-type="indexterm" id="idm45858760977872"/><a data-primary="plt.scatter() function" data-secondary="plt.plot versus" data-type="indexterm" id="idm45858760976896"/><a data-primary="simple scatter plots" data-secondary="plt.plot versus plt.scatter" data-type="indexterm" id="idm45858760957056"/>The primary difference of <code>plt.scatter</code> from <code>plt.plot</code> is that it can
be used to create scatter plots where the properties of each individual
point (size, face color, edge color, etc.) can be individually
controlled or mapped to data.</p>
<p>Let’s show this by creating a random scatter plot with
points of many colors and sizes. In order to better see the overlapping
results, we’ll also use the <code>alpha</code> keyword to adjust the
transparency level (see <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_15_0">Figure 27-6</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">default_rng</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code>
        <code class="n">x</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="n">size</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code>
        <code class="n">y</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">normal</code><code class="p">(</code><code class="n">size</code><code class="o">=</code><code class="mi">100</code><code class="p">)</code>
        <code class="n">colors</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>
        <code class="n">sizes</code> <code class="o">=</code> <code class="mi">1000</code> <code class="o">*</code> <code class="n">rng</code><code class="o">.</code><code class="n">random</code><code class="p">(</code><code class="mi">100</code><code class="p">)</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">c</code><code class="o">=</code><code class="n">colors</code><code class="p">,</code> <code class="n">s</code><code class="o">=</code><code class="n">sizes</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.3</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">colorbar</code><code class="p">();</code>  <code class="c1"># show color scale</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_15_0">
<img alt="output 15 0" height="401" src="assets/output_15_0.png" width="600"/>
<h6><span class="label">Figure 27-6. </span>Changing size and color in scatter points</h6>
</div></figure>
<p>Notice that the color argument is automatically mapped to a color scale
(shown here by the <code>colorbar</code> command), and that the size argument is
given in pixels. In this way, the color and size of points can be used
to convey information in the visualization, in order to visualize
multidimensional data.</p>
<p><a data-primary="Iris dataset" data-secondary="scatter plots" data-type="indexterm" id="idm45858760816576"/>For example, we might use the Iris dataset from Scikit-Learn, where each
sample is one of three types of flowers that has had the size of its
petals and sepals carefully measured (see <a data-type="xref" href="#fig_0402-simple-scatter-plots_files_in_output_17_0">Figure 27-7</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.datasets</code> <code class="kn">import</code> <code class="n">load_iris</code>
        <code class="n">iris</code> <code class="o">=</code> <code class="n">load_iris</code><code class="p">()</code>
        <code class="n">features</code> <code class="o">=</code> <code class="n">iris</code><code class="o">.</code><code class="n">data</code><code class="o">.</code><code class="n">T</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">scatter</code><code class="p">(</code><code class="n">features</code><code class="p">[</code><code class="mi">0</code><code class="p">],</code> <code class="n">features</code><code class="p">[</code><code class="mi">1</code><code class="p">],</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.4</code><code class="p">,</code>
                    <code class="n">s</code><code class="o">=</code><code class="mi">100</code><code class="o">*</code><code class="n">features</code><code class="p">[</code><code class="mi">3</code><code class="p">],</code> <code class="n">c</code><code class="o">=</code><code class="n">iris</code><code class="o">.</code><code class="n">target</code><code class="p">,</code> <code class="n">cmap</code><code class="o">=</code><code class="s1">'viridis'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">xlabel</code><code class="p">(</code><code class="n">iris</code><code class="o">.</code><code class="n">feature_names</code><code class="p">[</code><code class="mi">0</code><code class="p">])</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">ylabel</code><code class="p">(</code><code class="n">iris</code><code class="o">.</code><code class="n">feature_names</code><code class="p">[</code><code class="mi">1</code><code class="p">]);</code></pre>
<figure><div class="figure" id="fig_0402-simple-scatter-plots_files_in_output_17_0">
<img alt="output 17 0" height="401" src="assets/output_17_0.png" width="600"/>
<h6><span class="label">Figure 27-7. </span>Using point properties to encode features of the Iris data<sup><a data-type="noteref" href="ch27.xhtml#idm45858760750032" id="idm45858760750032-marker">1</a></sup></h6>
</div></figure>
<p>We can see that this scatter plot has given us the ability to
simultaneously explore four different dimensions of the data: the (<em>x</em>,
<em>y</em>) location of each point corresponds to the sepal length and width,
the size of the point is related to the petal width, and the color is
related to the particular species of flower. Multicolor and multifeature
scatter plots like this can be useful for both exploration and
presentation of data.</p>
</div></section>
<section data-pdf-bookmark="plot Versus scatter: A Note on Efficiency" data-type="sect1"><div class="sect1" id="ch_0402-simple-scatter-plots_plot-versus-scatter-a-note-on-efficiency">
<h1>plot Versus scatter: A Note on Efficiency</h1>
<p><a data-primary="plt.plot() function" data-secondary="plt.scatter versus" data-type="indexterm" id="idm45858760746032"/><a data-primary="plt.scatter() function" data-secondary="plt.plot versus" data-type="indexterm" id="idm45858760744832"/><a data-primary="simple scatter plots" data-secondary="plt.plot versus plt.scatter" data-type="indexterm" id="idm45858760743888"/>Aside from the different features available in <code>plt.plot</code> and
<code>plt.scatter</code>, why might you choose to use one over the other? While it
doesn’t matter as much for small amounts of data, as
datasets get larger than a few thousand points, <code>plt.plot</code> can be
noticeably more efficient than <code>plt.scatter</code>. The reason is that
<code>plt.scatter</code> has the capability to render a different size and/or color
for each point, so the renderer must do the extra work of constructing
each point individually. With <code>plt.plot</code>, on the other hand, the markers
for each point are guaranteed to be identical, so the work of
determining the appearance of the points is done only once for the
entire set of data. For large datasets, this difference can lead to
vastly different performance, and for this reason, <code>plt.plot</code> should be
preferred over <code>plt.scatter</code> for large datasets.</p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Visualizing Uncertainties" data-type="sect1"><div class="sect1" id="section-0403-errorbars">
<h1>Visualizing Uncertainties</h1>
<p><a data-primary="Matplotlib" data-secondary="uncertainty visualization" data-type="indexterm" id="ix_ch27-asciidoc4"/><a data-primary="plotting" data-secondary="of uncertainties" data-type="indexterm" id="ix_ch27-asciidoc5"/><a data-primary="uncertainties, visualizing" data-secondary="Matplotlib" data-type="indexterm" id="ix_ch27-asciidoc6"/>For any scientific measurement, accurate accounting of uncertainties is
nearly as important, if not more so, as accurate reporting of the number
itself. For example, imagine that I am using some astrophysical
observations to estimate the Hubble Constant, the local measurement of
the expansion rate of the Universe. I know that the current literature
suggests a value of around 70 (km/s)/Mpc, and I measure a value of 74
(km/s)/Mpc with my method. Are the values consistent? The only correct
answer, given this information, is this: there is no way to know.</p>
<p>Suppose I augment this information with reported uncertainties: the
current literature suggests a value of 70 ± 2.5 (km/s)/Mpc, and my
method has measured a value of 74 ± 5 (km/s)/Mpc. Now are the values
consistent? That is a question that can be quantitatively answered.</p>
<p>In visualization of data and results, showing these errors effectively
can make a plot convey much more complete information.</p>
<section data-pdf-bookmark="Basic Errorbars" data-type="sect2"><div class="sect2" id="ch_0403-errorbars_basic-errorbars">
<h2>Basic Errorbars</h2>
<p><a data-primary="errorbars" data-type="indexterm" id="idm45858760685968"/><a data-primary="uncertainties, visualizing" data-secondary="basic errorbars" data-type="indexterm" id="idm45858760685264"/>One standard way to visualize uncertainties is using an errorbar. A
basic errorbar can be created with a single Matplotlib function call, as
shown in <a data-type="xref" href="#fig_0403-errorbars_files_in_output_4_0">Figure 27-8</a>.</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="o">%</code><code class="k">matplotlib</code> inline
        <code class="kn">import</code> <code class="nn">matplotlib.pyplot</code> <code class="k">as</code> <code class="nn">plt</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">style</code><code class="o">.</code><code class="n">use</code><code class="p">(</code><code class="s1">'seaborn-whitegrid'</code><code class="p">)</code>
        <code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">50</code><code class="p">)</code>
        <code class="n">dy</code> <code class="o">=</code> <code class="mf">0.8</code>
        <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code> <code class="o">+</code> <code class="n">dy</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">randn</code><code class="p">(</code><code class="mi">50</code><code class="p">)</code>

        <code class="n">plt</code><code class="o">.</code><code class="n">errorbar</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">yerr</code><code class="o">=</code><code class="n">dy</code><code class="p">,</code> <code class="n">fmt</code><code class="o">=</code><code class="s1">'.k'</code><code class="p">);</code></pre>
<p>Here the <code>fmt</code> is a format code controlling the appearance of lines and
points, and it has the same syntax as the shorthand used in <code>plt.plot</code>,
outlined in the previous chapter and earlier in this chapter.</p>
<figure><div class="figure" id="fig_0403-errorbars_files_in_output_4_0">
<img alt="output 4 0" height="194" src="assets/output_4_0.png" width="600"/>
<h6><span class="label">Figure 27-8. </span>An errorbar example</h6>
</div></figure>
<p>In addition to these basic options, the <code>errorbar</code> function has many
options to fine-tune the outputs. Using these additional options you can
easily customize the aesthetics of your errorbar plot. I often find it
helpful, especially in crowded plots, to make the errorbars lighter than
the points themselves (see <a data-type="xref" href="#fig_0403-errorbars_files_in_output_6_0">Figure 27-9</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">plt</code><code class="o">.</code><code class="n">errorbar</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">yerr</code><code class="o">=</code><code class="n">dy</code><code class="p">,</code> <code class="n">fmt</code><code class="o">=</code><code class="s1">'o'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'black'</code><code class="p">,</code>
                     <code class="n">ecolor</code><code class="o">=</code><code class="s1">'lightgray'</code><code class="p">,</code> <code class="n">elinewidth</code><code class="o">=</code><code class="mi">3</code><code class="p">,</code> <code class="n">capsize</code><code class="o">=</code><code class="mi">0</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0403-errorbars_files_in_output_6_0">
<img alt="output 6 0" height="383" src="assets/output_6_0.png" width="600"/>
<h6><span class="label">Figure 27-9. </span>Customizing errorbars</h6>
</div></figure>
<p>In addition to these options, you can also specify horizontal errorbars,
one-sided errorbars, and many other variants. For more information on
the options available, refer to the docstring of <code>plt.errorbar</code>.</p>
</div></section>
<section data-pdf-bookmark="Continuous Errors" data-type="sect2"><div class="sect2" id="ch_0403-errorbars_continuous-errors">
<h2>Continuous Errors</h2>
<p><a data-primary="uncertainties, visualizing" data-secondary="continuous errors" data-type="indexterm" id="idm45858760521104"/>In some situations it is desirable to show errorbars on continuous
quantities. Though Matplotlib does not have a built-in convenience
routine for this type of application, it’s relatively easy
to combine primitives like <code>plt.plot</code> and <code>plt.fill_between</code> for a
useful result.</p>
<p><a data-primary="Gaussian process regression (GPR)" data-type="indexterm" id="idm45858760518880"/><a data-primary="GPR (Gaussian process regression)" data-type="indexterm" id="idm45858760518208"/>Here we’ll perform a simple <em>Gaussian process regression</em>,
using the Scikit-Learn API (see
<a data-type="xref" href="ch38.xhtml#section-0502-introducing-scikit-learn">Chapter 38</a> for
details). This is a method of fitting a very flexible nonparametric
function to data with a continuous measure of the uncertainty. We
won’t delve into the details of Gaussian process regression
at this point, but will focus instead on how you might visualize such a
continuous error measurement:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="kn">from</code> <code class="nn">sklearn.gaussian_process</code> <code class="kn">import</code> <code class="n">GaussianProcessRegressor</code>

        <code class="c1"># define the model and draw some data</code>
        <code class="n">model</code> <code class="o">=</code> <code class="k">lambda</code> <code class="n">x</code><code class="p">:</code> <code class="n">x</code> <code class="o">*</code> <code class="n">np</code><code class="o">.</code><code class="n">sin</code><code class="p">(</code><code class="n">x</code><code class="p">)</code>
        <code class="n">xdata</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">8</code><code class="p">])</code>
        <code class="n">ydata</code> <code class="o">=</code> <code class="n">model</code><code class="p">(</code><code class="n">xdata</code><code class="p">)</code>

        <code class="c1"># Compute the Gaussian process fit</code>
        <code class="n">gp</code> <code class="o">=</code> <code class="n">GaussianProcessRegressor</code><code class="p">()</code>
        <code class="n">gp</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">xdata</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">],</code> <code class="n">ydata</code><code class="p">)</code>

        <code class="n">xfit</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">linspace</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">1000</code><code class="p">)</code>
        <code class="n">yfit</code><code class="p">,</code> <code class="n">dyfit</code> <code class="o">=</code> <code class="n">gp</code><code class="o">.</code><code class="n">predict</code><code class="p">(</code><code class="n">xfit</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">],</code> <code class="n">return_std</code><code class="o">=</code><code class="kc">True</code><code class="p">)</code></pre>
<p>We now have <code>xfit</code>, <code>yfit</code>, and <code>dyfit</code>, which sample the continuous fit
to our data. We could pass these to the <code>plt.errorbar</code> function as in
the previous section, but we don’t really want to plot 1,000
points with 1,000 errorbars. Instead, we can use the <code>plt.fill_between</code>
function with a light color to visualize this continuous error (see <a data-type="xref" href="#fig_0403-errorbars_files_in_output_11_0">Figure 27-10</a>).</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="c1"># Visualize the result</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">xdata</code><code class="p">,</code> <code class="n">ydata</code><code class="p">,</code> <code class="s1">'or'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">plot</code><code class="p">(</code><code class="n">xfit</code><code class="p">,</code> <code class="n">yfit</code><code class="p">,</code> <code class="s1">'-'</code><code class="p">,</code> <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">fill_between</code><code class="p">(</code><code class="n">xfit</code><code class="p">,</code> <code class="n">yfit</code> <code class="o">-</code> <code class="n">dyfit</code><code class="p">,</code> <code class="n">yfit</code> <code class="o">+</code> <code class="n">dyfit</code><code class="p">,</code>
                         <code class="n">color</code><code class="o">=</code><code class="s1">'gray'</code><code class="p">,</code> <code class="n">alpha</code><code class="o">=</code><code class="mf">0.2</code><code class="p">)</code>
        <code class="n">plt</code><code class="o">.</code><code class="n">xlim</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="mi">10</code><code class="p">);</code></pre>
<figure><div class="figure" id="fig_0403-errorbars_files_in_output_11_0">
<img alt="output 11 0" height="200" src="assets/output_11_0.png" width="600"/>
<h6><span class="label">Figure 27-10. </span>Representing continuous uncertainty with filled regions</h6>
</div></figure>
<p>Take a look at the <code>fill_between</code> call signature: we pass an x value,
then the lower <em>y</em>-bound, then the upper <em>y</em>-bound, and the result is
that the area between these regions is filled.</p>
<p>The resulting figure gives an intuitive view into what the Gaussian
process regression algorithm is doing: in regions near a measured data
point, the model is strongly constrained, and this is reflected in the
small model uncertainties. In regions far from a measured data point,
the model is not strongly constrained, and the model uncertainties
increase.</p>
<p>For more information on the options available in <code>plt.fill_between</code> (and
the closely related <code>plt.fill</code> function), see the function docstring or Matplotlib documentation.</p>
<p>Finally, if this seems a bit too low-level for your taste, refer to
<a data-type="xref" href="ch36.xhtml#section-0414-visualization-with-seaborn">Chapter 36</a>,
where we discuss the Seaborn package, which has a more streamlined API
for visualizing this type of continuous errorbar<a data-startref="ix_ch27-asciidoc6" data-type="indexterm" id="idm45858760272592"/><a data-startref="ix_ch27-asciidoc5" data-type="indexterm" id="idm45858760271920"/><a data-startref="ix_ch27-asciidoc4" data-type="indexterm" id="idm45858760271248"/>.<a data-startref="ix_ch27-asciidoc1" data-type="indexterm" id="idm45858760270448"/><a data-startref="ix_ch27-asciidoc0" data-type="indexterm" id="idm45858760269744"/></p>
</div></section>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm45858760750032"><sup><a href="ch27.xhtml#idm45858760750032-marker">1</a></sup> A full-color version of this figure can be found on <a href="https://oreil.ly/PDSH_GitHub">GitHub</a>.</p></div></div></section></div></body></html>