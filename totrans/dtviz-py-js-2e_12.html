<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 8. Introduction to pandas" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter_intro_to_pandas">
<h1><span class="label">Chapter 8. </span>Introduction to pandas</h1>
<p>pandas is a key element in our <a data-primary="pandas" data-secondary="introduction to" data-type="indexterm" id="ix_pndsintr"/>dataviz toolchain, as we will use it for both cleaning and exploring our recently scraped dataset (see <a data-type="xref" href="ch06.xhtml#chapter_heavy_scraping">Chapter 6</a>). The last chapter introduced NumPy, the Python array processing library that is the foundation of pandas. Before we move on to applying pandas, this chapter will introduce its key concepts and show how it interacts with existing data files and database tables. The rest of your pandas learning will be on the job over the next couple of chapters.</p>
<section data-pdf-bookmark="Why pandas Is Tailor-Made for Dataviz" data-type="sect1"><div class="sect1" id="idm45607780444752">
<h1>Why pandas Is Tailor-Made for Dataviz</h1>
<p>Take any dataviz, whether web-based or in print, and chances are that the data visualized was at one point stored in row-columnar form in a spreadsheet like Excel, a CSV file, or HDF5.<a data-primary="dataviz" data-secondary="benefits of pandas for" data-type="indexterm" id="idm45607780443488"/><a data-primary="pandas" data-secondary="introduction to" data-tertiary="benefits of pandas for dataviz" data-type="indexterm" id="idm45607780442512"/> There are certainly visualizations, like network graphs,  for which row-columnar data is not the best form, but they are in the minority. pandas is tailor-made to manipulate row-columnar data tables with its core datatype, the DataFrame, which is best thought of as a very fast, programmatic spreadsheet.</p>
</div></section>
<section data-pdf-bookmark="Why pandas Was Developed" data-type="sect1"><div class="sect1" id="idm45607780440944">
<h1>Why pandas Was Developed</h1>
<p>First revealed by Wes Kinney in 2008, pandas was built to solve a particular problem—​namely, that while Python was great for manipulating data, it was weak in the area of data analysis and modeling, certainly compared with big hitters like R.</p>
<p>pandas is designed to work with the kind of heterogenous<sup><a data-type="noteref" href="ch08.xhtml#idm45607780439264" id="idm45607780439264-marker">1</a></sup> data found in row-columnar spreadsheets, but cleverly manages to leverage some of the speed of <span class="keep-together">NumPy’s</span> homogeneous numeric arrays used by mathematicians, physicists, computer graphics, and the like.<a data-primary="NumPy" data-secondary="pandas and" data-type="indexterm" id="idm45607780437696"/> Combined with the Jupyter notebook and the Matplotlib plotting library (with auxiliary libraries like seaborn), pandas represents a first-class interactive data analysis tool. Because it’s part of the NumPy ecosystem, its data modeling is easily enhanced by such libraries as SciPy, statsmodels, and scikit-learn, to name but a few.</p>
</div></section>
<section data-pdf-bookmark="Categorizing Data and Measurements" data-type="sect1"><div class="sect1" id="idm45607780436336">
<h1>Categorizing Data and Measurements</h1>
<p>I’ll cover the core concepts of pandas in the next section, focusing on the DataFrame and how to get your data into and out of it via the common datastores, CSV files, and SQL databases.<a data-primary="pandas" data-secondary="introduction to" data-tertiary="categorizing data and measurements" data-type="indexterm" id="idm45607780434832"/> But first let’s take a little diversion to consider what we really mean by the heterogeneous datasets that pandas was designed to work with and that are the mainstay of data visualizers.<a data-primary="categorizing data and measurements" data-type="indexterm" id="idm45607780433488"/></p>
<p>Chances are that<a data-primary="measurements, categorical and numerical" data-type="indexterm" id="idm45607780420064"/> a visualization, maybe a bar chart or line graph used to illustrate an article or a modern web dashboard, presents the results of measurements in the real world, the price of commodities as they change over time, changes in rainfall over a year, voting intentions by ethnic group, and so forth. These measurements can be broadly broken into two groups, numerical and categorical. Numerical values can be divided into interval and ratio scales, and categorical values can in turn be divided into nominal and ordinal measurements. This gives four broad categories of observation available to the data visualizer.</p>
<p>Let’s take a set of tweets as an example in order to draw out these measurement categories. Each tweet has various data fields:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="p">{</code><code>
  </code><code class="s2">"text"</code><code class="o">:</code><code> </code><code class="s2">"#Python and #JavaScript sitting in a tree..."</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-1" id="co_introduction_to_pandas_CO1-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
  </code><code class="s2">"id"</code><code class="o">:</code><code> </code><code class="mi">2103303030333004303</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-1" id="co_introduction_to_pandas_CO1-2"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
  </code><code class="s2">"favorited"</code><code class="o">:</code><code> </code><code class="kc">true</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-2" id="co_introduction_to_pandas_CO1-3"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
  </code><code class="s2">"filter_level"</code><code class="o">:</code><code class="s2">"medium"</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-3" id="co_introduction_to_pandas_CO1-4"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
  </code><code class="s2">"created_at"</code><code class="o">:</code><code> </code><code class="s2">"Wed Mar 23 14:07:43 +0000 2015"</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-4" id="co_introduction_to_pandas_CO1-5"><img alt="4" height="12" src="assets/4.png" width="12"/></a><code>
  </code><code class="s2">"retweet_count"</code><code class="o">:</code><code class="mi">23</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-5" id="co_introduction_to_pandas_CO1-6"><img alt="5" height="12" src="assets/5.png" width="12"/></a><code>
  </code><code class="s2">"coordinates"</code><code class="o">:</code><code class="p">[</code><code class="o">-</code><code class="mf">97.5</code><code class="p">,</code><code> </code><code class="mf">45.3</code><code class="p">]</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO1-6" id="co_introduction_to_pandas_CO1-7"><img alt="6" height="12" src="assets/6.png" width="12"/></a><code>
  </code><code class="p">...</code><code>
</code><code class="p">}</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO1-1" id="callout_introduction_to_pandas_CO1-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>The <code>text</code> and <code>id</code> fields are unique indicators. The former might contain categorical information (e.g., the category of tweets containing the #Python hashtag), and the latter might be used to create a category (e.g., the set of all users retweeting this tweet), but they are not per se visualizable fields.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO1-3" id="callout_introduction_to_pandas_CO1-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p><code>favorited</code> is Boolean, categorical information, dividing the tweets into two sets. This would count as a <em>nominal</em> category, as it can be counted but not ordered.<a data-primary="nominal category" data-type="indexterm" id="idm45607780358640"/></p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO1-4" id="callout_introduction_to_pandas_CO1-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p><code>filter_level</code> is also categorical information, but it is ordinal. There is an order, low→medium→high, to the filter levels.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO1-5" id="callout_introduction_to_pandas_CO1-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></dt>
<dd><p>The <code>created_at</code> field is a timestamp, a numerical value on an interval scale. We would probably want to order the tweets on this scale, something pandas does automatically, and then maybe box into broader intervals, say by the day or week. Again, pandas makes this trivial.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO1-6" id="callout_introduction_to_pandas_CO1-5"><img alt="5" height="12" src="assets/5.png" width="12"/></a></dt>
<dd><p><code>retweet_count</code> is likewise on a numerical scale, but it is a ratio one. A ratio scale, as opposed to an interval scale, has a meaningful concept of zero—​in this case, no retweets. Our <code>created_at</code> timestamp, on the other hand, can have an arbitrary baseline (e.g., unixtime or Gregorian year 0), much in the same way as temperature scales, with 0 degrees Celsius being the same as 273.15 degrees Kelvin.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO1-7" id="callout_introduction_to_pandas_CO1-6"><img alt="6" height="12" src="assets/6.png" width="12"/></a></dt>
<dd><p><code>coordinates</code>, if available, has two numerical scales for longitude and latitude. Both are interval scales, though, as it doesn’t make much sense to speak of ratios of degrees.</p></dd>
</dl>
<p>So a small subset of our humble tweet’s fields contains heterogeneous information covering all the generally accepted divisions of measurement.<a data-primary="NumPy" data-secondary="use of arrays for homogeneous, numerical number crunching" data-type="indexterm" id="idm45607780306144"/> Whereas the NumPy array is generally used for homogeneous, numerical number crunching, pandas is designed to deal with categorical data, time series, and items that reflect the heterogeneous nature of real-world data. This makes it a great fit for the data visualization.</p>
<p>Now that we know the type of data pandas is designed to deal with, let’s look at the data structures it uses.</p>
</div></section>
<section data-pdf-bookmark="The DataFrame" data-type="sect1"><div class="sect1" id="pandas_objects">
<h1>The DataFrame</h1>
<p>The first step in a pandas session is usually to load some data into a DataFrame. <a data-primary="pandas" data-secondary="introduction to" data-tertiary="DataFrames" data-type="indexterm" id="ix_pndsintrdf"/><a data-primary="DataFrames" data-type="indexterm" id="ix_DaFr"/>We’ll cover the various ways we can do this in a later section. For now, let’s read our <em>nobel_winners.json</em> JSON data from a file. <code>read_json</code> returns a DataFrame, parsed from the JSON file specified. By convention, DataFrame variables start with <code>df</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code> <code class="nn">pandas</code> <code class="k">as</code> <code class="nn">pd</code>

<code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="s1">'data/nobel_winners.json'</code><code class="p">)</code></pre>
<p>With our DataFrame in hand, let’s inspect its content. A quick way to get the row-columnar structure of the DataFrame is to use its <code>head</code> method to show (by default) the top five items. <a data-type="xref" href="#pandas_dataframe">Figure 8-1</a> shows the output from a <a href="https://jupyter.org">Jupyter notebook</a>, with key elements of the DataFrame highlighted.<a data-primary="Jupyter notebooks" data-secondary="showing key elements of pandas DataFrame" data-type="indexterm" id="idm45607780285744"/></p>
<figure><div class="figure" id="pandas_dataframe">
<img alt="dpj2 0801" height="493" src="assets/dpj2_0801.png" width="1362"/>
<h6><span class="label">Figure 8-1. </span>The key elements of a pandas DataFrame</h6>
</div></figure>
<section data-pdf-bookmark="Indices" data-type="sect2"><div class="sect2" id="idm45607780282736">
<h2>Indices</h2>
<p>The DataFrame’s columns are indexed by a <code>columns</code> property, which is a pandas <code>index</code> instance. <a data-primary="DataFrames" data-secondary="indices" data-type="indexterm" id="idm45607780280336"/><a data-primary="indices" data-secondary="pandas DataFrames" data-type="indexterm" id="idm45607780252064"/>Let’s select the columns in <a data-type="xref" href="#pandas_dataframe">Figure 8-1</a>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">0</code><code class="p">]:</code> <code class="n">df</code><code class="o">.</code><code class="n">columns</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">0</code><code class="p">]:</code> <code class="n">Index</code><code class="p">([</code><code class="s1">'born_in'</code><code class="p">,</code> <code class="s1">'category'</code><code class="p">,</code> <code class="o">...</code> <code class="p">],</code> <code class="n">dtype</code><code class="o">=</code><code class="s1">'object'</code><code class="p">)</code></pre>
<p>Initially, pandas rows have a single numeric index (pandas can handle multiple indices if necessary) that can be accessed by the <code>index</code> property. This is a memory-saving <a href="https://oreil.ly/7Qzia"><code>RangeIndex</code></a> by default:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="n">df</code><code class="o">.</code><code class="n">index</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="n">RangeIndex</code><code class="p">(</code><code class="n">start</code><code class="o">=</code><code class="mi">0</code><code class="p">,</code> <code class="n">stop</code><code class="o">=</code><code class="mi">1052</code><code class="p">,</code> <code class="n">step</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code></pre>
<p>As well as integers, row indices can be strings, <code>DatetimeIndice</code>s, or <code>PeriodIndice</code>s for time-based data, and so on. Often, to aid selections, a column of the DataFrame will be set to the index via the <code>set_index</code> method. In the following code, we first use the <code>set_index</code> method to set our Nobel DataFrame’s index to the name column and then use the <code>loc</code> method to select a row by the index label (<code>name</code> in this case):</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">2</code><code class="p">]</code><code> </code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">set_index</code><code class="p">(</code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO2-1" id="co_introduction_to_pandas_CO2-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">In</code><code> </code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">loc</code><code class="p">[</code><code class="s1">'</code><code class="s1">Albert Einstein</code><code class="s1">'</code><code class="p">]</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO2-2" id="co_introduction_to_pandas_CO2-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="n">Out</code><code class="p">[</code><code class="mi">3</code><code class="p">]</code><code class="p">:</code><code>
</code><code>                </code><code class="n">born_in</code><code> </code><code class="n">category</code><code>      </code><code class="n">country</code><code> </code><code class="n">date_of_birth</code><code> </code><code class="n">date_of_death</code><code>  </code><code>\
</code><code class="n">name</code><code>
</code><code class="n">Albert</code><code> </code><code class="n">Einstein</code><code>          </code><code class="n">Physics</code><code>  </code><code class="n">Switzerland</code><code>    </code><code class="mi">1879</code><code class="o">-</code><code class="mi">03</code><code class="o">-</code><code class="mi">14</code><code>    </code><code class="mi">1955</code><code class="o">-</code><code class="mi">04</code><code class="o">-</code><code class="mi">18</code><code>
</code><code class="n">Albert</code><code> </code><code class="n">Einstein</code><code>          </code><code class="n">Physics</code><code>      </code><code class="n">Germany</code><code>    </code><code class="mi">1879</code><code class="o">-</code><code class="mi">03</code><code class="o">-</code><code class="mi">14</code><code>    </code><code class="mi">1955</code><code class="o">-</code><code class="mi">04</code><code class="o">-</code><code class="mi">18</code><code>
</code><code class="p">[</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code class="p">]</code><code>
</code><code>
</code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">reset_index</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO2-3" id="co_introduction_to_pandas_CO2-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO2-1" id="callout_introduction_to_pandas_CO2-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Set the index to the name column.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO2-2" id="callout_introduction_to_pandas_CO2-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>You can now select a row by the <code>name</code> label.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO2-3" id="callout_introduction_to_pandas_CO2-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Return the index to original integer-based state.</p></dd>
</dl>
</div></section>
<section data-pdf-bookmark="Rows and Columns" data-type="sect2"><div class="sect2" id="idm45607780052512">
<h2>Rows and Columns</h2>
<p>The rows and columns of a DataFrame are stored as <a href="https://oreil.ly/z7PF4">pandas Series</a>, a heterogeneous counterpart to NumPy’s array.<a data-primary="DataFrames" data-secondary="rows and columns" data-type="indexterm" id="idm45607780050288"/><a data-primary="rows" data-secondary="DataFrame" data-type="indexterm" id="idm45607780005888"/><a data-primary="columns" data-secondary="DataFrame" data-type="indexterm" id="idm45607780005040"/> These are essentially a labeled one-dimensional array that can contain any datatype from integers, strings, and floats to Python objects and lists.</p>
<p>There are two ways to select a row from the DataFrame. We’ve seen the <code>loc</code> method, which selects by label. There’s also an <code>iloc</code> method, which selects by position. So to select the row in <a data-type="xref" href="#pandas_dataframe">Figure 8-1</a>, we grab row number two:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">4</code><code class="p">]</code> <code class="n">df</code><code class="o">.</code><code class="n">iloc</code><code class="p">[</code><code class="mi">2</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code>
<code class="n">name</code>                                              <code class="n">Vladimir</code> <code class="n">Prelog</code> <code class="o">*</code>
<code class="n">born_in</code>                                      <code class="n">Bosnia</code> <code class="ow">and</code> <code class="n">Herzegovina</code>
<code class="n">category</code>                                                  <code class="n">Chemistry</code>
<code class="n">country</code>
<code class="n">date_of_birth</code>                                         <code class="n">July</code> <code class="mi">23</code><code class="p">,</code> <code class="mi">1906</code>
<code class="o">...</code>
<code class="n">year</code>                                                           <code class="mi">1975</code>
<code class="n">Name</code><code class="p">:</code> <code class="mi">2</code><code class="p">,</code> <code class="n">dtype</code><code class="p">:</code> <code class="nb">object</code></pre>
<p>You can grab a column of your DataFrame using dot notation<sup><a data-type="noteref" href="ch08.xhtml#idm45607779978240" id="idm45607779978240-marker">2</a></sup> or conventional array access by keyword string. This returns a pandas Series with all the column fields with their DataFrame indices <span class="keep-together">preserved</span>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">9</code><code class="p">]</code> <code class="n">gender_col</code> <code class="o">=</code> <code class="n">df</code><code class="o">.</code><code class="n">gender</code> <code class="c1"># or df['gender']</code>
<code class="n">In</code> <code class="p">[</code><code class="mi">10</code><code class="p">]</code> <code class="nb">type</code><code class="p">(</code><code class="n">gender_col</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]</code> <code class="n">pandas</code><code class="o">.</code><code class="n">core</code><code class="o">.</code><code class="n">series</code><code class="o">.</code><code class="n">Series</code>
<code class="n">In</code> <code class="p">[</code><code class="mi">11</code><code class="p">]</code> <code class="n">gender_col</code><code class="o">.</code><code class="n">head</code><code class="p">()</code> <code class="c1"># grab the Series' first five items</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code>
<code class="mi">0</code>    <code class="n">male</code> <code class="c1">#index, object</code>
<code class="mi">1</code>    <code class="n">male</code>
<code class="mi">2</code>    <code class="n">male</code>
<code class="mi">3</code>    <code class="kc">None</code>
<code class="mi">4</code>    <code class="n">male</code>
<code class="n">Name</code><code class="p">:</code> <code class="n">gender</code><code class="p">,</code> <code class="n">dtype</code><code class="p">:</code> <code class="nb">object</code></pre>
</div></section>
<section data-pdf-bookmark="Selecting Groups" data-type="sect2"><div class="sect2" id="idm45607779870768">
<h2>Selecting Groups</h2>
<p>There are various ways we can select groups (or subsets of rows) of our DataFrame. <a data-primary="groups" data-secondary="selecting in pandas DataFrames" data-type="indexterm" id="ix_grpsel"/><a data-primary="DataFrames" data-secondary="selecting groups" data-type="indexterm" id="ix_DaFrselgrp"/>Often we want to select all rows with a specific column value (e.g., all rows with category Physics). One way to do this is to use the DataFrame’s <code>groupby</code> method to group a column (or list of columns) and then use the <code>get_group</code> method to select the required group. Let’s use these two methods to select all Nobel Physics Prize winners:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">cat_groups</code> <code class="o">=</code> <code class="n">df</code><code class="o">.</code><code class="n">groupby</code><code class="p">(</code><code class="s1">'category'</code><code class="p">)</code>
<code class="n">cat_groups</code>
<code class="c1">#Out[-] &lt;pandas.core.groupby.generic.DataFrameGroupBy object ...&gt;</code>

<code class="n">cat_groups</code><code class="o">.</code><code class="n">groups</code><code class="o">.</code><code class="n">keys</code><code class="p">()</code>
<code class="c1">#Out[-]: dict_keys(['', 'Chemistry', 'Economics', 'Literature',\</code>
<code class="c1">#                  'Peace', 'Physics', 'Physiology or Medicine'])</code>
 <code class="o">...</code>

<code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]</code> <code class="n">phy_group</code> <code class="o">=</code> <code class="n">cat_groups</code><code class="o">.</code><code class="n">get_group</code><code class="p">(</code><code class="s1">'Physics'</code><code class="p">)</code>
<code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]</code> <code class="n">phy_group</code><code class="o">.</code><code class="n">head</code><code class="p">()</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code>
                 <code class="n">name</code> <code class="n">born_in</code> <code class="n">category</code>  <code class="n">country</code>    <code class="n">date_of_birth</code>  \
<code class="mi">13</code>   <code class="n">François</code> <code class="n">Englert</code>          <code class="n">Physics</code>  <code class="n">Belgium</code>  <code class="mi">6</code> <code class="n">November</code> <code class="mi">1932</code>
<code class="mi">19</code>         <code class="n">Niels</code> <code class="n">Bohr</code>          <code class="n">Physics</code>  <code class="n">Denmark</code>   <code class="mi">7</code> <code class="n">October</code> <code class="mi">1885</code>
<code class="mi">23</code>  <code class="n">Ben</code> <code class="n">Roy</code> <code class="n">Mottelson</code>          <code class="n">Physics</code>  <code class="n">Denmark</code>     <code class="n">July</code> <code class="mi">9</code><code class="p">,</code> <code class="mi">1926</code>
<code class="mi">24</code>          <code class="n">Aage</code> <code class="n">Bohr</code>          <code class="n">Physics</code>  <code class="n">Denmark</code>     <code class="mi">19</code> <code class="n">June</code> <code class="mi">1922</code>
<code class="mi">47</code>     <code class="n">Alfred</code> <code class="n">Kastler</code>          <code class="n">Physics</code>   <code class="n">France</code>       <code class="mi">3</code> <code class="n">May</code> <code class="mi">1902</code>
<code class="o">...</code></pre>
<p>Another way to select row subsets is to use a Boolean mask to create a new DataFrame. You can apply Boolean operators to all rows in a DataFrame in much the same way as you can to all members of a NumPy array:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">16</code><code class="p">]</code> <code class="n">df</code><code class="o">.</code><code class="n">category</code> <code class="o">==</code> <code class="s1">'Physics'</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code>
<code class="mi">0</code>     <code class="kc">False</code>
<code class="mi">1</code>     <code class="kc">False</code>
<code class="o">...</code>
<code class="mi">1047</code>   <code class="kc">True</code>
<code class="o">...</code></pre>
<p>The resulting Boolean mask can then be applied to the original DataFrame to select a subset of its rows:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="n">df</code><code class="p">[</code><code class="n">df</code><code class="o">.</code><code class="n">category</code> <code class="o">==</code> <code class="s1">'Physics'</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">17</code><code class="p">]:</code>
                          <code class="n">name</code>    <code class="n">born_in</code> <code class="n">category</code>    <code class="n">country</code>  \
<code class="mi">13</code>            <code class="n">François</code> <code class="n">Englert</code>             <code class="n">Physics</code>    <code class="n">Belgium</code>
<code class="mi">19</code>                  <code class="n">Niels</code> <code class="n">Bohr</code>             <code class="n">Physics</code>    <code class="n">Denmark</code>
<code class="mi">23</code>           <code class="n">Ben</code> <code class="n">Roy</code> <code class="n">Mottelson</code>             <code class="n">Physics</code>    <code class="n">Denmark</code>
<code class="mi">24</code>                   <code class="n">Aage</code> <code class="n">Bohr</code>             <code class="n">Physics</code>    <code class="n">Denmark</code>
<code class="o">...</code>
<code class="mi">1047</code>          <code class="n">Brian</code> <code class="n">P</code><code class="o">.</code> <code class="n">Schmidt</code>             <code class="n">Physics</code>  <code class="n">Australia</code>   <code class="o">...</code></pre>
<p>We’ll cover a lot more examples of data selections in the coming chapters. For now, let’s see how we create DataFrames from existing data and how to save the results of our data frame manipulations.<a data-primary="DataFrames" data-secondary="selecting groups" data-startref="ix_DaFrselgrp" data-type="indexterm" id="idm45607779583760"/><a data-primary="groups" data-secondary="selecting in pandas DataFrames" data-startref="ix_grpsel" data-type="indexterm" id="idm45607779543408"/><a data-primary="pandas" data-secondary="introduction to" data-startref="ix_pndsintrdf" data-tertiary="DataFrames" data-type="indexterm" id="idm45607779542320"/><a data-primary="DataFrames" data-startref="ix_DaFr" data-type="indexterm" id="idm45607779540928"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Creating and Saving DataFrames" data-type="sect1"><div class="sect1" id="load_save_dataframe">
<h1>Creating and Saving DataFrames</h1>
<p>The easiest way to create a DataFrame is to use a Python dictionary.<a data-primary="pandas" data-secondary="introduction to" data-tertiary="creating and saving DataFrames" data-type="indexterm" id="ix_pndsintrcrDF"/><a data-primary="DataFrames" data-secondary="creating and saving" data-type="indexterm" id="ix_DaFrcrsv"/> It’s also a way you won’t be using very often, as you will likely be accessing your data from files or databases. Nevertheless, it has its use cases.</p>
<p>By default, we specify the columns separately, in the following example creating three rows with name and category columns:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">({</code>
     <code class="s1">'name'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'Albert Einstein'</code><code class="p">,</code> <code class="s1">'Marie Curie'</code><code class="p">,</code>\
     <code class="s1">'William Faulkner'</code><code class="p">],</code>
     <code class="s1">'category'</code><code class="p">:</code> <code class="p">[</code><code class="s1">'Physics'</code><code class="p">,</code> <code class="s1">'Chemistry'</code><code class="p">,</code> <code class="s1">'Literature'</code><code class="p">]</code>
     <code class="p">})</code></pre>
<p>We can use the <code>from_dict</code> method to allow us to use our preferred record-based object arrays. <code>from_dict</code> has an <code>orient</code> argument to allow us to specify record-like data, but pandas is smart enough to work out the data form:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="o">.</code><code class="n">from_dict</code><code class="p">(</code><code class="p">[</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO3-1" id="co_introduction_to_pandas_CO3-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>     </code><code class="p">{</code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Albert Einstein</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">Physics</code><code class="s1">'</code><code class="p">}</code><code class="p">,</code><code>
</code><code>     </code><code class="p">{</code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Marie Curie</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">Chemistry</code><code class="s1">'</code><code class="p">}</code><code class="p">,</code><code>
</code><code>     </code><code class="p">{</code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">William Faulkner</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">:</code><code class="s1">'</code><code class="s1">Literature</code><code class="s1">'</code><code class="p">}</code><code>
</code><code>    </code><code class="p">]</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO3-1" id="callout_introduction_to_pandas_CO3-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Here we pass in an array of objects, each corresponding to a row in our <span class="keep-together">DataFrame</span>.</p></dd>
</dl>
<p>The methods just shown produce an identical DataFrame:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code><code class="o">.</code><code class="n">head</code><code class="p">()</code>
<code class="n">Out</code><code class="p">:</code>
               <code class="n">name</code>    <code class="n">category</code>
<code class="mi">0</code>   <code class="n">Albert</code> <code class="n">Einstein</code>     <code class="n">Physics</code>
<code class="mi">1</code>       <code class="n">Marie</code> <code class="n">Curie</code>   <code class="n">Chemistry</code>
<code class="mi">2</code>  <code class="n">William</code> <code class="n">Faulkner</code>  <code class="n">Literature</code></pre>
<p>As mentioned, you probably won’t be creating DataFrames from Python containers directly. Instead, you will probably use one of the pandas data-reading methods.</p>
<p>pandas has an impressive array of <code>read_[format]</code>/<code>to_[format]</code> methods, covering most conceivable data-loading use cases, from CSV through binary HDF5 to SQL databases. We’ll cover the subset most relevant to dataviz work. For a full list, see <a href="https://oreil.ly/b3VFR">the pandas <span class="keep-together">documentation</span></a>.</p>
<p>Note that by default pandas will try to convert the loaded data sensibly. The <code>convert_axes</code> (try to convert the axes to the proper <code>dtype</code>s), <code>dtype</code> (guess datatype), and <code>convert_dates</code> arguments to the read methods are all <code>True</code> by default. See the <a href="https://oreil.ly/MkmIx">pandas documentation</a> for an example of the available options, in this case for reading JSON files into a DataFrame.</p>
<p>Let’s cover file-based DataFrames first, then see how to interact with (No)SQL <span class="keep-together">databases</span>.</p>
<section data-pdf-bookmark="JSON" data-type="sect2"><div class="sect2" id="idm45607779336448">
<h2>JSON</h2>
<p>Loading data from our preferred JSON format<a data-primary="DataFrames" data-secondary="creating and saving" data-tertiary="JSON" data-type="indexterm" id="idm45607779334688"/><a data-primary="JSON" data-secondary="creating and saving JSON DataFrame" data-type="indexterm" id="idm45607779333440"/> is trivial in pandas:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="s1">'file.json'</code><code class="p">)</code></pre>
<p>There are various forms the JSON file can take, specified by an optional <code>orient</code> argument, one of [<code>split</code>, <code>records</code>, <code>index</code>, <code>columns</code>, <code>values</code>]. An array of records, our standard form, will be detected:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="p">[{</code><code class="s2">"name"</code><code class="o">:</code><code class="s2">"Albert Einstein"</code><code class="p">,</code> <code class="s2">"category"</code><code class="o">:</code><code class="s2">"Physics"</code><code class="p">,</code> <code class="p">...},</code>
<code class="p">{</code><code class="s2">"name"</code><code class="o">:</code><code class="s2">"Marie Curie"</code><code class="p">,</code> <code class="s2">"category"</code><code class="o">:</code><code class="s2">"Chemistry"</code><code class="p">,</code> <code class="p">...</code> <code class="p">}</code> <code class="p">...</code> <code class="p">]</code></pre>
<p>The default for a JSON object is <code>columns</code>, in the form:</p>
<pre data-code-language="javascript" data-type="programlisting"><code class="p">{</code><code class="s2">"name"</code><code class="o">:</code><code class="p">{</code><code class="s2">"0"</code><code class="o">:</code><code class="s2">"Albert Einstein"</code><code class="p">,</code><code class="s2">"1"</code><code class="o">:</code><code class="s2">"Marie Curie"</code> <code class="p">...</code> <code class="p">},</code>
<code class="s2">"category"</code><code class="o">:</code><code class="p">{</code><code class="s2">"1"</code><code class="p">,</code><code class="s2">"Physics"</code><code class="p">,</code><code class="s2">"2"</code><code class="o">:</code><code class="s2">"Chemistry"</code> <code class="p">...</code> <code class="p">}}</code></pre>
<p>As discussed, for web-based visualization work, particularly D3, record-based JSON arrays are the most common way of passing row-columnar data to the browser.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Note that you will need valid JSON files to work with pandas because the <code>read_json</code> method and Python <a data-primary="parsers" data-secondary="JSON" data-type="indexterm" id="idm45607779220064"/>JSON parsers in general tend to be fairly unforgiving, and exceptions not as informative as they might be.<sup><a data-type="noteref" href="ch08.xhtml#idm45607779218800" id="idm45607779218800-marker">3</a></sup> A common JSON error is failing to enclose keys in double-quote marks or using single quotes where double quotes are expected. The latter is particularly common for those coming from languages where single- and double-string quotes are essentially interchangeable and one reason why you should never build JSON documents yourself—​always use an official or well-respected library.</p>
</div>
<p>There are various ways to store DataFrames in JSON, but the format that will play most nicely with any dataviz work is the array of records.<a data-primary="records, array of, storing JSON DataFrame as" data-type="indexterm" id="idm45607779162224"/><a data-primary="arrays" data-secondary="of records, storing JSON DataFrame as" data-secondary-sortas="records" data-type="indexterm" id="idm45607779161552"/> This is the most common form of D3 data and the one I recommend outputting from pandas.<sup><a data-type="noteref" href="ch08.xhtml#idm45607779160128" id="idm45607779160128-marker">4</a></sup> Writing a DataFrame as records to JSON is then simply a case of specifying the <code>orient</code> field in the <code>to_json</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_json</code><code class="p">(</code><code class="s1">'</code><code class="s1">data.json</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="c1"># ... Perform data-cleaning operations</code><code>
</code><code class="n">json</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">to_json</code><code class="p">(</code><code class="s1">'</code><code class="s1">data_cleaned.json</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">orient</code><code class="o">=</code><code class="s1">'</code><code class="s1">records</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO4-1" id="co_introduction_to_pandas_CO4-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code class="p">[</code><code class="p">{</code><code class="s2">"</code><code class="s2">name</code><code class="s2">"</code><code class="p">:</code><code class="s2">"</code><code class="s2">Albert Einstein</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">category</code><code class="s2">"</code><code class="p">:</code><code class="s2">"</code><code class="s2">Physics</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code class="p">}</code><code class="p">,</code><code>
</code><code class="p">{</code><code class="s2">"</code><code class="s2">name</code><code class="s2">"</code><code class="p">:</code><code class="s2">"</code><code class="s2">Marie Curie</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="s2">"</code><code class="s2">category</code><code class="s2">"</code><code class="p">:</code><code class="s2">"</code><code class="s2">Chemistry</code><code class="s2">"</code><code class="p">,</code><code> </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code> </code><code class="p">}</code><code> </code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code> </code><code class="p">]</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO4-1" id="callout_introduction_to_pandas_CO4-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Override the default save to store the JSON as dataviz-friendly records.</p></dd>
</dl>
<p>We also have the parameters <code>date_format</code> (<em>epoch</em> timestamp, <em>iso</em> for ISO8601, etc.), <code>double_precision</code>, and <code>default_handler</code> to call if the object cannot be converted into JSON using pandas’s parser. Check <a href="https://oreil.ly/wqnI0">the pandas documentation</a> for more details.</p>
</div></section>
<section data-pdf-bookmark="CSV" data-type="sect2"><div class="sect2" id="idm45607779335792">
<h2>CSV</h2>
<p>As befits pandas’s data-table ethos, its handling of CSV files is sophisticated enough to cope with pretty much all conceivable data.<a data-primary="CSV files" data-secondary="creating and saving CSV DataFrame" data-type="indexterm" id="idm45607779076192"/><a data-primary="DataFrames" data-secondary="creating and saving" data-tertiary="CSV" data-type="indexterm" id="idm45607779075248"/>  Conventional CSV files, which is the large majority, will load without parameters:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># data.csv:</code>
<code class="c1"># name,category</code>
<code class="c1"># "Albert Einstein",Physics</code>
<code class="c1"># "Marie Curie",Chemistry</code>

<code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="s1">'data.csv'</code><code class="p">)</code>
<code class="n">df</code>
<code class="n">Out</code><code class="p">:</code>
              <code class="n">name</code>   <code class="n">category</code>
<code class="mi">0</code>  <code class="n">Albert</code> <code class="n">Einstein</code>    <code class="n">Physics</code>
<code class="mi">1</code>      <code class="n">Marie</code> <code class="n">Curie</code>  <code class="n">Chemistry</code></pre>
<p>Although you might expect all CSV files to be comma-separated, you will often find files with a CSV suffix with different delimiters such as semicolons or pipes (<code>|</code>). They may also use idiosyncratic quoting for strings containing spaces or special characters.<a data-primary="StringIO module (Python)" data-type="indexterm" id="idm45607779005472"/> In this case, we can specify any nonstandard elements in our read request. We’ll use Python’s handy <code>StringIO</code> module to emulate reading from a file:<sup><a data-type="noteref" href="ch08.xhtml#idm45607779004224" id="idm45607779004224-marker">5</a></sup></p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code><code> </code><code class="nn">io</code><code> </code><code class="kn">import</code><code> </code><code class="n">StringIO</code><code>
</code><code>
</code><code class="n">data</code><code> </code><code class="o">=</code><code> </code><code class="s2">"</code><code class="s2">  `Albert Einstein`| Physics </code><code class="se">\n</code><code class="s2">`Marie Curie`|  Chemistry</code><code class="s2">"</code><code>
</code><code>
</code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_csv</code><code class="p">(</code><code class="n">StringIO</code><code class="p">(</code><code class="n">data</code><code class="p">)</code><code class="p">,</code><code>
</code><code>   </code><code class="n">sep</code><code class="o">=</code><code class="s1">'</code><code class="s1">|</code><code class="s1">'</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO5-1" id="co_introduction_to_pandas_CO5-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>   </code><code class="n">names</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO5-2" id="co_introduction_to_pandas_CO5-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code>   </code><code class="n">skipinitialspace</code><code class="o">=</code><code class="kc">True</code><code class="p">,</code><code> </code><code class="n">quotechar</code><code class="o">=</code><code class="s2">"</code><code class="s2">`</code><code class="s2">"</code><code class="p">)</code><code>
</code><code>
</code><code class="n">df</code><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code>              </code><code class="n">name</code><code>   </code><code class="n">category</code><code>
</code><code class="mi">0</code><code>  </code><code class="n">Albert</code><code> </code><code class="n">Einstein</code><code>   </code><code class="n">Physics</code><code>
</code><code class="mi">1</code><code>      </code><code class="n">Marie</code><code> </code><code class="n">Curie</code><code>  </code><code class="n">Chemistry</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO5-1" id="callout_introduction_to_pandas_CO5-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>The fields are pipe-separated, not the default comma-separated.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO5-2" id="callout_introduction_to_pandas_CO5-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Here we provide the missing column headers.</p></dd>
</dl>
<p>We have the same degree of flexibility when saving CSV files, here setting the encoding to Unicode <code>utf-8</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code><code class="o">.</code><code class="n">to_csv</code><code class="p">(</code><code class="s1">'data.csv'</code><code class="p">,</code> <code class="n">encoding</code><code class="o">=</code><code class="s1">'utf-8'</code><code class="p">)</code></pre>
<p>For full coverage of the CSV options, see the <a href="https://oreil.ly/QPCs1">pandas documentation</a>.</p>
</div></section>
<section data-pdf-bookmark="Excel Files" data-type="sect2"><div class="sect2" id="idm45607778850240">
<h2>Excel Files</h2>
<p>pandas uses Python’s <code>xlrd</code> module to read Excel 2003 (<em>.xls</em>) and the <code>openpyxl</code> module to read Excel 2007+ (<em>.xlsx</em>) files. <a data-primary="Excel files" data-secondary="loading and saving in DataFrames" data-type="indexterm" id="idm45607778844976"/><a data-primary="DataFrames" data-secondary="creating and saving" data-tertiary="Excel files" data-type="indexterm" id="idm45607778844000"/><a data-primary="xlrd module (Python)" data-type="indexterm" id="idm45607778842784"/><a data-primary="openpyxl module (Python)" data-type="indexterm" id="idm45607778842112"/>The latter is an optional dependency that will need installing:</p>
<pre data-code-language="bash" data-type="programlisting">$ pip install openpyxl</pre>
<p>Excel documents have multiple named sheets, each of which can be passed to a DataFrame. There are two ways to read a datasheet into a DataFrame. The first is by creating and then parsing an <code>ExcelFile</code> object:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">dfs</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code class="p">}</code><code>
</code><code class="n">xls</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">ExcelFile</code><code class="p">(</code><code class="s1">'</code><code class="s1">data/nobel_winners.xlsx</code><code class="s1">'</code><code class="p">)</code><code> </code><code class="c1"># load Excel file</code><code>
</code><code class="n">dfs</code><code class="p">[</code><code class="s1">'</code><code class="s1">WinnersSheet1</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">xls</code><code class="o">.</code><code class="n">parse</code><code class="p">(</code><code class="s1">'</code><code class="s1">WinnersSheet1</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">na_values</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">NA</code><code class="s1">'</code><code class="p">]</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO6-1" id="co_introduction_to_pandas_CO6-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">dfs</code><code class="p">[</code><code class="s1">'</code><code class="s1">WinnersSheet2</code><code class="s1">'</code><code class="p">]</code><code> </code><code class="o">=</code><code> </code><code class="n">xls</code><code class="o">.</code><code class="n">parse</code><code class="p">(</code><code class="s1">'</code><code class="s1">WinnersSheet2</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>    </code><code class="n">index_col</code><code class="o">=</code><code class="mi">1</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO6-2" id="co_introduction_to_pandas_CO6-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code>    </code><code class="n">na_values</code><code class="o">=</code><code class="p">[</code><code class="s1">'</code><code class="s1">-</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO6-3" id="co_introduction_to_pandas_CO6-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code>    </code><code class="n">skiprows</code><code class="o">=</code><code class="mi">3</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO6-4" id="co_introduction_to_pandas_CO6-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a><code>
</code><code>    </code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO6-1" id="callout_introduction_to_pandas_CO6-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Grab a sheet by name and save to a dictionary.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO6-2" id="callout_introduction_to_pandas_CO6-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Specify the column, by position, to use as DataFrame’s row labels.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO6-3" id="callout_introduction_to_pandas_CO6-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>A list of additional strings to recognize as NaN.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO6-4" id="callout_introduction_to_pandas_CO6-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></dt>
<dd><p>The number of rows (e.g., metadata) to skip before processing.</p></dd>
</dl>
<p>Alternatively you can use the <code>read_excel</code> method, which is a convenience method for loading multiple spreadsheets:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">dfs</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'data/nobel_winners.xlsx'</code><code class="p">,</code> <code class="p">[</code><code class="s1">'WinnersSheet1'</code><code class="p">,</code><code class="s1">'WinnersSheet2'</code><code class="p">],</code>
                      <code class="n">index_col</code><code class="o">=</code><code class="kc">None</code><code class="p">,</code> <code class="n">na_values</code><code class="o">=</code><code class="p">[</code><code class="s1">'NA'</code><code class="p">])</code></pre>
<p>Let’s check the content of the second Excel sheet using the resulting DataFrame:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">In</code><code class="p">:</code> <code class="n">dfs</code><code class="p">[</code><code class="s1">'WinnersSheet2'</code><code class="p">]</code><code class="o">.</code><code class="n">head</code><code class="p">()</code>
<code class="n">Out</code><code class="p">:</code>
     <code class="n">category</code>             <code class="n">nationality</code>  <code class="n">year</code>                <code class="n">name</code>    <code class="n">gender</code>
<code class="mi">0</code>       <code class="n">Peace</code>                <code class="n">American</code>  <code class="mi">1906</code>  <code class="n">Theodore</code> <code class="n">Roosevelt</code>      <code class="n">male</code>
<code class="mi">1</code>  <code class="n">Literature</code>           <code class="n">South</code> <code class="n">African</code>  <code class="mi">1991</code>     <code class="n">Nadine</code> <code class="n">Gordimer</code>    <code class="n">female</code>
<code class="mi">2</code>   <code class="n">Chemistry</code>  <code class="n">Bosnia</code> <code class="ow">and</code> <code class="n">Herzegovina</code>  <code class="mi">1975</code>     <code class="n">Vladamir</code> <code class="n">Prelog</code>      <code class="n">male</code></pre>
<p>The only reason not to use <code>read_excel</code> is if you need different arguments for reading each Excel sheet.</p>
<p>You can specify sheets by index or name using the second (<code>sheetname</code>) parameter. <code>sheetname</code> can be a single name string or index (beginning at 0) or a mixed list. By default <code>sheetname</code> is <code>0</code>, returning the first sheet. <a data-type="xref" href="#excel_loads">Example 8-1</a> shows some variations. Setting <code>sheetname</code> to <code>None</code> returns a sheetname-keyed dictionary of DataFrames.</p>
<div data-type="example" id="excel_loads">
<h5><span class="label">Example 8-1. </span>Loading Excel sheets</h5>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># return the first datasheet</code>
<code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xls'</code><code class="p">)</code>

<code class="c1"># return a named sheet</code>
<code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xls'</code><code class="p">,</code> <code class="s1">'WinnersSheet3'</code><code class="p">)</code>

<code class="c1"># first sheet and sheet named 'WinnersSheet3'</code>
<code class="n">df</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xls'</code><code class="p">,</code> <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="s1">'WinnersSheet3'</code><code class="p">])</code>

<code class="c1"># all sheets loaded into a name-keyed dictionary</code>
<code class="n">dfs</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xls'</code><code class="p">,</code> <code class="n">sheetname</code><code class="o">=</code><code class="kc">None</code><code class="p">)</code></pre></div>
<p>The <code>parse_cols</code> parameter lets you select the sheet columns to be parsed. Setting <code>parse_cols</code> to an integer value selects all columns up to that ordinal. <a data-primary="columns" data-secondary="Excel worksheet, parsing into DataFrame" data-type="indexterm" id="idm45607778498576"/>Setting <code>parse_cols</code> to a list of integers allows you to select specific columns:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># parse up to the fifth column</code>
<code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xls'</code><code class="p">,</code> <code class="s1">'WinnersSheet1'</code><code class="p">,</code> <code class="n">parse_cols</code><code class="o">=</code><code class="mi">4</code><code class="p">)</code>

<code class="c1"># parse the second and fourth columns</code>
<code class="n">pd</code><code class="o">.</code><code class="n">read_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xls'</code><code class="p">,</code> <code class="s1">'WinnersSheet1'</code><code class="p">,</code> <code class="n">parse_cols</code><code class="o">=</code><code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code></pre>
<p>For more information on <code>read_excel</code>, see the <a href="https://oreil.ly/Js7Le">pandas documentation</a>.</p>
<p>You can save a<a data-primary="Excel files" data-secondary="loading and saving DataFrame to Excel sheet" data-type="indexterm" id="idm45607778408352"/> DataFrame to the sheet of an  Excel file with the <code>to_excel</code> method, giving the Excel filename and a sheetname, <code>'nobel_winners'</code> and <code>'WinnersSheet1'</code>, respectively, in this example:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">df</code><code class="o">.</code><code class="n">to_excel</code><code class="p">(</code><code class="s1">'nobel_winners.xlsx'</code><code class="p">,</code> <code class="n">sheet_name</code><code class="o">=</code><code class="s1">'WinnersSheet1'</code><code class="p">)</code></pre>
<p>There are various options similar to <code>to_csv</code> covered in the <a href="https://oreil.ly/g15Al">pandas docs</a>. Because pandas <code>Panel</code>s and Excel files can store multiple DataFrames,  there is a <code>Panel</code> <code>to_excel</code> method to write all its DataFrames to an Excel file.<a data-primary="Panel (pandas), to_excel method" data-type="indexterm" id="idm45607778394768"/></p>
<p>If you need to select multiple DataFrames to write to a shared Excel file, you can use an <code>ExcelWriter</code> object:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">with</code> <code class="n">pd</code><code class="o">.</code><code class="n">ExcelWriter</code><code class="p">(</code><code class="s1">'nobel_winners.xlsx'</code><code class="p">)</code> <code class="k">as</code> <code class="n">writer</code><code class="p">:</code>
    <code class="n">df1</code><code class="o">.</code><code class="n">to_excel</code><code class="p">(</code><code class="n">writer</code><code class="p">,</code> <code class="n">sheet_name</code><code class="o">=</code><code class="s1">'WinnersSheet1'</code><code class="p">)</code>
    <code class="n">df2</code><code class="o">.</code><code class="n">to_excel</code><code class="p">(</code><code class="n">writer</code><code class="p">,</code> <code class="n">sheet_name</code><code class="o">=</code><code class="s1">'WinnersSheet2'</code><code class="p">)</code></pre>
</div></section>
<section data-pdf-bookmark="SQL" data-type="sect2"><div class="sect2" id="sect_pandas_sql">
<h2>SQL</h2>
<p>By preference pandas uses Python’s <code>SQLAlchemy</code> module to do the database abstraction.  <a data-primary="DataFrames" data-secondary="creating and saving" data-tertiary="SQL" data-type="indexterm" id="idm45607778313056"/><a data-primary="SQL" data-secondary="loading and saving in DataFrames" data-type="indexterm" id="idm45607778311808"/>If using <code>SQLAlchemy</code>, you’ll also need the driver library for your database.</p>
<p>The easiest way to load a database table or the results of an SQL query is with the <code>read_sql</code> method. Let’s use our preferred SQLite database and read its winners table into a DataFrame:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code><code> </code><code class="nn">sqlalchemy</code><code>
</code><code>
</code><code class="n">engine</code><code> </code><code class="o">=</code><code> </code><code class="n">sqlalchemy</code><code class="o">.</code><code class="n">create_engine</code><code class="p">(</code><code>
</code><code>                </code><code class="s1">'</code><code class="s1">sqlite:///data/nobel_winners.db</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO7-1" id="co_introduction_to_pandas_CO7-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">read_sql</code><code class="p">(</code><code class="s1">'</code><code class="s1">winners</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">engine</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO7-2" id="co_introduction_to_pandas_CO7-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="n">df</code><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code>     </code><code class="n">index</code><code>                </code><code class="n">category</code><code>    </code><code class="n">country</code><code> </code><code class="n">date_of_birth</code><code>
</code><code class="mi">0</code><code>     </code><code class="mi">4</code><code>                   </code><code class="n">Peace</code><code>    </code><code class="n">Belgium</code><code>    </code><code class="mi">1829</code><code class="o">-</code><code class="mi">07</code><code class="o">-</code><code class="mi">26</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code><code>
</code><code>                      </code><code class="n">name</code><code>                          </code><code class="n">place_of_birth</code><code>
</code><code class="mi">0</code><code>    </code><code class="n">Auguste</code><code> </code><code class="n">Beernaert</code><code>  </code><code class="n">Ostend</code><code> </code><code class="p">,</code><code>  </code><code class="n">Netherlands</code><code>  </code><code class="p">(</code><code class="n">now</code><code>  </code><code class="n">Belgium</code><code> </code><code class="p">)</code><code>
</code><code class="o">.</code><code class="o">.</code><code class="o">.</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO7-1" id="callout_introduction_to_pandas_CO7-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Here, we use an existing SQLite (file-based) database. SQLAlchemy can create engines for all the commonly used databases, for example <em>mysql://USER:PASSWORD@localhost/db</em>.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO7-2" id="callout_introduction_to_pandas_CO7-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Read the contents of the <code>'nobel_winners'</code> SQL table into a DataFrame. <code>read_sql</code> is a convenience wrapper around the <code>read_sql_table</code> and <code>read_sql_query</code> methods and will do the right thing depending on its first argument.</p></dd>
</dl>
<p>Writing DataFrames to an SQL database is simple enough. Using the engine we just created, we can add a <a data-primary="SQL" data-secondary="writing DataFrames to SQLite database" data-type="indexterm" id="idm45607778226544"/>copy of the winners table to our SQLite database:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># save DataFrame df to nobel_winners SQL table</code>
<code class="n">df</code><code class="o">.</code><code class="n">to_sql</code><code class="p">(</code><code class="s1">'winners_copy'</code><code class="p">,</code> <code class="n">engine</code><code class="p">,</code> <code class="n">if_exists</code><code class="o">=</code><code class="s1">'replace'</code><code class="p">)</code></pre>
<p>If you encounter errors due to packet-size limitations, the <code>chunksize</code> parameter can set the number of rows to be written at a time:</p>
<pre data-code-language="python" data-type="programlisting"><code class="c1"># write 500 rows at a time</code>
<code class="n">df</code><code class="o">.</code><code class="n">to_sql</code><code class="p">(</code><code class="s1">'winners_copy'</code><code class="p">,</code> <code class="n">engine</code><code class="p">,</code> <code class="n">chunksize</code><code class="o">=</code><code class="mi">500</code><code class="p">)</code></pre>
<p>pandas will do the sensible thing and try to map your data to a suitable SQL type, inferring the datatype of objects. If necessary, the default type can be overridden in the load call:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">from</code><code> </code><code class="nn">sqlalchemy</code><code class="nn">.</code><code class="nn">types</code><code> </code><code class="kn">import</code><code> </code><code class="n">String</code><code>
</code><code class="n">df</code><code class="o">.</code><code class="n">to_sql</code><code class="p">(</code><code class="s1">'</code><code class="s1">winners_copy</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">engine</code><code class="p">,</code><code> </code><code class="n">dtype</code><code class="o">=</code><code class="p">{</code><code class="s1">'</code><code class="s1">year</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="n">String</code><code class="p">}</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO8-1" id="co_introduction_to_pandas_CO8-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO8-1" id="callout_introduction_to_pandas_CO8-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Override pandas’s inference, and specify year as a <code>String</code> <span class="keep-together">column</span>.</p></dd>
</dl>
<p>Further details of pandas-SQL interaction can be found <a href="https://oreil.ly/kiLyQ">in the pandas <span class="keep-together">documentation</span></a>.</p>
</div></section>
<section data-pdf-bookmark="MongoDB" data-type="sect2"><div class="sect2" id="mongo_to_dataframe">
<h2>MongoDB</h2>
<p>For dataviz work, there’s a lot to be said for the convenience of document-based NoSQL databases like MongoDB.<a data-primary="MongoDB" data-secondary="loading and saving document collection into DataFrames" data-type="indexterm" id="idm45607778083760"/><a data-primary="DataFrames" data-secondary="creating and saving" data-tertiary="MongoDB document collections" data-type="indexterm" id="idm45607778082816"/> In MongoDB’s case, things are even better, as it uses a binary form of JSON for its datastore—​namely BSON, short for binary JSON. Since JSON is our data glue of choice, as it connects our web dataviz with its backend server, there’s a good reason to consider storing your datasets in Mongo. It also plays nicely with pandas.</p>
<p>As we’ve seen, pandas DataFrames convert nicely to and from JSON format, so getting a Mongo document collection into a pandas DataFrame is a pretty easy affair:</p>
<pre data-code-language="python" data-type="programlisting"><code class="kn">import</code><code> </code><code class="nn">pandas</code><code> </code><code class="k">as</code><code> </code><code class="nn">pd</code><code>
</code><code class="kn">from</code><code> </code><code class="nn">pymongo</code><code> </code><code class="kn">import</code><code> </code><code class="n">MongoClient</code><code>
</code><code>
</code><code class="n">client</code><code> </code><code class="o">=</code><code> </code><code class="n">MongoClient</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO9-1" id="co_introduction_to_pandas_CO9-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>
</code><code class="n">db</code><code> </code><code class="o">=</code><code> </code><code class="n">client</code><code class="o">.</code><code class="n">nobel_prize</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO9-2" id="co_introduction_to_pandas_CO9-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="n">cursor</code><code> </code><code class="o">=</code><code> </code><code class="n">db</code><code class="o">.</code><code class="n">winners</code><code class="o">.</code><code class="n">find</code><code class="p">(</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO9-3" id="co_introduction_to_pandas_CO9-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="nb">list</code><code class="p">(</code><code class="n">cursor</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO9-4" id="co_introduction_to_pandas_CO9-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a><code>
</code><code class="n">df</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO9-5" id="co_introduction_to_pandas_CO9-5"><img alt="5" height="12" src="assets/5.png" width="12"/></a><code>
</code><code class="c1"># _</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO9-1" id="callout_introduction_to_pandas_CO9-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Create a Mongo client, using the default host and ports.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO9-2" id="callout_introduction_to_pandas_CO9-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Get the <code>nobel_prize</code> database.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO9-3" id="callout_introduction_to_pandas_CO9-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Find all documents in the <code>winner</code> collection.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO9-4" id="callout_introduction_to_pandas_CO9-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></dt>
<dd><p>Load all documents from the cursor into a list and use to create a DataFrame.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO9-5" id="callout_introduction_to_pandas_CO9-5"><img alt="5" height="12" src="assets/5.png" width="12"/></a></dt>
<dd><p>The winners collection is empty at this point—let’s fill it with some DataFrame data.</p></dd>
</dl>
<p>It’s just as easy to insert a DataFrame’s records into a MongoDB database. Here, we use the <code>get_mongo_database</code> method we defined in <a data-type="xref" href="ch03.xhtml#data_get_mongo">Example 3-5</a> to get our <code>nobel_prize</code> database and save the DataFrame to its winners collection:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">db</code><code> </code><code class="o">=</code><code> </code><code class="n">get_mongo_database</code><code class="p">(</code><code class="s1">'</code><code class="s1">nobel_prize</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>
</code><code class="n">records</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">to_dict</code><code class="p">(</code><code class="s1">'</code><code class="s1">records</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO10-1" id="co_introduction_to_pandas_CO10-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">db</code><code class="p">[</code><code class="n">collection</code><code class="p">]</code><code class="o">.</code><code class="n">insert_many</code><code class="p">(</code><code class="n">records</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO10-2" id="co_introduction_to_pandas_CO10-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO10-1" id="callout_introduction_to_pandas_CO10-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Converts the DataFrame to a <code>dict</code>, using the <code>records</code> argument to convert the rows into individual objects.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO10-2" id="callout_introduction_to_pandas_CO10-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>For PyMongo version 2, use the <code>insert</code> method.</p></dd>
</dl>
<p>pandas doesn’t<a data-primary="MongoDB" data-secondary="creating utility functions  to convert to/from MongoDB and DataFrames" data-type="indexterm" id="idm45607777907552"/> have MongoDB convenience methods comparable to <code>to_csv</code> or <code>read_csv</code>, but it’s easy enough to roll a couple of utility functions to convert from MongoDB to DataFrames and back again:</p>
<pre data-code-language="python" data-type="programlisting"><code class="k">def</code><code> </code><code class="nf">mongo_to_dataframe</code><code class="p">(</code><code class="n">db_name</code><code class="p">,</code><code> </code><code class="n">collection</code><code class="p">,</code><code> </code><code class="n">query</code><code class="o">=</code><code class="p">{</code><code class="p">}</code><code class="p">,</code><code>\
</code><code>                       </code><code class="n">host</code><code class="o">=</code><code class="s1">'</code><code class="s1">localhost</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">port</code><code class="o">=</code><code class="mi">27017</code><code class="p">,</code><code>\
</code><code>                       </code><code class="n">username</code><code class="o">=</code><code class="kc">None</code><code class="p">,</code><code> </code><code class="n">password</code><code class="o">=</code><code class="kc">None</code><code class="p">,</code><code>\
</code><code>                        </code><code class="n">no_id</code><code class="o">=</code><code class="kc">True</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="sd">""" create a DataFrame from mongodb collection """</code><code>
</code><code>
</code><code>    </code><code class="n">db</code><code> </code><code class="o">=</code><code> </code><code class="n">get_mongo_database</code><code class="p">(</code><code class="n">db_name</code><code class="p">,</code><code> </code><code class="n">host</code><code class="p">,</code><code> </code><code class="n">port</code><code class="p">,</code><code> </code><code class="n">username</code><code class="p">,</code><code>\
</code><code>     </code><code class="n">password</code><code class="p">)</code><code>
</code><code>    </code><code class="n">cursor</code><code> </code><code class="o">=</code><code> </code><code class="n">db</code><code class="p">[</code><code class="n">collection</code><code class="p">]</code><code class="o">.</code><code class="n">find</code><code class="p">(</code><code class="n">query</code><code class="p">)</code><code>
</code><code>    </code><code class="n">df</code><code> </code><code class="o">=</code><code>  </code><code class="n">pd</code><code class="o">.</code><code class="n">DataFrame</code><code class="p">(</code><code class="nb">list</code><code class="p">(</code><code class="n">cursor</code><code class="p">)</code><code class="p">)</code><code>
</code><code>
</code><code>    </code><code class="k">if</code><code> </code><code class="n">no_id</code><code class="p">:</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO11-1" id="co_introduction_to_pandas_CO11-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code>        </code><code class="k">del</code><code> </code><code class="n">df</code><code class="p">[</code><code class="s1">'</code><code class="s1">_id</code><code class="s1">'</code><code class="p">]</code><code>
</code><code>
</code><code>    </code><code class="k">return</code><code> </code><code class="n">df</code><code>
</code><code>
</code><code class="k">def</code><code> </code><code class="nf">dataframe_to_mongo</code><code class="p">(</code><code class="n">df</code><code class="p">,</code><code> </code><code class="n">db_name</code><code class="p">,</code><code> </code><code class="n">collection</code><code class="p">,</code><code>\
</code><code>                       </code><code class="n">host</code><code class="o">=</code><code class="s1">'</code><code class="s1">localhost</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="n">port</code><code class="o">=</code><code class="mi">27017</code><code class="p">,</code><code>\
</code><code>                       </code><code class="n">username</code><code class="o">=</code><code class="kc">None</code><code class="p">,</code><code> </code><code class="n">password</code><code class="o">=</code><code class="kc">None</code><code class="p">)</code><code class="p">:</code><code>
</code><code>    </code><code class="sd">""" save a DataFrame to mongodb collection """</code><code>
</code><code>    </code><code class="n">db</code><code> </code><code class="o">=</code><code> </code><code class="n">get_mongo_database</code><code class="p">(</code><code class="n">db_name</code><code class="p">,</code><code> </code><code class="n">host</code><code class="p">,</code><code> </code><code class="n">port</code><code class="p">,</code><code> </code><code class="n">username</code><code class="p">,</code><code>\
</code><code>     </code><code class="n">password</code><code class="p">)</code><code>
</code><code>
</code><code>    </code><code class="n">records</code><code> </code><code class="o">=</code><code> </code><code class="n">df</code><code class="o">.</code><code class="n">to_dict</code><code class="p">(</code><code class="s1">'</code><code class="s1">records</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>    </code><code class="n">db</code><code class="p">[</code><code class="n">collection</code><code class="p">]</code><code class="o">.</code><code class="n">insert_many</code><code class="p">(</code><code class="n">records</code><code class="p">)</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO11-1" id="callout_introduction_to_pandas_CO11-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Mongo’s <code>_id</code> field will be included in the DataFrame. By default, remove the column.</p></dd>
</dl>
<p class="pagebreak-before">Having inserted the DataFrame’s records into Mongo, let’s make sure they have been successfully stored:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">db</code><code> </code><code class="o">=</code><code> </code><code class="n">get_mongo_database</code><code class="p">(</code><code class="s1">'</code><code class="s1">nobel_prize</code><code class="s1">'</code><code class="p">)</code><code>
</code><code class="nb">list</code><code class="p">(</code><code class="n">db</code><code class="o">.</code><code class="n">winners</code><code class="o">.</code><code class="n">find</code><code class="p">(</code><code class="p">)</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO12-1" id="co_introduction_to_pandas_CO12-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="p">[</code><code class="p">{</code><code class="s1">'</code><code class="s1">_id</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="n">ObjectId</code><code class="p">(</code><code class="s1">'</code><code class="s1">62fcf2fb0e7fe50ac4393912</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">id</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Physics</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Albert Einstein</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">nationality</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Swiss</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">year</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1921</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">gender</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">male</code><code class="s1">'</code><code class="p">}</code><code class="p">,</code><code>
</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">_id</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="n">ObjectId</code><code class="p">(</code><code class="s1">'</code><code class="s1">62fcf2fb0e7fe50ac4393913</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">id</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">2</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Physics</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Paul Dirac</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">nationality</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">British</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">year</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1933</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">gender</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">male</code><code class="s1">'</code><code class="p">}</code><code class="p">,</code><code>
</code><code> </code><code class="p">{</code><code class="s1">'</code><code class="s1">_id</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="n">ObjectId</code><code class="p">(</code><code class="s1">'</code><code class="s1">62fcf2fb0e7fe50ac4393914</code><code class="s1">'</code><code class="p">)</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">id</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">3</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Chemistry</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Marie Curie</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">nationality</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">Polish</code><code class="s1">'</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">year</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="mi">1911</code><code class="p">,</code><code>
</code><code>  </code><code class="s1">'</code><code class="s1">gender</code><code class="s1">'</code><code class="p">:</code><code> </code><code class="s1">'</code><code class="s1">female</code><code class="s1">'</code><code class="p">}</code><code class="p">]</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO12-1" id="callout_introduction_to_pandas_CO12-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>The collection’s <code>find</code> method returns a cursor, which we convert to a Python list to see the contents.</p></dd>
</dl>
<p>Another way to create DataFrames is to build them from a collection of Series. Let’s have a look at that, taking the opportunity to explore Series in more detail.<a data-primary="pandas" data-secondary="introduction to" data-startref="ix_pndsintrcrDF" data-tertiary="creating and saving DataFrames" data-type="indexterm" id="idm45607777635904"/><a data-primary="DataFrames" data-secondary="creating and saving" data-startref="ix_DaFrcrsv" data-type="indexterm" id="idm45607777634416"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Series into DataFrames" data-type="sect1"><div class="sect1" id="idm45607779539392">
<h1>Series into DataFrames</h1>
<p>Series are the building block of pandas’s DataFrames. <a data-primary="DataFrames" data-secondary="combining Series into" data-type="indexterm" id="ix_DaFrSer"/><a data-primary="Series (pandas)" data-secondary="converting to DataFrames" data-type="indexterm" id="ix_SerDF"/><a data-primary="pandas" data-secondary="introduction to" data-tertiary="combining Series into DataFrames" data-type="indexterm" id="ix_pndsintrSerDF"/>They can be manipulated independently with methods that mirror those of the DataFrame and they can be combined to form DataFrames, as we’ll see in the subsection.</p>
<p>The key idea with pandas Series is the index. <a data-primary="indices" data-secondary="pandas Series" data-type="indexterm" id="idm45607777626784"/>These indices function as labels for the heterogeneous data contained in, say, a row of data. When pandas operates on more than one data object, these indices are used to align the fields.</p>
<p>Series can be created in one of three ways. The first is from a Python list or NumPy array:</p>
<pre class="pagebreak-before" data-code-language="python" data-type="programlisting"><code class="n">s</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">])</code> <code class="c1"># Series(np.arange(4))</code>
<code class="n">Out</code><code class="p">:</code>
<code class="mi">0</code>    <code class="mi">1</code> <code class="c1"># index, value</code>
<code class="mi">1</code>    <code class="mi">2</code>
<code class="mi">2</code>    <code class="mi">3</code>
<code class="mi">3</code>    <code class="mi">4</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre>
<p>Note that integer indices are automatically created for our Series. If we were adding a row of data to a DataFrame (table), we would want to specify the column indices by passing them as a list of integers or labels:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">s</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="n">index</code><code class="o">=</code><code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">])</code>
<code class="n">s</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">a</code>    <code class="mi">1</code>
<code class="n">b</code>    <code class="mi">2</code>
<code class="n">c</code>    <code class="mi">3</code>
<code class="n">d</code>    <code class="mi">4</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre>
<p>Note that the length of the index array should match the length of the data array.</p>
<p>We can specify both data and index using a Python <code>dict</code>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">s</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">({</code><code class="s1">'a'</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">:</code><code class="mi">3</code><code class="p">})</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">a</code>    <code class="mi">1</code>
<code class="n">b</code>    <code class="mi">2</code>
<code class="n">c</code>    <code class="mi">3</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre>
<p>If we pass an index array along with the <code>dict</code>, pandas will do the sensible thing, matching the indices to the data array. Any unmatched indices will be set to <code>NaN</code> (not a number), and any unmatched data discarded. Note one consequence of having fewer elements than indices is that the series is cast to a <code>float64</code> type:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">s</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">({</code><code class="s1">'a'</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">:</code><code class="mi">2</code><code class="p">},</code> <code class="n">index</code><code class="o">=</code><code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">a</code>    <code class="mf">1.0</code>
<code class="n">b</code>    <code class="mf">2.0</code>
<code class="n">c</code>    <code class="n">NaN</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">float64</code>

<code class="n">s</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">({</code><code class="s1">'a'</code><code class="p">:</code><code class="mi">1</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">:</code><code class="mi">2</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">:</code><code class="mi">3</code><code class="p">},</code> <code class="n">index</code><code class="o">=</code><code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">a</code> <code class="mi">1</code>
<code class="n">b</code> <code class="mi">2</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre>
<p>Finally, we can pass a single, scalar value as data to the Series, provided we also specify an index. The scalar value is then applied to all indices:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">(</code><code class="mi">9</code><code class="p">,</code> <code class="p">{</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">})</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">a</code>    <code class="mi">9</code>
<code class="n">b</code>    <code class="mi">9</code>
<code class="n">c</code>    <code class="mi">9</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre>
<p>Series are like NumPy arrays (<code>ndarray</code>), which means they can be passed to most NumPy functions:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">s</code> <code class="o">=</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">],</code> <code class="p">[</code><code class="s1">'a'</code><code class="p">,</code> <code class="s1">'b'</code><code class="p">,</code> <code class="s1">'c'</code><code class="p">,</code> <code class="s1">'d'</code><code class="p">])</code>
<code class="n">np</code><code class="o">.</code><code class="n">sqrt</code><code class="p">(</code><code class="n">s</code><code class="p">)</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">a</code>    <code class="mf">1.000000</code>
<code class="n">b</code>    <code class="mf">1.414214</code>
<code class="n">c</code>    <code class="mf">1.732051</code>
<code class="n">d</code>    <code class="mf">2.000000</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">float64</code></pre>
<p>Slicing operations work as they would with Python lists or <code>ndarray</code>s, but note that the index labels are preserved:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">s</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="mi">3</code><code class="p">]</code>
<code class="n">Out</code><code class="p">:</code>
<code class="n">b</code>  <code class="mi">2</code>
<code class="n">c</code>  <code class="mi">3</code>
<code class="n">dtype</code><code class="p">:</code> <code class="n">int64</code></pre>
<p>Unlike NumPy’s arrays, pandas’s series can take data of multiple types. Adding <span class="keep-together">two series</span> demonstrates this utility with numbers being added while strings are <span class="keep-together">concatenated</span>:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mf">2.1</code><code class="p">,</code> <code class="s1">'foo'</code><code class="p">])</code> <code class="o">+</code> <code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">([</code><code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="s1">'bar'</code><code class="p">])</code>
<code class="n">Out</code><code class="p">:</code>
<code class="mi">0</code>         <code class="mi">3</code> <code class="c1"># 1 + 2</code>
<code class="mi">1</code>       <code class="mf">5.1</code> <code class="c1"># 2.1 + 3</code>
<code class="mi">2</code>    <code class="n">foobar</code> <code class="c1"># strings correctly concatenated</code>
<code class="n">dtype</code><code class="p">:</code> <code class="nb">object</code></pre>
<p>The ability to create and manipulate individual Series is particularly important when you are interacting with the NumPy ecosystem, manipulating data from a DataFrame, or creating visualizations outside of pandas’s Matplotlib wrapper.</p>
<p>As Series are the building block of DataFrames, it’s easy to join them together to create a DataFrame, using pandas’s <code>concat</code> method:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">names</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">(</code><code class="p">[</code><code class="s1">'</code><code class="s1">Albert Einstein</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Marie Curie</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>\
</code><code> </code><code class="n">name</code><code class="o">=</code><code class="s1">'</code><code class="s1">name</code><code class="s1">'</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO13-1" id="co_introduction_to_pandas_CO13-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
</code><code class="n">categories</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">Series</code><code class="p">(</code><code class="p">[</code><code class="s1">'</code><code class="s1">Physics</code><code class="s1">'</code><code class="p">,</code><code> </code><code class="s1">'</code><code class="s1">Chemistry</code><code class="s1">'</code><code class="p">]</code><code class="p">,</code><code>\
</code><code> </code><code class="n">name</code><code class="o">=</code><code class="s1">'</code><code class="s1">category</code><code class="s1">'</code><code class="p">)</code><code>
</code><code>
</code><code class="n">df</code><code> </code><code class="o">=</code><code> </code><code class="n">pd</code><code class="o">.</code><code class="n">concat</code><code class="p">(</code><code class="p">[</code><code class="n">names</code><code class="p">,</code><code> </code><code class="n">categories</code><code class="p">]</code><code class="p">,</code><code> </code><code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code><code> </code><a class="co" href="#callout_introduction_to_pandas_CO13-2" id="co_introduction_to_pandas_CO13-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code>
</code><code class="n">df</code><code class="o">.</code><code class="n">head</code><code class="p">(</code><code class="p">)</code><code>
</code><code class="n">Out</code><code class="p">:</code><code>
</code><code>               </code><code class="n">name</code><code>    </code><code class="n">category</code><code>
</code><code class="mi">0</code><code>   </code><code class="n">Albert</code><code> </code><code class="n">Einstein</code><code>     </code><code class="n">Physics</code><code>
</code><code class="mi">1</code><code>       </code><code class="n">Marie</code><code> </code><code class="n">Curie</code><code>   </code><code class="n">Chemistry</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_introduction_to_pandas_CO13-1" id="callout_introduction_to_pandas_CO13-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>We use the <code>names</code> and <code>categories</code> series to provide the data and column names (the series <code>name</code> property) for a DataFrame.</p></dd>
<dt><a class="co" href="#co_introduction_to_pandas_CO13-2" id="callout_introduction_to_pandas_CO13-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Concatenate the two  Series using the <code>axis</code> argument of <code>1</code> to indicate that the Series are columns.</p></dd>
</dl>
<p>Along with the many ways to create DataFrames from files and databases just discussed, you should now have a solid grounding in getting data into and out of DataFrames.</p>
</div></section>
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="idm45607777632288">
<h1>Summary</h1>
<p>This chapter laid a foundation for the two pandas-based chapters to come. The core concepts of pandas—​the DataFrame, Index, and Series—were discussed and we saw why pandas is such a good fit with the type of real-world data that data visualizers deal with, extending the NumPy <code>ndarray</code> by allowing the storage of heterogeneous data and adding a powerful indexing system.<a data-primary="DataFrames" data-secondary="combining Series into" data-startref="ix_DaFrSer" data-type="indexterm" id="idm45607776765072"/><a data-primary="pandas" data-secondary="introduction to" data-startref="ix_pndsintrSerDF" data-tertiary="combining Series into DataFrames" data-type="indexterm" id="idm45607776763824"/><a data-primary="Series (pandas)" data-secondary="converting to DataFrames" data-startref="ix_SerDF" data-type="indexterm" id="idm45607776719088"/></p>
<p>With pandas’s core data structures under our belts, the next few chapters will show you how to use them to clean and process your dataset of Nobel Prize winners, extending your knowledge of the pandas toolkit and showing you how to go about applying it in a data visualization context.</p>
<p>Now that we know how to get data into and out of a DataFrame, it’s time to see what pandas can do with it. We’ll first see how to give your data a clean bill of health, discovering and fixing anomalies such as duplicate rows, missing fields, and corrupted data.<a data-primary="pandas" data-secondary="introduction to" data-startref="ix_pndsintr" data-type="indexterm" id="idm45607776717232"/></p>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm45607780439264"><sup><a href="ch08.xhtml#idm45607780439264-marker">1</a></sup> The columns in a typical spreadsheet will typically have different datatypes (dtypes), like floats, date-times, integers etc.</p><p data-type="footnote" id="idm45607779978240"><sup><a href="ch08.xhtml#idm45607779978240-marker">2</a></sup> Only if the column name is a string without spaces.</p><p data-type="footnote" id="idm45607779218800"><sup><a href="ch08.xhtml#idm45607779218800-marker">3</a></sup> If you have problems, you might try a subset of your data in <a href="https://jsonlint.com">JSONLint’s validator</a> for better feedback.</p><p data-type="footnote" id="idm45607779160128"><sup><a href="ch08.xhtml#idm45607779160128-marker">4</a></sup> D3 takes a number of other data formats, such as hierarchical (tree type) data or node and link graph formats. Here’s an example of <a href="https://oreil.ly/WsBCI">a tree hierarchy specified in JSON</a>.</p><p data-type="footnote" id="idm45607779004224"><sup><a href="ch08.xhtml#idm45607779004224-marker">5</a></sup> I recommend using this approach if you want to get a feel for the CSV or JSON parsers. It’s much more convenient than managing local files.</p></div></div></section></div></body></html>