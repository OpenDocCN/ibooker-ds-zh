<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 4. Webdev 101" data-type="chapter" epub:type="chapter"><div class="chapter" id="chapter_webdev101">
<h1><span class="label">Chapter 4. </span>Webdev 101</h1>
<p>This chapter introduces the core web-development knowledge you will need to understand the web pages you scrape for data and to structure those you want to deliver as the skeleton of your JavaScripted visualizations.<a data-primary="web development (webdev)" data-type="indexterm" id="ix_webdev"/> As you’ll see, a little knowledge goes a long way in modern webdev, particularly when your focus is building self-contained visualizations and not entire websites (see <a data-type="xref" href="#spas">“Single-Page Apps”</a> for more details).</p>
<p>The usual caveats apply: this chapter is part reference, part tutorial.  There will probably be stuff here you know already, so feel free to skip over it and get to the new material.</p>
<section data-pdf-bookmark="The Big Picture" data-type="sect1"><div class="sect1" id="idm45607793816512">
<h1>The Big Picture</h1>
<p>The humble web page, the basic building block of the World Wide Web <span class="keep-together">(WWW)—</span>that fraction of the internet consumed by humans—​is constructed from files of various types. Apart from the multimedia files (images, videos, sound, etc.), the key elements are textual, consisting of Hypertext Markup Language (HTML), Cascading Style Sheets (CSS), and JavaScript.  These three, along with any necessary data files, are delivered using the <a data-primary="HTTP" data-type="indexterm" id="idm45607793814496"/>Hypertext Transfer Protocol (HTTP) and used to build the page you see and interact with in your browser window, which is described by the Document Object Model (DOM), a hierarchical tree off which your content hangs.<a data-primary="DOM (Document Object Model)" data-type="indexterm" id="idm45607793813664"/> A basic understanding of how these elements interact is vital to building modern web visualizations, and the aim of this chapter is to get you quickly up to speed.</p>
<p>Web development is a big field, and the aim here is not to turn you into a full-fledged web developer. I assume you want to limit the amount of webdev you have to do as much as possible, focusing only on that fraction necessary to build a modern visualization. In order to build the sort of visualizations showcased at <a class="orm:hideurl" href="https://d3js.org"><em>d3js.org</em></a>, published in the <em>New York Times</em>, or incorporated in basic interactive data dashboards, you actually need surprisingly little webdev fu. The result of your labors should be easy to add to a larger website by someone dedicated to that job. In the case of small, personal websites, it’s easy enough to incorporate the visualization yourself.</p>
</div></section>
<section data-pdf-bookmark="Single-Page Apps" data-type="sect1"><div class="sect1" id="spas">
<h1>Single-Page Apps</h1>
<p><em>Single-page applications</em> (SPAs) are web <a data-primary="single-page applications (SPAs)" data-type="indexterm" id="idm45607793775056"/><a data-primary="web development (webdev)" data-secondary="single-page applications" data-type="indexterm" id="idm45607793774448"/>applications (or whole sites) that are dynamically assembled using JavaScript, often building upon a lightweight HTML backbone and CSS styles that can be applied dynamically using class and ID attributes. Many modern data visualizations fit this description, including the Nobel Prize visualization this book builds toward.<a data-primary="SPAs" data-see="single-page applications" data-type="indexterm" id="idm45607793773472"/></p>
<p>Often self-contained, the SPA’s root folder can be easily incorporated in an existing website or stand alone, requiring only an HTTP server such as Apache or NGINX.</p>
<p>Thinking of our data visualizations in terms of SPAs removes a lot of the cognitive overhead from the webdev aspect of JavaScript visualizations, allowing us to focus on programming challenges. The skills required to put the visualization on the web are still fairly basic and quickly amortized. Often it will be someone else’s job.</p>
</div></section>
<section data-pdf-bookmark="Tooling Up" data-type="sect1"><div class="sect1" id="idm45607793771600">
<h1>Tooling Up</h1>
<p>As you’ll see, the webdev needed to make modern data visualizations requires no more than a decent text editor, modern browser, and a terminal (<a data-type="xref" href="#webdev101_tools">Figure 4-1</a>). <a data-primary="web development (webdev)" data-secondary="tools" data-type="indexterm" id="ix_webdevtool"/>I’ll cover what I see as the minimal requirements for a webdev-ready editor and nonessential but nice-to-have features.</p>
<p>My browser development tools of choice are <a href="https://oreil.ly/52Z3e">Chrome’s web-developer kit</a>, freely available on all platforms. I<a data-primary="web browsers" data-secondary="development tools" data-type="indexterm" id="idm45607793766496"/><a data-primary="Chrome" data-secondary="web developer kit" data-type="indexterm" id="idm45607793765552"/>t has a lot of tab-delineated functionality, the following of which I’ll cover in this chapter:</p>
<ul>
<li>
<p>The <em>Elements</em> tab, which allows you to explore the structure of a web page, its HTML content, CSS styles, and DOM <span class="keep-together">presentation</span></p>
</li>
<li>
<p>The <em>Sources</em> tab, where most of your JavaScript debugging will take place</p>
</li>
</ul>
<p>You’ll need a terminal for output, starting your local web server, and maybe sketching ideas with the IPython interpreter. <a data-primary="terminal" data-type="indexterm" id="idm45607793759888"/>These days I tend to use browser-based <a href="https://jupyter.org">Jupyter notebooks</a> as my Python dataviz <em>sketchpad</em>—one of the key advantages being that the session persists in the form of a notebook (<em>.ipynb</em>) file, which you can use to restart the session at later dates. <a data-primary="Jupyter notebooks" data-secondary="use as Python dataviz sketchbook" data-type="indexterm" id="idm45607793757376"/><a data-primary="notebook (.ipynb) files" data-type="indexterm" id="idm45607793756336"/>You also get to iteratively explore your data with embedded charts. We’ll be putting this to good use in <a data-type="xref" href="part03.xhtml#part_clean_explore">Part III</a>.</p>
<figure><div class="figure" id="webdev101_tools">
<img alt="dpj2 0401" height="2100" src="assets/dpj2_0401.png" width="1217"/>
<h6><span class="label">Figure 4-1. </span>Primary webdev tools</h6>
</div></figure>
<p>Before dealing with what you do need, let’s deal with a few things you don’t need when setting out, laying a couple of myths to rest on the way.</p>
<section data-pdf-bookmark="The Myth of IDEs, Frameworks, and Tools" data-type="sect2"><div class="sect2" id="myth_ides">
<h2>The Myth of IDEs, Frameworks, and Tools</h2>
<p>There is a common assumption among the prospective JavaScripter that to program for the web requires a complex toolset, primarily an Intelligent Development Environment (IDE), as used by enterprise—​and other—​coders everywhere.<a data-primary="web development (webdev)" data-secondary="tools" data-tertiary="myth of IDEs, frameworks, and tools" data-type="indexterm" id="idm45607793750320"/><a data-primary="IDEs (Intelligent Development Environments)" data-type="indexterm" id="idm45607793748992"/> This is potentially expensive and presents another learning curve. The good news is that you can create professional-level web dataviz with nothing more than a decent text editor. In fact, until you start dealing with modern JavaScript frameworks (and I would hold off on that while you get your webdev legs) an IDE doesn’t provide much advantage, while usually being less performant.<a data-primary="Visual Studio Code (VSCode)" data-type="indexterm" id="idm45607793748224"/> More good news is that the free as in beer lightweight <a href="https://code.visualstudio.com">Visual Studio Code IDE (VSCode)</a> has become the de facto standard for web development. If you already use VSCode or want a few more bells and whistles, it’s a good workhorse for following this book.<a data-primary="Intelligent Development Environments" data-see="IDEs" data-type="indexterm" id="idm45607793746736"/></p>
<p>There is also a common myth that one cannot be productive in JavaScript without using a framework of some kind.<sup><a data-type="noteref" href="ch04.xhtml#idm45607793744992" id="idm45607793744992-marker">1</a></sup> <a data-primary="Flask" data-type="indexterm" id="idm45607793742816"/><a data-primary="JavaScript" data-secondary="frameworks" data-type="indexterm" id="idm45607793742080"/>At the moment, a number of these frameworks are vying for control of the JS ecosystem, most sponsored  by the various huge companies that created them. These frameworks come and go at a dizzying rate, and my advice for anyone starting out in JavaScript is to ignore them entirely while you develop your core skills. Use small, targeted libraries, such as those in the jQuery ecosystem or Underscore’s functional programming extensions, and see how far you can get before needing a <em>my way or the highway</em> framework. Only lock yourself into a framework to meet a clear and present need, not because the current JS groupthink is raving about how great it is.<sup><a data-type="noteref" href="ch04.xhtml#idm45607793740624" id="idm45607793740624-marker">2</a></sup>  Another important consideration is that D3, the prime web dataviz library, doesn’t really play well with any of the bigger frameworks I know, particularly the ones that want control over the DOM. Making D3 framework-compliant is an advanced skill.<a data-primary="D3 library" data-secondary="frameworks and" data-type="indexterm" id="idm45607793739936"/></p>
<p>Another thing you’ll find if you hang around webdev forums, Reddit lists, and Stack Overflow is a huge range of tools constantly clamoring for attention.<a data-primary="tools" data-secondary="myth of, in web development" data-type="indexterm" id="idm45607793738608"/> There are JS+CSS minifiers and watchers to automatically detect file changes and reload web pages during development, among others. While a few of these have their place, in my experience there are a lot of flaky tools that probably cost more time in hair-tearing than they gain in productivity. To reiterate, you can be very productive without these things and should only reach for one to scratch an urgent itch. Some are keepers, but very few are even remotely essential for data visualization work.</p>
</div></section>
<section data-pdf-bookmark="A Text-Editing Workhorse" data-type="sect2"><div class="sect2" id="idm45607793737280">
<h2>A Text-Editing Workhorse</h2>
<p>First and foremost among your webdev tools is a text editor that you are comfortable with and which can, at the very least, do syntax highlighting for multiple languages—​in our case, HTML, CSS, JavaScript, and Python. <a data-primary="web development (webdev)" data-secondary="tools" data-tertiary="text editor" data-type="indexterm" id="idm45607793735840"/><a data-primary="CSS" data-secondary="text editor for" data-type="indexterm" id="idm45607793734528"/><a data-primary="HTML" data-secondary="text editor for" data-type="indexterm" id="idm45607793733584"/><a data-primary="JavaScript" data-secondary="text editor for" data-type="indexterm" id="idm45607793732640"/><a data-primary="Python" data-secondary="text editor for" data-type="indexterm" id="idm45607793731696"/><a data-primary="text editors for web development" data-type="indexterm" id="idm45607793730752"/><a data-primary="syntax highlighting" data-type="indexterm" id="idm45607793730064"/>You can get away with a plain, nonhighlighting editor, but in the long run it will prove to be a pain. Things like syntax highlighting, code linting, intelligent indentation, and the like remove a huge cognitive load from the process of programming, so much so that I see their absence as a limiting factor. These are my minimal requirements for a text editor:</p>
<ul>
<li>
<p>Syntax highlighting for all languages you use</p>
</li>
<li>
<p>Configurable indentation <a data-primary="indentation levels (configurable) for different languages" data-type="indexterm" id="idm45607793727312"/><a data-primary="windows/panes/tabs, multiple, in text editors" data-type="indexterm" id="idm45607793726640"/><a data-primary="tabs (multiple) in text editors" data-type="indexterm" id="idm45607793725872"/><a data-primary="panes (multiple) in text editors" data-type="indexterm" id="idm45607793725136"/><a data-primary="code linters in text editors" data-type="indexterm" id="idm45607793724448"/><a data-primary="linters in text editors" data-type="indexterm" id="idm45607793723760"/>levels and types for languages (e.g., Python 4 soft tabs, JavaScript 2 soft tabs)</p>
</li>
<li>
<p>Multiple windows/panes/tabs to allow easy navigation around your codebase</p>
</li>
<li>
<p>A decent <a href="https://oreil.ly/6BOEU">code linter</a> (see <a data-type="xref" href="#webdev101_linter">Figure 4-2</a>)</p>
</li>
</ul>
<p>If you are using a relatively advanced text editor, all the above should come as standard with the exception of code linting, which may require a bit of configuration.</p>
<figure><div class="figure" id="webdev101_linter">
<img alt="dpj2 0402" height="400" src="assets/dpj2_0402.png" width="600"/>
<h6><span class="label">Figure 4-2. </span>A running code linter analyzes the JavaScript continuously, highlighting syntax errors in red and adding an ! to the left of the offending line</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="Browser with Development Tools" data-type="sect2"><div class="sect2" id="idm45607793716784">
<h2>Browser with Development Tools</h2>
<p>One of the reasons a full-fledged IDE is less vital in modern webdev is that the best place to do debugging is in the web browser itself, and such is the pace of change there that any IDE attempting to emulate that context will have its work cut out for it.<a data-primary="web development (webdev)" data-secondary="tools" data-tertiary="browser with development tools" data-type="indexterm" id="idm45607793715488"/><a data-primary="web browsers" data-secondary="development tools" data-type="indexterm" id="idm45607793714160"/><a data-primary="Chrome" data-secondary="development tools" data-type="indexterm" id="idm45607793713216"/> On top of this, modern web browsers have evolved a powerful set of debugging and development tools. The best among these is <a href="https://oreil.ly/jBLc9">Chrome DevTools</a>, which offers a huge amount of functionality, from sophisticated (certainly to a Pythonista) debugging (parametric breakpoints, variable watches, etc.) to memory and processor optimization profiling, device emulation (want to know what your web page looks like on a smartphone or tablet?), and a whole lot more. Chrome DevTools is my debugger of choice and will be used in this book. Like everything covered, it’s free to use.</p>
</div></section>
<section data-pdf-bookmark="Terminal or Command Prompt" data-type="sect2"><div class="sect2" id="idm45607793711232">
<h2>Terminal or Command Prompt</h2>
<p>The terminal or command line is where you initiate the various servers and probably output useful logging information.<a data-primary="web development (webdev)" data-secondary="tools" data-tertiary="terminal or command prompt" data-type="indexterm" id="idm45607793709840"/><a data-primary="terminal" data-type="indexterm" id="idm45607793708576"/><a data-primary="command prompt" data-type="indexterm" id="idm45607793707904"/> It’s also where you’ll try out Python modules or run a Python interpreter (IPython being in many ways the best).<a data-primary="interpreters" data-secondary="running on terminal or command prompt" data-type="indexterm" id="idm45607793706976"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Building a Web Page" data-type="sect1"><div class="sect1" id="HTTP_delivery">
<h1>Building a Web Page</h1>
<p>There are four elements to a <a data-primary="web development (webdev)" data-secondary="tools" data-startref="ix_webdevtool" data-type="indexterm" id="idm45607793703728"/><a data-primary="web development (webdev)" data-secondary="building a web page" data-type="indexterm" id="ix_webdevbldpage"/><a data-primary="web pages" data-secondary="building" data-see="web development" data-type="indexterm" id="idm45607793701184"/>typical web visualization:</p>
<ul>
<li>
<p>An HTML skeleton, with placeholders for our programmatic visualization</p>
</li>
<li>
<p>Cascading Style Sheets (CSS), which define the look and feel (e.g., border widths, colors, font sizes, placement of content blocks)</p>
</li>
<li>
<p>JavaScript to build the visualization</p>
</li>
<li>
<p>Data to be transformed</p>
</li>
</ul>
<p>The first three of these are just text files, created using our favorite editor and delivered to the browser by the web server (see <a data-type="xref" href="ch12.xhtml#chapter_delivery_intro">Chapter 12</a>). Let’s examine each in turn.</p>
<section data-pdf-bookmark="Serving Pages with HTTP" data-type="sect2"><div class="sect2" id="idm45607793694464">
<h2>Serving Pages with HTTP</h2>
<p>The delivery of the HTML, CSS, and JS files that are used to make a particular web page (and any related data files, multimedia, etc.) is negotiated between a server and browser using the Hypertext Transfer Protocol.<a data-primary="HTTP" data-secondary="serving web pages with" data-type="indexterm" id="idm45607793692992"/><a data-primary="web development (webdev)" data-secondary="building a web page" data-tertiary="serving pages with HTTP" data-type="indexterm" id="idm45607793692016"/> HTTP provides a number of methods, the most commonly used being GET, which requests a web resource, retrieving data from the server if all goes well or throwing an error if it doesn’t. We’ll be using GET, along with Python’s requests module, to scrape some web page content in <a data-type="xref" href="ch06.xhtml#chapter_heavy_scraping">Chapter 6</a>.</p>
<p>To negotiate the browser-generated HTTP requests, you’ll need a server. In development, you can run a little server locally using Python’s built-in web server (one of the batteries included), part of the <code>http</code> module. <a data-primary="http module (Python)" data-secondary="built-in web server, running locally" data-type="indexterm" id="idm45607793688976"/>You start the server at the command line, with an optional port number (default 8000), like this:</p>
<pre data-type="programlisting">$ python -m http.server 8080
Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...</pre>
<p>This server is now serving content locally on port 8080. You can access the site it is serving by going to the URL <em>http://localhost:8080</em> in your browser.</p>
<p>The <code>http.server</code> module is a nice thing to have and OK for demos and the like, but it lacks a lot of basic functionality. For this reason, as we’ll see in <a data-type="xref" href="part04.xhtml#part_delivery">Part IV</a>, it’s better to master the use of a proper development (and production) server like Flask (this book’s server of choice).</p>
</div></section>
<section data-pdf-bookmark="The DOM" data-type="sect2"><div class="sect2" id="idm45607793684128">
<h2>The DOM</h2>
<p>The HTML files you send through HTTP are converted at the browser end into a Document Object Model, or DOM, which can in turn be adapted by JavaScript because this programmatic DOM is the basis of dataviz libraries like D3.<a data-primary="HTML" data-secondary="conversion into DOM" data-type="indexterm" id="idm45607793682864"/> The DOM is a tree structure, represented by hierarchical nodes, the top node being the main web page or document.</p>
<p>Essentially, the HTML you write or generate with a template is converted by the browser into a tree hierarchy of nodes, each one representing an HTML element. The top node is called the <em>Document Object</em>, and all other nodes descend in a parent-child fashion. <a data-primary="jQuery" data-secondary="programmatic manipulation of the DOM" data-type="indexterm" id="idm45607793680832"/><a data-primary="D3 library" data-secondary="programmatic manipulation of the DOM" data-type="indexterm" id="idm45607793679840"/>Programmatically manipulating the DOM is at the heart of such libraries as jQuery and the mighty D3, so it’s vital to have a good mental model of what’s going on. A great way to get the feel for the DOM is to use a web tool such as <em>Chrome DevTools</em> (my recommended toolset) to inspect branches of the tree.</p>
<p>Whatever you see rendered on the web page, the bookkeeping of the object’s state (displayed or hidden, matrix transform, etc.) is being done with the DOM. D3’s powerful innovation was to attach data directly to the DOM and use it to drive visual changes (Data-Driven Documents).</p>
</div></section>
<section data-pdf-bookmark="The HTML Skeleton" data-type="sect2"><div class="sect2" id="idm45607793677696">
<h2>The HTML Skeleton</h2>
<p>A typical web visualization uses an HTML skeleton, and builds the visualization on top of it using JavaScript.<a data-primary="web development (webdev)" data-secondary="building a web page" data-tertiary="HTML skeleton" data-type="indexterm" id="idm45607793675904"/><a data-primary="HTML" data-secondary="skeleton for web visualizations" data-type="indexterm" id="idm45607793674640"/></p>
<p>HTML is the language used to describe the content of a web page. It was first proposed by physicist Tim Berners-Lee in 1980 while he was working at the CERN particle accelerator complex in Switzerland.<a data-primary="CSS" data-type="indexterm" id="idm45607793673072"/> It uses tags such as <code>&lt;div&gt;</code>, <code>&lt;img&gt;</code>, and <code>&lt;h&gt;</code> to structure the content of the page, while CSS is used to define the look and feel.<sup><a data-type="noteref" href="ch04.xhtml#idm45607793670928" id="idm45607793670928-marker">3</a></sup> The advent of HTML5 has reduced the boilerplate considerably, but the essence has remained essentially unchanged over those thirty years.</p>
<p>Fully specced HTML used to involve a lot of rather confusing header tags, but with HTML5 some thought was put into a more user-friendly minimalism.<a data-primary="HTML" data-secondary="starting template, minimal" data-type="indexterm" id="idm45607793669456"/> This is pretty much the minimal requirement for a starting template:<sup><a data-type="noteref" href="ch04.xhtml#idm45607793668384" id="idm45607793668384-marker">4</a></sup></p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="cm">&lt;!-- page content --&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code></pre>
<p>So we need only declare the document HTML, our character set 8-bit Unicode, and a <code>&lt;body&gt;</code> tag below which to add our page content. This is a big improvement on the bookkeeping required before and provides a very low threshold to entry as far as creating the documents that will be turned into web pages goes. <a data-primary="comments" data-secondary="comment tag form in HTML web page" data-type="indexterm" id="idm45607793659648"/>Note the comment tag form: <code>&lt;!-- comment --&gt;</code>.</p>
<p>More realistically, we would probably want to add some CSS and JavaScript.<a data-primary="JavaScript" data-secondary="adding to HTML document" data-type="indexterm" id="idm45607793652288"/><a data-primary="CSS" data-secondary="adding to HTML document" data-type="indexterm" id="idm45607793651312"/> You can add both directly to an HTML document by using the <code>&lt;style&gt;</code> and <code>&lt;script&gt;</code> tags like this:</p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>
<code class="c">/* CSS */</code>
<code class="nt">&lt;/style&gt;</code>
<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="cm">&lt;!-- page content --&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code><code class="p">&gt;</code><code class="w"/>
<code class="w">    </code><code class="c1">// JavaScript...</code><code class="w"/>
<code class="w">    </code><code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code></pre>
<p>This single-page HTML form is often used in examples such as the visualizations at <a class="orm:hideurl" href="https://d3js.org"><em>d3js.org</em></a>. <a data-primary="HTML" data-secondary="single-page HTML form" data-type="indexterm" id="idm45607793541216"/>It’s convenient to have a single page to deal with when demonstrating code or keeping track of files, but generally I’d suggest separating the HTML, CSS, and JavaScript elements into separate files. The big win here, apart from easier navigation as the codebase gets larger, is that you can take full advantage of your editor’s specific language enhancements such as solid syntax highlighting and code linting (essentially syntax checking on the fly). While some editors and libraries claim to deal with embedded CSS and JavaScript, I haven’t found an adequate one.</p>
<p class="pagebreak-before">To use CSS and JavaScript files, we just include them in the HTML using <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> tags like this:</p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"style.css"</code> <code class="p">/&gt;</code>
<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
    <code class="cm">&lt;!-- page content --&gt;</code>
    <code class="p">&lt;</code><code class="nt">script</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/javascript"</code> <code class="na">src</code><code class="o">=</code><code class="s">"script.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code></pre>
</div></section>
<section data-pdf-bookmark="Marking Up Content" data-type="sect2"><div class="sect2" id="idm45607793677072">
<h2>Marking Up Content</h2>
<p>Visualizations often use a small subset of the available HTML tags, usually building the page programmatically by attaching elements to the DOM tree.<a data-primary="HTML" data-secondary="markup of web page content" data-type="indexterm" id="ix_HTMLmrkup"/><a data-primary="marking up web page content" data-type="indexterm" id="ix_mrkupWP"/><a data-primary="web development (webdev)" data-secondary="building a web page" data-tertiary="marking up content" data-type="indexterm" id="ix_webdevbldpagemkup"/></p>
<p>The most common tag is the <code>&lt;div&gt;</code>, marking a block of content. <code>&lt;div&gt;</code>s can contain other <code>&lt;div&gt;</code>s, allowing for a tree hierarchy, the branches of which are used during element selection and to propagate user interface (UI) events such as mouse clicks. Here’s a simple <code>&lt;div&gt;</code> hierarchy:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"my-chart-wrapper"</code> <code class="na">class</code><code class="o">=</code><code class="s">"chart-holder dev"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"my-chart"</code> <code class="na">class</code><code class="o">=</code><code class="s">"bar chart"</code><code class="p">&gt;</code>
         this is a placeholder, with parent #my-chart-wrapper
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre>
<p>Note the use of <code>id</code> and <code>class</code> attributes. These are used when you’re selecting DOM elements and to apply CSS styles. IDs are unique identifiers; each element should have only one and there should be only one occurrence of any particular ID per page. The class can be applied to multiple elements, allowing bulk selection, and each element can have multiple classes.</p>
<p>For textual content, the main tags are <code>&lt;p&gt;</code>, <code>&lt;h*&gt;</code>, and <code>&lt;br&gt;</code>. You’ll be using these a lot. This code produces <a data-type="xref" href="#webdev101_h2">Figure 4-3</a>:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>A Level-2 Header<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>A paragraph of body text with a line break here..<code class="p">&lt;/</code><code class="nt">br</code><code class="p">&gt;</code>
and a second paragraph...<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code></pre>
<figure><div class="figure" id="webdev101_h2">
<img alt="dpj2 0403" height="115" src="assets/dpj2_0403.png" width="345"/>
<h6><span class="label">Figure 4-3. </span>An h2 header and text</h6>
</div></figure>
<p>Header tags are reverse-ordered by size from the largest <code>&lt;h1&gt;</code>.</p>
<p><code>&lt;div&gt;</code>, <code>&lt;h*&gt;</code>, and <code>&lt;p&gt;</code> are what is known as <em>block elements</em>. <a data-primary="block elements" data-type="indexterm" id="idm45607793332320"/><a data-primary="inline elements" data-type="indexterm" id="idm45607793331584"/>They normally begin and end with a new line. The other class of tag is <em>inline elements</em>, which display without line breaks. Images <code>&lt;img&gt;</code>, hyperlinks <code>&lt;a&gt;</code>, and table cells <code>&lt;td&gt;</code> are among these, which include the <code>&lt;span&gt;</code> tag for inline text:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">div</code><code> </code><code class="na">id</code><code class="o">=</code><code class="s">"inline-examples"</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">img</code><code> </code><code class="na">src</code><code class="o">=</code><code class="s">"path/to/image.png"</code><code> </code><code class="na">id</code><code class="o">=</code><code class="s">"prettypic"</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_webdev_101_CO1-1" id="co_webdev_101_CO1-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code><code>This is a </code><code class="p">&lt;</code><code class="nt">a</code><code> </code><code class="na">href</code><code class="o">=</code><code class="s">"link-url"</code><code class="p">&gt;</code><code>link</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">a</code><code class="p">&gt;</code><code> to
        </code><code class="p">&lt;</code><code class="nt">span</code><code> </code><code class="na">class</code><code class="o">=</code><code class="s">"url"</code><code class="p">&gt;</code><code>link-url</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">span</code><code class="p">&gt;</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">p</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_webdev_101_CO1-2" id="co_webdev_101_CO1-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">div</code><code class="p">&gt;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_webdev_101_CO1-1" id="callout_webdev_101_CO1-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Note that we don’t need a closing tag for images.</p></dd>
<dt><a class="co" href="#co_webdev_101_CO1-2" id="callout_webdev_101_CO1-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>The span and link are continuous in the text.</p></dd>
</dl>
<p>Other useful tags include lists, ordered <code>&lt;ol&gt;</code> and unordered <code>&lt;ul&gt;</code>:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">div</code><code> </code><code class="na">style</code><code class="o">=</code><code class="s">"display: flex; gap: 50px"</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_webdev_101_CO2-1" id="co_webdev_101_CO2-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
  </code><code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">h3</code><code class="p">&gt;</code><code>Ordered (ol) list</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">h3</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">ol</code><code class="p">&gt;</code><code>
      </code><code class="p">&lt;</code><code class="nt">li</code><code class="p">&gt;</code><code>First Item</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">li</code><code class="p">&gt;</code><code>
      </code><code class="p">&lt;</code><code class="nt">li</code><code class="p">&gt;</code><code>Second Item</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">li</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">ol</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">div</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">h3</code><code class="p">&gt;</code><code>Unordered (ul) list</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">h3</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">ul</code><code class="p">&gt;</code><code>
      </code><code class="p">&lt;</code><code class="nt">li</code><code class="p">&gt;</code><code>First Item</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">li</code><code class="p">&gt;</code><code>
      </code><code class="p">&lt;</code><code class="nt">li</code><code class="p">&gt;</code><code>Second Item</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">li</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">ul</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">div</code><code class="p">&gt;</code><code>
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">div</code><code class="p">&gt;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_webdev_101_CO2-1" id="callout_webdev_101_CO2-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Here we apply a CSS style directly (inline) on the <code>div</code> tag. <a data-primary="CSS" data-secondary="applying CSS style inline on div tag" data-type="indexterm" id="idm45607793140800"/>See <a data-type="xref" href="#sect_flexboxes">“Positioning and Sizing Containers with Flex”</a> for an introduction to the <code>flex</code> display property.</p></dd>
</dl>
<p><a data-type="xref" href="#webdev101_lists">Figure 4-4</a> shows the rendered lists.</p>
<figure><div class="figure" id="webdev101_lists">
<img alt="dpj2 0404" height="156" src="assets/dpj2_0404.png" width="680"/>
<h6><span class="label">Figure 4-4. </span>HTML lists</h6>
</div></figure>
<p>HTML also has a dedicated <code>&lt;table&gt;</code> tag, useful if you want to present raw data in your visualization. <a data-primary="table tag (HTML)" data-type="indexterm" id="idm45607793134432"/>This HTML produces the header and row in <a data-type="xref" href="#webdev101_table">Figure 4-5</a>:</p>
<pre data-code-language="html" data-type="programlisting"><code> </code><code class="p">&lt;</code><code class="nt">table</code><code> </code><code class="na">id</code><code class="o">=</code><code class="s">"chart-data"</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="nt">tr</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_webdev_101_CO3-1" id="co_webdev_101_CO3-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="p">&lt;</code><code class="nt">th</code><code class="p">&gt;</code><code>Name</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">th</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">th</code><code class="p">&gt;</code><code>Category</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">th</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">th</code><code class="p">&gt;</code><code>Country</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">th</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">tr</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="nt">tr</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_webdev_101_CO3-2" id="co_webdev_101_CO3-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
    </code><code class="p">&lt;</code><code class="nt">td</code><code class="p">&gt;</code><code>Albert Einstein</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">td</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">td</code><code class="p">&gt;</code><code>Physics</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">td</code><code class="p">&gt;</code><code>
    </code><code class="p">&lt;</code><code class="nt">td</code><code class="p">&gt;</code><code>Switzerland</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">td</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">tr</code><code class="p">&gt;</code><code>
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">table</code><code class="p">&gt;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_webdev_101_CO3-1" id="callout_webdev_101_CO3-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>The header row</p></dd>
<dt><a class="co" href="#co_webdev_101_CO3-2" id="callout_webdev_101_CO3-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>The first row of data</p></dd>
</dl>
<figure><div class="figure" id="webdev101_table">
<img alt="dpj2 0405" height="65" src="assets/dpj2_0405.png" width="262"/>
<h6><span class="label">Figure 4-5. </span>An HTML table</h6>
</div></figure>
<p>When you are making web visualizations, the most often used of the previous tags are the textual tags, which provide instructions, information boxes, and so on. But the meat of our JavaScript efforts will probably be devoted to building DOM branches rooted on the Scalable Vector Graphics (SVG) <code>&lt;svg&gt;</code> and <code>&lt;canvas&gt;</code> tags. <a data-primary="canvas element" data-secondary="WebGL context" data-type="indexterm" id="idm45607793016624"/><a data-primary="WebGL context" data-type="indexterm" id="idm45607793015616"/><a data-primary="OpenGL visualizations" data-type="indexterm" id="idm45607793014944"/>On most modern browsers, the <code>&lt;canvas&gt;</code> tag also supports a 3D <em>WebGL</em> context, allowing <em>OpenGL</em> visualizations to be embedded in the page.<sup><a data-type="noteref" href="ch04.xhtml#idm45607792973152" id="idm45607792973152-marker">5</a></sup></p>
<p>We’ll deal with SVG, the focus of this book and the format used by the mighty D3 library, in <a data-type="xref" href="#sect_svg">“Scalable Vector Graphics”</a>. Now let’s look at how we add style to our content blocks.</p>
</div></section>
<section data-pdf-bookmark="CSS" data-type="sect2"><div class="sect2" id="idm45607793456720">
<h2>CSS</h2>
<p><em>CSS</em>, short for Cascading Style Sheets, is a language for describing the look and feel of a web page.<a data-primary="HTML" data-secondary="markup of web page content" data-startref="ix_HTMLmrkup" data-type="indexterm" id="idm45607792968384"/><a data-primary="marking up web page content" data-startref="ix_mrkupWP" data-type="indexterm" id="idm45607792967168"/><a data-primary="web development (webdev)" data-secondary="building a web page" data-startref="ix_webdevbldpagemkup" data-tertiary="marking up content" data-type="indexterm" id="idm45607792966256"/><a data-primary="CSS" data-type="indexterm" id="ix_CSS"/><a data-primary="web development (webdev)" data-secondary="building a web page" data-tertiary="CSS" data-type="indexterm" id="ix_webdevbldpageCSS"/> Though you can hardcode style attributes into your HTML, it’s generally considered bad practice.<sup><a data-type="noteref" href="ch04.xhtml#idm45607792962112" id="idm45607792962112-marker">6</a></sup> It’s much better to label your tag with an <code>id</code> or <code>class</code> and use that to apply styles in the stylesheet.</p>
<p>The key word in CSS is <em>cascading</em>. CSS follows a precedence rule so that in the case of a clash, the latest style overrides earlier ones. This means the order of inclusion for sheets is important. Usually, you want your stylesheet to be loaded last so that you can override both the browser defaults and styles defined by any libraries you are using.<a data-primary="Cascading Style Sheets" data-see="CSS" data-type="indexterm" id="idm45607792959824"/></p>
<p><a data-type="xref" href="#css">Figure 4-6</a> shows how CSS is used to apply styles to the HTML elements. <a data-primary="CSS" data-secondary="applying styles to HTML elements" data-type="indexterm" id="idm45607792957536"/>First, you select the element using hashes (#) to indicate a unique ID and dots (.) to select members of a class. You then define one or more property/value pairs. Note that the <code>font-family</code> property can be a list of fallbacks, in order of preference. Here we want the browser default <code>font-family</code> of <code>serif</code> (capped strokes) to be replaced with the more modern <code>sans-serif</code>, with <code>Helvetica Neue</code> as our first choice.</p>
<figure><div class="figure" id="css">
<img alt="dpj2 0406" height="892" src="assets/dpj2_0406.png" width="1394"/>
<h6><span class="label">Figure 4-6. </span>Styling the page with CSS</h6>
</div></figure>
<p>Understanding CSS precedence rules is key to successfully applying styles.<a data-primary="CSS" data-secondary="precedence rules for applying styles" data-type="indexterm" id="idm45607792951920"/> In a nutshell, the order is:</p>
<ol>
<li>
<p><code>!important</code> after CSS property trumps all.</p>
</li>
<li>
<p>The more specific the better (i.e., IDs override classes).</p>
</li>
<li>
<p>The order of declaration: last declaration wins, subject to <em>1</em> and <em>2</em>.</p>
</li>
</ol>
<p>So, for example, say we have a <code>&lt;span&gt;</code> of class <code>alert</code>:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">span</code> <code class="na">class</code><code class="o">=</code><code class="s">"alert"</code> <code class="na">id</code><code class="o">=</code><code class="s">"special-alert"</code><code class="p">&gt;</code>
something to be alerted to<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;</code></pre>
<p>Putting the following in our <em>style.css</em> file will make the alert text red and bold:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.alert</code> <code class="p">{</code> <code class="k">font-weight</code><code class="o">:</code><code class="nb">bold</code><code class="p">;</code> <code class="k">color</code><code class="o">:</code><code class="nb">red</code> <code class="p">}</code></pre>
<p>If we then add this to the <em>style.css</em>, the ID color black will override the class color red, while the class <code>font-weight</code> remains bold:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#special-alert</code> <code class="p">{</code><code class="k">background</code><code class="o">:</code> <code class="nb">yellow</code><code class="p">;</code> <code class="k">color</code><code class="o">:</code><code class="nb">black</code><code class="p">}</code></pre>
<p>To enforce the color red for alerts, we can use the <code>!important</code> directive:<sup><a data-type="noteref" href="ch04.xhtml#idm45607792857568" id="idm45607792857568-marker">7</a></sup></p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.alert</code> <code class="p">{</code> <code class="k">font-weight</code><code class="o">:</code><code class="nb">bold</code><code class="p">;</code> <code class="k">color</code><code class="o">:</code><code class="nb">red</code> <code class="cp">!important</code> <code class="p">}</code></pre>
<p>If we then add another stylesheet, <em>style2.css</em>, after <em>style.css</em>:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"style.css"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/css"</code> <code class="p">/&gt;</code>
<code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"style2.css"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/css"</code> <code class="p">/&gt;</code></pre>
<p>with <em>style2.css</em> containing the following:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.alert</code> <code class="p">{</code> <code class="k">font-weight</code><code class="o">:</code><code class="n">normal</code> <code class="p">}</code></pre>
<p>then the <code>font-weight</code> of the alert will be reverted to <code>normal</code> because the new class style was declared last.<a data-primary="web development (webdev)" data-secondary="building a web page" data-startref="ix_webdevbldpageCSS" data-tertiary="CSS" data-type="indexterm" id="idm45607792782000"/><a data-primary="CSS" data-startref="ix_CSS" data-type="indexterm" id="idm45607792780576"/></p>
</div></section>
<section data-pdf-bookmark="JavaScript" data-type="sect2"><div class="sect2" id="idm45607792779376">
<h2>JavaScript</h2>
<p>JavaScript is the only browser-based programming language, with an interpreter included in all modern browsers. <a data-primary="JavaScript" data-type="indexterm" id="idm45607792775680"/><a data-primary="web development (webdev)" data-secondary="building a web page" data-tertiary="JavaScript" data-type="indexterm" id="idm45607792774976"/>In order to do anything remotely advanced (and that includes all modern web visualizations), you should have a JavaScript grounding. <a href="https://www.typescriptlang.org">TypeScript</a> is a superset of JavaScript that provides strong typing and is currently gaining a lot of traction. TypeScript compiles to and presupposes competence in JavaScript.</p>
<p>99% of all coded web visualization examples, the ones you should aim to be learning from, are in JavaScript, and voguish alternatives have a way of fading with time. In essence, good competence in (if not mastery of) JavaScript is a prerequisite for interesting web visualizations.</p>
<p>The good news for Pythonistas is that JavaScript is actually quite a nice language once you’ve tamed a few of its more awkward quirks.<sup><a data-type="noteref" href="ch04.xhtml#idm45607792772048" id="idm45607792772048-marker">8</a></sup> As I showed in <a data-type="xref" href="ch02.xhtml#chapter_language_bridge">Chapter 2</a>, JavaScript and Python have a lot in common and it’s usually easy to translate from one to the other.</p>
</div></section>
<section data-pdf-bookmark="Data" data-type="sect2"><div class="sect2" id="sect_data">
<h2>Data</h2>
<p>The data needed to fuel your web visualization will be provided by the web server as static files (e.g., JSON or CSV files) or dynamically through some kind of web API (e.g., <a href="https://oreil.ly/RwvhM">RESTful APIs</a>), usually retrieving the data server-side from a database. <a data-primary="web development (webdev)" data-secondary="building a web page" data-tertiary="data" data-type="indexterm" id="idm45607792721040"/><a data-primary="data" data-secondary="for web pages" data-secondary-sortas="web" data-type="indexterm" id="idm45607792719952"/>We’ll be covering all these forms in <a data-type="xref" href="part04.xhtml#part_delivery">Part IV</a>.</p>
<p>Although a lot of data used to be delivered in <a href="https://oreil.ly/2IvEi">XML form</a>, modern web visualization is predominantly about JSON and, to a lesser extent, CSV or TSV files.<a data-primary="JSON" data-secondary="data format for web visualizations" data-type="indexterm" id="idm45607792716656"/></p>
<p><a href="https://oreil.ly/kCBDk">JSON</a> (short for JavaScript Object Notation) is the de facto web visualization data standard and I recommend you learn to love it. <a data-primary="JavaScript Object Notation" data-see="JSON" data-type="indexterm" id="idm45607792714720"/>It obviously plays very nicely with JavaScript, but its structure will also be familiar to Pythonistas. As we saw in <a data-type="xref" href="ch03.xhtml#read_write_json">“JSON”</a>, reading and writing JSON data with Python is a snap. Here’s a little example of some JSON data:</p>
<pre data-code-language="js" data-type="programlisting"><code class="p">{</code>
  <code class="s2">"firstName"</code><code class="o">:</code> <code class="s2">"Groucho"</code><code class="p">,</code>
  <code class="s2">"lastName"</code><code class="o">:</code> <code class="s2">"Marx"</code><code class="p">,</code>
  <code class="s2">"siblings"</code><code class="o">:</code> <code class="p">[</code><code class="s2">"Harpo"</code><code class="p">,</code> <code class="s2">"Chico"</code><code class="p">,</code> <code class="s2">"Gummo"</code><code class="p">,</code> <code class="s2">"Zeppo"</code><code class="p">],</code>
  <code class="s2">"nationality"</code><code class="o">:</code> <code class="s2">"American"</code><code class="p">,</code>
  <code class="s2">"yearOfBirth"</code><code class="o">:</code> <code class="mi">1890</code>
<code class="p">}</code></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="Chrome DevTools" data-type="sect1"><div class="sect1" id="chrome_tab">
<h1>Chrome DevTools</h1>
<p>The arms race in JavaScript engines in recent years, which has produced huge increases in performance, has been matched by an increasingly sophisticated range of development tools built into the various browsers.<a data-primary="web development (webdev)" data-secondary="building a web page" data-startref="ix_webdevbldpage" data-type="indexterm" id="idm45607792649600"/> Firefox’s Firebug led the pack for a while but  <a href="https://oreil.ly/djHBp">Chrome DevTools</a> have surpassed it, and are adding functionality all the time. <a data-primary="Chrome DevTools" data-type="indexterm" id="ix_ChrmDT"/><a data-primary="web development (webdev)" data-secondary="Chrome DevTools" data-type="indexterm" id="ix_webdevChrDT"/>There’s now a huge amount you can do with Chrome’s tabbed tools, but here I’ll introduce the two most useful tabs, the HTML+CSS-focused <em>Elements</em> and the JavaScript-focused <em>Sources</em>. Both of these work in complement to Chrome’s developer console, demonstrated in <a data-type="xref" href="ch02.xhtml#bridge_js_interact">“JavaScript”</a>.</p>
<section data-pdf-bookmark="The Elements Tab" data-type="sect2"><div class="sect2" id="chrome_elements">
<h2>The Elements Tab</h2>
<p>To access <a data-primary="Elements tag (Chrome DevTools)" data-type="indexterm" id="idm45607792677456"/><a data-primary="Chrome DevTools" data-secondary="Elements tab" data-type="indexterm" id="idm45607792676752"/><a data-primary="HTML" data-secondary="Chrome DevTools Elements tab" data-type="indexterm" id="idm45607792675808"/>the Elements tab, select More Tools→Developer Tools from the righthand options menu or use the Ctrl-Shift-I keyboard shortcut (Cmd-Option-I in Mac).</p>
<p><a data-type="xref" href="#webdev101_elements">Figure 4-7</a> shows the Elements tab at work. <a data-primary="DOM (Document Object Model)" data-secondary="Chrome DevTools Elements tab" data-type="indexterm" id="idm45607792673520"/>You can select DOM elements on the page by using the lefthand magnifying glass and see their HTML branch in the left panel. <a data-primary="CSS" data-secondary="Chrome DevTools Elements tab" data-type="indexterm" id="idm45607792672512"/>The right panel allows you to see CSS styles applied to the element and look at any event listeners that are attached or DOM properties.</p>
<figure><div class="figure" id="webdev101_elements">
<img alt="dpj2 0407" height="487" src="assets/dpj2_0407.png" width="656"/>
<h6><span class="label">Figure 4-7. </span>Chrome DevTools Elements tab</h6>
</div></figure>
<p>One really cool feature of the Elements tab is that you can interactively change element styling for both CSS styles and attributes.<sup><a data-type="noteref" href="ch04.xhtml#idm45607792668960" id="idm45607792668960-marker">9</a></sup> This is a great way to refine the look and feel of your data visualizations.</p>
<p>Chrome’s Elements tab provides a great way to explore the structure of a page, finding out how the different elements are positioned. This is  good way to get your head around positioning content blocks with the <code>position</code> and <code>float</code> properties. Seeing how the pros apply CSS styles is a really good way to up your game and learn some useful tricks.</p>
</div></section>
<section data-pdf-bookmark="The Sources Tab" data-type="sect2"><div class="sect2" id="idm45607792635520">
<h2>The Sources Tab</h2>
<p>The Sources tab allows you to see any JavaScript included in the page. <a data-type="xref" href="#webdev101_sources">Figure 4-8</a> shows the tab at work. <a data-primary="JavaScript" data-secondary="Sources tab of Chrome DevTools" data-type="indexterm" id="idm45607792633760"/><a data-primary="Sources tab (Chrome DevTools)" data-type="indexterm" id="idm45607792632912"/><a data-primary="Chrome DevTools" data-secondary="Sources tab" data-type="indexterm" id="idm45607792632304"/>In the lefthand panel, you can select a script or an HTML file with embedded <code>&lt;script&gt;</code> tagged JavaScript. As shown, you can place a breakpoint in the code, load the page, and, on break, see the call stack and any scoped or global variables. These breakpoints are parametric, so you can set conditions for them to trigger, which is handy if you want to catch and step through a particular configuration. On break, you have the standard to step in, out, and over functions, and so on.</p>
<figure><div class="figure" id="webdev101_sources">
<img alt="dpj2 0408" height="478" src="assets/dpj2_0408.png" width="653"/>
<h6><span class="label">Figure 4-8. </span>Chrome DevTools Sources tab</h6>
</div></figure>
<p>The Sources tab is a fantastic resource and greatly reduces the need for console logging<sup><a data-type="noteref" href="ch04.xhtml#idm45607792628480" id="idm45607792628480-marker">10</a></sup> when trying to debug JavaScript. In fact, where JS debugging was once a major pain point, it is now almost a pleasure.</p>
</div></section>
<section data-pdf-bookmark="Other Tools" data-type="sect2"><div class="sect2" id="idm45607792627280">
<h2>Other Tools</h2>
<p>There’s a huge amount of functionality in those Chrome DevTools tabs, and they are being updated almost daily. <a data-primary="Chrome DevTools" data-secondary="other tools" data-type="indexterm" id="idm45607792625856"/>You can do memory and CPU timelines and profiling, monitor your network downloads, and test out your pages for different form factors. But you’ll spend the large majority of your time as a data visualizer in the Elements and Sources tabs.<a data-primary="web development (webdev)" data-secondary="Chrome DevTools" data-startref="ix_webdevChrDT" data-type="indexterm" id="idm45607792624752"/><a data-primary="Chrome DevTools" data-startref="ix_ChrmDT" data-type="indexterm" id="idm45607792623472"/></p>
</div></section>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="A Basic Page with Placeholders" data-type="sect1"><div class="sect1" id="webdev101_basic_page">
<h1>A Basic Page with Placeholders</h1>
<p>Now that we have covered the major elements of a web page, let’s put them together.<a data-primary="web development (webdev)" data-secondary="web page (basic) with placeholders" data-type="indexterm" id="ix_webdevwpgbsc"/> Most web visualizations start off as HTML and CSS skeletons, with placeholder elements ready to be fleshed out with a little JavaScript plus data (see <a data-type="xref" href="#spas">“Single-Page Apps”</a>).</p>
<p>We’ll first need our HTML skeleton, using the code in <a data-type="xref" href="#skel_html">Example 4-1</a>. <a data-primary="HTML" data-secondary="skeleton for basic web page" data-type="indexterm" id="idm45607792616624"/>This consists of a tree of <code>&lt;div&gt;</code> content blocks defining three chart elements: a header, main, and sidebar section. We’ll save this file as <em>index.xhtml</em>.</p>
<div data-type="example" id="skel_html">
<h5><span class="label">Example 4-1. </span>The file index.xhtml, our HTML skeleton</h5>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>

<code class="p">&lt;</code><code class="nt">link</code> <code class="na">rel</code><code class="o">=</code><code class="s">"stylesheet"</code> <code class="na">href</code><code class="o">=</code><code class="s">"style.css"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text/css"</code> <code class="p">/&gt;</code>

<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>

  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart-holder"</code> <code class="na">class</code><code class="o">=</code><code class="s">"dev"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"header"</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>A Catchy Title Coming Soon...<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Some body text describing what this visualization is all
      about and why you should care.<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart-components"</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"main"</code><code class="p">&gt;</code>
        A placeholder for the main chart.
      <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"sidebar"</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Some useful information about the chart,
          probably changing with user interaction.<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>
      <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

  <code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"script.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code></pre></div>
<p>Now that we have our HTML skeleton, we want to style it using some CSS.<a data-primary="CSS" data-secondary="styling for basic web page" data-type="indexterm" id="idm45607792609904"/> This will use the classes and IDs of our content blocks to adjust size, position, background color, etc. To apply our CSS, in <a data-type="xref" href="#skel_html">Example 4-1</a> we import a <em>style.css</em> file, shown in <a data-type="xref" href="#skel_css">Example 4-2</a>.</p>
<div data-type="example" id="skel_css">
<h5><span class="label">Example 4-2. </span>The style.css file, providing our CSS styling</h5>
<pre data-code-language="css" data-type="programlisting"><code class="nt">body</code><code> </code><code class="p">{</code><code>
    </code><code class="k">background</code><code class="o">:</code><code> </code><code class="m">#ccc</code><code class="p">;</code><code>
    </code><code class="k">font-family</code><code class="o">:</code><code> </code><code class="n">Sans</code><code class="o">-</code><code class="nb">serif</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nc">.dev</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_webdev_101_CO4-1" id="co_webdev_101_CO4-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
    </code><code class="k">border</code><code class="o">:</code><code> </code><code class="nb">solid</code><code> </code><code class="m">1px</code><code> </code><code class="nb">red</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nc">.dev</code><code> </code><code class="nt">div</code><code> </code><code class="p">{</code><code>
    </code><code class="k">border</code><code class="o">:</code><code> </code><code class="nb">dashed</code><code> </code><code class="m">1px</code><code> </code><code class="nb">green</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nf">#chart-holder</code><code> </code><code class="p">{</code><code>
    </code><code class="k">width</code><code class="o">:</code><code> </code><code class="m">600px</code><code class="p">;</code><code>
    </code><code class="k">background</code><code> </code><code class="o">:</code><code class="nb">white</code><code class="p">;</code><code>
    </code><code class="k">margin</code><code class="o">:</code><code> </code><code class="nb">auto</code><code class="p">;</code><code>
    </code><code class="k">font-size</code><code> </code><code class="o">:</code><code class="m">16px</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nf">#chart-components</code><code> </code><code class="p">{</code><code>
    </code><code class="k">height</code><code> </code><code class="o">:</code><code class="m">400px</code><code class="p">;</code><code>
    </code><code class="k">position</code><code> </code><code class="o">:</code><code class="nb">relative</code><code class="p">;</code><code> </code><a class="co" href="#callout_webdev_101_CO4-2" id="co_webdev_101_CO4-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nf">#main</code><code class="o">,</code><code> </code><code class="nt">div</code><code class="nf">#sidebar</code><code> </code><code class="p">{</code><code>
    </code><code class="k">position</code><code class="o">:</code><code> </code><code class="nb">absolute</code><code class="p">;</code><code> </code><a class="co" href="#callout_webdev_101_CO4-3" id="co_webdev_101_CO4-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nf">#main</code><code> </code><code class="p">{</code><code>
    </code><code class="k">width</code><code class="o">:</code><code> </code><code class="m">75%</code><code class="p">;</code><code>
    </code><code class="k">height</code><code class="o">:</code><code> </code><code class="m">100%</code><code class="p">;</code><code>
    </code><code class="k">background</code><code class="o">:</code><code> </code><code class="m">#eee</code><code class="p">;</code><code>
</code><code class="p">}</code><code>

</code><code class="nt">div</code><code class="nf">#sidebar</code><code> </code><code class="p">{</code><code>
    </code><code class="k">right</code><code class="o">:</code><code> </code><code class="m">0</code><code class="p">;</code><code> </code><a class="co" href="#callout_webdev_101_CO4-4" id="co_webdev_101_CO4-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a><code>
    </code><code class="k">width</code><code class="o">:</code><code> </code><code class="m">25%</code><code class="p">;</code><code>
    </code><code class="k">height</code><code class="o">:</code><code> </code><code class="m">100%</code><code class="p">;</code><code>
</code><code class="p">}</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_webdev_101_CO4-1" id="callout_webdev_101_CO4-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>This <code>dev</code> class is a handy way to see the border of any visual blocks, which is useful for visualization work.</p></dd>
<dt><a class="co" href="#co_webdev_101_CO4-2" id="callout_webdev_101_CO4-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>Makes <code>chart-components</code> the relative parent.</p></dd>
<dt><a class="co" href="#co_webdev_101_CO4-3" id="callout_webdev_101_CO4-3"><img alt="3" height="12" src="assets/3.png" width="12"/></a></dt>
<dd><p>Makes the <code>main</code> and <code>sidebar</code> positions relative to <code>chart-components</code>.</p></dd>
<dt><a class="co" href="#co_webdev_101_CO4-4" id="callout_webdev_101_CO4-4"><img alt="4" height="12" src="assets/4.png" width="12"/></a></dt>
<dd><p>Positions this block flush with the right wall of <code>chart-components</code>.</p></dd>
</dl></div>
<p class="pagebreak-before">We use absolute positioning of the main and sidebar chart elements (<a data-type="xref" href="#skel_css">Example 4-2</a>). <a data-primary="positioning web page elements" data-type="indexterm" id="idm45607792262912"/>There are various ways to position the content blocks with CSS, but absolute positioning gives you explicit control over their placement, which is a must if you want to get the look just right.</p>
<p>After specifying the size of the <code>chart-components</code> container, the <code>main</code> and <code>sidebar</code> child elements are sized and positioned using percentages of their parent. This means any changes to the size of <code>chart-components</code> will be reflected in its children.</p>
<p>With our HTML and CSS defined, we can examine the skeleton by firing up Python’s single-line HTTP server in the project directory containing the <em>index.xhtml</em> and <em>style.css</em> files defined in Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#skel_html">4-1</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#skel_css">4-2</a>, like so:</p>
<pre data-code-language="bash" data-type="programlisting">$ python -m http.server <code class="m">8000</code>
Serving HTTP on <code class="m">0</code>.0.0.0 port <code class="m">8000</code> ...</pre>
<p><a data-type="xref" href="#placeholder">Figure 4-9</a> shows the resulting page with the Elements tab open, displaying the page’s DOM tree.<a data-primary="placeholders" data-secondary="elements for basic web page" data-type="indexterm" id="idm45607794289232"/></p>
<p>The chart’s content blocks are now positioned and sized correctly, ready for JavaScript to add some engaging content.</p>
<figure><div class="figure" id="placeholder">
<img alt="dpj2 0409" height="735" src="assets/dpj2_0409.png" width="958"/>
<h6><span class="label">Figure 4-9. </span>Building a basic web page</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="Positioning and Sizing Containers with Flex" data-type="sect1"><div class="sect1" id="sect_flexboxes">
<h1>Positioning and Sizing Containers with Flex</h1>
<p>Historically positioning and sizing content (usually <code>&lt;div&gt;</code> containers) with CSS was somewhat of a dark art.<a data-primary="web development (webdev)" data-secondary="web page (basic) with placeholders" data-startref="ix_webdevwpgbsc" data-type="indexterm" id="idm45607792250512"/><a data-primary="flex-boxes" data-secondary="positioning and sizing web page content containers with" data-type="indexterm" id="ix_Flx"/><a data-primary="web development (webdev)" data-secondary="positioning and sizing web page containers with Flex" data-type="indexterm" id="ix_webdevFlex"/> It didn’t help that there were a lot of cross-browser incompatibilities and disagreements about what constituted padding or margins. But even allowing for that, the CSS properties used seemed pretty ad-hoc. Often achieving what seems to be a perfectly reasonable positioning or sizing ambition turned out to involve arcane CSS knowledge, hidden in the deep recesses of a Stack Overflow thread. One example being centering a <code>div</code> in the horizontal and vertical.<sup><a data-type="noteref" href="ch04.xhtml#idm45607792243232" id="idm45607792243232-marker">11</a></sup> This has all changed with the advent of the CSS flex-box, which uses some powerful new CSS properties to provide almost all the sizing and positioning you’ll ever need.</p>
<p>Flex-boxes aren’t quite one CSS property to rule them all—the absolute positioning demonstrated in the previous section still has its place, particularly with data visualizations—but they are a collection of very powerful properties which, more often than not, represent the simplest, and sometimes the only, way to achieve a particular placing/sizing mission. Effects that used to require CSS expertise are now well within the grasp of a relative newbie and the icing on the cake is that flex-boxes play really well with variable screen ratios—the power of the flex. With that in mind, let’s see what can be done with the basic set of flex properties.</p>
<p>First, we’ll use a little HTML to create a container <code>div</code> with three child <code>div</code>s (boxes). The child boxes will be of class <code>box</code> with an ID to enable specific CSS to be applied:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code> <code class="na">id</code><code class="o">=</code><code class="s">"top-container"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box1"</code><code class="p">&gt;</code>box 1<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box2"</code><code class="p">&gt;</code>box 2<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box3"</code><code class="p">&gt;</code>box 3<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre>
<p>The initial CSS gives the container a red border, width, and height (600x400). The boxes are 100 pixels wide and high (80 pixels plus 10 pixels padding) and have a green border. A novel CSS property is the container’s <code>display: flex</code>, which establishes a flex display context. The result of this can be seen in <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (<code>display: flex</code>), which shows the boxes presented in a row rather than the default column, where each box occupies its own row:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.container</code> <code class="p">{</code>
  <code class="k">display</code><code class="o">:</code> <code class="nb">flex</code><code class="p">;</code>
  <code class="k">width</code><code class="o">:</code> <code class="m">600px</code><code class="p">;</code>
  <code class="k">height</code><code class="o">:</code> <code class="m">400px</code><code class="p">;</code>
  <code class="k">border</code><code class="o">:</code> <code class="m">2px</code> <code class="nb">solid</code> <code class="nb">red</code><code class="p">;</code>
<code class="p">}</code>

<code class="nc">.box</code> <code class="p">{</code>
  <code class="k">border</code><code class="o">:</code> <code class="m">2px</code> <code class="nb">solid</code> <code class="nb">green</code><code class="p">;</code>
  <code class="k">font-size</code><code class="o">:</code> <code class="m">28px</code><code class="p">;</code>
  <code class="k">padding</code><code class="o">:</code> <code class="m">10px</code><code class="p">;</code>
  <code class="k">width</code><code class="o">:</code> <code class="m">80px</code><code class="p">;</code>
  <code class="k">height</code><code class="o">:</code> <code class="m">80px</code><code class="p">;</code>
<code class="p">}</code></pre>
<figure><div class="figure" id="flex-boxes">
<img alt="dpj2 0410" height="1329" src="assets/dpj2_0410.png" width="1389"/>
<h6><span class="label">Figure 4-10. </span>Positioning and sizing with flex-boxes</h6>
</div></figure>
<p>Flex displays respond to children with the <code>flex</code> property by expanding their size to fit the available space. If we make the boxes flexible, they respond by expanding to fill the container row. <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (flex-direction: row) shows the result. Note that the <code>flex</code> property overrides the boxes’ width property, allowing them to expand:</p>
<pre class="pagebreak-before" data-code-language="css" data-type="programlisting"><code class="nc">.box</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
  <code class="k">flex</code><code class="o">:</code> <code class="m">1</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>The <code>flex-direction</code> property is <code>row</code> by default. By setting it to <code>column</code>, the boxes are placed in a column and the height property is overridden to allow them to expand to fit the container’s height. <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (direction column) shows the result:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.container</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
  <code class="k">flex-direction</code><code class="o">:</code> <code class="n">column</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>Removing or commenting out the width and height properties from the boxes makes them fully flexible, able to expand in the horizontal and vertical, producing <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (full flex):</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.box</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
  <code class="c">/* width: 80px;</code>
<code class="c">  height: 80px; */</code>
  <code class="k">flex</code><code class="o">:</code> <code class="m">1</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>If you want to reverse the order of the flex-boxes, there are a <code>row-reverse</code> and <code>column-reverse</code> <code>flex-direction</code>. <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (column reverse) shows the result of reversing the columns:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.container</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
  <code class="k">flex-direction</code><code class="o">:</code> <code class="n">column</code><code class="o">-</code><code class="n">reverse</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>The value of the boxes’ <code>flex</code> property represents a sizing weight. Initially all the boxes have a weight of one, which makes them of equal size. If we give the first box a weight of two, it will occupy half (2 / (1 + 1 + 2)) the available space in the row or column direction specified. <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (#box1 flex 2) shows the result of increasing <code>box1</code>’s flex value:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#box1</code> <code class="p">{</code>
  <code class="k">flex</code><code class="o">:</code> <code class="m">2</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>If we return the 100-pixel height and width (including padding) constraints to the boxes and remove their <code>flex</code> property, we can demonstrate the power of flex display positioning. We’ll also need to remove the flex directive from <code>box1</code>:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.box</code> <code class="p">{</code>
  <code class="k">width</code><code class="o">:</code> <code class="m">80px</code><code class="p">;</code>
  <code class="k">height</code><code class="o">:</code> <code class="m">80px</code><code class="p">;</code>
  <code class="c">/* flex: 1; */</code>
<code class="p">}</code>

<code class="nf">#box1</code> <code class="p">{</code>
  <code class="c">/* flex: 2; */</code>
<code class="p">}</code></pre>
<p>With fixed-size content, flex displays have a number of properties that allow precise placement of the content. This sort of manipulation used to involve all manner of tricky CSS hacks. First, let’s distribute the boxes evenly in their container, using row-based spacing. The magic property is <code>justify-content</code> with the value <code>space-between</code>; <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (space between) shows the result:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.container</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
  <code class="k">flex-direction</code><code class="o">:</code> <code class="n">row</code><code class="p">;</code>
  <code class="k">justify-content</code><code class="o">:</code> <code class="n">space</code><code class="o">-</code><code class="n">between</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>There is a <code>space-around</code> complement to <code>space-between</code>, which spaces the content by adding equal padding to left and right. <a data-type="xref" href="#flex-boxes">Figure 4-10</a> (space around) shows the result:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.container</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
  <code class="k">justify-content</code><code class="o">:</code> <code class="n">space</code><code class="o">-</code><code class="n">around</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>By combining the <code>justify-content</code> and <code>align-items</code> properties, we can achieve the holy grail of CSS positioning, centering the content in the vertical and the horizontal. We’ll add a gap of 20 pixels between the boxes using the flex display’s <code>gap</code> property:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.container</code> <code class="p">{</code>
  <code class="c">/* ... */</code>
    <code class="n">gap</code><code class="o">:</code> <code class="m">20px</code><code class="p">;</code>
    <code class="k">justify-content</code><code class="o">:</code> <code class="nb">center</code><code class="p">;</code>
    <code class="k">align-items</code><code class="o">:</code> <code class="nb">center</code><code class="p">;</code>
<code class="p">}</code></pre>
<p><a data-type="xref" href="#flex-boxes">Figure 4-10</a> (centered with <code>gap</code>) shows our content sitting squarely in the middle of its container.</p>
<p>Another great thing about the flex display is that it is fully recursive. <code>div</code>s can both <em>have</em> a display flex property and <em>be</em> flex content. This makes achieving complex content layouts a breeze. Let’s see a little demonstration of nested flex-boxes, to make the point clear.</p>
<p>We’ll first use some HTML to build a nested tree of boxes (including the main container box). We’ll give each box and container an ID and class:</p>
<pre data-code-language="html" data-type="programlisting">  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"main-container"</code><code class="p">&gt;</code>

    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code> <code class="na">id</code><code class="o">=</code><code class="s">"top-container"</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box1"</code><code class="p">&gt;</code>box 1<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box2"</code><code class="p">&gt;</code>box 2<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code> <code class="na">id</code><code class="o">=</code><code class="s">"middle-container"</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box3"</code><code class="p">&gt;</code>box 3<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"container"</code> <code class="na">id</code><code class="o">=</code><code class="s">"bottom-container"</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box4"</code><code class="p">&gt;</code>box 4<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box5"</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box6"</code><code class="p">&gt;</code>box 6<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"box"</code> <code class="na">id</code><code class="o">=</code><code class="s">"box7"</code><code class="p">&gt;</code>box 7<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
      <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>

  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre>
<p>The following CSS gives the main container a height of 800 pixels (it will fill the available width by default), a flex display, and a flex-direction of column, making it stack its flex content.</p>
<p>There are three containers to be stacked, which are both flexible and provide a flex display for their content. The boxes have a red border and are fully flexible (no width or height specified). By default all boxes have a flex weight of one.</p>
<p>The middle container has a fixed width box (width 66%) and uses <code>justify-content: center</code> to center it.</p>
<p>The bottom container has a flex value of 2, making it twice the height of its siblings. It has two boxes of equal weight, one of which (box 5) contains two boxes that are stacked (<code>flex-direction: column</code>). The fairly complex layout (see <a data-type="xref" href="#flex-boxes-nested">Figure 4-11</a>) is achieved with impressively little CSS and is easily adapted by changing a few flex display properties:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nc">.main-container</code> <code class="p">{</code>
  <code class="k">height</code><code class="o">:</code> <code class="m">800px</code><code class="p">;</code>
  <code class="k">padding</code><code class="o">:</code> <code class="m">10px</code><code class="p">;</code>
  <code class="k">border</code><code class="o">:</code> <code class="m">2px</code> <code class="nb">solid</code> <code class="nb">green</code><code class="p">;</code>
  <code class="k">display</code><code class="o">:</code> <code class="nb">flex</code><code class="p">;</code>
  <code class="k">flex-direction</code><code class="o">:</code> <code class="n">column</code><code class="p">;</code>
<code class="p">}</code>

<code class="nc">.container</code> <code class="p">{</code>
  <code class="k">flex</code><code class="o">:</code> <code class="m">1</code><code class="p">;</code>
  <code class="k">display</code><code class="o">:</code> <code class="nb">flex</code><code class="p">;</code>
<code class="p">}</code>

<code class="nc">.box</code> <code class="p">{</code>
  <code class="k">flex</code><code class="o">:</code> <code class="m">1</code><code class="p">;</code>
  <code class="k">border</code><code class="o">:</code> <code class="m">2px</code> <code class="nb">solid</code> <code class="nb">red</code><code class="p">;</code>
  <code class="k">padding</code><code class="o">:</code> <code class="m">10px</code><code class="p">;</code>
  <code class="k">font-size</code><code class="o">:</code> <code class="m">30px</code><code class="p">;</code>
<code class="p">}</code>

<code class="nf">#middle-container</code> <code class="p">{</code>
  <code class="k">justify-content</code><code class="o">:</code> <code class="nb">center</code><code class="p">;</code>
<code class="p">}</code>

<code class="nf">#box3</code> <code class="p">{</code>
  <code class="k">width</code><code class="o">:</code> <code class="m">66%</code><code class="p">;</code>
  <code class="k">flex</code><code class="o">:</code> <code class="nb">initial</code><code class="p">;</code>
<code class="p">}</code>

<code class="nf">#bottom-container</code> <code class="p">{</code>
  <code class="k">flex</code><code class="o">:</code> <code class="m">2</code><code class="p">;</code>
<code class="p">}</code>

<code class="nf">#box5</code> <code class="p">{</code>
  <code class="k">display</code><code class="o">:</code> <code class="nb">flex</code><code class="p">;</code>
  <code class="k">flex-direction</code><code class="o">:</code> <code class="n">column</code><code class="p">;</code>
<code class="p">}</code></pre>
<figure><div class="figure" id="flex-boxes-nested">
<img alt="dpj2 0411" height="793" src="assets/dpj2_0411.png" width="955"/>
<h6><span class="label">Figure 4-11. </span>Nested flex-boxes</h6>
</div></figure>
<p>Flex-boxes provide a very powerful sizing and positioning context for your HTML content that responds to container size and can be easily adapted. If you want your content in a column rather than a row, then a single property change makes it so. For more precise positioning and sizing control there is the <a href="https://oreil.ly/lVilF">CSS grid layout</a>, but I would recommend focusing your initial energies on the flex display—it represents the best return on your learning investment in CSS right now. For further examples, see the <a href="https://oreil.ly/JJgbG">CSS-Tricks article</a> on flex-boxes and <a href="https://flexboxsheet.com">this handy cheat sheet</a>.</p>
<section data-pdf-bookmark="Filling the Placeholders with Content" data-type="sect2"><div class="sect2" id="idm45607791397536">
<h2>Filling the Placeholders with Content</h2>
<p>With our content blocks defined in HTML and positioned with CSS, a modern data visualization uses JavaScript to construct its interactive charts, menus, tables, and the like.<a data-primary="placeholders" data-secondary="filling with content" data-type="indexterm" id="ix_plchfill"/><a data-primary="canvas element" data-secondary="2D and 3D graphics contexts" data-type="indexterm" id="idm45607791394784"/> There are many ways to create visual content (aside from image or multimedia tags) in your modern browser, the main ones being:</p>
<ul>
<li>
<p>Scalable Vector Graphics (SVG) using special HTML tags</p>
</li>
<li>
<p>Drawing to a 2D <code>canvas</code> context</p>
</li>
<li>
<p>Drawing to a 3D <code>canvas</code> WebGL context, allowing a subset of OpenGL <span class="keep-together">commands</span></p>
</li>
<li>
<p>Using modern CSS to create animations, graphic primitives, and more</p>
</li>
</ul>
<p>Because SVG is the <a data-primary="SVG (Scalable Vector Graphics)" data-secondary="benefits of use with canvas element" data-type="indexterm" id="idm45607791387744"/><a data-primary="SVG (Scalable Vector Graphics)" data-type="indexterm" id="idm45607791386832"/><a data-primary="canvas element" data-secondary="SVG graphics in" data-type="indexterm" id="idm45607791386160"/><a data-primary="WebGL context" data-type="indexterm" id="idm45607791385216"/>language of choice for D3, in many ways the biggest JavaScript dataviz library, many of the cool web data visualizations you have seen, such as those by the <em>New York Times</em>, are built using it.<a data-primary="D3 library" data-secondary="SVG graphics" data-type="indexterm" id="idm45607791384032"/>  Broadly speaking, unless you anticipate having lots (&gt;1,000) of moving elements in your visualization or need to use a specific <code>canvas</code>-based library, SVG is probably the way to go.</p>
<p>By using vectors instead of pixels to express its primitives, SVG will generally produce cleaner graphics that respond smoothly to scaling operations. It’s also much better at handling text, a crucial consideration for many visualizations. Another key advantage of SVG is that user interaction (e.g., mouse hovering or clicking) is native to the browser, being part of the standard DOM event handling.<sup><a data-type="noteref" href="ch04.xhtml#idm45607791382032" id="idm45607791382032-marker">12</a></sup>   A final point in its favor is that because the graphic components are built on the DOM, you can inspect and adapt them using your browser’s development tools (see <a data-type="xref" href="#chrome_tab">“Chrome DevTools”</a>). This can make debugging and refining your visualizations much easier than trying to find errors in the <code>canvas</code>’s relatively black box.</p>
<p><code>canvas</code> graphics contexts come into their own when you need to move beyond simple graphic primitives like circles and lines, such as when incorporating images like PNGs and JPGs.<a data-primary="canvas element" data-secondary="graphics contexts and more complicated graphics" data-type="indexterm" id="idm45607791377936"/> <code>canvas</code> is usually considerably more performant  than SVG, so anything with lots of moving elements<sup><a data-type="noteref" href="ch04.xhtml#idm45607791376208" id="idm45607791376208-marker">13</a></sup>  is better off rendered to a canvas. If you want to be really ambitious or move beyond 2D graphics, you can even unleash the awesome power of modern graphics cards by using a special form of <code>canvas</code> context, the OpenGL-based WebGL context.<a data-primary="WebGL context" data-type="indexterm" id="idm45607791374976"/>  Just bear in mind that what would be simple user interaction with SVG (e.g., clicking on a visual element) often has to be derived from mouse coordinates manually, which adds a tricky layer of complexity.</p>
<p>The Nobel Prize data visualization realized at the end of this book’s toolchain is built primarily with D3, so SVG graphics are the focus of this book. Being comfortable with SVG is fundamental to modern web-based dataviz, so let’s explore a little primer.<a data-primary="web development (webdev)" data-secondary="positioning and sizing web page containers with Flex" data-startref="ix_webdevFlex" data-type="indexterm" id="idm45607791373888"/><a data-primary="placeholders" data-secondary="filling with content" data-startref="ix_plchfill" data-type="indexterm" id="idm45607791372576"/><a data-primary="flex-boxes" data-secondary="positioning and sizing web page content containers with" data-startref="ix_Flx" data-type="indexterm" id="idm45607791371360"/></p>
</div></section>
</div></section>
<section data-pdf-bookmark="Scalable Vector Graphics" data-type="sect1"><div class="sect1" id="sect_svg">
<h1>Scalable Vector Graphics</h1>
<p>All SVG<a data-primary="SVG (Scalable Vector Graphics)" data-type="indexterm" id="ix_SVG"/><a data-primary="web development (webdev)" data-secondary="Scalar Vector Graphics" data-type="indexterm" id="ix_webdevSVG"/> creations start with an <code>&lt;svg&gt;</code> root tag. All graphical elements, such as circles and lines, and groups thereof, are defined on this branch of the DOM tree. <a data-type="xref" href="#webdev_svg_tag">Example 4-3</a> shows  a little SVG context we’ll use in upcoming demonstrations, a light-gray rectangle with ID <code>chart</code>. We also include the D3 library, loaded from <a class="orm:hideurl" href="https://d3js.org"><em>d3js.org</em></a> and a <em>script.js</em> JavaScript file in the project folder.</p>
<div data-type="example" id="webdev_svg_tag">
<h5><span class="label">Example 4-3. </span>A basic SVG context</h5>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>
<code class="cm">&lt;!-- A few CSS style rules --&gt;</code>
<code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>
  <code class="nt">svg</code><code class="nf">#chart</code> <code class="p">{</code>
  <code class="k">background</code><code class="o">:</code> <code class="n">lightgray</code><code class="p">;</code>
  <code class="p">}</code>
<code class="nt">&lt;/style&gt;</code>

<code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"225"</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code>

<code class="cm">&lt;!-- Third-party libraries and our JS script. --&gt;</code>
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"http://d3js.org/d3.v7.min.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"script.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>
<p>Now that we’ve got our little SVG canvas in place, let’s start doing some drawing.</p>
<section data-pdf-bookmark="The &lt;g&gt; Element" data-type="sect2"><div class="sect2" id="idm45607791342816">
<h2>The &lt;g&gt; Element</h2>
<p>We can group shapes within our <code>&lt;svg&gt;</code> element by using the group <code>&lt;g&gt;</code> element. <a data-primary="g (groups) element in SVG" data-type="indexterm" id="idm45607791331216"/><a data-primary="SVG (Scalable Vector Graphics)" data-secondary="g (groups) element" data-type="indexterm" id="idm45607791330512"/><a data-primary="groups" data-secondary="g element in SVG" data-type="indexterm" id="idm45607791329600"/>As we’ll see in <a data-type="xref" href="#sect_groups">“Working with Groups”</a>, shapes contained in a group can be manipulated together, including changing their position, scale, or opacity.</p>
</div></section>
<section data-pdf-bookmark="Circles" data-type="sect2"><div class="sect2" id="idm45607791327440">
<h2>Circles</h2>
<p>Creating SVG visualizations, from the humblest <a data-primary="circles, creating in SVG" data-type="indexterm" id="idm45607791325680"/><a data-primary="SVG (Scalable Vector Graphics)" data-secondary="circles in" data-type="indexterm" id="idm45607791325008"/>little static bar chart to full-fledged interactive, geographic masterpieces, involves putting together elements from a fairly small set of graphical primitives such as lines, circles, and the very powerful paths. Each of these elements will have its own DOM tag, which will update as it changes.<sup><a data-type="noteref" href="ch04.xhtml#idm45607791323968" id="idm45607791323968-marker">14</a></sup> For example,  its <em>x</em> and <em>y</em> attributes will change to reflect any translations within its <code>&lt;svg&gt;</code> or group (<code>&lt;g&gt;</code>) context.</p>
<p>Let’s add a circle to our <code>&lt;svg&gt;</code> context to demonstrate:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"225"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">r</code><code class="o">=</code><code class="s">"15"</code> <code class="na">cx</code><code class="o">=</code><code class="s">"100"</code> <code class="na">cy</code><code class="o">=</code><code class="s">"50"</code><code class="p">&gt;&lt;/</code><code class="nt">circle</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>With a little CSS to <a data-primary="CSS" data-secondary="adding circle fill color in SVG" data-type="indexterm" id="idm45607791228960"/>provide the circle’s fill color:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#chart</code> <code class="nt">circle</code><code class="p">{</code> <code class="k">fill</code><code class="o">:</code> <code class="nb">lightblue</code> <code class="p">}</code></pre>
<p>This produces <a data-type="xref" href="#svg_circle">Figure 4-12</a>. Note that the <em>y</em> coordinate is measured from the top of the <code>&lt;svg&gt;</code> <code>'#chart'</code> container, a common graphic <span class="keep-together">convention</span>.</p>
<figure><div class="figure" id="svg_circle">
<img alt="dpj2 0412" height="747" src="assets/dpj2_0412.png" width="1174"/>
<h6><span class="label">Figure 4-12. </span>An SVG circle</h6>
</div></figure>
<p>Now let’s see how we go about applying styles to SVG elements.</p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Applying CSS Styles" data-type="sect2"><div class="sect2" id="idm45607791185376">
<h2>Applying CSS Styles</h2>
<p>The circle in <a data-type="xref" href="#svg_circle">Figure 4-12</a> is fill-colored <a data-primary="CSS" data-secondary="styles, applying to SVG elements" data-type="indexterm" id="idm45607791182544"/><a data-primary="SVG (Scalable Vector Graphics)" data-secondary="applying CSS styles to elements" data-type="indexterm" id="idm45607791181600"/><a data-primary="styles" data-secondary="setting on SVG elements using CSS" data-type="indexterm" id="idm45607791180720"/>light blue using CSS styling rules:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#chart</code> <code class="nt">circle</code><code class="p">{</code> <code class="k">fill</code><code class="o">:</code> <code class="nb">lightblue</code> <code class="p">}</code></pre>
<p>In modern browsers, you can set most visual SVG styles using CSS, including <code>fill</code>, <code>stroke</code>, <code>stroke-width</code>, and <code>opacity</code>. <a data-primary="fill property (SVG)" data-type="indexterm" id="idm45607791156608"/><a data-primary="stroke property (SVG)" data-type="indexterm" id="idm45607791153136"/><a data-primary="stroke-width property (SVG)" data-type="indexterm" id="idm45607791152464"/><a data-primary="opacity property (SVG)" data-type="indexterm" id="idm45607791151824"/><a data-primary="CSS" data-secondary="setting SVG visual styles with" data-type="indexterm" id="idm45607791151152"/>So if we wanted a thick, semitransparent green line (with ID <code>total</code>) we could use the following CSS:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#chart</code> <code class="nt">line</code><code class="nf">#total</code> <code class="p">{</code>
    <code class="k">stroke</code><code class="o">:</code> <code class="nb">green</code><code class="p">;</code>
    <code class="k">stroke-width</code><code class="o">:</code> <code class="m">3px</code><code class="p">;</code>
    <code class="k">opacity</code><code class="o">:</code> <code class="m">0</code><code class="o">.</code><code class="m">5</code><code class="p">;</code>
<code class="p">}</code></pre>
<p>You can also set the styles as attributes of the tags, though CSS is generally preferable:<a data-primary="attributes (SVG elements)" data-type="indexterm" id="idm45607791110672"/><a data-primary="styles" data-secondary="setting as attributes of SVG tags" data-type="indexterm" id="idm45607791110064"/></p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">r</code><code class="o">=</code><code class="s">"15"</code> <code class="na">cx</code><code class="o">=</code><code class="s">"100"</code> <code class="na">cy</code><code class="o">=</code><code class="s">"50"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"lightblue"</code><code class="p">&gt;&lt;/</code><code class="nt">circle</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<div data-type="tip"><h6>Tip</h6>
<p>Which SVG features can be set by CSS and which can’t is a source of some confusion and plenty of gotchas.<a data-primary="CSS" data-secondary="SVG features which can and can't be set by" data-type="indexterm" id="idm45607791060960"/><a data-primary="SVG (Scalable Vector Graphics)" data-secondary="element properties and attributes" data-type="indexterm" id="idm45607791060080"/> The SVG spec distinguishes between element <a href="https://oreil.ly/K0enr">properties</a> and attributes, the former being more likely to be found among the valid CSS styles. You can investigate the valid CSS properties using Chrome’s Elements tab and its autocomplete. Also, be prepared for some surprises. For example, SVG text is colored by the <code>fill</code>, not <code>color</code>, property.</p>
</div>
<p>For <code>fill</code> and <code>stroke</code>, there are various color conventions you can use:</p>
<ul>
<li>
<p>Named HTML colors, such as lightblue</p>
</li>
<li>
<p>Using HTML hex codes (#RRGGBB); for example, white is #FFFFFF</p>
</li>
<li>
<p>RGB values; for example, red = rgb(255, 0, 0)</p>
</li>
<li>
<p>RGBA values, where A is an alpha channel (0–1); for example, half-transparent blue is rgba(0, 0, 255, 0.5)</p>
</li>
</ul>
<p>In addition to adjusting the color’s alpha channel with RGBA, you can fade the SVG elements using their <code>opacity</code> property. Opacity is used a lot in D3 animations.</p>
<p>Stroke width is measured in pixels by default but can use points.<a data-primary="SVG (Scalable Vector Graphics)" data-secondary="lines, rectangles, and polygons" data-type="indexterm" id="idm45607791050672"/></p>
</div></section>
<section class="pagebreak-before less_space" data-pdf-bookmark="Lines, Rectangles, and Polygons" data-type="sect2"><div class="sect2" id="idm45607791184752">
<h2>Lines, Rectangles, and Polygons</h2>
<p>We’ll add a few more elements to our chart to produce <a data-type="xref" href="#svg_axes">Figure 4-13</a>.</p>
<figure><div class="figure" id="svg_axes">
<img alt="dpj2 0413" height="218" src="assets/dpj2_0413.png" width="350"/>
<h6><span class="label">Figure 4-13. </span>Adding a few elements to our dummy chart</h6>
</div></figure>
<p>First, we’ll add a couple of simple<a data-primary="lines (in SVG)" data-type="indexterm" id="idm45607791044592"/> axis lines to our chart, using the <code>&lt;line&gt;</code> tag. Line positions are defined by a start coordinate (x1, y1) and an end one (x2, y2):</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">line</code> <code class="na">x1</code><code class="o">=</code><code class="s">"20"</code> <code class="na">y1</code><code class="o">=</code><code class="s">"20"</code> <code class="na">x2</code><code class="o">=</code><code class="s">"20"</code> <code class="na">y2</code><code class="o">=</code><code class="s">"130"</code><code class="p">&gt;&lt;/</code><code class="nt">line</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">line</code> <code class="na">x1</code><code class="o">=</code><code class="s">"20"</code> <code class="na">y1</code><code class="o">=</code><code class="s">"130"</code> <code class="na">x2</code><code class="o">=</code><code class="s">"280"</code> <code class="na">y2</code><code class="o">=</code><code class="s">"130"</code><code class="p">&gt;&lt;/</code><code class="nt">line</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>We’ll also add a dummy legend box in the top-right corner using an SVG rectangle. <a data-primary="rectangles in SVG" data-type="indexterm" id="idm45607790960448"/>Rectangles are defined by <em>x</em> and <em>y</em> coordinates relative to their parent container, and a width and height:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">rect</code> <code class="na">x</code><code class="o">=</code><code class="s">"240"</code> <code class="na">y</code><code class="o">=</code><code class="s">"5"</code> <code class="na">width</code><code class="o">=</code><code class="s">"55"</code> <code class="na">height</code><code class="o">=</code><code class="s">"30"</code><code class="p">&gt;&lt;/</code><code class="nt">rect</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>You can create irregular polygons using the <code>&lt;polygon&gt;</code> tag, which takes a list of coordinate pairs. <a data-primary="polygons in SVG graphics" data-type="indexterm" id="idm45607790917280"/>Let’s make a triangle marker in the bottom right of our chart:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">polygon</code> <code class="na">points</code><code class="o">=</code><code class="s">"210,100, 230,100, 220,80"</code><code class="p">&gt;&lt;/</code><code class="nt">polygon</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>We’ll style the elements with a little CSS:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#chart</code> <code class="nt">circle</code> <code class="p">{</code><code class="k">fill</code><code class="o">:</code> <code class="nb">lightblue</code><code class="p">}</code>
<code class="nf">#chart</code> <code class="nt">line</code> <code class="p">{</code><code class="k">stroke</code><code class="o">:</code> <code class="m">#555555</code><code class="p">;</code> <code class="k">stroke-width</code><code class="o">:</code> <code class="m">2</code><code class="p">}</code>
<code class="nf">#chart</code> <code class="nt">rect</code> <code class="p">{</code><code class="k">stroke</code><code class="o">:</code> <code class="nb">red</code><code class="p">;</code> <code class="k">fill</code><code class="o">:</code> <code class="nb">white</code><code class="p">}</code>
<code class="nf">#chart</code> <code class="nt">polygon</code> <code class="p">{</code><code class="k">fill</code><code class="o">:</code> <code class="nb">green</code><code class="p">}</code></pre>
<p>Now that we’ve got a few graphical primitives in place, let’s see how we add some text to our dummy chart.</p>
</div></section>
<section data-pdf-bookmark="Text" data-type="sect2"><div class="sect2" id="idm45607791049296">
<h2>Text</h2>
<p>One of the key strengths of SVG over the rasterized <code>canvas</code> context is how it handles text. <a data-primary="SVG (Scalable Vector Graphics)" data-secondary="text" data-type="indexterm" id="idm45607790806736"/><a data-primary="text" data-secondary="handling in SVG" data-type="indexterm" id="idm45607790805792"/>Vector-based text tends to look a lot clearer than its pixelated counterparts and benefits from smooth scaling too. You can also adjust stroke and fill properties, just like any SVG element.</p>
<p>Let’s add a bit of text to our dummy chart: a title and labeled y-axis (see <a data-type="xref" href="#svg_text">Figure 4-14</a>).</p>
<figure><div class="figure" id="svg_text">
<img alt="dpj2 0414" height="221" src="assets/dpj2_0414.png" width="352"/>
<h6><span class="label">Figure 4-14. </span>Some SVG text</h6>
</div></figure>
<p>We place text using <em>x</em> and <em>y</em> coordinates. One important property is the <code>text-anchor</code>, which stipulates where the text is placed relative to its x position.<a data-primary="text-anchor property (SVG)" data-type="indexterm" id="idm45607790786224"/> The options are <code>start</code>, <code>middle</code>, and <code>end</code>; <code>start</code> is the default.</p>
<p>We can use the <code>text-anchor</code> property to center our chart title. We set the <em>x</em> coordinates at half the chart width and then set the <code>text-anchor</code> to <code>middle</code>:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">text</code> <code class="na">id</code><code class="o">=</code><code class="s">"title"</code> <code class="na">text-anchor</code><code class="o">=</code><code class="s">"middle"</code> <code class="na">x</code><code class="o">=</code><code class="s">"150"</code> <code class="na">y</code><code class="o">=</code><code class="s">"20"</code><code class="p">&gt;</code>
    A Dummy Chart
  <code class="p">&lt;/</code><code class="nt">text</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>As with all SVG primitives, we can apply scaling and rotation transforms to our text. <a data-primary="scaling" data-secondary="applying scaling transforms to SVG text" data-type="indexterm" id="idm45607790726192"/><a data-primary="rotation" data-secondary="applying rotation transforms to SVG text" data-type="indexterm" id="idm45607790725344"/>To label our y-axis, we’ll need to rotate the text to the vertical (<a data-type="xref" href="#svg_text_rotate">Example 4-4</a>). By convention, rotations are clockwise by degree, so we’ll want a counterclockwise, –90 degree rotation. By default rotations are around the (0,0) point of the element’s container (<code>&lt;svg&gt;</code> or group <code>&lt;g&gt;</code>). We want to rotate our text around its own position, so first translate the rotation point using the extra arguments to the <code>rotate</code> function. We also want to first set the <code>text-anchor</code> to the end of the <code>y axis label</code> string to rotate about its endpoint.</p>
<div class="pagebreak-before" data-type="example" id="svg_text_rotate">
<h5><span class="label">Example 4-4. </span>Rotating text</h5>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">text</code> <code class="na">x</code><code class="o">=</code><code class="s">"20"</code> <code class="na">y</code><code class="o">=</code><code class="s">"20"</code> <code class="na">transform</code><code class="o">=</code><code class="s">"rotate(-90,20,20)"</code>
      <code class="na">text-anchor</code><code class="o">=</code><code class="s">"end"</code> <code class="na">dy</code><code class="o">=</code><code class="s">"0.71em"</code><code class="p">&gt;</code>y axis label<code class="p">&lt;/</code><code class="nt">text</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre></div>
<p>In <a data-type="xref" href="#svg_text_rotate">Example 4-4</a>, we make use of the text’s <code>dy</code> attribute, which, along with <code>dx</code>, can be used to make fine adjustments to the text’s position.<a data-primary="dy and dx attributes (SVG)" data-type="indexterm" id="idm45607790743680"/> In this case, we want to lower it so that when rotated counterclockwise it will be to the right of the y-axis.</p>
<p>SVG text elements can also be styled with CSS. Here we set the <code>font-family</code> of the chart to <code>sans-serif</code> and the <code>font-size</code> to <code>16px</code>, using the <code>title</code> ID to make that a little bigger:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#chart</code> <code class="p">{</code>
<code class="k">background</code><code class="o">:</code> <code class="m">#eee</code><code class="p">;</code>
<code class="k">font-family</code><code class="o">:</code> <code class="nb">sans-serif</code><code class="p">;</code>
<code class="p">}</code>
<code class="nf">#chart</code> <code class="nt">text</code><code class="p">{</code> <code class="k">font-size</code><code class="o">:</code> <code class="m">16px</code> <code class="p">}</code>
<code class="nf">#chart</code> <code class="nt">text</code><code class="nf">#title</code><code class="p">{</code> <code class="k">font-size</code><code class="o">:</code> <code class="m">18px</code> <code class="p">}</code></pre>
<p>Note that the <code>text</code> elements inherit <code>font-family</code> and <code>font-size</code> from the chart’s CSS; you don’t have to specify a <code>text</code> element.</p>
</div></section>
<section data-pdf-bookmark="Paths" data-type="sect2"><div class="sect2" id="idm45607790808032">
<h2>Paths</h2>
<p>Paths are the most complicated and powerful SVG element, enabling the creation of multiline, multicurve component paths that can be closed and filled, creating pretty much any shape you want.<a data-primary="SVG (Scalable Vector Graphics)" data-secondary="paths in" data-type="indexterm" id="idm45607790634096"/><a data-primary="paths, creating in SVG" data-type="indexterm" id="idm45607790633152"/> A simple example is adding a little chart line to our dummy chart to produce <a data-type="xref" href="#svg_path">Figure 4-15</a>.</p>
<figure><div class="figure" id="svg_path">
<img alt="dpj2 0415" height="220" src="assets/dpj2_0415.png" width="351"/>
<h6><span class="label">Figure 4-15. </span>A red line path from the chart axis</h6>
</div></figure>
<p>The red path in <a data-type="xref" href="#svg_path">Figure 4-15</a> is produced by the following SVG:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">path</code> <code class="na">d</code><code class="o">=</code><code class="s">"M20 130L60 70L110 100L160 45"</code><code class="p">&gt;&lt;/</code><code class="nt">path</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>The <code>path</code>’s <code>d</code> attribute specifies <a data-primary="d attribute (path element in SVG)" data-type="indexterm" id="idm45607790622064"/>the series of operations needed to make the red line. Let’s break it down:</p>
<ul>
<li>
<p>“M20  130”: move to coordinate (20, 130)</p>
</li>
<li>
<p>“L60  70”: draw a line to (60, 70)</p>
</li>
<li>
<p>“L110  100”: draw a line to (110, 100)</p>
</li>
<li>
<p>“L160  45”: draw a line to (160, 45)</p>
</li>
</ul>
<p>You can imagine <code>d</code> as a set of instructions to a pen to move to a point, with <code>M</code> raising the pen from the canvas.</p>
<p>A little CSS styling is needed. <a data-primary="CSS" data-secondary="styling path in SVG" data-type="indexterm" id="idm45607790584320"/><a data-primary="fill property (SVG)" data-type="indexterm" id="idm45607790583344"/><a data-primary="stroke property (SVG)" data-type="indexterm" id="idm45607790582672"/>Note that the <code>fill</code> is set to <code>none</code>; otherwise, to create a fill area, the path would be closed, drawing a line from its end to beginning points, and any enclosed areas filled in with the default color black:</p>
<pre data-code-language="css" data-type="programlisting"><code class="nf">#chart</code> <code class="nt">path</code> <code class="p">{</code><code class="k">stroke</code><code class="o">:</code> <code class="nb">red</code><code class="p">;</code> <code class="k">fill</code><code class="o">:</code> <code class="nb">none</code><code class="p">}</code></pre>
<p>As well as the <code>moveto 'M'</code> and <code>lineto 'L'</code>, the path has a number of other commands to draw arcs, Bézier curves, and the like. <a data-primary="arcs (in SVG)" data-type="indexterm" id="idm45607790550288"/><a data-primary="elliptical arcs in SVG" data-type="indexterm" id="idm45607790536640"/>SVG arcs and curves are commonly used in dataviz work, with many of D3’s libraries making use of them.<sup><a data-type="noteref" href="ch04.xhtml#idm45607790535824" id="idm45607790535824-marker">15</a></sup> <a data-type="xref" href="#svg_arc">Figure 4-16</a> shows some SVG elliptical arcs created by the following code:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code><code> </code><code class="na">id</code><code class="o">=</code><code class="s">"chart"</code><code> </code><code class="na">width</code><code class="o">=</code><code class="s">"300"</code><code> </code><code class="na">height</code><code class="o">=</code><code class="s">"150"</code><code class="p">&gt;</code><code>
  </code><code class="p">&lt;</code><code class="nt">path</code><code> </code><code class="na">d</code><code class="o">=</code><code class="s">"M40 40
           A30 40  </code><a class="co" href="#callout_webdev_101_CO5-1" id="co_webdev_101_CO5-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code class="s">
           0 0 1  </code><a class="co" href="#callout_webdev_101_CO5-2" id="co_webdev_101_CO5-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a><code class="s">
           80 80
           A50 50  0 0 1  160  80
           A30 30  0 0 1  190  80
"</code><code class="p">&gt;</code><code>
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_webdev_101_CO5-1" id="callout_webdev_101_CO5-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>Having moved to position (40, 40), draw an elliptical arc with x-radius 30, y-radius 40, and endpoint (80, 80).</p></dd>
<dt><a class="co" href="#co_webdev_101_CO5-2" id="callout_webdev_101_CO5-2"><img alt="2" height="12" src="assets/2.png" width="12"/></a></dt>
<dd><p>The first flag (0) sets the x axis rotation, in this case the conventional zero. See <a href="https://oreil.ly/KGCDZ">the Mozilla developer site</a> for a visual demonstration. The last two flags (0, 1) are <code>large-arc-flag</code>, specifying which arc of the ellipse to use, and <code>sweep-flag</code>, which specifies which of the two possible ellipses defined by start and endpoints to use.</p></dd>
</dl>
<figure><div class="figure" id="svg_arc">
<img alt="dpj2 0416" height="234" src="assets/dpj2_0416.png" width="356"/>
<h6><span class="label">Figure 4-16. </span>Some SVG elliptical arcs</h6>
</div></figure>
<p>The key flags used <a data-primary="elliptical arcs in SVG" data-secondary="flags used in" data-type="indexterm" id="idm45607790454096"/>in the elliptical arc (<code>large-arc-flag</code> and <code>sweep-flag</code>) are, like most things geometric, better demonstrated than described. <a data-type="xref" href="#svg_arc_flags">Figure 4-17</a> shows the effect of changing the flags for the same relative beginning and endpoints, like so:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"150"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">path</code> <code class="na">d</code><code class="o">=</code><code class="s">"M40 80</code>
<code class="s">           A30 40  0 0 1  80 80</code>
<code class="s">           A30 40  0 0 0  120  80</code>
<code class="s">           A30 40  0 1 0  160  80</code>
<code class="s">           A30 40  0 1 1  200  80</code>
<code class="s">"</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<figure><div class="figure" id="svg_arc_flags">
<img alt="dpj2 0417" height="222" src="assets/dpj2_0417.png" width="350"/>
<h6><span class="label">Figure 4-17. </span>Changing the elliptic-arc flags</h6>
</div></figure>
<p>As well as lines and arcs, the <code>path</code> element offers a number of Bézier curves, including quadratic, cubic, and compounds of the two.<a data-primary="Bézier curves offered by SVG path element" data-type="indexterm" id="idm45607790390896"/> With a little work, these can create any line path you want. There’s a nice run-through <a href="https://oreil.ly/PRdVF">on SitePoint</a> with good illustrations.</p>
<p>For the definitive list of <code>path</code> elements and their arguments, go <a href="https://oreil.ly/s7YSY">to the World Wide Web Consortium (W3C) source</a>. And for a nice round-up, see <a href="https://oreil.ly/fdERF">Jakob Jenkov’s <span class="keep-together">introduction</span></a>.</p>
</div></section>
<section data-pdf-bookmark="Scaling and Rotating" data-type="sect2"><div class="sect2" id="idm45607790635232">
<h2>Scaling and Rotating</h2>
<p>As befits their vector nature, all SVG elements can be transformed by geometric operations. <a data-primary="SVG (Scalable Vector Graphics)" data-secondary="scaling and rotating elements" data-type="indexterm" id="idm45607790418992"/><a data-primary="rotation" data-secondary="rotate operation in SVG" data-type="indexterm" id="idm45607790418032"/><a data-primary="scaling" data-secondary="scale operation in SVG" data-type="indexterm" id="idm45607790417088"/>The most commonly used are <code>rotate</code>, <code>translate</code>, and <code>scale</code>, but you can also apply skewing using <code>skewX</code> and <code>skewY</code>  or use the powerful, multipurpose <em>matrix</em> transform.<a data-primary="matrix transform (SVG)" data-type="indexterm" id="idm45607790413360"/><a data-primary="skewing (in SVG)" data-type="indexterm" id="idm45607790412624"/></p>
<p>Let’s demonstrate the most popular transforms, using a set of identical rectangles. The transformed rectangles in <a data-type="xref" href="#svg_transform">Figure 4-18</a> are achieved like so:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"150"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">rect</code> <code class="na">width</code><code class="o">=</code><code class="s">"20"</code> <code class="na">height</code><code class="o">=</code><code class="s">"40"</code> <code class="na">transform</code><code class="o">=</code><code class="s">"translate(60, 55)"</code>
        <code class="na">fill</code><code class="o">=</code><code class="s">"blue"</code><code class="p">/&gt;</code>
  <code class="p">&lt;</code><code class="nt">rect</code> <code class="na">width</code><code class="o">=</code><code class="s">"20"</code> <code class="na">height</code><code class="o">=</code><code class="s">"40"</code> <code class="na">transform</code><code class="o">=</code><code class="s">"translate(120, 55),</code>
<code class="s">        rotate(45)"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"blue"</code><code class="p">/&gt;</code>
  <code class="p">&lt;</code><code class="nt">rect</code> <code class="na">width</code><code class="o">=</code><code class="s">"20"</code> <code class="na">height</code><code class="o">=</code><code class="s">"40"</code> <code class="na">transform</code><code class="o">=</code><code class="s">"translate(180, 55),</code>
<code class="s">        scale(0.5)"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"blue"</code><code class="p">/&gt;</code>
  <code class="p">&lt;</code><code class="nt">rect</code> <code class="na">width</code><code class="o">=</code><code class="s">"20"</code> <code class="na">height</code><code class="o">=</code><code class="s">"40"</code> <code class="na">transform</code><code class="o">=</code><code class="s">"translate(240, 55),</code>
<code class="s">        rotate(45),scale(0.5)"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"blue"</code><code class="p">/&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<figure><div class="figure" id="svg_transform">
<img alt="dpj2 0418" height="227" src="assets/dpj2_0418.png" width="347"/>
<h6><span class="label">Figure 4-18. </span>Some SVG transforms: rotate(45), scale(0.5), scale(0.5), then rotate(45)</h6>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The order in which transforms are applied is important. A rotation of 45 degrees clockwise followed by a translation along the x-axis will see the element moved southeasterly, whereas the reverse operation moves it to the left and then rotates it.</p>
</div>
</div></section>
<section data-pdf-bookmark="Working with Groups" data-type="sect2"><div class="sect2" id="sect_groups">
<h2>Working with Groups</h2>
<p>Often when you are constructing a visualization, it’s helpful to group the visual elements. <a data-primary="SVG (Scalable Vector Graphics)" data-secondary="groups of visual elements" data-type="indexterm" id="idm45607790326880"/>A couple of particular uses are:</p>
<ul>
<li>
<p>When you require local coordinate schemes (e.g., if you have a text label for an icon and you want to specify its position relative to the icon, not the whole <code>&lt;svg&gt;</code> canvas).</p>
</li>
<li>
<p>If you want to apply a scaling and/or rotation transformation to a subset of the visual elements.</p>
</li>
</ul>
<p>SVG has a group <code>&lt;g&gt;</code> tag for this, which you can think of as a mini canvas within the <code>&lt;svg&gt;</code> canvas. <a data-primary="g (groups) element in SVG" data-type="indexterm" id="idm45607790321856"/>Groups can contain groups, allowing for very flexible geometric mappings.<sup><a data-type="noteref" href="ch04.xhtml#idm45607790321024" id="idm45607790321024-marker">16</a></sup></p>
<p><a data-type="xref" href="#svg_group_code">Example 4-5</a>  groups shapes in the center of the canvas, producing <a data-type="xref" href="#svg_group">Figure 4-19</a>. Note that the position of <code>circle</code>, <code>rect</code>, and <code>path</code> elements is relative to the translated group.</p>
<div data-type="example" id="svg_group_code">
<h5><span class="label">Example 4-5. </span>Grouping SVG shapes</h5>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"150"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">g</code> <code class="na">id</code><code class="o">=</code><code class="s">"shapes"</code> <code class="na">transform</code><code class="o">=</code><code class="s">"translate(150,75)"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">cx</code><code class="o">=</code><code class="s">"50"</code> <code class="na">cy</code><code class="o">=</code><code class="s">"0"</code> <code class="na">r</code><code class="o">=</code><code class="s">"25"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"red"</code> <code class="p">/&gt;</code>
    <code class="p">&lt;</code><code class="nt">rect</code> <code class="na">x</code><code class="o">=</code><code class="s">"30"</code> <code class="na">y</code><code class="o">=</code><code class="s">"10"</code> <code class="na">width</code><code class="o">=</code><code class="s">"40"</code> <code class="na">height</code><code class="o">=</code><code class="s">"20"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"blue"</code> <code class="p">/&gt;</code>
    <code class="p">&lt;</code><code class="nt">path</code> <code class="na">d</code><code class="o">=</code><code class="s">"M-20 -10L50 -10L10 60Z"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"green"</code> <code class="p">/&gt;</code>
    <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">r</code><code class="o">=</code><code class="s">"10"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"yellow"</code><code class="p">&gt;</code>
  <code class="p">&lt;/</code><code class="nt">g</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre></div>
<figure><div class="figure" id="svg_group">
<img alt="dpj2 0419" height="221" src="assets/dpj2_0419.png" width="349"/>
<h6><span class="label">Figure 4-19. </span>Grouping shapes with SVG <code>&lt;g&gt;`</code> tag</h6>
</div></figure>
<p>If we now apply a transform to the group, all shapes within it will be affected. <a data-type="xref" href="#svg_group_transform">Figure 4-20</a> shows the result of scaling <a data-type="xref" href="#svg_group">Figure 4-19</a> by a factor of 0.75 and then rotating it 90 degrees, which we achieve by adapting the transform attribute, like so:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"150"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">g</code> <code class="na">id</code><code class="o">=</code><code class="s">"shapes"</code><code class="err">,</code>
     <code class="na">transform </code><code class="o">=</code> <code class="s">"translate(150,75),scale(0.5),rotate(90)"</code><code class="p">&gt;</code>
     ...
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<figure><div class="figure" id="svg_group_transform">
<img alt="dpj2 0420" height="222" src="assets/dpj2_0420.png" width="352"/>
<h6><span class="label">Figure 4-20. </span>Transforming an SVG group</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="Layering and Transparency" data-type="sect2"><div class="sect2" id="sect_svg_layering">
<h2>Layering and Transparency</h2>
<p>The order in which the SVG elements are added to the DOM tree is important, with later elements taking precedence, layering over others.<a data-primary="layering SVG elements" data-type="indexterm" id="idm45607790099360"/><a data-primary="DOM (Document Object Model)" data-secondary="manipulating for SVG element layering and transparency" data-type="indexterm" id="idm45607790098656"/><a data-primary="SVG (Scalable Vector Graphics)" data-secondary="layering and transparency" data-type="indexterm" id="idm45607790097776"/> In <a data-type="xref" href="#svg_group">Figure 4-19</a>, for example, the triangle path obscures the red circle and blue rectangle and is in turn obscured by the yellow circle.</p>
<p>Manipulating the DOM ordering is an important part of JavaScripted dataviz (e.g., D3’s <code>insert</code> method allows you to place an SVG element before an existing one).</p>
<p>Element transparency can be manipulated using the alpha channel of <code>rgba(R,G,B,A)</code> colors or the more convenient <code>opacity</code> property. <a data-primary="transparency (SVG elements)" data-type="indexterm" id="idm45607790093776"/><a data-primary="opacity property (SVG)" data-type="indexterm" id="idm45607790093072"/>Both can be set using CSS. For overlaid elements, opacity is cumulative, as demonstrated by the color triangle in <a data-type="xref" href="#svg_transparency">Figure 4-21</a>, produced by the following SVG:</p>
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>
  <code class="nf">#chart</code> <code class="nt">circle</code> <code class="p">{</code> <code class="k">opacity</code><code class="o">:</code> <code class="m">0</code><code class="o">.</code><code class="m">33</code> <code class="p">}</code>
<code class="nt">&lt;/style&gt;</code>

<code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="na">height</code><code class="o">=</code><code class="s">"150"</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">g</code> <code class="na">transform</code><code class="o">=</code><code class="s">"translate(150, 75)"</code><code class="p">&gt;</code>
    <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">cx</code><code class="o">=</code><code class="s">"0"</code> <code class="na">cy</code><code class="o">=</code><code class="s">"-20"</code> <code class="na">r</code><code class="o">=</code><code class="s">"30"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"red"</code><code class="p">/&gt;</code>
    <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">cx</code><code class="o">=</code><code class="s">"17.3"</code> <code class="na">cy</code><code class="o">=</code><code class="s">"10"</code> <code class="na">r</code><code class="o">=</code><code class="s">"30"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"green"</code><code class="p">/&gt;</code>
    <code class="p">&lt;</code><code class="nt">circle</code> <code class="na">cx</code><code class="o">=</code><code class="s">"-17.3"</code> <code class="na">cy</code><code class="o">=</code><code class="s">"10"</code> <code class="na">r</code><code class="o">=</code><code class="s">"30"</code> <code class="na">fill</code><code class="o">=</code><code class="s">"blue"</code><code class="p">/&gt;</code>
  <code class="p">&lt;/</code><code class="nt">g</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code></pre>
<p>The SVG elements demonstrated here were handcoded in HTML, but in data visualization work they are almost always added programmatically. Thus the basic D3 workflow is to add SVG elements to a visualization, using data files to specify their attributes and properties.</p>
<figure><div class="figure" id="svg_transparency">
<img alt="dpj2 0421" height="218" src="assets/dpj2_0421.png" width="346"/>
<h6><span class="label">Figure 4-21. </span>Manipulating opacity with SVG</h6>
</div></figure>
</div></section>
<section data-pdf-bookmark="JavaScripted SVG" data-type="sect2"><div class="sect2" id="idm45607789959296">
<h2>JavaScripted SVG</h2>
<p>The fact that SVG graphics are described by DOM tags has a number of advantages over a black box such as the <code>&lt;canvas&gt;</code> context.<a data-primary="SVG (Scalable Vector Graphics)" data-secondary="JavaScripted" data-type="indexterm" id="idm45607789957024"/><a data-primary="JavaScript" data-secondary="SVG creation via" data-type="indexterm" id="idm45607789956048"/> For example, it allows nonprogrammers to create or adapt graphics and is a boon for debugging.</p>
<p>In web dataviz, pretty much all your SVG elements will be created with JavaScript, through a library such as D3. You can inspect the results of this scripting using the browser’s Elements tab (see <a data-type="xref" href="#chrome_tab">“Chrome DevTools”</a>), which is a great way to refine and debug your work (e.g., nailing an annoying visual glitch).</p>
<p>As a little taster for things to come, let’s use D3 to scatter a few red circles on an SVG canvas. The dimensions of the canvas and circles are contained in a <code>data</code> object sent to a <code>chartCircles</code> function.</p>
<p>We use a little HTML placeholder for the <code>&lt;svg&gt;</code> element:</p>
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>
<code class="p">&lt;</code><code class="nt">meta</code> <code class="na">charset</code><code class="o">=</code><code class="s">"utf-8"</code><code class="p">&gt;</code>

<code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>
  <code class="nf">#chart</code> <code class="p">{</code> <code class="k">background</code><code class="o">:</code> <code class="n">lightgray</code><code class="p">;</code> <code class="p">}</code>
  <code class="nf">#chart</code> <code class="nt">circle</code> <code class="p">{</code><code class="k">fill</code><code class="o">:</code> <code class="nb">red</code><code class="p">}</code>
<code class="nt">&lt;/style&gt;</code>

<code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">svg</code> <code class="na">id</code><code class="o">=</code><code class="s">"chart"</code><code class="p">&gt;&lt;/</code><code class="nt">svg</code><code class="p">&gt;</code>

  <code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"http://d3js.org/d3.v7.min.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
  <code class="p">&lt;</code><code class="nt">script</code> <code class="na">src</code><code class="o">=</code><code class="s">"script.js"</code><code class="p">&gt;&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>
<code class="p">&lt;/</code><code class="nt">body</code><code class="p">&gt;</code></pre>
<p>With our placeholder SVG <code>chart</code> element in place, a little D3 in the <em>script.js</em> file is used to turn some data into the scattered circles (see <a data-type="xref" href="#webdev101_d3_circles">Figure 4-22</a>):</p>
<pre class="pagebreak-before" data-code-language="js" data-type="programlisting"><code class="c1">// script.js
</code><code>
</code><code class="kd">var</code><code> </code><code class="nx">chartCircles</code><code> </code><code class="o">=</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">data</code><code class="p">)</code><code> </code><code class="p">{</code><code>

    </code><code class="kd">var</code><code> </code><code class="nx">chart</code><code> </code><code class="o">=</code><code> </code><code class="nx">d3</code><code class="p">.</code><code class="nx">select</code><code class="p">(</code><code class="s1">'#chart'</code><code class="p">)</code><code class="p">;</code><code>
    </code><code class="c1">// Set the chart height and width from data
</code><code>    </code><code class="nx">chart</code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'height'</code><code class="p">,</code><code> </code><code class="nx">data</code><code class="p">.</code><code class="nx">height</code><code class="p">)</code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'width'</code><code class="p">,</code><code> </code><code class="nx">data</code><code class="p">.</code><code class="nx">width</code><code class="p">)</code><code class="p">;</code><code>
    </code><code class="c1">// Create some circles using the data
</code><code>    </code><code class="nx">chart</code><code class="p">.</code><code class="nx">selectAll</code><code class="p">(</code><code class="s1">'circle'</code><code class="p">)</code><code class="p">.</code><code class="nx">data</code><code class="p">(</code><code class="nx">data</code><code class="p">.</code><code class="nx">circles</code><code class="p">)</code><code>
        </code><code class="p">.</code><code class="nx">enter</code><code class="p">(</code><code class="p">)</code><code>
        </code><code class="p">.</code><code class="nx">append</code><code class="p">(</code><code class="s1">'circle'</code><code class="p">)</code><code>
        </code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'cx'</code><code class="p">,</code><code> </code><code class="kd">function</code><code class="p">(</code><code class="nx">d</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><code class="k">return</code><code> </code><code class="nx">d</code><code class="p">.</code><code class="nx">x</code><code> </code><code class="p">}</code><code class="p">)</code><code>
        </code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'cy'</code><code class="p">,</code><code> </code><code class="nx">d</code><code> </code><code class="o">=&gt;</code><code> </code><code class="nx">d</code><code class="p">.</code><code class="nx">y</code><code class="p">)</code><code> </code><a class="co" href="#callout_webdev_101_CO6-1" id="co_webdev_101_CO6-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a><code>
        </code><code class="p">.</code><code class="nx">attr</code><code class="p">(</code><code class="s1">'r'</code><code class="p">,</code><code> </code><code class="nx">d</code><code> </code><code class="o">=&gt;</code><code> </code><code class="nx">d</code><code class="p">.</code><code class="nx">r</code><code class="p">)</code><code class="p">;</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="kd">var</code><code> </code><code class="nx">data</code><code> </code><code class="o">=</code><code> </code><code class="p">{</code><code>
    </code><code class="nx">width</code><code class="o">:</code><code> </code><code class="mi">300</code><code class="p">,</code><code> </code><code class="nx">height</code><code class="o">:</code><code> </code><code class="mi">150</code><code class="p">,</code><code>
    </code><code class="nx">circles</code><code class="o">:</code><code> </code><code class="p">[</code><code>
        </code><code class="p">{</code><code class="s1">'x'</code><code class="o">:</code><code> </code><code class="mi">50</code><code class="p">,</code><code> </code><code class="s1">'y'</code><code class="o">:</code><code> </code><code class="mi">30</code><code class="p">,</code><code> </code><code class="s1">'r'</code><code class="o">:</code><code> </code><code class="mi">20</code><code class="p">}</code><code class="p">,</code><code>
        </code><code class="p">{</code><code class="s1">'x'</code><code class="o">:</code><code> </code><code class="mi">70</code><code class="p">,</code><code> </code><code class="s1">'y'</code><code class="o">:</code><code> </code><code class="mi">80</code><code class="p">,</code><code> </code><code class="s1">'r'</code><code class="o">:</code><code> </code><code class="mi">10</code><code class="p">}</code><code class="p">,</code><code>
        </code><code class="p">{</code><code class="s1">'x'</code><code class="o">:</code><code> </code><code class="mi">160</code><code class="p">,</code><code> </code><code class="s1">'y'</code><code class="o">:</code><code> </code><code class="mi">60</code><code class="p">,</code><code> </code><code class="s1">'r'</code><code class="o">:</code><code> </code><code class="mi">10</code><code class="p">}</code><code class="p">,</code><code>
        </code><code class="p">{</code><code class="s1">'x'</code><code class="o">:</code><code> </code><code class="mi">200</code><code class="p">,</code><code> </code><code class="s1">'y'</code><code class="o">:</code><code> </code><code class="mi">100</code><code class="p">,</code><code> </code><code class="s1">'r'</code><code class="o">:</code><code> </code><code class="mi">5</code><code class="p">}</code><code class="p">,</code><code>
    </code><code class="p">]</code><code>
</code><code class="p">}</code><code class="p">;</code><code>

</code><code class="nx">chartCircles</code><code class="p">(</code><code class="nx">data</code><code class="p">)</code><code class="p">;</code></pre>
<dl class="calloutlist">
<dt><a class="co" href="#co_webdev_101_CO6-1" id="callout_webdev_101_CO6-1"><img alt="1" height="12" src="assets/1.png" width="12"/></a></dt>
<dd><p>This is the modern shorthand arrow-based anonymous function, equivalent to the long form on the previous line. D3 makes use of a lot of these for accessing the properties of bound data objects, so this new syntax is a big win.</p></dd>
</dl>
<figure><div class="figure" id="webdev101_d3_circles">
<img alt="dpj2 0422" height="214" src="assets/dpj2_0422.png" width="496"/>
<h6><span class="label">Figure 4-22. </span>D3-generated circles</h6>
</div></figure>
<p>We’ll see exactly how D3 works its magic in <a data-type="xref" href="ch17.xhtml#chapter_d3_intro">Chapter 17</a>. For now, let’s summarize what we’ve learned in this chapter.</p>
</div></section>
</div></section>
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="idm45607791369984">
<h1>Summary</h1>
<p>This chapter provided a basic set of modern web-development skills for the budding data visualizer. It showed how the various elements of a web page (HTML, CSS stylesheets, JavaScript, and media files) are delivered by HTTP and, on being received by the browser, combined to become the web page the user sees. We saw how content blocks are described, using HTML tags such as <code>div</code> and <code>p</code>, and then styled and positioned using CSS. We also covered Chrome’s Elements and Sources tabs, which are the key browser development tools.  Finally we had a little  primer in SVG, the language in which most modern web data visualizations are expressed. These skills will be extended when our toolchain reaches its D3 visualization and new ones will be introduced in context.<a data-primary="web development (webdev)" data-secondary="Scalable Vector Graphics" data-startref="ix_webdevSVG" data-type="indexterm" id="idm45607789563968"/><a data-primary="SVG (Scalable Vector Graphics)" data-startref="ix_SVG" data-type="indexterm" id="idm45607789562784"/></p>
</div></section>
<div data-type="footnotes"><p data-type="footnote" id="idm45607793744992"><sup><a href="ch04.xhtml#idm45607793744992-marker">1</a></sup> There are some interesting alternatives to full-blown frameworks currently generating a buzz, such as <a href="https://oreil.ly/daXEB">Alpine.js and htmx</a>, which play well with Python web servers like Django and <a href="https://oreil.ly/3zlEU">Flask</a>.</p><p data-type="footnote" id="idm45607793740624"><sup><a href="ch04.xhtml#idm45607793740624-marker">2</a></sup> I bear the scars so you don’t have to.</p><p data-type="footnote" id="idm45607793670928"><sup><a href="ch04.xhtml#idm45607793670928-marker">3</a></sup> You can code style in HTML tags using the <code>style</code> attribute,  but it’s generally bad practice. It’s better to use classes and ids defined in CSS.</p><p data-type="footnote" id="idm45607793668384"><sup><a href="ch04.xhtml#idm45607793668384-marker">4</a></sup> As demonstrated <a href="https://oreil.ly/MgWtS">by Mike Bostock</a>, with a hat-tip to Paul Irish.</p><p data-type="footnote" id="idm45607792973152"><sup><a href="ch04.xhtml#idm45607792973152-marker">5</a></sup> OpenGL (Open Graphics Language) and its web counterpart WebGL are cross-platform APIs for rendering 2D and 3D vector graphics (see the <a href="https://oreil.ly/eytfV">Wikipedia page</a> for details).</p><p data-type="footnote" id="idm45607792962112"><sup><a href="ch04.xhtml#idm45607792962112-marker">6</a></sup> This is not the same as programmatically setting styles, which is a hugely powerful technique that allows styles to adapt to user interaction.</p><p data-type="footnote" id="idm45607792857568"><sup><a href="ch04.xhtml#idm45607792857568-marker">7</a></sup> This is generally considered bad practice and is usually an indication of poorly structured CSS. Use with extreme caution, as it can make life very difficult for code developers.</p><p data-type="footnote" id="idm45607792772048"><sup><a href="ch04.xhtml#idm45607792772048-marker">8</a></sup> These are succinctly discussed in Douglas Crockford’s famously short <em>JavaScript: The Good Parts</em> (O’Reilly).</p><p data-type="footnote" id="idm45607792668960"><sup><a href="ch04.xhtml#idm45607792668960-marker">9</a></sup> Being able to play with attributes is particularly useful when trying to get Scalable Vector Graphics (SVG) to work.</p><p data-type="footnote" id="idm45607792628480"><sup><a href="ch04.xhtml#idm45607792628480-marker">10</a></sup> Logging is a great way of tracking data flow through your app. I recommend you adopt a consistent approach here.</p><p data-type="footnote" id="idm45607792243232"><sup><a href="ch04.xhtml#idm45607792243232-marker">11</a></sup> Here’s <a href="https://oreil.ly/casbD">a thread showing the many and varied solutions to the problem</a>, none of which could be called elegant.</p><p data-type="footnote" id="idm45607791382032"><sup><a href="ch04.xhtml#idm45607791382032-marker">12</a></sup> With a <code>canvas</code> graphic context, you generally have to contrive your own event <span class="keep-together">handling</span>.</p><p data-type="footnote" id="idm45607791376208"><sup><a href="ch04.xhtml#idm45607791376208-marker">13</a></sup> This number changes with time and the browser in question, but as a rough rule of thumb, SVG often starts to strain in the low thousands.</p><p data-type="footnote" id="idm45607791323968"><sup><a href="ch04.xhtml#idm45607791323968-marker">14</a></sup> You should be able to use your browser’s development tools to see the tag attributes updating in real time.</p><p data-type="footnote" id="idm45607790535824"><sup><a href="ch04.xhtml#idm45607790535824-marker">15</a></sup> <a href="https://oreil.ly/ujCxf">Mike Bostock’s chord diagram</a> is a nice example, and uses D3’s <code>chord</code> function.</p><p data-type="footnote" id="idm45607790321024"><sup><a href="ch04.xhtml#idm45607790321024-marker">16</a></sup> For example, a body group can contain an arm group, which can contain a hand group, which can contain finger elements.</p></div></div></section></div></body></html>