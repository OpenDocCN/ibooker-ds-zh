<html><head></head><body>
<p id="filepos1653100" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Chapter 12. User-Defined Functions (UDFs)</span></span></span></p><p class="calibre_16">The <a/>previous three chapters showed you how to automate Excel with a Python script and how to run such a script from Excel at the click of a button. This chapter introduces user-defined functions (UDFs) as another option to call Python code from Excel with xlwings. UDFs are Python functions that you use in Excel cells in the same way as you use built-in functions like <tt class="calibre6">SUM</tt> or <tt class="calibre6">AVERAGE</tt>. As in the previous chapter, we will start with the <tt class="calibre6">quickstart</tt> command that allows us to try out a first UDF in no time. We then move on to a case study about fetching and processing data from Google Trends as an excuse to work with more complex UDFs: we’ll learn how to work with pandas DataFrames and plots as well as how to debug UDFs. To conclude this chapter, we’ll dig into a few advanced topics with a focus on performance. Unfortunately, xlwings doesn’t support UDFs on macOS, which makes this chapter the only chapter requiring you to run the samples on Windows.<a id="filepos1654281"/><a href="#filepos1810019"><span class="calibre5"><span class="calibre_7">1</span></span></a></p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">A NOTE FOR MACOS AND LINUX USERS</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">Even if you are not on Windows, you may still want to have a look at the Google Trends case study as you could easily adapt it to work with a </span><span class="calibre5"><tt class="calibre6">RunPython</tt></span><span class="calibre5"> call on macOS. You could also produce a report by using one of the writer libraries from </span><a href="index_split_020.html#filepos959867"><span class="calibre5"><span class="calibre_7">Chapter 8</span></span></a><span class="calibre5">, which even works on Linux.</span></blockquote><p id="filepos1655019" class="calibre_30"><span class="calibre3"><span class="bold"><span class="calibre_7">Getting Started with UDFs</span></span></span></p><p class="calibre_6">This <a id="filepos1655193"/>section starts with the prerequisites for writing UDFs before we can use the <tt class="calibre6">quickstart</tt> command to run our first UDF. To follow along with the examples in this chapter, you’ll need the xlwings add-in installed and have the Excel option “Trust access to the VBA project object mode” enabled:</p><p class="calibre_6"><span class="italic">Add-in</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">I assume you have the xlwings add-in installed as explained in <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>. This is not a hard requirement, though: while it makes development easy, especially to click the Import Functions button, it is not required for deployment and can be replaced by setting the workbook up in the standalone mode—for the details, see <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>.</blockquote></blockquote><p class="calibre_20"><span class="italic">Trust access to the VBA project object model</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">To be able to write your first UDFs, you will need to change a setting in Excel: go to File &gt; Options &gt; Trust Center &gt; Trust Center Settings &gt; Macro Settings and activate the checkbox to “Trust access to the VBA project object model,” as in <a href="#filepos1656979"><span class="calibre_7">Figure 12-1</span></a>. This enables xlwings to automatically insert a VBA module into your workbook when you click the Import Functions button in the add-in, as we’ll see shortly. Since you only rely on this setting during the import process, you should look at it as a developer setting that end users don’t need to be concerned about.</blockquote><a id="filepos1656916"/></blockquote><p class="calibre_3"><img src="images/00048.jpg" id="filepos1656979" class="calibre_117"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-1. Trust access to the VBA project object model</span></span></span></p><p class="calibre_24">With these two prerequisites in place, you’re ready to run your first UDF!</p><p id="filepos1657338" class="calibre_17"><span class="calibre3"><span class="bold">UDF Quickstart</span></span></p><p class="calibre_6">As usual, <a id="filepos1657477"/>the easiest way to get off the ground is to use the <tt class="calibre6">quickstart</tt> command. Before you run the following on an Anaconda Prompt, make sure to change into the directory of your choice via the <tt class="calibre6">cd</tt> command. For example, if you are in your home directory and want to change to the desktop, run <tt class="calibre6">cd Desktop</tt> first:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings quickstart first_udf</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">Navigate to the <span class="italic">first_udf</span> folder in the File Explorer and open <span class="italic">first_udf.xlsm</span> in Excel and <span class="italic">first_udf.py</span> in VS Code. Then, in the xlwings ribbon add-in, click the Import Functions button. By default, this is a silent action, i.e., you will only see something in case of an error. However, if you activate the checkbox Show Console in the Excel add-in and click the Import Functions button again, a Command Prompt opens and prints the following:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">xlwings server running [...]<br class="calibre1"/>Imported functions from the following modules: first_udf</tt></span></blockquote><p class="calibre_32">The first line prints a few more details that we can ignore, though—the important part is that once this line is printed, Python is up and running. The second line confirms that it imported the functions from the <tt class="calibre6">first_udf</tt> module correctly. Now type <tt class="calibre6"><span class="bold">=hello("xlwings")</span></tt> into cell A1 of the active sheet in <span class="italic">first_udf.xlsm</span> and after hitting Enter, you will see the formula evaluated as shown in <a href="#filepos1659317"><span class="calibre_7">Figure 12-2</span></a>.</p><p class="calibre_21"><img src="images/00055.jpg" id="filepos1659317" class="calibre_118"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-2. first_udf.xlsm</span></span></span></p><p class="calibre_24">Let’s break this down to see how everything works: start by looking at the <tt class="calibre6">hello</tt> function in <span class="italic">first_udf.py</span> (<a href="#filepos1659850"><span class="calibre_7">Example 12-1</span></a>), which is the part of the <tt class="calibre6">quickstart</tt> code that we’ve<a id="filepos1659823"/> ignored so far.</p><p id="filepos1659850" class="calibre_6"><span class="italic">Example 12-1. first_udf.py (excerpt)</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello {name}!"</span></tt></span></p><p class="calibre_24">Every function that you mark with <tt class="calibre6">@xw.func</tt> will get imported into Excel when you click on Import Functions in the xlwings add-in. Importing a function makes it available in Excel so you can use it in your cell formulas—we’ll get to the technical details in a moment. <tt class="calibre6">@xw.func</tt> is a <span class="italic">decorator</span>, which means that you have to place it directly on top of the function definition. If you want to know a bit more about how decorators work, have a look at the sidebar.</p><blockquote class="calibre_39"><span class="bold">FUNCTION DECORATORS</span></blockquote><blockquote class="calibre_27">A decorator<a id="filepos1661857"/> is a function name that you put on top of a function definition, starting with the <tt class="calibre6">@</tt> sign. It’s a simple way to change the behavior of a function and is used by xlwings to recognize which functions you want to make available in Excel. To help you understand how a decorator works, the following example shows the definition of a decorator called <tt class="calibre6">verbose</tt> that will print some text before and after the function <tt class="calibre6">print_hello</tt> is run. Technically, the decorator takes the function (<tt class="calibre6">print_hello</tt>) and provides it as argument <tt class="calibre6">func</tt> to the <tt class="calibre6">verbose</tt> function. The inner function called <tt class="calibre6">wrapper</tt> can then do whatever needs to be done; in this case, it prints a value before and after calling the <tt class="calibre6">print_hello</tt> function. The name of the inner function doesn’t matter:</blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># This is the definition of the function decorator</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">verbose</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">func</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">wrapper</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">():</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Before calling the function."</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">func</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"After calling the function."</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">wrapper</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Using a function decorator</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@verbose</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">print_hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">():</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"hello!"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Effect of calling the decorated function</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">print_hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Before calling the function.<br class="calibre1"/>hello!<br class="calibre1"/>After calling the function.</tt></span></blockquote><blockquote class="calibre_31">At the end of this chapter, you’ll find <a href="#filepos1801916"><span class="calibre_7">Table 12-1</span></a> with a summary of all decorators that xlwings offers.</blockquote><p class="calibre_17">By default, if the function arguments are cell ranges, xlwings delivers you the values of these cell ranges instead of the xlwings <tt class="calibre6">range</tt> object. In the vast majority of cases, this is very convenient and allows you to call the <tt class="calibre6">hello</tt> function with a cell as argument. For example, you could write “xlwings” into cell A2, then change the formula in A1 into the following:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">A2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">The result will be the same as in <a href="#filepos1659317"><span class="calibre_7">Figure 12-2</span></a>. I will show you in the last section of this chapter how to change this behavior and make the arguments arrive as xlwings <tt class="calibre6">range</tt> objects instead—as we will see then, there are occasions where you will need this. In VBA, the equivalent <tt class="calibre6">hello</tt> function would look like this:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Function</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">String</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">String</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">hello</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello "</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"!"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">End</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Function</span></span></tt></span></blockquote><p class="calibre_32">When you click the Import Functions button in the add-in, xlwings inserts a VBA module called <tt class="calibre6">xlwings_udfs</tt> into your Excel workbook. It contains a VBA function for each Python function you import: these<a id="filepos1670563"/> wrapper VBA functions take care of running the respective function in Python. While nobody stops you from looking at the <tt class="calibre6">xlwings_udfs</tt> VBA module by opening the VBA editor with Alt+F11, you can ignore it as the code is autogenerated and any changes would get lost when you click the Import Functions button again. Let’s now play around with our <tt class="calibre6">hello</tt> function in <span class="italic">first_udf.py</span> and replace <tt class="calibre6">Hello</tt> in the return value with <tt class="calibre6">Bye</tt>:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Bye {name}!"</span></tt></span></blockquote><p class="calibre_32">To recalculate the<a id="filepos1671914"/> function in Excel, either double-click the cell A1 to edit the formula (or select the cell and press F2 to activate the edit mode), then hit Enter. Alternatively, type the keyboard shortcut Ctrl+Alt+F9: this will <span class="italic">force</span> the recalculation of all worksheets in all open workbooks including the <tt class="calibre6">hello</tt> formula. Note that F9 (recalculate all worksheets in all open workbooks) or Shift+F9 (recalculate the active worksheet) will not recalculate the UDF as Excel only triggers a recalculation of UDFs if a dependent cell changed. To change this behavior, you could make the function <span class="italic">volatile</span> by adding the respective argument to the <tt class="calibre6">func</tt> decorator:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">volatile</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Bye {name}!"</span></tt></span></blockquote><p class="calibre_32">Volatile functions <a id="filepos1673786"/>are evaluated every time Excel performs a recalculation—whether or not the function’s dependencies have changed. A few of Excel’s built-in functions are volatile like <tt class="calibre6">=RAND()</tt> or <tt class="calibre6">=NOW()</tt> and using lots of them will make your workbook slower, so don’t overdo it. When you change a function’s name or arguments or the <tt class="calibre6">func</tt> decorator as we just did, you will need to reimport your function by clicking the Import Functions button again: this will restart the Python interpreter before importing the updated function. When you now change the function back from <tt class="calibre6">Bye</tt> to <tt class="calibre6">Hello</tt>, it is enough to use the keyboard shortcuts Shift+F9 or F9 to cause the formula to recalculate as the function is now volatile.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">SAVE THE PYTHON FILE AFTER CHANGING IT</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">A common gotcha is forgetting to save the Python source file after making changes. Therefore, always double-check that the Python file is saved before hitting the Import Functions button or recalculating the UDFs in Excel.</span><a id="filepos1674980"/></blockquote><p class="calibre_16">By default, xlwings imports functions from a Python file in the same directory with the same name as the Excel file. Renaming and moving your Python source file requires similar changes as in <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>, when we were doing the same with <tt class="calibre6">RunPython</tt> calls: go ahead and rename the file from <span class="italic">first_udf.py</span> to <span class="italic">hello.py</span>. To let xlwings know about that change, add the name of the module, i.e., <tt class="calibre6">hello</tt> (without the <span class="italic">.py</span> extension!) to UDF Modules in the xlwings add-in, as shown in <a href="#filepos1675723"><span class="calibre_7">Figure 12-3</span></a>.</p><p class="calibre_21"><img src="images/00065.jpg" id="filepos1675723" class="calibre_119"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-3. The UDF Modules setting</span></span></span></p><p class="calibre_24">Click the Import Functions button to reimport the function. Then recalculate the formula in Excel to be sure everything still works.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">IMPORT FUNCTIONS FROM MULTIPLE PYTHON MODULES</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">If you want to import functions from multiple modules, use a semicolon between their names in the UDF Modules setting, e.g., </span><span class="calibre5"><tt class="calibre6">hello;another_module</tt></span><span class="calibre5">.</span></blockquote><p class="calibre_16">Now go ahead and move <span class="italic">hello.py</span> to your desktop: this requires you to add the path of your desktop to the <tt class="calibre6">PYTHONPATH</tt> in the<a id="filepos1676726"/> xlwings add-in. As seen in <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>, you could use environment variables to achieve this, i.e., you could set the <tt class="calibre6">PYTHONPATH</tt> setting in the add-in to <span class="italic">%USERPROFILE%\Desktop</span>. If you still have the path to the <span class="italic">pyscripts</span> folder in there from <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>, either overwrite it or leave it in there, separating the paths with a semicolon. After these changes, click the Import Functions button again, then recalculate the function in Excel to verify that everything still works.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">CONFIGURATION AND DEPLOYMENT</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">In this chapter, I am always referring to changing a setting in the add-in; however, everything from </span><a href="index_split_026.html#filepos1439732"><span class="calibre5"><span class="calibre_7">Chapter 10</span></span></a><span class="calibre5"> with regard to configuration and deployment can be applied to this chapter too. This means that a setting could also be changed in the xlwings.conf sheet or a config file sitting in the same directory as the Excel file. And instead of using the xlwings add-in, you could use a workbook that has been set up in the standalone mode. With UDFs, it also makes sense to build your own custom add-in—this allows you to share your UDFs among all workbooks without having to import them into each workbook. For more information about building your own custom add-in, see the </span><a id="filepos1678327"/><a href="https://oreil.ly/uNo0g"><span class="calibre5"><span class="calibre_7">xlwings docs</span></span></a><span class="calibre5">.</span></blockquote><p class="calibre_16">If you change the Python code of your UDF, xlwings automatically picks up the changes whenever you save the Python file. As mentioned, you only need to reimport your UDFs if you change something in the function’s name, arguments, or decorators. If, however, your source file imports code from other modules, and you change something in these modules, the easiest way to let Excel pick up all changes is to click on Restart UDF Server.</p><p class="calibre_6">At this point, you know how to <a id="filepos1679023"/>write a simple UDF in Python and how to use it in Excel. The case study in the next section will introduce you to more realistic UDFs that make use of pandas DataFrames.</p><p id="filepos1679203" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Case Study: Google Trends</span></span></span></p><p class="calibre_6">In this case study, we’ll use data from Google Trends to learn how to work with pandas DataFrames and dynamic arrays, one of the most exciting new features in Excel that Microsoft officially launched in 2020. We then create a UDF that connects directly to Google Trends as well as one that uses a DataFrame’s <tt class="calibre6">plot</tt> method. To wrap this section up, we’ll have a look at how debugging works with UDFs. Let’s get started with a short introduction to Google Trends!</p><p id="filepos1679853" class="calibre_17"><span class="calibre3"><span class="bold">Introduction to Google Trends</span></span></p><p class="calibre_6"><a href="https://oreil.ly/G6TpC"><span class="calibre_7">Google Trends</span></a> is a <a id="filepos1680082"/>Google service that allows you to analyze the popularity of Google search queries over time and across regions. <a href="#filepos1681064"><span class="calibre_7">Figure 12-4</span></a> shows Google Trends after adding a few popular programming languages, selecting Worldwide as the region and 1/1/16 - 12/26/20 as the time range. Each search term has been selected with the <span class="italic">Programming language</span> context that appears in a drop-down after typing in the search term. This makes sure that we ignore Python, the snake, and Java, the island. Google indexes the data within the selected timeframe and location with 100 representing the maximum search interest. In our sample, it means that within the given timeframe and location, the highest search interest was in Java in February 2016. For more details about Google Trends, have a look at their official <a href="https://oreil.ly/_aw8f"><span class="calibre_7">blog post</span></a>.</p><p class="calibre_21"><img src="images/00070.jpg" id="filepos1681064" class="calibre_120"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-4. Interest over time; data source </span></span></span><a href="https://oreil.ly/SR8zD"><span class="calibre5"><span class="italic"><span class="calibre_7">Google Trends</span></span></span></a></p><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">RANDOM SAMPLES</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">Google Trends numbers are based on random samples, which means that you may see a picture that is slightly different from </span><a href="#filepos1681064"><span class="calibre5"><span class="calibre_7">Figure 12-4</span></span></a><span class="calibre5"> even if you use the same location, timeframe, and search terms as on the screenshot.</span></blockquote><p class="calibre_16">I hit the download button that you see in <a href="#filepos1681064"><span class="calibre_7">Figure 12-4</span></a> to get a CSV file from where I copied the data into the Excel workbook of a <tt class="calibre6">quickstart</tt> project. In the next section, I’ll show you where to find this workbook—we will use it to analyze the data with a UDF right from<a id="filepos1682295"/> within Excel!</p><p id="filepos1682320" class="calibre_17"><span class="calibre3"><span class="bold">Working with DataFrames and Dynamic Arrays</span></span></p><p class="calibre_6">Having it<a id="filepos1682486"/> made this far in the book, you shouldn’t be surprised that pandas DataFrames are also a UDF’s best friend. To see how DataFrames and UDFs work together and to learn about dynamic arrays, navigate to the <span class="italic">describe</span> folder in the <span class="italic">udfs</span> directory of the companion repository and open <span class="italic">describe.xlsm</span> in Excel and <span class="italic">describe.py</span> in VS Code. The Excel file contains the data from Google Trends and in the Python file, you’ll find a simple function to start with, <a id="filepos1682978"/>as shown in <a href="#filepos1683070"><span class="calibre_7">Example 12-2</span></a>.</p><p id="filepos1683070" class="calibre_6"><span class="italic">Example 12-2. describe.py</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"df"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">header</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></p><p class="calibre_24">Compared to the <tt class="calibre6">hello</tt> function from the <tt class="calibre6">quickstart</tt> project, you’ll notice a second decorator:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"df"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">header</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32"><tt class="calibre6">arg</tt> is short <a id="filepos1687455"/>for <span class="italic">argument</span> and allows you to apply the same converters and options as I was using in <a href="index_split_024.html#filepos1235764"><span class="calibre_7">Chapter 9</span></a> when I was introducing the xlwings syntax. In other words, the decorator offers the same functionality for UDFs as the <tt class="calibre6">options</tt> method for xlwings <tt class="calibre6">range</tt> objects. Formally, this is the syntax of the <tt class="calibre6">arg</tt> decorator:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"argument_name"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">convert</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">option1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">option2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">...</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">To help you make the connection back to <a href="index_split_024.html#filepos1235764"><span class="calibre_7">Chapter 9</span></a>, the equivalent of the <tt class="calibre6">describe</tt> function in the form of a script looks like this (this assumes that <span class="italic">describe.xlsm</span> is open in Excel and that the function is applied to the range A3:F263):</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">data_range</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">xw</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Book</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"describe.xlsm"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheets</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">][</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A3:F263"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">data_range</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">options</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">header</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><p class="calibre_32">The options <tt class="calibre6">index</tt> and <tt class="calibre6">header</tt> wouldn’t be required as they are using the default arguments, but I included them to show you how they are applied with UDFs. With <span class="italic">describe.xlsm</span> as your active workbook, click the Import Functions button, then type <tt class="calibre6"><span class="bold">=describe(A3:F263)</span></tt> in a free cell, in H3, for example. What happens when you hit Enter depends on your version of Excel—more specifically if your version of Excel is recent enough to support <span class="italic">dynamic arrays</span>. If it does, you will see the situation as shown in <a href="#filepos1694433"><span class="calibre_7">Figure 12-5</span></a>, i.e., the output of the <tt class="calibre6">describe</tt> function in cells H3:M11 is surrounded by a thin blue border. You will only be able to see the blue border if your cursor is within the array, and it is so subtle that you may have issues seeing it clearly if you look at the screenshot in a printed version of the book. We’ll see how dynamic arrays behave in a moment and you can also learn more about them in the sidebar <a href="#filepos1711844"><span class="calibre_7">“Dynamic Arrays”</span></a>.</p><p class="calibre_21"><img src="images/00078.jpg" id="filepos1694433" class="calibre_121"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-5. The </span></span></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_15">describe</span></span></tt></span><span class="calibre5"><span class="italic"><span class="calibre_15"> function with dynamic arrays</span></span></span></p><p class="calibre_24">If, however, you are using a version of Excel that doesn’t support dynamic arrays, it will look as if nothing is happening: by default, the formula will only return the top-left cell in H3, which is empty. To fix this, use what Microsoft nowadays calls <a id="filepos1695089"/>legacy <span class="italic">CSE arrays</span>. CSE Arrays need to be confirmed by typing the Ctrl+Shift+Enter key combination instead of hitting just Enter—hence their name. Let’s see how they work in detail:</p><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Make sure that H3 is an empty cell by selecting it and hitting the Delete key.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Select the output range by starting in cell H3, and then select all cells on the way to M11.</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">With the range H3:M11 selected, type in the formula <tt class="calibre6"><span class="bold">=describe(A3:F263)</span></tt>, and then confirm by hitting Ctrl+Shift+Enter.</blockquote></blockquote></blockquote></blockquote></li></ul><p class="calibre_14">You should now see almost the same picture as in <a href="#filepos1694433"><span class="calibre_7">Figure 12-5</span></a> with these differences:</p><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">There is no blue border around the range H3:M11.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">The formula shows curly braces around it to mark it as a CSE array: <tt class="calibre6">{=describe(A3:F263)}</tt>.</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">While you delete dynamic arrays by going to the top-left cell and hitting the Delete key, with CSE arrays, you always have to select the whole array first to be able to delete it.</blockquote></blockquote></blockquote></blockquote></li></ul><p class="calibre_14">Let’s now make our function slightly more useful by introducing an optional parameter called <tt class="calibre6">selection</tt> that will allow us to specify which columns we want to include in our output. If you have a lot of columns and only want to include a subset in the <tt class="calibre6">describe</tt> function, this can become a useful feature. Change the function as follows:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"df"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">selection</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00039.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">selection</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">is</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">not</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">loc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[:,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">selection</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00050.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">else</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><p class="calibre_17"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">I left off the <tt class="calibre6">index</tt> and <tt class="calibre6">header</tt> arguments, as they are using the defaults, but feel free to leave them in.</blockquote></blockquote><p class="calibre_20"><img src="images/00039.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">Add the parameter <tt class="calibre6">selection</tt> and make it optional by assigning <tt class="calibre6">None</tt> as its default value.</blockquote></blockquote><p class="calibre_20"><img src="images/00050.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">If <tt class="calibre6">selection</tt> is provided, filter the DataFrame’s columns based on it.</blockquote></blockquote><p class="calibre_16">Once you have changed the function, make sure to save it, and then hit the Import Functions button in the xlwings add-in—this is required since we have added a new parameter. Write <tt class="calibre6"><span class="bold">Selection</span></tt> into cell A2 and <tt class="calibre6"><span class="bold">TRUE</span></tt> into cells B2:F2. Finally, adjust your formula in cell H3 depending on whether you have dynamic arrays or not:</p><p class="calibre_6"><span class="italic">With dynamic arrays</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">Select H3, then change the formula to <tt class="calibre6"><span class="bold">=describe(A3:F263, B2:F2)</span></tt> and hit Enter.</blockquote></blockquote><p class="calibre_20"><span class="italic">Without dynamic arrays</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">Starting at cell H3, select H3:M11, and then hit F2 to activate the edit mode of cell H3 and change the formula to <tt class="calibre6"><span class="bold">=describe(A3:F263, B2:F2)</span></tt>. To finalize, hit Ctrl+Shift+Enter.</blockquote></blockquote><p class="calibre_16">To try out the enhanced function, let’s change Java’s <tt class="calibre6">TRUE</tt> in cell E2 to <tt class="calibre6">FALSE</tt> and see what happens: with dynamic arrays, you will see the table magically shrink by one column. With legacy CSE arrays, however, you will end up with an ugly column full of <tt class="calibre6">#N/A</tt> values, as shown in <a href="#filepos1708195"><span class="calibre_7">Figure 12-6</span></a>.</p><p class="calibre_6">To work around this issue, xlwings can resize legacy CSE arrays by making use of the return decorator. Add it by changing your function like this:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"df"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.ret</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">expand</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"table"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">selection</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">selection</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">is</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">not</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">loc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[:,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">selection</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">else</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">describe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><p class="calibre_17"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">By adding the return decorator with the option <tt class="calibre6">expand="table"</tt>, xlwings will resize the CSE array to match the dimensions of the returned DataFrame.</blockquote></blockquote><p class="calibre_3"><img src="images/00003.jpg" id="filepos1708195" class="calibre_122"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-6. Dynamic arrays (top) vs. CSE arrays (bottom) after excluding a column</span></span></span></p><p class="calibre_24">After adding the return decorator, save the Python source file, switch over to Excel, and hit Ctrl+Alt+F9 to recalculate: this will resize the CSE array and remove the <tt class="calibre6">#N/A</tt> column. Since this is a workaround, I highly recommend you do whatever is in your power to get your hands on a version of Excel that supports dynamic arrays.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">ORDER OF FUNCTION DECORATORS</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">Make sure to place the </span><a id="filepos1709067"/><span class="calibre5"><tt class="calibre6">xw.func</tt></span><span class="calibre5"> decorator on top of the </span><span class="calibre5"><tt class="calibre6">xw.arg</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">xw.ret</tt></span><span class="calibre5"> decorators; note that the order of </span><span class="calibre5"><tt class="calibre6">xw.arg</tt></span><span class="calibre5"> and </span><span class="calibre5"><tt class="calibre6">xw.ret</tt></span><span class="calibre5"> doesn’t matter.</span></blockquote><p class="calibre_16">The <span class="italic">return decorator</span> works <a id="filepos1709547"/>conceptually the same way as the argument decorator, with the only difference that you don’t have to specify the name of an argument. Formally, its syntax looks like this:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.ret</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">convert</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">option1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">option2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">...</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">You usually don’t have to provide an explicit <tt class="calibre6">convert</tt> argument as xlwings recognizes the type of the return value automatically—that’s the same behavior we saw in <a href="index_split_024.html#filepos1235764"><span class="calibre_7">Chapter 9</span></a> with the <tt class="calibre6">options</tt> method when writing values to Excel.</p><p class="calibre_6">As an example, if you want to suppress the index of the DataFrame you return, use this decorator:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.ret</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">index</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">False</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote id="filepos1711844" class="calibre_25"><span class="bold">DYNAMIC ARRAYS</span></blockquote><blockquote class="calibre_27">Having seen how dynamic arrays work in the context of the <tt class="calibre6">describe</tt> function, I am pretty sure you’d agree that they are one of the most fundamental and exciting additions to Excel that Microsoft has come up with in a long time. They were officially introduced in 2020 to Microsoft 365 subscribers who are using the most recent version of Excel. To see if your version is recent enough, check for the existence of the <a id="filepos1712408"/>new <tt class="calibre6">UNIQUE</tt> function: start typing <tt class="calibre6"><span class="bold">=UNIQUE</span></tt> in a cell and if Excel suggests the function name, dynamic arrays are supported. If you use Excel with a permanent license rather than as part of the Microsoft 365 subscription, you are likely to get it with the version that was announced for release in 2021 and that will presumably be called Office 2021. Here are a few technical notes about the behavior of dynamic arrays:</blockquote><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">If dynamic arrays overwrite a cell with a value, you will get a <tt class="calibre6">#SPILL!</tt> error. After making room for the dynamic array by deleting or moving the cell that is in the way, the array will be written out. Note that the xlwings return decorator with <tt class="calibre6">expand="table"</tt> is less smart and will overwrite existing cell values without warning!</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">You can refer to the range of a dynamic array by using the top-left cell followed by a <tt class="calibre6">#</tt> sign. For example, if your dynamic array is in the range A1:B2 and you wanted to sum up all cells, write <tt class="calibre6"><span class="bold">=SUM(A1#)</span></tt>.</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">If you ever want your arrays to behave like the legacy CSE arrays again, start your formula with an <tt class="calibre6">@</tt> sign, e.g., to have a matrix multiplication return a legacy CSE array, use <tt class="calibre6"><span class="bold">=@MMULT()</span></tt>.</blockquote></blockquote></blockquote></blockquote></li></ul><p class="calibre_16">Downloading a CSV file and copy/pasting the values into an Excel file worked fine for this introductory DataFrame example, but copy/paste is such an error-prone process that<a id="filepos1714516"/> you’ll want to get rid of it whenever you can. With Google Trends, you can indeed, and the next section shows you how!</p><p id="filepos1714648" class="calibre_17"><span class="calibre3"><span class="bold">Fetching Data from Google Trends</span></span></p><p class="calibre_6">The<a id="filepos1714798"/> previous examples were all very simple, pretty much just wrapping a single pandas function. To get our hands on a more real-world case, let’s create a UDF that downloads the data directly from Google Trends so you don’t have to go online and download a CSV file manually anymore. Google Trends doesn’t have an official API (application programming interface), but there is a Python package <a id="filepos1715202"/>called <a href="https://oreil.ly/SvnLl"><span class="calibre_7">pytrends</span></a> that fills the gap. Not being an official API means that Google can change it anytime they want, so there is a risk that the examples in this section will stop working at some point. However, given that pytrends has been around for more than five years at the time of this writing, there’s also a real chance that it will be updated to reflect the changes and make it work again. In any case, it serves as a good example to show you that <span class="italic">there’s a Python package for just about anything</span>—a claim I made in <a href="index_split_007.html#filepos32075"><span class="calibre_7">Chapter 1</span></a>. If you were restricted to using Power Query, you’d probably need to invest a lot more time to get something working—I, at least, wasn’t able to find a plug-and-play solution that is available for free. Since pytrends isn’t part of Anaconda and also doesn’t have an official Conda package, let’s install it with pip, if you haven’t done this yet:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">pip install pytrends</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">To replicate the exact case from the online version of Google Trends as shown in <a href="#filepos1681064"><span class="calibre_7">Figure 12-4</span></a>, we’ll need to find the correct identifiers for the search terms with the “Programming language” context. To do this, pytrends can print the different search contexts or <span class="italic">types</span> that Google Trends suggests in the dropdown. In the following code sample, <tt class="calibre6">mid</tt> stands for <span class="italic">Machine ID</span>, which is the ID we are looking for:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pytrends.request</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">TrendReq</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># First, let's instantiate a TrendRequest object</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">trend</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">TrendReq</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">6</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Now we can print the suggestions as they would appear</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># online in the dropdown of Google Trends after typing in "Python"</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">trend</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">suggestions</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Python"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[6]: [{'mid': '/m/05z1_', 'title': 'Python', 'type': 'Programming language'},<br class="calibre1"/>         {'mid': '/m/05tb5', 'title': 'Python family', 'type': 'Snake'},<br class="calibre1"/>         {'mid': '/m/0cv6_m', 'title': 'Pythons', 'type': 'Snake'},<br class="calibre1"/>         {'mid': '/m/06bxxb', 'title': 'CPython', 'type': 'Topic'},<br class="calibre1"/>         {'mid': '/g/1q6j3gsvm', 'title': 'python', 'type': 'Topic'}]</tt></span></blockquote><p class="calibre_32">Repeating this for the other programming languages allows us to retrieve the correct <tt class="calibre6">mid</tt> for all of them, and we can write the UDF as shown in <a href="#filepos1720656"><span class="calibre_7">Example 12-3</span></a>. You’ll find the source code in the <span class="italic">google_trends</span> directory within the <span class="italic">udfs</span> folder of the companion repository.</p><p id="filepos1720656" class="calibre_6"><span class="italic">Example 12-3. The </span><tt class="calibre6"><span class="italic">get_interest_over_time</span></tt><span class="italic"> function in google_trends.py (excerpt with the relevant import statements)</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pytrends.request</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">TrendReq</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">call_in_wizard</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">False</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"mids"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">doc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Machine IDs: A range of max 5 cells"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00039.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"start_date"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">doc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A date-formatted cell"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"end_date"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">doc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A date-formatted cell"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">get_interest_over_time</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">start_date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">end_date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_38">"""Query Google Trends - replaces the Machine ID (mid) of<br class="calibre1"/>    common programming languages with their human-readable<br class="calibre1"/>    equivalent in the return value, e.g., instead of "/m/05z1_"<br class="calibre1"/>    it returns "Python".<br class="calibre1"/>    """</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00050.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Check and transform parameters</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">assert</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">len</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&lt;=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Too many mids (max: 5)"</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00067.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">start_date</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">start_date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">isoformat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00058.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">end_date</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">end_date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">isoformat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Make the Google Trends request and return the DataFrame</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">trend</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">TrendReq</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timeout</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00082.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">trend</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">build_payload</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">kw_list</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timeframe</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"{start_date} {end_date}"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00076.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">trend</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">interest_over_time</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00007.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Replace Google's "mid" with a human-readable word</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">{</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"/m/05z1_"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Python"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"/m/02p97"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"JavaScript"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"/m/0jgqg"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"C++"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"/m/07sbkfb"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Java"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"/m/060kv"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"PHP"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">}</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">rename</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">columns</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00015.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Drop the isPartial column</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">drop</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">columns</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"isPartial"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00020.jpg" class="calibre_65"/></p><p class="calibre_32"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">By default, Excel calls the function when you open it in the Function Wizard. As this can make it slow, especially with API requests involved, we’re switching this off.</blockquote><a id="filepos1735053"/></blockquote><p class="calibre_20"><img src="images/00039.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">Optionally, add a docstring for the function argument, which will be shown in the Function Wizard when you edit the respective argument, as in <a href="#filepos1740246"><span class="calibre_7">Figure 12-8</span></a>.</blockquote></blockquote><p class="calibre_20"><img src="images/00050.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The function’s docstring is displayed in the Function Wizard, as in <a href="#filepos1740246"><span class="calibre_7">Figure 12-8</span></a>.</blockquote></blockquote><p class="calibre_20"><img src="images/00067.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The <tt class="calibre6">assert</tt> statement is an easy way to raise an error in case the user provides too many <tt class="calibre6">mids</tt>. Google Trends allows a maximum of five <tt class="calibre6">mids</tt> per query.</blockquote></blockquote><p class="calibre_20"><img src="images/00058.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">pytrends expects the start and end dates as a single string in the form <tt class="calibre6">YYYY-MM-DD YYYY-MM-DD</tt>. As we are providing the start and end dates as date-formatted cells, they will arrive as <tt class="calibre6">datetime</tt> objects. Calling the <tt class="calibre6">date</tt> and <tt class="calibre6">isoformat</tt> methods on them will format them properly.</blockquote></blockquote><p class="calibre_20"><img src="images/00082.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">We’re instantiating a pytrends <tt class="calibre6">request</tt> object. By setting the <tt class="calibre6">timeout</tt> to ten seconds, we reduce the risk of seeing a <tt class="calibre6">requests.exceptions.ReadTimeout</tt> error, which occasionally happens if Google Trends takes a bit longer to respond. If you still see this error, simply run the function again or increase the timeout.</blockquote></blockquote><p class="calibre_20"><img src="images/00076.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">We provide the <tt class="calibre6">kw_list</tt> and <tt class="calibre6">timeframe</tt> arguments to the request object.</blockquote></blockquote><p class="calibre_20"><img src="images/00007.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">We make the actual request by calling <tt class="calibre6">interest_over_time</tt>, which will return a pandas DataFrame.</blockquote></blockquote><p class="calibre_20"><img src="images/00015.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">We rename the <tt class="calibre6">mids</tt> with their human-readable equivalent.</blockquote></blockquote><p class="calibre_20"><img src="images/00020.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The last column is called <tt class="calibre6">isPartial</tt>. <tt class="calibre6">True</tt> indicates that the current interval, e.g., a week, is still ongoing and therefore doesn’t have all data yet. To keep things simple and to be in line with the online version, we’re dropping this column when returning the DataFrame.</blockquote><a id="filepos1738598"/></blockquote><p class="calibre_16">Now open <span class="italic">google_trends.xlsm</span> from the companion repository, click on Import Functions in the xlwings add-in, and then call the <tt class="calibre6">get_interest_over_time</tt> function from cell A4, as shown in <a href="#filepos1738974"><span class="calibre_7">Figure 12-7</span></a>.</p><p class="calibre_21"><img src="images/00009.jpg" id="filepos1738974" class="calibre_123"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-7. google_trends.xlsm</span></span></span></p><p class="calibre_24">To get help with regard to the function arguments, click the Insert Function button to the left of the formula bar while cell A4 is selected: this will open the Function Wizard where you will find your UDFs under the <tt class="calibre6">xlwings</tt> category. After selecting <tt class="calibre6">get_interest_over_time</tt>, you’ll see the name of the function arguments as well as the docstring as function description (restricted to the first 256 characters): see <a href="#filepos1740246"><span class="calibre_7">Figure 12-8</span></a>. Alternatively, start typing <tt class="calibre6"><span class="bold">=get_interest_over_time(</span></tt> into cell A4 (including the opening parenthesis) before hitting the Insert Function button—this will take you directly to the view shown in <a href="#filepos1740246"><span class="calibre_7">Figure 12-8</span></a>. Note that UDFs return the dates unformatted. To fix this, right-click on the column with the dates, select Format Cells, and then select the format of your choice under the Date category.</p><p class="calibre_21"><img src="images/00017.jpg" id="filepos1740246" class="calibre_124"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-8. The Function Wizard</span></span></span></p><p class="calibre_24">If you look closely at <a href="#filepos1738974"><span class="calibre_7">Figure 12-7</span></a>, you can tell by the blue border around the result array that I am using dynamic arrays again. As the screenshot is cropped at the bottom and the array starts at the very left, you only see the top and right borders starting at cell A4, and even they might be hard to recognize on the screenshot. If your version of Excel doesn’t support dynamic arrays, use the workaround by adding the following return decorator to the <tt class="calibre6">get_interest_over_time</tt> function (below the existing decorators):</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.ret</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">expand</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"table"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">Now that <a id="filepos1741590"/>you know how to work with more complicated UDFs, let’s see how we can use plots with UDFs!</p><p id="filepos1741693" class="calibre_17"><span class="calibre3"><span class="bold">Plotting with UDFs</span></span></p><p class="calibre_6">As <a id="filepos1741829"/>you might remember from <a href="index_split_015.html#filepos482650"><span class="calibre_7">Chapter 5</span></a>, calling a DataFrame’s <tt class="calibre6">plot</tt> method returns a Matplotlib plot by default. In Chapters <a href="index_split_024.html#filepos1235764"><span class="calibre_7">9</span></a> and <a href="index_split_027.html#filepos1487255"><span class="calibre_7">11</span></a>, we’ve already seen how you add such a plot as a picture to Excel. When working with UDFs, there’s an easy way to produce plots: have a look at the second function<a id="filepos1742308"/> in <span class="italic">google_trends.py</span>, shown in <a href="#filepos1742426"><span class="calibre_7">Example 12-4</span></a>.</p><p id="filepos1742426" class="calibre_6"><span class="italic">Example 12-4. The </span><tt class="calibre6"><span class="italic">plot</span></tt><span class="italic"> function in google_trends.py (excerpt with the relevant import statements)</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">matplotlib.pyplot</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">plt</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"df"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pd</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">DataFrame</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">plot</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">plt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">style</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">use</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"seaborn"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00039.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">not</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">empty</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00050.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">pictures</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">add</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">df</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">plot</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">get_figure</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(),</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00067.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                                  </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">top</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">offset</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">row_offset</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">top</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00058.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                                  </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">left</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">left</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                                  </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">update</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">True</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00082.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"&lt;Plot: {name}&gt;"</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00076.jpg" class="calibre_65"/></p><p class="calibre_32"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The <tt class="calibre6">caller</tt> argument is a special argument that is reserved by xlwings: this argument will not be exposed when you call the function from an Excel cell. Instead, <tt class="calibre6">caller</tt> will be provided by xlwings behind the scenes and corresponds to the cell from which you are calling the function (in the form of an xlwings <tt class="calibre6">range</tt> object). Having the <tt class="calibre6">range</tt> object of the calling cell makes it easy to place the plot by using the <tt class="calibre6">top</tt> and <tt class="calibre6">left</tt> arguments of <tt class="calibre6">pictures.add</tt>. The <tt class="calibre6">name</tt> argument will define the name of the picture in Excel.</blockquote></blockquote><p class="calibre_20"><img src="images/00039.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">We set the <tt class="calibre6">seaborn</tt> style to make the plot visually more attractive.</blockquote></blockquote><p class="calibre_20"><img src="images/00050.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">Only call the <tt class="calibre6">plot</tt> method if the DataFrame isn’t empty. Calling the <tt class="calibre6">plot</tt> method on an empty DataFrame would raise an error.</blockquote></blockquote><p class="calibre_20"><img src="images/00067.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19"><tt class="calibre6">get_figure()</tt> returns the Matplotlib figure object from a DataFrame plot, which is what <tt class="calibre6">pictures.add</tt> expects.</blockquote></blockquote><p class="calibre_20"><img src="images/00058.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The arguments <tt class="calibre6">top</tt> and <tt class="calibre6">left</tt> are only used when you insert the plot for the first time. The provided arguments will place the plot in a convenient place—one cell below the one from where you call this function.</blockquote></blockquote><p class="calibre_20"><img src="images/00082.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">The argument <tt class="calibre6">update=True</tt> makes sure that repeated function calls will update the existing picture with the provided name in Excel, without changing its position or size. Without this argument, xlwings would complain that there is already a picture with that name in Excel.</blockquote></blockquote><p class="calibre_20"><img src="images/00076.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">While you don’t strictly need to return anything, it makes your life much easier if you return a string: this allows you to recognize where in your sheet your plotting function sits.</blockquote><a id="filepos1753405"/></blockquote><p class="calibre_16">In <span class="italic">google_trends.xlsm</span>, in cell H3, call the <tt class="calibre6">plot</tt> function like so:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">plot</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">A4</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">F263</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"History"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">If your version of Excel supports dynamic arrays, use <tt class="calibre6">A4#</tt> instead of <tt class="calibre6">A4:F263</tt> to make the source dynamic as shown in <a href="#filepos1754503"><span class="calibre_7">Figure 12-9</span></a>.</p><p class="calibre_21"><img src="images/00022.jpg" id="filepos1754503" class="calibre_125"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-9. The </span></span></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_15">plot</span></span></tt></span><span class="calibre5"><span class="italic"><span class="calibre_15"> function in action</span></span></span></p><p class="calibre_24">Let’s assume that you are slightly confused by<a id="filepos1754939"/> how the <tt class="calibre6">get_interest_over_time</tt> function works. One option to get a better understanding is to debug the code—the next section shows you how this works with UDFs!</p><p id="filepos1755123" class="calibre_17"><span class="calibre3"><span class="bold">Debugging UDFs</span></span></p><p class="calibre_6">A simple<a id="filepos1755260"/> way to debug a UDF is to use the <tt class="calibre6">print</tt> function. If you have the Show Console setting enabled in the xlwings add-in, you will be able to print the value of a variable in the Command Prompt that shows up when you call your UDF. A slightly more comfortable option is to use the debugger of VS Code, which will allow you to pause at breakpoints and step through the code line by line. To use the VS Code debugger (or the debugger of any other IDE), you’ll need to do two things:</p><div class="calibre_8"> </div><ol class="calibre_99"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">In the Excel add-in, activate the checkbox Debug UDFs. This prevents Excel from automatically starting Python, which means you have to do it manually as explained under the next point.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">The easiest way to run the Python UDF server manually is by adding the following lines at the very bottom of the file you’re trying to debug. I have already added these lines at the bottom of the <span class="italic">google_trends.py</span> file in the companion repository:</blockquote></blockquote></blockquote></blockquote><blockquote class="calibre_46"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6"> __name__ </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">==</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"__main__"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">xw</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">serve</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote></blockquote></blockquote></blockquote><blockquote class="calibre_46"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">As you may remember from <a href="index_split_027.html#filepos1487255"><span class="calibre_7">Chapter 11</span></a>, this <tt class="calibre6">if</tt> statement makes sure that the code only runs when you run the file as a script—it doesn’t run when you import the code as a module. With the <tt class="calibre6">serve</tt> command added, run <span class="italic">google_trends.py</span> in VS Code in debug mode by pressing F5 and selecting “Python File”—make sure you don’t run the file by clicking the Run File button as this would ignore breakpoints.</blockquote></blockquote></blockquote></blockquote></li></ol><p class="calibre_14">Let’s set a breakpoint <a id="filepos1758108"/>on line 29 by clicking to the left of the line number. If you are not familiar with using the debugger of VS Code, please have a look at <a href="index_split_030.html#filepos1820886"><span class="calibre_7">Appendix B</span></a> where I introduce it in more detail. When you now recalculate cell A4, your function call will stop at the breakpoint and you can inspect the variables. What’s always helpful during debugging is to run <tt class="calibre6">df.info()</tt>. Activate the Debug Console tab, write <tt class="calibre6"><span class="bold">df.info()</span></tt> in the prompt at the bottom, and confirm by hitting Enter, as shown in <a href="#filepos1759601"><span class="calibre_7">Figure 12-10</span></a>.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">DEBUGGING WITH VS CODE AND ANACONDA</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">This is the same warning as in </span><a id="filepos1758990"/><a href="index_split_027.html#filepos1487255"><span class="calibre5"><span class="calibre_7">Chapter 11</span></span></a><span class="calibre5">: on Windows, when you run the VS Code debugger for the first time with code that uses pandas, you might be greeted by an error: “Exception has occurred: ImportError, Unable to import required dependencies: numpy.” This happens because the debugger is up and running before the Conda environment has been activated properly. As a workaround, stop the debugger by clicking the stop icon and hit F5 again—it will work the second time.</span></blockquote><p class="calibre_3"><img src="images/00030.jpg" id="filepos1759601" class="calibre_126"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-10. Using the Debug Console while the code is paused at a breakpoint</span></span></span></p><p class="calibre_24">If you keep your program paused for more than ninety seconds on a breakpoint, Excel will show you a pop-up saying that “Microsoft Excel is waiting for another application to complete an OLE action.” This shouldn’t have an impact on your debugging experience other than having to confirm the pop-up to make it disappear once you’re done with debugging. To finish this debugging session, click on the Stop button in VS Code (see <a href="#filepos1759601"><span class="calibre_7">Figure 12-10</span></a>) and make sure to uncheck the Debug UDFs setting again in the xlwings ribbon add-in. If you forget to uncheck the Debug UDFs setting, your functions will return an error the next time you recalculate<a id="filepos1760605"/> them.</p><p class="calibre_6">This section showed you the most commonly used UDF functionality by working through the Google Trends case study. The next section will touch on a few advanced topics including UDF performance and the <tt class="calibre6">xw.sub</tt> decorator.</p><p id="filepos1760894" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Advanced UDF Topics</span></span></span></p><p class="calibre_6">If you use many UDFs in your workbook, performance can become an issue. This section starts by showing you the same basic performance optimizations as we’ve seen in <a href="index_split_024.html#filepos1235764"><span class="calibre_7">Chapter 9</span></a>, but applied to UDFs. The second part deals with caching, an additional performance optimization technique that we can use with UDFs. Along the way, we’ll also learn how to have function arguments arrive as xlwings <tt class="calibre6">range</tt> objects rather than as values. At the end of this section, I will introduce you to the <tt class="calibre6">xw.sub</tt> decorator that you can use as an alternative to the <tt class="calibre6">RunPython</tt> call if you are exclusively working on Windows.</p><p id="filepos1761747" class="calibre_17"><span class="calibre3"><span class="bold">Basic Performance Optimization</span></span></p><p class="calibre_6">This part looks at two performance optimization techniques: how to minimize cross-application calls and how to use the raw values converter.</p><p class="calibre_20"><span class="bold"><span class="calibre_5">Minimize cross-application calls</span></span></p><p class="calibre_6">As you<a id="filepos1762196"/> probably recall from <a href="index_split_024.html#filepos1235764"><span class="calibre_7">Chapter 9</span></a>, cross-application calls, i.e., calls between Excel and Python, are relatively slow, so the fewer UDFs you have, the better. You should therefore work with arrays whenever you can—having a version of Excel that supports dynamic arrays definitely makes this part easier. When you are working with pandas DataFrames, there isn’t much that can go wrong, but there are certain formulas where you might not think of using arrays automatically. Consider the example of <a href="#filepos1762988"><span class="calibre_7">Figure 12-11</span></a> that calculates total revenues as the sum of a given Base Fee plus a variable fee determined by Users times Price.</p><p class="calibre_21"><img src="images/00038.jpg" id="filepos1762988" class="calibre_127"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 12-11. Single-cell formulas (left) vs. array-based formulas (right)</span></span></span></p><p class="calibre_32"><span class="italic">Single-cell formulas</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">The left table in <a href="#filepos1762988"><span class="calibre_7">Figure 12-11</span></a> uses the formula <tt class="calibre6">=revenue($B$5, $A9, B$8)</tt> in cell B9. This formula is then applied to the whole range B9:E13. This means that you have 20 single-cell formulas that call the <tt class="calibre6">revenue</tt> function.</blockquote></blockquote><p class="calibre_20"><span class="italic">Array-based formulas</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">The right table in <a href="#filepos1762988"><span class="calibre_7">Figure 12-11</span></a> uses the formula <tt class="calibre6">=revenue2(H5, G9:G13, H8:K8)</tt>. If you don’t have dynamic arrays in your version of Excel, you would need to add the decorator <tt class="calibre6">xw.ret(expand="table")</tt> to the <tt class="calibre6">revenue2</tt> function or turn the array into a legacy CSE array by selecting H9:K13, pressing F2 to edit the formula, and confirming with Ctrl+Shift+Enter. Unlike the single-cell formula, this version only calls the <tt class="calibre6">revenue2</tt> function once.</blockquote><a id="filepos1764379"/></blockquote><p class="calibre_16">You can see the Python code for the two UDFs in <a href="#filepos1764694"><span class="calibre_7">Example 12-5</span></a>, and you’ll find the source file in the <span class="italic">revenues</span> folder within the <span class="italic">udfs</span> directory of the<a id="filepos1764661"/> companion repository.</p><p id="filepos1764694" class="calibre_6"><span class="italic">Example 12-5. revenues.py</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">numpy</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">np</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">revenue</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">base_fee</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">users</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">price</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">base_fee</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">users</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">*</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">price</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"users"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">ndim</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"price"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">revenue2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">base_fee</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">users</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">price</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">base_fee</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">users</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">*</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">price</span></tt></span></p><p class="calibre_24">When you change the base fee in cell B5 or H5 respectively, you will see that the right example will be much faster than the left one. The difference in the Python functions are minimal and only differ in the argument decorators: the array-based version reads in <tt class="calibre6">users</tt> and <tt class="calibre6">prices</tt> as NumPy array—the only caveat here is to read in <tt class="calibre6">users</tt> as a two-dimensional column vector by setting <tt class="calibre6">ndim=2</tt> in the argument decorator. You probably remember that NumPy arrays are similar to DataFrames but without index or header and with only one data type, but if you want a more detailed refresher, <a id="filepos1770595"/>have another look at <a href="index_split_014.html#filepos433313"><span class="calibre_7">Chapter 4</span></a>.</p><p class="calibre_20"><span class="bold"><span class="calibre_5">Using raw values</span></span></p><p class="calibre_6">Using <a id="filepos1770837"/>raw values means that you are leaving out the data preparation and cleaning steps that xlwings does on top of pywin32, xlwings’ dependency on Windows. This, for example, means that you can’t work with DataFrames directly anymore as pywin32 doesn’t understand them, but that may not be an issue if you work with lists or NumPy arrays. To use UDFs with raw values, use the string <tt class="calibre6">raw</tt> as the <tt class="calibre6">convert</tt> argument in the argument or return decorator. This is the equivalent of using the <tt class="calibre6">raw</tt> converter via the <tt class="calibre6">options</tt> method of an xlwings <tt class="calibre6">range</tt> object as we did in <a href="index_split_024.html#filepos1235764"><span class="calibre_7">Chapter 9</span></a>. In line with what we saw back then, you’ll get the biggest speed up during write operations. For example, calling the following function without the return decorator would be about three times slower on my laptop:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">numpy</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">np</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.ret</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"raw"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">randn</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">i</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1000</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">j</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1000</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_38">"""Returns an array with dimensions (i, j) with normally distributed</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_38">    pseudorandom numbers provided by NumPy's random.randn</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_38">    """</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">np</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">random</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">randn</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">i</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">j</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">You’ll find the respective sample in the companion repository in the <span class="italic">raw_values</span> folder within the <span class="italic">udfs</span> directory. When working with UDFs, you have another easy option to improve performance: prevent repeated calculations of slow functions by caching their results.</p><p id="filepos1775412" class="calibre_17"><span class="calibre3"><span class="bold">Caching</span></span></p><p class="calibre_6">When <a id="filepos1775539"/>you call a <span class="italic">deterministic</span> function, i.e., a function that given the same inputs, always returns the same output, you can store the result in a <span class="italic">cache</span>: repeated calls of the function don’t have to wait for the slow calculation anymore but can take the result from the cache where it’s already precalculated. This is best explained with a short example. A very basic caching mechanism can be programmed with a dictionary:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">7</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">time</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">8</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">cache</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">{}</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">slow_sum</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">key</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">key</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">in</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">cache</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">cache</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">key</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">else</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">time</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sleep</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># sleep for 2 seconds</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">result</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">cache</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">key</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">result</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">result</span></tt></span></blockquote><p class="calibre_32">When you call this function for the first time, the <tt class="calibre6">cache</tt> is empty. The code will therefore execute the <tt class="calibre6">else</tt> clause with the artificial two seconds pause that mimics a slow calculation. After performing the calculation, it will add the result to the <tt class="calibre6">cache</tt> dictionary before returning the result. When you now call this function a second time with the same arguments and during the same Python session, it will find it in the <tt class="calibre6">cache</tt> and return it right away, without having to perform the slow calculation again. Caching a result based on its arguments is also <a id="filepos1781894"/>called <span class="italic">memoization</span>. Accordingly, you will see the time difference when you call the function for the first and second time:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">9</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">%%</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">time</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">slow_sum</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Wall time: 2.01 s</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[9]: 3</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">%%</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">time</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">slow_sum</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Wall time: 0 ns</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[10]: 3</tt></span></blockquote><p class="calibre_32">Python has a built-in decorator <a id="filepos1784463"/>called <tt class="calibre6">lru_cache</tt> that can make your life really easy and that you import from the <tt class="calibre6">functools</tt> module that is part of the standard library. <tt class="calibre6">lru</tt> stands for <span class="italic">least recently used</span> cache and means that it holds a maximum number of results (by default 128) before it gets rid of the oldest ones. We can use this with our Google Trends example from the last section. As long as we’re only querying historical values, we can safely cache the result. This will not only make multiple calls faster, but it will also decrease the amounts of requests that we send to Google, lowering the chance that Google blocks us—something that could happen if you send too many requests in a short time.</p><p class="calibre_6">Here are the first few lines of the <tt class="calibre6">get_interest_over_time</tt> function with the required changes to apply caching:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">functools</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">lru_cache</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pandas</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pd</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">pytrends.request</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">TrendReq</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">matplotlib.pyplot</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">plt</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@lru_cache</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00039.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">call_in_wizard</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">False</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"mids"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">xw</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Range</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">doc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Machine IDs: A range of max 5 cells"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00050.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"start_date"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">doc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A date-formatted cell"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.arg</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"end_date"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">doc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A date-formatted cell"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">get_interest_over_time</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">start_date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">end_date</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_38">"""Query Google Trends - replaces the Machine ID (mid) of<br class="calibre1"/>    common programming languages with their human-readable<br class="calibre1"/>    equivalent in the return value, e.g., instead of "/m/05z1_"<br class="calibre1"/>    it returns "Python".<br class="calibre1"/>    """</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mids</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00067.jpg" class="calibre_65"/></blockquote><p class="calibre_17"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">Import the <tt class="calibre6">lru_cache</tt> decorator.</blockquote></blockquote><p class="calibre_20"><img src="images/00039.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">Use the decorator. The decorator has to be on top of the <tt class="calibre6">xw.func</tt> decorator.</blockquote></blockquote><p class="calibre_20"><img src="images/00050.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">By default, <tt class="calibre6">mids</tt> is a list. This creates a problem in this case as functions with lists as arguments can’t be cached. The underlying issue is that lists are mutable objects that can’t be used as keys in dictionaries; see <a href="index_split_031.html#filepos1832059"><span class="calibre_7">Appendix C</span></a> for more information about mutable vs. immutable objects. Using the <tt class="calibre6">xw.Range</tt> converter allows us to retrieve <tt class="calibre6">mids</tt> as xlwings <tt class="calibre6">range</tt> object rather than as list, which solves our problem.</blockquote></blockquote><p class="calibre_20"><img src="images/00067.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">To make the rest of the code work again, we now need to get the values via the <tt class="calibre6">value</tt> property of the xlwings <tt class="calibre6">range</tt> object.</blockquote></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">CACHING WITH DIFFERENT VERSIONS OF PYTHON</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">If you are using a Python version below 3.8, you’ll have to use the decorator with parentheses like so: </span><a id="filepos1793985"/><span class="calibre5"><tt class="calibre6">@lru_cache()</tt></span><span class="calibre5">. If you are using Python 3.9 or later, replace </span><span class="calibre5"><tt class="calibre6">@lru_cache</tt></span><span class="calibre5"> with </span><span class="calibre5"><tt class="calibre6">@cache</tt></span><span class="calibre5">, which is the same as </span><span class="calibre5"><tt class="calibre6">@lru_cache(maxsize=None)</tt></span><span class="calibre5">, i.e., the cache never gets rid of older values. You also need to import the </span><span class="calibre5"><tt class="calibre6">cache</tt></span><span class="calibre5"> decorator from </span><span class="calibre5"><tt class="calibre6">functools</tt></span><span class="calibre5">.</span></blockquote><p class="calibre_16">The <tt class="calibre6">xw.Range</tt> converter can also be useful in other circumstances, for example, if you need to access the cell formulas instead of the values in your UDF. In the previous example, you could write <tt class="calibre6">mids.formula</tt> to access the formulas of the cells. You’ll find the complete example in the <span class="italic">google_trends_cache</span> folder within the <span class="italic">udfs</span> directory of the<a id="filepos1794980"/> companion repository.</p><p class="calibre_6">Now that you know how to tweak the performance of UDFs, let’s wrap this section up by introducing the <tt class="calibre6">xw.sub</tt> decorator.</p><p id="filepos1795188" class="calibre_17"><span class="calibre3"><span class="bold">The Sub Decorator</span></span></p><p class="calibre_6">In <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>, I <a id="filepos1795393"/>showed you how to speed up the <tt class="calibre6">RunPython</tt> call by activating the Use UDF Server setting. If you are living in a Windows-only world, there is an alternative to the <tt class="calibre6">RunPython</tt>/<tt class="calibre6">Use UDF Server</tt> combination in the form of the <tt class="calibre6">xw.sub</tt> decorator. This will allow you to import your Python functions as Sub procedures into Excel, without having to manually write any <tt class="calibre6">RunPython</tt> calls. In Excel, you will need a Sub procedure to be able to attach it to a button—an Excel function, as you get it when using the <tt class="calibre6">xw.func</tt> decorator, won’t work. To try this out, create a new <tt class="calibre6">quickstart</tt> project called <tt class="calibre6">importsub</tt>. As usual, make sure to <tt class="calibre6">cd</tt> first into the directory where you want the project to be created:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings quickstart importsub</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">In the File Explorer, navigate to the created <span class="italic">importsub</span> folder and open <span class="italic">importsub.xlsm</span> in Excel and <span class="italic">importsub.py</span> in VS Code, then decorate the <tt class="calibre6">main</tt> function with <tt class="calibre6">@xw.sub</tt> as shown <a id="filepos1796656"/>in <a href="#filepos1796739"><span class="calibre_7">Example 12-6</span></a>.</p><p id="filepos1796739" class="calibre_6"><span class="italic">Example 12-6. importsub.py (excerpt)</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.sub</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">main</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">():</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">wb</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">xw</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Book</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">wb</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheets</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">==</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello xlwings!"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Bye xlwings!"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">else</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello xlwings!"</span></tt></span></p><p class="calibre_24">In the xlwings add-in, click on Import Functions before hitting Alt+F8 to see the available macros: in addition to the <tt class="calibre6">SampleCall</tt> that uses <tt class="calibre6">RunPython</tt>, you’ll now also see a macro called <tt class="calibre6">main</tt>. Select it and click the Run button—you’ll see the familiar greeting in cell A1. You could now go ahead and assign the <tt class="calibre6">main</tt> macro to a button as we did in <a href="index_split_026.html#filepos1439732"><span class="calibre_7">Chapter 10</span></a>. While the <tt class="calibre6">xw.sub</tt> decorator can make your life easier on Windows, bear in mind that by using it, you lose cross-platform compatibility. With <tt class="calibre6">xw.sub</tt>, we have met all xlwings decorators—I have summarized them again <a id="filepos1801826"/>in <a href="#filepos1801916"><span class="calibre_7">Table 12-1</span></a>.</p><p class="calibre1" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" id="filepos1801916" class="calibre_47"><caption valign="top" class="calibre_48"><span class="italic">Table 12-1. xlwings decorators</span></caption><tr valign="top" class="calibre_49"><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Decorator </span></span><span class="bold">
</span></th><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Description </span></span><span class="bold">
</span></th></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">xw.func</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Put this decorator on top of all functions that you want to import into Excel as an Excel function. </span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">xw.sub</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Put this decorator on top of all functions that you want to import into Excel as an Excel Sub procedure. </span></p></td></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">xw.arg</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Apply converters and options to arguments, e.g., add a docstring via the  </span><span class="calibre5"><tt class="calibre6">doc</tt></span><span class="calibre5"> argument or you can have a range arrive as DataFrame by providing </span><span class="calibre5"><tt class="calibre6">pd.DataFrame</tt></span><span class="calibre5"> as the first argument (this assumes that you have imported pandas as pd).</span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5"> </span><span class="calibre5"><tt class="calibre6">xw.ret</tt></span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">Apply converters and options to return values, e.g., suppress a DataFrame’s index by providing  </span><span class="calibre5"><tt class="calibre6">index=False</tt></span><span class="calibre5">.</span></p></td></tr></table><p class="calibre_17">For more details on these decorators, have a <a id="filepos1804381"/>look at the <a href="https://oreil.ly/h-sT_"><span class="calibre_7">xlwings documentation</span></a>.</p><p id="filepos1804492" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Conclusion</span></span></span></p><p class="calibre_6">This chapter was about writing Python functions and importing them into Excel as UDFs, allowing you to call them via cell formulas. By working through the Google Trends case study, you learned how to influence the behavior of the function arguments and return values by using the <tt class="calibre6">arg</tt> and <tt class="calibre6">ret</tt> decorators, respectively. The last part showed you a few performance tricks and introduced the <tt class="calibre6">xw.sub</tt> decorator, which you can use as a <tt class="calibre6">RunPython</tt> replacement if you are exclusively working with Windows. The nice thing about writing UDFs in Python is that this allows you to replace long and complex cell formulas with Python code that will be easier to understand and maintain. My preferred way to work with UDFs is definitely to use pandas DataFrames with Excel’s new dynamic arrays, a combination that makes it easy to work with the sort of data we get from Google Trends, i.e., DataFrames with a dynamic number of rows.</p><p class="calibre_6">And that’s it—we have reached the end of the book! Thanks so much for your interest in my interpretation of a modern automation and data analysis environment for Excel! My idea was to introduce you to the world of Python and its powerful open source packages, allowing you to write Python code for your next project instead of having to deal with Excel’s own solutions like VBA or Power Query, thereby keeping a door open to easily move away from Excel if you need to. I hope I could give you a few hands-on examples to make the start easier. After reading this book, you now know how to:</p><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Replace an Excel workbook with a Jupyter notebook and pandas code</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Batch process Excel workbooks by reading them with OpenPyXL, xlrd, pyxlsb, or xlwings and then consolidate them with pandas</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Produce Excel reports with either OpenPyXL, XlsxWriter, xlwt, or xlwings</blockquote></blockquote></blockquote></blockquote></li><li value="4" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Use Excel as a frontend and connect it to pretty much anything you want via xlwings, either by clicking a button or by writing a UDF</blockquote></blockquote></blockquote></blockquote></li></ul><p class="calibre_14">Soon enough, however, you’ll want to move beyond the scope of this book. I invite you to check the <a href="https://xlwings.org/book"><span class="calibre_7">book’s home page</span></a> from time to time for updates and additional material. In this spirit, here are a few ideas that you could explore on your own:</p><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Schedule the periodic run of a Python script using either the Task Scheduler on Windows or a cron job on macOS or Linux. You could, for example, create an Excel report every Friday based on data you consume from a REST API or a database.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Write a Python script that sends email alerts whenever the values in your Excel files satisfy a certain condition. Maybe that is when your account balance, consolidated from multiple workbooks, falls below a certain value, or when it shows a different value from what you expect based on your internal database.</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Write code that finds errors in Excel workbooks: check for cell errors like <tt class="calibre6">#REF!</tt> or <tt class="calibre6">#VALUE!</tt> or logical errors like making sure that a formula is including all the cells it should. If you start tracking your mission-critical workbooks with a professional version control system like Git, you can even run these tests automatically whenever you commit a new version.</blockquote></blockquote></blockquote></blockquote></li></ul><p class="calibre_14">If this book inspires you to automate your daily or weekly routine of downloading data and copy/pasting it into Excel, I couldn’t be any happier. Automation doesn’t just give you back time, it also reduces the chance of committing errors dramatically. If you have any feedback, please let me know about it! You can contact me via O’Reilly, by opening an issue on the <a href="https://oreil.ly/vVHmR"><span class="calibre_7">companion repository</span></a> or on Twitter at <a href="https://twitter.com/felixzumstein"><span class="calibre_7">@felixzumstein</span></a>.</p><blockquote id="filepos1810019" class="calibre_33"><a href="#filepos1654281"><span class="calibre5"><span class="calibre_7">1  </span></span></a><span class="calibre5"> The Windows implementation uses a COM server (I’ve introduced the COM technology briefly in </span><a href="index_split_024.html#filepos1235764"><span class="calibre5"><span class="calibre_7">Chapter 9</span></span></a><span class="calibre5">). Since COM doesn’t exist on macOS, UDFs would have to be reimplemented from scratch, which is a lot of work and simply hasn’t been done yet.</span></blockquote><div class="mbp_pagebreak" id="calibre_pb_23"/>


<p id="filepos1810552" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Appendix A. Conda Environments</span></span></span></p><p class="calibre_16">In <a href="index_split_008.html#filepos96824"><span class="calibre_7">Chapter 2</span></a>, I introduced Conda environments by explaining that <tt class="calibre6">(base)</tt> at the beginning of an Anaconda Prompt stands for the currently active Conda environment with the name <tt class="calibre6">base</tt>. Anaconda requires you to always work in an activated environment, but the activation is done automatically for the <tt class="calibre6">base</tt> environment when you start the Anaconda Prompt on Windows or the Terminal on macOS. Working <a id="filepos1811202"/>with Conda environments allows you to properly separate the dependencies of your projects: if you want to try out a newer version of a package like pandas without changing your <tt class="calibre6">base</tt> environment, you can do so in a separate Conda environment. In the first part of this appendix, I will walk you through the process of creating a Conda environment called <tt class="calibre6">xl38</tt> where we will install all packages in the version I used them to write this book. This will allow you to run the samples in this book as-is, even if some packages have released new versions with breaking changes in the meantime. In the second part, I will show you how to disable the auto activation of the <tt class="calibre6">base</tt> environment if you don’t like the default behavior.</p><p id="filepos1811963" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Create a New Conda Environment</span></span></span></p><p class="calibre_6">Run<a id="filepos1812140"/> the following command on your Anaconda Prompt to create a new environment with the name <tt class="calibre6">xl38</tt> that uses Python 3.8:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda create --name xl38 python=3.8</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">When hitting Enter, Conda will print what it is going to install into the new environment and asks you to confirm:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Proceed ([y]/n)?</tt></span></blockquote><p class="calibre_32">Hit Enter to confirm or type <tt class="calibre6"><span class="bold">n</span></tt> if you want to cancel. Once the installation is done, activate your new environment like this:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda activate xl38</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(xl38)&gt;<br class="calibre1"/></tt></span></blockquote><p class="calibre_32">The environment name changed from <tt class="calibre6">base</tt> to <tt class="calibre6">xl38</tt> and you can now use Conda or pip to install packages into this new environment without impacting any of the other environments (as a reminder: only use pip if the package isn’t available via Conda). Let’s go ahead and install all packages from this book in the version I was using them. First, double-check that you are in the <tt class="calibre6">xl38</tt> environment, i.e., the Anaconda Prompt is showing <tt class="calibre6">(xl38)</tt>, then install the Conda packages<a id="filepos1813742"/> like so (the following command should be typed in as a single command; the line breaks are only for display purposes):</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(xl38)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda install lxml=4.6.1 matplotlib=3.3.2 notebook=6.1.4 openpyxl=3.0.5<br class="calibre1"/>                      pandas=1.1.3 pillow=8.0.1 plotly=4.14.1 flake8=3.8.4<br class="calibre1"/>                      python-dateutil=2.8.1 requests=2.24.0 sqlalchemy=1.3.20<br class="calibre1"/>                      xlrd=1.2.0 xlsxwriter=1.3.7 xlutils=2.0.0 xlwings=0.20.8<br class="calibre1"/>                      xlwt=1.3.0</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">Confirm the installation plan and finalize the environment by installing the two remaining dependencies with pip:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(xl38)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">pip install pyxlsb==1.0.7 pytrends==4.7.3</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(xl38)&gt;<br class="calibre1"/></tt></span></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">HOW TO USE THE XL38 ENVIRONMENT</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">If you would like to use the </span><a id="filepos1815162"/><span class="calibre5"><tt class="calibre6">xl38</tt></span><span class="calibre5"> environment rather than the </span><span class="calibre5"><tt class="calibre6">base</tt></span><span class="calibre5"> environment to work through the examples in this book, make sure to always have your </span><span class="calibre5"><tt class="calibre6">xl38</tt></span><span class="calibre5"> environment activated by running:</span></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda activate xl38</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote></blockquote><blockquote class="calibre_31"><span class="calibre5">That is, wherever I show the Anaconda Prompt as </span><span class="calibre5"><tt class="calibre6">(base)&gt;</tt></span><span class="calibre5">, you will want it to show </span><span class="calibre5"><tt class="calibre6">(xl38)&gt;</tt></span><span class="calibre5"> instead.</span></blockquote><p class="calibre_16">To deactivate <a id="filepos1816090"/>the environment again and get back to the <tt class="calibre6">base</tt> environment, type:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(xl38)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda deactivate</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt;<br class="calibre1"/></tt></span></blockquote><p class="calibre_32">If you want to <a id="filepos1816460"/>delete the environment completely, run the following command:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda env remove --name xl38</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">Instead of going through the steps manually to create the <tt class="calibre6">xl38</tt> environment, you can also take advantage of the environment file <span class="italic">xl38.yml</span> that I included in the <span class="italic">conda</span> folder of the companion repository. Running the following commands takes care of everything:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">cd C:\Users\</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="bold">username</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">\python-for-excel\conda</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda env create -f xl38.yml</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda activate xl38</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(xl38)&gt;<br class="calibre1"/></tt></span></blockquote><p class="calibre_32">By default, Anaconda always activates the <tt class="calibre6">base</tt> environment when you open a Terminal on macOS or the Anaconda Prompt on Windows. If you don’t like this, you could disable auto activation<a id="filepos1817881"/> as I’ll show you next.</p><p id="filepos1817917" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Disable Auto Activation</span></span></span></p><p class="calibre_6">If you <a id="filepos1818091"/>don’t want the <tt class="calibre6">base</tt> environment to be activated automatically whenever you fire up an Anaconda Prompt, you can disable it: this will require you to type <tt class="calibre6"><span class="bold">conda activate base</span></tt> manually on a Command Prompt (Windows) or Terminal (macOS) before you are able to use Python.</p><p class="calibre_6"><span class="italic">Windows</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">On Windows, you will need to use the regular Command Prompt instead of the Anaconda Prompt. The following steps will enable the <tt class="calibre6">conda</tt> command in a normal Command Prompt. Make sure to replace the path in the first line with the path where Anaconda is installed on your system:</blockquote><a id="filepos1818813"/></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">cd C:\Users\</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="bold">username</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">\Anaconda3\condabin</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda init cmd.exe</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19">Your regular Command Prompt is now set up with Conda, so going forward you can activate the <tt class="calibre6">base</tt> environment like this:</blockquote></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda activate base</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt;<br class="calibre1"/></tt></span></blockquote></blockquote><p class="calibre_17"><span class="italic">macOS</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">On macOS, simply run the following command in your Terminal to disable auto activation:</blockquote><a id="filepos1819954"/></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda config --set auto_activate_base false</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19">If you ever want to revert, run the same command again with <tt class="calibre6">true</tt> instead of <tt class="calibre6">false</tt>. Changes will come into effect after restarting the Terminal. Going forward, you will need to activate the <tt class="calibre6">base</tt> environment like this before you can use the <tt class="calibre6">python</tt> command again:</blockquote></blockquote><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda activate base</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt;<br class="calibre1"/></tt></span></blockquote></blockquote><div class="mbp_pagebreak" id="calibre_pb_24"/>


<p id="filepos1820886" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Appendix B. Advanced VS Code Functionality</span></span></span></p><p class="calibre_16">This appendix shows you how the debugger works in VS Code and how you can run Jupyter notebooks directly from within VS Code. The topics are independent of each other, so you may read them in any order.</p><p id="filepos1821278" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Debugger</span></span></span></p><p class="calibre_6">If <a id="filepos1821433"/>you’ve ever used the VBA debugger in Excel, I have good news for you: debugging with VS Code is a very similar experience. Let’s start by opening the file <span class="italic">debugging.py</span> from the companion repository in VS Code. Click into the margin to the left of line number 4 so that a red dot appears—this is your breakpoint where code execution will be paused. Now hit F5 to start debugging: the Command Panel will appear with a selection of debug configurations. Choose “Python File” to debug the active file and run the code until it hits the breakpoint. The line will be highlighted and code execution pauses, see <a href="#filepos1822749"><span class="calibre_7">Figure B-1</span></a>. While you debug, the status bar turns orange.</p><p class="calibre_6">If the Variables section doesn’t show up automatically on the left, make sure to click on the Run menu to see the values of the variables. Alternatively, you can also hover over a variable in the source code and get a tooltip with its value. At the top, you will see the Debug Toolbar that gives you access to the following buttons from left to right): Continue, Step Over, Step Into, Step Out, Restart, and Stop. When you hover over them, you will also see the keyboard shortcuts.</p><p class="calibre_21"><img src="images/00049.jpg" id="filepos1822749" class="calibre_128"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure B-1. VS Code with the debugger stopped at the breakpoint</span></span></span></p><p class="calibre_24">Let’s see what each of these buttons does:</p><p class="calibre_6"><span class="italic">Continue</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">This continues to run the program until it either hits the next breakpoint or the end of the program. If it reaches the end of the program, the debugging process will stop.</blockquote><a id="filepos1823390"/></blockquote><p class="calibre_20"><span class="italic">Step Over</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">The debugger will advance one line. <span class="italic">Step Over</span> means that the debugger will not visually step through lines of code that are not part of your current scope. For example, it will not step into the code of a function that you call line by line—but the function will still be called!</blockquote><a id="filepos1823834"/></blockquote><p class="calibre_20"><span class="italic">Step Into</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">If you have code that calls a function or class, etc., <span class="italic">Step Into</span> will cause the debugger to step into that function or class. If the function or class is in a different file, the debugger will open this file for you.</blockquote><a id="filepos1824213"/></blockquote><p class="calibre_20"><span class="italic">Step Out</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">If you stepped into a function with Step Into, <span class="italic">Step Out</span> causes the debugger to return to the next higher level until eventually, you will be back on the highest level from where you called Step Into initially.</blockquote><a id="filepos1824584"/></blockquote><p class="calibre_20"><span class="italic">Restart</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">This will stop the current debug process and start a new one from the beginning.</blockquote><a id="filepos1824818"/></blockquote><p class="calibre_20"><span class="italic">Stop</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">This will stop the current debug process.</blockquote><a id="filepos1825010"/></blockquote><p class="calibre_16">Now that you know what each button does, click on Step Over to advance one line and see how variable <tt class="calibre6">c</tt> appears in the Variables section, then finish this debugging exercise by clicking on Continue.</p><p class="calibre_6">If you save the debugging configuration, the Command Panel will not show up and ask you about the configuration every time you hit F5: click on the Run icon in the Activity Bar, then click on “create a launch.json file.” This will cause the Command Panel to show up again and when you select “Python File,” it creates the <span class="italic">launch.json</span> file under a directory called <span class="italic">.vscode</span>. When you now hit F5, the debugger will start right away. If you need to change the configuration or want to get the Command Panel pop-up again, edit or delete the <span class="italic">launch.json</span> file <a id="filepos1825904"/>in the <span class="italic">.vscode</span> directory.</p><p id="filepos1825947" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Jupyter Notebooks in VS Code</span></span></span></p><p class="calibre_6">Instead of running your Jupyter notebooks in a web browser, you can also run them with VS Code directly. On top of that, VS Code offers a convenient Variable explorer as well as options to transform the notebook into standard Python files without losing the cell functionality. This makes it easier to use the debugger or to copy/paste cells between different notebooks. Let’s get started by running a notebook in VS Code!</p><p id="filepos1826547" class="calibre_17"><span class="calibre3"><span class="bold">Run Jupyter Notebooks</span></span></p><p class="calibre_6">Click <a id="filepos1826689"/>the Explorer icon on the Activity Bar and open <span class="italic">ch05.ipynb</span> from the companion repository. To continue, you will need to make the notebook a trusted one by clicking on Trust in the notification that pops up. The layout of the notebook looks a bit different from the one in the browser to match the rest of VS Code, but otherwise, it’s the same experience including all the keyboard shortcuts. Let’s run the first three cells via Shift+Enter. This will start the Jupyter notebook server if it isn’t running yet (you will see the status at the top right of the notebook). After running the cells, click on the calculator button in the menu at the top of the notebook: this will open the <a id="filepos1827392"/>Variable explorer, in which you can see the values of all variables that currently exist, as in <a href="#filepos1828071"><span class="calibre_7">Figure B-2</span></a>. That is, you will only find variables from cells that have been run.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">SAVING JUPYTER NOTEBOOKS IN VS CODE</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">To save notebooks in VS Code, you need to use the Save button at the top of the notebook or hit Ctrl+S on Windows or Command-S on macOS. File &gt; Save won’t work.</span><a id="filepos1828008"/></blockquote><p class="calibre_3"><img src="images/00056.jpg" id="filepos1828071" class="calibre_129"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure B-2. Jupyter notebook Variable explorer</span></span></span></p><p class="calibre_24">If you use data structures like nested lists, NumPy arrays, or DataFrames, you can double-click the variable: this will open the<a id="filepos1828467"/> Data Viewer and give you a familiar spreadsheet-like view. <a href="#filepos1828717"><span class="calibre_7">Figure B-3</span></a> shows the Data Viewer after double-clicking the <tt class="calibre6">df</tt> variable.</p><p class="calibre_21"><img src="images/00066.jpg" id="filepos1828717" class="calibre_130"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure B-3. Jupyter notebook Data Viewer</span></span></span></p><p class="calibre_24">While VS Code allows you to run standard Jupyter notebook files, it also allows you to<a id="filepos1829065"/> transform the notebooks into normal Python files—without losing your cells. Let’s see how it works!</p><p id="filepos1829180" class="calibre_17"><span class="calibre3"><span class="bold">Python Scripts with Code Cells</span></span></p><p class="calibre_6">To<a id="filepos1829327"/> use Jupyter notebook cells in standard Python files, VS Code uses a special comment to denote cells: <tt class="calibre6"># %%</tt>. To convert an existing Jupyter notebook, open it and hit the Export As button in the menu at the top of the notebook; see <a href="#filepos1828071"><span class="calibre_7">Figure B-2</span></a>. This will allow you to select “Python File” from the command palette. However, instead of converting an existing file, let’s create a new file that we call <span class="italic">cells.py</span> with the following content:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># %%</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># %% [markdown]</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># # This is a Title</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43">#</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Some markdown content</span></span></tt></span></blockquote><p class="calibre_32">Markdown cells need to start with <tt class="calibre6"># %% [markdown]</tt> and require the whole cell to be marked as comment. If you want to run such a file as notebook, click on the “Run Below” link that appears when you hover over the first cell. This will open up <a id="filepos1831056"/>the <span class="italic">Python Interactive Window</span> to the right, as shown in <a href="#filepos1831240"><span class="calibre_7">Figure B-4</span></a>.</p><p class="calibre_21"><img src="images/00074.jpg" id="filepos1831240" class="calibre_131"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure B-4. Python Interactive Window</span></span></span></p><p class="calibre_24">The Python Interactive Window is again shown as notebook. To export your file in the <span class="italic">ipynb</span> format, click the Save icon (Export as Jupyter notebook) at the top of the Python Interactive Window. The Python Interactive Window also offers you a cell at the bottom from where you can execute code interactively. Using regular Python files as opposed to Jupyter notebooks allows you to use the VS Code debugger and makes working with version control easier as output cells, which typically add a lot of noise between versions, are ignored.</p><div class="mbp_pagebreak" id="calibre_pb_25"/>


<p id="filepos1832059" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Appendix C. Advanced Python Concepts</span></span></span></p><p class="calibre_16">In this appendix, we’re taking a closer look at the following three topics: classes and objects, time-zone-aware datetime objects, and mutable vs. immutable objects. The topics are independent of each other, so you may read them in any order.</p><p id="filepos1832487" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Classes and Objects</span></span></span></p><p class="calibre_6">In this<a id="filepos1832657"/> section, we will write our own class to get a better understanding of how classes and objects are related. Classes define new types of objects: a class behaves like a springform you use to bake a cake. Depending on the ingredients you use, you get a different cake, for example, a chocolate cake or a cheesecake. The process of getting a cake (the object) out of the springform (the class) is <a id="filepos1833058"/>called <span class="italic">instantiation</span>, which is why objects are also called <span class="italic">class instances</span>. Whether chocolate or cheesecake, they are both a <span class="italic">type</span> of cake: classes allow you to define new data types that keep related data (<span class="italic">attributes</span>) <a id="filepos1833311"/>and functions (<span class="italic">methods</span>) together and therefore help you to structure and organize your code. Let me now return to the car racing game example from <a href="index_split_010.html#filepos178328"><span class="calibre_7">Chapter 3</span></a> to define our own class:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">class</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_66">Car</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6"> __init__</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">self</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">self</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">self</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/>            </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">accelerate</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">self</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mph</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">self</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">mph</span></tt></span></blockquote><p class="calibre_32">This is a simple car class with two methods. Methods are functions that are part of a class definition. This class has one regular method called <tt class="calibre6">accelerate</tt>. This method will change the data (<tt class="calibre6">speed</tt>) of an instance of this class. It also has a special method that starts and ends with double underscores<a id="filepos1837273"/> called <tt class="calibre6">__init__</tt>. It will be called automatically by Python when an object is <span class="italic">initialized</span> to attach some initial data to the object. The first argument of every method represents the instance of the class and is <a id="filepos1837508"/>called <tt class="calibre6">self</tt> by convention. This will get clearer when you see how you use the <tt class="calibre6">Car</tt> class. First, let’s instantiate two cars. You are doing this in the same way as you are calling a function: call the class by adding parentheses and by providing the arguments of the <tt class="calibre6">__init__</tt> method. You never provide anything for <tt class="calibre6">self</tt>, as Python will take care of that. In this sample, <tt class="calibre6">self</tt> will be <tt class="calibre6">car1</tt> or <tt class="calibre6">car2</tt>, respectively:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Let's instantiate two car objects</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Car</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"red"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car2</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Car</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"blue"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">When you call a class, you are really calling<a id="filepos1839671"/> the <tt class="calibre6">__init__</tt> function, which is why everything with regard to function arguments applies here as well: for <tt class="calibre6">car1</tt>, we provide the argument as positional argument, while for <tt class="calibre6">car2</tt>, we are using keyword arguments. After instantiating the two car objects from the <tt class="calibre6">Car</tt> class, we’ll have a look at their attributes and call their methods. As we will see, after accelerating <tt class="calibre6">car1</tt>, the speed of <tt class="calibre6">car1</tt> is changed, but it is unchanged for <tt class="calibre6">car2</tt> as the two objects are independent of each other:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># By default, an object prints its memory location</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[3]: &lt;__main__.Car at 0x7fea812e3890&gt;</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">4</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Attributes give you access to the data of an object</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[4]: 'red'</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">5</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[5]: 0</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">6</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Calling the accelerate method on car1</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">accelerate</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">20</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">7</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># The speed attribute of car1 changed</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[7]: 20</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">8</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># The speed attribute of car2 remained the same</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">speed</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[8]: 0</tt></span></blockquote><p class="calibre_32">Python also allows you to change attributes directly without having to use methods:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">9</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"green"</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">10</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[10]: 'green'</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">11</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">car2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">color</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># unchanged</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[11]: 'blue'</tt></span></blockquote><p class="calibre_32">To summarize: classes define the attributes and methods of objects. Classes allow you to group related functions (“methods”) and data (“attributes”) together so that they can conveniently be accessed via <a id="filepos1847675"/>dot notation: <tt class="calibre6">myobject.attribute</tt> or <tt class="calibre6">myobject.method()</tt>.</p><p id="filepos1847758" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></span></span></p><p class="calibre_6">In <a href="index_split_010.html#filepos178328"><span class="calibre_7">Chapter 3</span></a>, we<a id="filepos1848019"/> briefly looked at time-zone-naive <tt class="calibre6">datetime</tt> objects. If time zone is of importance, you usually work in the <span class="italic">UTC</span> time zone <a id="filepos1848164"/>and only transform to local time zones for display purposes. UTC stands for <span class="italic">Coordinated Universal Time</span> and is the successor of Greenwich Mean Time (GMT). When you work with Excel and Python, you may want to turn naive timestamps, as delivered by Excel, into time-zone-aware <tt class="calibre6">datetime</tt> objects. For time-zone support in Python, you can use the<a id="filepos1848527"/> dateutil package, which isn’t part of the standard library but comes preinstalled with Anaconda. The following samples show a few common operations when working with <tt class="calibre6">datetime</tt> objects and time zones:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">12</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">datetime</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">dt</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">dateutil</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tz</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">13</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Time-zone-naive datetime object</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2020</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">31</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">14</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">30</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">isoformat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[13]: '2020-01-31T14:30:00'</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">14</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Time-zone-aware datetime object</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2020</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">31</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">14</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">30</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                                         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tzinfo</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tz</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">gettz</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"US/Eastern"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">))</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Printing in isoformat makes it easy to</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># see the offset from UTC</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">isoformat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[14]: '2020-01-31T14:30:00-05:00'</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">15</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Assign a time zone to a naive datetime object</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">replace</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tzinfo</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tz</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">gettz</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"US/Eastern"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">))</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">isoformat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[15]: '2020-01-31T14:30:00-05:00'</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">16</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Convert from one time zone to another.</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Since the UTC time zone is so common,</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># there is a shortcut: tz.UTC</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_utc</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">astimezone</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tz</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">UTC</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_utc</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">isoformat</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[16]: '2020-01-31T19:30:00+00:00'</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">17</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># From time-zone-aware to naive</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">replace</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tzinfo</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[17]: datetime.datetime(2020, 1, 31, 14, 30)</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">18</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Current time without time zone</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">now</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[18]: datetime.datetime(2021, 1, 3, 11, 18, 37, 172170)</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">19</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Current time in UTC time zone</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">now</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tz</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">UTC</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[19]: datetime.datetime(2021, 1, 3, 10, 18, 37, 176299, tzinfo=tzutc())</tt></span></blockquote><blockquote class="calibre_25"><span class="bold">TIME ZONES WITH PYTHON 3.9</span></blockquote><blockquote class="calibre_27">Python 3.9 added <a id="filepos1862968"/>proper time zone support to the standard library in the form of the <tt class="calibre6">timezone</tt> module. Use it to replace the <tt class="calibre6">tz.gettz</tt> calls from <tt class="calibre6">dateutil</tt>:</blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">from</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">zoneinfo</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">ZoneInfo</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">timestamp_eastern</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">dt</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">datetime</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2020</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">31</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">14</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">30</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                                </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">tzinfo</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">ZoneInfo</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"US/Eastern"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">))</span></tt></span></blockquote><p id="filepos1865329" class="calibre_30"><span class="calibre3"><span class="bold"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></span></span></p><p class="calibre_6">In Python,<a id="filepos1865519"/> objects that can change their values are called <span class="italic">mutable</span> and those that can’t are called <span class="italic">immutable</span>. <a href="#filepos1865771"><span class="calibre_7">Table C-1</span></a> shows how the different<a id="filepos1865731"/> data types qualify.</p><p class="calibre1" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" id="filepos1865771" class="calibre_47"><caption valign="top" class="calibre_48"><span class="italic">Table C-1. Mutable and immutable data types</span></caption><tr valign="top" class="calibre_49"><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Mutability </span></span><span class="bold">
</span></th><th valign="top" class="calibre_50"><span class="calibre5"><span class="bold"> Data Types </span></span><span class="bold">
</span></th></tr><tr valign="top" class="calibre_49"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">mutable </span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">lists, dictionaries, sets </span></p></td></tr><tr valign="top" class="calibre_52"><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">immutable </span></p></td><td class="calibre_51"><span class="calibre5"> </span><p class="calibre_6"><span class="calibre5">integers, floats, booleans, strings, datetime, tuples </span></p></td></tr></table><p class="calibre_17">Knowing about the difference is important as mutable objects may behave differently from what you are used to from other languages, including VBA. Have a look at the following VBA snippet:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Dim</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">Variant</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">Variant</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Array</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">22</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Debug</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Print</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">", "</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">", "</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Debug</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Print</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">", "</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">", "</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">&amp;</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">This prints the following:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">1, 22, 3<br class="calibre1"/>1, 2, 3</tt></span></blockquote><p class="calibre_32">Now let’s do the same example in Python with a list:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">20</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">22</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">[1, 22, 3]<br class="calibre1"/>[1, 22, 3]</tt></span></blockquote><p class="calibre_32">What happened here? In Python, variables are names that you “attach” to an object. By doing <tt class="calibre6">b = a</tt>, you attach both names to the same object, the list <tt class="calibre6">[1, 2, 3]</tt>. All variables attached to that object will, therefore, show the changes to the list. This only happens with mutable objects, though: if you would replace the list with an immutable object like a tuple, changing <tt class="calibre6">a</tt> would not change <tt class="calibre6">b</tt>. If you want a mutable object like <tt class="calibre6">b</tt> to be independent of changes in <tt class="calibre6">a</tt>, you have to explicitly copy the list:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">21</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">2</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">,</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">3</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">copy</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">22</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[22]: [1, 2, 3]</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">23</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[23]: [1, 2, 3]</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">24</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">22</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Changing "a"...</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">25</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[25]: [1, 22, 3]</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">26</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6">  </tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># ...doesn't affect "b"</span></span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[26]: [1, 2, 3]</tt></span></blockquote><p class="calibre_32">By using a list’s <tt class="calibre6">copy</tt> method, you are creating<a id="filepos1881031"/> a <span class="italic">shallow copy</span>: you will get a copy of the list, but if the list contains mutable elements, these will still be shared. If you want to copy all elements recursively, you need to make<a id="filepos1881228"/> a <span class="italic">deep copy</span> by using the <tt class="calibre6">copy</tt> module from the standard library:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">27</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">copy</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">b</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">copy</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">deepcopy</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><p class="calibre_32">Let’s now look at what happens when you use mutable objects as <a id="filepos1882596"/>function arguments.</p><p id="filepos1882626" class="calibre_17"><span class="calibre3"><span class="bold">Calling Functions with Mutable Objects as Arguments</span></span></p><p class="calibre_6">If you <a id="filepos1882799"/>come from VBA, you are probably used to marking function arguments<a id="filepos1882872"/> as pass-by-reference (<tt class="calibre6">ByRef</tt>) or pass-by-value (<tt class="calibre6">ByVal</tt>): when you pass a variable to a function as argument, the function will have the ability to change it (<tt class="calibre6">ByRef</tt>) or will work on a copy of the values (<tt class="calibre6">ByVal</tt>), thus leaving the original variable untouched. <tt class="calibre6">ByRef</tt> is the default in VBA. Consider the following function in VBA:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Function</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">ByRef</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">Integer</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">Integer</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">increment</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">End</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Function</span></span></tt></span></blockquote><p class="calibre_32">Then, call the function like this:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Sub</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">call_increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Dim</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">As</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_61">Integer</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Debug</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Print</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Debug</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Print</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">End</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Sub</span></span></tt></span></blockquote><p class="calibre_32">This will print the following:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">2<br class="calibre1"/>2</tt></span></blockquote><p class="calibre_32">However, if <a id="filepos1887586"/>you change <tt class="calibre6">ByRef</tt> in the <tt class="calibre6">increment</tt> function to <tt class="calibre6">ByVal</tt>, it will print:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">2<br class="calibre1"/>1</tt></span></blockquote><p class="calibre_32">How does this work in Python? When you pass around variables, you pass around names that point to objects. This means that the behavior depends on whether the object is mutable or not. Let’s first use an immutable object:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">28</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">29</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">))</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">2<br class="calibre1"/>1</tt></span></blockquote><p class="calibre_32">Now let’s repeat the sample with a mutable object:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">30</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">+</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">31</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">))</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">[2]<br class="calibre1"/>[2]</tt></span></blockquote><p class="calibre_32">If the object is mutable and you would like to leave the original object unchanged, you will need to pass in a copy of the object:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">32</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">increment</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">copy</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()))</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">print</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">a</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">[2]<br class="calibre1"/>[1]</tt></span></blockquote><p class="calibre_32">Another case to watch out for is the use of mutable objects as default arguments in function definitions—let’s see why!</p><p id="filepos1896621" class="calibre_17"><span class="calibre3"><span class="bold">Functions with Mutable Objects as Default Arguments</span></span></p><p class="calibre_6">When<a id="filepos1896791"/> you write functions, you normally shouldn’t use mutable objects as default arguments. The reason is that the value of default arguments is evaluated only once as part of the function definition, not every time when the function is called. Therefore, using mutable objects as default arguments can lead to unexpected behavior:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">33</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="italic"><span class="calibre_43"># Don't do this:</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>         </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">add_one</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[]):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">append</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">34</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">add_one</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[34]: [1]</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">35</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">add_one</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[35]: [1, 1]</tt></span></blockquote><p class="calibre_32">If you want to use an empty list as a default argument, do this<a id="filepos1900058"/> instead:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">36</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">add_one</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_15">is</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_58">None</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>                 </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">append</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">1</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>             </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">x</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">37</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">add_one</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[37]: [1]</tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="calibre_36">In</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">38</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">add_one</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></blockquote><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Out[38]: [1]</tt></span></blockquote><div class="mbp_pagebreak" id="calibre_pb_26"/>


<p id="filepos1903642" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Index</span></span></span></p><blockquote class="calibre_91"><span class="bold">Symbols</span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">%%time cell magic, <a href="index_split_022.html#filepos1147874"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="2" class="calibre_10">%%timeit cell magic, <a href="index_split_022.html#filepos1148960"><span class="calibre_7">Reading sheets in parallel</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">A</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">absolute paths, <a href="index_split_008.html#filepos112263"><span class="calibre_7">Anaconda Prompt</span></a>, <a href="index_split_027.html#filepos1638593"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">activating Conda environments, <a href="index_split_029.html#filepos1815162"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="3" class="calibre_10">ActiveX controls, <a href="index_split_007.html#filepos92381"><span class="calibre_7">Cross-Platform Compatibility</span></a>, <a href="index_split_026.html#filepos1464639"><span class="calibre_7">RunPython Function</span></a></li><li value="4" class="calibre_10">Activity Bar (VS Code), <a href="index_split_009.html#filepos161361"><span class="calibre_7">Installation and Configuration</span></a></li><li value="5" class="calibre_10">add-ins (Excel)<ul class="calibre_135"><li value="1" class="calibre_13">custom, <a href="index_split_026.html#filepos1477721"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a>, <a href="index_split_028.html#filepos1678327"><span class="calibre_7">UDF Quickstart</span></a></li><li value="2" class="calibre_10">installing xlwings, <a href="index_split_026.html#filepos1442113"><span class="calibre_7">Excel Add-in</span></a>-<a href="index_split_026.html#filepos1447961"><span class="calibre_7">Excel Add-in</span></a></li></ul></li><li value="6" class="calibre_10">adding<ul class="calibre_135"><li value="1" class="calibre_13">columns to DataFrame, <a href="index_split_015.html#filepos592331"><span class="calibre_7">Setting data by adding a new column</span></a></li><li value="2" class="calibre_10">elements to lists, <a href="index_split_011.html#filepos256618"><span class="calibre_7">Lists</span></a></li><li value="3" class="calibre_10">packages to Python Package Tracker, <a href="index_split_027.html#filepos1489144"><span class="calibre_7">What We Will Build</span></a>-<a href="index_split_027.html#filepos1492009"><span class="calibre_7">What We Will Build</span></a></li></ul></li><li value="7" class="calibre_10">add_package function (Python Package Tracker) example, <a href="index_split_027.html#filepos1621394"><span class="calibre_7">Backend</span></a>-<a href="index_split_027.html#filepos1633823"><span class="calibre_7">Backend</span></a></li><li value="8" class="calibre_10">agg method (pandas), <a href="index_split_016.html#filepos698880"><span class="calibre_7">Grouping</span></a></li><li value="9" class="calibre_10">aggfunc function (pandas), <a href="index_split_016.html#filepos708364"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="10" class="calibre_10">aliases for modules, <a href="index_split_012.html#filepos388542"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="11" class="calibre_10">Altair, <a href="index_split_016.html#filepos739626"><span class="calibre_7">Plotly</span></a></li><li value="12" class="calibre_10">Anaconda<ul class="calibre_135"><li value="1" class="calibre_13">components of, <a href="index_split_008.html#filepos98339"><span class="calibre_7">Development Environment</span></a></li><li value="2" class="calibre_10">Conda (see Conda)</li><li value="3" class="calibre_10">installing, <a href="index_split_008.html#filepos99940"><span class="calibre_7">Installation</span></a>-<a href="index_split_008.html#filepos101307"><span class="calibre_7">Installation</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_008.html#filepos97439"><span class="calibre_7">Development Environment</span></a></li></ul></li><li value="13" class="calibre_10">Anaconda Prompt<ul class="calibre_135"><li value="1" class="calibre_13">commands, list of, <a href="index_split_008.html#filepos106145"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">interactive Python session<ul class="calibre_136"><li value="1" class="calibre_13">ending, <a href="index_split_008.html#filepos118780"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="2" class="calibre_10">starting, <a href="index_split_008.html#filepos115018"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a>-<a href="index_split_008.html#filepos118983"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li></ul></li><li value="3" class="calibre_10">long file paths, <a href="index_split_009.html#filepos170243"><span class="calibre_7">Running a Python Script</span></a></li><li value="4" class="calibre_10">notation, <a href="index_split_008.html#filepos116148"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="5" class="calibre_10">operational overview, <a href="index_split_008.html#filepos101486"><span class="calibre_7">Anaconda Prompt</span></a>-<a href="index_split_008.html#filepos114837"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="6" class="calibre_10">purpose of, <a href="index_split_008.html#filepos97588"><span class="calibre_7">Development Environment</span></a></li><li value="7" class="calibre_10">Python scripts, running, <a href="index_split_009.html#filepos168744"><span class="calibre_7">Running a Python Script</span></a></li><li value="8" class="calibre_10">running<ul class="calibre_136"><li value="1" class="calibre_13">in macOS, <a href="index_split_008.html#filepos104346"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">in Windows, <a href="index_split_008.html#filepos103402"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="9" class="calibre_10">VS Code, running, <a href="index_split_009.html#filepos165226"><span class="calibre_7">Running a Python Script</span></a></li><li value="10" class="calibre_10">xlwings CLI<ul class="calibre_136"><li value="1" class="calibre_13">addin install command, <a href="index_split_026.html#filepos1442590"><span class="calibre_7">Excel Add-in</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_026.html#filepos1444887"><span class="calibre_7">Excel Add-in</span></a></li><li value="3" class="calibre_10">quickstart command, <a href="index_split_026.html#filepos1448302"><span class="calibre_7">Quickstart Command</span></a></li></ul></li></ul></li><li value="14" class="calibre_10">antivirus software, xlwings installation and, <a href="index_split_026.html#filepos1444759"><span class="calibre_7">Excel Add-in</span></a></li><li value="15" class="calibre_10">APIs (application programming interfaces), <a href="index_split_027.html#filepos1492910"><span class="calibre_7">Web APIs</span></a></li><li value="16" class="calibre_10">app object (xlwings), <a href="index_split_024.html#filepos1252360"><span class="calibre_7">The Excel Object Model</span></a>, <a href="index_split_024.html#filepos1296280"><span class="calibre_7">The Excel Object Model</span></a>, <a href="index_split_025.html#filepos1428002"><span class="calibre_7">App properties</span></a></li><li value="17" class="calibre_10">append method (OpenPyXL), <a href="index_split_022.html#filepos1126427"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="18" class="calibre_10">AppleScript, <a href="index_split_025.html#filepos1411927"><span class="calibre_7">xlwings Foundations</span></a></li><li value="19" class="calibre_10">application programming interfaces (APIs), <a href="index_split_027.html#filepos1492910"><span class="calibre_7">Web APIs</span></a></li><li value="20" class="calibre_10">application structure (Python Package Tracker), <a href="index_split_027.html#filepos1601418"><span class="calibre_7">Application Structure</span></a><ul class="calibre_135"><li value="1" class="calibre_13">backend, <a href="index_split_027.html#filepos1620020"><span class="calibre_7">Backend</span></a>-<a href="index_split_027.html#filepos1644241"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">debugging, <a href="index_split_027.html#filepos1644656"><span class="calibre_7">Debugging</span></a>-<a href="index_split_027.html#filepos1651460"><span class="calibre_7">Debugging</span></a></li><li value="3" class="calibre_10">frontend, <a href="index_split_027.html#filepos1606230"><span class="calibre_7">Frontend</span></a>-<a href="index_split_027.html#filepos1619827"><span class="calibre_7">Frontend</span></a></li></ul></li><li value="21" class="calibre_10">applications, layers of, <a href="index_split_007.html#filepos41940"><span class="calibre_7">Separation of concerns</span></a>-<a href="index_split_007.html#filepos45911"><span class="calibre_7">Separation of concerns</span></a></li><li value="22" class="calibre_10">applymap method (pandas), <a href="index_split_015.html#filepos641087"><span class="calibre_7">Applying a Function</span></a>-<a href="index_split_015.html#filepos649303"><span class="calibre_7">Applying a Function</span></a></li><li value="23" class="calibre_10">arange function (NumPy), <a href="index_split_014.html#filepos471142"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="24" class="calibre_10">argument decorators (xlwings), <a href="index_split_028.html#filepos1687455"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>, <a href="index_split_028.html#filepos1801826"><span class="calibre_7">The Sub Decorator</span></a></li><li value="25" class="calibre_10">arguments, mutable objects as, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="26" class="calibre_10">arithmetic operations<ul class="calibre_135"><li value="1" class="calibre_13">on DataFrames, <a href="index_split_015.html#filepos617369"><span class="calibre_7">Arithmetic Operations</span></a>-<a href="index_split_015.html#filepos633672"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="2" class="calibre_10">on NumPy arrays, <a href="index_split_014.html#filepos448254"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a></li></ul></li><li value="27" class="calibre_10">arithmetic operators (pandas), corresponding methods for, <a href="index_split_015.html#filepos625775"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="28" class="calibre_10">array ranges, <a href="index_split_014.html#filepos471142"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="29" class="calibre_10">array-based formulas (xlwings), <a href="index_split_028.html#filepos1764379"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="30" class="calibre_10">arrays (NumPy)<ul class="calibre_135"><li value="1" class="calibre_13">broadcasting, <a href="index_split_014.html#filepos451025"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="2" class="calibre_10">constructors, <a href="index_split_014.html#filepos470880"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="3" class="calibre_10">data analysis issues in, <a href="index_split_014.html#filepos481110"><span class="calibre_7">Conclusion</span></a></li><li value="4" class="calibre_10">data types, <a href="index_split_014.html#filepos445451"><span class="calibre_7">NumPy Array</span></a>-<a href="index_split_014.html#filepos447897"><span class="calibre_7">NumPy Array</span></a></li><li value="5" class="calibre_10">getting and setting elements, <a href="index_split_014.html#filepos463404"><span class="calibre_7">Getting and Setting Array Elements</span></a>-<a href="index_split_014.html#filepos470575"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="6" class="calibre_10">operational overview, <a href="index_split_014.html#filepos434881"><span class="calibre_7">NumPy Array</span></a>-<a href="index_split_014.html#filepos448083"><span class="calibre_7">NumPy Array</span></a></li><li value="7" class="calibre_10">universal functions (ufuncs), <a href="index_split_014.html#filepos454337"><span class="calibre_7">Universal Functions (ufunc)</span></a>-<a href="index_split_014.html#filepos462582"><span class="calibre_7">Universal Functions (ufunc)</span></a></li><li value="8" class="calibre_10">vectorization, <a href="index_split_014.html#filepos448254"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="9" class="calibre_10">views versus copies, <a href="index_split_014.html#filepos475259"><span class="calibre_7">View vs. Copy</span></a>-<a href="index_split_014.html#filepos480562"><span class="calibre_7">View vs. Copy</span></a></li></ul></li><li value="31" class="calibre_10">asfreq method (pandas), <a href="index_split_017.html#filepos850558"><span class="calibre_7">Resampling</span></a></li><li value="32" class="calibre_10">attributes<ul class="calibre_135"><li value="1" class="calibre_13">help documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_011.html#filepos187275"><span class="calibre_7">Attributes and methods</span></a>, <a href="index_split_031.html#filepos1833311"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a></li></ul></li><li value="33" class="calibre_10">augmented assignment notation, <a href="index_split_012.html#filepos346050"><span class="calibre_7">The for and while Loops</span></a></li><li value="34" class="calibre_10">auto activation of Conda environments, disabling, <a href="index_split_029.html#filepos1818091"><span class="calibre_7">Disable Auto Activation</span></a></li><li value="35" class="calibre_10">autocomplete, <a href="index_split_009.html#filepos155542"><span class="calibre_7">Visual Studio Code</span></a></li><li value="36" class="calibre_10">autofit method (xlwings), <a href="index_split_025.html#filepos1409291"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li><li value="37" class="calibre_10">automation in Excel (see xlwings)</li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">B</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">backends<ul class="calibre_135"><li value="1" class="calibre_13">purpose of, <a href="index_split_027.html#filepos1606388"><span class="calibre_7">Frontend</span></a></li><li value="2" class="calibre_10">in Python Package Tracker, <a href="index_split_027.html#filepos1620020"><span class="calibre_7">Backend</span></a>-<a href="index_split_027.html#filepos1644241"><span class="calibre_7">Backend</span></a></li></ul></li><li value="2" class="calibre_10">best practices for programming<ul class="calibre_135"><li value="1" class="calibre_13">DRY principle, <a href="index_split_007.html#filepos46294"><span class="calibre_7">DRY principle</span></a></li><li value="2" class="calibre_10">separation of concerns, <a href="index_split_007.html#filepos41610"><span class="calibre_7">Separation of concerns</span></a>-<a href="index_split_007.html#filepos45911"><span class="calibre_7">Separation of concerns</span></a></li><li value="3" class="calibre_10">testing, <a href="index_split_007.html#filepos48860"><span class="calibre_7">Testing</span></a></li><li value="4" class="calibre_10">version control, <a href="index_split_007.html#filepos51713"><span class="calibre_7">Version control</span></a>-<a href="index_split_007.html#filepos57576"><span class="calibre_7">Version control</span></a></li></ul></li><li value="3" class="calibre_10">big data, <a href="index_split_003.html#filepos8884"><span class="calibre_7">Preface</span></a>, <a href="index_split_017.html#filepos860803"><span class="calibre_7">Limitations with pandas</span></a>, <a href="index_split_022.html#filepos1125159"><span class="calibre_7">Working with Big Excel Files</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="4" class="calibre_10">Binder, <a href="index_split_009.html#filepos152085"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="5" class="calibre_10">Bokeh, <a href="index_split_016.html#filepos739170"><span class="calibre_7">Plotly</span></a></li><li value="6" class="calibre_10">Book class (xlwings), <a href="index_split_024.html#filepos1256174"><span class="calibre_7">The Excel Object Model</span></a></li><li value="7" class="calibre_10">book object (xlwings), <a href="index_split_024.html#filepos1256174"><span class="calibre_7">The Excel Object Model</span></a></li><li value="8" class="calibre_10">books collection (xlwings), <a href="index_split_024.html#filepos1310200"><span class="calibre_7">The Excel Object Model</span></a></li><li value="9" class="calibre_10">bool constructor, <a href="index_split_011.html#filepos213851"><span class="calibre_7">Booleans</span></a></li><li value="10" class="calibre_10">boolean data type, <a href="index_split_011.html#filepos205063"><span class="calibre_7">Booleans</span></a>-<a href="index_split_011.html#filepos217752"><span class="calibre_7">Booleans</span></a>, <a href="index_split_019.html#filepos891785"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="11" class="calibre_10">boolean indexing (pandas)<ul class="calibre_135"><li value="1" class="calibre_13">selecting data by, <a href="index_split_015.html#filepos549780"><span class="calibre_7">Selecting by boolean indexing</span></a>-<a href="index_split_015.html#filepos567453"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="2" class="calibre_10">setting data by, <a href="index_split_015.html#filepos582259"><span class="calibre_7">Setting data by boolean indexing</span></a>-<a href="index_split_015.html#filepos589159"><span class="calibre_7">Setting data by boolean indexing</span></a></li></ul></li><li value="12" class="calibre_10">boolean operators, <a href="index_split_011.html#filepos205160"><span class="calibre_7">Booleans</span></a>, <a href="index_split_015.html#filepos554159"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="13" class="calibre_10">break statement, <a href="index_split_012.html#filepos335412"><span class="calibre_7">The for and while Loops</span></a></li><li value="14" class="calibre_10">breakpoints (VS Code), setting, <a href="index_split_028.html#filepos1758108"><span class="calibre_7">Debugging UDFs</span></a></li><li value="15" class="calibre_10">broadcasting, <a href="index_split_014.html#filepos451025"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a>, <a href="index_split_015.html#filepos628153"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="16" class="calibre_10">built-in converters (xlwings), <a href="index_split_025.html#filepos1340690"><span class="calibre_7">Converters and Options</span></a></li><li value="17" class="calibre_10">built-in options for range object (xlwings), <a href="index_split_025.html#filepos1345217"><span class="calibre_7">Converters and Options</span></a></li><li value="18" class="calibre_10">business intelligence (see Power BI)</li><li value="19" class="calibre_10">business layer, <a href="index_split_007.html#filepos44149"><span class="calibre_7">Separation of concerns</span></a></li><li value="20" class="calibre_10">ByRef function arguments (VBA), <a href="index_split_031.html#filepos1882872"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1887586"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a></li><li value="21" class="calibre_10">ByVal function arguments (VBA), <a href="index_split_031.html#filepos1882872"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1887586"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">C</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">cache decorator, <a href="index_split_028.html#filepos1793985"><span class="calibre_7">Caching</span></a></li><li value="2" class="calibre_10">caching, <a href="index_split_028.html#filepos1775539"><span class="calibre_7">Caching</span></a>-<a href="index_split_028.html#filepos1794980"><span class="calibre_7">Caching</span></a></li><li value="3" class="calibre_10">calculations, separate layer for, <a href="index_split_007.html#filepos45452"><span class="calibre_7">Separation of concerns</span></a></li><li value="4" class="calibre_10">calling functions, <a href="index_split_011.html#filepos185990"><span class="calibre_7">Functions</span></a>, <a href="index_split_012.html#filepos370297"><span class="calibre_7">Calling functions</span></a>, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="5" class="calibre_10">capitalize method (pandas), <a href="index_split_015.html#filepos634661"><span class="calibre_7">Working with Text Columns</span></a></li><li value="6" class="calibre_10">Cascading Style Sheets (CSS), <a href="index_split_022.html#filepos1222109"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="7" class="calibre_10">Case statement (VBA), <a href="index_split_011.html#filepos282660"><span class="calibre_7">Dictionaries</span></a></li><li value="8" class="calibre_10">case studies<ul class="calibre_135"><li value="1" class="calibre_13">Excel reporting, <a href="index_split_019.html#filepos864531"><span class="calibre_7">Case Study: Excel Reporting</span></a>-<a href="index_split_019.html#filepos885516"><span class="calibre_7">Case Study: Excel Reporting</span></a>, <a href="index_split_022.html#filepos1232433"><span class="calibre_7">Case Study (Revisited): Excel Reporting</span></a>, <a href="index_split_025.html#filepos1400987"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a>-<a href="index_split_025.html#filepos1409826"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li><li value="2" class="calibre_10">Google Trends case study<ul class="calibre_136"><li value="1" class="calibre_13">DataFrames and dynamic arrays, <a href="index_split_028.html#filepos1682486"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>-<a href="index_split_028.html#filepos1714516"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="2" class="calibre_10">debugging UDFs, <a href="index_split_028.html#filepos1755260"><span class="calibre_7">Debugging UDFs</span></a>-<a href="index_split_028.html#filepos1760605"><span class="calibre_7">Debugging UDFs</span></a></li><li value="3" class="calibre_10">explanation of Google Trends, <a href="index_split_028.html#filepos1680082"><span class="calibre_7">Introduction to Google Trends</span></a>-<a href="index_split_028.html#filepos1682295"><span class="calibre_7">Introduction to Google Trends</span></a></li><li value="4" class="calibre_10">fetching data, <a href="index_split_028.html#filepos1714798"><span class="calibre_7">Fetching Data from Google Trends</span></a>-<a href="index_split_028.html#filepos1741590"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="5" class="calibre_10">plotting data, <a href="index_split_028.html#filepos1741829"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1754939"><span class="calibre_7">Plotting with UDFs</span></a></li></ul></li><li value="3" class="calibre_10">Python Package Tracker<ul class="calibre_136"><li value="1" class="calibre_13">adding packages, <a href="index_split_027.html#filepos1489144"><span class="calibre_7">What We Will Build</span></a>-<a href="index_split_027.html#filepos1492009"><span class="calibre_7">What We Will Build</span></a></li><li value="2" class="calibre_10">application structure, <a href="index_split_027.html#filepos1601418"><span class="calibre_7">Application Structure</span></a></li><li value="3" class="calibre_10">backend, <a href="index_split_027.html#filepos1620020"><span class="calibre_7">Backend</span></a>-<a href="index_split_027.html#filepos1644241"><span class="calibre_7">Backend</span></a></li><li value="4" class="calibre_10">databases, <a href="index_split_027.html#filepos1515417"><span class="calibre_7">Databases</span></a>-<a href="index_split_027.html#filepos1579942"><span class="calibre_7">SQL injection</span></a></li><li value="5" class="calibre_10">debugging, <a href="index_split_027.html#filepos1644656"><span class="calibre_7">Debugging</span></a>-<a href="index_split_027.html#filepos1651460"><span class="calibre_7">Debugging</span></a></li><li value="6" class="calibre_10">error handling, <a href="index_split_027.html#filepos1580257"><span class="calibre_7">Exceptions</span></a>-<a href="index_split_027.html#filepos1601081"><span class="calibre_7">Exceptions</span></a></li><li value="7" class="calibre_10">frontend, <a href="index_split_027.html#filepos1606230"><span class="calibre_7">Frontend</span></a>-<a href="index_split_027.html#filepos1619827"><span class="calibre_7">Frontend</span></a></li><li value="8" class="calibre_10">web APIs, <a href="index_split_027.html#filepos1492808"><span class="calibre_7">Web APIs</span></a>-<a href="index_split_027.html#filepos1515072"><span class="calibre_7">Web APIs</span></a></li></ul></li></ul></li><li value="9" class="calibre_10">cd command, <a href="index_split_008.html#filepos111447"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="10" class="calibre_10">cell formatting (xlwings), clearing, <a href="index_split_025.html#filepos1429624"><span class="calibre_7">How to Work Around Missing Functionality</span></a>-<a href="index_split_025.html#filepos1435920"><span class="calibre_7">How to Work Around Missing Functionality</span></a></li><li value="11" class="calibre_10">cell looping, <a href="index_split_021.html#filepos974268"><span class="calibre_7">The excel.py Module</span></a></li><li value="12" class="calibre_10">cells (Jupyter notebooks)<ul class="calibre_135"><li value="1" class="calibre_13">edit mode versus command mode, <a href="index_split_009.html#filepos140230"><span class="calibre_7">Edit vs. Command Mode</span></a>-<a href="index_split_009.html#filepos145012"><span class="calibre_7">Edit vs. Command Mode</span></a></li><li value="2" class="calibre_10">in Python scripts, <a href="index_split_030.html#filepos1829327"><span class="calibre_7">Python Scripts with Code Cells</span></a></li><li value="3" class="calibre_10">operational overview, <a href="index_split_009.html#filepos134675"><span class="calibre_7">Notebook Cells</span></a>-<a href="index_split_009.html#filepos140068"><span class="calibre_7">Notebook Cells</span></a></li><li value="4" class="calibre_10">output, <a href="index_split_009.html#filepos137198"><span class="calibre_7">Notebook Cells</span></a></li><li value="5" class="calibre_10">run order, <a href="index_split_009.html#filepos145168"><span class="calibre_7">Run Order Matters</span></a></li></ul></li><li value="13" class="calibre_10">chaining indexing and slicing operations, <a href="index_split_011.html#filepos240871"><span class="calibre_7">Slicing</span></a>, <a href="index_split_014.html#filepos463605"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="14" class="calibre_10">changing<ul class="calibre_135"><li value="1" class="calibre_13">cell types (Jupyter notebooks), <a href="index_split_009.html#filepos138341"><span class="calibre_7">Notebook Cells</span></a></li><li value="2" class="calibre_10">directories, <a href="index_split_008.html#filepos111447"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="3" class="calibre_10">list separators (Excel), <a href="index_split_024.html#filepos1254107"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1255983"><span class="calibre_7">The Excel Object Model</span></a></li><li value="4" class="calibre_10">to parent directory, <a href="index_split_008.html#filepos112850"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="15" class="calibre_10">charts (Excel), <a href="index_split_016.html#filepos716676"><span class="calibre_7">Pivoting and Melting</span></a><ul class="calibre_135"><li value="1" class="calibre_13">(see also plots)</li><li value="2" class="calibre_10">creating in OpenPyXL, <a href="index_split_021.html#filepos996317"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="3" class="calibre_10">creating in XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a></li><li value="4" class="calibre_10">creating in xlwings, <a href="index_split_025.html#filepos1368049"><span class="calibre_7">Excel charts</span></a>-<a href="index_split_025.html#filepos1374395"><span class="calibre_7">Excel charts</span></a></li></ul></li><li value="16" class="calibre_10">class inheritance, <a href="index_split_007.html#filepos89951"><span class="calibre_7">Modern Language Features</span></a></li><li value="17" class="calibre_10">classes, <a href="index_split_011.html#filepos188185"><span class="calibre_7">Attributes and methods</span></a><ul class="calibre_135"><li value="1" class="calibre_13">instantiation, <a href="index_split_012.html#filepos394507"><span class="calibre_7">The datetime Class</span></a>, <a href="index_split_031.html#filepos1833058"><span class="calibre_7">Classes and Objects</span></a></li><li value="2" class="calibre_10">objects and, <a href="index_split_031.html#filepos1832657"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a></li></ul></li><li value="18" class="calibre_10">clearing cell formatting (xlwings), <a href="index_split_025.html#filepos1429624"><span class="calibre_7">How to Work Around Missing Functionality</span></a>-<a href="index_split_025.html#filepos1435920"><span class="calibre_7">How to Work Around Missing Functionality</span></a></li><li value="19" class="calibre_10">cloud providers for Jupyter notebooks, <a href="index_split_009.html#filepos151042"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="20" class="calibre_10">code blocks, <a href="index_split_011.html#filepos303668"><span class="calibre_7">Code Blocks and the pass Statement</span></a>-<a href="index_split_012.html#filepos306087"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="21" class="calibre_10">code cells (Jupyter notebooks), <a href="index_split_009.html#filepos137960"><span class="calibre_7">Notebook Cells</span></a></li><li value="22" class="calibre_10">code command (VS Code), <a href="index_split_009.html#filepos165226"><span class="calibre_7">Running a Python Script</span></a></li><li value="23" class="calibre_10">collections (xlwings)<ul class="calibre_135"><li value="1" class="calibre_13">charts (Excel), creating, <a href="index_split_025.html#filepos1368049"><span class="calibre_7">Excel charts</span></a>-<a href="index_split_025.html#filepos1374395"><span class="calibre_7">Excel charts</span></a></li><li value="2" class="calibre_10">defined names (Excel), creating, <a href="index_split_025.html#filepos1390078"><span class="calibre_7">Defined names</span></a>-<a href="index_split_025.html#filepos1400526"><span class="calibre_7">Defined names</span></a></li><li value="3" class="calibre_10">pictures (Excel), Matplotlib plots as, <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_024.html#filepos1252253"><span class="calibre_7">The Excel Object Model</span></a></li></ul></li><li value="24" class="calibre_10">colors, hexadecimal values for, <a href="index_split_021.html#filepos1032314"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="25" class="calibre_10">columns (pandas)<ul class="calibre_135"><li value="1" class="calibre_13">adding to DataFrame, <a href="index_split_015.html#filepos592331"><span class="calibre_7">Setting data by adding a new column</span></a></li><li value="2" class="calibre_10">for DataFrames, <a href="index_split_015.html#filepos512954"><span class="calibre_7">Columns</span></a>-<a href="index_split_015.html#filepos524119"><span class="calibre_7">Columns</span></a>, <a href="index_split_022.html#filepos1170468"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a>-<a href="index_split_022.html#filepos1205120"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a></li><li value="3" class="calibre_10">selecting, <a href="index_split_015.html#filepos537621"><span class="calibre_7">Selecting by label</span></a></li></ul></li><li value="26" class="calibre_10">COM (Component Object Model), <a href="index_split_025.html#filepos1411455"><span class="calibre_7">xlwings Foundations</span></a></li><li value="27" class="calibre_10">combining DataFrames<ul class="calibre_135"><li value="1" class="calibre_13">concatenation, <a href="index_split_016.html#filepos653577"><span class="calibre_7">Concatenating</span></a>-<a href="index_split_016.html#filepos667519"><span class="calibre_7">Concatenating</span></a></li><li value="2" class="calibre_10">joining, <a href="index_split_016.html#filepos667765"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="3" class="calibre_10">merging, <a href="index_split_016.html#filepos682873"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li></ul></li><li value="28" class="calibre_10">command history, scrolling through, <a href="index_split_008.html#filepos113245"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="29" class="calibre_10">command mode (Jupyter notebooks), <a href="index_split_009.html#filepos140230"><span class="calibre_7">Edit vs. Command Mode</span></a>-<a href="index_split_009.html#filepos145012"><span class="calibre_7">Edit vs. Command Mode</span></a></li><li value="30" class="calibre_10">Command Palette (VS Code), <a href="index_split_009.html#filepos163380"><span class="calibre_7">Installation and Configuration</span></a></li><li value="31" class="calibre_10">Command Prompt (Windows), <a href="index_split_008.html#filepos102144"><span class="calibre_7">Anaconda Prompt</span></a><ul class="calibre_135"><li value="1" class="calibre_13">debugging with, <a href="index_split_027.html#filepos1650611"><span class="calibre_7">Debugging</span></a></li><li value="2" class="calibre_10">disabling auto activation of Conda environment, <a href="index_split_029.html#filepos1818813"><span class="calibre_7">Disable Auto Activation</span></a></li></ul></li><li value="32" class="calibre_10">commands in Anaconda Prompt, list of, <a href="index_split_008.html#filepos106145"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="33" class="calibre_10">comments in Python, <a href="index_split_011.html#filepos201944"><span class="calibre_7">Mathematical operators</span></a></li><li value="34" class="calibre_10">complex data type, <a href="index_split_011.html#filepos194226"><span class="calibre_7">Numeric Types</span></a></li><li value="35" class="calibre_10">composite keys (databases), <a href="index_split_027.html#filepos1527951"><span class="calibre_7">The Package Tracker database</span></a></li><li value="36" class="calibre_10">concat function (pandas), <a href="index_split_016.html#filepos653577"><span class="calibre_7">Concatenating</span></a>-<a href="index_split_016.html#filepos667519"><span class="calibre_7">Concatenating</span></a>, <a href="index_split_017.html#filepos831244"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="37" class="calibre_10">concatenating<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames, <a href="index_split_016.html#filepos653577"><span class="calibre_7">Concatenating</span></a>-<a href="index_split_016.html#filepos667519"><span class="calibre_7">Concatenating</span></a></li><li value="2" class="calibre_10">lists, <a href="index_split_011.html#filepos246001"><span class="calibre_7">Lists</span></a></li><li value="3" class="calibre_10">strings, <a href="index_split_011.html#filepos218479"><span class="calibre_7">Strings</span></a></li><li value="4" class="calibre_10">tuples, <a href="index_split_011.html#filepos288158"><span class="calibre_7">Tuples</span></a></li></ul></li><li value="38" class="calibre_10">Conda, <a href="index_split_008.html#filepos119343"><span class="calibre_7">Package Managers: Conda and pip</span></a>-<a href="index_split_008.html#filepos127083"><span class="calibre_7">Package Managers: Conda and pip</span></a><ul class="calibre_135"><li value="1" class="calibre_13">commands, <a href="index_split_008.html#filepos120708"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="2" class="calibre_10">environments, <a href="index_split_008.html#filepos127438"><span class="calibre_7">Conda Environments</span></a><ul class="calibre_136"><li value="1" class="calibre_13">creating, <a href="index_split_029.html#filepos1812140"><span class="calibre_7">Create a New Conda Environment</span></a>-<a href="index_split_029.html#filepos1817881"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="2" class="calibre_10">disabling auto activation, <a href="index_split_029.html#filepos1818091"><span class="calibre_7">Disable Auto Activation</span></a></li><li value="3" class="calibre_10">purpose of, <a href="index_split_029.html#filepos1811202"><span class="calibre_7">Conda Environments</span></a></li></ul></li><li value="3" class="calibre_10">pip versus, <a href="index_split_008.html#filepos120576"><span class="calibre_7">Package Managers: Conda and pip</span></a></li></ul></li><li value="39" class="calibre_10">conditional expressions, <a href="index_split_012.html#filepos314525"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="40" class="calibre_10">conditional formatting in Python Package Tracker, <a href="index_split_027.html#filepos1615600"><span class="calibre_7">Frontend</span></a></li><li value="41" class="calibre_10">configuration hierarchy for xlwings, <a href="index_split_026.html#filepos1478189"><span class="calibre_7">Configuration Hierarchy</span></a></li><li value="42" class="calibre_10">configuring VS Code, <a href="index_split_009.html#filepos160636"><span class="calibre_7">Installation and Configuration</span></a>-<a href="index_split_009.html#filepos164899"><span class="calibre_7">Installation and Configuration</span></a></li><li value="43" class="calibre_10">connections to databases, <a href="index_split_027.html#filepos1529652"><span class="calibre_7">Database connections</span></a>-<a href="index_split_027.html#filepos1537920"><span class="calibre_7">Database connections</span></a></li><li value="44" class="calibre_10">constant memory (XlsxWriter), <a href="index_split_022.html#filepos1130401"><span class="calibre_7">Writing with XlsxWriter</span></a></li><li value="45" class="calibre_10">constructors for arrays (NumPy), <a href="index_split_014.html#filepos470880"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="46" class="calibre_10">context managers, <a href="index_split_019.html#filepos910651"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="47" class="calibre_10">Continue button (VS Code debugger), <a href="index_split_030.html#filepos1823390"><span class="calibre_7">Debugger</span></a></li><li value="48" class="calibre_10">continue statement, <a href="index_split_012.html#filepos337705"><span class="calibre_7">The for and while Loops</span></a></li><li value="49" class="calibre_10">control flow<ul class="calibre_135"><li value="1" class="calibre_13">code blocks, <a href="index_split_011.html#filepos303668"><span class="calibre_7">Code Blocks and the pass Statement</span></a>-<a href="index_split_012.html#filepos306087"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="2" class="calibre_10">conditional expressions, <a href="index_split_012.html#filepos314525"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="3" class="calibre_10">dictionary comprehensions, <a href="index_split_012.html#filepos355651"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="4" class="calibre_10">for loops, <a href="index_split_012.html#filepos316683"><span class="calibre_7">The for and while Loops</span></a>-<a href="index_split_012.html#filepos341967"><span class="calibre_7">The for and while Loops</span></a></li><li value="5" class="calibre_10">if statements, <a href="index_split_012.html#filepos306285"><span class="calibre_7">The if Statement and Conditional Expressions</span></a>-<a href="index_split_012.html#filepos316429"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="6" class="calibre_10">list comprehensions, <a href="index_split_012.html#filepos347118"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="7" class="calibre_10">pass statement, <a href="index_split_011.html#filepos303668"><span class="calibre_7">Code Blocks and the pass Statement</span></a>-<a href="index_split_012.html#filepos306087"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="8" class="calibre_10">set comprehensions, <a href="index_split_012.html#filepos358997"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="9" class="calibre_10">while loops, <a href="index_split_012.html#filepos343907"><span class="calibre_7">The for and while Loops</span></a></li></ul></li><li value="50" class="calibre_10">converters (xlwings), <a href="index_split_025.html#filepos1340690"><span class="calibre_7">Converters and Options</span></a></li><li value="51" class="calibre_10">converting<ul class="calibre_135"><li value="1" class="calibre_13">data types with excel.py module, <a href="index_split_021.html#filepos973831"><span class="calibre_7">The excel.py Module</span></a>-<a href="index_split_021.html#filepos977785"><span class="calibre_7">The excel.py Module</span></a></li><li value="2" class="calibre_10">indices to columns (pandas), <a href="index_split_015.html#filepos502052"><span class="calibre_7">Index</span></a></li><li value="3" class="calibre_10">objects to boolean data type, <a href="index_split_019.html#filepos891785"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="4" class="calibre_10">strings to datetime data type, <a href="index_split_017.html#filepos783176"><span class="calibre_7">Creating a DatetimeIndex</span></a></li></ul></li><li value="52" class="calibre_10">Coordinated Universal Time (UTC), <a href="index_split_017.html#filepos805006"><span class="calibre_7">Working with Time Zones</span></a>, <a href="index_split_031.html#filepos1848164"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="53" class="calibre_10">copies (DataFrames)<ul class="calibre_135"><li value="1" class="calibre_13">returned by methods, <a href="index_split_015.html#filepos506311"><span class="calibre_7">Index</span></a></li><li value="2" class="calibre_10">views versus, <a href="index_split_015.html#filepos649623"><span class="calibre_7">View vs. Copy</span></a></li></ul></li><li value="54" class="calibre_10">copies (NumPy), views versus, <a href="index_split_014.html#filepos475259"><span class="calibre_7">View vs. Copy</span></a>-<a href="index_split_014.html#filepos480562"><span class="calibre_7">View vs. Copy</span></a></li><li value="55" class="calibre_10">copy method, shallow versus deep copies, <a href="index_split_031.html#filepos1881031"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="56" class="calibre_10">corr method (pandas), <a href="index_split_017.html#filepos838567"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="57" class="calibre_10">correlation in time series analysis, <a href="index_split_017.html#filepos822133"><span class="calibre_7">Rebasing and Correlation</span></a>-<a href="index_split_017.html#filepos846848"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="58" class="calibre_10">counter variables in loops, <a href="index_split_012.html#filepos340077"><span class="calibre_7">The for and while Loops</span></a></li><li value="59" class="calibre_10">COVID-19 test results, delayed reporting, <a href="index_split_007.html#filepos39115"><span class="calibre_7">Excel in the News</span></a></li><li value="60" class="calibre_10">CPU times, <a href="index_split_022.html#filepos1148285"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="61" class="calibre_10">cross-application calls (xlwings), minimizing, <a href="index_split_025.html#filepos1416834"><span class="calibre_7">Minimize cross-application calls</span></a>, <a href="index_split_028.html#filepos1762196"><span class="calibre_7">Minimize cross-application calls</span></a>-<a href="index_split_028.html#filepos1770595"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="62" class="calibre_10">cross-platform compatibility, <a href="index_split_007.html#filepos90342"><span class="calibre_7">Cross-Platform Compatibility</span></a></li><li value="63" class="calibre_10">CSE arrays (Excel), <a href="index_split_028.html#filepos1695089"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="64" class="calibre_10">CSS (Cascading Style Sheets), <a href="index_split_022.html#filepos1222109"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="65" class="calibre_10">CSV files<ul class="calibre_135"><li value="1" class="calibre_13">exporting DataFrame data as, <a href="index_split_016.html#filepos745826"><span class="calibre_7">Exporting CSV Files</span></a>-<a href="index_split_016.html#filepos748395"><span class="calibre_7">Exporting CSV Files</span></a></li><li value="2" class="calibre_10">importing to DataFrames, <a href="index_split_016.html#filepos748628"><span class="calibre_7">Importing CSV Files</span></a>-<a href="index_split_016.html#filepos764876"><span class="calibre_7">Importing CSV Files</span></a></li></ul></li><li value="66" class="calibre_10">cuDF, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a></li><li value="67" class="calibre_10">current directory<ul class="calibre_135"><li value="1" class="calibre_13">in Windows, listing files in, <a href="index_split_008.html#filepos110263"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">in macOS<ul class="calibre_136"><li value="1" class="calibre_13">listing files in, <a href="index_split_008.html#filepos110600"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">viewing full path, <a href="index_split_008.html#filepos105254"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li></ul></li><li value="68" class="calibre_10">custom add-ins (xlwings), <a href="index_split_026.html#filepos1477721"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a>, <a href="index_split_028.html#filepos1678327"><span class="calibre_7">UDF Quickstart</span></a></li><li value="69" class="calibre_10">custom functions (see UDFs)</li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">D</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">Dask, <a href="index_split_017.html#filepos860975"><span class="calibre_7">Limitations with pandas</span></a></li><li value="2" class="calibre_10">data alignment (pandas), <a href="index_split_015.html#filepos483705"><span class="calibre_7">Data Analysis with pandas</span></a>, <a href="index_split_015.html#filepos509147"><span class="calibre_7">Index</span></a>, <a href="index_split_015.html#filepos619204"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="3" class="calibre_10">Data Analysis Expressions (DAX), <a href="index_split_003.html#filepos9339"><span class="calibre_7">Preface</span></a></li><li value="4" class="calibre_10">data analysis with pandas (see pandas)</li><li value="5" class="calibre_10">data layer, <a href="index_split_007.html#filepos44428"><span class="calibre_7">Separation of concerns</span></a></li><li value="6" class="calibre_10">data parts (DataFrames), formatting, <a href="index_split_022.html#filepos1205675"><span class="calibre_7">Formatting a DataFrame’s data part</span></a>-<a href="index_split_022.html#filepos1224706"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="7" class="calibre_10">data structures<ul class="calibre_135"><li value="1" class="calibre_13">dictionaries, <a href="index_split_011.html#filepos268897"><span class="calibre_7">Dictionaries</span></a>-<a href="index_split_011.html#filepos285555"><span class="calibre_7">Dictionaries</span></a></li><li value="2" class="calibre_10">list of, <a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="3" class="calibre_10">lists, <a href="index_split_011.html#filepos243228"><span class="calibre_7">Lists</span></a>-<a href="index_split_011.html#filepos268531"><span class="calibre_7">Lists</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_011.html#filepos242442"><span class="calibre_7">Data Structures</span></a></li><li value="5" class="calibre_10">sets, <a href="index_split_011.html#filepos290624"><span class="calibre_7">Sets</span></a>-<a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="6" class="calibre_10">tuples, <a href="index_split_011.html#filepos285858"><span class="calibre_7">Tuples</span></a></li><li value="7" class="calibre_10">in VBA, <a href="index_split_011.html#filepos242442"><span class="calibre_7">Data Structures</span></a></li></ul></li><li value="8" class="calibre_10">data types<ul class="calibre_135"><li value="1" class="calibre_13">boolean, <a href="index_split_011.html#filepos205063"><span class="calibre_7">Booleans</span></a>-<a href="index_split_011.html#filepos217752"><span class="calibre_7">Booleans</span></a>, <a href="index_split_019.html#filepos891785"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="2" class="calibre_10">converting with excel.py module, <a href="index_split_021.html#filepos973831"><span class="calibre_7">The excel.py Module</span></a>-<a href="index_split_021.html#filepos977785"><span class="calibre_7">The excel.py Module</span></a></li><li value="3" class="calibre_10">in DataFrames, <a href="index_split_015.html#filepos498597"><span class="calibre_7">DataFrame and Series</span></a></li><li value="4" class="calibre_10">datetime, converting strings to, <a href="index_split_017.html#filepos783176"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="5" class="calibre_10">mutable versus immutable, <a href="index_split_031.html#filepos1865731"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="6" class="calibre_10">numeric, <a href="index_split_011.html#filepos189160"><span class="calibre_7">Numeric Types</span></a>-<a href="index_split_011.html#filepos194525"><span class="calibre_7">Numeric Types</span></a></li><li value="7" class="calibre_10">of NumPy arrays, <a href="index_split_014.html#filepos445451"><span class="calibre_7">NumPy Array</span></a>-<a href="index_split_014.html#filepos447897"><span class="calibre_7">NumPy Array</span></a></li><li value="8" class="calibre_10">purpose of, <a href="index_split_010.html#filepos180377"><span class="calibre_7">Data Types</span></a></li><li value="9" class="calibre_10">strings, <a href="index_split_011.html#filepos217986"><span class="calibre_7">Strings</span></a>-<a href="index_split_011.html#filepos227137"><span class="calibre_7">Strings</span></a></li></ul></li><li value="9" class="calibre_10">data validation in Python Package Tracker, <a href="index_split_027.html#filepos1614044"><span class="calibre_7">Frontend</span></a></li><li value="10" class="calibre_10">Data Viewer (VS Code), <a href="index_split_030.html#filepos1828467"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="11" class="calibre_10">data viewer, Excel as, <a href="index_split_024.html#filepos1239513"><span class="calibre_7">Using Excel as Data Viewer</span></a>-<a href="index_split_024.html#filepos1248699"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="12" class="calibre_10">database.py example, <a href="index_split_027.html#filepos1634047"><span class="calibre_7">Backend</span></a></li><li value="13" class="calibre_10">databases<ul class="calibre_135"><li value="1" class="calibre_13">connections, <a href="index_split_027.html#filepos1529652"><span class="calibre_7">Database connections</span></a>-<a href="index_split_027.html#filepos1537920"><span class="calibre_7">Database connections</span></a></li><li value="2" class="calibre_10">SQL injection, <a href="index_split_027.html#filepos1563158"><span class="calibre_7">SQL injection</span></a>-<a href="index_split_027.html#filepos1579942"><span class="calibre_7">SQL injection</span></a></li><li value="3" class="calibre_10">SQL queries, <a href="index_split_027.html#filepos1538233"><span class="calibre_7">SQL queries</span></a>-<a href="index_split_027.html#filepos1562882"><span class="calibre_7">SQL queries</span></a></li><li value="4" class="calibre_10">structure for Python Package Tracker case study, <a href="index_split_027.html#filepos1520310"><span class="calibre_7">The Package Tracker database</span></a>-<a href="index_split_027.html#filepos1529401"><span class="calibre_7">The Package Tracker database</span></a></li><li value="5" class="calibre_10">types of, <a href="index_split_027.html#filepos1515417"><span class="calibre_7">Databases</span></a>-<a href="index_split_027.html#filepos1519777"><span class="calibre_7">Databases</span></a></li></ul></li><li value="14" class="calibre_10">DataFrames<ul class="calibre_135"><li value="1" class="calibre_13">applying functions, <a href="index_split_015.html#filepos641087"><span class="calibre_7">Applying a Function</span></a>-<a href="index_split_015.html#filepos649303"><span class="calibre_7">Applying a Function</span></a></li><li value="2" class="calibre_10">arithmetic operations, <a href="index_split_015.html#filepos617369"><span class="calibre_7">Arithmetic Operations</span></a>-<a href="index_split_015.html#filepos633672"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="3" class="calibre_10">columns, <a href="index_split_015.html#filepos512954"><span class="calibre_7">Columns</span></a>-<a href="index_split_015.html#filepos524119"><span class="calibre_7">Columns</span></a></li><li value="4" class="calibre_10">concatenating, <a href="index_split_016.html#filepos653577"><span class="calibre_7">Concatenating</span></a>-<a href="index_split_016.html#filepos667519"><span class="calibre_7">Concatenating</span></a></li><li value="5" class="calibre_10">copies<ul class="calibre_136"><li value="1" class="calibre_13">returned by methods, <a href="index_split_015.html#filepos506311"><span class="calibre_7">Index</span></a></li><li value="2" class="calibre_10">views versus, <a href="index_split_015.html#filepos649623"><span class="calibre_7">View vs. Copy</span></a></li></ul></li><li value="6" class="calibre_10">creating, <a href="index_split_015.html#filepos489479"><span class="calibre_7">DataFrame and Series</span></a></li><li value="7" class="calibre_10">descriptive statistics, <a href="index_split_016.html#filepos691290"><span class="calibre_7">Descriptive Statistics</span></a>-<a href="index_split_016.html#filepos695190"><span class="calibre_7">Descriptive Statistics</span></a></li><li value="8" class="calibre_10">duplicate data, <a href="index_split_015.html#filepos608897"><span class="calibre_7">Duplicate Data</span></a>-<a href="index_split_015.html#filepos617033"><span class="calibre_7">Duplicate Data</span></a></li><li value="9" class="calibre_10">Excel spreadsheets versus, <a href="index_split_015.html#filepos485631"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos489337"><span class="calibre_7">DataFrame and Series</span></a></li><li value="10" class="calibre_10">exploration methods, <a href="index_split_016.html#filepos758459"><span class="calibre_7">Importing CSV Files</span></a></li><li value="11" class="calibre_10">exporting<ul class="calibre_136"><li value="1" class="calibre_13">as CSV files, <a href="index_split_016.html#filepos745826"><span class="calibre_7">Exporting CSV Files</span></a>-<a href="index_split_016.html#filepos748395"><span class="calibre_7">Exporting CSV Files</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_016.html#filepos740480"><span class="calibre_7">Importing and Exporting DataFrames</span></a></li></ul></li><li value="12" class="calibre_10">formatting in Excel, <a href="index_split_022.html#filepos1157749"><span class="calibre_7">Formatting DataFrames in Excel</span></a>-<a href="index_split_022.html#filepos1224706"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="13" class="calibre_10">in Google Trends case study, <a href="index_split_028.html#filepos1682486"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>-<a href="index_split_028.html#filepos1714516"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="14" class="calibre_10">grouping data, <a href="index_split_016.html#filepos695504"><span class="calibre_7">Grouping</span></a></li><li value="15" class="calibre_10">importing<ul class="calibre_136"><li value="1" class="calibre_13">as CSV files, <a href="index_split_016.html#filepos748628"><span class="calibre_7">Importing CSV Files</span></a>-<a href="index_split_016.html#filepos764876"><span class="calibre_7">Importing CSV Files</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_016.html#filepos740480"><span class="calibre_7">Importing and Exporting DataFrames</span></a></li></ul></li><li value="16" class="calibre_10">indices, <a href="index_split_015.html#filepos498949"><span class="calibre_7">Index</span></a>-<a href="index_split_015.html#filepos512717"><span class="calibre_7">Index</span></a></li><li value="17" class="calibre_10">joining, <a href="index_split_016.html#filepos667765"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="18" class="calibre_10">limitations, <a href="index_split_017.html#filepos860285"><span class="calibre_7">Limitations with pandas</span></a></li><li value="19" class="calibre_10">melting data, <a href="index_split_016.html#filepos712684"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="20" class="calibre_10">merging, <a href="index_split_016.html#filepos682873"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="21" class="calibre_10">missing data, <a href="index_split_015.html#filepos598810"><span class="calibre_7">Missing Data</span></a>-<a href="index_split_015.html#filepos608614"><span class="calibre_7">Missing Data</span></a></li><li value="22" class="calibre_10">pivoting data, <a href="index_split_016.html#filepos701536"><span class="calibre_7">Pivoting and Melting</span></a>-<a href="index_split_016.html#filepos716422"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="23" class="calibre_10">plotting<ul class="calibre_136"><li value="1" class="calibre_13">list of plotting libraries, <a href="index_split_016.html#filepos738084"><span class="calibre_7">Plotly</span></a></li><li value="2" class="calibre_10">with Matplotlib, <a href="index_split_016.html#filepos717479"><span class="calibre_7">Matplotlib</span></a>-<a href="index_split_016.html#filepos727877"><span class="calibre_7">Matplotlib</span></a></li><li value="3" class="calibre_10">with Plotly, <a href="index_split_016.html#filepos728120"><span class="calibre_7">Plotly</span></a>-<a href="index_split_016.html#filepos737814"><span class="calibre_7">Plotly</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_016.html#filepos716977"><span class="calibre_7">Plotting</span></a></li></ul></li><li value="24" class="calibre_10">reading/writing in Excel with xlwings, <a href="index_split_025.html#filepos1324128"><span class="calibre_7">Working with DataFrames</span></a>-<a href="index_split_025.html#filepos1340369"><span class="calibre_7">Working with DataFrames</span></a></li><li value="25" class="calibre_10">selecting data<ul class="calibre_136"><li value="1" class="calibre_13">by boolean indexing, <a href="index_split_015.html#filepos549780"><span class="calibre_7">Selecting by boolean indexing</span></a>-<a href="index_split_015.html#filepos567453"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="2" class="calibre_10">by label, <a href="index_split_015.html#filepos525461"><span class="calibre_7">Selecting by label</span></a>-<a href="index_split_015.html#filepos538911"><span class="calibre_7">Selecting by label</span></a></li><li value="3" class="calibre_10">with MultiIndexes, <a href="index_split_015.html#filepos567793"><span class="calibre_7">Selecting by using a MultiIndex</span></a>-<a href="index_split_015.html#filepos575571"><span class="calibre_7">Selecting by using a MultiIndex</span></a></li><li value="4" class="calibre_10">by position, <a href="index_split_015.html#filepos539083"><span class="calibre_7">Selecting by position</span></a>-<a href="index_split_015.html#filepos549467"><span class="calibre_7">Selecting by position</span></a></li></ul></li><li value="26" class="calibre_10">Series versus, <a href="index_split_015.html#filepos484520"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos485550"><span class="calibre_7">DataFrame and Series</span></a>, <a href="index_split_015.html#filepos536695"><span class="calibre_7">Selecting by label</span></a></li><li value="27" class="calibre_10">setting data<ul class="calibre_136"><li value="1" class="calibre_13">by adding columns, <a href="index_split_015.html#filepos592331"><span class="calibre_7">Setting data by adding a new column</span></a></li><li value="2" class="calibre_10">by boolean indexing, <a href="index_split_015.html#filepos582259"><span class="calibre_7">Setting data by boolean indexing</span></a>-<a href="index_split_015.html#filepos589159"><span class="calibre_7">Setting data by boolean indexing</span></a></li><li value="3" class="calibre_10">by label, <a href="index_split_015.html#filepos576247"><span class="calibre_7">Setting data by label or position</span></a></li><li value="4" class="calibre_10">by position, <a href="index_split_015.html#filepos576247"><span class="calibre_7">Setting data by label or position</span></a></li><li value="5" class="calibre_10">by replacing values, <a href="index_split_015.html#filepos589332"><span class="calibre_7">Setting data by replacing values</span></a></li></ul></li><li value="28" class="calibre_10">SQL queries versus, <a href="index_split_027.html#filepos1540168"><span class="calibre_7">SQL queries</span></a></li><li value="29" class="calibre_10">text columns, <a href="index_split_015.html#filepos634000"><span class="calibre_7">Working with Text Columns</span></a></li><li value="30" class="calibre_10">time series analysis (see time series analysis)</li><li value="31" class="calibre_10">transposing, <a href="index_split_015.html#filepos520188"><span class="calibre_7">Columns</span></a></li></ul></li><li value="15" class="calibre_10">date serial number (Excel), <a href="index_split_012.html#filepos393168"><span class="calibre_7">The datetime Class</span></a></li><li value="16" class="calibre_10">datetime data type, converting strings to, <a href="index_split_017.html#filepos783176"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="17" class="calibre_10">datetime module, <a href="index_split_012.html#filepos392883"><span class="calibre_7">The datetime Class</span></a>-<a href="index_split_012.html#filepos408810"><span class="calibre_7">The datetime Class</span></a>, <a href="index_split_031.html#filepos1848019"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a>-<a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="18" class="calibre_10">DatetimeIndex (pandas)<ul class="calibre_135"><li value="1" class="calibre_13">creating, <a href="index_split_017.html#filepos770795"><span class="calibre_7">Creating a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos794737"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="2" class="calibre_10">filtering, <a href="index_split_017.html#filepos794993"><span class="calibre_7">Filtering a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos798956"><span class="calibre_7">Filtering a DatetimeIndex</span></a></li><li value="3" class="calibre_10">time zones in, <a href="index_split_017.html#filepos799257"><span class="calibre_7">Working with Time Zones</span></a>-<a href="index_split_017.html#filepos808759"><span class="calibre_7">Working with Time Zones</span></a></li></ul></li><li value="19" class="calibre_10">dateutil package, <a href="index_split_031.html#filepos1848527"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="20" class="calibre_10">date_range function (pandas), <a href="index_split_017.html#filepos770851"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="21" class="calibre_10">DAX (Data Analysis Expressions), <a href="index_split_003.html#filepos9339"><span class="calibre_7">Preface</span></a></li><li value="22" class="calibre_10">deactivating Conda environments, <a href="index_split_029.html#filepos1816090"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="23" class="calibre_10">debugging<ul class="calibre_135"><li value="1" class="calibre_13">Python Package Tracker, <a href="index_split_027.html#filepos1644656"><span class="calibre_7">Debugging</span></a>-<a href="index_split_027.html#filepos1651460"><span class="calibre_7">Debugging</span></a></li><li value="2" class="calibre_10">in text editor, <a href="index_split_009.html#filepos156231"><span class="calibre_7">Visual Studio Code</span></a></li><li value="3" class="calibre_10">UDFs, <a href="index_split_028.html#filepos1755260"><span class="calibre_7">Debugging UDFs</span></a>-<a href="index_split_028.html#filepos1760605"><span class="calibre_7">Debugging UDFs</span></a></li><li value="4" class="calibre_10">in VS Code, <a href="index_split_030.html#filepos1821433"><span class="calibre_7">Debugger</span></a>-<a href="index_split_030.html#filepos1825904"><span class="calibre_7">Debugger</span></a></li></ul></li><li value="24" class="calibre_10">decimal data type, <a href="index_split_011.html#filepos194226"><span class="calibre_7">Numeric Types</span></a></li><li value="25" class="calibre_10">declarative languages, <a href="index_split_027.html#filepos1538408"><span class="calibre_7">SQL queries</span></a></li><li value="26" class="calibre_10">decorators (xlwings)<ul class="calibre_135"><li value="1" class="calibre_13">order of, <a href="index_split_028.html#filepos1709067"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_028.html#filepos1661857"><span class="calibre_7">UDF Quickstart</span></a></li><li value="3" class="calibre_10">sub decorator, <a href="index_split_028.html#filepos1795393"><span class="calibre_7">The Sub Decorator</span></a>-<a href="index_split_028.html#filepos1804381"><span class="calibre_7">The Sub Decorator</span></a></li></ul></li><li value="27" class="calibre_10">deep copies, <a href="index_split_031.html#filepos1881228"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="28" class="calibre_10">def keyword, <a href="index_split_012.html#filepos362541"><span class="calibre_7">Defining functions</span></a></li><li value="29" class="calibre_10">default arguments, mutable objects as, <a href="index_split_031.html#filepos1896791"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="30" class="calibre_10">defined names (Excel), creating in xlwings, <a href="index_split_025.html#filepos1390078"><span class="calibre_7">Defined names</span></a>-<a href="index_split_025.html#filepos1400526"><span class="calibre_7">Defined names</span></a></li><li value="31" class="calibre_10">defining functions, <a href="index_split_012.html#filepos362480"><span class="calibre_7">Defining functions</span></a></li><li value="32" class="calibre_10">del statement (lists), <a href="index_split_011.html#filepos260070"><span class="calibre_7">Lists</span></a></li><li value="33" class="calibre_10">deleting<ul class="calibre_135"><li value="1" class="calibre_13">columns (pandas), <a href="index_split_015.html#filepos517912"><span class="calibre_7">Columns</span></a></li><li value="2" class="calibre_10">Conda environments, <a href="index_split_029.html#filepos1816460"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="3" class="calibre_10">elements from lists, <a href="index_split_011.html#filepos260070"><span class="calibre_7">Lists</span></a></li></ul></li><li value="34" class="calibre_10">dependencies<ul class="calibre_135"><li value="1" class="calibre_13">xlwings deployment, <a href="index_split_026.html#filepos1472746"><span class="calibre_7">Python Dependency</span></a>-<a href="index_split_026.html#filepos1475110"><span class="calibre_7">Python Dependency</span></a></li><li value="2" class="calibre_10">in xlwings, <a href="index_split_025.html#filepos1410868"><span class="calibre_7">xlwings Foundations</span></a></li></ul></li><li value="35" class="calibre_10">deployment<ul class="calibre_135"><li value="1" class="calibre_13">defined, <a href="index_split_026.html#filepos1472064"><span class="calibre_7">Deployment</span></a></li><li value="2" class="calibre_10">of xlwings<ul class="calibre_136"><li value="1" class="calibre_13">configuration hierarchy, <a href="index_split_026.html#filepos1478189"><span class="calibre_7">Configuration Hierarchy</span></a></li><li value="2" class="calibre_10">Python dependencies, <a href="index_split_026.html#filepos1472746"><span class="calibre_7">Python Dependency</span></a>-<a href="index_split_026.html#filepos1475110"><span class="calibre_7">Python Dependency</span></a></li><li value="3" class="calibre_10">settings, <a href="index_split_026.html#filepos1480593"><span class="calibre_7">Settings</span></a>-<a href="index_split_026.html#filepos1484138"><span class="calibre_7">Settings</span></a></li><li value="4" class="calibre_10">standalone workbooks, <a href="index_split_026.html#filepos1475399"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a>-<a href="index_split_026.html#filepos1477920"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a></li></ul></li></ul></li><li value="36" class="calibre_10">describe.py example, <a href="index_split_028.html#filepos1682978"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="37" class="calibre_10">descriptive statistics, <a href="index_split_016.html#filepos691290"><span class="calibre_7">Descriptive Statistics</span></a>-<a href="index_split_016.html#filepos695190"><span class="calibre_7">Descriptive Statistics</span></a></li><li value="38" class="calibre_10">deterministic functions, <a href="index_split_028.html#filepos1775539"><span class="calibre_7">Caching</span></a></li><li value="39" class="calibre_10">development environment (see Anaconda; Jupyter notebooks; VS Code)</li><li value="40" class="calibre_10">dict constructor, <a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="41" class="calibre_10">dictionaries, <a href="index_split_011.html#filepos268897"><span class="calibre_7">Dictionaries</span></a>-<a href="index_split_011.html#filepos285555"><span class="calibre_7">Dictionaries</span></a></li><li value="42" class="calibre_10">dictionary comprehensions, <a href="index_split_012.html#filepos355651"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="43" class="calibre_10">dir command, <a href="index_split_008.html#filepos110263"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="44" class="calibre_10">directories<ul class="calibre_135"><li value="1" class="calibre_13">changing, <a href="index_split_008.html#filepos111447"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">current directory<ul class="calibre_136"><li value="1" class="calibre_13">listing files in, <a href="index_split_008.html#filepos110263"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">viewing full path, <a href="index_split_008.html#filepos105254"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="3" class="calibre_10">parent directory, changing to, <a href="index_split_008.html#filepos112850"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="45" class="calibre_10">disabling auto activation of Conda environments, <a href="index_split_029.html#filepos1818091"><span class="calibre_7">Disable Auto Activation</span></a></li><li value="46" class="calibre_10">docstrings, <a href="index_split_012.html#filepos420835"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a></li><li value="47" class="calibre_10">documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="48" class="calibre_10">dot notation, <a href="index_split_011.html#filepos187525"><span class="calibre_7">Attributes and methods</span></a></li><li value="49" class="calibre_10">downsampling, <a href="index_split_017.html#filepos847090"><span class="calibre_7">Resampling</span></a></li><li value="50" class="calibre_10">drivers (for databases), <a href="index_split_027.html#filepos1529652"><span class="calibre_7">Database connections</span></a>-<a href="index_split_027.html#filepos1537920"><span class="calibre_7">Database connections</span></a></li><li value="51" class="calibre_10">dropna method (pandas), <a href="index_split_015.html#filepos602631"><span class="calibre_7">Missing Data</span></a></li><li value="52" class="calibre_10">drop_duplicates method (pandas), <a href="index_split_015.html#filepos609015"><span class="calibre_7">Duplicate Data</span></a></li><li value="53" class="calibre_10">DRY principle, <a href="index_split_007.html#filepos46294"><span class="calibre_7">DRY principle</span></a></li><li value="54" class="calibre_10">duplicate data in DataFrames, <a href="index_split_015.html#filepos608897"><span class="calibre_7">Duplicate Data</span></a>-<a href="index_split_015.html#filepos617033"><span class="calibre_7">Duplicate Data</span></a></li><li value="55" class="calibre_10">duplicated method (pandas), <a href="index_split_015.html#filepos612773"><span class="calibre_7">Duplicate Data</span></a></li><li value="56" class="calibre_10">dynamic arrays (Excel), <a href="index_split_028.html#filepos1682486"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>-<a href="index_split_028.html#filepos1714516"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="57" class="calibre_10">dynamic typing, <a href="index_split_010.html#filepos183257"><span class="calibre_7">Variables</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">E</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">edit mode (Jupyter notebooks), <a href="index_split_009.html#filepos140230"><span class="calibre_7">Edit vs. Command Mode</span></a>-<a href="index_split_009.html#filepos145012"><span class="calibre_7">Edit vs. Command Mode</span></a></li><li value="2" class="calibre_10">editing files (Excel)<ul class="calibre_135"><li value="1" class="calibre_13">with OpenPyXL, <a href="index_split_021.html#filepos1033340"><span class="calibre_7">Editing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1039562"><span class="calibre_7">Editing with OpenPyXL</span></a></li><li value="2" class="calibre_10">with xlutils, <a href="index_split_022.html#filepos1119688"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li><li value="3" class="calibre_10">elements of arrays (NumPy), getting and setting, <a href="index_split_014.html#filepos463404"><span class="calibre_7">Getting and Setting Array Elements</span></a>-<a href="index_split_014.html#filepos470575"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="4" class="calibre_10">Emacs, <a href="index_split_009.html#filepos174170"><span class="calibre_7">Running a Python Script</span></a></li><li value="5" class="calibre_10">enabling macros (Excel), <a href="index_split_026.html#filepos1459885"><span class="calibre_7">RunPython Function</span></a></li><li value="6" class="calibre_10">ending interactive Python session, <a href="index_split_008.html#filepos118780"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="7" class="calibre_10">endpoints, <a href="index_split_027.html#filepos1505232"><span class="calibre_7">Web APIs</span></a></li><li value="8" class="calibre_10">engine parameter (read_excel or to_excel functions), <a href="index_split_021.html#filepos971083"><span class="calibre_7">When to Use Which Package</span></a></li><li value="9" class="calibre_10">enumerate function, <a href="index_split_012.html#filepos328659"><span class="calibre_7">The for and while Loops</span></a></li><li value="10" class="calibre_10">environment variables, <a href="index_split_026.html#filepos1482074"><span class="calibre_7">Settings</span></a></li><li value="11" class="calibre_10">error handling<ul class="calibre_135"><li value="1" class="calibre_13">in Python Package Tracker, <a href="index_split_027.html#filepos1580257"><span class="calibre_7">Exceptions</span></a>-<a href="index_split_027.html#filepos1601081"><span class="calibre_7">Exceptions</span></a></li><li value="2" class="calibre_10">in VBA, <a href="index_split_007.html#filepos81423"><span class="calibre_7">Modern Language Features</span></a></li></ul></li><li value="12" class="calibre_10">escape characters in strings, <a href="index_split_011.html#filepos219648"><span class="calibre_7">Strings</span></a></li><li value="13" class="calibre_10">EuSpRIG (European Spreadsheet Risks Interest Group), <a href="index_split_007.html#filepos40774"><span class="calibre_7">Excel in the News</span></a></li><li value="14" class="calibre_10">examples<ul class="calibre_135"><li value="1" class="calibre_13">add_package function (Python Package Tracker), <a href="index_split_027.html#filepos1621394"><span class="calibre_7">Backend</span></a>-<a href="index_split_027.html#filepos1633823"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">database.py, <a href="index_split_027.html#filepos1634047"><span class="calibre_7">Backend</span></a></li><li value="3" class="calibre_10">describe.py, <a href="index_split_028.html#filepos1682978"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="4" class="calibre_10">first_project.py, <a href="index_split_026.html#filepos1449910"><span class="calibre_7">Run Main</span></a>-<a href="index_split_026.html#filepos1458891"><span class="calibre_7">Run Main</span></a></li><li value="5" class="calibre_10">first_udf.py, <a href="index_split_028.html#filepos1659823"><span class="calibre_7">UDF Quickstart</span></a></li><li value="6" class="calibre_10">get_interest_over_time function (google_trends.py), <a href="index_split_028.html#filepos1735053"><span class="calibre_7">Fetching Data from Google Trends</span></a>-<a href="index_split_028.html#filepos1738598"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="7" class="calibre_10">importsub.py, <a href="index_split_028.html#filepos1796656"><span class="calibre_7">The Sub Decorator</span></a></li><li value="8" class="calibre_10">pep8_sample.py, <a href="index_split_012.html#filepos409133"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a>-<a href="index_split_012.html#filepos425840"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a></li><li value="9" class="calibre_10">plot function (google_trends.py), <a href="index_split_028.html#filepos1742308"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1753405"><span class="calibre_7">Plotting with UDFs</span></a></li><li value="10" class="calibre_10">revenues.py, <a href="index_split_028.html#filepos1764661"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="11" class="calibre_10">sales_report_pandas.py, <a href="index_split_019.html#filepos871006"><span class="calibre_7">Case Study: Excel Reporting</span></a>-<a href="index_split_019.html#filepos884117"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="12" class="calibre_10">sales_report_xlwings.py, <a href="index_split_025.html#filepos1403162"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li><li value="13" class="calibre_10">temperature.py, <a href="index_split_012.html#filepos377100"><span class="calibre_7">Modules and the import Statement</span></a></li></ul></li><li value="15" class="calibre_10">Excel<ul class="calibre_135"><li value="1" class="calibre_13">array-based calculations, <a href="index_split_014.html#filepos453400"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="2" class="calibre_10">automation (see xlwings)</li><li value="3" class="calibre_10">charts, <a href="index_split_016.html#filepos716676"><span class="calibre_7">Pivoting and Melting</span></a><ul class="calibre_136"><li value="1" class="calibre_13">(see also plots)</li><li value="2" class="calibre_10">creating in OpenPyXL, <a href="index_split_021.html#filepos996317"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="3" class="calibre_10">creating in XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a></li><li value="4" class="calibre_10">creating in xlwings, <a href="index_split_025.html#filepos1368049"><span class="calibre_7">Excel charts</span></a>-<a href="index_split_025.html#filepos1374395"><span class="calibre_7">Excel charts</span></a></li></ul></li><li value="4" class="calibre_10">as data viewer, <a href="index_split_024.html#filepos1239513"><span class="calibre_7">Using Excel as Data Viewer</span></a>-<a href="index_split_024.html#filepos1248699"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="5" class="calibre_10">DataFrames, reading/writing with xlwings, <a href="index_split_025.html#filepos1324128"><span class="calibre_7">Working with DataFrames</span></a>-<a href="index_split_025.html#filepos1340369"><span class="calibre_7">Working with DataFrames</span></a></li><li value="6" class="calibre_10">date serial number, <a href="index_split_012.html#filepos393168"><span class="calibre_7">The datetime Class</span></a></li><li value="7" class="calibre_10">defined names, creating in xlwings, <a href="index_split_025.html#filepos1390078"><span class="calibre_7">Defined names</span></a>-<a href="index_split_025.html#filepos1400526"><span class="calibre_7">Defined names</span></a></li><li value="8" class="calibre_10">files (see files)</li><li value="9" class="calibre_10">floats in, <a href="index_split_011.html#filepos193692"><span class="calibre_7">Numeric Types</span></a></li><li value="10" class="calibre_10">formatting DataFrames in, <a href="index_split_022.html#filepos1157749"><span class="calibre_7">Formatting DataFrames in Excel</span></a>-<a href="index_split_022.html#filepos1224706"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="11" class="calibre_10">as frontend<ul class="calibre_136"><li value="1" class="calibre_13">installing xlwings add-in, <a href="index_split_026.html#filepos1442113"><span class="calibre_7">Excel Add-in</span></a>-<a href="index_split_026.html#filepos1447961"><span class="calibre_7">Excel Add-in</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_026.html#filepos1440971"><span class="calibre_7">Using Excel as Frontend with xlwings</span></a></li><li value="3" class="calibre_10">quickstart command, <a href="index_split_026.html#filepos1448302"><span class="calibre_7">Quickstart Command</span></a></li><li value="4" class="calibre_10">Run main button, <a href="index_split_026.html#filepos1449910"><span class="calibre_7">Run Main</span></a>-<a href="index_split_026.html#filepos1458891"><span class="calibre_7">Run Main</span></a></li><li value="5" class="calibre_10">RunPython function, <a href="index_split_026.html#filepos1459375"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1471460"><span class="calibre_7">RunPython without quickstart command</span></a></li></ul></li><li value="12" class="calibre_10">history of, <a href="index_split_007.html#filepos33602"><span class="calibre_7">Why Python for Excel?</span></a></li><li value="13" class="calibre_10">instances, <a href="index_split_024.html#filepos1252360"><span class="calibre_7">The Excel Object Model</span></a>, <a href="index_split_024.html#filepos1296280"><span class="calibre_7">The Excel Object Model</span></a></li><li value="14" class="calibre_10">Jupyter notebooks versus, <a href="index_split_008.html#filepos131000"><span class="calibre_7">Jupyter Notebooks</span></a></li><li value="15" class="calibre_10">language and regional settings, <a href="index_split_024.html#filepos1254107"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1255983"><span class="calibre_7">The Excel Object Model</span></a></li><li value="16" class="calibre_10">logarithms in, <a href="index_split_017.html#filepos810574"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="17" class="calibre_10">macOS permissions, <a href="index_split_024.html#filepos1249144"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="18" class="calibre_10">modern Excel, <a href="index_split_007.html#filepos58283"><span class="calibre_7">Modern Excel</span></a></li><li value="19" class="calibre_10">Name Manager, <a href="index_split_025.html#filepos1399895"><span class="calibre_7">Defined names</span></a></li><li value="20" class="calibre_10">in news stories, <a href="index_split_007.html#filepos38612"><span class="calibre_7">Excel in the News</span></a>-<a href="index_split_007.html#filepos41040"><span class="calibre_7">Excel in the News</span></a></li><li value="21" class="calibre_10">object model, <a href="index_split_024.html#filepos1250235"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1313152"><span class="calibre_7">The Excel Object Model</span></a></li><li value="22" class="calibre_10">pictures, Matplotlib plots as, <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="23" class="calibre_10">as programming language, <a href="index_split_007.html#filepos35748"><span class="calibre_7">Excel Is a Programming Language</span></a>-<a href="index_split_007.html#filepos38457"><span class="calibre_7">Excel Is a Programming Language</span></a></li><li value="24" class="calibre_10">programming, reading/writing files versus, <a href="index_split_005.html#filepos18185"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="25" class="calibre_10">Python advantages for, <a href="index_split_007.html#filepos62589"><span class="calibre_7">Python for Excel</span></a><ul class="calibre_136"><li value="1" class="calibre_13">cross-platform compatibility, <a href="index_split_007.html#filepos90342"><span class="calibre_7">Cross-Platform Compatibility</span></a></li><li value="2" class="calibre_10">modern language features, <a href="index_split_007.html#filepos80870"><span class="calibre_7">Modern Language Features</span></a>-<a href="index_split_007.html#filepos89951"><span class="calibre_7">Modern Language Features</span></a></li><li value="3" class="calibre_10">readability, <a href="index_split_007.html#filepos64414"><span class="calibre_7">Readability and Maintainability</span></a>-<a href="index_split_007.html#filepos71415"><span class="calibre_7">Readability and Maintainability</span></a></li><li value="4" class="calibre_10">scientific computing, <a href="index_split_007.html#filepos76559"><span class="calibre_7">Scientific Computing</span></a></li><li value="5" class="calibre_10">standard library and package manager, <a href="index_split_007.html#filepos71589"><span class="calibre_7">Standard Library and Package Manager</span></a>-<a href="index_split_007.html#filepos76314"><span class="calibre_7">Standard Library and Package Manager</span></a></li></ul></li><li value="26" class="calibre_10">reporting case study, <a href="index_split_019.html#filepos864531"><span class="calibre_7">Case Study: Excel Reporting</span></a>-<a href="index_split_019.html#filepos885516"><span class="calibre_7">Case Study: Excel Reporting</span></a>, <a href="index_split_022.html#filepos1232433"><span class="calibre_7">Case Study (Revisited): Excel Reporting</span></a>, <a href="index_split_025.html#filepos1400987"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a>-<a href="index_split_025.html#filepos1409826"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li><li value="27" class="calibre_10">spreadsheets, DataFrames versus, <a href="index_split_015.html#filepos485631"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos489337"><span class="calibre_7">DataFrame and Series</span></a></li><li value="28" class="calibre_10">standalone workbooks, <a href="index_split_026.html#filepos1475399"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a>-<a href="index_split_026.html#filepos1477920"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a></li><li value="29" class="calibre_10">time series analysis limitations, <a href="index_split_017.html#filepos768348"><span class="calibre_7">Time Series Analysis with pandas</span></a></li><li value="30" class="calibre_10">Trust access to VBA project model setting, <a href="index_split_028.html#filepos1656916"><span class="calibre_7">Getting Started with UDFs</span></a></li><li value="31" class="calibre_10">used range, <a href="index_split_021.html#filepos1099306"><span class="calibre_7">Reading with xlrd</span></a></li><li value="32" class="calibre_10">version control, <a href="index_split_007.html#filepos51713"><span class="calibre_7">Version control</span></a>-<a href="index_split_007.html#filepos57576"><span class="calibre_7">Version control</span></a></li><li value="33" class="calibre_10">versions of, <a href="index_split_005.html#filepos19959"><span class="calibre_7">Python and Excel Versions</span></a>-<a href="index_split_005.html#filepos20478"><span class="calibre_7">Python and Excel Versions</span></a></li><li value="34" class="calibre_10">zombie processes, <a href="index_split_025.html#filepos1412114"><span class="calibre_7">xlwings Foundations</span></a></li></ul></li><li value="16" class="calibre_10">excel.py module, <a href="index_split_021.html#filepos972622"><span class="calibre_7">The excel.py Module</span></a>-<a href="index_split_021.html#filepos980989"><span class="calibre_7">The excel.py Module</span></a></li><li value="17" class="calibre_10">ExcelFile class (pandas), <a href="index_split_019.html#filepos886398"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>-<a href="index_split_019.html#filepos935481"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="18" class="calibre_10">ExcelWriter class (pandas), <a href="index_split_019.html#filepos935768"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a>-<a href="index_split_019.html#filepos953568"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a></li><li value="19" class="calibre_10">exceptions (see error handling)</li><li value="20" class="calibre_10">expand method (xlwings), <a href="index_split_025.html#filepos1333572"><span class="calibre_7">Working with DataFrames</span></a></li><li value="21" class="calibre_10">exporting DataFrame data<ul class="calibre_135"><li value="1" class="calibre_13">as CSV files, <a href="index_split_016.html#filepos745826"><span class="calibre_7">Exporting CSV Files</span></a>-<a href="index_split_016.html#filepos748395"><span class="calibre_7">Exporting CSV Files</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_016.html#filepos740480"><span class="calibre_7">Importing and Exporting DataFrames</span></a></li></ul></li><li value="22" class="calibre_10">extracting macro code (Xlsxwriter) from xlsm files, <a href="index_split_021.html#filepos1064438"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066693"><span class="calibre_7">XlsxWriter</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">F</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">f-strings (formatted string literals), <a href="index_split_011.html#filepos222026"><span class="calibre_7">Strings</span></a></li><li value="2" class="calibre_10">False boolean data type, <a href="index_split_011.html#filepos205063"><span class="calibre_7">Booleans</span></a>-<a href="index_split_011.html#filepos217752"><span class="calibre_7">Booleans</span></a></li><li value="3" class="calibre_10">ffill method (pandas), <a href="index_split_017.html#filepos850748"><span class="calibre_7">Resampling</span></a></li><li value="4" class="calibre_10">figure object (Matplotlib), <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="5" class="calibre_10">file extensions, viewing, <a href="index_split_008.html#filepos113417"><span class="calibre_7">Anaconda Prompt</span></a>-<a href="index_split_008.html#filepos114549"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="6" class="calibre_10">file paths<ul class="calibre_135"><li value="1" class="calibre_13">absolute versus relative, <a href="index_split_027.html#filepos1638593"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">globbing, <a href="index_split_019.html#filepos884117"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="3" class="calibre_10">Path class, <a href="index_split_019.html#filepos882885"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="4" class="calibre_10">in Windows as raw strings, <a href="index_split_016.html#filepos747454"><span class="calibre_7">Exporting CSV Files</span></a></li></ul></li><li value="7" class="calibre_10">files<ul class="calibre_135"><li value="1" class="calibre_13">in current directory, listing, <a href="index_split_008.html#filepos110263"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">editing<ul class="calibre_136"><li value="1" class="calibre_13">with OpenPyXL, <a href="index_split_021.html#filepos1033340"><span class="calibre_7">Editing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1039562"><span class="calibre_7">Editing with OpenPyXL</span></a></li><li value="2" class="calibre_10">with xlutils, <a href="index_split_022.html#filepos1119688"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li><li value="3" class="calibre_10">reading<ul class="calibre_136"><li value="1" class="calibre_13">limitations in pandas, <a href="index_split_019.html#filepos957495"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></a></li><li value="2" class="calibre_10">with OpenPyXL, <a href="index_split_021.html#filepos982131"><span class="calibre_7">Reading with OpenPyXL</span></a>-<a href="index_split_021.html#filepos996210"><span class="calibre_7">Writing with OpenPyXL</span></a>, <a href="index_split_022.html#filepos1141062"><span class="calibre_7">Reading with OpenPyXL</span></a></li><li value="3" class="calibre_10">with pandas, <a href="index_split_019.html#filepos886398"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>-<a href="index_split_019.html#filepos935481"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="4" class="calibre_10">in parallel, <a href="index_split_022.html#filepos1144410"><span class="calibre_7">Reading sheets in parallel</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="5" class="calibre_10">programming Excel versus, <a href="index_split_005.html#filepos18185"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="6" class="calibre_10">with pyxlsb, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="7" class="calibre_10">from URLs, <a href="index_split_019.html#filepos922687"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="8" class="calibre_10">with xlrd, <a href="index_split_021.html#filepos1085917"><span class="calibre_7">Reading with xlrd</span></a>-<a href="index_split_021.html#filepos1099832"><span class="calibre_7">Reading with xlrd</span></a>, <a href="index_split_022.html#filepos1134915"><span class="calibre_7">Reading with xlrd</span></a></li></ul></li><li value="4" class="calibre_10">writing<ul class="calibre_136"><li value="1" class="calibre_13">limitations in pandas, <a href="index_split_019.html#filepos957495"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></a></li><li value="2" class="calibre_10">with OpenPyXL, <a href="index_split_021.html#filepos996317"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a>, <a href="index_split_022.html#filepos1126036"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="3" class="calibre_10">with pandas, <a href="index_split_019.html#filepos935768"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a>-<a href="index_split_019.html#filepos953568"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a></li><li value="4" class="calibre_10">programming Excel versus, <a href="index_split_005.html#filepos18185"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="5" class="calibre_10">with XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a>, <a href="index_split_022.html#filepos1130359"><span class="calibre_7">Writing with XlsxWriter</span></a></li><li value="6" class="calibre_10">with xlwt, <a href="index_split_022.html#filepos1099995"><span class="calibre_7">Writing with xlwt</span></a>-<a href="index_split_022.html#filepos1119593"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li></ul></li><li value="8" class="calibre_10">fillna method (pandas), <a href="index_split_015.html#filepos606608"><span class="calibre_7">Missing Data</span></a></li><li value="9" class="calibre_10">filtering<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames, <a href="index_split_015.html#filepos549780"><span class="calibre_7">Selecting by boolean indexing</span></a>-<a href="index_split_015.html#filepos567453"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="2" class="calibre_10">DatetimeIndex (pandas), <a href="index_split_017.html#filepos794993"><span class="calibre_7">Filtering a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos798956"><span class="calibre_7">Filtering a DatetimeIndex</span></a></li></ul></li><li value="10" class="calibre_10">first_project.py example, <a href="index_split_026.html#filepos1449910"><span class="calibre_7">Run Main</span></a>-<a href="index_split_026.html#filepos1458891"><span class="calibre_7">Run Main</span></a></li><li value="11" class="calibre_10">first_udf.py example, <a href="index_split_028.html#filepos1659823"><span class="calibre_7">UDF Quickstart</span></a></li><li value="12" class="calibre_10">flake8, <a href="index_split_012.html#filepos426532"><span class="calibre_7">PEP 8 and VS Code</span></a></li><li value="13" class="calibre_10">float data type, <a href="index_split_011.html#filepos189160"><span class="calibre_7">Numeric Types</span></a>-<a href="index_split_011.html#filepos194525"><span class="calibre_7">Numeric Types</span></a></li><li value="14" class="calibre_10">float64 data type (NumPy), <a href="index_split_014.html#filepos445451"><span class="calibre_7">NumPy Array</span></a>-<a href="index_split_014.html#filepos446866"><span class="calibre_7">NumPy Array</span></a></li><li value="15" class="calibre_10">floating-point inaccuracies, <a href="index_split_011.html#filepos194705"><span class="calibre_7">Numeric Types</span></a></li><li value="16" class="calibre_10">floating-point numbers, <a href="index_split_011.html#filepos189272"><span class="calibre_7">Numeric Types</span></a></li><li value="17" class="calibre_10">For Each statement (VBA), <a href="index_split_012.html#filepos319389"><span class="calibre_7">The for and while Loops</span></a></li><li value="18" class="calibre_10">for loops, <a href="index_split_012.html#filepos316683"><span class="calibre_7">The for and while Loops</span></a>-<a href="index_split_012.html#filepos341967"><span class="calibre_7">The for and while Loops</span></a></li><li value="19" class="calibre_10">foreign keys (databases), <a href="index_split_027.html#filepos1528709"><span class="calibre_7">The Package Tracker database</span></a>, <a href="index_split_027.html#filepos1562373"><span class="calibre_7">SQL queries</span></a></li><li value="20" class="calibre_10">Form Controls (Excel), <a href="index_split_026.html#filepos1464639"><span class="calibre_7">RunPython Function</span></a></li><li value="21" class="calibre_10">formatting<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames in Excel, <a href="index_split_022.html#filepos1157749"><span class="calibre_7">Formatting DataFrames in Excel</span></a>-<a href="index_split_022.html#filepos1224706"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="2" class="calibre_10">datetime objects into strings, <a href="index_split_012.html#filepos404852"><span class="calibre_7">The datetime Class</span></a></li><li value="3" class="calibre_10">strings in DataFrames, <a href="index_split_015.html#filepos641289"><span class="calibre_7">Applying a Function</span></a>-<a href="index_split_015.html#filepos645020"><span class="calibre_7">Applying a Function</span></a></li></ul></li><li value="22" class="calibre_10">forward-filling, <a href="index_split_017.html#filepos850748"><span class="calibre_7">Resampling</span></a></li><li value="23" class="calibre_10">fraction data type, <a href="index_split_011.html#filepos194226"><span class="calibre_7">Numeric Types</span></a></li><li value="24" class="calibre_10">frontends<ul class="calibre_135"><li value="1" class="calibre_13">defined, <a href="index_split_026.html#filepos1440971"><span class="calibre_7">Using Excel as Frontend with xlwings</span></a></li><li value="2" class="calibre_10">Excel as<ul class="calibre_136"><li value="1" class="calibre_13">installing xlwings add-in, <a href="index_split_026.html#filepos1442113"><span class="calibre_7">Excel Add-in</span></a>-<a href="index_split_026.html#filepos1447961"><span class="calibre_7">Excel Add-in</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_026.html#filepos1440971"><span class="calibre_7">Using Excel as Frontend with xlwings</span></a></li><li value="3" class="calibre_10">quickstart command, <a href="index_split_026.html#filepos1448302"><span class="calibre_7">Quickstart Command</span></a></li><li value="4" class="calibre_10">Run main button, <a href="index_split_026.html#filepos1449910"><span class="calibre_7">Run Main</span></a>-<a href="index_split_026.html#filepos1458891"><span class="calibre_7">Run Main</span></a></li><li value="5" class="calibre_10">RunPython function, <a href="index_split_026.html#filepos1459375"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1471460"><span class="calibre_7">RunPython without quickstart command</span></a></li></ul></li><li value="3" class="calibre_10">purpose of, <a href="index_split_027.html#filepos1606292"><span class="calibre_7">Frontend</span></a></li><li value="4" class="calibre_10">in Python Package Tracker, <a href="index_split_027.html#filepos1606230"><span class="calibre_7">Frontend</span></a>-<a href="index_split_027.html#filepos1619827"><span class="calibre_7">Frontend</span></a></li></ul></li><li value="25" class="calibre_10">frozen executables, <a href="index_split_026.html#filepos1475043"><span class="calibre_7">Python Dependency</span></a></li><li value="26" class="calibre_10">full outer joins, <a href="index_split_016.html#filepos669216"><span class="calibre_7">Joining and Merging</span></a></li><li value="27" class="calibre_10">functions<ul class="calibre_135"><li value="1" class="calibre_13">applying to DataFrames, <a href="index_split_015.html#filepos641087"><span class="calibre_7">Applying a Function</span></a>-<a href="index_split_015.html#filepos649303"><span class="calibre_7">Applying a Function</span></a></li><li value="2" class="calibre_10">calling, <a href="index_split_011.html#filepos185990"><span class="calibre_7">Functions</span></a>, <a href="index_split_012.html#filepos370297"><span class="calibre_7">Calling functions</span></a>, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="3" class="calibre_10">decorators (xlwings)<ul class="calibre_136"><li value="1" class="calibre_13">order of, <a href="index_split_028.html#filepos1709067"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_028.html#filepos1661857"><span class="calibre_7">UDF Quickstart</span></a></li><li value="3" class="calibre_10">sub decorator, <a href="index_split_028.html#filepos1795393"><span class="calibre_7">The Sub Decorator</span></a>-<a href="index_split_028.html#filepos1804381"><span class="calibre_7">The Sub Decorator</span></a></li></ul></li><li value="4" class="calibre_10">defining, <a href="index_split_012.html#filepos362480"><span class="calibre_7">Defining functions</span></a></li><li value="5" class="calibre_10">deterministic, <a href="index_split_028.html#filepos1775539"><span class="calibre_7">Caching</span></a></li><li value="6" class="calibre_10">lambda expressions, <a href="index_split_015.html#filepos645164"><span class="calibre_7">Applying a Function</span></a></li><li value="7" class="calibre_10">purpose of, <a href="index_split_012.html#filepos361996"><span class="calibre_7">Functions</span></a></li><li value="8" class="calibre_10">recalculating (Excel), <a href="index_split_028.html#filepos1671914"><span class="calibre_7">UDF Quickstart</span></a></li><li value="9" class="calibre_10">universal functions (NumPy), <a href="index_split_014.html#filepos454337"><span class="calibre_7">Universal Functions (ufunc)</span></a>-<a href="index_split_014.html#filepos462582"><span class="calibre_7">Universal Functions (ufunc)</span></a></li><li value="10" class="calibre_10">user-defined functions (see UDFs)</li><li value="11" class="calibre_10">VBA, <a href="index_split_007.html#filepos46886"><span class="calibre_7">DRY principle</span></a>, <a href="index_split_025.html#filepos1322194"><span class="calibre_7">Running VBA Code</span></a></li><li value="12" class="calibre_10">volatile (Excel), <a href="index_split_028.html#filepos1673786"><span class="calibre_7">UDF Quickstart</span></a></li></ul></li><li value="28" class="calibre_10">functools module, <a href="index_split_028.html#filepos1784463"><span class="calibre_7">Caching</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">G</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">get method (dictionaries), <a href="index_split_011.html#filepos281077"><span class="calibre_7">Dictionaries</span></a></li><li value="2" class="calibre_10">GET requests, <a href="index_split_027.html#filepos1493322"><span class="calibre_7">Web APIs</span></a></li><li value="3" class="calibre_10">getting array elements (NumPy), <a href="index_split_014.html#filepos463404"><span class="calibre_7">Getting and Setting Array Elements</span></a>-<a href="index_split_014.html#filepos470575"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="4" class="calibre_10">get_interest_over_time function (google_trends.py) example, <a href="index_split_028.html#filepos1735053"><span class="calibre_7">Fetching Data from Google Trends</span></a>-<a href="index_split_028.html#filepos1738598"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="5" class="calibre_10">Git, <a href="index_split_007.html#filepos51713"><span class="calibre_7">Version control</span></a>-<a href="index_split_007.html#filepos57576"><span class="calibre_7">Version control</span></a></li><li value="6" class="calibre_10">globbing, <a href="index_split_019.html#filepos884117"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="7" class="calibre_10">Google Colab, <a href="index_split_009.html#filepos152972"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="8" class="calibre_10">Google style guide for Python, <a href="index_split_012.html#filepos425552"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a></li><li value="9" class="calibre_10">Google Trends case study<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames and dynamic arrays, <a href="index_split_028.html#filepos1682486"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>-<a href="index_split_028.html#filepos1714516"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="2" class="calibre_10">debugging UDFs, <a href="index_split_028.html#filepos1755260"><span class="calibre_7">Debugging UDFs</span></a>-<a href="index_split_028.html#filepos1760605"><span class="calibre_7">Debugging UDFs</span></a></li><li value="3" class="calibre_10">explanation of Google Trends, <a href="index_split_028.html#filepos1680082"><span class="calibre_7">Introduction to Google Trends</span></a>-<a href="index_split_028.html#filepos1682295"><span class="calibre_7">Introduction to Google Trends</span></a></li><li value="4" class="calibre_10">fetching data, <a href="index_split_028.html#filepos1714798"><span class="calibre_7">Fetching Data from Google Trends</span></a>-<a href="index_split_028.html#filepos1741590"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="5" class="calibre_10">plotting data, <a href="index_split_028.html#filepos1741829"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1754939"><span class="calibre_7">Plotting with UDFs</span></a></li></ul></li><li value="10" class="calibre_10">graphical user interfaces (see frontends)</li><li value="11" class="calibre_10">gridlines (Excel), hiding, <a href="index_split_027.html#filepos1616277"><span class="calibre_7">Frontend</span></a></li><li value="12" class="calibre_10">grouping DataFrame data, <a href="index_split_016.html#filepos695504"><span class="calibre_7">Grouping</span></a></li><li value="13" class="calibre_10">GUIs (see frontends)</li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">H</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">head method (pandas), <a href="index_split_016.html#filepos750501"><span class="calibre_7">Importing CSV Files</span></a></li><li value="2" class="calibre_10">headers for DataFrame columns, <a href="index_split_022.html#filepos1170468"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a>-<a href="index_split_022.html#filepos1205120"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a></li><li value="3" class="calibre_10">heatmaps (Plotly), <a href="index_split_017.html#filepos838730"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="4" class="calibre_10">help documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="5" class="calibre_10">hexadecimal values for colors, <a href="index_split_021.html#filepos1032314"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="6" class="calibre_10">hiding gridlines (Excel), <a href="index_split_027.html#filepos1616277"><span class="calibre_7">Frontend</span></a></li><li value="7" class="calibre_10">HoloViews, <a href="index_split_016.html#filepos740040"><span class="calibre_7">Plotly</span></a></li><li value="8" class="calibre_10">homogenous data, <a href="index_split_014.html#filepos439635"><span class="calibre_7">NumPy Array</span></a></li><li value="9" class="calibre_10">Horror Stories web page, <a href="index_split_007.html#filepos40739"><span class="calibre_7">Excel in the News</span></a></li><li value="10" class="calibre_10">HTTP status codes, <a href="index_split_027.html#filepos1508263"><span class="calibre_7">Web APIs</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">I</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">Ibis, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a></li><li value="2" class="calibre_10">IDEs (integrated development environments), <a href="index_split_009.html#filepos156885"><span class="calibre_7">Visual Studio Code</span></a>, <a href="index_split_009.html#filepos174247"><span class="calibre_7">Running a Python Script</span></a>-<a href="index_split_009.html#filepos176621"><span class="calibre_7">Running a Python Script</span></a></li><li value="3" class="calibre_10">if statements, <a href="index_split_012.html#filepos306285"><span class="calibre_7">The if Statement and Conditional Expressions</span></a>-<a href="index_split_012.html#filepos316429"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="4" class="calibre_10">iloc attribute (pandas), <a href="index_split_015.html#filepos539083"><span class="calibre_7">Selecting by position</span></a>-<a href="index_split_015.html#filepos549467"><span class="calibre_7">Selecting by position</span></a>, <a href="index_split_015.html#filepos581974"><span class="calibre_7">Setting data by label or position</span></a></li><li value="5" class="calibre_10">immutable objects, <a href="index_split_011.html#filepos285912"><span class="calibre_7">Tuples</span></a>, <a href="index_split_031.html#filepos1865519"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a>-<a href="index_split_031.html#filepos1882596"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="6" class="calibre_10">implicit line breaks, <a href="index_split_011.html#filepos256242"><span class="calibre_7">Lists</span></a></li><li value="7" class="calibre_10">import statement, <a href="index_split_012.html#filepos376420"><span class="calibre_7">Modules and the import Statement</span></a>-<a href="index_split_012.html#filepos392723"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="8" class="calibre_10">importing<ul class="calibre_135"><li value="1" class="calibre_13">DataFrame data<ul class="calibre_136"><li value="1" class="calibre_13">as CSV files, <a href="index_split_016.html#filepos748628"><span class="calibre_7">Importing CSV Files</span></a>-<a href="index_split_016.html#filepos764876"><span class="calibre_7">Importing CSV Files</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_016.html#filepos740480"><span class="calibre_7">Importing and Exporting DataFrames</span></a></li></ul></li><li value="2" class="calibre_10">modules, <a href="index_split_012.html#filepos376420"><span class="calibre_7">Modules and the import Statement</span></a>-<a href="index_split_012.html#filepos392723"><span class="calibre_7">Modules and the import Statement</span></a><ul class="calibre_136"><li value="1" class="calibre_13">running scripts versus, <a href="index_split_027.html#filepos1641594"><span class="calibre_7">Backend</span></a></li></ul></li><li value="3" class="calibre_10">UDFs, <a href="index_split_028.html#filepos1657477"><span class="calibre_7">UDF Quickstart</span></a>-<a href="index_split_028.html#filepos1679023"><span class="calibre_7">UDF Quickstart</span></a></li></ul></li><li value="9" class="calibre_10">importsub.py example, <a href="index_split_028.html#filepos1796656"><span class="calibre_7">The Sub Decorator</span></a></li><li value="10" class="calibre_10">imshow method (Plotly), <a href="index_split_017.html#filepos846056"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="11" class="calibre_10">in operator, <a href="index_split_011.html#filepos262598"><span class="calibre_7">Lists</span></a>, <a href="index_split_015.html#filepos558929"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="12" class="calibre_10">indexing<ul class="calibre_135"><li value="1" class="calibre_13">in Python, <a href="index_split_011.html#filepos228067"><span class="calibre_7">Indexing</span></a></li><li value="2" class="calibre_10">range objects (xlwings), <a href="index_split_024.html#filepos1276198"><span class="calibre_7">The Excel Object Model</span></a></li><li value="3" class="calibre_10">in VBA, <a href="index_split_011.html#filepos228929"><span class="calibre_7">Indexing</span></a></li><li value="4" class="calibre_10">zero- versus one-based, <a href="index_split_024.html#filepos1295706"><span class="calibre_7">The Excel Object Model</span></a></li></ul></li><li value="13" class="calibre_10">indices<ul class="calibre_135"><li value="1" class="calibre_13">for DataFrames, <a href="index_split_015.html#filepos498949"><span class="calibre_7">Index</span></a>-<a href="index_split_015.html#filepos512717"><span class="calibre_7">Index</span></a>, <a href="index_split_022.html#filepos1170468"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a>-<a href="index_split_022.html#filepos1205120"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a></li><li value="2" class="calibre_10">time-based, <a href="index_split_017.html#filepos769969"><span class="calibre_7">Time Series Analysis with pandas</span></a></li></ul></li><li value="14" class="calibre_10">info method (pandas), <a href="index_split_015.html#filepos496964"><span class="calibre_7">DataFrame and Series</span></a>, <a href="index_split_016.html#filepos750501"><span class="calibre_7">Importing CSV Files</span></a>, <a href="index_split_019.html#filepos887441"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="15" class="calibre_10">init method, <a href="index_split_031.html#filepos1837273"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1839671"><span class="calibre_7">Classes and Objects</span></a></li><li value="16" class="calibre_10">initialization (of objects), <a href="index_split_031.html#filepos1837273"><span class="calibre_7">Classes and Objects</span></a></li><li value="17" class="calibre_10">inner joins, <a href="index_split_016.html#filepos668671"><span class="calibre_7">Joining and Merging</span></a></li><li value="18" class="calibre_10">inputs, separate layer for, <a href="index_split_007.html#filepos45452"><span class="calibre_7">Separation of concerns</span></a></li><li value="19" class="calibre_10">installing<ul class="calibre_135"><li value="1" class="calibre_13">Anaconda, <a href="index_split_008.html#filepos99940"><span class="calibre_7">Installation</span></a>-<a href="index_split_008.html#filepos101307"><span class="calibre_7">Installation</span></a></li><li value="2" class="calibre_10">packages, <a href="index_split_008.html#filepos125084"><span class="calibre_7">Package Managers: Conda and pip</span></a>, <a href="index_split_029.html#filepos1813742"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="3" class="calibre_10">Plotly, <a href="index_split_016.html#filepos728478"><span class="calibre_7">Plotly</span></a></li><li value="4" class="calibre_10">pytrends, <a href="index_split_008.html#filepos125608"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="5" class="calibre_10">pyxlsb, <a href="index_split_008.html#filepos125608"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="6" class="calibre_10">VS Code, <a href="index_split_009.html#filepos159642"><span class="calibre_7">Installation and Configuration</span></a></li><li value="7" class="calibre_10">xlutils, <a href="index_split_021.html#filepos1085435"><span class="calibre_7">xlrd, xlwt, and xlutils</span></a></li><li value="8" class="calibre_10">xlwings add-in, <a href="index_split_026.html#filepos1442113"><span class="calibre_7">Excel Add-in</span></a>-<a href="index_split_026.html#filepos1447961"><span class="calibre_7">Excel Add-in</span></a></li></ul></li><li value="20" class="calibre_10">instances (of Excel), <a href="index_split_024.html#filepos1252360"><span class="calibre_7">The Excel Object Model</span></a>, <a href="index_split_024.html#filepos1296280"><span class="calibre_7">The Excel Object Model</span></a></li><li value="21" class="calibre_10">instantiation, <a href="index_split_011.html#filepos188357"><span class="calibre_7">Attributes and methods</span></a>, <a href="index_split_012.html#filepos394507"><span class="calibre_7">The datetime Class</span></a>, <a href="index_split_031.html#filepos1833058"><span class="calibre_7">Classes and Objects</span></a></li><li value="22" class="calibre_10">int data type, <a href="index_split_011.html#filepos189160"><span class="calibre_7">Numeric Types</span></a>-<a href="index_split_011.html#filepos194525"><span class="calibre_7">Numeric Types</span></a></li><li value="23" class="calibre_10">integers, <a href="index_split_011.html#filepos189272"><span class="calibre_7">Numeric Types</span></a></li><li value="24" class="calibre_10">integrated development environments (IDEs), <a href="index_split_009.html#filepos156885"><span class="calibre_7">Visual Studio Code</span></a>, <a href="index_split_009.html#filepos174247"><span class="calibre_7">Running a Python Script</span></a>-<a href="index_split_009.html#filepos176621"><span class="calibre_7">Running a Python Script</span></a></li><li value="25" class="calibre_10">IntelliSense, <a href="index_split_009.html#filepos155542"><span class="calibre_7">Visual Studio Code</span></a></li><li value="26" class="calibre_10">interactive Python session<ul class="calibre_135"><li value="1" class="calibre_13">ending, <a href="index_split_008.html#filepos118780"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="2" class="calibre_10">starting, <a href="index_split_008.html#filepos115018"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a>-<a href="index_split_008.html#filepos118983"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li></ul></li><li value="27" class="calibre_10">isin operator (pandas), <a href="index_split_015.html#filepos558929"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="28" class="calibre_10">isna method (pandas), <a href="index_split_015.html#filepos605310"><span class="calibre_7">Missing Data</span></a></li><li value="29" class="calibre_10">items method, <a href="index_split_012.html#filepos333494"><span class="calibre_7">The for and while Loops</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">J</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">JavaScript Object Notation (JSON), <a href="index_split_027.html#filepos1494225"><span class="calibre_7">Web APIs</span></a>-<a href="index_split_027.html#filepos1503692"><span class="calibre_7">Web APIs</span></a></li><li value="2" class="calibre_10">join condition, <a href="index_split_016.html#filepos683007"><span class="calibre_7">Joining and Merging</span></a></li><li value="3" class="calibre_10">join method (pandas), <a href="index_split_016.html#filepos667765"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="4" class="calibre_10">joining<ul class="calibre_135"><li value="1" class="calibre_13">database tables, <a href="index_split_027.html#filepos1517665"><span class="calibre_7">Databases</span></a></li><li value="2" class="calibre_10">DataFrames, <a href="index_split_016.html#filepos667765"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li></ul></li><li value="5" class="calibre_10">JSON (JavaScript Object Notation), <a href="index_split_027.html#filepos1494225"><span class="calibre_7">Web APIs</span></a>-<a href="index_split_027.html#filepos1503692"><span class="calibre_7">Web APIs</span></a></li><li value="6" class="calibre_10">json module, <a href="index_split_027.html#filepos1495827"><span class="calibre_7">Web APIs</span></a></li><li value="7" class="calibre_10">Jupyter kernel, <a href="index_split_009.html#filepos149871"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="8" class="calibre_10">Jupyter notebooks<ul class="calibre_135"><li value="1" class="calibre_13">cells<ul class="calibre_136"><li value="1" class="calibre_13">edit mode versus command mode, <a href="index_split_009.html#filepos140230"><span class="calibre_7">Edit vs. Command Mode</span></a>-<a href="index_split_009.html#filepos145012"><span class="calibre_7">Edit vs. Command Mode</span></a></li><li value="2" class="calibre_10">operational overview, <a href="index_split_009.html#filepos134675"><span class="calibre_7">Notebook Cells</span></a>-<a href="index_split_009.html#filepos140068"><span class="calibre_7">Notebook Cells</span></a></li><li value="3" class="calibre_10">output, <a href="index_split_009.html#filepos137198"><span class="calibre_7">Notebook Cells</span></a></li><li value="4" class="calibre_10">in Python scripts, <a href="index_split_030.html#filepos1829327"><span class="calibre_7">Python Scripts with Code Cells</span></a></li><li value="5" class="calibre_10">run order, <a href="index_split_009.html#filepos145168"><span class="calibre_7">Run Order Matters</span></a></li></ul></li><li value="2" class="calibre_10">cloud providers, <a href="index_split_009.html#filepos151042"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="3" class="calibre_10">comments, <a href="index_split_011.html#filepos204466"><span class="calibre_7">Mathematical operators</span></a></li><li value="4" class="calibre_10">Excel versus, <a href="index_split_008.html#filepos131000"><span class="calibre_7">Jupyter Notebooks</span></a></li><li value="5" class="calibre_10">magic commands, <a href="index_split_016.html#filepos726866"><span class="calibre_7">Matplotlib</span></a></li><li value="6" class="calibre_10">purpose of, <a href="index_split_008.html#filepos97807"><span class="calibre_7">Development Environment</span></a>, <a href="index_split_008.html#filepos129917"><span class="calibre_7">Jupyter Notebooks</span></a>-<a href="index_split_008.html#filepos132282"><span class="calibre_7">Jupyter Notebooks</span></a></li><li value="7" class="calibre_10">renaming, <a href="index_split_008.html#filepos134176"><span class="calibre_7">Running Jupyter Notebooks</span></a></li><li value="8" class="calibre_10">running, <a href="index_split_008.html#filepos132444"><span class="calibre_7">Running Jupyter Notebooks</span></a>-<a href="index_split_008.html#filepos134424"><span class="calibre_7">Running Jupyter Notebooks</span></a>, <a href="index_split_030.html#filepos1826689"><span class="calibre_7">Run Jupyter Notebooks</span></a>-<a href="index_split_030.html#filepos1829065"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="9" class="calibre_10">saving in VS Code, <a href="index_split_030.html#filepos1828008"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="10" class="calibre_10">shutting down, <a href="index_split_009.html#filepos149871"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="11" class="calibre_10">VS Code versus, <a href="index_split_009.html#filepos154255"><span class="calibre_7">Visual Studio Code</span></a></li></ul></li><li value="9" class="calibre_10">JupyterLab, <a href="index_split_009.html#filepos175602"><span class="calibre_7">Running a Python Script</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">K</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">Kaggle, <a href="index_split_009.html#filepos152502"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="2" class="calibre_10">key/value combinations (see dictionaries)</li><li value="3" class="calibre_10">keyboard shortcuts<ul class="calibre_135"><li value="1" class="calibre_13">for comments, <a href="index_split_011.html#filepos204466"><span class="calibre_7">Mathematical operators</span></a></li><li value="2" class="calibre_10">Jupyter notebooks, <a href="index_split_009.html#filepos141162"><span class="calibre_7">Edit vs. Command Mode</span></a>-<a href="index_split_009.html#filepos144741"><span class="calibre_7">Edit vs. Command Mode</span></a></li></ul></li><li value="4" class="calibre_10">keyword arguments (for functions), <a href="index_split_012.html#filepos372720"><span class="calibre_7">Calling functions</span></a></li><li value="5" class="calibre_10">Koalas, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a></li><li value="6" class="calibre_10">Komodo IDE, <a href="index_split_009.html#filepos176335"><span class="calibre_7">Running a Python Script</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">L</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">labels<ul class="calibre_135"><li value="1" class="calibre_13">selecting data by (pandas), <a href="index_split_015.html#filepos525461"><span class="calibre_7">Selecting by label</span></a>-<a href="index_split_015.html#filepos538911"><span class="calibre_7">Selecting by label</span></a></li><li value="2" class="calibre_10">setting data by (pandas), <a href="index_split_015.html#filepos576247"><span class="calibre_7">Setting data by label or position</span></a></li><li value="3" class="calibre_10">in VBA, <a href="index_split_007.html#filepos89147"><span class="calibre_7">Modern Language Features</span></a></li></ul></li><li value="2" class="calibre_10">lambda expressions, <a href="index_split_015.html#filepos645164"><span class="calibre_7">Applying a Function</span></a></li><li value="3" class="calibre_10">lambda functions (Excel), <a href="index_split_007.html#filepos36898"><span class="calibre_7">Excel Is a Programming Language</span></a></li><li value="4" class="calibre_10">language settings (Excel), <a href="index_split_024.html#filepos1254107"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1255983"><span class="calibre_7">The Excel Object Model</span></a></li><li value="5" class="calibre_10">layers of applications, <a href="index_split_007.html#filepos41940"><span class="calibre_7">Separation of concerns</span></a>-<a href="index_split_007.html#filepos45911"><span class="calibre_7">Separation of concerns</span></a></li><li value="6" class="calibre_10">left joins, <a href="index_split_016.html#filepos668763"><span class="calibre_7">Joining and Merging</span></a></li><li value="7" class="calibre_10">len function (lists), <a href="index_split_011.html#filepos262598"><span class="calibre_7">Lists</span></a></li><li value="8" class="calibre_10">line breaks, <a href="index_split_011.html#filepos253745"><span class="calibre_7">Lists</span></a></li><li value="9" class="calibre_10">linting, <a href="index_split_012.html#filepos426221"><span class="calibre_7">PEP 8 and VS Code</span></a></li><li value="10" class="calibre_10">list comprehensions, <a href="index_split_012.html#filepos347118"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="11" class="calibre_10">list constructor, <a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="12" class="calibre_10">list separators (Excel), changing, <a href="index_split_024.html#filepos1254107"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1255983"><span class="calibre_7">The Excel Object Model</span></a></li><li value="13" class="calibre_10">listing current directory files, <a href="index_split_008.html#filepos110263"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="14" class="calibre_10">lists, <a href="index_split_011.html#filepos243228"><span class="calibre_7">Lists</span></a>-<a href="index_split_011.html#filepos268531"><span class="calibre_7">Lists</span></a></li><li value="15" class="calibre_10">literals, <a href="index_split_011.html#filepos297752"><span class="calibre_7">Sets</span></a>, <a href="index_split_012.html#filepos394192"><span class="calibre_7">The datetime Class</span></a></li><li value="16" class="calibre_10">loc attribute (pandas), <a href="index_split_015.html#filepos525461"><span class="calibre_7">Selecting by label</span></a>-<a href="index_split_015.html#filepos538911"><span class="calibre_7">Selecting by label</span></a>, <a href="index_split_015.html#filepos576473"><span class="calibre_7">Setting data by label or position</span></a></li><li value="17" class="calibre_10">log returns, <a href="index_split_017.html#filepos809605"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos818833"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="18" class="calibre_10">log ufunc (NumPy), <a href="index_split_017.html#filepos814239"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="19" class="calibre_10">logarithms in Excel and Python, <a href="index_split_017.html#filepos810574"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="20" class="calibre_10">London Whale story, <a href="index_split_007.html#filepos39761"><span class="calibre_7">Excel in the News</span></a></li><li value="21" class="calibre_10">loops<ul class="calibre_135"><li value="1" class="calibre_13">for loops, <a href="index_split_012.html#filepos316683"><span class="calibre_7">The for and while Loops</span></a>-<a href="index_split_012.html#filepos341967"><span class="calibre_7">The for and while Loops</span></a></li><li value="2" class="calibre_10">while loops, <a href="index_split_012.html#filepos343907"><span class="calibre_7">The for and while Loops</span></a></li></ul></li><li value="22" class="calibre_10">Lotus 1-2-3, <a href="index_split_007.html#filepos33990"><span class="calibre_7">Why Python for Excel?</span></a></li><li value="23" class="calibre_10">low-level packages, <a href="index_split_021.html#filepos974268"><span class="calibre_7">The excel.py Module</span></a></li><li value="24" class="calibre_10">lowercase, transforming to/from uppercase, <a href="index_split_011.html#filepos224113"><span class="calibre_7">Strings</span></a></li><li value="25" class="calibre_10">lru_cache decorator, <a href="index_split_028.html#filepos1784463"><span class="calibre_7">Caching</span></a></li><li value="26" class="calibre_10">ls command, <a href="index_split_008.html#filepos110600"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="27" class="calibre_10">lxml, <a href="index_split_022.html#filepos1126100"><span class="calibre_7">Writing with OpenPyXL</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">M</span></span></blockquote>

<div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">M formula language (Power Query), <a href="index_split_003.html#filepos9253"><span class="calibre_7">Preface</span></a></li><li value="2" class="calibre_10">macOS<ul class="calibre_135"><li value="1" class="calibre_13">Anaconda Prompt, running, <a href="index_split_008.html#filepos104346"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">current directory<ul class="calibre_136"><li value="1" class="calibre_13">listing files in, <a href="index_split_008.html#filepos110600"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">viewing full path, <a href="index_split_008.html#filepos105254"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="3" class="calibre_10">extracting macro code (Xlsxwriter), <a href="index_split_021.html#filepos1066169"><span class="calibre_7">XlsxWriter</span></a></li><li value="4" class="calibre_10">file extensions, viewing, <a href="index_split_008.html#filepos114549"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="5" class="calibre_10">list separators (Excel), changing, <a href="index_split_024.html#filepos1255706"><span class="calibre_7">The Excel Object Model</span></a></li><li value="6" class="calibre_10">permissions in, <a href="index_split_024.html#filepos1249144"><span class="calibre_7">Using Excel as Data Viewer</span></a>, <a href="index_split_024.html#filepos1309403"><span class="calibre_7">The Excel Object Model</span></a></li><li value="7" class="calibre_10">ribbon add-ins, <a href="index_split_026.html#filepos1447883"><span class="calibre_7">Excel Add-in</span></a></li><li value="8" class="calibre_10">Terminal, <a href="index_split_008.html#filepos102144"><span class="calibre_7">Anaconda Prompt</span></a>-<a href="index_split_008.html#filepos104346"><span class="calibre_7">Anaconda Prompt</span></a><ul class="calibre_136"><li value="1" class="calibre_13">disabling auto activation of Conda environment, <a href="index_split_029.html#filepos1819954"><span class="calibre_7">Disable Auto Activation</span></a></li></ul></li><li value="9" class="calibre_10">VS Code<ul class="calibre_136"><li value="1" class="calibre_13">configuring, <a href="index_split_009.html#filepos164804"><span class="calibre_7">Installation and Configuration</span></a></li><li value="2" class="calibre_10">installing, <a href="index_split_009.html#filepos160570"><span class="calibre_7">Installation and Configuration</span></a></li></ul></li><li value="10" class="calibre_10">xlwings dependencies, <a href="index_split_025.html#filepos1411927"><span class="calibre_7">xlwings Foundations</span></a></li></ul></li><li value="3" class="calibre_10">macro code (Xlsxwriter), extracting from xlsm files, <a href="index_split_021.html#filepos1064438"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066693"><span class="calibre_7">XlsxWriter</span></a></li><li value="4" class="calibre_10">macro object (xlwings), <a href="index_split_024.html#filepos1316702"><span class="calibre_7">Running VBA Code</span></a></li><li value="5" class="calibre_10">macros<ul class="calibre_135"><li value="1" class="calibre_13">enabling (Excel), <a href="index_split_026.html#filepos1459885"><span class="calibre_7">RunPython Function</span></a></li><li value="2" class="calibre_10">in Python Package Tracker, <a href="index_split_027.html#filepos1616544"><span class="calibre_7">Frontend</span></a></li><li value="3" class="calibre_10">running (Excel), <a href="index_split_026.html#filepos1462470"><span class="calibre_7">RunPython Function</span></a></li></ul></li><li value="6" class="calibre_10">magic commands (Jupyter notebooks), <a href="index_split_016.html#filepos726866"><span class="calibre_7">Matplotlib</span></a>, <a href="index_split_022.html#filepos1147874"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="7" class="calibre_10">Markdown cells (Jupyter notebooks), <a href="index_split_009.html#filepos138277"><span class="calibre_7">Notebook Cells</span></a>-<a href="index_split_009.html#filepos139906"><span class="calibre_7">Notebook Cells</span></a></li><li value="8" class="calibre_10">mathematical operators, <a href="index_split_011.html#filepos196304"><span class="calibre_7">Mathematical operators</span></a></li><li value="9" class="calibre_10">Matplotlib, <a href="index_split_016.html#filepos717479"><span class="calibre_7">Matplotlib</span></a>-<a href="index_split_016.html#filepos727877"><span class="calibre_7">Matplotlib</span></a><ul class="calibre_135"><li value="1" class="calibre_13">plots as Excel pictures, <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li></ul></li><li value="10" class="calibre_10">matrix, <a href="index_split_011.html#filepos249366"><span class="calibre_7">Lists</span></a>, <a href="index_split_014.html#filepos451947"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="11" class="calibre_10">mean method (pandas), <a href="index_split_016.html#filepos695674"><span class="calibre_7">Grouping</span></a></li><li value="12" class="calibre_10">melt function (pandas), <a href="index_split_016.html#filepos712684"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="13" class="calibre_10">melting DataFrame data, <a href="index_split_016.html#filepos712684"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="14" class="calibre_10">memoization, <a href="index_split_028.html#filepos1781894"><span class="calibre_7">Caching</span></a></li><li value="15" class="calibre_10">merge method (pandas), <a href="index_split_016.html#filepos682873"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="16" class="calibre_10">merge requests, <a href="index_split_007.html#filepos53419"><span class="calibre_7">Version control</span></a></li><li value="17" class="calibre_10">merging<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames, <a href="index_split_016.html#filepos682873"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="2" class="calibre_10">dictionaries, <a href="index_split_011.html#filepos275528"><span class="calibre_7">Dictionaries</span></a></li></ul></li><li value="18" class="calibre_10">method chaining, <a href="index_split_015.html#filepos505857"><span class="calibre_7">Index</span></a></li><li value="19" class="calibre_10">methods<ul class="calibre_135"><li value="1" class="calibre_13">corresponding arithmetic operators for (pandas), <a href="index_split_015.html#filepos625775"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="2" class="calibre_10">DataFrame exploration, <a href="index_split_016.html#filepos758459"><span class="calibre_7">Importing CSV Files</span></a></li><li value="3" class="calibre_10">of DataFrames, copies returned, <a href="index_split_015.html#filepos506311"><span class="calibre_7">Index</span></a></li><li value="4" class="calibre_10">help documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="5" class="calibre_10">purpose of, <a href="index_split_011.html#filepos187275"><span class="calibre_7">Attributes and methods</span></a>, <a href="index_split_031.html#filepos1833311"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a></li><li value="6" class="calibre_10">string methods in DataFrames, <a href="index_split_015.html#filepos634000"><span class="calibre_7">Working with Text Columns</span></a></li></ul></li><li value="20" class="calibre_10">Microsoft Access, <a href="index_split_027.html#filepos1516369"><span class="calibre_7">Databases</span></a></li><li value="21" class="calibre_10">migrating databases, <a href="index_split_027.html#filepos1518267"><span class="calibre_7">Databases</span></a></li><li value="22" class="calibre_10">minimizing cross-application calls (xlwings), <a href="index_split_025.html#filepos1416834"><span class="calibre_7">Minimize cross-application calls</span></a>, <a href="index_split_028.html#filepos1762196"><span class="calibre_7">Minimize cross-application calls</span></a>-<a href="index_split_028.html#filepos1770595"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="23" class="calibre_10">missing data in DataFrames, <a href="index_split_015.html#filepos598810"><span class="calibre_7">Missing Data</span></a>-<a href="index_split_015.html#filepos608614"><span class="calibre_7">Missing Data</span></a></li><li value="24" class="calibre_10">model-view-controller (MVC), <a href="index_split_027.html#filepos1605468"><span class="calibre_7">Application Structure</span></a></li><li value="25" class="calibre_10">modern Excel, <a href="index_split_007.html#filepos58283"><span class="calibre_7">Modern Excel</span></a></li><li value="26" class="calibre_10">modern language features in Python versus Excel, <a href="index_split_007.html#filepos80870"><span class="calibre_7">Modern Language Features</span></a>-<a href="index_split_007.html#filepos89951"><span class="calibre_7">Modern Language Features</span></a></li><li value="27" class="calibre_10">Modin, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a>, <a href="index_split_022.html#filepos1154305"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="28" class="calibre_10">modularity, <a href="index_split_007.html#filepos41610"><span class="calibre_7">Separation of concerns</span></a>-<a href="index_split_007.html#filepos45911"><span class="calibre_7">Separation of concerns</span></a></li><li value="29" class="calibre_10">module search path (Python), <a href="index_split_026.html#filepos1466429"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1468145"><span class="calibre_7">RunPython Function</span></a>, <a href="index_split_026.html#filepos1483129"><span class="calibre_7">Settings</span></a></li><li value="30" class="calibre_10">modules<ul class="calibre_135"><li value="1" class="calibre_13">datetime module, <a href="index_split_012.html#filepos392883"><span class="calibre_7">The datetime Class</span></a>-<a href="index_split_012.html#filepos408810"><span class="calibre_7">The datetime Class</span></a>, <a href="index_split_031.html#filepos1848019"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a>-<a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="2" class="calibre_10">importing, <a href="index_split_012.html#filepos376420"><span class="calibre_7">Modules and the import Statement</span></a>-<a href="index_split_012.html#filepos392723"><span class="calibre_7">Modules and the import Statement</span></a><ul class="calibre_136"><li value="1" class="calibre_13">running scripts versus, <a href="index_split_027.html#filepos1641594"><span class="calibre_7">Backend</span></a></li></ul></li><li value="3" class="calibre_10">timezone module, <a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li></ul></li><li value="31" class="calibre_10">MongoDB, <a href="index_split_027.html#filepos1518942"><span class="calibre_7">Databases</span></a></li><li value="32" class="calibre_10">moving averages in time series analysis, <a href="index_split_017.html#filepos855004"><span class="calibre_7">Rolling Windows</span></a></li><li value="33" class="calibre_10">MultiIndexes (pandas), selecting data by, <a href="index_split_015.html#filepos567793"><span class="calibre_7">Selecting by using a MultiIndex</span></a>-<a href="index_split_015.html#filepos575571"><span class="calibre_7">Selecting by using a MultiIndex</span></a></li><li value="34" class="calibre_10">Multiplan, <a href="index_split_007.html#filepos34096"><span class="calibre_7">Why Python for Excel?</span></a></li><li value="35" class="calibre_10">multiprocessing, <a href="index_split_022.html#filepos1144410"><span class="calibre_7">Reading sheets in parallel</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="36" class="calibre_10">mutable objects<ul class="calibre_135"><li value="1" class="calibre_13">as function arguments, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="2" class="calibre_10">immutable objects versus, <a href="index_split_031.html#filepos1865519"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a>-<a href="index_split_031.html#filepos1882596"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li></ul></li><li value="37" class="calibre_10">MVC (model-view-controller), <a href="index_split_027.html#filepos1605468"><span class="calibre_7">Application Structure</span></a></li><li value="38" class="calibre_10">mypy, <a href="index_split_012.html#filepos428975"><span class="calibre_7">Type Hints</span></a></li><li value="39" class="calibre_10">MySQL, <a href="index_split_027.html#filepos1516369"><span class="calibre_7">Databases</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">N</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">Name Manager (Excel), <a href="index_split_025.html#filepos1399895"><span class="calibre_7">Defined names</span></a></li><li value="2" class="calibre_10">named ranges<ul class="calibre_135"><li value="1" class="calibre_13">creating in xlwings, <a href="index_split_025.html#filepos1390078"><span class="calibre_7">Defined names</span></a>-<a href="index_split_025.html#filepos1400526"><span class="calibre_7">Defined names</span></a></li><li value="2" class="calibre_10">in Python Package Tracker, <a href="index_split_027.html#filepos1608660"><span class="calibre_7">Frontend</span></a></li></ul></li><li value="3" class="calibre_10">namespaces of scripts, <a href="index_split_012.html#filepos391305"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="4" class="calibre_10">naming<ul class="calibre_135"><li value="1" class="calibre_13">columns (pandas), <a href="index_split_015.html#filepos514077"><span class="calibre_7">Columns</span></a></li><li value="2" class="calibre_10">indices (pandas), <a href="index_split_015.html#filepos500212"><span class="calibre_7">Index</span></a></li><li value="3" class="calibre_10">scripts, <a href="index_split_012.html#filepos392387"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="4" class="calibre_10">variables, <a href="index_split_010.html#filepos185081"><span class="calibre_7">Variables</span></a></li></ul></li><li value="5" class="calibre_10">NaN values<ul class="calibre_135"><li value="1" class="calibre_13">handling when reading Excel files, <a href="index_split_019.html#filepos906409"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_015.html#filepos598810"><span class="calibre_7">Missing Data</span></a>-<a href="index_split_015.html#filepos608614"><span class="calibre_7">Missing Data</span></a></li><li value="3" class="calibre_10">replacing with zeros, <a href="index_split_015.html#filepos624230"><span class="calibre_7">Arithmetic Operations</span></a></li></ul></li><li value="6" class="calibre_10">nested lists, <a href="index_split_011.html#filepos247058"><span class="calibre_7">Lists</span></a>, <a href="index_split_014.html#filepos435109"><span class="calibre_7">NumPy Array</span></a></li><li value="7" class="calibre_10">news stories, Excel in, <a href="index_split_007.html#filepos38612"><span class="calibre_7">Excel in the News</span></a>-<a href="index_split_007.html#filepos41040"><span class="calibre_7">Excel in the News</span></a></li><li value="8" class="calibre_10">None built-in constant, <a href="index_split_011.html#filepos213324"><span class="calibre_7">Booleans</span></a></li><li value="9" class="calibre_10">normalization (databases), <a href="index_split_027.html#filepos1516187"><span class="calibre_7">Databases</span></a>-<a href="index_split_027.html#filepos1520748"><span class="calibre_7">The Package Tracker database</span></a></li><li value="10" class="calibre_10">NoSQL databases, <a href="index_split_027.html#filepos1517033"><span class="calibre_7">Databases</span></a></li><li value="11" class="calibre_10">notebook cells (see cells)</li><li value="12" class="calibre_10">Notepad++, <a href="index_split_009.html#filepos173617"><span class="calibre_7">Running a Python Script</span></a></li><li value="13" class="calibre_10">numeric data types, <a href="index_split_011.html#filepos189160"><span class="calibre_7">Numeric Types</span></a>-<a href="index_split_011.html#filepos194525"><span class="calibre_7">Numeric Types</span></a></li><li value="14" class="calibre_10">NumFOCUS, <a href="index_split_007.html#filepos75535"><span class="calibre_7">Standard Library and Package Manager</span></a></li><li value="15" class="calibre_10">NumPy, <a href="index_split_007.html#filepos34564"><span class="calibre_7">Why Python for Excel?</span></a><ul class="calibre_135"><li value="1" class="calibre_13">arrays<ul class="calibre_136"><li value="1" class="calibre_13">broadcasting, <a href="index_split_014.html#filepos451025"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="2" class="calibre_10">constructors, <a href="index_split_014.html#filepos470880"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="3" class="calibre_10">data types, <a href="index_split_014.html#filepos445451"><span class="calibre_7">NumPy Array</span></a>-<a href="index_split_014.html#filepos447897"><span class="calibre_7">NumPy Array</span></a></li><li value="4" class="calibre_10">getting and setting elements, <a href="index_split_014.html#filepos463404"><span class="calibre_7">Getting and Setting Array Elements</span></a>-<a href="index_split_014.html#filepos470575"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="5" class="calibre_10">operational overview, <a href="index_split_014.html#filepos434881"><span class="calibre_7">NumPy Array</span></a>-<a href="index_split_014.html#filepos448083"><span class="calibre_7">NumPy Array</span></a></li><li value="6" class="calibre_10">universal functions (ufuncs), <a href="index_split_014.html#filepos454337"><span class="calibre_7">Universal Functions (ufunc)</span></a>-<a href="index_split_014.html#filepos462582"><span class="calibre_7">Universal Functions (ufunc)</span></a></li><li value="7" class="calibre_10">vectorization, <a href="index_split_014.html#filepos448254"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="8" class="calibre_10">views versus copies, <a href="index_split_014.html#filepos475259"><span class="calibre_7">View vs. Copy</span></a>-<a href="index_split_014.html#filepos480562"><span class="calibre_7">View vs. Copy</span></a></li></ul></li><li value="2" class="calibre_10">data analysis issues in, <a href="index_split_014.html#filepos481110"><span class="calibre_7">Conclusion</span></a></li><li value="3" class="calibre_10">purpose of, <a href="index_split_014.html#filepos433502"><span class="calibre_7">NumPy Foundations</span></a></li></ul></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">O</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">object model (Excel), <a href="index_split_024.html#filepos1250235"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1313152"><span class="calibre_7">The Excel Object Model</span></a></li><li value="2" class="calibre_10">object relational mapper (ORM), <a href="index_split_027.html#filepos1530130"><span class="calibre_7">Database connections</span></a></li><li value="3" class="calibre_10">objects<ul class="calibre_135"><li value="1" class="calibre_13">attributes and methods, <a href="index_split_031.html#filepos1833311"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a><ul class="calibre_136"><li value="1" class="calibre_13">help documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_011.html#filepos187275"><span class="calibre_7">Attributes and methods</span></a></li></ul></li><li value="2" class="calibre_10">as class instances, <a href="index_split_012.html#filepos394507"><span class="calibre_7">The datetime Class</span></a>, <a href="index_split_031.html#filepos1833058"><span class="calibre_7">Classes and Objects</span></a></li><li value="3" class="calibre_10">classes and, <a href="index_split_031.html#filepos1832657"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a></li><li value="4" class="calibre_10">in collections, <a href="index_split_024.html#filepos1252253"><span class="calibre_7">The Excel Object Model</span></a></li><li value="5" class="calibre_10">converting to boolean data type, <a href="index_split_019.html#filepos891785"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="6" class="calibre_10">help documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="7" class="calibre_10">initialization, <a href="index_split_031.html#filepos1837273"><span class="calibre_7">Classes and Objects</span></a></li><li value="8" class="calibre_10">mutable as function arguments, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="9" class="calibre_10">mutable versus immutable, <a href="index_split_031.html#filepos1865519"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a>-<a href="index_split_031.html#filepos1882596"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="10" class="calibre_10">purpose of, <a href="index_split_010.html#filepos180908"><span class="calibre_7">Objects</span></a></li><li value="11" class="calibre_10">variables, <a href="index_split_010.html#filepos181374"><span class="calibre_7">Variables</span></a></li></ul></li><li value="4" class="calibre_10">ohlc method (pandas), <a href="index_split_017.html#filepos850167"><span class="calibre_7">Resampling</span></a></li><li value="5" class="calibre_10">oletools, <a href="index_split_022.html#filepos1231999"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="6" class="calibre_10">one-based indexing, <a href="index_split_024.html#filepos1295706"><span class="calibre_7">The Excel Object Model</span></a></li><li value="7" class="calibre_10">one-dimensional NumPy arrays, <a href="index_split_014.html#filepos439635"><span class="calibre_7">NumPy Array</span></a></li><li value="8" class="calibre_10">one-to-many relationships (databases), <a href="index_split_027.html#filepos1528709"><span class="calibre_7">The Package Tracker database</span></a></li><li value="9" class="calibre_10">open mode (VS Code), <a href="index_split_009.html#filepos172252"><span class="calibre_7">Running a Python Script</span></a></li><li value="10" class="calibre_10">Open Source Software (OSS), <a href="index_split_007.html#filepos74609"><span class="calibre_7">Standard Library and Package Manager</span></a></li><li value="11" class="calibre_10">opening Excel instances, <a href="index_split_024.html#filepos1252360"><span class="calibre_7">The Excel Object Model</span></a></li><li value="12" class="calibre_10">OpenPyXL<ul class="calibre_135"><li value="1" class="calibre_13">editing files, <a href="index_split_021.html#filepos1033340"><span class="calibre_7">Editing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1039562"><span class="calibre_7">Editing with OpenPyXL</span></a></li><li value="2" class="calibre_10">formatting DataFrames<ul class="calibre_136"><li value="1" class="calibre_13">data parts, <a href="index_split_022.html#filepos1206138"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="2" class="calibre_10">indices and headers, <a href="index_split_022.html#filepos1174367"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a></li></ul></li><li value="3" class="calibre_10">parallelization, <a href="index_split_022.html#filepos1153631"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="4" class="calibre_10">reading files, <a href="index_split_021.html#filepos982131"><span class="calibre_7">Reading with OpenPyXL</span></a>-<a href="index_split_021.html#filepos996210"><span class="calibre_7">Writing with OpenPyXL</span></a>, <a href="index_split_022.html#filepos1141062"><span class="calibre_7">Reading with OpenPyXL</span></a></li><li value="5" class="calibre_10">when to use, <a href="index_split_020.html#filepos964224"><span class="calibre_7">When to Use Which Package</span></a></li><li value="6" class="calibre_10">writing files, <a href="index_split_021.html#filepos996317"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a>, <a href="index_split_022.html#filepos1126036"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="7" class="calibre_10">XlsxWriter versus, <a href="index_split_020.html#filepos968476"><span class="calibre_7">When to Use Which Package</span></a></li></ul></li><li value="13" class="calibre_10">operator precedence, <a href="index_split_015.html#filepos555852"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="14" class="calibre_10">optimizing<ul class="calibre_135"><li value="1" class="calibre_13">reader/writer packages, <a href="index_split_022.html#filepos1125159"><span class="calibre_7">Working with Big Excel Files</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="2" class="calibre_10">UDFs<ul class="calibre_136"><li value="1" class="calibre_13">caching, <a href="index_split_028.html#filepos1775539"><span class="calibre_7">Caching</span></a>-<a href="index_split_028.html#filepos1794980"><span class="calibre_7">Caching</span></a></li><li value="2" class="calibre_10">minimizing cross-application calls (xlwings), <a href="index_split_028.html#filepos1762196"><span class="calibre_7">Minimize cross-application calls</span></a>-<a href="index_split_028.html#filepos1770595"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="3" class="calibre_10">raw values, <a href="index_split_028.html#filepos1770837"><span class="calibre_7">Using raw values</span></a></li></ul></li><li value="3" class="calibre_10">xlwings performance, <a href="index_split_025.html#filepos1416353"><span class="calibre_7">Improving Performance</span></a>-<a href="index_split_025.html#filepos1429357"><span class="calibre_7">App properties</span></a></li></ul></li><li value="15" class="calibre_10">optional arguments (for functions), <a href="index_split_012.html#filepos364918"><span class="calibre_7">Defining functions</span></a></li><li value="16" class="calibre_10">options for range object (xlwings), <a href="index_split_025.html#filepos1345103"><span class="calibre_7">Converters and Options</span></a>-<a href="index_split_025.html#filepos1366895"><span class="calibre_7">Converters and Options</span></a></li><li value="17" class="calibre_10">Oracle, <a href="index_split_027.html#filepos1516369"><span class="calibre_7">Databases</span></a></li><li value="18" class="calibre_10">ORM (object relational mapper), <a href="index_split_027.html#filepos1530130"><span class="calibre_7">Database connections</span></a></li><li value="19" class="calibre_10">OSS (Open Source Software), <a href="index_split_007.html#filepos74609"><span class="calibre_7">Standard Library and Package Manager</span></a></li><li value="20" class="calibre_10">outer joins, <a href="index_split_016.html#filepos669216"><span class="calibre_7">Joining and Merging</span></a></li><li value="21" class="calibre_10">output<ul class="calibre_135"><li value="1" class="calibre_13">in Jupyter notebooks, <a href="index_split_009.html#filepos137198"><span class="calibre_7">Notebook Cells</span></a></li><li value="2" class="calibre_10">separate layer for, <a href="index_split_007.html#filepos45452"><span class="calibre_7">Separation of concerns</span></a></li></ul></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">P</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">package managers, <a href="index_split_007.html#filepos71589"><span class="calibre_7">Standard Library and Package Manager</span></a>-<a href="index_split_007.html#filepos76314"><span class="calibre_7">Standard Library and Package Manager</span></a>, <a href="index_split_008.html#filepos119343"><span class="calibre_7">Package Managers: Conda and pip</span></a>-<a href="index_split_008.html#filepos127083"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="2" class="calibre_10">packages<ul class="calibre_135"><li value="1" class="calibre_13">adding to Python Package Tracker, <a href="index_split_027.html#filepos1489144"><span class="calibre_7">What We Will Build</span></a>-<a href="index_split_027.html#filepos1492009"><span class="calibre_7">What We Will Build</span></a></li><li value="2" class="calibre_10">building, <a href="index_split_026.html#filepos1483129"><span class="calibre_7">Settings</span></a></li><li value="3" class="calibre_10">installing, <a href="index_split_008.html#filepos125084"><span class="calibre_7">Package Managers: Conda and pip</span></a>, <a href="index_split_029.html#filepos1813742"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="4" class="calibre_10">reader/writer packages<ul class="calibre_136"><li value="1" class="calibre_13">excel.py module, <a href="index_split_021.html#filepos972622"><span class="calibre_7">The excel.py Module</span></a>-<a href="index_split_021.html#filepos980989"><span class="calibre_7">The excel.py Module</span></a></li><li value="2" class="calibre_10">list of, <a href="index_split_022.html#filepos1230090"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="3" class="calibre_10">OpenPyXL, <a href="index_split_021.html#filepos981782"><span class="calibre_7">OpenPyXL</span></a>-<a href="index_split_021.html#filepos1039562"><span class="calibre_7">Editing with OpenPyXL</span></a></li><li value="4" class="calibre_10">optimization for big files, <a href="index_split_022.html#filepos1125159"><span class="calibre_7">Working with Big Excel Files</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="5" class="calibre_10">pyxlsb, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="6" class="calibre_10">when to use, <a href="index_split_020.html#filepos962384"><span class="calibre_7">When to Use Which Package</span></a>-<a href="index_split_021.html#filepos972372"><span class="calibre_7">When to Use Which Package</span></a></li><li value="7" class="calibre_10">xlrd, <a href="index_split_021.html#filepos1085917"><span class="calibre_7">Reading with xlrd</span></a>-<a href="index_split_021.html#filepos1099832"><span class="calibre_7">Reading with xlrd</span></a></li><li value="8" class="calibre_10">XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a></li><li value="9" class="calibre_10">xlutils, <a href="index_split_022.html#filepos1119688"><span class="calibre_7">Editing with xlutils</span></a></li><li value="10" class="calibre_10">xlwt, <a href="index_split_022.html#filepos1099995"><span class="calibre_7">Writing with xlwt</span></a>-<a href="index_split_022.html#filepos1119593"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li><li value="5" class="calibre_10">switching, <a href="index_split_021.html#filepos973335"><span class="calibre_7">The excel.py Module</span></a></li><li value="6" class="calibre_10">versions of, <a href="index_split_008.html#filepos126480"><span class="calibre_7">Package Managers: Conda and pip</span></a>-<a href="index_split_008.html#filepos127438"><span class="calibre_7">Conda Environments</span></a></li></ul></li><li value="3" class="calibre_10">pandas, <a href="index_split_007.html#filepos34877"><span class="calibre_7">Why Python for Excel?</span></a><ul class="calibre_135"><li value="1" class="calibre_13">DataFrames<ul class="calibre_136"><li value="1" class="calibre_13">applying functions, <a href="index_split_015.html#filepos641087"><span class="calibre_7">Applying a Function</span></a>-<a href="index_split_015.html#filepos649303"><span class="calibre_7">Applying a Function</span></a></li><li value="2" class="calibre_10">arithmetic operations, <a href="index_split_015.html#filepos617369"><span class="calibre_7">Arithmetic Operations</span></a>-<a href="index_split_015.html#filepos633672"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="3" class="calibre_10">columns, <a href="index_split_015.html#filepos512954"><span class="calibre_7">Columns</span></a>-<a href="index_split_015.html#filepos524119"><span class="calibre_7">Columns</span></a></li><li value="4" class="calibre_10">concatenating, <a href="index_split_016.html#filepos653577"><span class="calibre_7">Concatenating</span></a>-<a href="index_split_016.html#filepos667519"><span class="calibre_7">Concatenating</span></a></li><li value="5" class="calibre_10">copies, <a href="index_split_015.html#filepos506311"><span class="calibre_7">Index</span></a></li><li value="6" class="calibre_10">creating, <a href="index_split_015.html#filepos489479"><span class="calibre_7">DataFrame and Series</span></a></li><li value="7" class="calibre_10">descriptive statistics, <a href="index_split_016.html#filepos691290"><span class="calibre_7">Descriptive Statistics</span></a>-<a href="index_split_016.html#filepos695190"><span class="calibre_7">Descriptive Statistics</span></a></li><li value="8" class="calibre_10">duplicate data, <a href="index_split_015.html#filepos608897"><span class="calibre_7">Duplicate Data</span></a>-<a href="index_split_015.html#filepos617033"><span class="calibre_7">Duplicate Data</span></a></li><li value="9" class="calibre_10">Excel spreadsheets versus, <a href="index_split_015.html#filepos485631"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos489337"><span class="calibre_7">DataFrame and Series</span></a></li><li value="10" class="calibre_10">exploration methods, <a href="index_split_016.html#filepos758459"><span class="calibre_7">Importing CSV Files</span></a></li><li value="11" class="calibre_10">exporting, <a href="index_split_016.html#filepos740480"><span class="calibre_7">Importing and Exporting DataFrames</span></a></li><li value="12" class="calibre_10">formatting in Excel, <a href="index_split_022.html#filepos1157749"><span class="calibre_7">Formatting DataFrames in Excel</span></a>-<a href="index_split_022.html#filepos1224706"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="13" class="calibre_10">in Google Trends case study, <a href="index_split_028.html#filepos1682486"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>-<a href="index_split_028.html#filepos1714516"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="14" class="calibre_10">grouping data, <a href="index_split_016.html#filepos695504"><span class="calibre_7">Grouping</span></a></li><li value="15" class="calibre_10">importing, <a href="index_split_016.html#filepos740480"><span class="calibre_7">Importing and Exporting DataFrames</span></a></li><li value="16" class="calibre_10">indices, <a href="index_split_015.html#filepos498949"><span class="calibre_7">Index</span></a>-<a href="index_split_015.html#filepos512717"><span class="calibre_7">Index</span></a></li><li value="17" class="calibre_10">joining, <a href="index_split_016.html#filepos667765"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="18" class="calibre_10">limitations, <a href="index_split_017.html#filepos860285"><span class="calibre_7">Limitations with pandas</span></a></li><li value="19" class="calibre_10">melting data, <a href="index_split_016.html#filepos712684"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="20" class="calibre_10">merging, <a href="index_split_016.html#filepos682873"><span class="calibre_7">Joining and Merging</span></a>-<a href="index_split_016.html#filepos690380"><span class="calibre_7">Joining and Merging</span></a></li><li value="21" class="calibre_10">missing data, <a href="index_split_015.html#filepos598810"><span class="calibre_7">Missing Data</span></a>-<a href="index_split_015.html#filepos608614"><span class="calibre_7">Missing Data</span></a></li><li value="22" class="calibre_10">pivoting data, <a href="index_split_016.html#filepos701536"><span class="calibre_7">Pivoting and Melting</span></a>-<a href="index_split_016.html#filepos716422"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="23" class="calibre_10">plotting, <a href="index_split_016.html#filepos716977"><span class="calibre_7">Plotting</span></a>-<a href="index_split_016.html#filepos740115"><span class="calibre_7">Plotly</span></a></li><li value="24" class="calibre_10">reading/writing in Excel with xlwings, <a href="index_split_025.html#filepos1324128"><span class="calibre_7">Working with DataFrames</span></a>-<a href="index_split_025.html#filepos1340369"><span class="calibre_7">Working with DataFrames</span></a></li><li value="25" class="calibre_10">selecting data, <a href="index_split_015.html#filepos525158"><span class="calibre_7">Selecting Data</span></a>-<a href="index_split_015.html#filepos575571"><span class="calibre_7">Selecting by using a MultiIndex</span></a></li><li value="26" class="calibre_10">Series versus, <a href="index_split_015.html#filepos484520"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos485550"><span class="calibre_7">DataFrame and Series</span></a>, <a href="index_split_015.html#filepos536695"><span class="calibre_7">Selecting by label</span></a></li><li value="27" class="calibre_10">setting data, <a href="index_split_015.html#filepos575788"><span class="calibre_7">Setting Data</span></a>-<a href="index_split_015.html#filepos598654"><span class="calibre_7">Setting data by adding a new column</span></a></li><li value="28" class="calibre_10">SQL queries versus, <a href="index_split_027.html#filepos1540168"><span class="calibre_7">SQL queries</span></a></li><li value="29" class="calibre_10">text columns, <a href="index_split_015.html#filepos634000"><span class="calibre_7">Working with Text Columns</span></a></li><li value="30" class="calibre_10">transposing, <a href="index_split_015.html#filepos520188"><span class="calibre_7">Columns</span></a></li><li value="31" class="calibre_10">views versus copies, <a href="index_split_015.html#filepos649623"><span class="calibre_7">View vs. Copy</span></a></li></ul></li><li value="2" class="calibre_10">DatetimeIndex<ul class="calibre_136"><li value="1" class="calibre_13">creating, <a href="index_split_017.html#filepos770795"><span class="calibre_7">Creating a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos794737"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="2" class="calibre_10">filtering, <a href="index_split_017.html#filepos794993"><span class="calibre_7">Filtering a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos798956"><span class="calibre_7">Filtering a DatetimeIndex</span></a></li><li value="3" class="calibre_10">time zones in, <a href="index_split_017.html#filepos799257"><span class="calibre_7">Working with Time Zones</span></a>-<a href="index_split_017.html#filepos808759"><span class="calibre_7">Working with Time Zones</span></a></li></ul></li><li value="3" class="calibre_10">Excel files<ul class="calibre_136"><li value="1" class="calibre_13">limitations, <a href="index_split_019.html#filepos957495"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></a></li><li value="2" class="calibre_10">reading, <a href="index_split_019.html#filepos886398"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>-<a href="index_split_019.html#filepos935481"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="3" class="calibre_10">writing, <a href="index_split_019.html#filepos935768"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a>-<a href="index_split_019.html#filepos953568"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a></li></ul></li><li value="4" class="calibre_10">NumPy (see NumPy)</li><li value="5" class="calibre_10">plot types, <a href="index_split_016.html#filepos733673"><span class="calibre_7">Plotly</span></a></li><li value="6" class="calibre_10">reader/writer packages<ul class="calibre_136"><li value="1" class="calibre_13">excel.py module, <a href="index_split_021.html#filepos972622"><span class="calibre_7">The excel.py Module</span></a>-<a href="index_split_021.html#filepos980989"><span class="calibre_7">The excel.py Module</span></a></li><li value="2" class="calibre_10">list of, <a href="index_split_022.html#filepos1230090"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="3" class="calibre_10">OpenPyXL, <a href="index_split_021.html#filepos981782"><span class="calibre_7">OpenPyXL</span></a>-<a href="index_split_021.html#filepos1039562"><span class="calibre_7">Editing with OpenPyXL</span></a></li><li value="4" class="calibre_10">optimization for big files, <a href="index_split_022.html#filepos1125159"><span class="calibre_7">Working with Big Excel Files</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="5" class="calibre_10">pyxlsb, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="6" class="calibre_10">when to use, <a href="index_split_020.html#filepos962384"><span class="calibre_7">When to Use Which Package</span></a>-<a href="index_split_021.html#filepos972372"><span class="calibre_7">When to Use Which Package</span></a></li><li value="7" class="calibre_10">xlrd, <a href="index_split_021.html#filepos1085917"><span class="calibre_7">Reading with xlrd</span></a>-<a href="index_split_021.html#filepos1099832"><span class="calibre_7">Reading with xlrd</span></a></li><li value="8" class="calibre_10">XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a></li><li value="9" class="calibre_10">xlutils, <a href="index_split_022.html#filepos1119688"><span class="calibre_7">Editing with xlutils</span></a></li><li value="10" class="calibre_10">xlwt, <a href="index_split_022.html#filepos1099995"><span class="calibre_7">Writing with xlwt</span></a>-<a href="index_split_022.html#filepos1119593"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li><li value="7" class="calibre_10">time series analysis<ul class="calibre_136"><li value="1" class="calibre_13">correlation, <a href="index_split_017.html#filepos822133"><span class="calibre_7">Rebasing and Correlation</span></a>-<a href="index_split_017.html#filepos846848"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="2" class="calibre_10">percentage change, <a href="index_split_017.html#filepos809588"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos821793"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="3" class="calibre_10">rebasing, <a href="index_split_017.html#filepos822133"><span class="calibre_7">Rebasing and Correlation</span></a>-<a href="index_split_017.html#filepos846848"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="4" class="calibre_10">resampling, <a href="index_split_017.html#filepos847003"><span class="calibre_7">Resampling</span></a>-<a href="index_split_017.html#filepos854741"><span class="calibre_7">Resampling</span></a></li><li value="5" class="calibre_10">rolling windows, <a href="index_split_017.html#filepos855004"><span class="calibre_7">Rolling Windows</span></a></li><li value="6" class="calibre_10">shifting, <a href="index_split_017.html#filepos809588"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos821793"><span class="calibre_7">Shifting and Percentage Changes</span></a></li></ul></li></ul></li><li value="4" class="calibre_10">parallelization, <a href="index_split_022.html#filepos1144410"><span class="calibre_7">Reading sheets in parallel</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="5" class="calibre_10">parent directory, changing to, <a href="index_split_008.html#filepos112850"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="6" class="calibre_10">parsing strings into datetime objects, <a href="index_split_012.html#filepos404852"><span class="calibre_7">The datetime Class</span></a></li><li value="7" class="calibre_10">pass statement, <a href="index_split_011.html#filepos303668"><span class="calibre_7">Code Blocks and the pass Statement</span></a>-<a href="index_split_012.html#filepos306087"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="8" class="calibre_10">Path class, <a href="index_split_019.html#filepos882885"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="9" class="calibre_10">pathlib module, <a href="index_split_019.html#filepos882885"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="10" class="calibre_10">pct_change method (pandas), <a href="index_split_017.html#filepos818833"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="11" class="calibre_10">PEP 8 style guide<ul class="calibre_135"><li value="1" class="calibre_13">examples, <a href="index_split_012.html#filepos409133"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a>-<a href="index_split_012.html#filepos425840"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a></li><li value="2" class="calibre_10">linting, <a href="index_split_012.html#filepos426221"><span class="calibre_7">PEP 8 and VS Code</span></a></li></ul></li><li value="12" class="calibre_10">pep8_sample.py example, <a href="index_split_012.html#filepos409133"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a>-<a href="index_split_012.html#filepos425840"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a></li><li value="13" class="calibre_10">percentage change in time series analysis, <a href="index_split_017.html#filepos809588"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos821793"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="14" class="calibre_10">performance optimization<ul class="calibre_135"><li value="1" class="calibre_13">of reader/writer packages, <a href="index_split_022.html#filepos1125159"><span class="calibre_7">Working with Big Excel Files</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="2" class="calibre_10">of UDFs<ul class="calibre_136"><li value="1" class="calibre_13">caching, <a href="index_split_028.html#filepos1775539"><span class="calibre_7">Caching</span></a>-<a href="index_split_028.html#filepos1794980"><span class="calibre_7">Caching</span></a></li><li value="2" class="calibre_10">minimizing cross-application calls (xlwings), <a href="index_split_028.html#filepos1762196"><span class="calibre_7">Minimize cross-application calls</span></a>-<a href="index_split_028.html#filepos1770595"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="3" class="calibre_10">raw values, <a href="index_split_028.html#filepos1770837"><span class="calibre_7">Using raw values</span></a></li></ul></li><li value="3" class="calibre_10">in xlwings, <a href="index_split_025.html#filepos1416353"><span class="calibre_7">Improving Performance</span></a>-<a href="index_split_025.html#filepos1429357"><span class="calibre_7">App properties</span></a></li></ul></li><li value="15" class="calibre_10">permissions in macOS, <a href="index_split_024.html#filepos1249144"><span class="calibre_7">Using Excel as Data Viewer</span></a>, <a href="index_split_024.html#filepos1309403"><span class="calibre_7">The Excel Object Model</span></a></li><li value="16" class="calibre_10">pictures (Excel), Matplotlib plots as, <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="17" class="calibre_10">Pillow, <a href="index_split_025.html#filepos1388937"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="18" class="calibre_10">pip, <a href="index_split_007.html#filepos73403"><span class="calibre_7">Standard Library and Package Manager</span></a>-<a href="index_split_007.html#filepos76314"><span class="calibre_7">Standard Library and Package Manager</span></a>, <a href="index_split_008.html#filepos119343"><span class="calibre_7">Package Managers: Conda and pip</span></a>-<a href="index_split_008.html#filepos127083"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="19" class="calibre_10">pivoting DataFrame data, <a href="index_split_016.html#filepos701536"><span class="calibre_7">Pivoting and Melting</span></a>-<a href="index_split_016.html#filepos716422"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="20" class="calibre_10">pivot_table function (pandas), <a href="index_split_016.html#filepos701536"><span class="calibre_7">Pivoting and Melting</span></a>-<a href="index_split_016.html#filepos716422"><span class="calibre_7">Pivoting and Melting</span></a></li><li value="21" class="calibre_10">plot function (google_trends.py) example, <a href="index_split_028.html#filepos1742308"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1753405"><span class="calibre_7">Plotting with UDFs</span></a></li><li value="22" class="calibre_10">plot method (pandas), <a href="index_split_016.html#filepos717713"><span class="calibre_7">Matplotlib</span></a>, <a href="index_split_028.html#filepos1741829"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1754939"><span class="calibre_7">Plotting with UDFs</span></a></li><li value="23" class="calibre_10">Plotly, <a href="index_split_016.html#filepos728120"><span class="calibre_7">Plotly</span></a>-<a href="index_split_016.html#filepos737814"><span class="calibre_7">Plotly</span></a><ul class="calibre_135"><li value="1" class="calibre_13">heatmaps, <a href="index_split_017.html#filepos838730"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="2" class="calibre_10">installing, <a href="index_split_008.html#filepos125084"><span class="calibre_7">Package Managers: Conda and pip</span></a></li></ul></li><li value="24" class="calibre_10">plots<ul class="calibre_135"><li value="1" class="calibre_13">as Excel pictures, <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="2" class="calibre_10">list of plotting libraries, <a href="index_split_016.html#filepos738084"><span class="calibre_7">Plotly</span></a></li><li value="3" class="calibre_10">in Matplotlib, <a href="index_split_016.html#filepos717479"><span class="calibre_7">Matplotlib</span></a>-<a href="index_split_016.html#filepos727877"><span class="calibre_7">Matplotlib</span></a></li><li value="4" class="calibre_10">in Plotly, <a href="index_split_016.html#filepos728120"><span class="calibre_7">Plotly</span></a>-<a href="index_split_016.html#filepos737814"><span class="calibre_7">Plotly</span></a></li><li value="5" class="calibre_10">types of (pandas), <a href="index_split_016.html#filepos733673"><span class="calibre_7">Plotly</span></a></li></ul></li><li value="25" class="calibre_10">plotting<ul class="calibre_135"><li value="1" class="calibre_13">DataFrame data<ul class="calibre_136"><li value="1" class="calibre_13">list of plotting libraries, <a href="index_split_016.html#filepos738084"><span class="calibre_7">Plotly</span></a></li><li value="2" class="calibre_10">with Matplotlib, <a href="index_split_016.html#filepos717479"><span class="calibre_7">Matplotlib</span></a>-<a href="index_split_016.html#filepos727877"><span class="calibre_7">Matplotlib</span></a></li><li value="3" class="calibre_10">with Plotly, <a href="index_split_016.html#filepos728120"><span class="calibre_7">Plotly</span></a>-<a href="index_split_016.html#filepos737814"><span class="calibre_7">Plotly</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_016.html#filepos716977"><span class="calibre_7">Plotting</span></a></li></ul></li><li value="2" class="calibre_10">with UDFs, <a href="index_split_028.html#filepos1741829"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1754939"><span class="calibre_7">Plotting with UDFs</span></a></li></ul></li><li value="26" class="calibre_10">pop method (lists), <a href="index_split_011.html#filepos260070"><span class="calibre_7">Lists</span></a></li><li value="27" class="calibre_10">position (pandas)<ul class="calibre_135"><li value="1" class="calibre_13">selecting data by, <a href="index_split_015.html#filepos539083"><span class="calibre_7">Selecting by position</span></a>-<a href="index_split_015.html#filepos549467"><span class="calibre_7">Selecting by position</span></a></li><li value="2" class="calibre_10">setting data by, <a href="index_split_015.html#filepos576247"><span class="calibre_7">Setting data by label or position</span></a></li></ul></li><li value="28" class="calibre_10">positional arguments (for functions), <a href="index_split_012.html#filepos372056"><span class="calibre_7">Calling functions</span></a></li><li value="29" class="calibre_10">POST requests, <a href="index_split_027.html#filepos1493790"><span class="calibre_7">Web APIs</span></a></li><li value="30" class="calibre_10">PostgreSQL, <a href="index_split_027.html#filepos1516369"><span class="calibre_7">Databases</span></a>, <a href="index_split_027.html#filepos1643404"><span class="calibre_7">Backend</span></a></li><li value="31" class="calibre_10">Power BI, <a href="index_split_007.html#filepos61061"><span class="calibre_7">Power BI</span></a></li><li value="32" class="calibre_10">Power Pivot, <a href="index_split_003.html#filepos9127"><span class="calibre_7">Preface</span></a>, <a href="index_split_007.html#filepos60136"><span class="calibre_7">Power Query and Power Pivot</span></a></li><li value="33" class="calibre_10">Power Query, <a href="index_split_003.html#filepos9041"><span class="calibre_7">Preface</span></a>, <a href="index_split_007.html#filepos59126"><span class="calibre_7">Power Query and Power Pivot</span></a></li><li value="34" class="calibre_10">The Pragmatic Programmer (Hunt and Thomas), <a href="index_split_007.html#filepos46294"><span class="calibre_7">DRY principle</span></a></li><li value="35" class="calibre_10">presentation layer, <a href="index_split_007.html#filepos43779"><span class="calibre_7">Separation of concerns</span></a></li><li value="36" class="calibre_10">primary keys (databases), <a href="index_split_027.html#filepos1527951"><span class="calibre_7">The Package Tracker database</span></a></li><li value="37" class="calibre_10">print function, <a href="index_split_009.html#filepos167325"><span class="calibre_7">Running a Python Script</span></a>, <a href="index_split_028.html#filepos1755260"><span class="calibre_7">Debugging UDFs</span></a></li><li value="38" class="calibre_10">programming Excel, reading/writing files versus, <a href="index_split_005.html#filepos18185"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="39" class="calibre_10">programming languages<ul class="calibre_135"><li value="1" class="calibre_13">best practices<ul class="calibre_136"><li value="1" class="calibre_13">DRY principle, <a href="index_split_007.html#filepos46294"><span class="calibre_7">DRY principle</span></a></li><li value="2" class="calibre_10">separation of concerns, <a href="index_split_007.html#filepos41610"><span class="calibre_7">Separation of concerns</span></a>-<a href="index_split_007.html#filepos45911"><span class="calibre_7">Separation of concerns</span></a></li><li value="3" class="calibre_10">testing, <a href="index_split_007.html#filepos48860"><span class="calibre_7">Testing</span></a></li><li value="4" class="calibre_10">version control, <a href="index_split_007.html#filepos51713"><span class="calibre_7">Version control</span></a>-<a href="index_split_007.html#filepos57576"><span class="calibre_7">Version control</span></a></li></ul></li><li value="2" class="calibre_10">Excel as, <a href="index_split_007.html#filepos35748"><span class="calibre_7">Excel Is a Programming Language</span></a>-<a href="index_split_007.html#filepos38457"><span class="calibre_7">Excel Is a Programming Language</span></a></li></ul></li><li value="40" class="calibre_10">properties of app object (xlwings), <a href="index_split_025.html#filepos1428002"><span class="calibre_7">App properties</span></a></li><li value="41" class="calibre_10">pseudorandom numbers, generating, <a href="index_split_014.html#filepos473280"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="42" class="calibre_10">PTVS (Python Tools for Visual Studio), <a href="index_split_009.html#filepos159079"><span class="calibre_7">Visual Studio Code</span></a></li><li value="43" class="calibre_10">pull requests, <a href="index_split_007.html#filepos53419"><span class="calibre_7">Version control</span></a></li><li value="44" class="calibre_10">pwd command, <a href="index_split_008.html#filepos105254"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="45" class="calibre_10">PyArrow, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a></li><li value="46" class="calibre_10">pycache folder, <a href="index_split_012.html#filepos390629"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="47" class="calibre_10">PyCharm, <a href="index_split_009.html#filepos174659"><span class="calibre_7">Running a Python Script</span></a></li><li value="48" class="calibre_10">PyDev, <a href="index_split_009.html#filepos176621"><span class="calibre_7">Running a Python Script</span></a></li><li value="49" class="calibre_10">pyexcel, <a href="index_split_022.html#filepos1230583"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="50" class="calibre_10">PyExcelerate, <a href="index_split_022.html#filepos1230903"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="51" class="calibre_10">PyInstaller, <a href="index_split_026.html#filepos1475043"><span class="calibre_7">Python Dependency</span></a></li><li value="52" class="calibre_10">pylightxl, <a href="index_split_022.html#filepos1231224"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="53" class="calibre_10">PyPI (Python Package Index), <a href="index_split_007.html#filepos72449"><span class="calibre_7">Standard Library and Package Manager</span></a>, <a href="index_split_027.html#filepos1489666"><span class="calibre_7">What We Will Build</span></a>, <a href="index_split_027.html#filepos1504690"><span class="calibre_7">Web APIs</span></a></li><li value="54" class="calibre_10">PyPy, <a href="index_split_007.html#filepos73085"><span class="calibre_7">Standard Library and Package Manager</span></a></li><li value="55" class="calibre_10">PySpark, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a></li><li value="56" class="calibre_10">Python<ul class="calibre_135"><li value="1" class="calibre_13">advantages for Excel, <a href="index_split_007.html#filepos62589"><span class="calibre_7">Python for Excel</span></a><ul class="calibre_136"><li value="1" class="calibre_13">cross-platform compatibility, <a href="index_split_007.html#filepos90342"><span class="calibre_7">Cross-Platform Compatibility</span></a></li><li value="2" class="calibre_10">modern language features, <a href="index_split_007.html#filepos80870"><span class="calibre_7">Modern Language Features</span></a>-<a href="index_split_007.html#filepos89951"><span class="calibre_7">Modern Language Features</span></a></li><li value="3" class="calibre_10">readability, <a href="index_split_007.html#filepos64414"><span class="calibre_7">Readability and Maintainability</span></a>-<a href="index_split_007.html#filepos71415"><span class="calibre_7">Readability and Maintainability</span></a></li><li value="4" class="calibre_10">scientific computing, <a href="index_split_007.html#filepos76559"><span class="calibre_7">Scientific Computing</span></a></li><li value="5" class="calibre_10">standard library and package manager, <a href="index_split_007.html#filepos71589"><span class="calibre_7">Standard Library and Package Manager</span></a>-<a href="index_split_007.html#filepos76314"><span class="calibre_7">Standard Library and Package Manager</span></a></li></ul></li><li value="2" class="calibre_10">Anaconda distribution (see Anaconda)</li><li value="3" class="calibre_10">boolean operators, <a href="index_split_011.html#filepos205160"><span class="calibre_7">Booleans</span></a></li><li value="4" class="calibre_10">classes, <a href="index_split_011.html#filepos188185"><span class="calibre_7">Attributes and methods</span></a></li><li value="5" class="calibre_10">comments, <a href="index_split_011.html#filepos201944"><span class="calibre_7">Mathematical operators</span></a></li><li value="6" class="calibre_10">control flow<ul class="calibre_136"><li value="1" class="calibre_13">code blocks, <a href="index_split_011.html#filepos303668"><span class="calibre_7">Code Blocks and the pass Statement</span></a>-<a href="index_split_012.html#filepos306087"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="2" class="calibre_10">conditional expressions, <a href="index_split_012.html#filepos314525"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="3" class="calibre_10">dictionary comprehensions, <a href="index_split_012.html#filepos355651"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="4" class="calibre_10">for loops, <a href="index_split_012.html#filepos316683"><span class="calibre_7">The for and while Loops</span></a>-<a href="index_split_012.html#filepos341967"><span class="calibre_7">The for and while Loops</span></a></li><li value="5" class="calibre_10">if statements, <a href="index_split_012.html#filepos306285"><span class="calibre_7">The if Statement and Conditional Expressions</span></a>-<a href="index_split_012.html#filepos316429"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="6" class="calibre_10">list comprehensions, <a href="index_split_012.html#filepos347118"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="7" class="calibre_10">pass statement, <a href="index_split_011.html#filepos303668"><span class="calibre_7">Code Blocks and the pass Statement</span></a>-<a href="index_split_012.html#filepos306087"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="8" class="calibre_10">set comprehensions, <a href="index_split_012.html#filepos358997"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="9" class="calibre_10">while loops, <a href="index_split_012.html#filepos343907"><span class="calibre_7">The for and while Loops</span></a></li></ul></li><li value="7" class="calibre_10">data structures<ul class="calibre_136"><li value="1" class="calibre_13">dictionaries, <a href="index_split_011.html#filepos268897"><span class="calibre_7">Dictionaries</span></a>-<a href="index_split_011.html#filepos285555"><span class="calibre_7">Dictionaries</span></a></li><li value="2" class="calibre_10">list of, <a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="3" class="calibre_10">lists, <a href="index_split_011.html#filepos243228"><span class="calibre_7">Lists</span></a>-<a href="index_split_011.html#filepos268531"><span class="calibre_7">Lists</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_011.html#filepos242442"><span class="calibre_7">Data Structures</span></a></li><li value="5" class="calibre_10">sets, <a href="index_split_011.html#filepos290624"><span class="calibre_7">Sets</span></a>-<a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="6" class="calibre_10">tuples, <a href="index_split_011.html#filepos285858"><span class="calibre_7">Tuples</span></a></li></ul></li><li value="8" class="calibre_10">data types<ul class="calibre_136"><li value="1" class="calibre_13">boolean, <a href="index_split_011.html#filepos205063"><span class="calibre_7">Booleans</span></a>-<a href="index_split_011.html#filepos217752"><span class="calibre_7">Booleans</span></a></li><li value="2" class="calibre_10">mutable versus immutable, <a href="index_split_031.html#filepos1865731"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="3" class="calibre_10">numeric, <a href="index_split_011.html#filepos189160"><span class="calibre_7">Numeric Types</span></a>-<a href="index_split_011.html#filepos194525"><span class="calibre_7">Numeric Types</span></a></li><li value="4" class="calibre_10">purpose of, <a href="index_split_010.html#filepos180377"><span class="calibre_7">Data Types</span></a></li><li value="5" class="calibre_10">strings, <a href="index_split_011.html#filepos217986"><span class="calibre_7">Strings</span></a>-<a href="index_split_011.html#filepos227137"><span class="calibre_7">Strings</span></a></li></ul></li><li value="9" class="calibre_10">functions<ul class="calibre_136"><li value="1" class="calibre_13">calling, <a href="index_split_011.html#filepos185990"><span class="calibre_7">Functions</span></a>, <a href="index_split_012.html#filepos370297"><span class="calibre_7">Calling functions</span></a>, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="2" class="calibre_10">defining, <a href="index_split_012.html#filepos362480"><span class="calibre_7">Defining functions</span></a></li><li value="3" class="calibre_10">purpose of, <a href="index_split_012.html#filepos361996"><span class="calibre_7">Functions</span></a></li></ul></li><li value="10" class="calibre_10">history of, <a href="index_split_007.html#filepos34260"><span class="calibre_7">Why Python for Excel?</span></a>-<a href="index_split_007.html#filepos35198"><span class="calibre_7">Why Python for Excel?</span></a></li><li value="11" class="calibre_10">indexing, <a href="index_split_011.html#filepos228067"><span class="calibre_7">Indexing</span></a></li><li value="12" class="calibre_10">interactive session<ul class="calibre_136"><li value="1" class="calibre_13">ending, <a href="index_split_008.html#filepos118780"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="2" class="calibre_10">starting, <a href="index_split_008.html#filepos115018"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a>-<a href="index_split_008.html#filepos118983"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li></ul></li><li value="13" class="calibre_10">line breaks, <a href="index_split_011.html#filepos253745"><span class="calibre_7">Lists</span></a></li><li value="14" class="calibre_10">logarithms in, <a href="index_split_017.html#filepos810574"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="15" class="calibre_10">macOS permissions, <a href="index_split_024.html#filepos1249144"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="16" class="calibre_10">mathematical operators, <a href="index_split_011.html#filepos196304"><span class="calibre_7">Mathematical operators</span></a></li><li value="17" class="calibre_10">module search path, <a href="index_split_026.html#filepos1466429"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1468145"><span class="calibre_7">RunPython Function</span></a>, <a href="index_split_026.html#filepos1483129"><span class="calibre_7">Settings</span></a></li><li value="18" class="calibre_10">modules<ul class="calibre_136"><li value="1" class="calibre_13">datetime module, <a href="index_split_012.html#filepos392883"><span class="calibre_7">The datetime Class</span></a>-<a href="index_split_012.html#filepos408810"><span class="calibre_7">The datetime Class</span></a>, <a href="index_split_031.html#filepos1848019"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a>-<a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="2" class="calibre_10">importing, <a href="index_split_012.html#filepos376420"><span class="calibre_7">Modules and the import Statement</span></a>-<a href="index_split_012.html#filepos392723"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="3" class="calibre_10">timezone module, <a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li></ul></li><li value="19" class="calibre_10">objects<ul class="calibre_136"><li value="1" class="calibre_13">attributes and methods, <a href="index_split_011.html#filepos187275"><span class="calibre_7">Attributes and methods</span></a>, <a href="index_split_031.html#filepos1833311"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a></li><li value="2" class="calibre_10">as class instances, <a href="index_split_012.html#filepos394507"><span class="calibre_7">The datetime Class</span></a></li><li value="3" class="calibre_10">classes and, <a href="index_split_031.html#filepos1832657"><span class="calibre_7">Classes and Objects</span></a>-<a href="index_split_031.html#filepos1847675"><span class="calibre_7">Classes and Objects</span></a></li><li value="4" class="calibre_10">help documentation, <a href="index_split_011.html#filepos225822"><span class="calibre_7">Strings</span></a></li><li value="5" class="calibre_10">initialization, <a href="index_split_031.html#filepos1837273"><span class="calibre_7">Classes and Objects</span></a></li><li value="6" class="calibre_10">mutable as function arguments, <a href="index_split_031.html#filepos1882799"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1900058"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li><li value="7" class="calibre_10">mutable versus immutable, <a href="index_split_031.html#filepos1865519"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a>-<a href="index_split_031.html#filepos1882596"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="8" class="calibre_10">purpose of, <a href="index_split_010.html#filepos180908"><span class="calibre_7">Objects</span></a></li></ul></li><li value="20" class="calibre_10">packages, building, <a href="index_split_026.html#filepos1483129"><span class="calibre_7">Settings</span></a></li><li value="21" class="calibre_10">PEP 8 style guide<ul class="calibre_136"><li value="1" class="calibre_13">examples, <a href="index_split_012.html#filepos409133"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a>-<a href="index_split_012.html#filepos425840"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a></li><li value="2" class="calibre_10">linting, <a href="index_split_012.html#filepos426221"><span class="calibre_7">PEP 8 and VS Code</span></a></li></ul></li><li value="22" class="calibre_10">purpose of, <a href="index_split_003.html#filepos9905"><span class="calibre_7">Preface</span></a>-<a href="index_split_003.html#filepos10584"><span class="calibre_7">Preface</span></a></li><li value="23" class="calibre_10">saving files, <a href="index_split_028.html#filepos1674980"><span class="calibre_7">UDF Quickstart</span></a></li><li value="24" class="calibre_10">scripts (see scripts)</li><li value="25" class="calibre_10">slicing, <a href="index_split_011.html#filepos233726"><span class="calibre_7">Slicing</span></a></li><li value="26" class="calibre_10">variables, <a href="index_split_010.html#filepos181374"><span class="calibre_7">Variables</span></a></li><li value="27" class="calibre_10">versions of, <a href="index_split_005.html#filepos19456"><span class="calibre_7">Python and Excel Versions</span></a></li><li value="28" class="calibre_10">xlwings dependencies, <a href="index_split_026.html#filepos1472746"><span class="calibre_7">Python Dependency</span></a>-<a href="index_split_026.html#filepos1475110"><span class="calibre_7">Python Dependency</span></a></li></ul></li><li value="57" class="calibre_10">python command, <a href="index_split_008.html#filepos115104"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="58" class="calibre_10">Python Data Analysis Library (see pandas)</li><li value="59" class="calibre_10">Python Interactive Window (VS Code), <a href="index_split_030.html#filepos1831056"><span class="calibre_7">Python Scripts with Code Cells</span></a></li><li value="60" class="calibre_10">Python interpreters (xlwings), <a href="index_split_026.html#filepos1482074"><span class="calibre_7">Settings</span></a></li><li value="61" class="calibre_10">Python Package Tracker case study<ul class="calibre_135"><li value="1" class="calibre_13">application structure, <a href="index_split_027.html#filepos1601418"><span class="calibre_7">Application Structure</span></a><ul class="calibre_136"><li value="1" class="calibre_13">backend, <a href="index_split_027.html#filepos1620020"><span class="calibre_7">Backend</span></a>-<a href="index_split_027.html#filepos1644241"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">debugging, <a href="index_split_027.html#filepos1644656"><span class="calibre_7">Debugging</span></a>-<a href="index_split_027.html#filepos1651460"><span class="calibre_7">Debugging</span></a></li><li value="3" class="calibre_10">frontend, <a href="index_split_027.html#filepos1606230"><span class="calibre_7">Frontend</span></a>-<a href="index_split_027.html#filepos1619827"><span class="calibre_7">Frontend</span></a></li></ul></li><li value="2" class="calibre_10">databases<ul class="calibre_136"><li value="1" class="calibre_13">connections, <a href="index_split_027.html#filepos1529652"><span class="calibre_7">Database connections</span></a>-<a href="index_split_027.html#filepos1537920"><span class="calibre_7">Database connections</span></a></li><li value="2" class="calibre_10">SQL injection, <a href="index_split_027.html#filepos1563158"><span class="calibre_7">SQL injection</span></a>-<a href="index_split_027.html#filepos1579942"><span class="calibre_7">SQL injection</span></a></li><li value="3" class="calibre_10">SQL queries, <a href="index_split_027.html#filepos1538233"><span class="calibre_7">SQL queries</span></a>-<a href="index_split_027.html#filepos1562882"><span class="calibre_7">SQL queries</span></a></li><li value="4" class="calibre_10">structure of, <a href="index_split_027.html#filepos1520310"><span class="calibre_7">The Package Tracker database</span></a>-<a href="index_split_027.html#filepos1529401"><span class="calibre_7">The Package Tracker database</span></a></li><li value="5" class="calibre_10">types of, <a href="index_split_027.html#filepos1515417"><span class="calibre_7">Databases</span></a>-<a href="index_split_027.html#filepos1519777"><span class="calibre_7">Databases</span></a></li></ul></li><li value="3" class="calibre_10">error handling, <a href="index_split_027.html#filepos1580257"><span class="calibre_7">Exceptions</span></a>-<a href="index_split_027.html#filepos1601081"><span class="calibre_7">Exceptions</span></a></li><li value="4" class="calibre_10">packages, adding, <a href="index_split_027.html#filepos1489144"><span class="calibre_7">What We Will Build</span></a>-<a href="index_split_027.html#filepos1492009"><span class="calibre_7">What We Will Build</span></a></li><li value="5" class="calibre_10">web APIs, <a href="index_split_027.html#filepos1492808"><span class="calibre_7">Web APIs</span></a>-<a href="index_split_027.html#filepos1515072"><span class="calibre_7">Web APIs</span></a></li></ul></li><li value="62" class="calibre_10">Python REPL, <a href="index_split_008.html#filepos115018"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a>-<a href="index_split_008.html#filepos118983"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="63" class="calibre_10">Python Tools for Visual Studio (PTVS), <a href="index_split_009.html#filepos159079"><span class="calibre_7">Visual Studio Code</span></a></li><li value="64" class="calibre_10">Pythonic style, <a href="index_split_012.html#filepos309980"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="65" class="calibre_10">PYTHONPATH setting (xlwings), <a href="index_split_026.html#filepos1466429"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1468145"><span class="calibre_7">RunPython Function</span></a>, <a href="index_split_026.html#filepos1483129"><span class="calibre_7">Settings</span></a>, <a href="index_split_028.html#filepos1676726"><span class="calibre_7">UDF Quickstart</span></a></li><li value="66" class="calibre_10">pytrends, <a href="index_split_008.html#filepos125608"><span class="calibre_7">Package Managers: Conda and pip</span></a>, <a href="index_split_028.html#filepos1715202"><span class="calibre_7">Fetching Data from Google Trends</span></a>-<a href="index_split_028.html#filepos1738598"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="67" class="calibre_10">pyxlsb<ul class="calibre_135"><li value="1" class="calibre_13">installing, <a href="index_split_008.html#filepos125608"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="2" class="calibre_10">reading files, <a href="index_split_019.html#filepos926988"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="3" class="calibre_10">when to use, <a href="index_split_020.html#filepos964224"><span class="calibre_7">When to Use Which Package</span></a></li></ul></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">Q</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">queries (SQL), <a href="index_split_027.html#filepos1538233"><span class="calibre_7">SQL queries</span></a>-<a href="index_split_027.html#filepos1562882"><span class="calibre_7">SQL queries</span></a></li><li value="2" class="calibre_10">quickstart command (xlwings), <a href="index_split_026.html#filepos1448302"><span class="calibre_7">Quickstart Command</span></a><ul class="calibre_135"><li value="1" class="calibre_13">importing UDFs, <a href="index_split_028.html#filepos1657477"><span class="calibre_7">UDF Quickstart</span></a>-<a href="index_split_028.html#filepos1679023"><span class="calibre_7">UDF Quickstart</span></a></li><li value="2" class="calibre_10">RunPython function and, <a href="index_split_026.html#filepos1459577"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1468568"><span class="calibre_7">RunPython Function</span></a></li></ul></li><li value="3" class="calibre_10">quit command, <a href="index_split_008.html#filepos118780"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">R</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">random numbers, generating, <a href="index_split_014.html#filepos473280"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="2" class="calibre_10">range function, <a href="index_split_012.html#filepos322530"><span class="calibre_7">The for and while Loops</span></a>-<a href="index_split_012.html#filepos328659"><span class="calibre_7">The for and while Loops</span></a></li><li value="3" class="calibre_10">range object (xlwings), <a href="index_split_024.html#filepos1265312"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1293849"><span class="calibre_7">The Excel Object Model</span></a><ul class="calibre_135"><li value="1" class="calibre_13">converters, <a href="index_split_025.html#filepos1340690"><span class="calibre_7">Converters and Options</span></a></li><li value="2" class="calibre_10">options, <a href="index_split_025.html#filepos1345103"><span class="calibre_7">Converters and Options</span></a>-<a href="index_split_025.html#filepos1366895"><span class="calibre_7">Converters and Options</span></a></li></ul></li><li value="4" class="calibre_10">raw strings, <a href="index_split_016.html#filepos747454"><span class="calibre_7">Exporting CSV Files</span></a></li><li value="5" class="calibre_10">raw values, <a href="index_split_025.html#filepos1424751"><span class="calibre_7">Raw values</span></a>, <a href="index_split_028.html#filepos1770837"><span class="calibre_7">Using raw values</span></a></li><li value="6" class="calibre_10">read function (excel.py), <a href="index_split_021.html#filepos976882"><span class="calibre_7">The excel.py Module</span></a></li><li value="7" class="calibre_10">readability of Python, <a href="index_split_007.html#filepos64414"><span class="calibre_7">Readability and Maintainability</span></a>-<a href="index_split_007.html#filepos71415"><span class="calibre_7">Readability and Maintainability</span></a></li><li value="8" class="calibre_10">reader/writer packages<ul class="calibre_135"><li value="1" class="calibre_13">excel.py module, <a href="index_split_021.html#filepos972622"><span class="calibre_7">The excel.py Module</span></a>-<a href="index_split_021.html#filepos980989"><span class="calibre_7">The excel.py Module</span></a></li><li value="2" class="calibre_10">list of, <a href="index_split_022.html#filepos1230090"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="3" class="calibre_10">OpenPyXL, <a href="index_split_021.html#filepos981782"><span class="calibre_7">OpenPyXL</span></a>-<a href="index_split_021.html#filepos1039562"><span class="calibre_7">Editing with OpenPyXL</span></a></li><li value="4" class="calibre_10">optimization for big files, <a href="index_split_022.html#filepos1125159"><span class="calibre_7">Working with Big Excel Files</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="5" class="calibre_10">pyxlsb, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="6" class="calibre_10">when to use, <a href="index_split_020.html#filepos962384"><span class="calibre_7">When to Use Which Package</span></a>-<a href="index_split_021.html#filepos972372"><span class="calibre_7">When to Use Which Package</span></a></li><li value="7" class="calibre_10">xlrd, <a href="index_split_021.html#filepos1085917"><span class="calibre_7">Reading with xlrd</span></a>-<a href="index_split_021.html#filepos1099832"><span class="calibre_7">Reading with xlrd</span></a></li><li value="8" class="calibre_10">XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a></li><li value="9" class="calibre_10">xlutils, <a href="index_split_022.html#filepos1119688"><span class="calibre_7">Editing with xlutils</span></a></li><li value="10" class="calibre_10">xlwt, <a href="index_split_022.html#filepos1099995"><span class="calibre_7">Writing with xlwt</span></a>-<a href="index_split_022.html#filepos1119593"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li><li value="9" class="calibre_10">reading<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames in Excel with xlwings, <a href="index_split_025.html#filepos1324128"><span class="calibre_7">Working with DataFrames</span></a>-<a href="index_split_025.html#filepos1340369"><span class="calibre_7">Working with DataFrames</span></a></li><li value="2" class="calibre_10">files (Excel)<ul class="calibre_136"><li value="1" class="calibre_13">limitations in pandas, <a href="index_split_019.html#filepos957495"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></a></li><li value="2" class="calibre_10">with OpenPyXL, <a href="index_split_021.html#filepos982131"><span class="calibre_7">Reading with OpenPyXL</span></a>-<a href="index_split_021.html#filepos996210"><span class="calibre_7">Writing with OpenPyXL</span></a>, <a href="index_split_022.html#filepos1141062"><span class="calibre_7">Reading with OpenPyXL</span></a></li><li value="3" class="calibre_10">with pandas, <a href="index_split_019.html#filepos886398"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>-<a href="index_split_019.html#filepos935481"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="4" class="calibre_10">in parallel, <a href="index_split_022.html#filepos1144410"><span class="calibre_7">Reading sheets in parallel</span></a>-<a href="index_split_022.html#filepos1157423"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="5" class="calibre_10">programming Excel versus, <a href="index_split_005.html#filepos18185"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="6" class="calibre_10">with pyxlsb, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="7" class="calibre_10">from URLs, <a href="index_split_019.html#filepos922687"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="8" class="calibre_10">with xlrd, <a href="index_split_021.html#filepos1085917"><span class="calibre_7">Reading with xlrd</span></a>-<a href="index_split_021.html#filepos1099832"><span class="calibre_7">Reading with xlrd</span></a>, <a href="index_split_022.html#filepos1134915"><span class="calibre_7">Reading with xlrd</span></a></li></ul></li></ul></li><li value="10" class="calibre_10">read_csv function (pandas), <a href="index_split_016.html#filepos748628"><span class="calibre_7">Importing CSV Files</span></a>-<a href="index_split_016.html#filepos764876"><span class="calibre_7">Importing CSV Files</span></a>, <a href="index_split_017.html#filepos786030"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="11" class="calibre_10">read_excel function (pandas), <a href="index_split_015.html#filepos486309"><span class="calibre_7">DataFrame and Series</span></a>, <a href="index_split_019.html#filepos866436"><span class="calibre_7">Case Study: Excel Reporting</span></a>, <a href="index_split_019.html#filepos886398"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>-<a href="index_split_019.html#filepos935481"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>, <a href="index_split_021.html#filepos971083"><span class="calibre_7">When to Use Which Package</span></a></li><li value="12" class="calibre_10">rebasing in time series analysis, <a href="index_split_017.html#filepos822133"><span class="calibre_7">Rebasing and Correlation</span></a>-<a href="index_split_017.html#filepos846848"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="13" class="calibre_10">recalculating functions (Excel), <a href="index_split_028.html#filepos1671914"><span class="calibre_7">UDF Quickstart</span></a></li><li value="14" class="calibre_10">records (databases), <a href="index_split_027.html#filepos1527951"><span class="calibre_7">The Package Tracker database</span></a></li><li value="15" class="calibre_10">recursive globbing, <a href="index_split_019.html#filepos884117"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="16" class="calibre_10">Redis, <a href="index_split_027.html#filepos1518942"><span class="calibre_7">Databases</span></a></li><li value="17" class="calibre_10">regional settings (Excel), <a href="index_split_024.html#filepos1254107"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1255983"><span class="calibre_7">The Excel Object Model</span></a></li><li value="18" class="calibre_10">reindex method (pandas), <a href="index_split_015.html#filepos507287"><span class="calibre_7">Index</span></a></li><li value="19" class="calibre_10">relational databases, <a href="index_split_027.html#filepos1515821"><span class="calibre_7">Databases</span></a>-<a href="index_split_027.html#filepos1519443"><span class="calibre_7">Databases</span></a></li><li value="20" class="calibre_10">relative paths, <a href="index_split_008.html#filepos112263"><span class="calibre_7">Anaconda Prompt</span></a>, <a href="index_split_027.html#filepos1638593"><span class="calibre_7">Backend</span></a></li><li value="21" class="calibre_10">removing<ul class="calibre_135"><li value="1" class="calibre_13">duplicate data (pandas), <a href="index_split_015.html#filepos609015"><span class="calibre_7">Duplicate Data</span></a></li><li value="2" class="calibre_10">missing data rows (pandas), <a href="index_split_015.html#filepos602631"><span class="calibre_7">Missing Data</span></a></li></ul></li><li value="22" class="calibre_10">renaming<ul class="calibre_135"><li value="1" class="calibre_13">columns (pandas), <a href="index_split_015.html#filepos515814"><span class="calibre_7">Columns</span></a></li><li value="2" class="calibre_10">Jupyter notebooks, <a href="index_split_008.html#filepos134176"><span class="calibre_7">Running Jupyter Notebooks</span></a></li></ul></li><li value="23" class="calibre_10">reordering columns (pandas), <a href="index_split_015.html#filepos521832"><span class="calibre_7">Columns</span></a></li><li value="24" class="calibre_10">replace method (pandas), <a href="index_split_015.html#filepos589430"><span class="calibre_7">Setting data by replacing values</span></a></li><li value="25" class="calibre_10">replacing values (pandas), setting data by, <a href="index_split_015.html#filepos589332"><span class="calibre_7">Setting data by replacing values</span></a></li><li value="26" class="calibre_10">reporting case study (Excel), <a href="index_split_019.html#filepos864531"><span class="calibre_7">Case Study: Excel Reporting</span></a>-<a href="index_split_019.html#filepos885516"><span class="calibre_7">Case Study: Excel Reporting</span></a>, <a href="index_split_022.html#filepos1232433"><span class="calibre_7">Case Study (Revisited): Excel Reporting</span></a>, <a href="index_split_025.html#filepos1400987"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a>-<a href="index_split_025.html#filepos1409826"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li><li value="27" class="calibre_10">representational state transfer (REST) API, <a href="index_split_027.html#filepos1503021"><span class="calibre_7">Web APIs</span></a></li><li value="28" class="calibre_10">Requests package, <a href="index_split_027.html#filepos1506175"><span class="calibre_7">Web APIs</span></a></li><li value="29" class="calibre_10">required arguments (for functions), <a href="index_split_012.html#filepos364602"><span class="calibre_7">Defining functions</span></a></li><li value="30" class="calibre_10">resample method (pandas), <a href="index_split_017.html#filepos847388"><span class="calibre_7">Resampling</span></a></li><li value="31" class="calibre_10">resampling in time series analysis, <a href="index_split_017.html#filepos847003"><span class="calibre_7">Resampling</span></a>-<a href="index_split_017.html#filepos854741"><span class="calibre_7">Resampling</span></a></li><li value="32" class="calibre_10">resetting<ul class="calibre_135"><li value="1" class="calibre_13">indices (pandas), <a href="index_split_015.html#filepos502052"><span class="calibre_7">Index</span></a></li><li value="2" class="calibre_10">MultiIndexes (pandas), <a href="index_split_015.html#filepos573635"><span class="calibre_7">Selecting by using a MultiIndex</span></a></li></ul></li><li value="33" class="calibre_10">reset_index method (pandas), <a href="index_split_015.html#filepos502052"><span class="calibre_7">Index</span></a></li><li value="34" class="calibre_10">reshape function (NumPy), <a href="index_split_014.html#filepos471368"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="35" class="calibre_10">resolve method (Path class), <a href="index_split_019.html#filepos882885"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="36" class="calibre_10">REST (representational state transfer) API, <a href="index_split_027.html#filepos1503021"><span class="calibre_7">Web APIs</span></a></li><li value="37" class="calibre_10">Restart button (VS Code debugger), <a href="index_split_030.html#filepos1824818"><span class="calibre_7">Debugger</span></a></li><li value="38" class="calibre_10">return decorators (xlwings), <a href="index_split_028.html#filepos1709547"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>, <a href="index_split_028.html#filepos1801826"><span class="calibre_7">The Sub Decorator</span></a></li><li value="39" class="calibre_10">return statement (for functions), <a href="index_split_012.html#filepos365301"><span class="calibre_7">Defining functions</span></a></li><li value="40" class="calibre_10">revenues.py example, <a href="index_split_028.html#filepos1764661"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="41" class="calibre_10">rglob method (Path class), <a href="index_split_019.html#filepos884117"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="42" class="calibre_10">right joins, <a href="index_split_016.html#filepos669071"><span class="calibre_7">Joining and Merging</span></a></li><li value="43" class="calibre_10">rolling method (pandas), <a href="index_split_017.html#filepos855557"><span class="calibre_7">Rolling Windows</span></a></li><li value="44" class="calibre_10">rolling windows in time series analysis, <a href="index_split_017.html#filepos855004"><span class="calibre_7">Rolling Windows</span></a></li><li value="45" class="calibre_10">Run File button (VS Code), <a href="index_split_009.html#filepos171481"><span class="calibre_7">Running a Python Script</span></a></li><li value="46" class="calibre_10">Run main button (xlwings), <a href="index_split_026.html#filepos1449910"><span class="calibre_7">Run Main</span></a>-<a href="index_split_026.html#filepos1458891"><span class="calibre_7">Run Main</span></a></li><li value="47" class="calibre_10">run order of Jupyter notebook cells, <a href="index_split_009.html#filepos145168"><span class="calibre_7">Run Order Matters</span></a></li><li value="48" class="calibre_10">running<ul class="calibre_135"><li value="1" class="calibre_13">Anaconda Prompt<ul class="calibre_136"><li value="1" class="calibre_13">in macOS, <a href="index_split_008.html#filepos104346"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">in Windows, <a href="index_split_008.html#filepos103402"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="2" class="calibre_10">code from text editor, <a href="index_split_009.html#filepos155991"><span class="calibre_7">Visual Studio Code</span></a></li><li value="3" class="calibre_10">Jupyter notebooks, <a href="index_split_008.html#filepos132444"><span class="calibre_7">Running Jupyter Notebooks</span></a>-<a href="index_split_008.html#filepos134424"><span class="calibre_7">Running Jupyter Notebooks</span></a>, <a href="index_split_030.html#filepos1826689"><span class="calibre_7">Run Jupyter Notebooks</span></a>-<a href="index_split_030.html#filepos1829065"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="4" class="calibre_10">macros (Excel), <a href="index_split_026.html#filepos1462470"><span class="calibre_7">RunPython Function</span></a></li><li value="5" class="calibre_10">scripts<ul class="calibre_136"><li value="1" class="calibre_13">importing modules versus, <a href="index_split_027.html#filepos1641594"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">in VS Code, <a href="index_split_009.html#filepos165121"><span class="calibre_7">Running a Python Script</span></a>-<a href="index_split_009.html#filepos172327"><span class="calibre_7">Running a Python Script</span></a></li></ul></li><li value="6" class="calibre_10">VBA code in xlwings, <a href="index_split_024.html#filepos1313318"><span class="calibre_7">Running VBA Code</span></a>-<a href="index_split_025.html#filepos1322929"><span class="calibre_7">Running VBA Code</span></a></li><li value="7" class="calibre_10">VS Code in Anaconda Prompt, <a href="index_split_009.html#filepos165226"><span class="calibre_7">Running a Python Script</span></a></li></ul></li><li value="49" class="calibre_10">RunPython function (xlwings), <a href="index_split_026.html#filepos1459375"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1471460"><span class="calibre_7">RunPython without quickstart command</span></a>, <a href="index_split_026.html#filepos1484138"><span class="calibre_7">Settings</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">S</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">sales_report_openpyxl.py, <a href="index_split_022.html#filepos1233238"><span class="calibre_7">Case Study (Revisited): Excel Reporting</span></a></li><li value="2" class="calibre_10">sales_report_pandas.py example, <a href="index_split_019.html#filepos871006"><span class="calibre_7">Case Study: Excel Reporting</span></a>-<a href="index_split_019.html#filepos884117"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="3" class="calibre_10">sales_report_xlsxwriter.py, <a href="index_split_022.html#filepos1233238"><span class="calibre_7">Case Study (Revisited): Excel Reporting</span></a></li><li value="4" class="calibre_10">sales_report_xlwings.py example, <a href="index_split_025.html#filepos1403162"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li><li value="5" class="calibre_10">sandboxed environments, <a href="index_split_024.html#filepos1253282"><span class="calibre_7">The Excel Object Model</span></a>, <a href="index_split_024.html#filepos1309403"><span class="calibre_7">The Excel Object Model</span></a></li><li value="6" class="calibre_10">saving<ul class="calibre_135"><li value="1" class="calibre_13">Jupyter notebooks in VS Code, <a href="index_split_030.html#filepos1828008"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="2" class="calibre_10">Python files, <a href="index_split_028.html#filepos1674980"><span class="calibre_7">UDF Quickstart</span></a></li></ul></li><li value="7" class="calibre_10">scalars, <a href="index_split_014.html#filepos449798"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="8" class="calibre_10">scientific computing in Python, <a href="index_split_007.html#filepos76559"><span class="calibre_7">Scientific Computing</span></a></li><li value="9" class="calibre_10">scripts<ul class="calibre_135"><li value="1" class="calibre_13">Jupyter notebook cells in, <a href="index_split_030.html#filepos1829327"><span class="calibre_7">Python Scripts with Code Cells</span></a></li><li value="2" class="calibre_10">namespaces of, <a href="index_split_012.html#filepos391305"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="3" class="calibre_10">naming, <a href="index_split_012.html#filepos392387"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="4" class="calibre_10">running<ul class="calibre_136"><li value="1" class="calibre_13">importing modules versus, <a href="index_split_027.html#filepos1641594"><span class="calibre_7">Backend</span></a></li><li value="2" class="calibre_10">in VS Code, <a href="index_split_009.html#filepos165121"><span class="calibre_7">Running a Python Script</span></a>-<a href="index_split_009.html#filepos172327"><span class="calibre_7">Running a Python Script</span></a></li></ul></li></ul></li><li value="10" class="calibre_10">scrolling through command history, <a href="index_split_008.html#filepos113245"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="11" class="calibre_10">Seaborn, <a href="index_split_016.html#filepos738741"><span class="calibre_7">Plotly</span></a></li><li value="12" class="calibre_10">selecting<ul class="calibre_135"><li value="1" class="calibre_13">columns (pandas), <a href="index_split_015.html#filepos537621"><span class="calibre_7">Selecting by label</span></a></li><li value="2" class="calibre_10">DataFrame data<ul class="calibre_136"><li value="1" class="calibre_13">by boolean indexing, <a href="index_split_015.html#filepos549780"><span class="calibre_7">Selecting by boolean indexing</span></a>-<a href="index_split_015.html#filepos567453"><span class="calibre_7">Selecting by boolean indexing</span></a></li><li value="2" class="calibre_10">by label, <a href="index_split_015.html#filepos525461"><span class="calibre_7">Selecting by label</span></a></li><li value="3" class="calibre_10">with MultiIndexes, <a href="index_split_015.html#filepos567793"><span class="calibre_7">Selecting by using a MultiIndex</span></a>-<a href="index_split_015.html#filepos575571"><span class="calibre_7">Selecting by using a MultiIndex</span></a></li><li value="4" class="calibre_10">by position, <a href="index_split_015.html#filepos539083"><span class="calibre_7">Selecting by position</span></a>-<a href="index_split_015.html#filepos549467"><span class="calibre_7">Selecting by position</span></a></li></ul></li></ul></li><li value="13" class="calibre_10">self argument (classes), <a href="index_split_031.html#filepos1837508"><span class="calibre_7">Classes and Objects</span></a></li><li value="14" class="calibre_10">separation of concerns, <a href="index_split_007.html#filepos41610"><span class="calibre_7">Separation of concerns</span></a>-<a href="index_split_007.html#filepos45911"><span class="calibre_7">Separation of concerns</span></a>, <a href="index_split_027.html#filepos1601989"><span class="calibre_7">Application Structure</span></a></li><li value="15" class="calibre_10">Series<ul class="calibre_135"><li value="1" class="calibre_13">arithmetic operations, <a href="index_split_015.html#filepos628066"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="2" class="calibre_10">DataFrames versus, <a href="index_split_015.html#filepos484520"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos485550"><span class="calibre_7">DataFrame and Series</span></a>, <a href="index_split_015.html#filepos536695"><span class="calibre_7">Selecting by label</span></a></li><li value="3" class="calibre_10">descriptive statistics, <a href="index_split_016.html#filepos691290"><span class="calibre_7">Descriptive Statistics</span></a>-<a href="index_split_016.html#filepos695190"><span class="calibre_7">Descriptive Statistics</span></a></li></ul></li><li value="16" class="calibre_10">set comprehensions, <a href="index_split_012.html#filepos358997"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li><li value="17" class="calibre_10">set constructor, <a href="index_split_011.html#filepos291512"><span class="calibre_7">Sets</span></a>-<a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="18" class="calibre_10">set-based languages, <a href="index_split_027.html#filepos1540168"><span class="calibre_7">SQL queries</span></a></li><li value="19" class="calibre_10">sets, <a href="index_split_011.html#filepos290624"><span class="calibre_7">Sets</span></a>-<a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="20" class="calibre_10">setting<ul class="calibre_135"><li value="1" class="calibre_13">array elements (NumPy), <a href="index_split_014.html#filepos463404"><span class="calibre_7">Getting and Setting Array Elements</span></a>-<a href="index_split_014.html#filepos470575"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="2" class="calibre_10">DataFrame data<ul class="calibre_136"><li value="1" class="calibre_13">by adding columns, <a href="index_split_015.html#filepos592331"><span class="calibre_7">Setting data by adding a new column</span></a></li><li value="2" class="calibre_10">by boolean indexing, <a href="index_split_015.html#filepos582259"><span class="calibre_7">Setting data by boolean indexing</span></a>-<a href="index_split_015.html#filepos589159"><span class="calibre_7">Setting data by boolean indexing</span></a></li><li value="3" class="calibre_10">by label, <a href="index_split_015.html#filepos576247"><span class="calibre_7">Setting data by label or position</span></a></li><li value="4" class="calibre_10">by position, <a href="index_split_015.html#filepos576247"><span class="calibre_7">Setting data by label or position</span></a></li><li value="5" class="calibre_10">by replacing values, <a href="index_split_015.html#filepos589332"><span class="calibre_7">Setting data by replacing values</span></a></li></ul></li><li value="3" class="calibre_10">indices (pandas), <a href="index_split_015.html#filepos502052"><span class="calibre_7">Index</span></a></li></ul></li><li value="21" class="calibre_10">settings for xlwings deployment, <a href="index_split_026.html#filepos1480593"><span class="calibre_7">Settings</span></a>-<a href="index_split_026.html#filepos1484138"><span class="calibre_7">Settings</span></a></li><li value="22" class="calibre_10">set_index method (pandas), <a href="index_split_015.html#filepos502108"><span class="calibre_7">Index</span></a></li><li value="23" class="calibre_10">shallow copies, <a href="index_split_031.html#filepos1881031"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a></li><li value="24" class="calibre_10">sheet object (xlwings), <a href="index_split_024.html#filepos1253502"><span class="calibre_7">The Excel Object Model</span></a>, <a href="index_split_024.html#filepos1281618"><span class="calibre_7">The Excel Object Model</span></a></li><li value="25" class="calibre_10">sheets (see files)</li><li value="26" class="calibre_10">shift method (pandas), <a href="index_split_017.html#filepos811119"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="27" class="calibre_10">shifting in time series analysis, <a href="index_split_017.html#filepos809588"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos821793"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="28" class="calibre_10">Show Console checkbox (xlwings add-in), <a href="index_split_027.html#filepos1650611"><span class="calibre_7">Debugging</span></a></li><li value="29" class="calibre_10">shutting down Jupyter notebooks, <a href="index_split_009.html#filepos149871"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li><li value="30" class="calibre_10">significant white space, <a href="index_split_011.html#filepos304028"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="31" class="calibre_10">simple returns, <a href="index_split_017.html#filepos818833"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="32" class="calibre_10">single-clicking in VS Code, <a href="index_split_009.html#filepos172252"><span class="calibre_7">Running a Python Script</span></a></li><li value="33" class="calibre_10">slicing<ul class="calibre_135"><li value="1" class="calibre_13">arrays (NumPy), <a href="index_split_014.html#filepos463404"><span class="calibre_7">Getting and Setting Array Elements</span></a>-<a href="index_split_014.html#filepos470575"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="2" class="calibre_10">with labels (pandas), <a href="index_split_015.html#filepos531987"><span class="calibre_7">Selecting by label</span></a></li><li value="3" class="calibre_10">in Python, <a href="index_split_011.html#filepos233726"><span class="calibre_7">Slicing</span></a></li><li value="4" class="calibre_10">range objects (xlwings), <a href="index_split_024.html#filepos1276198"><span class="calibre_7">The Excel Object Model</span></a></li></ul></li><li value="34" class="calibre_10">sorting<ul class="calibre_135"><li value="1" class="calibre_13">indices (pandas), <a href="index_split_015.html#filepos509482"><span class="calibre_7">Index</span></a>-<a href="index_split_015.html#filepos512499"><span class="calibre_7">Index</span></a></li><li value="2" class="calibre_10">lists, <a href="index_split_011.html#filepos262598"><span class="calibre_7">Lists</span></a></li></ul></li><li value="35" class="calibre_10">sort_index method (pandas), <a href="index_split_015.html#filepos509482"><span class="calibre_7">Index</span></a>-<a href="index_split_015.html#filepos512499"><span class="calibre_7">Index</span></a></li><li value="36" class="calibre_10">source control, <a href="index_split_007.html#filepos51713"><span class="calibre_7">Version control</span></a>-<a href="index_split_007.html#filepos57576"><span class="calibre_7">Version control</span></a></li><li value="37" class="calibre_10">spaghetti code, <a href="index_split_007.html#filepos89417"><span class="calibre_7">Modern Language Features</span></a></li><li value="38" class="calibre_10">spreadsheets (Excel), DataFrames versus, <a href="index_split_015.html#filepos485631"><span class="calibre_7">DataFrame and Series</span></a>-<a href="index_split_015.html#filepos489337"><span class="calibre_7">DataFrame and Series</span></a></li><li value="39" class="calibre_10">Spyder, <a href="index_split_009.html#filepos175133"><span class="calibre_7">Running a Python Script</span></a></li><li value="40" class="calibre_10">SQL injection, <a href="index_split_027.html#filepos1563158"><span class="calibre_7">SQL injection</span></a>-<a href="index_split_027.html#filepos1579942"><span class="calibre_7">SQL injection</span></a></li><li value="41" class="calibre_10">SQL queries, <a href="index_split_027.html#filepos1538233"><span class="calibre_7">SQL queries</span></a>-<a href="index_split_027.html#filepos1562882"><span class="calibre_7">SQL queries</span></a></li><li value="42" class="calibre_10">SQL Server, <a href="index_split_027.html#filepos1516369"><span class="calibre_7">Databases</span></a></li><li value="43" class="calibre_10">SQLAlchemy, <a href="index_split_027.html#filepos1529652"><span class="calibre_7">Database connections</span></a>-<a href="index_split_027.html#filepos1537920"><span class="calibre_7">Database connections</span></a><ul class="calibre_135"><li value="1" class="calibre_13">enforcing foreign keys, <a href="index_split_027.html#filepos1562373"><span class="calibre_7">SQL queries</span></a></li><li value="2" class="calibre_10">SQL injection, <a href="index_split_027.html#filepos1579180"><span class="calibre_7">SQL injection</span></a></li></ul></li><li value="44" class="calibre_10">SQLite, <a href="index_split_027.html#filepos1515821"><span class="calibre_7">Databases</span></a>-<a href="index_split_027.html#filepos1519443"><span class="calibre_7">Databases</span></a><ul class="calibre_135"><li value="1" class="calibre_13">foreign keys in, <a href="index_split_027.html#filepos1562373"><span class="calibre_7">SQL queries</span></a></li><li value="2" class="calibre_10">replacing with PostgreSQL, <a href="index_split_027.html#filepos1643404"><span class="calibre_7">Backend</span></a></li><li value="3" class="calibre_10">VS Code extension, <a href="index_split_027.html#filepos1529158"><span class="calibre_7">The Package Tracker database</span></a></li></ul></li><li value="45" class="calibre_10">standalone workbooks (xlwings), <a href="index_split_026.html#filepos1475399"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a>-<a href="index_split_026.html#filepos1477920"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a></li><li value="46" class="calibre_10">standard library (Python), <a href="index_split_007.html#filepos71589"><span class="calibre_7">Standard Library and Package Manager</span></a>-<a href="index_split_007.html#filepos76314"><span class="calibre_7">Standard Library and Package Manager</span></a></li><li value="47" class="calibre_10">starting interactive Python session, <a href="index_split_008.html#filepos115018"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a>-<a href="index_split_008.html#filepos118983"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="48" class="calibre_10">stateless resources, <a href="index_split_027.html#filepos1503328"><span class="calibre_7">Web APIs</span></a></li><li value="49" class="calibre_10">Status Bar (VS Code), <a href="index_split_009.html#filepos162761"><span class="calibre_7">Installation and Configuration</span></a></li><li value="50" class="calibre_10">Step Into button (VS Code debugger), <a href="index_split_030.html#filepos1824213"><span class="calibre_7">Debugger</span></a></li><li value="51" class="calibre_10">Step Out button (VS Code debugger), <a href="index_split_030.html#filepos1824584"><span class="calibre_7">Debugger</span></a></li><li value="52" class="calibre_10">Step Over button (VS Code debugger), <a href="index_split_030.html#filepos1823834"><span class="calibre_7">Debugger</span></a></li><li value="53" class="calibre_10">Stop button (VS Code debugger), <a href="index_split_030.html#filepos1825010"><span class="calibre_7">Debugger</span></a></li><li value="54" class="calibre_10">storing VBA functions, <a href="index_split_025.html#filepos1322194"><span class="calibre_7">Running VBA Code</span></a></li><li value="55" class="calibre_10">strftime method, <a href="index_split_012.html#filepos404852"><span class="calibre_7">The datetime Class</span></a></li><li value="56" class="calibre_10">strings, <a href="index_split_011.html#filepos217986"><span class="calibre_7">Strings</span></a>-<a href="index_split_011.html#filepos227137"><span class="calibre_7">Strings</span></a><ul class="calibre_135"><li value="1" class="calibre_13">converting to datetime data type, <a href="index_split_017.html#filepos783176"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="2" class="calibre_10">formatting in DataFrames, <a href="index_split_015.html#filepos641289"><span class="calibre_7">Applying a Function</span></a>-<a href="index_split_015.html#filepos645020"><span class="calibre_7">Applying a Function</span></a></li><li value="3" class="calibre_10">methods in DataFrames, <a href="index_split_015.html#filepos634000"><span class="calibre_7">Working with Text Columns</span></a></li><li value="4" class="calibre_10">raw strings, <a href="index_split_016.html#filepos747454"><span class="calibre_7">Exporting CSV Files</span></a></li></ul></li><li value="57" class="calibre_10">strip method (pandas), <a href="index_split_015.html#filepos634575"><span class="calibre_7">Working with Text Columns</span></a></li><li value="58" class="calibre_10">strptime method, <a href="index_split_012.html#filepos404852"><span class="calibre_7">The datetime Class</span></a></li><li value="59" class="calibre_10">style guide for Python (see PEP 8 style guide)</li><li value="60" class="calibre_10">style property (DataFrames), <a href="index_split_022.html#filepos1221911"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="61" class="calibre_10">styleframe, <a href="index_split_022.html#filepos1231558"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="62" class="calibre_10">sub decorator (xlwings), <a href="index_split_028.html#filepos1795393"><span class="calibre_7">The Sub Decorator</span></a>-<a href="index_split_028.html#filepos1804381"><span class="calibre_7">The Sub Decorator</span></a></li><li value="63" class="calibre_10">Sublime Text, <a href="index_split_009.html#filepos173298"><span class="calibre_7">Running a Python Script</span></a></li><li value="64" class="calibre_10">sum universal function (NumPy), <a href="index_split_014.html#filepos460116"><span class="calibre_7">Universal Functions (ufunc)</span></a></li><li value="65" class="calibre_10">switching reader/writer packages, <a href="index_split_021.html#filepos973335"><span class="calibre_7">The excel.py Module</span></a></li><li value="66" class="calibre_10">syntax highlighting, <a href="index_split_009.html#filepos136864"><span class="calibre_7">Notebook Cells</span></a>, <a href="index_split_009.html#filepos155225"><span class="calibre_7">Visual Studio Code</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">T</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">table joins, <a href="index_split_027.html#filepos1517665"><span class="calibre_7">Databases</span></a></li><li value="2" class="calibre_10">tables in Python Package Tracker, <a href="index_split_027.html#filepos1613315"><span class="calibre_7">Frontend</span></a></li><li value="3" class="calibre_10">tail method (pandas), <a href="index_split_016.html#filepos750501"><span class="calibre_7">Importing CSV Files</span></a></li><li value="4" class="calibre_10">temperature.py example, <a href="index_split_012.html#filepos377100"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="5" class="calibre_10">Terminal (macOS), <a href="index_split_008.html#filepos102144"><span class="calibre_7">Anaconda Prompt</span></a>-<a href="index_split_008.html#filepos104346"><span class="calibre_7">Anaconda Prompt</span></a><ul class="calibre_135"><li value="1" class="calibre_13">disabling auto activation of Conda environment, <a href="index_split_029.html#filepos1819954"><span class="calibre_7">Disable Auto Activation</span></a></li></ul></li><li value="6" class="calibre_10">ternary operators, <a href="index_split_012.html#filepos314525"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="7" class="calibre_10">testing, <a href="index_split_007.html#filepos48860"><span class="calibre_7">Testing</span></a></li><li value="8" class="calibre_10">text columns in DataFrames, <a href="index_split_015.html#filepos634000"><span class="calibre_7">Working with Text Columns</span></a></li><li value="9" class="calibre_10">text editors<ul class="calibre_135"><li value="1" class="calibre_13">list of, <a href="index_split_009.html#filepos172984"><span class="calibre_7">Running a Python Script</span></a></li><li value="2" class="calibre_10">VS Code (see VS Code)</li></ul></li><li value="10" class="calibre_10">text function (SQLAlchemy), <a href="index_split_027.html#filepos1579180"><span class="calibre_7">SQL injection</span></a></li><li value="11" class="calibre_10">%%time cell magic, <a href="index_split_022.html#filepos1147874"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="12" class="calibre_10">time series analysis<ul class="calibre_135"><li value="1" class="calibre_13">correlation, <a href="index_split_017.html#filepos822133"><span class="calibre_7">Rebasing and Correlation</span></a>-<a href="index_split_017.html#filepos846848"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="2" class="calibre_10">DatetimeIndex (pandas)<ul class="calibre_136"><li value="1" class="calibre_13">creating, <a href="index_split_017.html#filepos770795"><span class="calibre_7">Creating a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos794737"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="2" class="calibre_10">filtering, <a href="index_split_017.html#filepos794993"><span class="calibre_7">Filtering a DatetimeIndex</span></a>-<a href="index_split_017.html#filepos798956"><span class="calibre_7">Filtering a DatetimeIndex</span></a></li><li value="3" class="calibre_10">time zones in, <a href="index_split_017.html#filepos799257"><span class="calibre_7">Working with Time Zones</span></a>-<a href="index_split_017.html#filepos808759"><span class="calibre_7">Working with Time Zones</span></a></li></ul></li><li value="3" class="calibre_10">Excel limitations, <a href="index_split_017.html#filepos768348"><span class="calibre_7">Time Series Analysis with pandas</span></a></li><li value="4" class="calibre_10">percentage change, <a href="index_split_017.html#filepos809588"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos821793"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="5" class="calibre_10">rebasing, <a href="index_split_017.html#filepos822133"><span class="calibre_7">Rebasing and Correlation</span></a>-<a href="index_split_017.html#filepos846848"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="6" class="calibre_10">resampling, <a href="index_split_017.html#filepos847003"><span class="calibre_7">Resampling</span></a>-<a href="index_split_017.html#filepos854741"><span class="calibre_7">Resampling</span></a></li><li value="7" class="calibre_10">rolling windows, <a href="index_split_017.html#filepos855004"><span class="calibre_7">Rolling Windows</span></a></li><li value="8" class="calibre_10">shifting, <a href="index_split_017.html#filepos809588"><span class="calibre_7">Shifting and Percentage Changes</span></a>-<a href="index_split_017.html#filepos821793"><span class="calibre_7">Shifting and Percentage Changes</span></a></li></ul></li><li value="13" class="calibre_10">time series, purpose of, <a href="index_split_017.html#filepos767771"><span class="calibre_7">Time Series Analysis with pandas</span></a></li><li value="14" class="calibre_10">time zones<ul class="calibre_135"><li value="1" class="calibre_13">in DatetimeIndex (pandas), <a href="index_split_017.html#filepos799257"><span class="calibre_7">Working with Time Zones</span></a>-<a href="index_split_017.html#filepos808759"><span class="calibre_7">Working with Time Zones</span></a></li><li value="2" class="calibre_10">in Python, <a href="index_split_031.html#filepos1848019"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a>-<a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li></ul></li><li value="15" class="calibre_10">%%timeit cell magic, <a href="index_split_022.html#filepos1148960"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="16" class="calibre_10">timezone module, <a href="index_split_031.html#filepos1862968"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="17" class="calibre_10">titles, adding to DataFrames, <a href="index_split_022.html#filepos1162787"><span class="calibre_7">Formatting DataFrames in Excel</span></a></li><li value="18" class="calibre_10">to_datetime function (pandas), <a href="index_split_017.html#filepos783272"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="19" class="calibre_10">to_excel method (pandas), <a href="index_split_019.html#filepos935768"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a>-<a href="index_split_019.html#filepos953568"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a>, <a href="index_split_021.html#filepos971083"><span class="calibre_7">When to Use Which Package</span></a></li><li value="20" class="calibre_10">transposing DataFrames, <a href="index_split_015.html#filepos520188"><span class="calibre_7">Columns</span></a></li><li value="21" class="calibre_10">True boolean data type, <a href="index_split_011.html#filepos205063"><span class="calibre_7">Booleans</span></a>-<a href="index_split_011.html#filepos217752"><span class="calibre_7">Booleans</span></a></li><li value="22" class="calibre_10">try/except statements, <a href="index_split_027.html#filepos1580257"><span class="calibre_7">Exceptions</span></a>-<a href="index_split_027.html#filepos1601081"><span class="calibre_7">Exceptions</span></a></li><li value="23" class="calibre_10">tuple constructor, <a href="index_split_011.html#filepos302517"><span class="calibre_7">Sets</span></a></li><li value="24" class="calibre_10">tuples, <a href="index_split_011.html#filepos285858"><span class="calibre_7">Tuples</span></a></li><li value="25" class="calibre_10">two-dimensional NumPy arrays, <a href="index_split_014.html#filepos439635"><span class="calibre_7">NumPy Array</span></a></li><li value="26" class="calibre_10">type annotations, <a href="index_split_012.html#filepos427923"><span class="calibre_7">Type Hints</span></a></li><li value="27" class="calibre_10">type hints, <a href="index_split_012.html#filepos427923"><span class="calibre_7">Type Hints</span></a></li><li value="28" class="calibre_10">tz_convert method (pandas), <a href="index_split_017.html#filepos805006"><span class="calibre_7">Working with Time Zones</span></a></li><li value="29" class="calibre_10">tz_localize method (pandas), <a href="index_split_017.html#filepos799539"><span class="calibre_7">Working with Time Zones</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">U</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">UDFs (user-defined functions)<ul class="calibre_135"><li value="1" class="calibre_13">debugging, <a href="index_split_028.html#filepos1755260"><span class="calibre_7">Debugging UDFs</span></a>-<a href="index_split_028.html#filepos1760605"><span class="calibre_7">Debugging UDFs</span></a></li><li value="2" class="calibre_10">Google Trends case study<ul class="calibre_136"><li value="1" class="calibre_13">DataFrames and dynamic arrays, <a href="index_split_028.html#filepos1682486"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a>-<a href="index_split_028.html#filepos1714516"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="2" class="calibre_10">explanation of Google Trends, <a href="index_split_028.html#filepos1680082"><span class="calibre_7">Introduction to Google Trends</span></a>-<a href="index_split_028.html#filepos1682295"><span class="calibre_7">Introduction to Google Trends</span></a></li><li value="3" class="calibre_10">fetching data, <a href="index_split_028.html#filepos1714798"><span class="calibre_7">Fetching Data from Google Trends</span></a>-<a href="index_split_028.html#filepos1741590"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="4" class="calibre_10">plotting data, <a href="index_split_028.html#filepos1741829"><span class="calibre_7">Plotting with UDFs</span></a>-<a href="index_split_028.html#filepos1754939"><span class="calibre_7">Plotting with UDFs</span></a></li></ul></li><li value="3" class="calibre_10">importing, <a href="index_split_028.html#filepos1657477"><span class="calibre_7">UDF Quickstart</span></a>-<a href="index_split_028.html#filepos1679023"><span class="calibre_7">UDF Quickstart</span></a></li><li value="4" class="calibre_10">performance optimization of<ul class="calibre_136"><li value="1" class="calibre_13">caching, <a href="index_split_028.html#filepos1775539"><span class="calibre_7">Caching</span></a>-<a href="index_split_028.html#filepos1794980"><span class="calibre_7">Caching</span></a></li><li value="2" class="calibre_10">minimizing cross-application calls (xlwings), <a href="index_split_028.html#filepos1762196"><span class="calibre_7">Minimize cross-application calls</span></a>-<a href="index_split_028.html#filepos1770595"><span class="calibre_7">Minimize cross-application calls</span></a></li><li value="3" class="calibre_10">raw values, <a href="index_split_028.html#filepos1770837"><span class="calibre_7">Using raw values</span></a></li></ul></li><li value="5" class="calibre_10">requirements for, <a href="index_split_028.html#filepos1655193"><span class="calibre_7">Getting Started with UDFs</span></a></li><li value="6" class="calibre_10">sub decorator, <a href="index_split_028.html#filepos1795393"><span class="calibre_7">The Sub Decorator</span></a>-<a href="index_split_028.html#filepos1804381"><span class="calibre_7">The Sub Decorator</span></a></li></ul></li><li value="2" class="calibre_10">ufuncs (universal functions in NumPy), <a href="index_split_014.html#filepos454337"><span class="calibre_7">Universal Functions (ufunc)</span></a>-<a href="index_split_014.html#filepos462582"><span class="calibre_7">Universal Functions (ufunc)</span></a></li><li value="3" class="calibre_10">UIs (see frontends)</li><li value="4" class="calibre_10">UNIQUE function (Excel), <a href="index_split_028.html#filepos1712408"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="5" class="calibre_10">unit tests, <a href="index_split_007.html#filepos48860"><span class="calibre_7">Testing</span></a></li><li value="6" class="calibre_10">universal functions (NumPy), <a href="index_split_014.html#filepos454337"><span class="calibre_7">Universal Functions (ufunc)</span></a>-<a href="index_split_014.html#filepos462582"><span class="calibre_7">Universal Functions (ufunc)</span></a></li><li value="7" class="calibre_10">unpacking dictionaries, <a href="index_split_011.html#filepos275528"><span class="calibre_7">Dictionaries</span></a></li><li value="8" class="calibre_10">update method (xlwings), <a href="index_split_025.html#filepos1385886"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="9" class="calibre_10">updating xlwings, <a href="index_split_026.html#filepos1443233"><span class="calibre_7">Excel Add-in</span></a></li><li value="10" class="calibre_10">uppercase, transforming to/from lowercase, <a href="index_split_011.html#filepos224113"><span class="calibre_7">Strings</span></a></li><li value="11" class="calibre_10">upsampling, <a href="index_split_017.html#filepos847090"><span class="calibre_7">Resampling</span></a></li><li value="12" class="calibre_10">URLs, reading files from, <a href="index_split_019.html#filepos922687"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="13" class="calibre_10">used range, <a href="index_split_021.html#filepos1099306"><span class="calibre_7">Reading with xlrd</span></a></li><li value="14" class="calibre_10">user interfaces (see frontends)</li><li value="15" class="calibre_10">user-defined functions (see UDFs)</li><li value="16" class="calibre_10">UTC (Coordinated Universal Time), <a href="index_split_017.html#filepos805006"><span class="calibre_7">Working with Time Zones</span></a>, <a href="index_split_031.html#filepos1848164"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">V</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">Vaex, <a href="index_split_017.html#filepos861209"><span class="calibre_7">Limitations with pandas</span></a></li><li value="2" class="calibre_10">validating data in Python Package Tracker, <a href="index_split_027.html#filepos1614044"><span class="calibre_7">Frontend</span></a></li><li value="3" class="calibre_10">values (pandas), setting data by replacing, <a href="index_split_015.html#filepos589332"><span class="calibre_7">Setting data by replacing values</span></a></li><li value="4" class="calibre_10">Variable explorer (Jupyter notebooks), <a href="index_split_030.html#filepos1827392"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="5" class="calibre_10">variables, <a href="index_split_010.html#filepos181374"><span class="calibre_7">Variables</span></a></li><li value="6" class="calibre_10">VBA (Visual Basic for Applications), <a href="index_split_003.html#filepos9501"><span class="calibre_7">Preface</span></a><ul class="calibre_135"><li value="1" class="calibre_13">add-ins, <a href="index_split_007.html#filepos47157"><span class="calibre_7">DRY principle</span></a></li><li value="2" class="calibre_10">ByRef and ByVal function arguments, <a href="index_split_031.html#filepos1882872"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a>-<a href="index_split_031.html#filepos1887586"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a></li><li value="3" class="calibre_10">Case statement, <a href="index_split_011.html#filepos282660"><span class="calibre_7">Dictionaries</span></a></li><li value="4" class="calibre_10">code blocks, <a href="index_split_011.html#filepos305198"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="5" class="calibre_10">counter variables in loops, <a href="index_split_012.html#filepos340077"><span class="calibre_7">The for and while Loops</span></a></li><li value="6" class="calibre_10">data structures, <a href="index_split_011.html#filepos242442"><span class="calibre_7">Data Structures</span></a></li><li value="7" class="calibre_10">For Each statement, <a href="index_split_012.html#filepos319389"><span class="calibre_7">The for and while Loops</span></a></li><li value="8" class="calibre_10">functions, <a href="index_split_007.html#filepos46886"><span class="calibre_7">DRY principle</span></a>, <a href="index_split_025.html#filepos1322194"><span class="calibre_7">Running VBA Code</span></a></li><li value="9" class="calibre_10">indexing, <a href="index_split_011.html#filepos228929"><span class="calibre_7">Indexing</span></a></li><li value="10" class="calibre_10">modern language features, <a href="index_split_007.html#filepos80870"><span class="calibre_7">Modern Language Features</span></a>-<a href="index_split_007.html#filepos89951"><span class="calibre_7">Modern Language Features</span></a></li><li value="11" class="calibre_10">readability, <a href="index_split_007.html#filepos64905"><span class="calibre_7">Readability and Maintainability</span></a></li><li value="12" class="calibre_10">running in xlwings, <a href="index_split_024.html#filepos1313318"><span class="calibre_7">Running VBA Code</span></a>-<a href="index_split_025.html#filepos1322929"><span class="calibre_7">Running VBA Code</span></a></li><li value="13" class="calibre_10">RunPython function, <a href="index_split_026.html#filepos1459375"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1471460"><span class="calibre_7">RunPython without quickstart command</span></a>, <a href="index_split_026.html#filepos1484138"><span class="calibre_7">Settings</span></a></li><li value="14" class="calibre_10">Trust access to VBA project model setting, <a href="index_split_028.html#filepos1656916"><span class="calibre_7">Getting Started with UDFs</span></a></li><li value="15" class="calibre_10">variables, <a href="index_split_010.html#filepos183010"><span class="calibre_7">Variables</span></a></li><li value="16" class="calibre_10">With statement, <a href="index_split_019.html#filepos910651"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="17" class="calibre_10">wrapper functions, <a href="index_split_028.html#filepos1670563"><span class="calibre_7">UDF Quickstart</span></a></li><li value="18" class="calibre_10">xlwings range object versus, <a href="index_split_024.html#filepos1265312"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1293849"><span class="calibre_7">The Excel Object Model</span></a></li></ul></li><li value="7" class="calibre_10">VCS (version control system), <a href="index_split_007.html#filepos51880"><span class="calibre_7">Version control</span></a></li><li value="8" class="calibre_10">vectorization, <a href="index_split_014.html#filepos448254"><span class="calibre_7">Vectorization and Broadcasting</span></a>-<a href="index_split_014.html#filepos453983"><span class="calibre_7">Vectorization and Broadcasting</span></a>, <a href="index_split_015.html#filepos483705"><span class="calibre_7">Data Analysis with pandas</span></a>, <a href="index_split_015.html#filepos617425"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="9" class="calibre_10">version control, <a href="index_split_007.html#filepos51713"><span class="calibre_7">Version control</span></a>-<a href="index_split_007.html#filepos57576"><span class="calibre_7">Version control</span></a>, <a href="index_split_009.html#filepos156579"><span class="calibre_7">Visual Studio Code</span></a></li><li value="10" class="calibre_10">versions<ul class="calibre_135"><li value="1" class="calibre_13">of packages, <a href="index_split_008.html#filepos126480"><span class="calibre_7">Package Managers: Conda and pip</span></a>-<a href="index_split_008.html#filepos127438"><span class="calibre_7">Conda Environments</span></a></li><li value="2" class="calibre_10">of Windows, determining, <a href="index_split_008.html#filepos100180"><span class="calibre_7">Installation</span></a></li></ul></li><li value="11" class="calibre_10">view function (xlwings), <a href="index_split_024.html#filepos1239513"><span class="calibre_7">Using Excel as Data Viewer</span></a>-<a href="index_split_024.html#filepos1248699"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="12" class="calibre_10">viewing<ul class="calibre_135"><li value="1" class="calibre_13">current directory in macOS, <a href="index_split_008.html#filepos105254"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="2" class="calibre_10">file extensions, <a href="index_split_008.html#filepos113417"><span class="calibre_7">Anaconda Prompt</span></a>-<a href="index_split_008.html#filepos114549"><span class="calibre_7">Anaconda Prompt</span></a></li></ul></li><li value="13" class="calibre_10">views, copies versus, <a href="index_split_014.html#filepos475259"><span class="calibre_7">View vs. Copy</span></a>-<a href="index_split_014.html#filepos480562"><span class="calibre_7">View vs. Copy</span></a>, <a href="index_split_015.html#filepos649623"><span class="calibre_7">View vs. Copy</span></a></li><li value="14" class="calibre_10">Vim, <a href="index_split_009.html#filepos174170"><span class="calibre_7">Running a Python Script</span></a></li><li value="15" class="calibre_10">virtual environments, <a href="index_split_008.html#filepos128407"><span class="calibre_7">Conda Environments</span></a></li><li value="16" class="calibre_10">VisiCalc, <a href="index_split_007.html#filepos33925"><span class="calibre_7">Why Python for Excel?</span></a></li><li value="17" class="calibre_10">Visual Basic for Applications (see VBA)</li><li value="18" class="calibre_10">Visual Studio, <a href="index_split_009.html#filepos159079"><span class="calibre_7">Visual Studio Code</span></a></li><li value="19" class="calibre_10">volatile functions (Excel), <a href="index_split_028.html#filepos1673786"><span class="calibre_7">UDF Quickstart</span></a></li><li value="20" class="calibre_10">VS Code (Visual Studio Code)<ul class="calibre_135"><li value="1" class="calibre_13">advantages, <a href="index_split_009.html#filepos153777"><span class="calibre_7">Visual Studio Code</span></a>-<a href="index_split_009.html#filepos159324"><span class="calibre_7">Visual Studio Code</span></a></li><li value="2" class="calibre_10">comments, <a href="index_split_011.html#filepos204466"><span class="calibre_7">Mathematical operators</span></a></li><li value="3" class="calibre_10">components of, <a href="index_split_008.html#filepos98339"><span class="calibre_7">Development Environment</span></a></li><li value="4" class="calibre_10">configuring, <a href="index_split_009.html#filepos160636"><span class="calibre_7">Installation and Configuration</span></a>-<a href="index_split_009.html#filepos164899"><span class="calibre_7">Installation and Configuration</span></a></li><li value="5" class="calibre_10">debugging with, <a href="index_split_027.html#filepos1648684"><span class="calibre_7">Debugging</span></a>, <a href="index_split_028.html#filepos1758990"><span class="calibre_7">Debugging UDFs</span></a>, <a href="index_split_030.html#filepos1821433"><span class="calibre_7">Debugger</span></a>-<a href="index_split_030.html#filepos1825904"><span class="calibre_7">Debugger</span></a></li><li value="6" class="calibre_10">installing, <a href="index_split_009.html#filepos159642"><span class="calibre_7">Installation and Configuration</span></a></li><li value="7" class="calibre_10">Jupyter notebooks<ul class="calibre_136"><li value="1" class="calibre_13">running, <a href="index_split_030.html#filepos1826689"><span class="calibre_7">Run Jupyter Notebooks</span></a>-<a href="index_split_030.html#filepos1829065"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="2" class="calibre_10">saving, <a href="index_split_030.html#filepos1828008"><span class="calibre_7">Run Jupyter Notebooks</span></a></li></ul></li><li value="8" class="calibre_10">linting, <a href="index_split_012.html#filepos426221"><span class="calibre_7">PEP 8 and VS Code</span></a></li><li value="9" class="calibre_10">purpose of, <a href="index_split_008.html#filepos98029"><span class="calibre_7">Development Environment</span></a></li><li value="10" class="calibre_10">Python scripts, running, <a href="index_split_009.html#filepos165121"><span class="calibre_7">Running a Python Script</span></a>-<a href="index_split_009.html#filepos172327"><span class="calibre_7">Running a Python Script</span></a></li><li value="11" class="calibre_10">Run File button, <a href="index_split_009.html#filepos171481"><span class="calibre_7">Running a Python Script</span></a></li><li value="12" class="calibre_10">running in Anaconda Prompt, <a href="index_split_009.html#filepos165226"><span class="calibre_7">Running a Python Script</span></a></li><li value="13" class="calibre_10">single-clicking in, <a href="index_split_009.html#filepos172252"><span class="calibre_7">Running a Python Script</span></a></li><li value="14" class="calibre_10">SQLite extension, <a href="index_split_027.html#filepos1529158"><span class="calibre_7">The Package Tracker database</span></a></li><li value="15" class="calibre_10">Visual Studio versus, <a href="index_split_009.html#filepos159079"><span class="calibre_7">Visual Studio Code</span></a></li></ul></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">W</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">wall time, <a href="index_split_022.html#filepos1148285"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="2" class="calibre_10">web APIs, <a href="index_split_027.html#filepos1492808"><span class="calibre_7">Web APIs</span></a>-<a href="index_split_027.html#filepos1515072"><span class="calibre_7">Web APIs</span></a></li><li value="3" class="calibre_10">while loops, <a href="index_split_012.html#filepos343907"><span class="calibre_7">The for and while Loops</span></a></li><li value="4" class="calibre_10">white space, <a href="index_split_011.html#filepos304028"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="5" class="calibre_10">Windows<ul class="calibre_135"><li value="1" class="calibre_13">ActiveX controls, <a href="index_split_026.html#filepos1464639"><span class="calibre_7">RunPython Function</span></a></li><li value="2" class="calibre_10">Anaconda Prompt, running, <a href="index_split_008.html#filepos103402"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="3" class="calibre_10">Command Prompt, <a href="index_split_008.html#filepos102144"><span class="calibre_7">Anaconda Prompt</span></a><ul class="calibre_136"><li value="1" class="calibre_13">disabling auto activation of Conda environment, <a href="index_split_029.html#filepos1818813"><span class="calibre_7">Disable Auto Activation</span></a></li></ul></li><li value="4" class="calibre_10">current directory, listing files in, <a href="index_split_008.html#filepos110263"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="5" class="calibre_10">extracting macro code (Xlsxwriter), <a href="index_split_021.html#filepos1064950"><span class="calibre_7">XlsxWriter</span></a></li><li value="6" class="calibre_10">file extensions, viewing, <a href="index_split_008.html#filepos114224"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="7" class="calibre_10">file paths as raw strings, <a href="index_split_016.html#filepos747454"><span class="calibre_7">Exporting CSV Files</span></a></li><li value="8" class="calibre_10">Form Controls (Excel), <a href="index_split_026.html#filepos1464639"><span class="calibre_7">RunPython Function</span></a></li><li value="9" class="calibre_10">frozen executables, <a href="index_split_026.html#filepos1475043"><span class="calibre_7">Python Dependency</span></a></li><li value="10" class="calibre_10">list separators (Excel), changing, <a href="index_split_024.html#filepos1254821"><span class="calibre_7">The Excel Object Model</span></a></li><li value="11" class="calibre_10">Show Console checkbox (xlwings add-in), <a href="index_split_027.html#filepos1650611"><span class="calibre_7">Debugging</span></a></li><li value="12" class="calibre_10">Use UDF Server, <a href="index_split_026.html#filepos1484138"><span class="calibre_7">Settings</span></a></li><li value="13" class="calibre_10">user-defined functions (see UDFs)</li><li value="14" class="calibre_10">VS Code<ul class="calibre_136"><li value="1" class="calibre_13">configuring, <a href="index_split_009.html#filepos164382"><span class="calibre_7">Installation and Configuration</span></a></li><li value="2" class="calibre_10">installing, <a href="index_split_009.html#filepos160121"><span class="calibre_7">Installation and Configuration</span></a></li></ul></li><li value="15" class="calibre_10">xlwings dependencies, <a href="index_split_025.html#filepos1411455"><span class="calibre_7">xlwings Foundations</span></a></li><li value="16" class="calibre_10">zombie processes, <a href="index_split_025.html#filepos1412114"><span class="calibre_7">xlwings Foundations</span></a></li></ul></li><li value="6" class="calibre_10">Wing Python IDE, <a href="index_split_009.html#filepos175986"><span class="calibre_7">Running a Python Script</span></a></li><li value="7" class="calibre_10">WinPython, <a href="index_split_026.html#filepos1473728"><span class="calibre_7">Python Dependency</span></a></li><li value="8" class="calibre_10">with statement, <a href="index_split_019.html#filepos910651"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="9" class="calibre_10">wrapper VBA functions, <a href="index_split_028.html#filepos1670563"><span class="calibre_7">UDF Quickstart</span></a></li><li value="10" class="calibre_10">write function (excel.py), <a href="index_split_021.html#filepos977466"><span class="calibre_7">The excel.py Module</span></a></li><li value="11" class="calibre_10">writer packages (see reader/writer packages)</li><li value="12" class="calibre_10">writing<ul class="calibre_135"><li value="1" class="calibre_13">DataFrames to Excel with xlwings, <a href="index_split_025.html#filepos1324128"><span class="calibre_7">Working with DataFrames</span></a>-<a href="index_split_025.html#filepos1340369"><span class="calibre_7">Working with DataFrames</span></a></li><li value="2" class="calibre_10">files (Excel)<ul class="calibre_136"><li value="1" class="calibre_13">limitations in pandas, <a href="index_split_019.html#filepos957495"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></a></li><li value="2" class="calibre_10">with OpenPyXL, <a href="index_split_021.html#filepos996317"><span class="calibre_7">Writing with OpenPyXL</span></a>-<a href="index_split_021.html#filepos1032891"><span class="calibre_7">Writing with OpenPyXL</span></a>, <a href="index_split_022.html#filepos1126036"><span class="calibre_7">Writing with OpenPyXL</span></a></li><li value="3" class="calibre_10">with pandas, <a href="index_split_019.html#filepos935768"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a>-<a href="index_split_019.html#filepos953568"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a></li><li value="4" class="calibre_10">programming Excel versus, <a href="index_split_005.html#filepos18185"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="5" class="calibre_10">with XlsxWriter, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a>, <a href="index_split_022.html#filepos1130359"><span class="calibre_7">Writing with XlsxWriter</span></a></li><li value="6" class="calibre_10">with xlwt, <a href="index_split_022.html#filepos1099995"><span class="calibre_7">Writing with xlwt</span></a>-<a href="index_split_022.html#filepos1119593"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li></ul></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">X</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">xlrd<ul class="calibre_135"><li value="1" class="calibre_13">parallelization, <a href="index_split_022.html#filepos1153795"><span class="calibre_7">Reading sheets in parallel</span></a></li><li value="2" class="calibre_10">reading files, <a href="index_split_021.html#filepos1085917"><span class="calibre_7">Reading with xlrd</span></a>-<a href="index_split_021.html#filepos1099832"><span class="calibre_7">Reading with xlrd</span></a>, <a href="index_split_022.html#filepos1134915"><span class="calibre_7">Reading with xlrd</span></a></li><li value="3" class="calibre_10">when to use, <a href="index_split_020.html#filepos964224"><span class="calibre_7">When to Use Which Package</span></a></li></ul></li><li value="2" class="calibre_10">xls files, reading/writing/editing, <a href="index_split_021.html#filepos1085017"><span class="calibre_7">xlrd, xlwt, and xlutils</span></a></li><li value="3" class="calibre_10">xlsb files, reading, <a href="index_split_019.html#filepos925712"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a>, <a href="index_split_021.html#filepos1071930"><span class="calibre_7">pyxlsb</span></a>-<a href="index_split_021.html#filepos1083611"><span class="calibre_7">pyxlsb</span></a></li><li value="4" class="calibre_10">xlsm files<ul class="calibre_135"><li value="1" class="calibre_13">enabling macros, <a href="index_split_026.html#filepos1459885"><span class="calibre_7">RunPython Function</span></a></li><li value="2" class="calibre_10">extracting macro code (Xlsxwriter), <a href="index_split_021.html#filepos1064438"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066693"><span class="calibre_7">XlsxWriter</span></a></li></ul></li><li value="5" class="calibre_10">XlsxWriter<ul class="calibre_135"><li value="1" class="calibre_13">formatting DataFrames<ul class="calibre_136"><li value="1" class="calibre_13">data parts, <a href="index_split_022.html#filepos1215478"><span class="calibre_7">Formatting a DataFrame’s data part</span></a></li><li value="2" class="calibre_10">indices and headers, <a href="index_split_022.html#filepos1190749"><span class="calibre_7">Formatting a DataFrame’s index and headers</span></a></li></ul></li><li value="2" class="calibre_10">OpenPyXL versus, <a href="index_split_020.html#filepos968476"><span class="calibre_7">When to Use Which Package</span></a></li><li value="3" class="calibre_10">when to use, <a href="index_split_020.html#filepos964224"><span class="calibre_7">When to Use Which Package</span></a></li><li value="4" class="calibre_10">writing files, <a href="index_split_021.html#filepos1039708"><span class="calibre_7">XlsxWriter</span></a>-<a href="index_split_021.html#filepos1066941"><span class="calibre_7">XlsxWriter</span></a>, <a href="index_split_022.html#filepos1130359"><span class="calibre_7">Writing with XlsxWriter</span></a></li></ul></li><li value="6" class="calibre_10">xltrail, <a href="index_split_007.html#filepos56694"><span class="calibre_7">Version control</span></a></li><li value="7" class="calibre_10">xlutils<ul class="calibre_135"><li value="1" class="calibre_13">editing files, <a href="index_split_022.html#filepos1119688"><span class="calibre_7">Editing with xlutils</span></a></li><li value="2" class="calibre_10">installing, <a href="index_split_008.html#filepos125084"><span class="calibre_7">Package Managers: Conda and pip</span></a>, <a href="index_split_021.html#filepos1085435"><span class="calibre_7">xlrd, xlwt, and xlutils</span></a></li><li value="3" class="calibre_10">when to use, <a href="index_split_020.html#filepos964224"><span class="calibre_7">When to Use Which Package</span></a></li></ul></li><li value="8" class="calibre_10">xlwings<ul class="calibre_135"><li value="1" class="calibre_13">charts (Excel), creating, <a href="index_split_025.html#filepos1368049"><span class="calibre_7">Excel charts</span></a>-<a href="index_split_025.html#filepos1374395"><span class="calibre_7">Excel charts</span></a></li><li value="2" class="calibre_10">converters, <a href="index_split_025.html#filepos1340690"><span class="calibre_7">Converters and Options</span></a></li><li value="3" class="calibre_10">DataFrames, reading/writing in Excel, <a href="index_split_025.html#filepos1324128"><span class="calibre_7">Working with DataFrames</span></a>-<a href="index_split_025.html#filepos1340369"><span class="calibre_7">Working with DataFrames</span></a></li><li value="4" class="calibre_10">defined names (Excel), creating, <a href="index_split_025.html#filepos1390078"><span class="calibre_7">Defined names</span></a>-<a href="index_split_025.html#filepos1400526"><span class="calibre_7">Defined names</span></a></li><li value="5" class="calibre_10">dependencies, <a href="index_split_025.html#filepos1410868"><span class="calibre_7">xlwings Foundations</span></a></li><li value="6" class="calibre_10">deployment<ul class="calibre_136"><li value="1" class="calibre_13">configuration hierarchy, <a href="index_split_026.html#filepos1478189"><span class="calibre_7">Configuration Hierarchy</span></a></li><li value="2" class="calibre_10">Python dependencies, <a href="index_split_026.html#filepos1472746"><span class="calibre_7">Python Dependency</span></a>-<a href="index_split_026.html#filepos1475110"><span class="calibre_7">Python Dependency</span></a></li><li value="3" class="calibre_10">settings, <a href="index_split_026.html#filepos1480593"><span class="calibre_7">Settings</span></a>-<a href="index_split_026.html#filepos1484138"><span class="calibre_7">Settings</span></a></li><li value="4" class="calibre_10">standalone workbooks, <a href="index_split_026.html#filepos1475399"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a>-<a href="index_split_026.html#filepos1477920"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a></li></ul></li><li value="7" class="calibre_10">Excel as data viewer, <a href="index_split_024.html#filepos1239513"><span class="calibre_7">Using Excel as Data Viewer</span></a>-<a href="index_split_024.html#filepos1248699"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="8" class="calibre_10">Excel as frontend<ul class="calibre_136"><li value="1" class="calibre_13">installing xlwings add-in, <a href="index_split_026.html#filepos1442113"><span class="calibre_7">Excel Add-in</span></a>-<a href="index_split_026.html#filepos1447961"><span class="calibre_7">Excel Add-in</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_026.html#filepos1440971"><span class="calibre_7">Using Excel as Frontend with xlwings</span></a></li><li value="3" class="calibre_10">quickstart command, <a href="index_split_026.html#filepos1448302"><span class="calibre_7">Quickstart Command</span></a></li><li value="4" class="calibre_10">Run main button, <a href="index_split_026.html#filepos1449910"><span class="calibre_7">Run Main</span></a>-<a href="index_split_026.html#filepos1458891"><span class="calibre_7">Run Main</span></a></li><li value="5" class="calibre_10">RunPython function, <a href="index_split_026.html#filepos1459375"><span class="calibre_7">RunPython Function</span></a>-<a href="index_split_026.html#filepos1471460"><span class="calibre_7">RunPython without quickstart command</span></a></li></ul></li><li value="9" class="calibre_10">Excel dependency, <a href="index_split_021.html#filepos969891"><span class="calibre_7">When to Use Which Package</span></a></li><li value="10" class="calibre_10">Excel object model and, <a href="index_split_024.html#filepos1250235"><span class="calibre_7">The Excel Object Model</span></a>-<a href="index_split_024.html#filepos1313152"><span class="calibre_7">The Excel Object Model</span></a></li><li value="11" class="calibre_10">macOS permissions, <a href="index_split_024.html#filepos1249144"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="12" class="calibre_10">missing functionality workarounds, <a href="index_split_025.html#filepos1429624"><span class="calibre_7">How to Work Around Missing Functionality</span></a>-<a href="index_split_025.html#filepos1435920"><span class="calibre_7">How to Work Around Missing Functionality</span></a></li><li value="13" class="calibre_10">performance optimization, <a href="index_split_025.html#filepos1416353"><span class="calibre_7">Improving Performance</span></a>-<a href="index_split_025.html#filepos1429357"><span class="calibre_7">App properties</span></a></li><li value="14" class="calibre_10">pictures (Excel), Matplotlib plots as, <a href="index_split_025.html#filepos1374823"><span class="calibre_7">Pictures: Matplotlib plots</span></a>-<a href="index_split_025.html#filepos1389691"><span class="calibre_7">Pictures: Matplotlib plots</span></a></li><li value="15" class="calibre_10">purpose of, <a href="index_split_024.html#filepos1236537"><span class="calibre_7">Excel Automation</span></a>-<a href="index_split_024.html#filepos1238572"><span class="calibre_7">Getting Started with xlwings</span></a></li><li value="16" class="calibre_10">Python Package Tracker (see Python Package Tracker)</li><li value="17" class="calibre_10">range object options, <a href="index_split_025.html#filepos1345103"><span class="calibre_7">Converters and Options</span></a>-<a href="index_split_025.html#filepos1366895"><span class="calibre_7">Converters and Options</span></a></li><li value="18" class="calibre_10">Show Console checkbox, <a href="index_split_027.html#filepos1650611"><span class="calibre_7">Debugging</span></a></li><li value="19" class="calibre_10">updating, <a href="index_split_026.html#filepos1443233"><span class="calibre_7">Excel Add-in</span></a></li><li value="20" class="calibre_10">user-defined functions (see UDFs)</li><li value="21" class="calibre_10">VBA code, running, <a href="index_split_024.html#filepos1313318"><span class="calibre_7">Running VBA Code</span></a>-<a href="index_split_025.html#filepos1322929"><span class="calibre_7">Running VBA Code</span></a></li></ul></li><li value="9" class="calibre_10">xlwings CLI<ul class="calibre_135"><li value="1" class="calibre_13">addin install command, <a href="index_split_026.html#filepos1442590"><span class="calibre_7">Excel Add-in</span></a></li><li value="2" class="calibre_10">purpose of, <a href="index_split_026.html#filepos1444887"><span class="calibre_7">Excel Add-in</span></a></li><li value="3" class="calibre_10">quickstart command, <a href="index_split_026.html#filepos1448302"><span class="calibre_7">Quickstart Command</span></a></li></ul></li><li value="10" class="calibre_10">xlwings PRO, <a href="index_split_026.html#filepos1484297"><span class="calibre_7">Settings</span></a></li><li value="11" class="calibre_10">xlwt<ul class="calibre_135"><li value="1" class="calibre_13">when to use, <a href="index_split_020.html#filepos964224"><span class="calibre_7">When to Use Which Package</span></a></li><li value="2" class="calibre_10">writing files, <a href="index_split_022.html#filepos1099995"><span class="calibre_7">Writing with xlwt</span></a>-<a href="index_split_022.html#filepos1119593"><span class="calibre_7">Editing with xlutils</span></a></li></ul></li></ul><blockquote class="calibre_133"><span class="bold"><span class="calibre_134">Z</span></span></blockquote><div class="calibre_132"> </div><ul class="calibre_9"><li value="1" class="calibre_13">The Zen of Python, <a href="index_split_007.html#filepos64658"><span class="calibre_7">Readability and Maintainability</span></a></li><li value="2" class="calibre_10">zero-based indexing, <a href="index_split_024.html#filepos1295706"><span class="calibre_7">The Excel Object Model</span></a></li><li value="3" class="calibre_10">zeros, replacing NaN values with, <a href="index_split_015.html#filepos624230"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="4" class="calibre_10">zombie processes, <a href="index_split_025.html#filepos1412114"><span class="calibre_7">xlwings Foundations</span></a></li></ul><div class="mbp_pagebreak" id="calibre_pb_27"/>


<p class="calibre_"><span class="bold">About the Author</span></p><p class="calibre_6"><span class="bold">Felix Zumstein</span> is creator and maintainer of xlwings, a popular open source package that allows the automation of Excel with Python on Windows and macOS. He also organizes the xlwings meetups in London and NYC to promote a broad range of innovative solutions for Excel.</p><p class="calibre_6">As CEO of xltrail, a version control system for Excel files, he has talked to hundreds of users who use Excel for business critical tasks and has therefore gained deep insight into the typical uses cases and issues with Excel across various industries.</p><div class="mbp_pagebreak" id="calibre_pb_28"/>


<p class="calibre_"><span class="bold">Colophon</span></p><p class="calibre_6">The animal on the cover of <span class="italic">Python for Excel</span> is a false coral snake (<span class="italic">Anilius scytale</span>). This brightly colored snake, also known as the American pipe snake, is found in the Guianas region of South America, the Amazon rainforest, and Trinidad and Tobago.</p><p class="calibre_6">The false coral snake grows up to around 70 cm in length and has bright red and black bands. Its banded appearance is similar to that of the coral snake, from whom it derives one of its common names; however, the false coral snake is missing the distinctive yellow bands of the “true” coral snake. Its body has roughly the same diameter for most of its length with a very short tail, giving it a tube-like appearance. It small eyes are covered by large head scales.</p><p class="calibre_6">This burrowing snake has been observed to be ovoviviparous. It feeds on beetles, amphibians, lizards, fish, and other small snakes. The false coral snake also retains spurs, or small protruding bits of bone near its vent, which are vestigial traces of hips and occasionally upper leg bones. This feature, along with the thick bones and distinctive shape of its skull, makes the false coral snake closely resemble snakes’ ancestral, lizard-like condition.</p><p class="calibre_6">The conservation status of the false coral snake is “Data Deficient,” meaning that there is not yet enough information to judge the threat of its extinction. Many of the animals on O’Reilly covers are endangered; all of them are important to the world.</p><p class="calibre_6">The cover illustration is by Karen Montgomery, based on a black and white engraving from <span class="italic">English Cyclopedia Natural History</span>. The cover fonts are Gilroy Semibold and Guardian Sans. The text font is Adobe Minion Pro; the heading font is Adobe Myriad Condensed; and the code font is Dalton Maag’s Ubuntu Mono.</p><div class="mbp_pagebreak" id="calibre_pb_29"/>


<div id="filepos2197622" class="calibre_8"> </div><ol class="calibre_99"><li value="1" class="calibre_13"><a href="index_split_003.html#filepos7451"><span class="calibre_7">Preface</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_003.html#filepos10599"><span class="calibre_7">Why I Wrote This Book</span></a></li><li value="2" class="calibre_10"><a href="index_split_004.html#filepos12953"><span class="calibre_7">Who This Book Is For</span></a></li><li value="3" class="calibre_10"><a href="index_split_005.html#filepos14647"><span class="calibre_7">How This Book Is Organized</span></a></li><li value="4" class="calibre_10"><a href="index_split_005.html#filepos19282"><span class="calibre_7">Python and Excel Versions</span></a></li><li value="5" class="calibre_10"><a href="index_split_005.html#filepos20494"><span class="calibre_7">Conventions Used in This Book</span></a></li><li value="6" class="calibre_10"><a href="index_split_005.html#filepos22519"><span class="calibre_7">Using Code Examples</span></a></li><li value="7" class="calibre_10"><a href="index_split_005.html#filepos26099"><span class="calibre_7">O’Reilly Online Learning</span></a></li><li value="8" class="calibre_10"><a href="index_split_005.html#filepos27203"><span class="calibre_7">How to Contact Us</span></a></li><li value="9" class="calibre_10"><a href="index_split_005.html#filepos29274"><span class="calibre_7">Acknowledgments</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_006.html#filepos31953"><span class="calibre_7">I. Introduction to Python</span></a></li><li value="3" class="calibre_10"><a href="index_split_007.html#filepos32075"><span class="calibre_7">1. Why Python for Excel?</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_007.html#filepos35568"><span class="calibre_7">Excel Is a Programming Language</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_007.html#filepos38474"><span class="calibre_7">Excel in the News</span></a></li><li value="2" class="calibre_10"><a href="index_split_007.html#filepos41058"><span class="calibre_7">Programming Best Practices</span></a></li><li value="3" class="calibre_10"><a href="index_split_007.html#filepos57974"><span class="calibre_7">Modern Excel</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_007.html#filepos62423"><span class="calibre_7">Python for Excel</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_007.html#filepos64265"><span class="calibre_7">Readability and Maintainability</span></a></li><li value="2" class="calibre_10"><a href="index_split_007.html#filepos71431"><span class="calibre_7">Standard Library and Package Manager</span></a></li><li value="3" class="calibre_10"><a href="index_split_007.html#filepos76421"><span class="calibre_7">Scientific Computing</span></a></li><li value="4" class="calibre_10"><a href="index_split_007.html#filepos80725"><span class="calibre_7">Modern Language Features</span></a></li><li value="5" class="calibre_10"><a href="index_split_007.html#filepos90194"><span class="calibre_7">Cross-Platform Compatibility</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_007.html#filepos92569"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_008.html#filepos96824"><span class="calibre_7">2. Development Environment</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_008.html#filepos98858"><span class="calibre_7">The Anaconda Python Distribution</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_008.html#filepos99810"><span class="calibre_7">Installation</span></a></li><li value="2" class="calibre_10"><a href="index_split_008.html#filepos101327"><span class="calibre_7">Anaconda Prompt</span></a></li><li value="3" class="calibre_10"><a href="index_split_008.html#filepos114857"><span class="calibre_7">Python REPL: An Interactive Python Session</span></a></li><li value="4" class="calibre_10"><a href="index_split_008.html#filepos119195"><span class="calibre_7">Package Managers: Conda and pip</span></a></li><li value="5" class="calibre_10"><a href="index_split_008.html#filepos127301"><span class="calibre_7">Conda Environments</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_008.html#filepos129753"><span class="calibre_7">Jupyter Notebooks</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_008.html#filepos132302"><span class="calibre_7">Running Jupyter Notebooks</span></a></li><li value="2" class="calibre_10"><a href="index_split_009.html#filepos134472"><span class="calibre_7">Notebook Cells</span></a></li><li value="3" class="calibre_10"><a href="index_split_009.html#filepos140089"><span class="calibre_7">Edit vs. Command Mode</span></a></li><li value="4" class="calibre_10"><a href="index_split_009.html#filepos145029"><span class="calibre_7">Run Order Matters</span></a></li><li value="5" class="calibre_10"><a href="index_split_009.html#filepos149719"><span class="calibre_7">Shutting Down Jupyter Notebooks</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_009.html#filepos153612"><span class="calibre_7">Visual Studio Code</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_009.html#filepos159489"><span class="calibre_7">Installation and Configuration</span></a></li><li value="2" class="calibre_10"><a href="index_split_009.html#filepos164978"><span class="calibre_7">Running a Python Script</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_009.html#filepos176641"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="5" class="calibre_10"><a href="index_split_010.html#filepos178328"><span class="calibre_7">3. Getting Started with Python</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_010.html#filepos180215"><span class="calibre_7">Data Types</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_010.html#filepos180784"><span class="calibre_7">Objects</span></a></li><li value="2" class="calibre_10"><a href="index_split_011.html#filepos189029"><span class="calibre_7">Numeric Types</span></a></li><li value="3" class="calibre_10"><a href="index_split_011.html#filepos204923"><span class="calibre_7">Booleans</span></a></li><li value="4" class="calibre_10"><a href="index_split_011.html#filepos217861"><span class="calibre_7">Strings</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_011.html#filepos227429"><span class="calibre_7">Indexing and Slicing</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_011.html#filepos227867"><span class="calibre_7">Indexing</span></a></li><li value="2" class="calibre_10"><a href="index_split_011.html#filepos233601"><span class="calibre_7">Slicing</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_011.html#filepos242277"><span class="calibre_7">Data Structures</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_011.html#filepos243091"><span class="calibre_7">Lists</span></a></li><li value="2" class="calibre_10"><a href="index_split_011.html#filepos268746"><span class="calibre_7">Dictionaries</span></a></li><li value="3" class="calibre_10"><a href="index_split_011.html#filepos285719"><span class="calibre_7">Tuples</span></a></li><li value="4" class="calibre_10"><a href="index_split_011.html#filepos290490"><span class="calibre_7">Sets</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_011.html#filepos302712"><span class="calibre_7">Control Flow</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_011.html#filepos303492"><span class="calibre_7">Code Blocks and the pass Statement</span></a></li><li value="2" class="calibre_10"><a href="index_split_012.html#filepos306124"><span class="calibre_7">The if Statement and Conditional Expressions</span></a></li><li value="3" class="calibre_10"><a href="index_split_012.html#filepos316543"><span class="calibre_7">The for and while Loops</span></a></li><li value="4" class="calibre_10"><a href="index_split_012.html#filepos346762"><span class="calibre_7">List, Dictionary, and Set Comprehensions</span></a></li></ol></li><li value="5" class="calibre_10"><a href="index_split_012.html#filepos361307"><span class="calibre_7">Code Organization</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_012.html#filepos361867"><span class="calibre_7">Functions</span></a></li><li value="2" class="calibre_10"><a href="index_split_012.html#filepos376269"><span class="calibre_7">Modules and the import Statement</span></a></li><li value="3" class="calibre_10"><a href="index_split_012.html#filepos392743"><span class="calibre_7">The datetime Class</span></a></li></ol></li><li value="6" class="calibre_10"><a href="index_split_012.html#filepos408951"><span class="calibre_7">PEP 8: Style Guide for Python Code</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_012.html#filepos426085"><span class="calibre_7">PEP 8 and VS Code</span></a></li><li value="2" class="calibre_10"><a href="index_split_012.html#filepos427790"><span class="calibre_7">Type Hints</span></a></li></ol></li><li value="7" class="calibre_10"><a href="index_split_012.html#filepos431930"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="6" class="calibre_10"><a href="index_split_013.html#filepos433190"><span class="calibre_7">II. Introduction to pandas</span></a></li><li value="7" class="calibre_10"><a href="index_split_014.html#filepos433313"><span class="calibre_7">4. NumPy Foundations</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_014.html#filepos434390"><span class="calibre_7">Getting Started with NumPy</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_014.html#filepos434752"><span class="calibre_7">NumPy Array</span></a></li><li value="2" class="calibre_10"><a href="index_split_014.html#filepos448103"><span class="calibre_7">Vectorization and Broadcasting</span></a></li><li value="3" class="calibre_10"><a href="index_split_014.html#filepos454160"><span class="calibre_7">Universal Functions (ufunc)</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_014.html#filepos462749"><span class="calibre_7">Creating and Manipulating Arrays</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_014.html#filepos463249"><span class="calibre_7">Getting and Setting Array Elements</span></a></li><li value="2" class="calibre_10"><a href="index_split_014.html#filepos470734"><span class="calibre_7">Useful Array Constructors</span></a></li><li value="3" class="calibre_10"><a href="index_split_014.html#filepos475126"><span class="calibre_7">View vs. Copy</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_014.html#filepos480583"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="8" class="calibre_10"><a href="index_split_015.html#filepos482650"><span class="calibre_7">5. Data Analysis with pandas</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_015.html#filepos484346"><span class="calibre_7">DataFrame and Series</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_015.html#filepos498826"><span class="calibre_7">Index</span></a></li><li value="2" class="calibre_10"><a href="index_split_015.html#filepos512830"><span class="calibre_7">Columns</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_015.html#filepos524268"><span class="calibre_7">Data Manipulation</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_015.html#filepos525021"><span class="calibre_7">Selecting Data</span></a></li><li value="2" class="calibre_10"><a href="index_split_015.html#filepos575658"><span class="calibre_7">Setting Data</span></a></li><li value="3" class="calibre_10"><a href="index_split_015.html#filepos598671"><span class="calibre_7">Missing Data</span></a></li><li value="4" class="calibre_10"><a href="index_split_015.html#filepos608764"><span class="calibre_7">Duplicate Data</span></a></li><li value="5" class="calibre_10"><a href="index_split_015.html#filepos617229"><span class="calibre_7">Arithmetic Operations</span></a></li><li value="6" class="calibre_10"><a href="index_split_015.html#filepos633855"><span class="calibre_7">Working with Text Columns</span></a></li><li value="7" class="calibre_10"><a href="index_split_015.html#filepos640942"><span class="calibre_7">Applying a Function</span></a></li><li value="8" class="calibre_10"><a href="index_split_015.html#filepos649491"><span class="calibre_7">View vs. Copy</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_016.html#filepos652519"><span class="calibre_7">Combining DataFrames</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_016.html#filepos653446"><span class="calibre_7">Concatenating</span></a></li><li value="2" class="calibre_10"><a href="index_split_016.html#filepos667627"><span class="calibre_7">Joining and Merging</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_016.html#filepos690581"><span class="calibre_7">Descriptive Statistics and Data Aggregation</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_016.html#filepos691116"><span class="calibre_7">Descriptive Statistics</span></a></li><li value="2" class="calibre_10"><a href="index_split_016.html#filepos695376"><span class="calibre_7">Grouping</span></a></li><li value="3" class="calibre_10"><a href="index_split_016.html#filepos701398"><span class="calibre_7">Pivoting and Melting</span></a></li></ol></li><li value="5" class="calibre_10"><a href="index_split_016.html#filepos716809"><span class="calibre_7">Plotting</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_016.html#filepos717341"><span class="calibre_7">Matplotlib</span></a></li><li value="2" class="calibre_10"><a href="index_split_016.html#filepos727990"><span class="calibre_7">Plotly</span></a></li></ol></li><li value="6" class="calibre_10"><a href="index_split_016.html#filepos740294"><span class="calibre_7">Importing and Exporting DataFrames</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_016.html#filepos745685"><span class="calibre_7">Exporting CSV Files</span></a></li><li value="2" class="calibre_10"><a href="index_split_016.html#filepos748485"><span class="calibre_7">Importing CSV Files</span></a></li></ol></li><li value="7" class="calibre_10"><a href="index_split_016.html#filepos765032"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="9" class="calibre_10"><a href="index_split_017.html#filepos767560"><span class="calibre_7">6. Time Series Analysis with pandas</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_017.html#filepos770332"><span class="calibre_7">DatetimeIndex</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_017.html#filepos770653"><span class="calibre_7">Creating a DatetimeIndex</span></a></li><li value="2" class="calibre_10"><a href="index_split_017.html#filepos794850"><span class="calibre_7">Filtering a DatetimeIndex</span></a></li><li value="3" class="calibre_10"><a href="index_split_017.html#filepos799109"><span class="calibre_7">Working with Time Zones</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_017.html#filepos808936"><span class="calibre_7">Common Time Series Manipulations</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_017.html#filepos809440"><span class="calibre_7">Shifting and Percentage Changes</span></a></li><li value="2" class="calibre_10"><a href="index_split_017.html#filepos821988"><span class="calibre_7">Rebasing and Correlation</span></a></li><li value="3" class="calibre_10"><a href="index_split_017.html#filepos846876"><span class="calibre_7">Resampling</span></a></li><li value="4" class="calibre_10"><a href="index_split_017.html#filepos854869"><span class="calibre_7">Rolling Windows</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_017.html#filepos860113"><span class="calibre_7">Limitations with pandas</span></a></li><li value="4" class="calibre_10"><a href="index_split_017.html#filepos861902"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="10" class="calibre_10"><a href="index_split_018.html#filepos863198"><span class="calibre_7">III. Reading and Writing Excel Files Without Excel</span></a></li><li value="11" class="calibre_10"><a href="index_split_019.html#filepos863345"><span class="calibre_7">7. Excel File Manipulation with pandas</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_019.html#filepos864355"><span class="calibre_7">Case Study: Excel Reporting</span></a></li><li value="2" class="calibre_10"><a href="index_split_019.html#filepos885558"><span class="calibre_7">Reading and Writing Excel Files with pandas</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_019.html#filepos886236"><span class="calibre_7">The read_excel Function and ExcelFile Class</span></a></li><li value="2" class="calibre_10"><a href="index_split_019.html#filepos935608"><span class="calibre_7">The to_excel Method and ExcelWriter Class</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_019.html#filepos957296"><span class="calibre_7">Limitations When Using pandas with Excel Files</span></a></li><li value="4" class="calibre_10"><a href="index_split_019.html#filepos958961"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="12" class="calibre_10"><a href="index_split_020.html#filepos959867"><span class="calibre_7">8. Excel File Manipulation with Reader and Writer Packages</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_020.html#filepos961261"><span class="calibre_7">The Reader and Writer Packages</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_020.html#filepos962240"><span class="calibre_7">When to Use Which Package</span></a></li><li value="2" class="calibre_10"><a href="index_split_021.html#filepos972482"><span class="calibre_7">The excel.py Module</span></a></li><li value="3" class="calibre_10"><a href="index_split_021.html#filepos981650"><span class="calibre_7">OpenPyXL</span></a></li><li value="4" class="calibre_10"><a href="index_split_021.html#filepos1039580"><span class="calibre_7">XlsxWriter</span></a></li><li value="5" class="calibre_10"><a href="index_split_021.html#filepos1071801"><span class="calibre_7">pyxlsb</span></a></li><li value="6" class="calibre_10"><a href="index_split_021.html#filepos1084875"><span class="calibre_7">xlrd, xlwt, and xlutils</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_022.html#filepos1124258"><span class="calibre_7">Advanced Reader and Writer Topics</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_022.html#filepos1125008"><span class="calibre_7">Working with Big Excel Files</span></a></li><li value="2" class="calibre_10"><a href="index_split_022.html#filepos1157601"><span class="calibre_7">Formatting DataFrames in Excel</span></a></li><li value="3" class="calibre_10"><a href="index_split_022.html#filepos1232272"><span class="calibre_7">Case Study (Revisited): Excel Reporting</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_022.html#filepos1233979"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="13" class="calibre_10"><a href="index_split_023.html#filepos1235617"><span class="calibre_7">IV. Programming the Excel Application with xlwings</span></a></li><li value="14" class="calibre_10"><a href="index_split_024.html#filepos1235764"><span class="calibre_7">9. Excel Automation</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_024.html#filepos1238381"><span class="calibre_7">Getting Started with xlwings</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_024.html#filepos1239368"><span class="calibre_7">Using Excel as Data Viewer</span></a></li><li value="2" class="calibre_10"><a href="index_split_024.html#filepos1250093"><span class="calibre_7">The Excel Object Model</span></a></li><li value="3" class="calibre_10"><a href="index_split_024.html#filepos1313184"><span class="calibre_7">Running VBA Code</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_025.html#filepos1323109"><span class="calibre_7">Converters, Options, and Collections</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_025.html#filepos1323983"><span class="calibre_7">Working with DataFrames</span></a></li><li value="2" class="calibre_10"><a href="index_split_025.html#filepos1340542"><span class="calibre_7">Converters and Options</span></a></li><li value="3" class="calibre_10"><a href="index_split_025.html#filepos1367107"><span class="calibre_7">Charts, Pictures, and Defined Names</span></a></li><li value="4" class="calibre_10"><a href="index_split_025.html#filepos1400825"><span class="calibre_7">Case Study (Re-Revisited): Excel Reporting</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_025.html#filepos1410331"><span class="calibre_7">Advanced xlwings Topics</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_025.html#filepos1410727"><span class="calibre_7">xlwings Foundations</span></a></li><li value="2" class="calibre_10"><a href="index_split_025.html#filepos1416214"><span class="calibre_7">Improving Performance</span></a></li><li value="3" class="calibre_10"><a href="index_split_025.html#filepos1429461"><span class="calibre_7">How to Work Around Missing Functionality</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_025.html#filepos1435946"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="15" class="calibre_10"><a href="index_split_026.html#filepos1439732"><span class="calibre_7">10. Python-Powered Excel Tools</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_026.html#filepos1440768"><span class="calibre_7">Using Excel as Frontend with xlwings</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_026.html#filepos1441981"><span class="calibre_7">Excel Add-in</span></a></li><li value="2" class="calibre_10"><a href="index_split_026.html#filepos1448166"><span class="calibre_7">Quickstart Command</span></a></li><li value="3" class="calibre_10"><a href="index_split_026.html#filepos1449780"><span class="calibre_7">Run Main</span></a></li><li value="4" class="calibre_10"><a href="index_split_026.html#filepos1459239"><span class="calibre_7">RunPython Function</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_026.html#filepos1471908"><span class="calibre_7">Deployment</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_026.html#filepos1472608"><span class="calibre_7">Python Dependency</span></a></li><li value="2" class="calibre_10"><a href="index_split_026.html#filepos1475221"><span class="calibre_7">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></a></li><li value="3" class="calibre_10"><a href="index_split_026.html#filepos1478036"><span class="calibre_7">Configuration Hierarchy</span></a></li><li value="4" class="calibre_10"><a href="index_split_026.html#filepos1480462"><span class="calibre_7">Settings</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_026.html#filepos1485980"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="16" class="calibre_10"><a href="index_split_027.html#filepos1487255"><span class="calibre_7">11. The Python Package Tracker</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_027.html#filepos1488972"><span class="calibre_7">What We Will Build</span></a></li><li value="2" class="calibre_10"><a href="index_split_027.html#filepos1492209"><span class="calibre_7">Core Functionality</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_027.html#filepos1492676"><span class="calibre_7">Web APIs</span></a></li><li value="2" class="calibre_10"><a href="index_split_027.html#filepos1515287"><span class="calibre_7">Databases</span></a></li><li value="3" class="calibre_10"><a href="index_split_027.html#filepos1580121"><span class="calibre_7">Exceptions</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_027.html#filepos1601250"><span class="calibre_7">Application Structure</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_027.html#filepos1606102"><span class="calibre_7">Frontend</span></a></li><li value="2" class="calibre_10"><a href="index_split_027.html#filepos1619894"><span class="calibre_7">Backend</span></a></li><li value="3" class="calibre_10"><a href="index_split_027.html#filepos1644529"><span class="calibre_7">Debugging</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_027.html#filepos1651491"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="17" class="calibre_10"><a href="index_split_028.html#filepos1653100"><span class="calibre_7">12. User-Defined Functions (UDFs)</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_028.html#filepos1655019"><span class="calibre_7">Getting Started with UDFs</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_028.html#filepos1657338"><span class="calibre_7">UDF Quickstart</span></a></li></ol></li><li value="2" class="calibre_10"><a href="index_split_028.html#filepos1679203"><span class="calibre_7">Case Study: Google Trends</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_028.html#filepos1679853"><span class="calibre_7">Introduction to Google Trends</span></a></li><li value="2" class="calibre_10"><a href="index_split_028.html#filepos1682320"><span class="calibre_7">Working with DataFrames and Dynamic Arrays</span></a></li><li value="3" class="calibre_10"><a href="index_split_028.html#filepos1714648"><span class="calibre_7">Fetching Data from Google Trends</span></a></li><li value="4" class="calibre_10"><a href="index_split_028.html#filepos1741693"><span class="calibre_7">Plotting with UDFs</span></a></li><li value="5" class="calibre_10"><a href="index_split_028.html#filepos1755123"><span class="calibre_7">Debugging UDFs</span></a></li></ol></li><li value="3" class="calibre_10"><a href="index_split_028.html#filepos1760894"><span class="calibre_7">Advanced UDF Topics</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_028.html#filepos1761747"><span class="calibre_7">Basic Performance Optimization</span></a></li><li value="2" class="calibre_10"><a href="index_split_028.html#filepos1775412"><span class="calibre_7">Caching</span></a></li><li value="3" class="calibre_10"><a href="index_split_028.html#filepos1795188"><span class="calibre_7">The Sub Decorator</span></a></li></ol></li><li value="4" class="calibre_10"><a href="index_split_028.html#filepos1804492"><span class="calibre_7">Conclusion</span></a></li></ol></li><li value="18" class="calibre_10"><a href="index_split_029.html#filepos1810552"><span class="calibre_7">A. Conda Environments</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_029.html#filepos1811963"><span class="calibre_7">Create a New Conda Environment</span></a></li><li value="2" class="calibre_10"><a href="index_split_029.html#filepos1817917"><span class="calibre_7">Disable Auto Activation</span></a></li></ol></li><li value="19" class="calibre_10"><a href="index_split_030.html#filepos1820886"><span class="calibre_7">B. Advanced VS Code Functionality</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_030.html#filepos1821278"><span class="calibre_7">Debugger</span></a></li><li value="2" class="calibre_10"><a href="index_split_030.html#filepos1825947"><span class="calibre_7">Jupyter Notebooks in VS Code</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_030.html#filepos1826547"><span class="calibre_7">Run Jupyter Notebooks</span></a></li><li value="2" class="calibre_10"><a href="index_split_030.html#filepos1829180"><span class="calibre_7">Python Scripts with Code Cells</span></a></li></ol></li></ol></li><li value="20" class="calibre_10"><a href="index_split_031.html#filepos1832059"><span class="calibre_7">C. Advanced Python Concepts</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_031.html#filepos1832487"><span class="calibre_7">Classes and Objects</span></a></li><li value="2" class="calibre_10"><a href="index_split_031.html#filepos1847758"><span class="calibre_7">Working with Time-Zone-Aware datetime Objects</span></a></li><li value="3" class="calibre_10"><a href="index_split_031.html#filepos1865329"><span class="calibre_7">Mutable vs. Immutable Python Objects</span></a><div class="calibre_8"> </div><ol class="calibre_137"><li value="1" class="calibre_13"><a href="index_split_031.html#filepos1882626"><span class="calibre_7">Calling Functions with Mutable Objects as Arguments</span></a></li><li value="2" class="calibre_10"><a href="index_split_031.html#filepos1896621"><span class="calibre_7">Functions with Mutable Objects as Default Arguments</span></a></li></ol></li></ol></li><li value="21" class="calibre_10"><a href="index_split_032.html#filepos1903642"><span class="calibre_7">Index</span></a></li></ol><div class="mbp_pagebreak" id="calibre_pb_30"/>
</body></html>