<html><head></head><body>
<p id="filepos1439732" class="calibre_"><span class="calibre2"><span class="bold"><span class="calibre_15">Chapter 10. Python-Powered Excel Tools</span></span></span></p><p class="calibre_16">In the last chapter, we learned how to write Python scripts to automate Microsoft Excel. While this is very powerful, the user must feel comfortable using either the Anaconda Prompt or an editor like VS Code to run the scripts. This is most likely not the case if your tools are used by business users. For them, you’ll want to hide away the Python part so that the Excel tool feels like a normal macro-enabled workbook again. How you achieve that with xlwings is the topic of this chapter. I’ll start by showing you the shortest path to run Python code from Excel before looking at the challenges of deploying xlwings tools—this will also allow us to have a more detailed look at the available settings that xlwings offers. Like the last chapter, this chapter requires you to have an installation of Microsoft Excel on either Windows or macOS.</p><p id="filepos1440768" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Using Excel as Frontend with xlwings</span></span></span></p><p class="calibre_6">The <span class="italic">frontend</span> is <a id="filepos1440971"/>the part of an application that a user sees and interacts with. Other common names for frontend are <span class="italic">graphical user interface</span> (GUI) or<a/> just <span class="italic">user interface</span> (UI). When I ask xlwings users why they are creating their tool with Excel rather than building a modern web application, what I usually hear is this: “Excel is the interface that our users are familiar with.” Relying on spreadsheet cells allows the users to provide inputs quickly and intuitively, making them often more productive than if they have to use a half-baked web interface. I’ll start this section by introducing you to the xlwings Excel add-in and the xlwings CLI (command line interface) before creating our first project via the <tt class="calibre6">quickstart</tt> command. I’ll wrap this section up by showing you two ways of calling Python code from Excel: by clicking the Run main button in the add-in and by using the <tt class="calibre6">RunPython</tt> function in VBA. Let’s get started by installing the xlwings Excel add-in!</p><p id="filepos1441981" class="calibre_17"><span class="calibre3"><span class="bold">Excel Add-in</span></span></p><p class="calibre_6">Since<a id="filepos1442113"/> xlwings is included in the Anaconda distribution, in the previous chapter, we could run xlwings commands in Python right out of the box. If you, however, want to call Python scripts from Excel, you need to either install the Excel add-in or set the workbook up in the standalone mode. While I will introduce the standalone mode under <a href="#filepos1471908"><span class="calibre_7">“Deployment”</span></a>, this section shows you how to work with the add-in. To install<a id="filepos1442590"/> it, run the following on an Anaconda Prompt:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings addin install</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">You will need to keep the version of the Python package and the version of the add-in in sync whenever you update xlwings. Therefore, you should always run two commands when you update xlwings—one for the Python package and one for the Excel add-in. Depending on whether you use the Conda or pip package manager, this is how you <a id="filepos1443233"/>update your xlwings installation:</p><p class="calibre_6"><span class="italic">Conda (use this with the Anaconda Python distribution)</span></p><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">conda update xlwings</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings addin install</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote></blockquote><p class="calibre_17"><span class="italic">pip (use this with any other Python distribution)</span></p><blockquote class="calibre_46"><blockquote class="calibre_19"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">pip install --upgrade xlwings</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings addin install</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote></blockquote><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">ANTIVIRUS SOFTWARE</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">Unfortunately, the xlwings add-in is sometimes flagged as a malicious add-in by antivirus software, especially if you’re using a brand-new release. If this happens on your machine, go to the settings of your antivirus software, where you should be able to mark xlwings as safe to run. Usually, it’s also possible to report such false positives via the software’s home page.</span><a id="filepos1444759"/></blockquote><p class="calibre_16">When you type <tt class="calibre6">xlwings</tt> on an Anaconda Prompt, you are using<a id="filepos1444887"/> the xlwings CLI. Apart from making the installation of the xlwings add-in easy, it offers a few more commands: I will introduce them whenever we need them, but you can always type <tt class="calibre6">xlwings</tt> on an Anaconda Prompt and hit Enter to print the available options. Let’s now have a closer look at what <tt class="calibre6">xlwings addin install</tt> does:</p><p class="calibre_6"><span class="italic">Installation</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">The actual installation of the add-in is done by copying <span class="italic">xlwings.xlam</span> from the directory of the Python package into Excel’s <span class="italic">XLSTART</span> folder, which is a special folder: Excel will open all files that are in this folder every time you start Excel. When you run <tt class="calibre6">xlwings addin status</tt> on an Anaconda Prompt, it will print where the <span class="italic">XLSTART</span> directory is on your system and whether or not the add-in is installed.</blockquote></blockquote><p class="calibre_20"><span class="italic">Configuration</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">When you install the add-in for the very first time, it will also configure it to use the Python interpreter or Conda environment from where you are running the <tt class="calibre6">install</tt> command: as you see in <a href="#filepos1447147"><span class="calibre_7">Figure 10-1</span></a>, the values for <tt class="calibre6">Conda Path</tt> and <tt class="calibre6">Conda Env</tt> are filled in automatically by the xlwings CLI.<a href="#filepos1486934"><span class="calibre5"><span class="calibre_7">1</span></span></a> These values are stored in a file called <span class="italic">xlwings.conf</span> in the <span class="italic">.xlwings</span> folder in your home directory. On Windows, this is usually <span class="italic">C:\Users\&lt;username&gt;\.xlwings\xlwings.conf</span> and on macOS <span class="italic">/Users/&lt;username&gt;/.xlwings/xlwings.conf</span>. On macOS, folders and files with a leading dot are hidden by default. When you are in Finder, type the keyboard shortcut Command-Shift-. to toggle their visibility.</blockquote><a id="filepos1446851"/></blockquote><p class="calibre_16">After running the installation command, you’ll have to restart Excel to see the xlwings tab in the ribbon as shown in <a href="#filepos1447147"><span class="calibre_7">Figure 10-1</span></a>.</p><p class="calibre_21"><img src="images/00040.jpg" id="filepos1447147" class="calibre_95"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 10-1. The xlwings ribbon add-in after running the install command</span></span></span></p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">THE RIBBON ADD-IN ON MACOS</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">On macOS, the ribbon looks a bit different as it’s missing the sections about user-defined functions and Conda: while user-defined functions are not supported on macOS, Conda environments don’t require special treatment, i.e., are configured as Interpreter under the Python group.</span><a id="filepos1447883"/></blockquote><p class="calibre_16">Now that you have<a id="filepos1447961"/> the xlwings add-in installed, we’ll need a workbook and some Python code to test it out. The fastest way of getting there is by using the <tt class="calibre6">quickstart</tt> command, as I will show you next.</p><p id="filepos1448166" class="calibre_17"><span class="calibre3"><span class="bold">Quickstart Command</span></span></p><p class="calibre_6">To <a id="filepos1448302"/>make the creation of your first xlwings tool as easy as possible, the xlwings CLI offers the <tt class="calibre6">quickstart</tt> command. On an Anaconda Prompt, use the <tt class="calibre6">cd</tt> command to change into the directory where you want to create your first project (e.g., <tt class="calibre6">cd Desktop</tt>), then run the following to create a project with the name <tt class="calibre6">first_project</tt>:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings quickstart first_project</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">The project name has to be a valid Python module name: it can contain characters, numbers, and underscores, but no spaces or dashes, and it must not start with a number. I will show you under <a href="#filepos1459239"><span class="calibre_7">“RunPython Function”</span></a> how you can change the name of the Excel file into something that doesn’t have to follow these rules. Running the <tt class="calibre6">quickstart</tt> command will create a folder called <span class="italic">first_project</span> in your current directory. When you open it in the File Explorer on Windows or the Finder on macOS, you will see two files: <span class="italic">first_project.xlsm</span> and <span class="italic">first_project.py</span>. Open both files—the Excel file in Excel and the Python file in VS Code. The easiest way to run the Python code from Excel is by using the Run main button in the add-in—let’s see how it works!</p><p id="filepos1449780" class="calibre_17"><span class="calibre3"><span class="bold">Run Main</span></span></p><p class="calibre_6">Before <a id="filepos1449910"/>looking at <span class="italic">first_project.py</span> in more detail, go ahead and click the Run main button on the very left of the xlwings add-in while <span class="italic">first_project.xlsm</span> is your active file; it will write “Hello xlwings!” into cell <tt class="calibre6">A1</tt> of the first sheet. Click the button again and it will change to “Bye xlwings!” Congratulations, you have just run your first Python function from Excel! After all, that wasn’t much harder than writing a VBA macro, was it? Let’s now have a look at <span class="italic">first_project.py</span> in <a href="#filepos1450512"><span class="calibre_7">Example 10-1</span></a>.</p><p id="filepos1450512" class="calibre_6"><span class="italic">Example 10-1. first_project.py</span></p><p class="calibre_63"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">import</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xlwings</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">as</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_64">xw</span></span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">main</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">():</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">wb</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">xw</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Book</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00031.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">wb</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheets</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_37">0</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">==</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello xlwings!"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Bye xlwings!"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">else</span></span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>        </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">sheet</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">[</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"A1"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">]</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">value</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">=</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello xlwings!"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_44">@xw.func</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00039.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">def</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">hello</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">name</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">):</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">return</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">f</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"Hello {name}!"</span></tt></span></p><p class="calibre_"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">if</span></span></tt></span><span class="calibre5"><tt class="calibre6"> __name__ </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">==</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"__main__"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">:</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><img src="images/00050.jpg" class="calibre_65"/><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">xw</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">Book</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">(</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"first_project.xlsm"</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">)</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_5">.</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">set_mock_caller</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">main</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span></p><p class="calibre_32"><img src="images/00031.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19"><tt class="calibre6">xw.Book.caller()</tt> is an xlwings <tt class="calibre6">book</tt> object that refers to the Excel workbook that is active when you click the Run main button. In our case, it corresponds to <tt class="calibre6">xw.Book("first_project.xlsm")</tt>. Using <tt class="calibre6">xw.Book.caller()</tt> allows you to rename and move your Excel file around on the file system without breaking the reference. It also makes sure that you are manipulating the correct workbook if you have it open in multiple Excel instances.</blockquote></blockquote><p class="calibre_20"><img src="images/00039.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">In this chapter, we will ignore the function <tt class="calibre6">hello</tt> as this will be the topic of <a href="index_split_028.html#filepos1653100"><span class="calibre_7">Chapter 12</span></a>. If you run the <tt class="calibre6">quickstart</tt> command on macOS, you won’t see the <tt class="calibre6">hello</tt> function anyway, as user-defined functions are only supported on Windows.</blockquote></blockquote><p class="calibre_20"><img src="images/00050.jpg" class="calibre_65"/></p><blockquote class="calibre4"><blockquote class="calibre_19">I will explain the last three lines when we look at debugging in the next chapter. For the purpose of this chapter, ignore or even delete everything below the first function.</blockquote></blockquote><p class="calibre_16">The Run main button in the Excel add-in is a convenience feature: it allows you to call a function with the name <tt class="calibre6">main</tt> in a Python module that has the same name as the Excel file without having to add a button first to your workbook. It<a id="filepos1458891"/> will even work if you save your workbook in the macro-free <span class="italic">xlsx</span> format. If, however, you want to call one or more Python functions that are not called <tt class="calibre6">main</tt> and are not part of a module with the same name as the workbook, you have to use the <tt class="calibre6">RunPython</tt> function from VBA instead. The next section has the details!</p><p id="filepos1459239" class="calibre_17"><span class="calibre3"><span class="bold">RunPython Function</span></span></p><p class="calibre_6">If <a id="filepos1459375"/>you need more control over how you call your Python code, use the VBA function <tt class="calibre6">RunPython</tt>. Consequently, <tt class="calibre6">RunPython</tt> requires your workbook to be saved as a macro-enabled workbook.<a id="filepos1459577"/></p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">ENABLE MACROS</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">You need to click on Enable Content (Windows) or Enable Macros (macOS) when you open a macro-enabled workbook (</span><a id="filepos1459885"/><span class="calibre5"><span class="italic">xlsm</span></span><span class="calibre5"> extension) such as the one that is generated by the </span><span class="calibre5"><tt class="calibre6">quickstart</tt></span><span class="calibre5"> command. On Windows, when you work with </span><span class="calibre5"><span class="italic">xlsm</span></span><span class="calibre5"> files from the companion repository, you have to additionally click on Enable Editing or Excel won’t open files that are downloaded from the internet properly.</span></blockquote><p class="calibre_16"><tt class="calibre6">RunPython</tt> accepts a string with Python code: most commonly, you import a Python module and run one of its functions. When you open the VBA editor via Alt+F11 (Windows) or Option-F11 (macOS), you will see that the <tt class="calibre6">quickstart</tt> command adds a macro called <tt class="calibre6">SampleCall</tt> in a VBA module with the name “Module1” (see <a href="#filepos1460941"><span class="calibre_7">Figure 10-2</span></a>). If you don’t see the <tt class="calibre6">SampleCall</tt>, double-click Module1 in the VBA project tree on the lefthand side.</p><p class="calibre_21"><img src="images/00032.jpg" id="filepos1460941" class="calibre_96"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 10-2. The VBA editor showing Module1</span></span></span></p><p class="calibre_24">The code looks a bit convoluted, but this is only to make it work dynamically no matter what project name you choose when running the <tt class="calibre6">quickstart</tt> command. As our Python module is called <tt class="calibre6">first_project</tt>, you could replace the code with the following easy-to-understand equivalent:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Sub</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">SampleCall</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">RunPython</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"import first_project; first_project.main()"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">End</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Sub</span></span></tt></span></blockquote><p class="calibre_32">Since it’s no fun to write multiline strings in VBA, we use a semicolon that Python accepts instead of a line break. There are a couple of ways you can run this<a id="filepos1462470"/> code: for example, while you are in the VBA editor, place your cursor on any line of the <tt class="calibre6">SampleCall</tt> macro and hit F5. Usually, however, you will be running the code from an Excel sheet and not from the VBA editor. Therefore, close the VBA editor and switch back to the workbook. Typing Alt+F8 (Windows) or Option-F8 (macOS) will bring up the macro menu: select <tt class="calibre6">SampleCall</tt> and click on the Run button. Or, to make it more user-friendly, add a button to your Excel workbook and connect it with the <tt class="calibre6">SampleCall</tt>: first, make sure that the Developer tab in the ribbon is shown. If it isn’t, go to <tt class="calibre6">File</tt> &gt; Options &gt; Customize Ribbon and activate the checkbox next to Developer (on macOS, you’ll find it under Excel &gt; Preferences &gt; Ribbon &amp; Toolbar instead). To insert a button, go to the Developer tab and in the Controls group, click on Insert &gt; Button (under Form Controls). On macOS, you’ll be presented with the button without having to go to Insert first. When you click the button icon, your cursor turns into a small cross: use it to draw a button on your sheet by holding your left mouse button down while drawing a rectangular form. Once you let go of your mouse button, you’ll be presented with the Assign Macro menu—select the <tt class="calibre6">SampleCall</tt> and click OK. Click the button that you’ve just created (in my case it’s called “Button 1”), and it will run our <tt class="calibre6">main</tt> function again, as in <a href="#filepos1464065"><span class="calibre_7">Figure 10-3</span></a>.</p><p class="calibre_21"><img src="images/00060.jpg" id="filepos1464065" class="calibre_97"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 10-3. Drawing a button on a sheet</span></span></span></p><blockquote class="calibre_25"><span class="bold"><span class="calibre_29">FORM CONTROLS VS. ACTIVEX CONTROLS</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">On Windows, you have two types of controls: Form Controls and ActiveX Controls. While you could use a button from either group to connect to your </span><a id="filepos1464639"/><span class="calibre5"><tt class="calibre6">SampleCall</tt></span><span class="calibre5"> macro, only the one from the Form Controls will work on macOS too. In the next chapter, we will use Rectangles as buttons to make them look a bit more modern.</span></blockquote><p class="calibre_16">Now let’s take a look at how we can change the default names that were assigned by the <tt class="calibre6">quickstart</tt> command: go back to your Python file and rename it from <span class="italic">first_project.py</span> to <span class="italic">hello.py</span>. Also, rename your <tt class="calibre6">main</tt> function into <tt class="calibre6">hello_world</tt>. Make sure to save the file, then open the VBA editor again via Alt+F11 (Windows) or Option-F11 (macOS) and edit <tt class="calibre6">SampleCall</tt> as follows to reflect the changes:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Sub</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_62">SampleCall</span></tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_15">()</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>    </tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_36">RunPython</span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="calibre_38">"import hello; hello.hello_world()"</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">End</span></span></tt></span><span class="calibre5"><tt class="calibre6">
</tt></span><span class="calibre5"><tt class="calibre6"><span class="bold"><span class="calibre_35">Sub</span></span></tt></span></blockquote><p class="calibre_32">Back on the sheet, click the “Button 1” to make sure that everything still works. Finally, you may also want to keep the Python script and the Excel file in two different directories. To understand the implications of this, I’ll first need to say a word about<a id="filepos1466429"/> Python’s <span class="italic">module search path</span>: if you import a module in your code, Python searches for it in various directories. First, Python checks if there is a built-in module with this name, and if it doesn’t find one, moves on to look in the current working directory and in the directories provided by the so-called <tt class="calibre6">PYTHONPATH</tt>. xlwings automatically adds the directory of the workbook to the <tt class="calibre6">PYTHONPATH</tt> and allows you to add additional paths via the add-in. To try this out, take the Python script that is now called <span class="italic">hello.py</span> and move it to a folder called <span class="italic">pyscripts</span> that you create under your home directory: in my case, this would be <span class="italic">C:\Users\felix\pyscripts</span> on Windows or <span class="italic">/Users/felix/pyscripts</span> on macOS. When you now click the button again, you will get the following error in a pop-up:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6">Traceback (most recent call last):<br class="calibre1"/>  File "&lt;string&gt;", line 1, in &lt;module&gt;<br class="calibre1"/>ModuleNotFoundError: No module named 'first_project'</tt></span></blockquote><p class="calibre_32">To fix this, simply add the path of the <span class="italic">pyscripts</span> directory to the <tt class="calibre6">PYTHONPATH</tt> setting in your xlwings ribbon, as in <a href="#filepos1467883"><span class="calibre_7">Figure 10-4</span></a>. When you now click the button one more time, it will work again.</p><p class="calibre_21"><img src="images/00033.jpg" id="filepos1467883" class="calibre_98"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 10-4. The PYTHONPATH setting</span></span></span></p><p class="calibre_24">What <a id="filepos1468145"/>I haven’t touched on yet is the name of the Excel workbook: once your <tt class="calibre6">RunPython</tt> function call uses an explicit module name like <tt class="calibre6">first_project</tt> instead of the code that was added by <tt class="calibre6">quickstart</tt>, you are free to rename your Excel workbook anything you want.</p><p class="calibre_6">Relying on the <tt class="calibre6">quickstart</tt> command is the easiest way if you start a new xlwings <a id="filepos1468568"/>project. If you have an existing workbook, however, you may prefer to set it up manually. Let’s see how it’s done!</p><p class="calibre_20"><span class="bold"><span class="calibre_5">RunPython without quickstart command</span></span></p><p class="calibre_6">If you want to use the <tt class="calibre6">RunPython</tt> function with an existing workbook that wasn’t created by the <tt class="calibre6">quickstart</tt> command, you need to manually take care of the things that the <tt class="calibre6">quickstart</tt> command does for you otherwise. Note that the following steps are only required for the <tt class="calibre6">RunPython</tt> call but not when you want to use the Run main button:</p><div class="calibre_8"> </div><ol class="calibre_99"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">First of all, make sure to save your workbook as a macro-enabled workbook with either the <span class="italic">xlsm</span> or <span class="italic">xlsb</span> extension.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Add a VBA module; to do so, open the VBA editor via Alt+F11 (Windows) or Option-F11 (macOS) and make sure to select the VBAProject of your workbook in the tree view on the lefthand side, then right-click on it and choose Insert &gt; Module, as in <a href="#filepos1470658"><span class="calibre_7">Figure 10-5</span></a>. This will insert an empty VBA module where you can write your VBA macro with the <tt class="calibre6">RunPython</tt> call.</blockquote></blockquote></blockquote></blockquote><blockquote class="calibre_100"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_101"><img src="images/00075.jpg" class="calibre_102"/>
</blockquote></blockquote></blockquote></blockquote><blockquote class="calibre_103"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_101"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 10-5. Add a VBA module</span></span></span></blockquote></blockquote></blockquote></blockquote></li><a id="filepos1470658"/><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Add a reference to xlwings: <tt class="calibre6">RunPython</tt> is a function that is part of the xlwings add-in. To use it, you will need to make sure that you have a reference set to <tt class="calibre6">xlwings</tt> in your VBA Project. Again, start by selecting the correct workbook in the tree view on the lefthand side of the VBA editor, then go to Tools &gt; Reference and activate the checkbox for xlwings, as seen in <a href="#filepos1471674"><span class="calibre_7">Figure 10-6</span></a>.</blockquote></blockquote></blockquote></blockquote></li></ol><p class="calibre_14">Your workbook is now ready to be used with the <tt class="calibre6">RunPython</tt> call again. Once everything <a id="filepos1471460"/>works on your machine, the next step is usually to make it work on your colleague’s machine—let’s go through a couple of options to make this part easier!</p><p class="calibre_21"><img src="images/00047.jpg" id="filepos1471674" class="calibre_104"/>
</p><p class="calibre_23"><span class="calibre5"><span class="italic"><span class="calibre_15">Figure 10-6. RunPython requires a reference to xlwings</span></span></span></p><p id="filepos1471908" class="calibre_17"><span class="calibre3"><span class="bold"><span class="calibre_7">Deployment</span></span></span></p><p class="calibre_6">In<a id="filepos1472064"/> software development, the term <span class="italic">deployment</span> refers to distributing and installing software so that end users are able to use it. In the case of xlwings tools, it helps to know which dependencies are required and which settings can make deployment easier. I’ll start with the most important dependency, which is Python, before looking at workbooks that have been set up in the standalone mode to get rid of the xlwings Excel add-in. I’ll conclude this section by having a closer look at how configuration works with xlwings.</p><p id="filepos1472608" class="calibre_17"><span class="calibre3"><span class="bold">Python Dependency</span></span></p><p class="calibre_6">To be <a id="filepos1472746"/>able to run xlwings tools, your end users must have an installation of Python. But just because they don’t have Python yet doesn’t mean that there aren’t ways to make the installation process easy. Here are a couple of options:</p><p class="calibre_6"><span class="italic">Anaconda or WinPython</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">Instruct your users to download and install the Anaconda distribution. To be on the safe side, you would have to agree to a specific version of Anaconda to make sure they are using the same versions of the contained packages that you’re using. This is a good option if you only use packages that are part of Anaconda. <a href="https://oreil.ly/A66KN"><span class="calibre_7">WinPython</span></a> is an interesting alternative to Anaconda, as it is distributed under the MIT open source license and also comes with xlwings preinstalled. As the name suggests, it is only available on Windows.</blockquote><a id="filepos1473728"/></blockquote><p class="calibre_20"><span class="italic">Shared drive</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">If you have access to a reasonably fast shared drive, you may be able to install Python directly on there, which will allow everyone to use the tools without a local Python installation.</blockquote></blockquote><p class="calibre_20"><span class="italic">Frozen executable</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">On Windows, xlwings allows you to work with <span class="italic">frozen executables</span>, which are files with the <span class="italic">.exe</span> extension that contain Python and all the dependencies. A popular package to produce frozen executables is <a href="https://oreil.ly/AnYlV"><span class="calibre_7">PyInstaller</span></a>. Frozen executables have the advantage that they are only packaging up what your program needs and can produce a single file, which can make distribution easier. For more details on how to work with frozen executables, have a look at the <a href="https://oreil.ly/QWz7i"><span class="calibre_7">xlwings docs</span></a>. Note that frozen executables will not work when you use xlwings for user-defined functions, the functionality that I will introduce in <a href="index_split_028.html#filepos1653100"><span class="calibre_7">Chapter 12</span></a>.</blockquote><a id="filepos1475043"/></blockquote><p class="calibre_16">While <a id="filepos1475110"/>Python is a hard requirement, the installation of the xlwings add-in is not, as I will explain next.</p><p id="filepos1475221" class="calibre_17"><span class="calibre3"><span class="bold">Standalone Workbooks: Getting Rid of the xlwings Add-in</span></span></p><p class="calibre_6">In this <a id="filepos1475399"/>chapter, we have always relied on the xlwings add-in to call Python code either by clicking the Run main button or by using the <tt class="calibre6">RunPython</tt> function. Even if the xlwings CLI makes it easy to install the add-in, it may still be a hassle for less technical users who don’t feel comfortable using the Anaconda Prompt. Also, since the xlwings add-in and the xlwings Python package need to have the same version, you may run into a conflict where your recipients already have the xlwings add-in installed, but with a different version than your tool requires. There is a simple solution, though: xlwings doesn’t require the Excel add-in and can be set up as a <span class="italic">standalone workbook</span> instead. In this case, the VBA code of the add-in is stored directly in your workbook. As usual, the easiest way to get everything set up is by using the <tt class="calibre6">quickstart</tt> command, this time with the <tt class="calibre6">--standalone</tt> flag:</p><blockquote class="calibre_31"><span class="calibre5"><tt class="calibre6"><br class="calibre1"/>(base)&gt; </tt></span><span class="calibre5"><tt class="calibre6"><span class="bold">xlwings quickstart second_project --standalone</span></tt></span><span class="calibre5"><tt class="calibre6"><br class="calibre1"/></tt></span></blockquote><p class="calibre_32">When you open the generated <span class="italic">second_project.xlsm</span> workbook in Excel and press Alt+F11 (Windows) or Option-F11 (macOS), you will see the <tt class="calibre6">xlwings</tt> module and the <tt class="calibre6">Dictionary</tt> class module that are required in place of the add-in. Most importantly, a standalone project must not have a reference to xlwings anymore. While this is configured automatically when using the <tt class="calibre6">--standalone</tt> flag, it is important that you remove the reference in case you want to convert an existing workbook: go to Tools &gt; References in your VBA editor and clear the checkbox for <tt class="calibre6">xlwings</tt>.</p><blockquote class="calibre_25"><span class="bold"><span class="calibre_26">BUILDING A CUSTOM ADD-IN</span></span></blockquote><blockquote class="calibre_27"><span class="calibre5">While this section shows you how to get rid of the dependency of the xlwings add-in, you may sometimes want to build your own add-in for deployment. This makes sense if you want to use the same macros with many different workbooks. You will find instructions on how to build your own custom add-in in the </span><a id="filepos1477721"/><a href="https://oreil.ly/hFvlj"><span class="calibre5"><span class="calibre_7">xlwings docs</span></span></a><span class="calibre5">.</span></blockquote><p class="calibre_16">Having touched <a id="filepos1477920"/>upon Python and the add-in, let’s now have a more in-depth look at how the xlwings configuration works.</p><p id="filepos1478036" class="calibre_17"><span class="calibre3"><span class="bold">Configuration Hierarchy</span></span></p><p class="calibre_6">As mentioned at<a id="filepos1478189"/> the beginning of this chapter, the ribbon stores its configuration in the user’s home directory, under <span class="italic">.xlwings\xlwings.conf</span>. The <span class="italic">configuration</span> consists of individual <span class="italic">settings</span>, like the <tt class="calibre6">PYTHONPATH</tt> that we already saw at the beginning of this chapter. The settings you set in your add-in can be overridden on the directory and workbook level—xlwings looks for settings in the following locations and order:</p><p class="calibre_6"><span class="italic">Workbook configuration</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">First, xlwings looks for a sheet called <span class="italic">xlwings.conf</span>. This is the recommended way to configure your workbook for deployment as you don’t have to handle an additional config file. When you run the <tt class="calibre6">quickstart</tt> command, it will create a sample configuration on a sheet called “_xlwings.conf”: remove the leading underscore in the name to activate it. If you don’t want to use it, feel free to delete the sheet.</blockquote></blockquote><p class="calibre_20"><span class="italic">Directory configuration</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">Next, xlwings looks for a file called <span class="italic">xlwings.conf</span> in the same directory as your Excel workbook.</blockquote></blockquote><p class="calibre_20"><span class="italic">User configuration</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">Finally, xlwings looks for a file called <span class="italic">xlwings.conf</span> in the <span class="italic">.xlwings</span> folder in the user’s home directory. Normally, you don’t edit this file directly—instead, it is created and edited by the add-in whenever you change a setting.</blockquote></blockquote><p class="calibre_16">If xlwings doesn’t find any settings in these three locations, it falls back to default values.</p><p class="calibre_6">When you edit the settings via the Excel add-in, it will automatically edit the <span class="italic">xlwings.conf</span> file. If you want to edit the file directly, look up the exact format and available settings by going to the <a href="https://oreil.ly/U9JTY"><span class="calibre_7">xlwings docs</span></a>, but I’ll point out the most helpful settings in the context of deployment next.</p><p id="filepos1480462" class="calibre_17"><span class="calibre3"><span class="bold">Settings</span></span></p><p class="calibre_6">The most<a id="filepos1480593"/> critical setting is certainly the Python interpreter—if your Excel tool can’t find the correct Python interpreter, nothing will work. The <tt class="calibre6">PYTHONPATH</tt> setting allows you to control where you place your Python source files, and the Use UDF Server setting keeps the Python interpreter running in between calls on Windows, which can greatly improve performance.</p><p class="calibre_6"><span class="italic">Python Interpreter</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">xlwings relies on a locally installed Python installation. This, however, doesn’t necessarily mean that the recipient of your xlwings tool needs to mess around with the configuration before they can use the tool. As mentioned previously, you could tell them to install the Anaconda distribution with the default settings, which will install it in the user’s home directory. If you use <span class="italic">environment variables</span> in your configuration, xlwings will find the correct path to the Python interpreter. An environment variable is a variable set on the user’s computer that allows programs to query information specific to this environment, like the name of the current user’s home folder. As an example, on Windows, set the <tt class="calibre6">Conda Path</tt> to <tt class="calibre6">%USERPROFILE%\anaconda3</tt> and on macOS, set <tt class="calibre6">Interpreter_Mac</tt> to <tt class="calibre6">$HOME/opt/anaconda3/bin/python</tt>. These paths will then dynamically resolve to Anaconda’s default installation path.</blockquote><a id="filepos1482074"/></blockquote><p class="calibre_20"><span class="italic">PYTHONPATH</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">By default, xlwings looks for the Python source file in the same directory as the Excel file. This may not be ideal when you give your tool to users who aren’t familiar with Python as they could forget to keep the two files together when moving the Excel file around. Instead, you can put your Python source files in a dedicated folder (this could be on a shared drive) and add this folder to the <tt class="calibre6">PYTHONPATH</tt> setting. Alternatively, you could also place your source files on a path that is already part of the Python module search path. One way to achieve this would be to distribute your source code as a Python package—installing it will place it in Python’s <span class="italic">site-packages</span> directory, where Python will find your code. For more information on how to build a Python package, see the <a href="https://oreil.ly/_kJoj"><span class="calibre_7">Python Packaging User Guide</span></a>.</blockquote><a id="filepos1483129"/></blockquote><p class="calibre_20"><span class="italic">RunPython: Use UDF Server (Windows only)</span></p><blockquote class="calibre_18"><blockquote class="calibre_19">You may have noticed that a <tt class="calibre6">RunPython</tt> call can be rather slow. This is because xlwings starts a Python interpreter, runs the Python code, and finally shuts the interpreter down again. This may not be so bad during development, as it makes sure that all modules are loaded from scratch every time you call the <tt class="calibre6">RunPython</tt> command. Once your code is stable, though, you might want to activate the checkbox “RunPython: Use UDF Server” that is only available on Windows. This will use the same Python server as the user-defined functions use (the topic of <a href="index_split_028.html#filepos1653100"><span class="calibre_7">Chapter 12</span></a>) and keep the Python session running in between calls, which will be much faster. Note, however, that you need to click the Restart UDF Server button in the ribbon after code changes.</blockquote><a id="filepos1484138"/></blockquote><blockquote class="calibre_25"><span class="bold">XLWINGS PRO</span></blockquote><blockquote class="calibre_27">While <a id="filepos1484297"/>this book makes use of only the free and open source version of xlwings, there is also a commercial PRO package available to fund the continued maintenance and development of the open source package. Some of the additional functionality that xlwings PRO offers are:</blockquote><div class="calibre_8"> </div><ul class="calibre_9"><li value="1" class="calibre_13"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Python code can be embedded in Excel, thereby getting rid of external source files.</blockquote></blockquote></blockquote></blockquote></li><li value="2" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">The reports package allows you to turn your workbooks into templates with placeholders. This gives nontechnical users the power to edit the template without having to change the Python code.</blockquote></blockquote></blockquote></blockquote></li><li value="3" class="calibre_10"><blockquote class="calibre_18"><blockquote class="calibre4"><blockquote class="calibre4"><blockquote class="calibre_19">Installers can be built easily to get rid of any deployment headaches: end users can install Python including all dependencies with a single click, giving them the feeling of dealing with normal Excel workbooks without having to manually configure anything.</blockquote></blockquote></blockquote></blockquote></li></ul><blockquote class="calibre_105">For further details about xlwings PRO and to request a trial license, see the <a href="https://oreil.ly/QEuoo"><span class="calibre_7">xlwings home page</span></a>.</blockquote><p id="filepos1485980" class="calibre_16"><span class="calibre3"><span class="bold"><span class="calibre_7">Conclusion</span></span></span></p><p class="calibre_6">This chapter started by showing you how easy it is to run Python code from Excel: with Anaconda installed, you only need to run <tt class="calibre6">xlwings addin install</tt> followed by <tt class="calibre6">xlwings quickstart myproject</tt>, and you are ready to click the Run main button in the xlwings add-in or use the <tt class="calibre6">RunPython</tt> VBA function. The second part introduced a few settings that make it easier to deploy your xlwings tool to your end users. The fact that xlwings comes preinstalled with Anaconda helps a lot in lowering the entry barriers for new users.</p><p class="calibre_6">In this chapter, we were merely using the Hello World example to learn how everything works. The next chapter takes these foundations to build the Python Package Tracker, a full-fledged business application.</p><blockquote id="filepos1486934" class="calibre_33"><a href="#filepos1446851"><span class="calibre5"><span class="calibre_7">1  </span></span></a><span class="calibre5"> If you are on macOS or using a Python distribution other than Anaconda, it will configure the Interpreter rather than the Conda settings.</span></blockquote><div class="mbp_pagebreak" id="calibre_pb_21"/>
</body></html>