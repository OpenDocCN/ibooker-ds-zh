<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 12. Mediation and Instrumental Variables"><div class="chapter" id="mediation_and_instrumental_variables">
<h1><span class="label">Chapter 12. </span>Mediation and Instrumental Variables</h1>

<p>In the last chapter, we saw that moderation allows us to open the black box of a causal relationship by revealing groups for which that relationship is stronger or weaker.<a contenteditable="false" data-primary="mediation" data-secondary="about" data-type="indexterm" id="idm45968142367272"/><a contenteditable="false" data-primary="variables" data-secondary="mediation definition" data-type="indexterm" id="idm45968142365896"/><a contenteditable="false" data-primary="causes" data-secondary="mediation" data-type="indexterm" id="idm45968142364520"/><a contenteditable="false" data-primary="causal-behavioral framework" data-secondary="mediation bridging" data-type="indexterm" id="idm45968142363144"/> <em>Mediation</em> refers to the presence of an intermediary variable between two variables in a chain; it offers a different way to probe that black box by understanding the causal mechanism at play—the “how” of the causal effect.</p>

<p>This has several benefits on both the causal and behavioral sides of our framework. <a contenteditable="false" data-primary="false positive probability" data-secondary="mediation reducing" data-type="indexterm" id="idm45968142360568"/><a contenteditable="false" data-primary="biases in data and analyses" data-secondary="mediation" data-tertiary="mediation unaccounted for" data-type="indexterm" id="idm45968142359224"/><a contenteditable="false" data-primary="chains in causal diagrams" data-secondary="mediation as expanding chains" data-seealso="mediation" data-type="indexterm" id="idm45968142357640"/><a contenteditable="false" data-primary="mediation" data-secondary="biases in data and analyses" data-tertiary="mediation unaccounted for" data-type="indexterm" id="idm45968142356056"/>From a causal perspective, mediation reduces the risk of false positives, and not accounting adequately for it can bias our analyses. From a behavioral perspective, mediation helps us better design and understand experiments. In a sense, mediation is nothing new, and most of the arguments in this chapter could have been summarized as “expand the chains in your CDs as much as you can, at least at the beginning.” But I believe such a simplification would have been a disservice to you, because the search for mediators is at the root of many scientific discoveries. “But why?” is one of the best follow-up questions after confirming the causal relationship between two variables. Customer satisfaction increases retention, <em>but why</em>? Is it because it reduces the probability of looking for alternatives or because it increases the customer’s opinion of the company?</p>

<p>Mediation also offers a nice stepping stone for the last tool we’ll see in this book,<a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="about" data-type="indexterm" id="idm45968142493528"/><a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="about" data-type="indexterm" id="idm45968142491880"/><a contenteditable="false" data-primary="variables" data-secondary="instrumental variables described" data-type="indexterm" id="idm45968142490536"/><a contenteditable="false" data-primary="mediation" data-secondary="about instrumental variables" data-type="indexterm" id="idm45968142489192"/><a contenteditable="false" data-primary="customer behavior" data-secondary="about instrumental variables" data-type="indexterm" id="idm45968142487848"/> instrumental variables (IVs). IVs, which are like mediation on steroids, allow us to answer questions that would otherwise be intractable. As promised at the beginning of the book, we’ll obtain an unbiased estimate of the effect of customer satisfaction on later purchasing behavior, and IVs make that possible.</p>

<p>In the next section, I’ll introduce you to mediation in the context of the <a contenteditable="false" data-primary="C-Mart fictional supermarket chain" data-secondary="mediation" data-tertiary="about" data-type="indexterm" id="idm45968142485624"/>C-Mart store play areas example from <a data-type="xref" href="ch11.xhtml#introduction_to_moderation">Chapter 11</a> and show you how mediation can make a causal-behavioral analysis more effective. Then in the second section, we’ll get to the grand finale: instrumental variables.</p>

<section data-type="sect1" data-pdf-bookmark="Mediation"><div class="sect1" id="mediation">
<h1>Mediation</h1>

<p>Let’s continue with the C-Mart example from the previous<a contenteditable="false" data-primary="C-Mart fictional supermarket chain" data-secondary="mediation" data-tertiary="business problem" data-type="indexterm" id="idm45968142480680"/><a contenteditable="false" data-primary="mediation" data-secondary="business problem" data-type="indexterm" id="idm45968142479064"/> chapter and assume that C-Mart is now interested in measuring the effect of the play areas on grocery purchases (<a data-type="xref" href="#our_relationship_of_interest">Figure 12-1</a>).</p>

<figure><div id="our_relationship_of_interest" class="figure"><img alt="Our relationship of interest" src="Images/BEDA_1201.png" width="707" height="139"/>
<h6><span class="label">Figure 12-1. </span>Our relationship of interest</h6>
</div></figure>

<p>Based on prior analyses, the management of C-Mart believes that visit duration is a key causal mechanism in this relationship. That is, they believe that <em>PlayArea</em> causes <em>VisitDuration</em>, which itself causes <em>GroceryPurchases</em>. Obviously, we could disregard that hypothesis and analyze the relationship displayed in <a data-type="xref" href="#our_relationship_of_interest">Figure 12-1</a> directly by building the corresponding regression, CIs, etc. However, we’re going to confirm and measure that causal mechanism, because taking it into account has several benefits:</p>

<ul>
	<li>
	<p>Mediation allows us to understand the mechanisms at play and generate actionable insights.</p>
	</li>
	<li>
	<p>In certain circumstances, not accounting for mediation could bias a causal <span class="keep-together">estimate.</span></p>
	</li>
</ul>

<p>Let’s review these benefits in more detail in the next two subsections, and then I’ll get into the technical considerations of measuring mediation.</p>

<section data-type="sect2" data-pdf-bookmark="Understanding Causal Mechanisms"><div class="sect2" id="understanding_causal_mechanisms">
<h2>Understanding Causal Mechanisms</h2>

<p>The first benefit of identifying and measuring mediation<a contenteditable="false" data-primary="mediation" data-secondary="causal mechanisms explained" data-type="indexterm" id="idm45968142466328"/><a contenteditable="false" data-primary="causes" data-secondary="mediation" data-tertiary="causal mechanisms explained" data-type="indexterm" id="idm45968142464984"/><a contenteditable="false" data-primary="correlation" data-secondary="causation implied" data-tertiary="causal mechanisms explained" data-type="indexterm" id="idm45968142463368"/><a contenteditable="false" data-primary="causes" data-secondary="correlation implying causation" data-tertiary="causal mechanisms explained" data-type="indexterm" id="idm45968142461752"/><a contenteditable="false" data-primary="causes" data-secondary="correlation implying causation" data-tertiary="mediation" data-type="indexterm" id="idm45968142460168"/><a contenteditable="false" data-primary="correlation" data-secondary="causation implied" data-tertiary="mediation" data-type="indexterm" id="idm45968142458552"/> is that it provides an explanation of the causal mechanism at hand. Correlation is still not (always) causation, but understanding what’s actually happening from a behavioral perspective is a strong safeguard against spurious correlations. If you have two variables that are correlated but you’re unsure whether that correlation is causal, finding and validating a mediator between them offers very strong evidence that the relationship is causal. At that point, the most likely source of error would be reverse causality—the causality flows in the opposite direction. (The alternative is that each of the three variables just happens to have a spurious correlation with the other two; that’s three spurious correlations from random chance instead of one, which is a highly improbable event.)</p>

<p>Mediation is also a very effective <a contenteditable="false" data-primary="moderation analysis" data-secondary="mediation a complement to" data-type="indexterm" id="idm45968142455544"/><a contenteditable="false" data-primary="mediation" data-secondary="moderation complement" data-type="indexterm" id="idm45968142453768"/><a contenteditable="false" data-primary="moderation analysis" data-secondary="applying" data-tertiary="experimental design stage" data-type="indexterm" id="idm45968142452392"/><a contenteditable="false" data-primary="moderation analysis" data-secondary="applying" data-tertiary="data analysis stage" data-type="indexterm" id="idm45968142450728"/><a contenteditable="false" data-primary="C-Mart fictional supermarket chain" data-secondary="mediation" data-tertiary="moderation complement" data-type="indexterm" id="idm45968142449080"/>complement to moderation, in both the discovery and the design phases. In the discovery phase (what I referred to as the “fishing expedition” in the previous chapter), identifying likely mediators can help the brainstorming process. Even if a mediator is not observable (e.g., a belief or emotion), simply considering it might lead you to a measurable moderator and provide a rationale for it. We saw in <a data-type="xref" href="ch11.xhtml#introduction_to_moderation">Chapter 11</a> that the relationship between <em>PlayArea</em> and <em>GroceryPurchases</em> is moderated by <em>Children</em>, something that makes immediate and intuitive sense. However, recognizing that this relationship is mediated by <em>VisitDuration</em> can give us clues to other possible moderators. For example, if the mediation is complete, the overall effect is likely to be weaker for visits near the closing time, something that would not be immediately apparent if we disregarded the role of <em>VisitDuration</em> (<a data-type="xref" href="#the_relationship_between_playarea_and_g">Figure 12-2</a>).</p>

<figure><div id="the_relationship_between_playarea_and_g" class="figure"><img alt="The relationship between PlayArea and GroceryPurchases" src="Images/BEDA_1202.png" width="1128" height="357"/>
<h6><span class="label">Figure 12-2. </span>The relationship between PlayArea and GroceryPurchases</h6>
</div></figure>

<p>We could probe that hypothesis by checking whether the effect of <em>PlayArea</em> on <em>GroceryPurchases</em> is weaker for visits that start near the closing time, which would provide further information about the nature of the effect.</p>

<p>Mediation can also be helpful for designing or improving business processes and messages. Too often, segmentation exercises end up with “segment A shows a stronger effect than segment B.” This is only useful in better targeting preexisting treatments, such as marketing campaigns. Understanding the mechanism through which the moderation acts provides us with useful insights for ideation. Having confirmed that the moderating effect of <em>Children</em> on <em>PlayArea</em> is mediated by <em>VisitDuration</em>, we could lean into it by offering a perk, like extra parking validation or a snack station near the play area. We could also replace the play areas with (potentially cheaper) mini-cinemas showing cartoons.</p>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Causal Biases"><div class="sect2" id="causal_biases">
<h2>Causal Biases</h2>

<p>Mediation is not just a “nice to have” tool.<a contenteditable="false" data-primary="mediation" data-secondary="biases in data and analyses" data-tertiary="causal biases" data-type="indexterm" id="idm45968142435016"/><a contenteditable="false" data-primary="biases in data and analyses" data-secondary="mediation" data-tertiary="causal biases" data-type="indexterm" id="idm45968142433352"/><a contenteditable="false" data-primary="C-Mart fictional supermarket chain" data-secondary="mediation" data-tertiary="causal biases" data-type="indexterm" id="idm45968142431688"/> In some circumstances, not accounting for it can introduce biases in our causal estimates.</p>

<p>The simplest case where this occurs is when we’re trying to measure the (total) effect of one variable on another, but we unwittingly include a mediator in our regression as a control variable. Let’s assume that we’ve measured the effect of having a play area on grocery purchases at the individual level, in line with the recommendations from <a data-type="xref" href="ch02.xhtml#understanding_behavioral_data">Chapter 2</a>. It is conceivable that a play area not only affects the visit duration of <span class="keep-together">customers</span> who would have come regardless but also draws new customers. To account for this causal path, we need to recast our CD at the store level (<a data-type="xref" href="#cd_recast_at_the_store_level">Figure 12-3</a>).</p>

<figure><div id="cd_recast_at_the_store_level" class="figure"><img alt="CD recast at the store level" src="Images/BEDA_1203.png" width="1052" height="311"/>
<h6><span class="label">Figure 12-3. </span>CD recast at the store level</h6>
</div></figure>

<p>Note that while average grocery purchases at the customer level are fully mediated by average visit duration, this is not the case for total grocery sales at the store level. The level at which you measure behaviors matters!</p>

<p>In <a data-type="xref" href="#cd_recast_at_the_store_level">Figure 12-3</a>, it is clear that <em>CustomersNumber</em> is a mediator of the effect of <em>PlayArea</em> on <em>GrocerySales</em>. However, we can easily imagine that someone investigating that effect would decide to include <em>CustomersNumber</em> as a control variable in that regression: <em>GrocerySales</em> = <em>β<sub>p</sub>.PlayArea</em> + <em>β<sub>c</sub>.CustomersNumber</em>. After all, the size of a store’s customer base certainly affects its total grocery sales, and it may have impacted the selection of stores where play areas would be built (<a data-type="xref" href="#the_storeapostrophes_customer_base_is_a">Figure 12-4</a>).</p>

<figure><div id="the_storeapostrophes_customer_base_is_a" class="figure"><img alt="The store’s customer base is a confounder" src="Images/BEDA_1204.png" width="1052" height="524"/>
<h6><span class="label">Figure 12-4. </span>The store’s customer base is a confounder</h6>
</div></figure>

<p><a data-type="xref" href="#the_storeapostrophes_customer_base_is_a">Figure 12-4</a> presents a causal conundrum: the store’s customer base, measured by the number of potential customers who are within shopping distance of the store, may be a confounder of the relationship between <em>PlayArea</em> and <em>GrocerySales</em>. But at the same time, <em>CustomersNumber</em> is a mediator of that relationship. This situation calls for thoughtful controlling of the relevant regressions—that is, all the regressions where the dependent variable is <em>CustomersNumber</em> or <em>GrocerySales</em>.</p>

<p>This can be achieved by adding to these regressions thoughtful control variables. For instance, the number of customers one year before installing the play area is a good proxy for the customer base and by definition doesn’t capture any of the effects of installing a play area. Alternatively, we could choose another proxy such as a <em>Rural/Urban</em> categorical <span class="keep-together">variable.</span></p>

<p>Once again, this illustrates the dangers of the “everything and the kitchen sink” approach to variable inclusion: just because the current number of customers is available and relevant to our situation doesn’t mean that it should automatically be included as a control.</p>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Identifying Mediation"><div class="sect2" id="identifying_mediation">
<h2>Identifying Mediation</h2>

<p>When I introduced the building blocks of CDs <a contenteditable="false" data-primary="mediation" data-secondary="identifying mediation" data-type="indexterm" id="idm45968142407000"/><a contenteditable="false" data-primary="mediation" data-secondary="about" data-type="indexterm" id="idm45968142405624"/>in <a data-type="xref" href="ch03.xhtml#introduction_to_causal_diagrams">Chapter 3</a>, I mentioned that a <em>mediator</em> is a variable between two other variables in a chain, as in <a data-type="xref" href="#the_effect_of_having_a_play_area_on_gro">Figure 12-5</a>.</p>

<figure><div id="the_effect_of_having_a_play_area_on_gro" class="figure"><img alt="The effect of having a play area on grocery purchases is mediated by the duration of the visit" src="Images/BEDA_1205.png" width="1053" height="139"/>
<h6><span class="label">Figure 12-5. </span>The effect of having a play area on grocery purchases is mediated by the duration of the visit</h6>
</div></figure>

<p><em>VisitDuration</em> is an effect of <em>PlayArea</em>, and a cause of <em>GroceryPurchases</em>. As such, it is the mediator of the effect of <em>PlayArea</em> on <em>GroceryPurchases</em> in this CD.</p>

<p>Assuming that the CD in <a data-type="xref" href="#the_effect_of_having_a_play_area_on_gro">Figure 12-5</a> gives us the whole story, <em>PlayArea</em> has no effect on <em>GroceryPurchases</em> apart from the path through <em>VisitDuration</em>; changing <em>PlayArea</em> while holding <em>VisitDuration</em> constant would not change <em>GroceryPurchases</em>. The effect of <em>PlayArea</em> on <em>GroceryPurchases</em> is said to be “completely” or “fully” mediated. Alternatively, we could imagine a situation where <em>PlayArea</em> also has a direct effect on <em>GroceryPurchases</em>, apart from the <em>VisitDuration</em> path (<a data-type="xref" href="#partial_mediation">Figure 12-6</a>).</p>

<figure><div id="partial_mediation" class="figure"><img alt="Partial mediation" src="Images/BEDA_1206.png" width="1053" height="258"/>
<h6><span class="label">Figure 12-6. </span>Partial mediation</h6>
</div></figure>

<p class="pagebreak-before less_space">This is called “partial” mediation. <em>VisitDuration</em> is still a mediator, even if it doesn’t account for the total effect of <em>PlayArea</em> on <em>GroceryPurchases</em>. The direct effect from <em>PlayArea</em> to <em>GroceryPurchases</em> may be truly direct—there is no intermediary variable involved—or it may represent one or several other mediators we don’t know of or are not interested in analyzing (in which case we have collapsed the corresponding chain or chains).</p>

<p>Like the search for potential moderators, the search for mediators is a trial-and-error fishing expedition, but the scope of the search (and therefore the risk of false positives) is much more limited. Since a potential mediator should be investigated only if there is a strong behavioral rationale for it, the number of candidates is considerably restricted. In addition, confirming a mediator involves several regressions, which also reduces the risk of false positives.</p>

<p>Given the benefits of accounting for mediators and the risks of not doing so, you should always include relevant mediators in your analysis, at least as a first step. Once you have identified which chains you’re going to analyze and which you’re going to disregard, you can safely collapse the latter ones (e.g., mediators between variables that play only a secondary role in your analysis).</p>

<p>As with moderators, the search process entails finding a potential candidate and then validating it through a Bootstrap confidence interval. In our example, <em>VisitDuration</em> is an obvious candidate, so let’s see how we can confirm and measure its mediation role.</p>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Measuring Mediation"><div class="sect2" id="measuring_mediation">
<h2>Measuring Mediation</h2>

<p>Measuring mediation is straightforward but a bit cumbersome.<a contenteditable="false" data-primary="mediation" data-secondary="measuring mediation" data-tertiary="about" data-type="indexterm" id="idm45968142148808"/> It boils down to running several regressions to estimate the following:</p>

<ul>
	<li>
	<p>The total effect of <em>PlayArea</em> on <em>GroceryPurchases</em></p>
	</li>
	<li>
	<p>The effect of <em>PlayArea</em> on <em>GroceryPurchases</em> that is mediated by <em>VisitDuration</em>, a.k.a. the indirect effect</p>
	</li>
	<li>
	<p>The effect of <em>PlayArea</em> on <em>GroceryPurchases</em> that is not mediated by <em>VisitDuration</em>, a.k.a. the direct effect</p>
	</li>
</ul>

<p>If we find no evidence for the indirect, mediated path, we should reject our tentative mediator. Conversely, if we find no evidence for the direct path, then the effect is fully mediated. The <em>percentage of total effect mediated</em> is a common and useful way to summarize that evidence. We’ll wrap up the section by considering the special case in which the mediator is a binary variable.</p>

<section data-type="sect3" data-pdf-bookmark="Total effect"><div class="sect3" id="total_effect">
<h3>Total effect</h3>

<p>We first determine the total effect by running a <a contenteditable="false" data-primary="mediation" data-secondary="measuring mediation" data-tertiary="total effect" data-type="indexterm" id="idm45968142138696"/>regression of <em>GroceryPurchases</em> on <em>PlayArea</em> (without including <em>VisitDuration</em>):</p>

<pre data-code-language="r" data-type="programlisting">
<code class="c1">## R (output not shown)</code>
<code class="nf">summary</code><code class="p">(</code><code class="nf">lm</code><code class="p">(</code><code class="n">grocery_purchases</code><code class="o">~</code><code class="n">play_area</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">hist_data</code><code class="p">))</code></pre>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python</code>
<code class="n">ols</code><code class="p">(</code><code class="s2">"grocery_purchases~play_area"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">hist_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">()</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>
<code class="o">...</code>
          <code class="n">coef</code>       <code class="n">std</code> <code class="n">err</code>    <code class="n">t</code>           <code class="n">P</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code>   <code class="p">[</code><code class="mf">0.025</code>  <code class="mf">0.975</code><code class="p">]</code>
<code class="n">Intercept</code> <code class="mf">49.1421</code>    <code class="mf">0.047</code>      <code class="mf">1036.494</code>    <code class="mf">0.000</code>   <code class="mf">49.049</code>  <code class="mf">49.235</code>
<code class="n">play_area</code> <code class="mf">27.6200</code>    <code class="mf">0.079</code>      <code class="mf">349.485</code>     <code class="mf">0.000</code>   <code class="mf">27.465</code>  <code class="mf">27.775</code>
<code class="o">...</code></pre>

<p>The total effect is approximately 27.6, meaning that adding a play area increases the amount spent on groceries by $27.6 on average, <em>not holding the visit duration constant</em>.</p>
</div></section>

<section data-type="sect3" data-pdf-bookmark="Mediated effect"><div class="sect3" id="mediated_effect">
<h3>Mediated effect</h3>

<p>The effect of <em>PlayArea</em> on <em>GroceryPurchases</em> <a contenteditable="false" data-primary="mediation" data-secondary="measuring mediation" data-tertiary="mediated effect" data-type="indexterm" id="idm45968142052248"/>mediated by <em>VisitDuration</em> can be obtained by multiplying together the effect of <em>PlayArea</em> on <em>VisitDuration</em> and the effect of <em>VisitDuration</em> on <em>GroceryPurchases</em>. This makes intuitive sense: if a play area increases the average duration of a visit by X minutes and each additional minute of visit duration increases the amount spent on groceries by $Y, then adding a play area increases the amount spent on groceries by $X * Y.</p>

<p>The first regression is for the arrow between <em>PlayArea</em> and <em>VisitDuration</em>. It yields a coefficient of about 12.6 (having a play area adds about 12.6 minutes to the average visit duration):</p>

<pre data-code-language="r" data-type="programlisting">
<code class="c1">## R (output not shown)</code>
<code class="nf">summary</code><code class="p">(</code><code class="nf">lm</code><code class="p">(</code><code class="n">duration</code><code class="o">~</code><code class="n">play_area</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">hist_data</code><code class="p">))</code></pre>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python</code>
<code class="n">ols</code><code class="p">(</code><code class="s2">"duration~play_area"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">hist_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">()</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>
<code class="o">...</code>
    <code class="n">coef</code>  <code class="n">std</code> <code class="n">err</code>    <code class="n">t</code>    <code class="n">P</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code> <code class="p">[</code><code class="mf">0.025</code>      <code class="mf">0.975</code><code class="p">]</code>
<code class="n">Intercept</code> <code class="mf">23.8039</code>    <code class="mf">0.018</code> <code class="mf">1287.327</code>   <code class="mf">0.000</code>  <code class="mf">23.768</code>  <code class="mf">23.840</code>
<code class="n">play_area</code> <code class="mf">12.5570</code>    <code class="mf">0.031</code> <code class="mf">407.397</code>    <code class="mf">0.000</code>  <code class="mf">12.497</code>  <code class="mf">12.617</code>
<code class="o">...</code></pre>

<p>The second regression is for the arrow between <em>VisitDuration</em> and <em>GroceryPurchases</em>. However, I will also include <em>PlayArea</em> in this regression. Looking back at <a data-type="xref" href="#partial_mediation">Figure 12-6</a> and remembering the definition of a confounder, we can see that if the mediation is only partial (i.e., there is a direct arrow from <em>PlayArea</em> to <em>GroceryPurchases</em>), <em>PlayArea</em> is a confounder of the relationship between <em>VisitDuration</em> and <em>GroceryPurchases</em>. Therefore it must be included in the regression by default. Running a regression with our primary cause and our mediator as explanatory variables yields coefficients of, respectively, 0.16 (adding a play area adds about $0.16 to the average grocery purchase per visit, holding the visit duration constant) and 2.2 (adding one minute to visit duration adds about $2.20 to the average grocery purchases per visit):</p>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python (output not shown)</code>
<code class="n">ols</code><code class="p">(</code><code class="s2">"grocery_purchases~duration+play_area"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">hist_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">()</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code></pre>

<pre data-code-language="r" data-type="programlisting">
<code class="c1">## R</code>
<code class="nf">summary</code><code class="p">(</code><code class="nf">lm</code><code class="p">(</code><code class="n">grocery_purchases</code><code class="o">~</code><code class="n">duration</code><code class="o">+</code><code class="n">play_area</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">hist_data</code><code class="p">))</code>
<code class="kc">...</code>
<code class="n">Coefficients</code><code class="o">:</code>
             <code class="n">Estimate</code> <code class="n">Std.</code> <code class="n">Error</code>  <code class="n">t</code> <code class="n">value</code> <code class="nf">Pr</code><code class="p">(</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code><code class="p">)</code>    
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code> <code class="m">-2.917728</code>   <code class="m">0.047329</code>  <code class="m">-61.647</code>  <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">duration</code>     <code class="m">2.187025</code>   <code class="m">0.001695</code> <code class="m">1290.410</code>  <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">play_area1</code>   <code class="m">0.157477</code>   <code class="m">0.046419</code>    <code class="m">3.393</code> <code class="m">0.000693</code> <code class="o">***</code>
<code class="kc">...</code></pre>

<div data-type="note" epub:type="note"><h6>Note</h6>
<p>In this very simple example, these three are the only variables involved, but in real life you would have to also include any other variable with an arrow towards the dependent variable in each of your regressions.</p>
</div>

<p>I mentioned earlier that the primary cause should be included in the regression “by default.” Sometimes, however, the primary cause and the mediator may be so closely correlated that including both of them in a regression creates multicollinearity. This is generally caused by full mediation and is evidenced by suspiciously large coefficients in opposite directions (that is, the primary cause and the mediator mostly cancel each other out) with large p-values. In the worst cases, your analysis software may even give up and return an error message without finishing the regression. Whenever including the primary cause in the regression makes the coefficient for the mediator go haywire, do not include the primary cause.</p>

<p>Finally, you may also encounter more complex situations, such as two mediators with an extra arrow between them, that is, one of the mediators is also a cause of the other (<a data-type="xref" href="#one_of_the_mediators_affects_the_other">Figure 12-7</a>). This is not just a theoretical possibility; it actually happens from time to time, especially with behavioral data. Situations like that one defy shortcuts and you’ll need to remember what we learned in <a data-type="xref" href="part02.xhtml#causal_diagrams_and_deconfounding">Part II</a>: the backdoor criterion for deconfounding and other rules of CDs still apply and will let you know which variables you should and should not include in your regression.</p>

<figure><div id="one_of_the_mediators_affects_the_other" class="figure"><img alt="One of the mediators affects the other mediator" src="Images/BEDA_1207.png" width="1053" height="376"/>
<h6><span class="label">Figure 12-7. </span>One of the mediators affects the other mediator</h6>
</div></figure>

<p class="pagebreak-before less_space">The mediated effect is equal to the product of the two coefficients along the mediation chain (i.e., the coefficient of the regression of <em>VisitDuration</em> on <em>PlayArea</em>, and the coefficient of the regression of <em>GroceryPurchases</em> on <em>VisitDuration</em>):</p>

<div data-type="equation">
<p><em>MediatedEffect</em> ≈ 12.6 * 2.2 ≈ 27.5</p>
</div>

<p>From there, we can calculate the percentage of the total effect that is mediated:</p>

<div data-type="equation">
<p><em>PercentageMediated = MediatedEffect / TotalEffect ≈ 27.5 / 27.6 ≈ 99.5%</em></p>
</div>

<p>The Bootstrap 90%-CI for this percentage is approximately [0.9933; 0.9975].</p>
</div></section>

<section data-type="sect3" data-pdf-bookmark="Direct effect"><div class="sect3" id="direct_effect">
<h3>Direct effect</h3>

<p>The direct, unmediated effect is equal to the coefficient for<a contenteditable="false" data-primary="mediation" data-secondary="measuring mediation" data-tertiary="direct effect" data-type="indexterm" id="idm45968141787800"/> <em>PlayArea</em> in the regression of <em>GroceryPurchases</em> on <em>PlayArea</em> and <em>VisitDuration</em>: <em>UnmediatedEffect</em> ≈ 0.16. From there, we can calculate the percentage of the total effect that is unmediated:</p>

<div data-type="equation">
<p><em>PercentageUnmediated</em> = <em>UnmediatedEffect / TotalEffect</em> ≈ 0.16 / 27.6 ≈ 0.5%</p>
</div>

<p>In other words, the total effect is technically not fully mediated. For practical purposes, however, we can neglect the unmediated effect. Note that “unmediated effect” is always expressed in relation to a specific mediator. If you had two mediators that together completely mediated a total effect, the mediated effect of the first one would be equal to the unmediated effect of the second one and vice versa.</p>

<p>In situations where you encounter multicollinearity and are unable to include the primary cause in the regression as described earlier, the effect is most likely fully mediated. You can and should check that this is the case by calculating the percentage of the total effect that is unmediated as the residual of the mediated effect:</p>

<div data-type="equation">
<p><em>PercentageUnmediated</em> = (<em>TotalEffect - MediatedEffect</em>) / <em>TotalEffect</em></p>
</div>

<p>If you obtain an unmediated effect that is economically significant through that approach, this means you most likely have a more complex causal structure on your hands than you thought. Then it’s time to revisit your CD with a critical eye. Maybe your primary cause and your mediator share a further joint cause? Or could there be several mediators with interrelations between them?</p>

<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The mediator in this example was <a contenteditable="false" data-primary="correlation" data-secondary="causation implied" data-tertiary="mediation" data-type="indexterm" id="idm45968141776216"/>positively correlated with both its cause and its effect. Mediators can also have a negative effect if exactly one of the two coefficients along the chain is negative. If that happens, and there is another mediator or a direct effect between our cause and effect of interest, then the mediator will <em>reduce</em> the total effect. In that case, your first mediator could represent, say, −25% of the total effect while the direct effect (or another mediator) would represent 125% of the total effect, but the sum of the proportions of effects will still be 100%. This is perfectly normal and expected, so don’t let it trip you up.</p>

<p>If you find that confusing, you’re in good company. Social scientists debated for decades whether or not having a significant total effect should be a prerequisite to mediation analysis. But there are a variety of perfectly legitimate regulating or self-regulating phenomena where a mediator compensates for the direct effect. For example, C-Mart may find that its price changes do not affect its sales volume as expected because they cause corresponding price changes from its competitors.</p>
</div>
</div></section>

<section data-type="sect3" data-pdf-bookmark="When the mediator is a binary variable"><div class="sect3" id="when_the_mediator_is_a_binary_variable">
<h3>When the mediator is a binary variable</h3>

<p>The mediator in this example was a <a contenteditable="false" data-primary="mediation" data-secondary="measuring mediation" data-tertiary="binary variable mediator" data-type="indexterm" id="idm45968141770264"/><a contenteditable="false" data-primary="binary variables" data-secondary="mediator as" data-type="indexterm" id="idm45968141768552"/><a contenteditable="false" data-primary="numeric variables" data-secondary="mediator as" data-type="indexterm" id="idm45968141767176"/>numeric variable, so we could easily obtain the mediated effect by multiplying the coefficients for the two arrows involved. When the mediator is a binary variable, it is still possible to quantify mediation analytically, i.e., by using equations, but the formulas get more convoluted.</p>

<p>If we call the cause of interest <em>X</em>, the mediator <em>M</em>, and the effect of interest <em>Y</em>, the regression equations for the mediator and the final effect become:</p>

<div data-type="equation">
<p><em>P(M</em> = 1) = logistic(<em>α<sub>0</sub></em> + <em>α<sub>X</sub>.X</em>)</p>
</div>

<div data-type="equation">
<p><em>Y</em> = <em>β</em><sub>0</sub> + <em>β<sub>X</sub>.X</em> + <em>β<sub>M</sub>.M</em></p>
</div>

<p>Note that the first equation is now a logistic regression, as appropriate for a binary variable. Instead of predicting the value of M as with a linear regression, we now predict the probability that it will take the value 1, P(M = 1). We can substitute that probability in the second equation:</p>

<div data-type="equation">
<p><em>Y</em> = <em>β</em><sub>0</sub> + <em>β<sub>X</sub>.X</em> + <em>β<sub>M</sub>.P</em>(<em>M</em> = <em>1</em>)</p>
</div>

<p>The direct effect is still straightforward to calculate: if X increases by 1, the direct effect increases Y by <em>β<sub>X</sub></em>. But the indirect effect now presents an additional challenge because the impact of X on M is not linear. Therefore, the impact of X on M has to be determined <em>for a certain value of X</em>. This issue is similar to the one we encountered with moderation in <a data-type="xref" href="ch11.xhtml#introduction_to_moderation">Chapter 11</a>, and the possible solutions are the same:</p>

<ul>
	<li>
	<p>Define a global reference point, such as the average value of X in our data.</p>
	</li>
	<li>
	<p>Or calculate the mediated effect and percentage mediated for each row in our data and then calculate their respective averages.</p>
	</li>
</ul>

<p>As was the case in <a data-type="xref" href="ch11.xhtml#introduction_to_moderation">Chapter 11</a>, I recommend the second approach, modified as needed to fit the business decision at hand.</p>
</div></section>
</div></section>
</div></section>

<section data-type="sect1" data-pdf-bookmark="Instrumental Variables"><div class="sect1" id="instrumental_variables">
<h1>Instrumental Variables</h1>

<p>Mediation represents a great addition to the behavioral data<a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="about" data-type="indexterm" id="idm45968141724152"/><a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="about" data-type="indexterm" id="idm45968141722824"/><a contenteditable="false" data-primary="variables" data-secondary="instrumental variables described" data-type="indexterm" id="idm45968141721176"/> analysis toolbox in itself, but it’s also a stepping stone to another powerful tool called instrumental variables (IVs). In a nutshell, IVs leverage a known mediation relationship to reduce confounding biases in our coefficients.</p>

<p>One of the most powerful use cases is to use an experiment to answer a broader, and often harder, question. I’ll illustrate this application with an example involving customer satisfaction, one of the most watched business metrics, but also admittedly one of the hardest to measure.</p>

<p>As first mentioned in <a data-type="xref" href="ch02.xhtml#understanding_behavioral_data">Chapter 2</a>, <a contenteditable="false" data-primary="AirCnC (Air Coach and Couch)" data-secondary="customer satisfaction and purchasing" data-type="indexterm" id="idm45968141717000"/><a contenteditable="false" data-primary="customer satisfaction (CSAT)" data-secondary="measuring effect on future purchasing" data-tertiary="business problem" data-type="indexterm" id="idm45968141715560"/><a contenteditable="false" data-primary="business goals" data-secondary="measuring CSAT effect on future purchasing" data-type="indexterm" id="idm45968141713880"/>AirCnC’s leadership wants to know the impact of customer satisfaction (<em>CSAT</em>) on one of their key performance indicators, the amount spent during the six months following a booking (<em>M6Spend</em>). We’ll reuse the data from the experiment in <a data-type="xref" href="ch10.xhtml#cluster_randomization_and_hierarchical">Chapter 10</a> in which we explored the impact on customer satisfaction of a change in call center procedures: namely, “Instead of apologizing repeatedly when something went wrong, the call center reps should apologize at the beginning of the interaction, then get into ‘problem-solving mode,’ then end up offering several options to the customer.”</p>

<section data-type="sect2" data-pdf-bookmark="Data"><div class="sect2" id="data-id00021">
<h2>Data</h2>

<p>The <a href="https://oreil.ly/BehavioralDataAnalysisCh12">GitHub folder for this chapter</a> <a contenteditable="false" data-primary="customer satisfaction (CSAT)" data-secondary="measuring effect on future purchasing" data-tertiary="data for example" data-type="indexterm" id="idm45968141707400"/><a contenteditable="false" data-primary="C-Mart fictional supermarket chain" data-secondary="mediation" data-tertiary="data for example" data-type="indexterm" id="idm45968141705688"/><a contenteditable="false" data-primary="mediation" data-secondary="data for example" data-type="indexterm" id="idm45968141704024"/><a contenteditable="false" data-primary="GitHub" data-secondary="CSAT and future purchasing" data-type="indexterm" id="idm45968141702648"/>contains a copy of the experimental data from <a data-type="xref" href="ch10.xhtml#cluster_randomization_and_hierarchical">Chapter 10</a>. This time we’ll include the M6Spend variable in our analysis. <a data-type="xref" href="#variables_in_our_data-id00085">Table 12-1</a> outlines the variables in our data for this chapter.</p>

<table class="border" id="variables_in_our_data-id00085">
<caption><span class="label">Table 12-1. </span>Variables in our data</caption>
	<thead>
		<tr>
			<th> </th>
			<th>Variable description</th>
			<th>chap10-experimental_data.csv</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td><em>Center_ID</em></td>
			<td>Categorical variable for the 10 call centers</td>
			<td>✓</td>
		</tr>
		<tr>
			<td><em>Rep_ID</em></td>
			<td>Categorical variable for the 193 call center reps</td>
			<td>✓</td>
		</tr>
		<tr>
			<td><em>Age</em></td>
			<td>Age of customer calling, 20-60</td>
			<td>✓</td>
		</tr>
		<tr>
			<td><em>Reason</em></td>
			<td>Reason for call, “payment”/’property”</td>
			<td>✓</td>
		</tr>
		<tr>
			<td><em>Call_CSAT</em></td>
			<td>Customer satisfaction with call, 0-10</td>
			<td>✓</td>
		</tr>
		<tr>
			<td><em>Group</em></td>
			<td>Experimental assignment, “ctrl”/”treat”</td>
			<td>✓</td>
		</tr>
		<tr>
			<td><em>M6Spend</em></td>
			<td>Amount spent on bookings within 6 months of a booking</td>
			<td>✓</td>
		</tr>
	</tbody>
</table>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Packages"><div class="sect2" id="libraries-id00053">
<h2>Packages</h2>

<p>In this section, we’ll use the following specific packages for instrumental variables:<a contenteditable="false" data-primary="packages" data-secondary="instrumental variables" data-type="indexterm" id="idm45968141678968"/><a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="packages" data-type="indexterm" id="idm45968141677592"/><a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="packages" data-type="indexterm" id="idm45968141676152"/></p>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python</code>
<code class="kn">from</code> <code class="nn">linearmodels.iv</code> <code class="kn">import</code> <code class="n">IV2SLS</code></pre>

<pre data-code-language="r" data-type="programlisting">
<code class="c1">## R</code>
<code class="nf">library</code><code class="p">(</code><code class="n">ivreg</code><code class="p">)</code></pre>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Understanding and Applying IVs"><div class="sect2" id="understanding_and_applying_ivs">
<h2>Understanding and Applying IVs</h2>

<p>Once you’re familiar with CDs and mediation, <a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="understanding and applying" data-type="indexterm" id="idm45968141658456"/><a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="understanding and applying" data-type="indexterm" id="idm45968141656952"/>the idea behind IVs becomes reasonably simple to express:</p>

<blockquote>
<p>Let’s assume you have a fully mediated relationship between two variables, and the relationship between the mediator and the final variable is confounded. Then you can obtain an unbiased estimate for that relationship by dividing the coefficient for the total effect by the coefficient for the first arm of the mediation (i.e., the relationship between the first variable and the mediator).</p>
</blockquote>

<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="the_history_of_ivscomma_adotkdotadot_th">
<h5>The History of IVs, a.k.a. the Roots of Causal Diagrams</h5>

<p>Instrumental variables were invented<a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="causal diagram roots" data-type="indexterm" id="ch12-cdiv"/><a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="causal diagram roots" data-type="indexterm" id="ch12-cdiv2"/><a contenteditable="false" data-primary="causal diagrams (CDs)" data-secondary="instrumental variable roots" data-type="indexterm" id="ch12-cdiv3"/><a contenteditable="false" data-primary="Wright, Philip and Sewall" data-type="indexterm" id="idm45968141626296"/><a contenteditable="false" data-primary="Mostly Harmless Econometrics (Angrist and Pischke)" data-type="indexterm" id="idm45968141625176"/><a contenteditable="false" data-primary="econometrics text on instrumental variables" data-type="indexterm" id="idm45968141624040"/><a contenteditable="false" data-primary="Angrist, Joshua D." data-type="indexterm" id="idm45968141622904"/><a contenteditable="false" data-primary="Pischke, Jörn-Steffen" data-type="indexterm" id="idm45968141621800"/> by Philip and Sewall Wright, a father and son who were also among the inventors of path analysis, the precursor of causal diagrams. Sadly, that origin story was lost for decades, and IVs were used as a stand-alone tool by economists. For example, the authors of leading introductory books on econometrics, Angrist and Pischke (2009, 2014), present IVs without ever introducing causal diagrams (although they do mention the Wrights).</p>

<p>In my experience, using instrumental variables without CDs is a head-scratching, wall-staring exercise. You need to postulate a potential instrument seemingly out of thin air, and then justify the necessary assumptions through lengthy discussions. It can certainly be done, but it requires an implicit knowledge of the business or economic situation that comes only from experience and is hard to communicate. <span class="keep-together">Conversely,</span> as we’ll see here, if that knowledge is expressed in the form of a carefully crafted and iterated-upon CD, applying IVs is a matter of course.</p>
</div></aside>

<p class="pagebreak-before less_space">To see what this looks like in our example, let’s start by drawing the CD of our variables of interest. We want to measure the causal relationship between <em>CSAT</em> and <em>M6Spend</em>. It’s plausible that a high CSAT increases the amount spent on bookings in the following months, but the relationship is also subject to unmeasured confounders, including personality traits such as openness. Finally, we have data on our experimental treatment, which we know affects <em>CSAT</em> thanks to our experiment in <a data-type="xref" href="ch10.xhtml#cluster_randomization_and_hierarchical">Chapter 10</a> (<a data-type="xref" href="#the_cd_for_our_variables_of_interest">Figure 12-8</a>).</p>

<figure><div id="the_cd_for_our_variables_of_interest" class="figure"><img alt="The CD for our variables of interest" src="Images/BEDA_1208.png" width="1053" height="417"/>
<h6><span class="label">Figure 12-8. </span>The CD for our variables of interest</h6>
</div></figure>

<p>As you can see, in this CD, <em>CSAT</em> is a mediator between <em>Group</em> and <em>M6Spend</em>, but the relationship between <em>CSAT</em> and <em>M6Spend</em> is biased upward by the confounding effect of <em>Openness</em>.</p>

<p>In an ideal world, we would have data about the <em>Openness</em> variable and we would be able to run the two true regressions (<a data-type="xref" href="#12eqtn1">Equation 12-1</a> and <a data-type="xref" href="#12eqtn2">Equation 12-2</a>).</p>

<div data-type="equation" id="12eqtn1">
<h5><span class="label">Equation 12-1. </span> </h5>

<p><em>CSAT</em> = <em>β<sub>g</sub></em><sub>1</sub>.<em>Group</em> + <em>β</em><sub>o1</sub>.<em>Openness</em></p>
</div>

<div data-type="equation" id="12eqtn2">
<h5><span class="label">Equation 12-2. </span> </h5>

<p><em>M6Spend</em> = <em>β<sub>c</sub></em><sub>2</sub>.<em>CSAT</em> + <em>β<sub>o</sub></em><sub>2</sub>.<em>Openness</em></p>
</div>

<p>But even if we got data about Openness specifically (e.g., through a survey), how could we be sure that there isn’t another confounder lurking around the corner?</p>

<p>Taking a step back from the math for a second, this question takes us to the very heart of behavioral analytics: customer satisfaction is an essential criterion for success in business, but because it is so strongly influenced by a myriad of unobserved individual characteristics that impact individual behaviors, we can’t hope to identify and control for all of these characteristics. This issue can’t be resolved satisfactorily outside of a causal-behavioral framework, but it is straightforward to handle within it.</p>

<p class="pagebreak-before less_space">Back to the math—let’s go through the intuition laid out earlier:</p>

<ol>
	<li>
	<p>Calculate the coefficient for the leftmost relationship, between <em>Group</em> and <em>CSAT</em>.</p>
	</li>
	<li>
	<p>Calculate the coefficient for the total effect of <em>Group</em> on <em>M6Spend.</em></p>
	</li>
	<li>
	<p>Calculate the coefficient for the effect of <em>CSAT</em> on <em>M6Spend</em> by dividing the total effect from step 2 by the coefficient for the leftmost relationship from step 1.</p>
	</li>
</ol>

<section data-type="sect3" data-pdf-bookmark="Step 1: Leftmost relationship"><div class="sect3" id="step_one_leftmost_relationship">
<h3>Step 1: Leftmost relationship</h3>

<p>Because <em>Group</em> is a random assignment, uncorrelated with <em>Openness</em>, we can run the following regression instead of <a data-type="xref" href="#12eqtn1">Equation 12-1</a>:</p>

<div data-type="equation">
<p><em>CSAT</em> = <em>β<sub>g</sub></em><sub>1</sub>.<em>Group</em></p>
</div>

<p>Our estimate for <em>β<sub>g</sub></em><sub>1</sub> is unbiased and can be plugged as needed in <a data-type="xref" href="#12eqtn1">Equation 12-1</a>, because it is the true causal coefficient.</p>
</div></section>

<section data-type="sect3" data-pdf-bookmark="Step 2: Total effect"><div class="sect3" id="step_two_total_effect">
<h3>Step 2: Total effect</h3>

<p>The equation for the total effect (<a data-type="xref" href="#eqtnR">Equation 12-3</a>) is called the <em>reduced</em> regression (and we’ll index it by “r”) because it collapses the chain between the variables.</p>

<div data-type="equation" id="eqtnR">
<h5><span class="label">Equation 12-3. </span>Equation R</h5>

<p><em>M6Spend</em> = <em>β<sub>gr</sub>.Group</em> (Eq. R)</p>
</div>

<p>For the same reasons as for the first arm of the mediation, our estimate for <em>β<sub>gr</sub></em> is unbiased.</p>
</div></section>

<section data-type="sect3" data-pdf-bookmark="Step 3: Relationship of interest"><div class="sect3" id="step_three_relationship_of_interest">
<h3>Step 3: Relationship of interest</h3>

<p>This is where the magic happens: as discussed in the previous section about mediation, <em>β<sub>gr</sub></em> = <em>β<sub>c</sub></em><sub>2</sub> * <em>β<sub>g</sub></em><sub>1</sub>. We can rewrite this equation as <em>β<sub>c</sub></em><sub>2</sub> = <em>β<sub>gr</sub></em> / <em>β<sub>g</sub></em><sub>1</sub>. Because all variables right of the equal sign are unbiased, the one left of it is as well. This estimate for <em>β<sub>c</sub></em><sub>2</sub> is unbiased.</p>

<p>In other words, we can deconfound the relationship between two variables if we can find a variable (called the <em>instrument</em>) that is a cause of our cause of interest but is otherwise unrelated to both the confounder and the effect of interest:</p>

<ul class="pagebreak-before less_space">
	<li>
	<p>The first condition (called the <em>independence assumption</em>) is necessary for the reduced regression to be unbiased, but fortunately it is always true with a random assignment.</p>
	</li>
	<li>
	<p>The second condition (called the <em>exclusion restriction</em>) can be rephrased as saying that the relationship between the instrument and the effect of interest must be fully mediated by the cause of interest. It is necessary for the equation <em>β<sub>gr</sub></em> = <em>β<sub>c</sub></em><sub>2</sub> * <em>β<sub>g</sub></em><sub>1</sub> to be true. Unfortunately, it can’t be proven mathematically (that would require knowing the coefficient for the second arm of the mediation, which is what we’re looking for!) and must be assumed based on qualitative causal considerations—in this case, for example, that the experimental group assignment is unlikely to affect <em>M6Spend</em> outside of the <em>CSAT</em> chain.<a contenteditable="false" data-primary="" data-startref="ch12-cdiv" data-type="indexterm" id="idm45968141537928"/><a contenteditable="false" data-primary="" data-startref="ch12-cdiv2" data-type="indexterm" id="idm45968141536520"/></p>
	<a contenteditable="false" data-primary="" data-startref="ch12-cdiv3" data-type="indexterm" id="idm45968141535144"/></li>
</ul>
</div></section>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Measurement"><div class="sect2" id="measurement">
<h2>Measurement</h2>

<p>That was the intuition. We could certainly calculate all the<a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="measurement" data-type="indexterm" id="ch12-meas"/><a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="measurement" data-type="indexterm" id="ch12-meas2"/><a contenteditable="false" data-primary="customer satisfaction (CSAT)" data-secondary="measuring effect on future purchasing" data-tertiary="instrumental variable measurement" data-type="indexterm" id="ch12-meas3"/><a contenteditable="false" data-primary="C-Mart fictional supermarket chain" data-secondary="mediation" data-tertiary="instrumental variable measurement" data-type="indexterm" id="ch12-meas4"/> corresponding regressions by hand, but as we spoiled twenty-first-century data analysts have come to expect, there is a package for that.</p>

<p>First, we’ll do two sanity checks by running the linear regressions for the first arm of the mediation and for the total effect (i.e., the reduced equation). If either of these yields a coefficient very close to zero (as determined by the Bootstrap CI), that would jeopardize our IV regression. In most cases, you’ll want to include some other covariates that are causally related to your variables of interest. In our example from <a data-type="xref" href="ch10.xhtml#cluster_randomization_and_hierarchical">Chapter 10</a>, <em>Age</em> (the age of the caller) and <em>Reason</em> (the reason for the call) were predictive of <em>CSAT</em> and included beside <em>Group</em>. We should include them here as well:<a contenteditable="false" data-primary="Python" data-secondary="mediation instrumental variable measurement" data-type="indexterm" id="ch12-mivm"/><a contenteditable="false" data-primary="R" data-secondary="mediation instrumental variable measurement" data-type="indexterm" id="ch12-mivm2"/></p>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python (output not shown)</code>
<code class="n">ols</code><code class="p">(</code><code class="s2">"call_CSAT~group+age+reason"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">exp_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">disp</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>
<code class="n">ols</code><code class="p">(</code><code class="s2">"M6Spend~group+age+reason"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">exp_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">disp</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code></pre>

<pre data-code-language="r" data-type="programlisting">
<code class="c1">## R</code>
<code class="nf">summary</code><code class="p">(</code><code class="nf">lm</code><code class="p">(</code><code class="n">call_CSAT</code><code class="o">~</code><code class="n">group</code><code class="o">+</code><code class="n">age</code><code class="o">+</code><code class="n">reason</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">exp_data</code><code class="p">))</code>
<code class="nf">summary</code><code class="p">(</code><code class="nf">lm</code><code class="p">(</code><code class="n">M6Spend</code><code class="o">~</code><code class="n">group</code><code class="o">+</code><code class="n">age</code><code class="o">+</code><code class="n">reason</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">exp_data</code><code class="p">))</code>
<code class="n">..</code>
<code class="n">Coefficients</code><code class="o">:</code>
               <code class="n">Estimate</code> <code class="n">Std.</code> <code class="n">Error</code> <code class="n">t</code> <code class="n">value</code> <code class="nf">Pr</code><code class="p">(</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code><code class="p">)</code>    
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>    <code class="m">4.103826</code>   <code class="m">0.011790</code>  <code class="m">348.07</code>   <code class="o">&lt;</code><code class="m">2e-16</code> <code class="o">***</code>
<code class="n">grouptreat</code>     <code class="m">0.540633</code>   <code class="m">0.006291</code>   <code class="m">85.94</code>   <code class="o">&lt;</code><code class="m">2e-16</code> <code class="o">***</code>
<code class="n">age</code>            <code class="m">0.020202</code>   <code class="m">0.000280</code>   <code class="m">72.14</code>   <code class="o">&lt;</code><code class="m">2e-16</code> <code class="o">***</code>
<code class="n">reasonproperty</code> <code class="m">0.200590</code>   <code class="m">0.006600</code>   <code class="m">30.39</code>   <code class="o">&lt;</code><code class="m">2e-16</code> <code class="o">***</code>
<code class="kc">...</code>
<code class="n">Coefficients</code><code class="o">:</code>
               <code class="n">Estimate</code> <code class="n">Std.</code> <code class="n">Error</code>  <code class="n">t</code> <code class="n">value</code>         <code class="nf">Pr</code><code class="p">(</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code><code class="p">)</code>    
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>    <code class="m">99.93195</code>    <code class="m">0.43976</code>  <code class="m">227.242</code>          <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">grouptreat</code>      <code class="m">1.61687</code>    <code class="m">0.23465</code>    <code class="m">6.891</code> <code class="m">0.00000000000557</code> <code class="o">***</code>
<code class="n">age</code>            <code class="m">-1.46785</code>    <code class="m">0.01044</code> <code class="m">-140.536</code>          <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">reasonproperty</code>  <code class="m">0.44458</code>    <code class="m">0.24615</code>    <code class="m">1.806</code>           <code class="m">0.0709</code> <code class="n">. </code>
<code class="kc">...</code></pre>

<p>Fortunately, both coefficients are safely distinct from zero, so we can move to our IV regression.</p>

<section data-type="sect3" data-pdf-bookmark="Python code"><div class="sect3" id="python_code">
<h3>Python code</h3>

<p>In Python, we’ll use the package <code>linearmodels</code>:</p>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python </code>
<code class="n">iv_mod</code> <code class="o">=</code> <code class="n">IV2SLS</code><code class="o">.</code><code class="n">from_formula</code><code class="p">(</code><code class="s1">'M6Spend ~ 1 + age + reason + [call_CSAT ~ group]'</code><code class="p">,</code> 
                             <code class="n">exp_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">()</code>
<code class="n">iv_mod</code><code class="o">.</code><code class="n">params</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> 
<code class="n">Intercept</code>             <code class="mf">87.658610</code>
<code class="n">reason</code><code class="p">[</code><code class="n">T</code><code class="o">.</code><code class="n">property</code><code class="p">]</code>    <code class="o">-</code><code class="mf">0.155326</code>
<code class="n">age</code>                   <code class="o">-</code><code class="mf">1.528264</code>
<code class="n">call_CSAT</code>              <code class="mf">2.990706</code>
<code class="n">Name</code><code class="p">:</code> <code class="n">parameter</code><code class="p">,</code> <code class="n">dtype</code><code class="p">:</code> <code class="n">float64</code></pre>

<p>The syntax of the <code>IV2SLS.from_formula()</code> function is almost the same as for <code>ols()</code>. The predicted variable, our effect of interest, goes to the left of the tilde sign (“~”) and the predictors go to the right of it, with the first-stage regression written between brackets. Two things to note:</p>

<ul>
	<li>
	<p>You need to explicitly include a constant (“1”) among the predictors.</p>
	</li>
	<li>
	<p>The other covariates related to your variables of interest (here, <em>Age</em> and <em>Reason</em>) should be included here as well, outside of the brackets. Note that they will automatically be included in the first-stage regression. Your formula for the first-stage regression only needs to include the mediator, a.k.a. our cause of interest, and the instrument.</p>
	</li>
</ul>

<p>The output of the Python function is limited, but that’s all we need. The effect of <em>call_CSAT</em> on <em>M6Spend</em> is about $2.99 per unit, about $1 less than the naive, biased regression of <em>M6Spend</em> on <em>call_CSAT</em> would suggest:</p>

<pre data-code-language="python" data-type="programlisting">
<code class="c1">## Python</code>
<code class="n">ols</code><code class="p">(</code><code class="s2">"M6Spend~call_CSAT+age+reason"</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">exp_data_df</code><code class="p">)</code><code class="o">.</code><code class="n">fit</code><code class="p">(</code><code class="n">disp</code><code class="o">=</code><code class="mi">0</code><code class="p">)</code><code class="o">.</code><code class="n">summary</code><code class="p">()</code>
<code class="o">...</code>
                     <code class="n">coef</code>    <code class="n">std</code> <code class="n">err</code>      <code class="n">t</code>     <code class="n">P</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code> <code class="p">[</code><code class="mf">0.025</code>  <code class="mf">0.975</code><code class="p">]</code>
<code class="n">Intercept</code>           <code class="mf">83.2283</code>   <code class="mf">0.536</code>    <code class="mf">155.302</code>   <code class="mf">0.000</code>   <code class="mf">82.178</code>  <code class="mf">84.279</code>
<code class="n">reason</code><code class="p">[</code><code class="n">T</code><code class="o">.</code><code class="n">property</code><code class="p">]</code>  <code class="o">-</code><code class="mf">0.3582</code>   <code class="mf">0.245</code>     <code class="o">-</code><code class="mf">1.461</code>   <code class="mf">0.144</code>   <code class="o">-</code><code class="mf">0.839</code>   <code class="mf">0.122</code>
<code class="n">call_CSAT</code>            <code class="mf">4.0019</code>   <code class="mf">0.076</code>     <code class="mf">52.767</code>   <code class="mf">0.000</code>    <code class="mf">3.853</code>   <code class="mf">4.151</code>
<code class="n">age</code>                 <code class="o">-</code><code class="mf">1.5488</code>   <code class="mf">0.010</code>   <code class="o">-</code><code class="mf">147.549</code>   <code class="mf">0.000</code>   <code class="o">-</code><code class="mf">1.569</code>  <code class="o">-</code><code class="mf">1.528</code>
<code class="o">...</code></pre>

<p>The Bootstrap 90%-CI for the unbiased effect is approximately [2.26; 3.89].</p>
</div></section>

<section data-type="sect3" data-pdf-bookmark="R code"><div class="sect3" id="r_code">
<h3>R code</h3>

<p>In R, we’ll use the package <code>ivreg</code>:</p>

<pre data-code-language="r" data-type="programlisting">
<code class="c1">## R</code>
<code class="o">&gt;</code> <code class="n">iv_mod</code> <code class="o">&lt;-</code> <code class="n">ivreg</code><code class="o">::</code><code class="nf">ivreg</code><code class="p">(</code><code class="n">M6Spend</code><code class="o">~</code><code class="n">call_CSAT</code> <code class="o">+</code> <code class="n">age</code> <code class="o">+</code> <code class="n">reason</code> <code class="o">|</code> <code class="n">group</code> <code class="o">+</code> <code class="n">age</code> <code class="o">+</code> <code class="n">reason</code><code class="p">,</code> 
    <code class="n">data</code><code class="o">=</code><code class="n">exp_data</code><code class="p">)</code>
<code class="o">&gt;</code> <code class="nf">summary</code><code class="p">(</code><code class="n">iv_mod</code><code class="p">)</code>

<code class="n">Call</code><code class="o">:</code>
<code class="n">ivreg</code><code class="o">::</code><code class="nf">ivreg</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">M6Spend</code> <code class="o">~</code> <code class="n">call_CSAT</code> <code class="o">+</code> <code class="n">age</code> <code class="o">+</code> <code class="n">reason</code> <code class="o">|</code> <code class="n">group</code> <code class="o">+</code> 
    <code class="n">age</code> <code class="o">+</code> <code class="n">reason</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">exp_data</code><code class="p">)</code>

<code class="n">Residuals</code><code class="o">:</code>
   <code class="n">Min</code>     <code class="m">1</code><code class="n">Q</code> <code class="n">Median</code>     <code class="m">3</code><code class="n">Q</code>    <code class="n">Max</code> 
<code class="m">-86.82</code> <code class="m">-35.01</code> <code class="m">-17.94</code>  <code class="m">19.92</code> <code class="m">706.58</code> 

<code class="n">Coefficients</code><code class="o">:</code>
               <code class="n">Estimate</code> <code class="n">Std.</code> <code class="n">Error</code>  <code class="n">t</code> <code class="n">value</code>         <code class="nf">Pr</code><code class="p">(</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code><code class="p">)</code>    
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>    <code class="m">87.65861</code>    <code class="m">1.93745</code>   <code class="m">45.244</code>          <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">call_CSAT</code>       <code class="m">2.99071</code>    <code class="m">0.43165</code>    <code class="m">6.929</code> <code class="m">0.00000000000426</code> <code class="o">***</code>
<code class="n">age</code>            <code class="m">-1.52826</code>    <code class="m">0.01358</code> <code class="m">-112.540</code>          <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">reasonproperty</code> <code class="m">-0.15533</code>    <code class="m">0.25968</code>   <code class="m">-0.598</code>             <code class="m">0.55</code>    

<code class="n">Diagnostic</code> <code class="n">tests</code><code class="o">:</code>
                    <code class="n">df1</code>    <code class="n">df2</code> <code class="n">statistic</code> <code class="n">p</code><code class="o">-</code><code class="n">value</code>    
<code class="n">Weak</code> <code class="n">instruments</code>      <code class="m">1</code> <code class="m">231655</code>  <code class="m">7384.847</code>  <code class="o">&lt;</code><code class="m">2e-16</code> <code class="o">***</code>
<code class="n">Wu</code><code class="o">-</code><code class="n">Hausman</code>            <code class="m">1</code> <code class="m">231654</code>     <code class="m">5.667</code>  <code class="m">0.0173</code> <code class="o">*</code>  
<code class="n">Sargan</code>                <code class="m">0</code>     <code class="kc">NA</code>        <code class="kc">NA</code>      <code class="kc">NA</code>    
<code class="o">---</code>
<code class="n">Signif.</code> <code class="n">codes</code><code class="o">:</code>  <code class="m">0</code> <code class="s">'***'</code> <code class="m">0.001</code> <code class="s">'**'</code> <code class="m">0.01</code> <code class="s">'*'</code> <code class="m">0.05</code> <code class="s">'.'</code> <code class="m">0.1</code> <code class="s">' '</code> <code class="m">1</code>

<code class="n">Residual</code> <code class="n">standard</code> <code class="n">error</code><code class="o">:</code> <code class="m">56.12</code> <code class="n">on</code> <code class="m">231655</code> <code class="n">degrees</code> <code class="n">of</code> <code class="n">freedom</code>
<code class="n">Multiple</code> <code class="n">R</code><code class="o">-</code><code class="n">Squared</code><code class="o">:</code> <code class="m">0.0925</code><code class="p">,</code>	<code class="n">Adjusted</code> <code class="n">R</code><code class="o">-</code><code class="n">squared</code><code class="o">:</code> <code class="m">0.09249</code> 
<code class="n">Wald</code> <code class="n">test</code><code class="o">:</code>  <code class="m">7019</code> <code class="n">on</code> <code class="m">3</code> <code class="n">and</code> <code class="m">231655</code> <code class="n">DF</code><code class="p">,</code>  <code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="o">:</code> <code class="o">&lt;</code> <code class="m">2.2e-16</code></pre>

<p>Thankfully, the authors of the <code>ivreg</code> package have made a conscious effort to make the <code>ivreg()</code> function as similar as possible to <code>lm()</code>, in both its syntax and its output. The only difference in the formula is that there are now two lists of regressors, separated by a vertical bar “|”. Here’s where the variables need to go:</p>

<ul>
	<li>
	<p>The cause of interest, here <em>call_CSAT</em>, appears only on the left of the bar.</p>
	</li>
	<li>
	<p>The instrument(s), here <em>Group</em>, appear only on the right of the bar.</p>
	</li>
	<li>
	<p>The other explanatory variables that contribute to our cause or effect of interest, here <em>Age</em> and <em>Reason</em>, appear on both sides of the bar.</p>
	</li>
</ul>

<p class="pagebreak-before less_space">The output of <code>ivreg()</code> is also very similar to the output of <code>lm()</code>. Our value of interest is the coefficient for <em>call_CSAT</em>. <code>ivreg()</code> also returns the results of several diagnostics for IV, which test the strength of various relationships in our model. Here again, the effect of <em>call_CSAT</em> on <em>M6Spend</em> is about $2.99 per unit. The corresponding Bootstrap 90%-CI is approximately [2.26; 3.89].</p>

<div data-type="note" epub:type="note"><h6>Note</h6>
<p>In our simple example, this difference between the two estimates comes from <em>Openness</em>. In real life, it’s unlikely that we would be able to confidently identify all the confounders at play, which we could instead, if you will, label “unknown psychological stuff.” However, even without measuring these confounders, we can measure their impact on <em>M6Spend</em> through <em>CSAT</em>: a change in these confounders that causes <em>CSAT</em> to increase by 1 point also causes <em>M6Spend</em> to increase by about $1. Now we can go run surveys to measure openness or any other unknown psychological stuff with the knowledge that there is, so to speak, $1 worth of confounding on <em>M6Spend</em> per point of <em>CSAT</em> to account for. We know what we don’t know, which, if you ask me, is pretty cool.<a contenteditable="false" data-primary="" data-startref="ch12-meas" data-type="indexterm" id="idm45968140852504"/><a contenteditable="false" data-primary="" data-startref="ch12-meas2" data-type="indexterm" id="idm45968140851128"/><a contenteditable="false" data-primary="" data-startref="ch12-meas3" data-type="indexterm" id="idm45968140849752"/><a contenteditable="false" data-primary="" data-startref="ch12-meas4" data-type="indexterm" id="idm45968140848376"/><a contenteditable="false" data-primary="" data-startref="ch12-mivm" data-type="indexterm" id="idm45968140847000"/><a contenteditable="false" data-primary="" data-startref="ch12-mivm2" data-type="indexterm" id="idm45968140845624"/></p>
</div>
</div></section>
</div></section>

<section data-type="sect2" data-pdf-bookmark="Applying IVs: Frequently Asked Questions"><div class="sect2" id="applying_ivs_frequently_asked_questions">
<h2>Applying IVs: Frequently Asked Questions</h2>

<p>In the preceding example, we’ve leveraged IVs for the<a contenteditable="false" data-primary="instrumental variables (IV)" data-secondary="applying" data-type="indexterm" id="idm45968140842584"/><a contenteditable="false" data-primary="mediation" data-secondary="instrumental variables" data-tertiary="applying" data-type="indexterm" id="idm45968140841192"/> downstream analysis of experimental data: using experimental data to deconfound causal relationships. This is one of their most straightforward and potent uses, but it’s not the only one. Once you get familiar with IVs, you’ll start asking yourself “what about...?” Building complete examples for each potential use case would be redundant, but it’s worth calling out the most common ones:</p>

<dl>
	<dt>Can I use IVs with purely observational data?</dt>
	<dd>
	<p>Yes, and the process is exactly the same as with experimental data, but because the independence assumption is not a given in that case, you’ll need to make sure that it holds. I have often come up with a potential instrument only to realize a bit later that there was another connection between the instrument and the final effect lurking in the background.</p>
	</dd>
	<dt>Can I use IVs with a binary final effect?</dt>
	<dd>
	<p>In such a case, the relationships between coefficients are significantly more complicated than they are with linear regressions all along. The R package <code>ivprobit()</code> allows you to run a probit regression with an instrument, but as far as I know, there is no such solution for logistic regression.</p>
	</dd>
</dl>
</div></section>
</div></section>

<section data-type="sect1" class="pagebreak-before" data-pdf-bookmark="Conclusion"><div class="sect1" id="conclusion-id00017">
<h1 class="less_space">Conclusion</h1>

<p>Here we are. At the beginning of the book I promised that we would measure the causal impact of customer satisfaction on a business metric, and we did just that: “An increase of stated customer satisfaction by one unit increases spending in the following six months by $2.99.” No lengthy caveat and footnotes, no “correlation is not causation” hand-waving—this is as clear-cut a result as it gets. And hopefully, a whole world of opportunities is opening in your mind. Customer satisfaction, loyalty program memeberships, brand perception: measuring the business implications of all these nebulous and biased concepts is within your reach. And chances are, you already have the data you need. Did someone in marketing run an experiment two years ago offering a discount to customers if they signed up for your loyalty program? Then it’s simply a matter of pulling the corresponding data and applying the one-line formula for IV regression. Of course, that simplicity isn’t coming out of nowhere. It’s been a long time in the making, as it requires:</p>

<ul>
	<li>
	<p>Well-defined and understood variables for customer satisfaction and spending, as we saw in <a data-type="xref" href="part01.xhtml#understanding_behaviors">Part I</a></p>
	</li>
	<li>
	<p>The right causal diagram, as we discovered in <a data-type="xref" href="part02.xhtml#causal_diagrams_and_deconfounding">Part II</a></p>
	</li>
	<li>
	<p>Tools that allow us to handle uncertainty without having to memorize a bunch of statistical tests, as we saw in <a data-type="xref" href="part03.xhtml#robust_data_analysis">Part III</a></p>
	</li>
	<li>
	<p>Well-designed and well-analyzed experiments, as we explored in <a data-type="xref" href="part04.xhtml#designing_and_analyzing_experiments">Part IV</a></p>
	</li>
	<li>
	<p>Finally, an understanding of moderation and mediation, as we learned in <a data-type="xref" href="part05.xhtml#advanced_tools_in_behavioral_data_analy">Part V</a></p>
	</li>
</ul>

<p>To end on a slightly less formal note: it is often noted that children appear to have an infinite curiosity for the world (“Why is the sky blue?”). Of course, that curiosity is not actually infinite, and at some point most children stop asking so many questions. It is my sincere hope that this book will have rekindled some of that childlike curiosity in you—that you’ll let yourself be intrigued by the world (especially the people) around you and you’ll wonder, “But why?” Of course, before claiming any credit for that, I’ll have to contemplate the very real possibility that I got the causality wrong and that you had it all in you from the start (<a data-type="xref" href="#did_i_mention_that_correlation_is_not_c">Figure 12-9</a>).</p>

<figure><div id="did_i_mention_that_correlation_is_not_c" class="figure"><img alt="Did I mention that correlation is not causation?" src="Images/BEDA_1209.png" width="671" height="375"/>
<h6><span class="label">Figure 12-9. </span>Did I mention that correlation is not causation?</h6>
</div></figure>
</div></section>
</div></section></div></body></html>