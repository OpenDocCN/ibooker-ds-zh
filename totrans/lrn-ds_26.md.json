["```py\n`def` `huber_loss``(``theta``,` `dataset``,` `gamma``=``1``)``:`\n    `d` `=` `np``.``abs``(``theta` `-` `dataset``)`\n    `return` `np``.``mean``(`\n        `np``.``where``(``d` `<``=` `gamma``,`\n                 `(``theta` `-` `dataset``)``*``*``2` `/` `2.0``,`\n                 `gamma` `*` `(``d` `-` `gamma` `/` `2.0``)``)`\n    `)`\n\n`def` `grad_huber_loss``(``theta``,` `dataset``,` `gamma``=``1``)``:`\n    `d` `=` `np``.``abs``(``theta` `-` `dataset``)`\n    `return` `np``.``mean``(`\n        `np``.``where``(``d` `<``=` `gamma``,`\n                 `-``(``dataset` `-` `theta``)``,`\n                 `-``gamma` `*` `np``.``sign``(``dataset` `-` `theta``)``)`\n    `)`\n\n```", "```py\n`def` `minimize``(``loss_fn``,` `grad_loss_fn``,` `dataset``,` `alpha``=``0.2``,` `progress``=``False``)``:`\n    `'''`\n `Uses gradient descent to minimize loss_fn. Returns the minimizing value of`\n `theta_hat once theta_hat changes less than 0.001 between iterations.`\n `'''`\n    `theta` `=` `0`\n    `while` `True``:`\n        `if` `progress``:`\n            `print``(``f``'``theta:` `{``theta``:``.2f``}` `| loss:` `{``loss_fn``(``theta``,` `dataset``)``:``.3f``}``'``)`\n        `gradient` `=` `grad_loss_fn``(``theta``,` `dataset``)`\n        `new_theta` `=` `theta` `-` `alpha` `*` `gradient`\n\n        `if` `abs``(``new_theta` `-` `theta``)` `<` `0.001``:`\n            `return` `new_theta`\n\n        `theta` `=` `new_theta`\n\n```", "```py\n`delays` `=` `pd``.``read_csv``(``'``data/seattle_bus_times_NC.csv``'``)`\n\n```", "```py\n`print``(``f``\"``Mean:` `{``np``.``mean``(``delays``[``'``minutes_late``'``]``)``:``.3f``}``\"``)`\n`print``(``f``\"``Median:` `{``np``.``median``(``delays``[``'``minutes_late``'``]``)``:``.3f``}``\"``)`    \n\n```", "```py\nMean:   1.920\nMedian: 0.742\n\n```", "```py\n`%``%``time`\n`theta_hat` `=` `minimize``(``huber_loss``,` `grad_huber_loss``,` `delays``[``'``minutes_late``'``]``)`\n`print``(``f``'``Minimizing theta:` `{``theta_hat``:``.3f``}``'``)`\n`print``(``)`\n\n```", "```py\nMinimizing theta: 0.701\n\nCPU times: user 93 ms, sys: 4.24 ms, total: 97.3 ms\nWall time: 140 ms\n\n```"]