<html><head></head><body>
<div id="sbo-rt-content"><section data-pdf-bookmark="Chapter 5. The Basics of NumPy Arrays" data-type="chapter" epub:type="chapter"><div class="chapter" id="section-0202-the-basics-of-numpy-arrays">
<h1><span class="label">Chapter 5. </span>The Basics of NumPy Arrays</h1>
<p><a data-primary="arrays" data-secondary="basics" data-type="indexterm" id="ix_ch05-asciidoc0"/><a data-primary="NumPy" data-secondary="array basics" data-type="indexterm" id="ix_ch05-asciidoc1"/>Data manipulation in Python is nearly synonymous with NumPy array
manipulation: even newer tools like Pandas
(<a data-type="xref" href="part03.xhtml#section-0300-introduction-to-pandas">Part III</a>) are built around the
NumPy array. This chapter will present several examples of using NumPy
array manipulation to access data and subarrays, and to split, reshape,
and join the arrays. While the types of operations shown here may seem a
bit dry and pedantic, they comprise the building blocks of many other
examples used throughout the book. Get to know them well!</p>
<p>We’ll cover a few categories of basic array manipulations
here:</p>
<dl>
<dt><em>Attributes of arrays</em></dt>
<dd>
<p>Determining the size, shape, memory
consumption, and data types of arrays</p>
</dd>
<dt><em>Indexing of arrays</em></dt>
<dd>
<p>Getting and setting the values of individual
array elements</p>
</dd>
<dt><em>Slicing of arrays</em></dt>
<dd>
<p>Getting and setting smaller subarrays within a
larger array</p>
</dd>
<dt><em>Reshaping of arrays</em></dt>
<dd>
<p>Changing the shape of a given array</p>
</dd>
<dt><em>Joining and splitting of arrays</em></dt>
<dd>
<p>Combining multiple arrays into one,
and splitting one array into many</p>
</dd>
</dl>
<section class="pagebreak-before less_space" data-pdf-bookmark="NumPy Array Attributes" data-type="sect1"><div class="sect1" id="ch_0202-the-basics-of-numpy-arrays_numpy-array-attributes">
<h1>NumPy Array Attributes</h1>
<p><a data-primary="arrays" data-secondary="attributes" data-type="indexterm" id="idm45858808640368"/><a data-primary="NumPy" data-secondary="array attributes" data-type="indexterm" id="idm45858808639392"/>First let’s discuss some useful array attributes.
We’ll start by defining random arrays of one, two, and three
dimensions. We’ll use NumPy’s random number
generator, which we will <em>seed</em> with a set value in order to ensure that
the same random arrays are generated each time this code is run:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">1</code><code class="p">]:</code> <code class="kn">import</code> <code class="nn">numpy</code> <code class="k">as</code> <code class="nn">np</code>
        <code class="n">rng</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">random</code><code class="o">.</code><code class="n">default_rng</code><code class="p">(</code><code class="n">seed</code><code class="o">=</code><code class="mi">1701</code><code class="p">)</code>  <code class="c1"># seed for reproducibility</code>

        <code class="n">x1</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">integers</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="n">size</code><code class="o">=</code><code class="mi">6</code><code class="p">)</code>  <code class="c1"># one-dimensional array</code>
        <code class="n">x2</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">integers</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="n">size</code><code class="o">=</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>  <code class="c1"># two-dimensional array</code>
        <code class="n">x3</code> <code class="o">=</code> <code class="n">rng</code><code class="o">.</code><code class="n">integers</code><code class="p">(</code><code class="mi">10</code><code class="p">,</code> <code class="n">size</code><code class="o">=</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">))</code>  <code class="c1"># three-dimensional array</code></pre>
<p>Each array has attributes including <code>ndim</code> (the number of dimensions),
<code>shape</code> (the size of each dimension), <code>size</code> (the total size of the
array), and <code>dtype</code> (the type of each 
<span class="keep-together">element</span>):</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="nb">print</code><code class="p">(</code><code class="s2">"x3 ndim: "</code><code class="p">,</code> <code class="n">x3</code><code class="o">.</code><code class="n">ndim</code><code class="p">)</code>
        <code class="nb">print</code><code class="p">(</code><code class="s2">"x3 shape:"</code><code class="p">,</code> <code class="n">x3</code><code class="o">.</code><code class="n">shape</code><code class="p">)</code>
        <code class="nb">print</code><code class="p">(</code><code class="s2">"x3 size: "</code><code class="p">,</code> <code class="n">x3</code><code class="o">.</code><code class="n">size</code><code class="p">)</code>
        <code class="nb">print</code><code class="p">(</code><code class="s2">"dtype:   "</code><code class="p">,</code> <code class="n">x3</code><code class="o">.</code><code class="n">dtype</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">2</code><code class="p">]:</code> <code class="n">x3</code> <code class="n">ndim</code><code class="p">:</code>  <code class="mi">3</code>
        <code class="n">x3</code> <code class="n">shape</code><code class="p">:</code> <code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">)</code>
        <code class="n">x3</code> <code class="n">size</code><code class="p">:</code>  <code class="mi">60</code>
        <code class="n">dtype</code><code class="p">:</code>    <code class="n">int64</code></pre>
<p>For more discussion of data types, see
<a data-type="xref" href="ch04.xhtml#section-0201-understanding-data-types">Chapter 4</a>.</p>
</div></section>
<section data-pdf-bookmark="Array Indexing: Accessing Single Elements" data-type="sect1"><div class="sect1" id="ch_0202-the-basics-of-numpy-arrays_array-indexing-accessing-single-elements">
<h1>Array Indexing: Accessing Single Elements</h1>
<p><a data-primary="arrays" data-secondary="indexing: accessing single elements" data-type="indexterm" id="idm45858808480256"/><a data-primary="indexing" data-secondary="NumPy arrays: accessing single elements" data-type="indexterm" id="idm45858808479312"/><a data-primary="NumPy" data-secondary="array indexing: accessing single elements" data-type="indexterm" id="idm45858808478400"/>If you are familiar with Python’s standard list indexing,
indexing in NumPy will feel quite familiar. In a one-dimensional array,
the <em>i<sub>th</sub></em> value (counting from zero) can be accessed by
specifying the desired index in square brackets, just as with Python
lists:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">x1</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">3</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">9</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">4</code><code class="p">]:</code> <code class="mi">9</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">4</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">5</code><code class="p">]:</code> <code class="mi">8</code></pre>
<p>To index from the end of the array, you can use negative indices:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">6</code><code class="p">]:</code> <code class="mi">6</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">7</code><code class="p">]:</code> <code class="mi">8</code></pre>
<p>In a multidimensional array, items can be accessed using a
comma-separated <code>(<em>row</em>, <em>column</em>)</code> tuple:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">x2</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">8</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">7</code><code class="p">],</code>
               <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
               <code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">9</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">9</code><code class="p">]:</code> <code class="mi">3</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">10</code><code class="p">]:</code> <code class="mi">0</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[</code><code class="mi">2</code><code class="p">,</code> <code class="o">-</code><code class="mi">1</code><code class="p">]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">11</code><code class="p">]:</code> <code class="mi">9</code></pre>
<p>Values can also be modified using any of the preceding index notation:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="mi">12</code>
         <code class="n">x2</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">12</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code>  <code class="mi">3</code><code class="p">,</code>  <code class="mi">7</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">4</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">2</code><code class="p">,</code>  <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">0</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">6</code><code class="p">,</code>  <code class="mi">9</code><code class="p">]])</code></pre>
<p>Keep in mind that, unlike Python lists, NumPy arrays have a fixed type.
This means, for example, that if you attempt to insert a floating-point
value into an integer array, the value will be silently truncated.
Don’t be caught unaware by this behavior!</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="mf">3.14159</code>  <code class="c1"># this will be truncated!</code>
         <code class="n">x1</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">13</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code></pre>
</div></section>
<section data-pdf-bookmark="Array Slicing: Accessing Subarrays" data-type="sect1"><div class="sect1" id="ch_0202-the-basics-of-numpy-arrays_array-slicing-accessing-subarrays">
<h1>Array Slicing: Accessing Subarrays</h1>
<p><a data-primary="arrays" data-secondary="slicing" data-type="indexterm" id="ix_ch05-asciidoc2"/><a data-primary="slicing" data-secondary="NumPy arrays" data-type="indexterm" id="ix_ch05-asciidoc3"/>Just <a data-primary=": (colon)" data-type="indexterm" id="idm45858807943216"/><a data-primary="colon (:)" data-type="indexterm" id="idm45858807942512"/>as we can use square brackets to access individual array elements,
we can also use them to access subarrays with the <em>slice</em> notation,
marked by the colon (<code>:</code>) character. The NumPy slicing syntax follows
that of the standard Python list; to access a slice of an array <code>x</code>, use
this:</p>
<pre data-code-language="python" data-type="programlisting"><code class="n">x</code><code class="p">[</code><code class="n">start</code><code class="p">:</code><code class="n">stop</code><code class="p">:</code><code class="n">step</code><code class="p">]</code></pre>
<p>If any of these are unspecified, they default to the values <code>start=0</code>,
<code>stop=&lt;size of dimension&gt;</code>, <code>step=1</code>. Let’s look at some
examples of accessing subarrays in one dimension and in multiple
dimensions.</p>
<section data-pdf-bookmark="One-Dimensional Subarrays" data-type="sect2"><div class="sect2" id="ch_0202-the-basics-of-numpy-arrays_one-dimensional-subarrays">
<h2>One-Dimensional Subarrays</h2>
<p><a data-primary="arrays" data-secondary="slicing one-dimensional subarrays" data-type="indexterm" id="idm45858807899712"/><a data-primary="NumPy" data-secondary="array slicing: accessing subarrays" data-type="indexterm" id="idm45858807898768"/><a data-primary="slicing" data-secondary="NumPy arrays: one-dimensional subarrays" data-type="indexterm" id="idm45858807897856"/><a data-primary="subarrays" data-secondary="slicing one-dimensional" data-type="indexterm" id="idm45858807896944"/>Here are some examples of accessing elements in one-dimensional
subarrays:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">x1</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">14</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[:</code><code class="mi">3</code><code class="p">]</code>  <code class="c1"># first three elements</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">15</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">0</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">3</code><code class="p">:]</code>  <code class="c1"># elements after index 3</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">16</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">1</code><code class="p">:</code><code class="mi">4</code><code class="p">]</code>  <code class="c1"># middle subarray</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">17</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">4</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">18</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[::</code><code class="mi">2</code><code class="p">]</code>  <code class="c1"># every second element</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">18</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">8</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">19</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">1</code><code class="p">::</code><code class="mi">2</code><code class="p">]</code>  <code class="c1"># every second element, starting at index 1</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">19</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">4</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">6</code><code class="p">])</code></pre>
<p>A potentially confusing case is when the <code>step</code> value is negative. In
this case, the defaults for <code>start</code> and <code>stop</code> are swapped. This becomes
a convenient way to reverse an array:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[::</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code>  <code class="c1"># all elements, reversed</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">20</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">6</code><code class="p">,</code> <code class="mi">8</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="n">x1</code><code class="p">[</code><code class="mi">4</code><code class="p">::</code><code class="o">-</code><code class="mi">2</code><code class="p">]</code>  <code class="c1"># every second element from index 4, reversed</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">21</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">8</code><code class="p">,</code> <code class="mi">0</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code></pre>
</div></section>
<section data-pdf-bookmark="Multidimensional Subarrays" data-type="sect2"><div class="sect2" id="ch_0202-the-basics-of-numpy-arrays_multidimensional-subarrays">
<h2>Multidimensional Subarrays</h2>
<p><a data-primary="arrays" data-secondary="slicing multidimensional subarrays" data-type="indexterm" id="idm45858807518640"/><a data-primary="slicing" data-secondary="NumPy arrays: multidimensional subarrays" data-type="indexterm" id="idm45858807517728"/><a data-primary="subarrays" data-secondary="slicing multidimensional" data-type="indexterm" id="idm45858807516816"/>Multidimensional slices work in the same way, with multiple slices
separated by commas. For example:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">22</code><code class="p">]:</code> <code class="n">x2</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">22</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code>  <code class="mi">3</code><code class="p">,</code>  <code class="mi">7</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">4</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">2</code><code class="p">,</code>  <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">0</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">6</code><code class="p">,</code>  <code class="mi">9</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">23</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[:</code><code class="mi">2</code><code class="p">,</code> <code class="p">:</code><code class="mi">3</code><code class="p">]</code>  <code class="c1"># first two rows &amp; three columns</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">23</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code>  <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">4</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">2</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">24</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[:</code><code class="mi">3</code><code class="p">,</code> <code class="p">::</code><code class="mi">2</code><code class="p">]</code>  <code class="c1"># three rows, every second column</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">24</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">4</code><code class="p">,</code>  <code class="mi">2</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">0</code><code class="p">,</code>  <code class="mi">6</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">25</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[::</code><code class="o">-</code><code class="mi">1</code><code class="p">,</code> <code class="p">::</code><code class="o">-</code><code class="mi">1</code><code class="p">]</code>  <code class="c1"># all rows &amp; columns, reversed</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">25</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code> <code class="mi">9</code><code class="p">,</code>  <code class="mi">6</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">0</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">3</code><code class="p">,</code>  <code class="mi">2</code><code class="p">,</code>  <code class="mi">0</code><code class="p">,</code>  <code class="mi">4</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">7</code><code class="p">,</code>  <code class="mi">3</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code> <code class="mi">12</code><code class="p">]])</code></pre>
<p><a data-primary="arrays" data-secondary="accessing single rows/columns" data-type="indexterm" id="idm45858807323456"/><a data-primary="column(s)" data-secondary="accessing single" data-type="indexterm" id="idm45858807313888"/>One commonly needed routine is accessing single rows or columns of an
array. This can be done by combining indexing and slicing, using an
empty slice marked by a single colon (<code>:</code>):</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">26</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[:,</code> <code class="mi">0</code><code class="p">]</code>  <code class="c1"># first column of x2</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">26</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">4</code><code class="p">,</code>  <code class="mi">0</code><code class="p">])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">27</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="p">:]</code>  <code class="c1"># first row of x2</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">27</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code>  <code class="mi">3</code><code class="p">,</code>  <code class="mi">7</code><code class="p">])</code></pre>
<p>In the case of row access, the empty slice can be omitted for a more
compact syntax:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">28</code><code class="p">]:</code> <code class="n">x2</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code>  <code class="c1"># equivalent to x2[0, :]</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">28</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">12</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code>  <code class="mi">3</code><code class="p">,</code>  <code class="mi">7</code><code class="p">])</code></pre>
</div></section>
<section data-pdf-bookmark="Subarrays as No-Copy Views" data-type="sect2"><div class="sect2" id="ch_0202-the-basics-of-numpy-arrays_subarrays-as-no-copy-views">
<h2>Subarrays as No-Copy Views</h2>
<p><a data-primary="arrays" data-secondary="subarrays as no-copy views" data-type="indexterm" id="idm45858807145296"/><a data-primary="slicing" data-secondary="NumPy versus Python" data-type="indexterm" id="idm45858807144384"/><a data-primary="subarrays" data-secondary="no-copy views" data-type="indexterm" id="idm45858807141552"/>Unlike Python list slices, NumPy array slices are returned as <em>views</em>
rather than <em>copies</em> of the array data. Consider our two-dimensional
array from before:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">29</code><code class="p">]:</code> <code class="nb">print</code><code class="p">(</code><code class="n">x2</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">29</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">12</code>  <code class="mi">1</code>  <code class="mi">3</code>  <code class="mi">7</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code>  <code class="mi">2</code>  <code class="mi">3</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">0</code>  <code class="mi">0</code>  <code class="mi">6</code>  <code class="mi">9</code><code class="p">]]</code></pre>
<p>Let’s extract a <math alttext="2 times 2">
<mrow>
<mn>2</mn>
<mo>×</mo>
<mn>2</mn>
</mrow>
</math> subarray from this:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">30</code><code class="p">]:</code> <code class="n">x2_sub</code> <code class="o">=</code> <code class="n">x2</code><code class="p">[:</code><code class="mi">2</code><code class="p">,</code> <code class="p">:</code><code class="mi">2</code><code class="p">]</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">x2_sub</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">30</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">12</code>  <code class="mi">1</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code><code class="p">]]</code></pre>
<p>Now if we modify this subarray, we’ll see that the original
array is changed! Observe:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">31</code><code class="p">]:</code> <code class="n">x2_sub</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="mi">99</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">x2_sub</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">31</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">99</code>  <code class="mi">1</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code><code class="p">]]</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">32</code><code class="p">]:</code> <code class="nb">print</code><code class="p">(</code><code class="n">x2</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">32</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">99</code>  <code class="mi">1</code>  <code class="mi">3</code>  <code class="mi">7</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code>  <code class="mi">2</code>  <code class="mi">3</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">0</code>  <code class="mi">0</code>  <code class="mi">6</code>  <code class="mi">9</code><code class="p">]]</code></pre>
<p>Some users may find this surprising, but it can be advantageous: for
example, when working with large datasets, we can access and process
pieces of these datasets without the need to copy the underlying data
buffer.</p>
</div></section>
<section data-pdf-bookmark="Creating Copies of Arrays" data-type="sect2"><div class="sect2" id="ch_0202-the-basics-of-numpy-arrays_creating-copies-of-arrays">
<h2>Creating Copies of Arrays</h2>
<p><a data-primary="arrays" data-secondary="creating copies" data-type="indexterm" id="idm45858806914768"/><a data-primary="subarrays" data-secondary="creating copies" data-type="indexterm" id="idm45858806913792"/>Despite the features of array views, it’s sometimes useful to
instead explicitly copy the data within an array or a subarray. This is easiest to do with the <code>copy</code> method:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">33</code><code class="p">]:</code> <code class="n">x2_sub_copy</code> <code class="o">=</code> <code class="n">x2</code><code class="p">[:</code><code class="mi">2</code><code class="p">,</code> <code class="p">:</code><code class="mi">2</code><code class="p">]</code><code class="o">.</code><code class="n">copy</code><code class="p">()</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">x2_sub_copy</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">33</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">99</code>  <code class="mi">1</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code><code class="p">]]</code></pre>
<p class="pagebreak-before less_space">If we now modify this subarray, the original array is not touched:<a data-startref="ix_ch05-asciidoc3" data-type="indexterm" id="idm45858806820912"/><a data-startref="ix_ch05-asciidoc2" data-type="indexterm" id="idm45858806849984"/></p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">34</code><code class="p">]:</code> <code class="n">x2_sub_copy</code><code class="p">[</code><code class="mi">0</code><code class="p">,</code> <code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="mi">42</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">x2_sub_copy</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">34</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">42</code>  <code class="mi">1</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code><code class="p">]]</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">35</code><code class="p">]:</code> <code class="nb">print</code><code class="p">(</code><code class="n">x2</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">35</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">99</code>  <code class="mi">1</code>  <code class="mi">3</code>  <code class="mi">7</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">0</code>  <code class="mi">2</code>  <code class="mi">3</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">0</code>  <code class="mi">0</code>  <code class="mi">6</code>  <code class="mi">9</code><code class="p">]]</code></pre>
</div></section>
</div></section>
<section data-pdf-bookmark="Reshaping of Arrays" data-type="sect1"><div class="sect1" id="ch_0202-the-basics-of-numpy-arrays_reshaping-of-arrays">
<h1>Reshaping of Arrays</h1>
<p><a data-primary="arrays" data-secondary="reshaping" data-type="indexterm" id="idm45858806736448"/><a data-primary="reshaping" data-type="indexterm" id="idm45858806735472"/>Another useful type of operation is reshaping of arrays, which can be
done with the <code>reshape</code> method. For example, if you want to put the
numbers 1 through 9 in a <math alttext="3 times 3">
<mrow>
<mn>3</mn>
<mo>×</mo>
<mn>3</mn>
</mrow>
</math> grid, you can do the
following:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">36</code><code class="p">]:</code> <code class="n">grid</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code> <code class="mi">10</code><code class="p">)</code><code class="o">.</code><code class="n">reshape</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code> <code class="mi">3</code><code class="p">)</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">grid</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">36</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">1</code> <code class="mi">2</code> <code class="mi">3</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">4</code> <code class="mi">5</code> <code class="mi">6</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">7</code> <code class="mi">8</code> <code class="mi">9</code><code class="p">]]</code></pre>
<p>Note that for this to work, the size of the initial array must match the
size of the reshaped array, and in most cases the <code>reshape</code> method will
return a no-copy view of the initial array.</p>
<p>A common reshaping operation is converting a one-dimensional array into
a two-dimensional row or column matrix:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">37</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code>
         <code class="n">x</code><code class="o">.</code><code class="n">reshape</code><code class="p">((</code><code class="mi">1</code><code class="p">,</code> <code class="mi">3</code><code class="p">))</code>  <code class="c1"># row vector via reshape</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">37</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="n">x</code><code class="o">.</code><code class="n">reshape</code><code class="p">((</code><code class="mi">3</code><code class="p">,</code> <code class="mi">1</code><code class="p">))</code>  <code class="c1"># column vector via reshape</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">38</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">2</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">3</code><code class="p">]])</code></pre>
<p>A convenient shorthand for this is to use <code>np.newaxis</code> in the slicing
syntax:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">39</code><code class="p">]:</code> <code class="n">x</code><code class="p">[</code><code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">,</code> <code class="p">:]</code>  <code class="c1"># row vector via newaxis</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">39</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">40</code><code class="p">]:</code> <code class="n">x</code><code class="p">[:,</code> <code class="n">np</code><code class="o">.</code><code class="n">newaxis</code><code class="p">]</code>  <code class="c1"># column vector via newaxis</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">40</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">2</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">3</code><code class="p">]])</code></pre>
<p>This is a pattern that we will utilize often throughout the remainder of
the book.</p>
</div></section>
<section data-pdf-bookmark="Array Concatenation and Splitting" data-type="sect1"><div class="sect1" id="ch_0202-the-basics-of-numpy-arrays_array-concatenation-and-splitting">
<h1>Array Concatenation and Splitting</h1>
<p><a data-primary="arrays" data-secondary="concatenation" data-type="indexterm" id="ix_ch05-asciidoc4"/><a data-primary="concatenation" data-secondary="arrays" data-type="indexterm" id="ix_ch05-asciidoc5"/>All of the preceding routines worked on single arrays. NumPy also
provides tools to combine multiple arrays into one, and to conversely
split a single array into multiple arrays.</p>
<section data-pdf-bookmark="Concatenation of Arrays" data-type="sect2"><div class="sect2" id="ch_0202-the-basics-of-numpy-arrays_concatenation-of-arrays">
<h2>Concatenation of Arrays</h2>
<p><a data-primary="np.concatenate() function" data-type="indexterm" id="idm45858806410720"/>Concatenation, or joining of two arrays in NumPy, is primarily
accomplished using the routines <code>np.concatenate</code>, <code>np.vstack</code>, and
<code>np.hstack</code>. <code>np.concatenate</code> takes a tuple or list of arrays as its
first argument, as you can see here:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">41</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">])</code>
         <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">])</code>
         <code class="n">np</code><code class="o">.</code><code class="n">concatenate</code><code class="p">([</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">41</code><code class="p">]:</code> <code class="n">array</code><code class="p">([</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">])</code></pre>
<p>You can also concatenate more than two arrays at once:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">42</code><code class="p">]:</code> <code class="n">z</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([</code><code class="mi">99</code><code class="p">,</code> <code class="mi">99</code><code class="p">,</code> <code class="mi">99</code><code class="p">])</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">np</code><code class="o">.</code><code class="n">concatenate</code><code class="p">([</code><code class="n">x</code><code class="p">,</code> <code class="n">y</code><code class="p">,</code> <code class="n">z</code><code class="p">]))</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">42</code><code class="p">]:</code> <code class="p">[</code> <code class="mi">1</code>  <code class="mi">2</code>  <code class="mi">3</code>  <code class="mi">3</code>  <code class="mi">2</code>  <code class="mi">1</code> <code class="mi">99</code> <code class="mi">99</code> <code class="mi">99</code><code class="p">]</code></pre>
<p>And it can be used for two-dimensional arrays:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">43</code><code class="p">]:</code> <code class="n">grid</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                          <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">44</code><code class="p">]:</code> <code class="c1"># concatenate along the first axis</code>
         <code class="n">np</code><code class="o">.</code><code class="n">concatenate</code><code class="p">([</code><code class="n">grid</code><code class="p">,</code> <code class="n">grid</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">44</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">45</code><code class="p">]:</code> <code class="c1"># concatenate along the second axis (zero-indexed)</code>
         <code class="n">np</code><code class="o">.</code><code class="n">concatenate</code><code class="p">([</code><code class="n">grid</code><code class="p">,</code> <code class="n">grid</code><code class="p">],</code> <code class="n">axis</code><code class="o">=</code><code class="mi">1</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">45</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">,</code> <code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code></pre>
<p>For working with arrays of mixed dimensions, it can be clearer to use
the <code>np.vstack</code> (vertical stack) and <code>np.hstack</code> (horizontal stack)
functions:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">46</code><code class="p">]:</code> <code class="c1"># vertically stack the arrays</code>
         <code class="n">np</code><code class="o">.</code><code class="n">vstack</code><code class="p">([</code><code class="n">x</code><code class="p">,</code> <code class="n">grid</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">46</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">4</code><code class="p">,</code> <code class="mi">5</code><code class="p">,</code> <code class="mi">6</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">47</code><code class="p">]:</code> <code class="c1"># horizontally stack the arrays</code>
         <code class="n">y</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">array</code><code class="p">([[</code><code class="mi">99</code><code class="p">],</code>
                       <code class="p">[</code><code class="mi">99</code><code class="p">]])</code>
         <code class="n">np</code><code class="o">.</code><code class="n">hstack</code><code class="p">([</code><code class="n">grid</code><code class="p">,</code> <code class="n">y</code><code class="p">])</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">47</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code> <code class="mi">1</code><code class="p">,</code>  <code class="mi">2</code><code class="p">,</code>  <code class="mi">3</code><code class="p">,</code> <code class="mi">99</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">4</code><code class="p">,</code>  <code class="mi">5</code><code class="p">,</code>  <code class="mi">6</code><code class="p">,</code> <code class="mi">99</code><code class="p">]])</code></pre>
<p>Similarly, for higher-dimensional arrays, <code>np.dstack</code> will stack arrays
along the third axis.</p>
</div></section>
<section data-pdf-bookmark="Splitting of Arrays" data-type="sect2"><div class="sect2" id="ch_0202-the-basics-of-numpy-arrays_splitting-of-arrays">
<h2>Splitting of Arrays</h2>
<p><a data-primary="arrays" data-secondary="splitting" data-type="indexterm" id="idm45858805913056"/><a data-primary="splitting arrays" data-type="indexterm" id="idm45858805912080"/>The opposite of concatenation is splitting, which is implemented by the
functions <code>np.split</code>, <code>np.hsplit</code>, and <code>np.vsplit</code>. For each of these,
we can pass a list of indices giving the split points:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">48</code><code class="p">]:</code> <code class="n">x</code> <code class="o">=</code> <code class="p">[</code><code class="mi">1</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">99</code><code class="p">,</code> <code class="mi">99</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mi">2</code><code class="p">,</code> <code class="mi">1</code><code class="p">]</code>
         <code class="n">x1</code><code class="p">,</code> <code class="n">x2</code><code class="p">,</code> <code class="n">x3</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">split</code><code class="p">(</code><code class="n">x</code><code class="p">,</code> <code class="p">[</code><code class="mi">3</code><code class="p">,</code> <code class="mi">5</code><code class="p">])</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">x1</code><code class="p">,</code> <code class="n">x2</code><code class="p">,</code> <code class="n">x3</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">48</code><code class="p">]:</code> <code class="p">[</code><code class="mi">1</code> <code class="mi">2</code> <code class="mi">3</code><code class="p">]</code> <code class="p">[</code><code class="mi">99</code> <code class="mi">99</code><code class="p">]</code> <code class="p">[</code><code class="mi">3</code> <code class="mi">2</code> <code class="mi">1</code><code class="p">]</code></pre>
<p>Notice that <em>N</em> split points leads to <em>N</em> + 1 subarrays. The related
functions <code>np.hsplit</code> and <code>np.vsplit</code> are similar:</p>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">49</code><code class="p">]:</code> <code class="n">grid</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">arange</code><code class="p">(</code><code class="mi">16</code><code class="p">)</code><code class="o">.</code><code class="n">reshape</code><code class="p">((</code><code class="mi">4</code><code class="p">,</code> <code class="mi">4</code><code class="p">))</code>
         <code class="n">grid</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">49</code><code class="p">]:</code> <code class="n">array</code><code class="p">([[</code> <code class="mi">0</code><code class="p">,</code>  <code class="mi">1</code><code class="p">,</code>  <code class="mi">2</code><code class="p">,</code>  <code class="mi">3</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">4</code><code class="p">,</code>  <code class="mi">5</code><code class="p">,</code>  <code class="mi">6</code><code class="p">,</code>  <code class="mi">7</code><code class="p">],</code>
                <code class="p">[</code> <code class="mi">8</code><code class="p">,</code>  <code class="mi">9</code><code class="p">,</code> <code class="mi">10</code><code class="p">,</code> <code class="mi">11</code><code class="p">],</code>
                <code class="p">[</code><code class="mi">12</code><code class="p">,</code> <code class="mi">13</code><code class="p">,</code> <code class="mi">14</code><code class="p">,</code> <code class="mi">15</code><code class="p">]])</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">50</code><code class="p">]:</code> <code class="n">upper</code><code class="p">,</code> <code class="n">lower</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">vsplit</code><code class="p">(</code><code class="n">grid</code><code class="p">,</code> <code class="p">[</code><code class="mi">2</code><code class="p">])</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">upper</code><code class="p">)</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">lower</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">50</code><code class="p">]:</code> <code class="p">[[</code><code class="mi">0</code> <code class="mi">1</code> <code class="mi">2</code> <code class="mi">3</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">4</code> <code class="mi">5</code> <code class="mi">6</code> <code class="mi">7</code><code class="p">]]</code>
         <code class="p">[[</code> <code class="mi">8</code>  <code class="mi">9</code> <code class="mi">10</code> <code class="mi">11</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">12</code> <code class="mi">13</code> <code class="mi">14</code> <code class="mi">15</code><code class="p">]]</code></pre>
<pre data-code-language="ipython" data-type="programlisting"><code class="n">In</code> <code class="p">[</code><code class="mi">51</code><code class="p">]:</code> <code class="n">left</code><code class="p">,</code> <code class="n">right</code> <code class="o">=</code> <code class="n">np</code><code class="o">.</code><code class="n">hsplit</code><code class="p">(</code><code class="n">grid</code><code class="p">,</code> <code class="p">[</code><code class="mi">2</code><code class="p">])</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">left</code><code class="p">)</code>
         <code class="nb">print</code><code class="p">(</code><code class="n">right</code><code class="p">)</code>
<code class="n">Out</code><code class="p">[</code><code class="mi">51</code><code class="p">]:</code> <code class="p">[[</code> <code class="mi">0</code>  <code class="mi">1</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">4</code>  <code class="mi">5</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">8</code>  <code class="mi">9</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">12</code> <code class="mi">13</code><code class="p">]]</code>
         <code class="p">[[</code> <code class="mi">2</code>  <code class="mi">3</code><code class="p">]</code>
          <code class="p">[</code> <code class="mi">6</code>  <code class="mi">7</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">10</code> <code class="mi">11</code><code class="p">]</code>
          <code class="p">[</code><code class="mi">14</code> <code class="mi">15</code><code class="p">]]</code></pre>
<p>Similarly, for higher-dimensional arrays, <code>np.dsplit</code> will split arrays
along the third axis<a data-startref="ix_ch05-asciidoc5" data-type="indexterm" id="idm45858805575168"/><a data-startref="ix_ch05-asciidoc4" data-type="indexterm" id="idm45858805527232"/>.<a data-startref="ix_ch05-asciidoc1" data-type="indexterm" id="idm45858805526464"/><a data-startref="ix_ch05-asciidoc0" data-type="indexterm" id="idm45858805525760"/></p>
</div></section>
</div></section>
</div></section></div></body></html>