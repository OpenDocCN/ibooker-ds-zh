- en: Chapter 9\. Constructing Dynamic Analyses
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 9 章. 构建动态分析
- en: Up to this point, we’ve been focused on identifying the correct visualizations
    to answer key questions. You’ve learned when it is appropriate to use pie charts,
    how to make effective and varied bar charts, and many ways to work with different
    data types. Each chapter has been foundational to your understanding of good data
    visualization and has given you the tools necessary to build the right charts.
    But now, you’re going to take that knowledge one step further with the introduction
    of dynamic elements.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 直到这一点，我们一直专注于识别正确的可视化方式来回答关键问题。您已经学会了在何时使用饼图，如何制作有效和多样化的条形图，以及处理不同数据类型的多种方法。每一章都对您理解良好的数据可视化至关重要，并为您提供了构建正确图表所需的工具。但现在，通过引入动态元素，您将进一步扩展这些知识。
- en: We named this chapter “Constructing Dynamic Analyses” because you will be using
    a variety of features within Tableau to manipulate visualizations, changing the
    way data is displayed, providing user input, and creating charts that are customized
    to the audience’s interests. Unlike the other strategies in this book, everything
    discussed in this chapter will result in several (sometimes infinite) permutations
    of a visual. We’ll be providing you baseline ideas and the building blocks for
    incorporating dynamic elements into your own data projects. We hope your takeaway
    from this chapter is how to effectively add interactivity and customization for
    your audience and use case.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将本章命名为“构建动态分析”，因为您将使用 Tableau 中的各种功能来操作可视化，改变数据显示方式，提供用户输入，并创建根据观众兴趣定制的图表。与本书中的其他策略不同，本章讨论的每一点都将导致可视化的多种（有时是无限的）排列组合。我们将为您提供基础理念和动态元素的构建模块，供您将其整合到自己的数据项目中。我们希望您从本章中学会如何有效地为观众和使用情景增加交互性和定制性。
- en: In the first case study, you will explore how to build several chart variations
    to satisfy your audience with parameters. In the second case study, you will work
    with parameter actions to create dynamic charts that change based on user interaction.
    Finally, you will use set actions to drill down to various date levels and create
    expanding and collapsing tables.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一个案例研究中，您将探索如何构建多种图表变体，以满足观众需求的参数。在第二个案例研究中，您将使用参数操作创建基于用户交互改变的动态图表。最后，您将使用集合操作来深入到各种日期级别，并创建可展开和折叠的表格。
- en: Parameters
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参数
- en: We’ve introduced parameters a few times throughout the book (namely, in [Chapter 1](ch01.xhtml#categorical_analysis)),
    when we used a simple parameter to limit a bar chart to a Top N (in our case,
    10) number of merchant categories. Before we dive deeper, let’s walk through a
    brief refresher.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中我们已经几次介绍了参数（特别是在[第 1 章](ch01.xhtml#categorical_analysis)），当我们使用简单的参数将柱状图限制在商户类别的前
    N（在我们的案例中为 10）个类别时。在我们深入讨论之前，让我们简单回顾一下。
- en: '*Parameters* in Tableau are dynamic entry fields that you can use in your visualizations.
    You can set them as the following field types: float, integer, string, Boolean,
    date, and datetime. They allow you or your audience to pick a variable that exists
    outside a dataset. These variables can be used to change the way visualizations
    are displayed, what field values are set to, or as complex filters, just to name
    a few.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*Tableau* 中的*参数* 是您可以在可视化中使用的动态输入字段。您可以将它们设置为以下字段类型：浮点数，整数，字符串，布尔值，日期和日期时间。它们允许您或您的观众选择存在于数据集之外的变量。这些变量可用于更改可视化方式显示的方式，设置字段值，或作为复杂的过滤器，仅举几例。'
- en: Additionally, you can define default behaviors associated with them. You can
    set them as a static list—either from manual entry or derived from a field, or
    as a range of values (for dates and numbers), or allow them to be free for any
    entry of the same data type. Over the following strategies, we’ll explore examples
    that take advantage of parameters in straightforward as well as less obvious ways.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以定义与它们相关的默认行为。您可以将它们设置为静态列表——可以是手动输入或从字段派生，也可以是值范围（适用于日期和数字），或允许它们自由输入相同数据类型的任何条目。在接下来的策略中，我们将探索利用参数的示例，无论是以明显的还是不明显的方式。
- en: 'Using Parameters to Change Measures and Dimensions: Office Essentials Case
    Study'
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用参数更改度量和维度：办公室必备案例研究
- en: One of the most popular ways to work with parameters in Tableau is to use them
    as a way for the audience to define which measures they want to view as well as
    to display charts by a dimension of their choosing.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在Tableau中使用参数的最流行方法之一是将其用作观众定义希望查看的度量的一种方式，以及通过选择的维度显示图表。
- en: As an office supply store, OE is managing tens of thousands of SKUs across many
    demographics—from individuals making purchases in local stores to corporate accounts
    with standing orders. As such, company executives are interested in tracking many
    key metrics. If you were to build a chart for each one, you would end up with
    many dashboards and reports. How can you avoid report proliferation?
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一家办公用品商店，OE正在管理数以万计的SKU，涵盖多个人群，从在当地店铺购买的个人到具有固定订单的企业客户。因此，公司高管对跟踪许多关键指标感兴趣。如果您为每一个建立图表，您将会得到许多仪表板和报告。您如何避免报告泛滥呢？
- en: Let’s take a closer look at leveraging parameters so you can have the same type
    of chart represent many types of analysis.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更详细地看看如何利用参数，以便您可以用相同类型的图表表示许多类型的分析。
- en: 'Strategy: Use a Parameter to Change a Measure in a Bar Chart'
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用参数来改变柱状图中的度量。
- en: Delving further into our scenario, imagine the Sales team at OE wants to be
    able to compare many metrics—namely Sales, Profit Ratio, Number of Orders, and
    Quantity for different Sub-Categories of product types. This request may seem
    benign, but imagine that this request is supposed to live on a Sales dashboard.
    If four bar charts for each metric were put on one dashboard, very little space
    would remain for anything more. Sure, you could switch the charts to a table,
    but as we’ve discussed, tables don’t allow for the same visual comparisons that
    bar charts afford. So instead, a parameter will serve as the control for the audience
    to select which measure they want displayed.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 进一步深入我们的场景，想象一下OE销售团队希望能够比较许多指标——即销售额、利润比率、订单数量和产品类型的不同子类别的数量。这个请求看起来可能是无害的，但请想象一下，这个请求应该放在一个销售仪表板上。如果每个度量标准的四个柱状图都放在一个仪表板上，几乎没有空间用于其他内容。当然，您可以将图表切换为表格，但正如我们讨论过的，表格不允许进行与柱状图所提供的相同视觉比较。因此，参数将作为观众选择要显示的度量的控制器。
- en: Tip
  id: totrans-14
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: Basic parameters can be used in visualizations without being a part of calculated
    fields, but most parameters, especially in more sophisticated techniques, will
    require use within one or many calculated fields.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 基本参数可以在可视化中使用，而不需要成为计算字段的一部分，但是大多数参数，特别是在更复杂的技术中，将需要在一个或多个计算字段中使用。
- en: 'Create a parameter called `**[Select A Metric]**` and make it a data type of
    Integer. Set the “Allowable values” option to List. Enter the following values
    in the list:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[选择一个度量]**`的参数，并将其数据类型设置为整数。将“允许的值”选项设置为列表。在列表中输入以下值：
- en: '| **Value** | **Display As** |'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **值** | **显示为** |'
- en: '| --- | --- |'
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `1` | `Sales` |'
  id: totrans-19
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `1` | `销售额` |'
- en: '| `2` | `Profit Ratio` |'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `2` | `利润比率` |'
- en: '| `3` | `# Orders` |'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `3` | `# 订单` |'
- en: '| `4` | `Quantity` |'
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `4` | `数量` |'
- en: Tip
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: We recommend creating these types of parameters as integers. When you do this,
    the integer is aliased as the Display As option in the parameter controller, but
    calculations will evaluate based on the Value. Integers are faster to process
    than strings within calculations and will also make your calculated fields shorter
    and faster to create.
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们建议将这些类型的参数创建为整数。这样做时，整数会作为参数控制器中的“显示为”选项别名，但计算将基于值进行评估。在计算中，整数比字符串处理更快，也会使您的计算字段更短，创建速度更快。
- en: 'Create a calculated field called `**[Selected Metric]**`. Using a case statement,
    enter the following:'
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[选择的度量]**`的计算字段。使用一个case语句，输入以下内容：
- en: '[PRE0]'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Tip
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: Remember that calculated fields need to either be row level or aggregated. Since
    [Profit Ratio] and [# Orders] will need to be pre-aggregated, the other two measures,
    [Sales] and [Quantity], are included as aggregates.
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 记住，计算字段需要是行级或聚合的。因为[利润比率]和[# 订单]需要预先聚合，所以另外两个度量值[销售额]和[数量]被包括为聚合。
- en: Drag [Selected Metric] onto the Columns shelf and drag [Sub-Category] onto the
    Rows shelf. Right-click [Sub-Category] and sort by [Selected Metric] in Descending
    order.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[选择的度量]拖放到列架上，并将[子类别]拖放到行架上。右键单击[子类别]，按降序排列[选择的度量]。
- en: 'Edit the title of the sheet by double-clicking the title, and then entering
    the following by using the Insert feature in the Edit Title dialog box:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击标题编辑表格的标题，然后通过使用“插入”功能在编辑标题对话框中输入以下内容：
- en: '[PRE1]'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Right-click the [Select A Metric] parameter in the lower left and select Show
    Parameter. Use the parameter control and notice that the bar chart changes depending
    on the metric and that the sub-categories stay sorted in descending order ([Figure 9-1](#a_bar_chart_whose_measure_changes_with_a)).
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左下角右键单击[选择一个度量]参数，并选择显示参数。使用参数控件，注意柱状图随度量变化而变化，并且子类别保持按降序排序（[图 9-1](#a_bar_chart_whose_measure_changes_with_a)）。
- en: '![A bar chart whose measure changes with a parameter](Images/TAST_0901.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![使用参数更改度量的柱状图](Images/TAST_0901.png)'
- en: Figure 9-1\. A bar chart whose measure changes with a parameter
  id: totrans-34
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-1\. 使用参数更改度量的柱状图
- en: You’ve now created four bar charts, with the use of a parameter and a single
    calculated field. This possibility gives your audience the ability to choose which
    chart is most impactful for them as they navigate through the data shared in dashboards.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用参数和一个计算字段，您现在已经创建了四个柱状图。这种可能性使您的观众能够在他们浏览仪表板中共享的数据时选择最具影响力的图表。
- en: Tip
  id: totrans-36
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: When you use a parameter to toggle between many metrics, you’ll notice that
    the number format changes, but not precisely for each metric. Within Tableau,
    each field can have only one default number type, so a common workaround is to
    create another calculated field that matches the desired number format.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 当您使用参数在多个度量之间切换时，您会注意到数字格式会发生变化，但并非每个度量都完全一样。在Tableau中，每个字段只能有一种默认的数字类型，因此一个常见的解决方法是创建另一个计算字段，以匹配所需的数字格式。
- en: 'Strategy: Use Regex Functions to Dynamically Format a Parameterized Metric'
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用正则表达式函数动态格式化参数化度量
- en: To make your visualizations user-friendly and intuitive, we always recommend
    making numbers match the data types and formatting that they represent. Think
    back to what we’ve said earlier; as the audience reads the chart, there will be
    internal dialogue. Why not help them out, by including a dollar sign or a percentage
    when appropriate?
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使您的可视化更加用户友好和直观，我们始终建议使数字匹配其表示的数据类型和格式。回想一下我们之前所说的，当观众阅读图表时，会有内部对话。为什么不在适当时包括一个美元符号或百分比呢？
- en: 'One approach to creating a formatting calculation that matches the metric type
    is by using regular expressions (regex). These are used to find and sometimes
    extract or replace patterns within a string of text. Regex functions are popular
    in many programming languages, and several exist within Tableau as well. For this
    example, we will use `REGEX_REPLACE()` along with `ROUND()` (the function that
    rounds numbers), and `STR()` (the function that turns numbers into strings) to
    construct well-formatted numeric labels:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 创建匹配度量类型的格式化计算的一种方法是使用正则表达式（regex）。这些用于在文本字符串中查找并有时提取或替换模式。正则表达式函数在许多编程语言中很流行，在Tableau中也有几种。例如，我们将使用`REGEX_REPLACE()`以及`ROUND()`（四舍五入函数）和`STR()`（将数字转换为字符串的函数）来构建格式良好的数值标签：
- en: 'Create a calculated field called `**[Formatted Label]**`:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建名为`**[Formatted Label]**`的计算字段：
- en: '[PRE2]'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Tip
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: While we don’t have time to go into regular expressions in great detail, it
    is enough to describe the repeated pattern shown in the preceding code. `(\d)(?=(\d{3})+$)`
    looks for any patterns of three digits in a row. `$0` inserts a comma after that
    pattern is found. This is done to take a number that has been converted to a string
    and add comma separators back in.
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 虽然我们没有时间详细讨论正则表达式，但足以描述在前面代码中显示的重复模式。`(\d)(?=(\d{3})+$)`查找连续三个数字的任何模式。`$0`在找到该模式后插入逗号。这是为了将转换为字符串的数字添加逗号分隔符而完成的。
- en: Drag the calculated field to Label and change the measure by using the parameter
    control. Your chart should now match [Figure 9-2](#the_regex_has_been_implemented_on_the_ba).
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将计算字段拖到标签中，并使用参数控件更改度量。您的图表现在应与[图 9-2](#the_regex_has_been_implemented_on_the_ba)匹配。
- en: '![The regex has been implemented on the bar chart labels to format numbers
    based on the chosen metric](Images/TAST_0902.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![正则表达式已应用于柱状图标签，以根据选择的度量格式化数字](Images/TAST_0902.png)'
- en: Figure 9-2\. The regex has been implemented on the bar chart labels to format
    numbers based on the chosen metric
  id: totrans-47
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-2\. 正则表达式已应用于柱状图标签，以根据选择的度量格式化数字
- en: 'Strategy: Use a Parameter to Change the Dimension in a Bar Chart'
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用参数改变柱状图的维度
- en: 'So what if your audience also wants a way to change the bar chart from comparing
    Sub-Categories to States, Customers, or Regions? You can apply a similar technique,
    using parameters to create a dynamic dimension:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的观众也想要一种方法来将条形图从比较子类别转变为比较州、客户或地区，你可以应用类似的技术，使用参数创建一个动态维度：
- en: 'Create an integer parameter called `**[Slice By]**` along with a calculated
    field called `**[Selected Dimension]**`:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[切片方式]**`的整数参数，并创建一个名为`**[选择的维度]**`的计算字段：
- en: '| **Value** | **Display As** |'
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **数值** | **显示为** |'
- en: '| --- | --- |'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `1` | `Sub-Category` |'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `1` | `子类别` |'
- en: '| `2` | `State` |'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `2` | `州` |'
- en: '| `3` | `Customer` |'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `3` | `客户` |'
- en: '| `4` | `Region` |'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `4` | `地区` |'
- en: '[PRE3]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Double-click [Sub-Category] on the Rows shelf to edit the field displayed. Then
    erase Sub-Category and replace it with [Selected Dimension], and press Enter.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击行架上的 [子类别] 以编辑显示的字段。然后删除子类别并替换为 [选择的维度]，然后按 Enter 键。
- en: Tip
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: When you change which field is used by editing it on the visualization, it will
    retain any formatting and sorting that has been placed on it. Here, we are using
    this technique to retain the field sort by Selected Metric.
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当你通过编辑可视化来更改使用的字段时，它将保留已放置在其上的任何格式和排序。在这里，我们正在使用这种技术来保留按所选度量排序的字段。
- en: Double-click the title and replace [Sub-Category] with [Slice By]. Show the
    parameter and toggle between the different dimensions. You can also update the
    title with this new parameter. Your final visualization should match [Figure 9-3](#this_bar_chart_allows_the_user_to_change).
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击标题，用 [切片方式] 替换 [子类别]。显示参数并在不同维度之间切换。你也可以使用这个新参数更新标题。你的最终可视化应与图 9-3 相匹配（#this_bar_chart_allows_the_user_to_change）。
- en: '![This bar chart allows the user to change both the metric and the header](Images/TAST_0903.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![这个条形图允许用户更改指标和标题](Images/TAST_0903.png)'
- en: Figure 9-3\. This bar chart allows the user to change both the metric and the
    header
  id: totrans-63
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-3\. 这个条形图允许用户更改指标和标题
- en: Congratulations—you’ve now created what could be 16 different bar charts by
    using two parameters and a few calculated fields. And you’ve also offered a multitude
    of options to your audience for analyzing their data.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你现在已经通过使用两个参数和几个计算字段创建了可能达到 16 种不同的条形图。同时，你也为你的观众提供了多种选项来分析他们的数据。
- en: 'Using Parameters to Set Time Periods and Date Aggregations in Line Charts:
    Office Essentials Case Study'
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用参数在折线图中设置时间段和日期聚合：Office Essentials 案例研究
- en: Now that the OE executives have highly customizable bar charts to better understand
    their sales, they’ve surfaced additional questions. They want to see their data
    trended over time, but aren’t quite sure how to ask for what they’re looking for,
    because it depends on what they’re using the data for. Sometimes they want to
    see weekly data for their biweekly reports, sometimes they want to see it daily
    when a specific promotion is going on, and sometimes they want to see it monthly.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 现在 OE 的高管们拥有了高度可定制的条形图，以更好地理解他们的销售情况，他们提出了额外的问题。他们想要随时间推移来看数据的趋势，但不太确定如何提出他们所寻找的内容，因为这取决于他们使用数据的目的。有时候，他们希望在双周报告中看到每周的数据，有时候在特定促销期间，他们希望每天看到数据，有时候他们想要看到每月的数据。
- en: All are reasonable scenarios and ways to analyze the data, but each one sounds
    like a chart of its own. Are there any simplified solutions? With parameters,
    you can again simplify all this data down to one chart, as shown in [Figure 9-4](#this_line_chart_allows_the_user_to_chang),
    allowing the audience to select which time part they want to use to analyze their
    data.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些都是合理的场景和分析数据的方式，但每一种听起来都像是一个单独的图表。有简化的解决方案吗？通过参数，你可以再次将所有这些数据简化为一个图表，如[图
    9-4](#this_line_chart_allows_the_user_to_chang)所示，让观众选择他们想要用来分析数据的时间部分。
- en: '![This line chart allows the user to change the level at which dates are displayed](Images/TAST_0904.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![这个折线图允许用户更改日期显示级别](Images/TAST_0904.png)'
- en: Figure 9-4\. This line chart allows the user to change the level at which dates
    are displayed
  id: totrans-69
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-4\. 这个折线图允许用户更改日期显示级别
- en: 'Strategy: Use a Parameter to Change the Date in a Line Chart'
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用参数来更改折线图中的日期
- en: 'In this strategy, you’ll create the line chart in [Figure 9-4](#this_line_chart_allows_the_user_to_chang):'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，你将创建图 9-4 中的折线图：
- en: 'Create an integer parameter called `**[Display By]**`:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[显示方式]**`的整数参数：
- en: '| **Value** | **Display As** |'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| **数值** | **显示为** |'
- en: '| --- | --- |'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `1` | `Daily` |'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `1` | `每天` |'
- en: '| `2` | `Weekly` |'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `2` | `每周` |'
- en: '| `3` | `Monthly` |'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| `3` | `每月` |'
- en: 'Create three custom date fields, from the field Order Date: [Days Date Value],
    [Week Numbers Date Value], and [Months Date Value]. Remember, you can create these
    by right-clicking the [Order Date] field, using the drop-down list for the date
    precision, and selecting Date Value.'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建三个自定义日期字段，从订单日期字段开始：[Days Date Value]、[Week Numbers Date Value] 和 [Months
    Date Value]。请记住，您可以通过右键单击[Order Date]字段，使用日期精度的下拉列表，并选择日期值来创建这些字段。
- en: 'Create a calculated field called `**[Selected Date]**`:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[选择的日期]**`的计算字段：
- en: '[PRE4]'
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Right-click and drag [Selected Date] onto the Columns shelf, choosing the first
    option, Selected Date (Continuous). Drag `SUM([Sales])` to Rows. Show the [Display
    By] parameter and toggle between different time values. Make a matching title
    by using the parameter, shown in [Figure 9-5](#this_line_chart_incorporates_filtering_t).
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击并拖动[选择的日期]到列架上，选择第一个选项，选定的日期（连续）。将`SUM([Sales])`拖到行中。显示[Display By]参数，并在不同的时间值之间切换。通过使用参数显示匹配的标题，如[图9-5](#this_line_chart_incorporates_filtering_t)所示。
- en: At this point, you may be questioning why we aren’t using the built-in date
    hierarchy features in Tableau to allow the audience to drill down and up, through
    various date levels. We have found that the experience often is less than intuitive,
    leading to overdrilling, too many options, or periods of time during which data
    is truncated and shows a less-than-accurate-picture.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '此时，您可能会质疑为什么我们不使用Tableau中的内置日期层次特性，以便观众可以通过各种日期级别进行下钻和上升。我们发现，这种体验通常不够直观，会导致过度钻取、过多选项，或者在截断数据并显示不够准确的情况下。 '
- en: Indeed, in this view, when we switch to weekly, the week of 12/29/2019 appears
    to be down a significant amount, but that is only because the data for this week
    includes just three days. Typically, when we build these charts, we will also
    build in hidden date filters to ensure that no matter what time part is selected,
    a full amount of time is displayed.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，在这个视图中，当我们切换到周视图时，2019年12月29日这一周的数据似乎下降了很多，但这仅因为这一周的数据仅包含了三天。通常情况下，当我们构建这些图表时，我们还会添加隐藏的日期过滤器，以确保无论选择了哪个时间段，都能显示完整的时间。
- en: '![This line chart incorporates filtering that changes based on the time part
    selected](Images/TAST_0905.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![此折线图包含根据所选时间部分更改的过滤器](Images/TAST_0905.png)'
- en: Figure 9-5\. This line chart incorporates filtering that changes based on the
    time part selected
  id: totrans-85
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图9-5. 此折线图包含根据所选时间部分更改的过滤器
- en: 'Strategy: Add Hidden Date Filters to Prevent Truncated Time Parts'
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：添加隐藏的日期过滤器以防止截断的时间部分
- en: To prevent truncated date parts, you can add more calculated fields that serve
    as filters. These will limit data appropriately, ensuring that the audience is
    looking at full time periods. And after asking around, you’ve found the most popular
    time window for each cut of time (daily, weekly, monthly). For daily, most end
    users want to see at most the last 30 days. For weekly, they’re looking back 13
    weeks, and for monthly, they’re looking at the last 12 months.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 为了防止截断日期部分，您可以添加更多作为过滤器的计算字段。这些将适当地限制数据，确保观众查看完整的时间段。询问后，您已找到每个时间切片（日常、每周、每月）的最受欢迎的时间窗口。对于日常，大多数最终用户希望查看最多最近的30天。对于每周，他们希望回顾过去的13周，对于每月，他们查看过去的12个月。
- en: 'Continuing with the chart from the previous strategy, you’ll now implement
    this dynamic filtering:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 按照前一战略的图表继续进行，现在您将实施这种动态过滤：
- en: 'Create a calculated field that identifies the latest date in the dataset:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个计算字段，用于识别数据集中最新的日期：
- en: '[PRE5]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Tip
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: When writing fixed LOD expressions, you don’t have to include the modifier `fixed`
    when applied to the entire dataset. This is a handy way to save time and easily
    identify what the LOD is computing.
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当编写固定的LOD表达式时，如果应用于整个数据集，则不必包括修饰符`fixed`。这是一个省时的方法，可以轻松地识别LOD正在计算的内容。
- en: 'Make a calculated field called `**[Limit Date]**`:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[限制日期]**`的计算字段：
- en: '[PRE6]'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Tip
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: Whenever you’re building calculated fields that limit dates, we always recommend
    identifying the most recent date programmatically. An LOD is an easy way to do
    this, but you could also switch this up and make it a user input (aka another
    parameter).
  id: totrans-96
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 每当您构建限制日期的计算字段时，我们始终建议以编程方式识别最新的日期。LOD是这样做的一种简便方式，但您也可以改变方式，使其成为用户输入（另一个参数）。
- en: Drag the [Limit Date] field onto your Filters shelf and select True.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[限制日期]字段拖放到您的筛选架上，并选择True。
- en: 'As a final touch, build a calculated field that explains how much data is being
    shown for each time part selected. Drag that onto Detail and then add it to your
    title:'
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为最后的修饰，构建一个计算字段，解释每个选择的时间部分显示多少数据。将其拖放到详细信息中，然后添加到您的标题中：
- en: '[PRE7]'
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Now you’ve provided the audience with charts (as shown in [Figure 9-5](#this_line_chart_incorporates_filtering_t))
    that are customizable to different time parts and popular time periods. You’ve
    also built in guardrails for the audience. They won’t find themselves comparing
    truncated weeks of data to each other, and when they look back at the data at
    a later date, the charts will have updated in time.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您已经为观众提供了可以根据不同的时间部分和流行时间段定制的图表（如[图 9-5](#this_line_chart_incorporates_filtering_t)所示）。您还为观众建立了防护栏。他们不会发现自己在比较截断的数据周之间，当他们在以后回顾数据时，图表将随时间更新。
- en: 'Using Parameter Actions to Change Trended Metrics: SAGE Digital Marketing Case
    Study'
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用参数操作来更改趋势度量：SAGE 数字营销案例研究
- en: SAGE Digital Marketing wants to take the concept of allowing end users the flexibility
    to choose their metrics a step further. Now, instead of just allowing them to
    select from a drop-down list, they want to integrate that functionality directly
    into the visualization itself. How would you build a visualization enabling the
    user to click a metric to automatically display more information?
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: SAGE 数字营销希望进一步发展允许最终用户灵活选择其指标的概念。现在，他们不仅仅允许用户从下拉列表中选择，还希望将该功能直接集成到可视化中。您如何构建一个可视化，使用户能够点击一个指标以自动显示更多信息？
- en: 'To get this functionality to work, you’ll be relying on *parameter actions*.
    First introduced in Tableau 2019.2, these allow end users to inject (or set) a
    parameter value by using a dashboard or worksheet action. Dashboard and worksheet
    actions are described in greater depth in [Chapter 12](ch12.xhtml#building_dashboards_and_data_products),
    so for now it is enough to know that an *action* is a way to specify a condition
    (like clicking a bar within a chart) and having something happen as a result.
    The most basic action is a *filter action*: a user clicks East Region, and the
    surrounding charts in the dashboard filter to East. With the inclusion of parameter
    actions, the user can now click East Region and have a parameter set to East Region.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 要使此功能正常工作，您将依赖于*参数操作*。这些操作最早在Tableau 2019.2中引入，允许最终用户通过使用仪表板或工作表操作来注入（或设置）参数值。仪表板和工作表操作将在[第
    12 章](ch12.xhtml#building_dashboards_and_data_products)中更深入地描述，因此现在知道*操作*是指定条件的一种方式（如在图表中点击条形），并作为结果发生的事情足够了。最基本的操作是*过滤操作*：用户点击东部地区，仪表板中的周围图表将过滤到东部地区。通过包含参数操作，用户现在可以点击东部地区，并设置一个参数为东部地区。
- en: 'Strategy: Change a Metric Dynamically Using Parameter Actions and Measure Names'
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用参数操作和度量名称动态更改度量
- en: 'In this strategy, we’ll build a visualization with a metric the user can click
    to display information:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，我们将构建一个可视化，用户可以点击其中一个指标来显示信息：
- en: Create a single sheet with KPIs by using [Measure Names] and [Measure Values]
    that includes Clicks, Conversions, Conversion Rate, Cost, Cost per Click, Cost
    per Conversion, Revenue, Revenue per Conversion, and Return on Ad Spend (ROAS);
    see [Figure 9-6](#a_basic_set_of_kpis).
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个包含点击数、转化数、转化率、成本、每次点击成本、每次转化成本、收入、每次转化收入和广告支出回报率（ROAS）的[KPI](#a_basic_set_of_kpis)的单一工作表，使用[度量名称]和[度量值]。
- en: '![A basic set of KPIs](Images/TAST_0906.png)'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![一组基本的KPI](Images/TAST_0906.png)'
- en: Figure 9-6\. A basic set of KPIs
  id: totrans-108
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-6\. 一组基本的KPI
- en: Now create a String parameter called `**[Marketing Metric]**`. Leave the “Current
    value” set to 1 and “Allowable values” set to All.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在创建一个名为`**[营销指标]**`的字符串参数。将“当前值”设置为 1，“允许值”设置为全部。
- en: Tip
  id: totrans-110
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: While we just recommended using integers for metric selection parameters, when
    using Measure Names along with parameter actions, you must use a String data type.
    This is because the name of the measure (Clicks) is set to the current value.
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 尽管我们建议使用整数作为度量选择参数，但在使用度量名称和参数操作时，必须使用字符串数据类型。这是因为度量的名称（点击）设置为当前值。
- en: 'Create a calculated field that displays when a marketing metric is chosen:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个计算字段，显示选择了哪个营销指标：
- en: '[PRE8]'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Create a horizontal bar chart showing the Selected Marketing Metric by Service
    Area. Add both the KPI worksheet and bar chart to a new dashboard.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个水平条形图，显示按服务区域划分的所选营销指标。将KPI工作表和条形图都添加到一个新的仪表板中。
- en: Create the dashboard action to change the parameter by choosing Dashboard →
    Actions. In the Actions dialog box, click Add Action → Change Parameter.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建仪表板操作以通过选择仪表板→操作来更改参数。在操作对话框中，单击添加操作→更改参数。
- en: In the Edit Parameter dialog box, shown in [Figure 9-7](#configuration_screen_for_parameter_actio),
    set the functionality such that Marketing KPIs is the source—that is, the worksheet
    that when interacted with will cause a change. Set Marketing Metric as the target
    parameter, whose value will change. The field value that will be put into the
    parameter is Measure Names.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在编辑参数对话框中，如[图 9-7](#configuration_screen_for_parameter_actio)所示，设置功能，使得营销关键绩效指标成为源——即与之交互将导致变化的工作表。将营销度量设为目标参数，其值将发生变化。参数中将要放入的字段值是测量名称。
- en: '![Configuration screen for parameter action](Images/TAST_0907.png)'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![参数操作配置屏幕](Images/TAST_0907.png)'
- en: Figure 9-7\. Configuration screen for parameter action
  id: totrans-118
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-7\. 参数操作配置屏幕
- en: Now when a user wants to see a bar chart based on any of these metrics, instead
    of a drop-down list, they can click the metric directly, as shown in [Figure 9-8](#the_output_when_the_user_selects_clicks).
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在，当用户希望基于任何这些指标查看柱状图时，他们可以直接点击指标，如[图 9-8](#the_output_when_the_user_selects_clicks)所示。
- en: '![The output when the user selects Clicks (top), and when the user selects
    Conversion Rate (bottom)](Images/TAST_0908.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![用户选择点击时的输出（顶部），以及用户选择转化率时的输出（底部）](Images/TAST_0908.png)'
- en: Figure 9-8\. The output when the user selects Clicks (top), and when the user
    selects Conversion Rate (bottom)
  id: totrans-121
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-8\. 用户选择点击时的输出（顶部），以及用户选择转化率时的输出（底部）
- en: 'Using Parameter Actions to View Daily and 7-Day Average Value: SAGE Digital
    Marketing Case Study'
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用参数操作查看每日和7天平均值：SAGE数字营销案例研究
- en: One of the interesting things about the world of digital marketing is that every
    day a significant amount of fluctuation occurs in the data that’s read out. Depending
    on the activity of your competitors, potential customers, and other external factors,
    your business metrics can display a wide range of values.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 数字营销世界中有趣的一点是，每天都会发生大量数据波动。根据竞争对手的活动、潜在客户及其他外部因素，您的业务指标可能会显示一系列值。
- en: To help compensate for this, SAGE Digital Marketing has requested that a moving
    average be added to its report, to smooth out the data. A *moving average* takes
    a data point and a certain number of preceding data points to calculate a value.
    This adds a smoothing effect to data, since the highs and lows of the past *x*
    data points are averaged. But the SAGE executives also want to see the actual
    value.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助弥补这一点，SAGE数字营销要求在其报告中添加一个移动平均线，以平滑数据。*移动平均*采用数据点及其之前一定数量的数据点来计算值。这样可以为数据添加平滑效果，因为过去*x*个数据点的高低值被平均。但是，SAGE的高管们也想看到实际值。
- en: How would you represent the actual value and the moving average at the same
    time?
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 如何同时表示实际值和移动平均值？
- en: 'Strategy: Compute a 7-Day Moving Average Reference Line That Dynamically Changes
    with a Date Selection'
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：计算动态更改的7天移动平均参考线，具体是通过日期选择
- en: 'Using the same dataset from the previous strategy, you’ll introduce parameter
    actions to dynamically change the moving average:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 使用前一个策略中的相同数据集，您将引入参数操作以动态更改移动平均线：
- en: Create a line chart showing Revenue by Day.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一张显示按天分组的收入线图。
- en: 'Create a parameter called `**[Selected Date]**` and make it a date field with
    all allowable values:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[选择的日期]**`的参数，并将其设为包含所有可允许值的日期字段：
- en: 'Create a calculated field called `**[Time Window]**`:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[时间窗口]**`的计算字段：
- en: '[PRE9]'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Create another calculated field called `**[Time Window Revenue]**`:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另一个名为`**[时间窗口收入]**`的计算字段：
- en: '[PRE10]'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Drag [Time Window Revenue] to Detail as a sum. Create a reference line by using
    this field, showing the Average value. Change the label to Custom. Unselect “Show
    recalculated lien for highlighted or selected data points.”
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[时间窗口收入]拖动到详细信息中作为总和。使用此字段创建一个参考线，显示平均值。将标签更改为自定义。取消选择“显示高亮或选定数据点的重新计算线”。
- en: 'Create another calculated field called `**[Time Window Date]**`:'
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建另一个名为`**[时间窗口日期]**`的计算字段：
- en: '[PRE11]'
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Drag [Time Window Date] onto Detail as the Minimum.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[时间窗口日期]拖动到详细信息中作为最小值。
- en: Tip
  id: totrans-138
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: Here we are dragging the date as aggregated to avoid the lines on the line chart
    from turning into dots. This method can also be helpful when trying to add dimensions
    to a chart that has table calculations that you don’t want to interfere with.
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在此，我们将日期作为聚合的方式拖拽，以避免线图上的线变成点。当试图向具有不希望干扰的表格计算的图表添加维度时，这种方法也可能会有所帮助。
- en: Create a reference band that goes from the Minimum Time Window Date to the Maximum
    Time Window Date and set the shading to light green.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个参考区间，从最小时间窗口日期到最大时间窗口日期，并将阴影设置为浅绿色。
- en: Create a worksheet action called `**Change Date**` that sets Selected Date to
    DAY([Date]) when the user hovers on the chart.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**Change Date**`的工作表操作，当用户悬停在图表上时，将所选日期设置为DAY([Date])。
- en: 'Now you’ve built a chart that satisfies both conditions from the audience:
    a daily readout and a smoothed average amount for a chosen time period ([Figure 9-9](#a_line_chart_with_a_reference_line_for_t)).'
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在，您已经建立了一个图表，满足了观众的两个条件：每日报告和选择时间段的平滑平均值（[图 9-9](#a_line_chart_with_a_reference_line_for_t)）。
- en: '![A line chart with a reference line for the seven-day moving average related
    to the point selected](Images/TAST_0909.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![带有指定点的七日移动平均参考线的线图](Images/TAST_0909.png)'
- en: Figure 9-9\. A line chart with a reference line for the seven-day moving average
    related to the point selected
  id: totrans-144
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 9-9\. 带有指定点七日移动平均参考线的线图
- en: Sets and Set Actions
  id: totrans-145
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 集合和集合操作
- en: You’ve had some basic firsthand experience with set actions early on in the
    book, but we haven’t yet taken the time to dive deep. In this section, we’ll start
    by explaining what a *set* is. In Tableau, it’s a computed field based off a dimension
    (or dimensions) where you can define the members based on conditions. Those conditions
    can be a manual selection like a list, they can be based on a computed condition
    or value, or they can be a top or bottom grouping based on a field or formula.
    In fact, the options for creating a set match those that are available when you
    use a dimension (blue field) as a filter. Sets can also be combined, meaning you
    can use two conditions to create a subgroup of a dimension.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在书的早期，您对集合操作有了一些基本的第一手经验，但我们还没有花时间深入探讨。在本节中，我们将从解释“*集合*”开始。在Tableau中，它是一个基于维度（或多个维度）的计算字段，您可以根据条件定义成员。这些条件可以是手动选择，例如列表，也可以基于计算的条件或值，或者可以基于字段或公式进行顶部或底部分组。实际上，创建集合的选项与使用维度（蓝色字段）作为过滤器时可用的选项相匹配。集合还可以组合，这意味着您可以使用两个条件创建维度的子组。
- en: 'A practical example of combining two sets and their outcomes is to construct
    a set of the Top 10 Customers by Sales and a set of Top 10 Customers by Quantity
    Sold. Those two sets can be combined in three ways:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 一个结合两个集合及其结果的实际例子是构建一个按销售额前十名和按销量销售前十名的客户集合。这两组可以通过三种方式组合使用：
- en: All members in both sets
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 两组中的所有成员
- en: If a Customer is either in Top 10 by Sales or in Top 10 by Quantity, that Customer
    will be included.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 如果客户既在销售额前十名中，又在销量前十名中，该客户将被包括在内。
- en: Shared members in both sets
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 两组中的共享成员
- en: The Customer is in both Top 10 sets.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 客户同时在前十名中。
- en: Except shared members
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 除了共享成员
- en: This subtracts one set from the other. In this scenario, if the Top 10 Customers
    by Quantity Sold set is subtracted from Top 10 Customers by Sales, you would be
    left with those customers with high sales, but not high quantity.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 这从另一组中减去了一组。在这种情况下，如果按销售额排名前十的客户减去按销量排名前十的客户，您将得到那些销售额高但销量不高的客户。
- en: As a row-level calculation, when you use a set, you can think of it as creating
    a Boolean value behind the scenes to categorize your data. In Tableau, sets have
    unique functionality in the way they can be displayed. First, you can use the
    set as dimensions that will construct an In and Out header and have the members
    in the respective group represented. You can also use sets as filters, filtering
    the data either to the entire In or Out group, or to the members within the In
    group. This means you can use sets to dynamically display either the dimension
    values that meet the set condition or the entire set itself. Finally, you can
    expose the set control and have your end users use it like a pick list.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 作为行级计算，当您使用集合时，可以将其视为在幕后创建布尔值以对数据进行分类。在Tableau中，集合在显示方式上具有独特功能。首先，您可以将集合用作维度，这将构建一个“包含”和“不包含”头，并在相应组中表示成员。您还可以将集合用作筛选器，将数据筛选到整个“包含”或“不包含”组，或者筛选到“包含”组中的成员。这意味着您可以使用集合动态显示符合集合条件的维度值或整个集合本身。最后，您可以公开集合控件，并让最终用户将其用作选项列表。
- en: Now, on to *set actions*, first introduced in Tableau 2018.3\. With a set action,
    you’re taking the first type of set, from which members are manually selected
    from a pick list, and instead of that being a one-time task, members are added
    and subtracted from the pick list based on user interactivity. This has powerful
    implications because you are giving your end users the ability to create ad hoc
    groupings of data. The end user can also dynamically define members that are either
    In or Out of the set, which is useful for filtering. As you saw in [Chapter 1](ch01.xhtml#categorical_analysis),
    a common use case for set actions is to dynamically change the granularity of
    data based on interactivity.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，关于*集合操作*，这是在Tableau 2018.3中首次引入的。通过集合操作，您正在采取第一种类型的集合，从中手动从选项列表中选择成员，而不是作为一次性任务，根据用户的交互添加和减少成员。这具有强大的影响，因为您正在赋予最终用户创建数据的临时分组的能力。最终用户还可以动态定义是“包含”还是“不包含”集合的成员，这对于筛选非常有用。正如您在[第1章](ch01.xhtml#categorical_analysis)中看到的，集合操作的常见用例之一是根据交互动态更改数据的粒度。
- en: In the next two strategies, we will expand on drilling into data with set actions
    and combine them with filtering and custom formatting to generate a compelling
    and intuitive user experience.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的两个策略中，我们将扩展使用集合操作进行数据钻取，并将其与筛选和自定义格式化结合，生成引人入胜且直观的用户体验。
- en: 'Using Set Actions to Drill Down and Filter Data: Digital Marketing Case Study'
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用集合操作进行数据下钻和筛选：数字营销案例研究
- en: SAGE is looking back at its digital marketing data after receiving an interesting
    request from end users. The executives typically like to look at weekly performance,
    but sometimes, especially if there is a particularly great week in terms of user
    engagement, they like to drill into daily volumes and isolate any content that
    could have potentially contributed. Unlike the prior concepts we’ve discussed,
    in this scenario they want to have flexibility to drill down to what is interesting
    to them instead of being confined to showing all the daily data or a pre-filtered
    subset.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: SAGE在收到来自最终用户的有趣请求后，正在回顾其数字营销数据。高管们通常喜欢查看每周业绩，但有时，特别是如果某周在用户参与方面表现特别突出，他们会喜欢深入了解每日量，并分离出可能有助于业绩的任何内容。与我们之前讨论过的概念不同，在这种情况下，他们希望有灵活性，可以根据兴趣钻取数据，而不是仅显示所有每日数据或预筛选的子集。
- en: This presents an interesting problem. How would you approach it? Let’s take
    a closer look at how this can be solved by implementing set actions, which allow
    the user to select a data point and see more detailed data within the point.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 这提出了一个有趣的问题。您会如何解决它呢？让我们更详细地看一下如何通过实施集合操作来解决这个问题，这允许用户选择一个数据点并查看该点内的更详细数据。
- en: 'Strategy: Drill from Week to Date in a Line Chart'
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：在折线图中从周到日期进行钻取
- en: 'Starting with a new worksheet, follow these steps to introduce drill-down interactivity:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 从新工作表开始，按照以下步骤介绍下钻交互性：
- en: Create two custom date fields, one that is a Date at the Day level, and one
    that is a Date at the Week level. Drag the week-level calculation to the Marks
    card.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建两个自定义日期字段，一个是日期在日级别上，另一个是日期在周级别上。将周级别的计算拖动到标记卡上。
- en: Create a set based on the week-level date. Click the All button to select all
    the values and name the set `**Included Dates Set**`.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据每周日期创建一个集合。单击“全部”按钮以选择所有数值，并命名该集合`**包含的日期集合**`。
- en: Create a set action called `**Drill Date**` that runs on select, configure it
    to “Add values to set” when run, and when clearing “Remove all values from set.”
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**Drill Date**`的集合操作，当选择时运行，配置为“添加到集合中的值”，清除时“从集合中删除所有值”。
- en: 'Create a calculated dimension based on the set, and place it as the [Date]
    field on the Columns shelf:'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个基于集合的计算维度，并将其放置在[日期]字段上。
- en: '[PRE12]'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: At this point, the interactivity you have built will cause the week date marks
    to change to daily. However, both will still be visible in the view. The last
    part of this strategy will be to add a filter for the dates, to ensure that you’re
    drilling *and* filtering to the daily view.
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 到此为止，您建立的互动将导致周日期标记变更为每日标记。但是，这两者仍将在视图中可见。此策略的最后一部分是为日期添加一个过滤器，以确保您正在进行钻取并将其过滤到每日视图。
- en: 'Create a calculated field called `**[Filter Date]**`:'
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Filter Date]**`的计算字段：
- en: '[PRE13]'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Tip
  id: totrans-170
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: This calculation determines the number of dates that are included in the set.
    If there are one or more dates in the set, the calculation will filter to include
    only those in the set. Otherwise, if there are 0 or NULL members in the set, the
    entire line chart will show.
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此计算确定包含在集合中的日期数量。如果集合中有一个或多个日期，则计算将过滤以仅包括其中的日期。否则，如果集合中有0个或NULL成员，则整个折线图将显示。
- en: Add some final formatting to the sheet by building a calculated field to dynamically
    change when the granularity of the data changes; this will use the same logic
    as the date filter. Bring it on to Detail as Attribute.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过构建一个计算字段来为工作表添加一些最终格式化，以动态更改数据粒度时进行动态更改；这将使用与日期过滤器相同的逻辑。将其作为属性添加到详细信息中。
- en: '[PRE14]'
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Tip
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: Bringing the formatting field on as an attribute will ensure that the mark selections
    still stay highlighted when you change from one date level to another. Otherwise,
    after you select a mark, the value will no longer be a part of it and will cause
    the mark to deselect.
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将格式化字段作为属性添加将确保在从一个日期级别更改到另一个日期级别时，标记选择仍然保持高亮显示。否则，在选择标记后，该值将不再是其一部分，会导致标记取消选择。
- en: Using this logic, you’ve now deployed a line chart that can dynamically change
    from weeks to days, as shown in [Figure 9-10](#a_line_chart_by_week_left_parenthesislef).
    This technique and interactivity follows the flow of analysis of the end user.
    Someone can come in, inspect the weekly data, and then quickly drill into a particular
    week to see more-granular daily data.
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用此逻辑，您现在部署了一个可以动态从周变为天的折线图，如[图9-10](#a_line_chart_by_week_left_parenthesislef)所示。这种技术和互动遵循最终用户的分析流程。有人可以进来，检查每周的数据，然后迅速钻取到特定周，查看更细粒度的每日数据。
- en: '![A line chart by week (left), and after selecting weeks, the data is drilled
    to the day (right)](Images/TAST_0910.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![按周的折线图（左），选择周后，数据钻取到每日（右）](Images/TAST_0910.png)'
- en: Figure 9-10\. A line chart by week (left), and after selecting weeks, the data
    is drilled to the day (right)
  id: totrans-178
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图9-10. 按周的折线图（左），选择周后，数据钻取到每日（右）
- en: In addition to using set actions to dynamically drill down on time parts, they
    can also be used to drill into tables. Has anyone ever said to you, “I want to
    see more detail for this area?” When they do, it is often a signal that you have
    hierarchical data and they’re looking to see it disaggregated. What they’d love
    to have is a table where they can “expand” a category to see the child members
    as they see fit. Unlike a built-in hierarchy within Tableau, set actions enable
    you to provide your users the opportunity to choose a category that presents more
    detail, giving them the ability to see both aggregated information for categories
    of less concern and disaggregated data of a particular category, all in the same
    view.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 除了使用集合操作动态地深入研究时间部分外，它们也可以用于深入研究表格。有人曾对你说过：“我想看到这个区域的更多细节吗？”当他们这样做时，通常意味着您拥有分层数据，他们希望看到数据细分。他们希望拥有一张表格，在这张表格中，他们可以“展开”一个类别，以便根据需要查看其子成员。与Tableau内置的层次结构不同，集合操作使您能够让用户选择一个类别，从而提供更详细的信息，使他们能够在同一视图中查看较少关注的类别的聚合信息和特定类别的细分数据。
- en: With our marketing data, this problem presents itself in the scenario of having
    users who want to drill into a service area of interest and then visually review
    the metrics associated with each zip code. They don’t want to be inundated with
    extra zip code detail for territories that are of less interest.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的营销数据中，这个问题表现为用户希望深入研究感兴趣的服务区域，然后视觉审查与每个邮政编码相关的指标。他们不希望为那些兴趣较少的领土添加额外的邮政编码详细信息。
- en: 'Strategy: Expand a Section of a Data Table'
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：展开数据表的一部分
- en: 'In this strategy, you’ll build interactivity that allows a data table to expand
    and collapse using set actions:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您将构建允许数据表通过集合操作展开和折叠的交互性：
- en: Create a data table that shows Cost, Clicks, Cost per Click, Conversions, Conversion
    Rate, and Rev. per Conversion by Service Area.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个显示按服务区域分组的成本、点击次数、每点击成本、转化、转化率和每转化收入的数据表。
- en: Create a set called `**[Selected Service Area]**` based on [Service Area], and
    include all values in the set.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[选定服务区域]**`的集合，基于[服务区域]，并包括集合中的所有值。
- en: 'Create a calculated field called `**[Show Zip Code]**` and place it to the
    right of [Service Area] on the Rows shelf:'
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[显示邮政编码]**`的计算字段，并将其放置在行架上的[服务区域]右侧：
- en: '[PRE15]'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Create a set action based on the new set, and configure the action to run on
    Select. Configure it such that running the action will “Assign values to set”
    and when clearing the selection it will “Remove all values from set.”
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于新集合创建一个集合操作，并配置该操作在选择时运行。配置操作以“分配值到集合”，并在清除选择时“从集合中移除所有值”。
- en: Now when a user clicks a service area, the table will dynamically expand to
    show the zip codes that are a part of that service area. To finish up, we recommend
    adding the following final touches.
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在，当用户点击服务区域时，表格将动态展开以显示该服务区域的邮政编码。为了完成，我们建议添加以下最后的触摸。
- en: 'Create a calculated field called `**[Drill Symbol]**`:'
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[钻取符号]**`的计算字段：
- en: '[PRE16]'
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Create a calculated field called `**[Zip Code Header]**`:'
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[邮政编码标头]**`的计算字段：
- en: '[PRE17]'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Drag the new calculated fields onto the Rows shelf, placing [Drill Symbol] after
    [Service Area], and [Zip Code Header] after [Show Zip Code]. Right-click [Show
    Zip Code] and hide the header. Right-click the headers and select Hide Field Label
    Rows. Adjust row banding and formatting as desired. Your visualization should
    now resemble [Figure 9-11](#the_marketing_metrics_aggregated_by_serv).
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新的计算字段拖放到行架上，将[钻取符号]放置在[服务区域]后，将[显示邮政编码]放置在[钻取符号]后。右键单击[显示邮政编码]并隐藏标题。右键单击标题并选择隐藏字段标签行。根据需要调整行间隔和格式。现在您的可视化应该类似于[图9-11](#the_marketing_metrics_aggregated_by_serv)。
- en: '![The marketing metrics aggregated by Service Area (top), and the chart after
    clicking the expand button for North to show the zip codes (bottom)](Images/TAST_0911.png)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![按服务区域聚合的营销指标（上），以及单击扩展按钮以显示北部邮政编码的图表（下）](Images/TAST_0911.png)'
- en: Figure 9-11\. The marketing metrics aggregated by Service Area (top), and the
    chart after clicking the expand button for North to show the zip codes (bottom)
  id: totrans-195
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图9-11。按服务区域聚合的营销指标（上），以及单击扩展按钮以显示北部邮政编码的图表（下）
- en: While it may take a little bit of time to add extra formatting details, trust
    us when we say it’s worth it. These small design decisions tally up to a good
    user experience (something we will explore in more detail in [Chapter 12](ch12.xhtml#building_dashboards_and_data_products)).
    And you’ve added functionality that is now more familiar to your audience.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然添加额外的格式细节可能需要一些时间，但当我们说值得时，请相信我们。这些小设计决策累计起来形成良好的用户体验（我们将在[第12章](ch12.xhtml#building_dashboards_and_data_products)中更详细地探讨）。并且您已经增加了更为熟悉于您的受众的功能。
- en: The type of functionality and interactivity that set actions bring to visualizations
    is something both familiar and popular with end users. Implementing these types
    of features and functionality will ultimately result in your audience responding
    more positively to the content you develop. They’re also very likely to be more
    engaged because of the added interactivity.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 集合操作带给可视化的功能和交互性是用户熟悉且喜欢的。实施这些类型的功能和功能最终将导致您的受众对您开发的内容做出更积极的响应。由于增加了这种交互性，他们也很可能更加投入其中。
- en: Animation
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 动画
- en: '*Animation* is a newer concept in the scheme of data visualization. This technique
    was arguably first popularized by Hans Rosling’s Gapminder, which showed how the
    relationship between number of births and life expectancy has changed among all
    countries in the world over the past 50 years. Animation has become increasingly
    more prevalent as software tools for creating visualizations have evolved.'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: '*动画* 是数据可视化方案中的一个较新概念。这种技术最初可以说是由汉斯·罗斯林的Gapminder首次流行化，展示了全球所有国家在过去50年间出生人数和预期寿命之间的关系如何变化。随着用于创建可视化的软件工具的演进，动画变得越来越普遍。'
- en: 'Animations are unique in that they allow visualization developers to display
    more-complex themes, like change over time, transitions, change in rank/order,
    or an emotional/narrative context. By literally “playing” through the data, the
    changes are offloaded from the audience and placed directly into the visual. A
    word of caution here: when using animations, we strongly recommend having someone
    there to describe the story as it unfolds. Because animation typically requires
    a narrator, we think it is best suited in the context of a presentation as opposed
    to a self-service data product.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 动画独特之处在于它们允许可视化开发者展示更复杂的主题，如随时间的变化、过渡、排名/顺序的变化或情感/叙述背景。通过直接“播放”数据，变化从观众身上卸载并直接放入视觉中。在这里需要注意的一点是：当使用动画时，我们强烈建议有人在场描述其展开的故事。因为动画通常需要讲述者，我们认为它最适合在演示的背景下而不是自助数据产品中使用。
- en: Tableau provides two ways that animation can be used. First is with the Pages
    shelf. This feature allows users to “page through,” or construct different views,
    based on the dimension on the shelf. Imagine you have a book, and each page represents
    a day. With the Pages shelf, you can add a controller to move through each page,
    or even automatically flip through them.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau提供两种使用动画的方式。首先是通过页面架构。该功能允许用户“翻页”，或者根据架构上的维度构建不同的视图。想象一下，您有一本书，每一页代表一天。使用页面架构，您可以添加控制器以浏览每一页，甚至可以自动翻转它们。
- en: The second way to use animation in Tableau is to animate marks. When this feature
    is turned on, if marks change position because of filtering or interactivity,
    an animation will automatically be made to show the transition. This can be useful
    at drawing users’ attention as selections are made, or to recognize that the data
    itself has been filtered.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau中使用动画的第二种方法是动画标记。当此功能打开时，如果由于过滤或交互而导致标记位置变化，则会自动进行动画显示过渡。这在用户进行选择时可以吸引注意力，或者可以识别数据本身已经被过滤的情况下非常有用。
- en: 'Competitor Analysis Study: Using Animations to Compare Ranking Performance'
  id: totrans-203
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 竞争对手分析研究：使用动画比较排名表现
- en: For most brands or products, it is natural to have competition. On any given
    day, your company is vying for the most attention from consumers. One popular
    way to measure customer awareness is to compare an engagement metric like web
    page views. A traditional way to analyze this may be to plot the number of page
    views by day, seeing how your company performs, and then also your competitors.
    But what if you want to glean the shuffling for market share that is happening
    in the day-to-day? If that’s the case, animation can help demonstrate the motion
    and movement among peers and tell the story of how your organization is performing.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数品牌或产品来说，有竞争是很自然的。在任何一天，您的公司都在争取吸引消费者的最多关注度。衡量客户意识的一种流行方式是比较网页浏览等参与度指标。传统的分析方法可能是通过按天绘制页面浏览量，看看您的公司表现如何，然后再看看您的竞争对手。但是如果您想了解每天市场份额的动态变化，那么动画可以帮助展示同行之间的移动和变化，并讲述您的组织的表现故事。
- en: In the next strategy, we’re going to work with another dataset from SAGE. This
    dataset has a few competitors and a target company (You) with metrics defining
    their daily rank based on page views.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个策略中，我们将使用来自SAGE的另一个数据集。该数据集具有几个竞争对手和一个目标公司（您），根据页面浏览量定义其每日排名的指标。
- en: 'Strategy: Build an Animated Bump Chart'
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：构建一个动画颠簸图
- en: 'In [Chapter 3](ch03.xhtml#making_comparisons), you learned how to build a bump
    chart, which takes dimensions ranked by a metric and plots the change in rank
    over time. In this example, you’ll take the bump chart a step further by introducing
    custom highlighting and animation:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第三章](ch03.xhtml#making_comparisons)中，您学习了如何构建一个颠簸图，该图根据度量值排名的维度并绘制排名随时间变化的情况。在这个例子中，您将通过引入自定义的高亮和动画，进一步改进颠簸图：
- en: Build a bump chart, showing the Rank by Day for each competitor.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个颠簸图，显示每个竞争对手的每日排名。
- en: Tip
  id: totrans-209
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: Remember, a bump chart is typically a dual-axis chart; the first axis marks
    are circles, and the secondary axis marks are lines. If your measure is continuous,
    reverse the axis, so that 1 is at the top of the chart.
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 记住，凸显图通常是双轴图表；第一个轴标记是圆圈，第二个轴标记是线条。如果您的度量是连续的，请反转轴，使1位于图表顶部。
- en: Create a parameter called `**[Comparison]**` based on the [Competitor] field,
    and remove You from the list.
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个基于[Competitor]字段的参数`**[Comparison]**`，并从列表中删除You。
- en: 'Create a calculated field called `**[Highlight Color]**` that will color You,
    the Comparison Competitor, and all Others in different colors. Put this on Color
    on the Marks card:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Highlight Color]**`的计算字段，用不同颜色着色You、Comparison Competitor和所有Others。将其放置在Marks
    card的颜色上：
- en: '[PRE18]'
  id: totrans-213
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Right-click and drag [Date] as a discrete field onto the Pages shelf. Configure
    the controller to show history for all marks, both trails and marks without fade.
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击并将[日期]作为离散字段拖放到页面架上。配置控制器以显示所有标记的历史记录，包括轨迹和不透明标记。
- en: With animations, you can now tell the story of your brand, starting at position
    6, making some headway and peaking at position 4 about halfway through the time
    period, and ending at position 5\. Likewise, you can visually see Competitor 5
    making a strong push to the top spot toward the end of the time period (as seen
    in [Figure 9-12](#the_initial_ranking_as_compared_to_compe)).
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过动画，您现在可以讲述品牌的故事，从第6名开始，途中取得一些进展，并在时间段的一半左右达到第4名的高峰，并最终在第5名结束。同样，您可以直观地看到竞争者5在时间段结束时向顶点发起强烈冲击（如[图9-12](#the_initial_ranking_as_compared_to_compe)所示）。
- en: An alternative to the bump chart is commonly called a *racing bar chart*. This
    takes the rank of a metric and animates it over time to see the position change
    day by day. It’s called a racing bar chart because each member is vying for position,
    like racers on a track.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 一个替代凸显图通常被称为*racing bar chart*。这种图表将指标的排名进行动画化，以便随时间查看位置变化，就像赛道上的赛车手一样争夺位置。
- en: '![The initial ranking as compared to competitors (top) and the rest of the
    data (bottom)](Images/TAST_0912.png)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![初始排名与竞争对手（顶部）和其余数据（底部）](Images/TAST_0912.png)'
- en: Figure 9-12\. The initial ranking as compared to competitors (top) and the rest
    of the data (bottom)
  id: totrans-218
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图9-12。初始排名与竞争对手（顶部）和其余数据（底部）的比较
- en: 'Strategy: Create a Racing Bar Chart'
  id: totrans-219
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建赛车条形图
- en: 'Using the same dataset, create a new worksheet and do the following:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 使用相同的数据集，创建一个新的工作表，并执行以下操作：
- en: Create a horizontal bar chart with Rank and Page Views.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个水平条形图，包括Rank和Page Views。
- en: Use the Pages shelf to page through each day.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用页面架逐日翻页。
- en: Put the [Highlight Color] calculated field from the previous strategy onto Color.
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将先前策略中的[Highlight Color]计算字段放置在颜色上。
- en: Do not enable history for the Pages shelf.
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不要启用页面架的历史记录。
- en: This type of animated chart takes advantage of changing positions over time,
    while still retaining the magnitude of the measurement. [Figure 9-13](#the_initial_ranking_versus_competitors_l)
    shows that while your brand was ranked sixth in terms of page views, all competitors
    were pretty close. However, Competitor 5 later dominated everyone, leaving you
    at the back of the pack.
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这种类型的动态图表利用时间内的位置变化，同时保持测量的幅度。[图9-13](#the_initial_ranking_versus_competitors_l)显示，尽管您的品牌在页面浏览中排名第六，但所有竞争者都非常接近。然而，竞争者5后来主导了所有人，将您留在包尾。
- en: '![The initial ranking versus competitors (top) and the end ranking (bottom)](Images/TAST_0913.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![初始排名与竞争对手（顶部）和最终排名（底部）](Images/TAST_0913.png)'
- en: Figure 9-13\. The initial ranking versus competitors (top) and the end ranking
    (bottom)
  id: totrans-227
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图9-13。初始排名与竞争对手（顶部）和最终排名（底部）
- en: Conclusion
  id: totrans-228
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: In this chapter, you’ve seen how powerful parameters can be. They allow for
    direct user input, and when combined with calculated fields, allow for complex
    filtering and interactivity. They’re extremely useful for reducing chart proliferation,
    as well as for providing flexibility in chart design (remember how you made a
    line chart change from monthly to weekly data with a drop-down). *Direct user
    input* means that the actions of your audience can define the output of the visualization—making
    for a highly customized ending visual.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您已经看到参数有多么强大。它们允许直接用户输入，并与计算字段结合使用，实现复杂的过滤和交互。它们非常有用，可以减少图表的繁殖，并在图表设计中提供灵活性（记得您是如何通过下拉菜单将线状图从月度数据更改为周度数据的）。*直接用户输入*意味着您的观众的行为可以定义可视化的输出——从而生成高度定制的最终可视化效果。
- en: You’ve also worked with sets more directly and seen the enhanced interactivity
    they bring. If your users are asking for drill capability, use *drill* as a keyword
    to consider how a set action could enhance your charts. And finally, you’ve seen
    how animation can take static charts and make them more compelling. By using movement
    and motion, data stories become easier to tell and more exciting to explore. The
    suite of techniques in this chapter will serve you well in leveling up your data
    products, both analytically and from a user-experience perspective. Refined data
    products built in Tableau are likely to have one or more of these tools employed
    for maximum effect.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 你也直接与集合进行了更多的工作，并看到它们带来的增强互动性。如果你的用户要求钻取功能，可以使用*钻取*作为一个关键词，考虑如何通过集合操作增强你的图表。最后，你已经看到动画如何将静态图表变得更有吸引力。通过运动和动作，数据故事更容易讲述，更令人兴奋。本章的技术组合将在提升你的数据产品分析能力和用户体验方面发挥重要作用。在Tableau中构建的精细数据产品可能会应用一个或多个这些工具以达到最大效果。
- en: In the next chapter, you’ll learn how to enrich your existing datasets to remove
    gaps for dates and values and to construct sophisticated visualizations.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将学习如何丰富你现有的数据集，填补日期和数值的空白，并构建复杂的可视化效果。
