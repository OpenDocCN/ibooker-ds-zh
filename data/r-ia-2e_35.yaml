- en: Appendix G. Updating an R installation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 G. 更新 R 安装
- en: As consumers, we take for granted that we can update a piece of software via
    a “Check for Updates” option. In chapter 1, I noted that the `update.packages()`
    function can be used to download and install the most recent version of a contributed
    package. Unfortunately, updating the R installation itself can be more complicated.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 作为消费者，我们理所当然地认为我们可以通过“检查更新”选项来更新软件。在第 1 章中，我提到可以使用 `update.packages()` 函数下载并安装贡献包的最新版本。不幸的是，更新
    R 安装本身可能更复杂。
- en: 'If you want to update an R installation from version 5.1.0 to 6.1.1, you must
    get creative. (As I write this, the current version is actually 4.1.1, but I want
    this book to appear hip and current for years to come.) Two methods are described
    here: an automated method using the `installr` package and a manual method that
    works on all platforms.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要将 R 安装从 5.1.0 更新到 6.1.1，你必须有创意。（当我写这段话时，当前版本实际上是 4.1.1，但我希望这本书在未来几年里看起来时尚且最新。）这里描述了两种方法：使用
    `installr` 包的自动化方法和适用于所有平台的手动方法。
- en: G.1 Automated installation (Windows only)
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: G.1 自动安装（仅限 Windows）
- en: 'If you’re a Windows user, you can use the `installr` package to update an R
    installation. First install the package and load it:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是一个 Windows 用户，可以使用 `installr` 包来更新 R 安装。首先安装该包并加载它：
- en: '[PRE0]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This adds an Update menu to the RGui (see figure G.1).
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这在 RGui 中添加了一个更新菜单（见图 G.1）。
- en: '![](Images/APPG_F01_Kabacoff3.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/APPG_F01_Kabacoff3.png)'
- en: Figure G.1 Update menu added to Windows RGui by the `installr` package
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 图 G.1 `installr` 包添加到 Windows RGui 中的更新菜单
- en: The menu allows you to install a new version of R, update existing packages,
    and install other useful software produces (such as RStudio). Currently, the `installr`
    package is only available for Windows platforms. For macOS users or Windows users
    who don’t want to use `installr`, updating R is usually a manual process.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 该菜单允许你安装 R 的新版本，更新现有包，并安装其他有用的软件产品（如 RStudio）。目前，`installr` 包仅适用于 Windows 平台。对于
    macOS 用户或不想使用 `installr` 的 Windows 用户，更新 R 通常是一个手动过程。
- en: G.2 Manual installation (Windows and macOS)
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: G.2 手动安装（Windows 和 macOS）
- en: Downloading and installing the latest version of R from CRAN ([http://cran.r-project
    .org/bin](http://cran.r-project.org/bin)) is relatively straightforward. The complicating
    factor is that customizations (including previously installed contributed packages)
    aren’t included in the new installation. In my current setup, I have more than
    500 contributed packages installed. I really don’t want to have to write down
    their names and reinstall them by hand the next time I upgrade my R installation!
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 从 CRAN ([http://cran.r-project.org/bin](http://cran.r-project.org/bin)) 下载并安装
    R 的最新版本相对简单。复杂因素在于，新安装中不包括自定义设置（包括之前安装的贡献包）。在我的当前设置中，我安装了 500 多个贡献包。我真的不希望每次升级我的
    R 安装时都要手动写下它们的名称并重新安装！
- en: There has been much discussion on the web concerning the most elegant and efficient
    way to update an R installation. The method described here is neither elegant
    nor efficient, but I find that it works well on both Windows and macOS platforms.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 网上关于如何优雅且高效地更新 R 安装有很多讨论。这里描述的方法既不优雅也不高效，但我发现它在 Windows 和 macOS 平台上都工作得很好。
- en: 'In this approach, you use the `installed.packages()` function to save a list
    of packages to a location outside of the R directory tree, and then you use the
    list with the `install.packages()` function to download and install the latest
    contributed packages into the new R installation. Here are the steps:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种方法中，你使用 `installed.packages()` 函数将包列表保存到 R 目录树之外的位置，然后使用该列表与 `install.packages()`
    函数下载并安装最新贡献包到新的 R 安装中。以下是步骤：
- en: If you have a customized Rprofile.site file (see appendix B), save a copy outside
    of R.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你有一个自定义的 Rprofile.site 文件（见附录 B），请将其保存到 R 外部。
- en: 'Launch your current version of R, and issue the following statements:'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动你的当前版本 R，并输入以下语句：
- en: '[PRE1]'
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: where `path` is a directory outside of R.
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 其中 `path` 是 R 之外的一个目录。
- en: Download and install the newer version of R.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载并安装 R 的新版本。
- en: If you saved a customized version of the Rprofile.site file in step 1, copy
    it into the new installation.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你在步骤 1 中保存了自定义版本的 Rprofile.site 文件，请将其复制到新安装中。
- en: 'Launch the new version of R, and issue the following statements:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 R 的新版本，并输入以下语句：
- en: '[PRE2]'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: where `path` is the location specified in step 2.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`path` 是在第 2 步中指定的位置。'
- en: Delete the old installation (optional).
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除旧安装（可选）。
- en: 'This approach will install only packages that are available from CRAN. It won’t
    find packages obtained from other locations. You’ll have to find and download
    these separately. Luckily, the process displays a list of packages that can’t
    be installed. During my last installation, `globaltest` and `Biobase` couldn’t
    be found. Because I got them from the Bioconductor site, I was able to install
    them via this code:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法只会安装来自 CRAN 的包。它不会找到来自其他位置的包。您必须单独查找和下载这些包。幸运的是，这个过程会显示一个无法安装的包列表。在我的最后一次安装中，`globaltest`
    和 `Biobase` 找不到。因为我从 Bioconductor 网站获取了它们，所以我能够通过以下代码安装它们：
- en: '[PRE3]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Step 6 involves the optional deletion of the old installation. On a Windows
    machine, more than one version of R can be installed at a time. If desired, uninstall
    the older version via Start > Control Panel > Uninstall a Program. On macOS platforms,
    the new version of R will overwrite the older version. To delete any remnants
    on a macOS, use the Finder to go to the /Library/Frameworks/R.frameworks/versions/
    directory, and delete the folder representing the older version.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 第 6 步涉及可选的删除旧安装包。在 Windows 机器上，可以同时安装多个 R 版本。如果需要，可以通过开始菜单 > 控制面板 > 卸载程序来卸载旧版本。在
    macOS 平台上，新版本的 R 将覆盖旧版本。要在 macOS 上删除任何残留文件，请使用 Finder 转到 /Library/Frameworks/R.frameworks/versions/
    目录，并删除代表旧版本的文件夹。
- en: Clearly, manually updating an existing version of R is more involved than is
    desirable for such a sophisticated piece of software. I’m hopeful that someday
    this appendix will simply say “Select the Check for Updates Option” to update
    an R installation.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，手动更新现有的 R 版本比这样一款复杂的软件所期望的要复杂得多。我希望能有一天，这个附录只需简单地说“选择检查更新选项”来更新 R 安装包。
- en: G.3 Updating an R installation (Linux)
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: G.3 更新 R 安装包（Linux）
- en: The process of updating an R installation on a Linux platform is quite different
    from the process used on Windows and macOS machines. Additionally, it varies by
    Linux distribution (Debian, Red Hat, SUSE, or Ubuntu). See [http://cran.r-project.org/bin/linux](http://cran.r-project.org/bin/linux)
    for details.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 平台上更新 R 安装包的过程与在 Windows 和 macOS 机器上使用的过程有很大不同。此外，它还因 Linux 发行版（Debian、Red
    Hat、SUSE 或 Ubuntu）而异。有关详细信息，请参阅 [http://cran.r-project.org/bin/linux](http://cran.r-project.org/bin/linux)。
