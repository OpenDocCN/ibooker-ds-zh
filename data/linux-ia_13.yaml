- en: Chapter 14\. Troubleshooting network issues
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第14章. 故障排除网络问题
- en: '*This chapter covers*'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '*本章涵盖*'
- en: Using TCP/IP networking to manage network problems
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用TCP/IP网络管理网络问题
- en: Troubleshooting networks and network interfaces
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络和网络接口的故障排除
- en: Managing DHCP connectivity
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理DHCP连接
- en: Configuring DNS for address translation
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置DNS进行地址转换
- en: Troubleshooting inbound network connectivity
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 故障排除入站网络连接
- en: When I was a lad, getting new software for a PC meant either writing it yourself
    or driving to a store and purchasing a box containing a program stored on one
    or more 5.25” floppy drives. As often as not, remote collaboration required a
    dot matrix printer and the post office. Streaming videos? Don’t make me laugh.
    I can’t remember if my first PC even had a modem. If it did, I certainly never
    used it.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 当我还是个孩子的时候，为PC获取新软件意味着要么自己编写，要么开车去商店购买一个包含一个或多个5.25英寸软盘的程序盒。通常情况下，远程协作需要点阵打印机和邮局。流媒体视频？别逗我了。我不记得我的第一台PC是否有调制解调器。如果有，我肯定从未使用过它。
- en: These days, network connectivity is as integral to computing as keyboards and
    strong coffee. And the way things are going with voice interfaces, like Amazon’s
    Alexa, it might not be wise to invest too heavily in keyboard manufacturing. (Coffee
    prospects still look good, though.) The bottom line is that you and the users
    you support would be pretty helpless without fast and reliable network access.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，网络连接对计算的重要性就像键盘和浓咖啡一样不可或缺。随着语音界面的发展，比如亚马逊的Alexa，可能不太明智地大量投资于键盘制造。（不过咖啡的前景仍然看好。）总之，没有快速可靠的网络访问，你和你要支持的用户将会非常无助。
- en: To deliver fast and reliable access, you’ll need to know how to use network
    tools and protocols to establish connectivity between your network interfaces
    and the outside world. And you’ll also need to know how to identify and connect
    network adapters to your computers so the tools and protocols will have something
    to work with. We’ll get to that.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 为了提供快速可靠的网络访问，你需要知道如何使用网络工具和协议在你的网络接口和外部世界之间建立连接。你还需要知道如何识别和连接网络适配器到你的计算机上，这样工具和协议才能有所作为。我们很快就会谈到这一点。
- en: But if you’re going to confront the vexing and unpredictable disruptions that
    can plague your network communication, you’ll first need a solid working knowledge
    of the basics of the *internet protocol suite*, often known as the Transmission
    Control Protocol (TCP) and the Internet Protocol (IP), or TCP/IP for short. Technically,
    TCP/IP isn’t a Linux topic at all, as the protocols are used universally by all
    networked devices no matter what OS they’re running. Because the work you’re going
    to do in this chapter won’t make much sense without taking TCP/IP into account,
    that’s where we’ll begin. Feel free to skip this section if you’re already comfortable
    with the material.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '但如果你要面对可能困扰你的网络通信的令人烦恼和不可预测的中断，你首先需要扎实的网络协议基础知识，通常被称为传输控制协议（TCP）和互联网协议（IP），简称TCP/IP。从技术上讲，TCP/IP根本不是Linux主题，因为无论运行什么操作系统，所有联网设备都普遍使用这些协议。由于本章的工作不涉及TCP/IP，我们将从这里开始。如果你已经熟悉这些材料，可以自由跳过这一部分。 '
- en: 14.1\. Understanding TCP/IP addressing
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.1. 理解TCP/IP寻址
- en: A network’s most basic unit is the humble Internet Protocol (IP) address, at
    least one of which must be assigned to every connected device. Each address must
    be unique throughout the entire network; otherwise message routing would descend
    into chaos.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 网络最基本单元是谦逊的互联网协议（IP）地址，至少必须分配给每个连接的设备。每个地址在整个网络中必须是唯一的；否则，消息路由将陷入混乱。
- en: 'For decades, the standard address format followed the IPv4 protocol: each address
    is made up of four 8-bit octets for a total of 32 bits. (Don’t worry if you don’t
    understand how to count in binary.) Each octet must be a number between 0 and
    255\. Here’s a typical (fake) example:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 几十年来，标准的地址格式遵循IPv4协议：每个地址由四个8位八位字节组成，总共32位。（如果你不懂如何用二进制计数，不用担心。）每个八位字节必须是一个介于0到255之间的数字。这里有一个典型的（虚构的）例子：
- en: '[PRE0]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The maximum theoretical number of addresses that can be drawn from the IPv4
    pool is over 4 billion (256^4). Once upon a time, that seemed like a lot. But
    as the internet grew far beyond anyone’s expectations, there clearly weren’t going
    to be enough unique addresses in the IPv4 pool for all the countless devices seeking
    to connect.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 从 IPv4 池中可以提取的最大理论地址数量超过 40 亿（256^4）。曾经，这看起来很多。但随着互联网远远超出任何人的预期，IPv4 池中显然不会有足够的唯一地址来满足无数寻求连接的设备。
- en: Four billion possible addresses sounds like a big number until you consider
    that there are currently more than 1 billion Android smartphones in use; that’s
    in addition to all the millions of servers, routers, PCs, and laptops, not to
    mention Apple phones. There’s a good chance your car, refrigerator, and home-security
    cameras also have their own network-accessible addresses, so something obviously
    had to give.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 四十亿个可能的地址听起来是一个很大的数字，但考虑到目前有超过 10 亿部正在使用的 Android 智能手机；这还加上数以百万计的服务器、路由器、PC
    和笔记本电脑，更不用说苹果手机了。有很大可能性，您的汽车、冰箱和家用安全摄像头也有它们自己的网络可访问地址，所以显然必须做出一些妥协。
- en: 'Two solutions to the impending collapse of the internet addressing system (and
    the end of life as we know it) were proposed: IPv6 (an entirely new addressing
    protocol) and Network Address Translation (NAT). IPv6 provides a much larger pool
    of addresses, but because it’s still not all that widely deployed, I’ll focus
    on NAT.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 提出了两种解决互联网地址系统即将崩溃（以及我们所知生活的终结）的方案：IPv6（一个全新的地址协议）和网络地址转换（NAT）。IPv6 提供了更大的地址池，但由于它还没有得到广泛部署，我将重点介绍
    NAT。
- en: 14.1.1\. What’s NAT addressing?
  id: totrans-18
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.1.1\. 什么是 NAT 地址？
- en: 'The organizing principle behind NAT is brilliant: rather than assign a unique,
    network-readable address to every one of your devices, why not have all of them
    share the single public address that’s used by your router? But how will traffic
    flow to and from your local devices? Through the use of *private* addresses. And
    if you want to divide network resources into multiple subgroups, how can everything
    be effectively managed? Through network segmentation. Clear as mud? Let’s look
    at how NAT addressing works, to gain a little perspective.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: NAT 背后的组织原则非常出色：为什么不给每个设备分配一个唯一的、网络可读的地址，而是让它们都共享路由器使用的单个公共地址呢？但是，如何使流量流向和离开本地设备呢？通过使用
    *私有* 地址。如果你想要将网络资源分成多个子组，如何才能有效地管理一切呢？通过网络分段。听起来很模糊？让我们看看 NAT 地址是如何工作的，以获得一些视角。
- en: 14.1.2\. Working with NAT addressing
  id: totrans-20
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.1.2\. 使用 NAT 地址
- en: When a browser on one of the laptops connected to your home WiFi visits a site,
    it does so using the public IP address that’s been assigned to the DSL modem/router
    provided by your internet service provider (ISP). Any other devices connecting
    through the same WiFi network use that same address for all their browsing activity
    (see [figure 14.1](#ch14fig01)).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 当连接到您家庭 WiFi 的笔记本电脑上的浏览器访问网站时，它使用的是您互联网服务提供商（ISP）提供的 DSL 调制器/路由器分配的公共 IP 地址。通过同一
    WiFi 网络连接的其他设备将使用相同的地址进行所有浏览活动（参见 [图 14.1](#ch14fig01)）。
- en: Figure 14.1\. A typical NAT configuration, showing how multiple local devices,
    each with its own private address, can all be represented by a single public IP
    address
  id: totrans-22
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 14.1\. 一个典型的 NAT 配置，展示了多个具有各自私有地址的本地设备如何都可以用一个单一的公共 IP 地址来表示
- en: '![](Images/14fig01_alt.jpg)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/14fig01_alt.jpg)'
- en: In most cases, the router uses the Dynamic Host Configuration Protocol (DHCP)
    to assign unique private (NAT) addresses to each local device, but they’re unique
    only in the local environment. That way, all local devices can enjoy full, reliable
    communication with their local peers. This works just as well for large enterprises,
    many of which use tens of thousands of NAT IP addresses, all behind a single public
    IP.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数情况下，路由器使用动态主机配置协议（DHCP）为每个本地设备分配唯一的私有（NAT）地址，但这些地址在本地环境中是唯一的。这样，所有本地设备都可以与它们的本地对等方进行全面、可靠的通信。这对大型企业来说同样适用，其中许多企业使用成千上万的
    NAT IP 地址，所有这些地址都位于单个公共 IP 后面。
- en: 'The NAT protocol sets aside three IPv4 address ranges that can only be used
    for private addressing:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: NAT 协议预留了三个只能用于私有地址的 IPv4 地址范围：
- en: 10.0.0.0 to 10.255.255.255
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 10.0.0.0 至 10.255.255.255
- en: 172.16.0.0 to 172.31.255.255
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 172.16.0.0 至 172.31.255.255
- en: 192.168.0.0 to 192.168.255.255
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 192.168.0.0 至 192.168.255.255
- en: Local network managers are free to use any and all of those addresses (there
    are more than 17 million of them) any way they like. But addresses are usually
    organized into smaller network (or *subnet*) blocks whose host network is identified
    by the octets to the left of the address. This leaves octets to the right of the
    address available for assigning to individual devices.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 本地网络管理员可以自由地以任何方式使用这些地址（有超过1700万个地址）。但是，地址通常被组织成更小的网络（或*子网*）块，其中主机网络由地址左侧的八位字节标识。这为地址右侧的八位字节留出了空间，可以分配给单个设备。
- en: For example, you might choose to create a subnet on 192.168.1, which would mean
    all the addresses in this subnet would start with 192.168.1 (the network portion
    of the address) and end with a unique, single-octet device address between 2 and
    254. One PC or laptop on that subnet might therefore get the address 192.168.1.4,
    and another could get 192.168.1.48.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，你可能会选择在192.168.1上创建一个子网，这意味着这个子网中的所有地址都将以192.168.1（地址的网络部分）开头，并以2到254之间的唯一单字节设备地址结尾。因此，该子网上的一个PC或笔记本电脑可能会获得地址192.168.1.4，另一个可能会获得192.168.1.48。
- en: '|  |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: Note
  id: totrans-32
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: Following networking conventions, DHCP servers generally don’t assign the numbers
    0, 1, and 255 to network devices.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 根据网络惯例，DHCP服务器通常不会将数字0、1和255分配给网络设备。
- en: '|  |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: Continuing with that example, you might subsequently want to add a parallel,
    but separate, network subnet using 192.168.2. In this case, not only are 192.168.1.4
    and 192.168.2.4 two separate addresses, available to be assigned to two distinct
    devices, but because they’re on separate networks, the two might not even have
    access to each other (see [figure 14.2](#ch14fig02)).
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 继续使用这个例子，你可能随后想要使用192.168.2添加一个并行但独立的网络子网。在这种情况下，192.168.1.4和192.168.2.4不仅是两个不同的地址，可以分配给两个不同的设备，而且由于它们位于不同的网络上，这两个设备甚至可能无法互相访问（参见[图14.2](#ch14fig02)）。
- en: Figure 14.2\. Devices attached to two separate NAT subnets in the 192.168.*x*
    network range
  id: totrans-36
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图14.2\. 192.168.*x*网络范围内连接到两个单独NAT子网的设备
- en: '![](Images/14fig02_alt.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/14fig02_alt.jpg)'
- en: '|  |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: '**Subnet notation**'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '**子网表示法**'
- en: 'Because it’s critically important to make sure systems know what kind of subnet
    a network address is on, we need a standard notation that can accurately communicate
    which octets are part of the network and which are available for devices. There
    are two commonly used standards: *Classless Inter-Domain Routing (CIDR)* notation
    and *netmask*. Using CIDR, the first network in the previous example would be
    represented as 192.168.1.0/24\. The /24 tells you that the first three octets
    (8×3=24) make up the network portion, leaving only the fourth octet for device
    addresses. The second subnet, in CIDR, would be described as 192.168.2.0/24.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 由于确保系统知道网络地址属于哪种子网至关重要，我们需要一种标准表示法，可以准确地传达哪些八位字节是网络的一部分，哪些是分配给设备的。有两种常用的标准：*无类域间路由（CIDR）*表示法和*子网掩码*。使用CIDR，上一个例子中的第一个网络将被表示为192.168.1.0/24。/24告诉你前三个八位字节（8×3=24）构成了网络部分，只留下第四个八位字节用于设备地址。第二个子网在CIDR中表示为192.168.2.0/24。
- en: These same two networks could also be described through a netmask of 255.255.255.0\.
    That means all 8 bits of each of the first three octets are used by the network,
    but none of the fourth.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个相同的网络也可以通过子网掩码255.255.255.0来描述。这意味着前三个八位字节中的所有8位都被网络使用，但第四个八位字节没有被使用。
- en: '|  |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: You don’t have to break up the address blocks exactly this way. If you knew
    you weren’t likely to ever require many network subnets in your domain, but you
    anticipated the need to connect more than 255 devices, you could choose to designate
    only the first two octets (192.168) as network addresses, leaving everything between
    192.168.0.0 and 192.168.255.255 for devices. In CIDR notation, this would be represented
    as 192.168.0.0/16 and have a netmask of 255.255.0.0.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 你不必完全按照这种方式拆分地址块。如果你知道你不太可能在域中需要很多网络子网，但你预计需要连接超过255个设备，你可以选择只将前两个八位字节（192.168）指定为网络地址，将192.168.0.0到192.168.255.255之间的所有内容留给设备。在CIDR表示法中，这将被表示为192.168.0.0/16，并具有子网掩码255.255.0.0。
- en: Nor do your network portions need to use complete (8-bit) octets. Part of the
    range available in a particular octet can be dedicated to addresses used for entire
    networks (such as 192.168.14.*x*), with the remainder left for devices (or hosts,
    as they’re more commonly called). This way, you could set aside all the addresses
    of the subnet’s first two octets (192 and 168), plus some of those of the third
    octet (0), as network addresses. This could be represented as 192.168.0.0/20 or
    with the netmask 255.255.240.0.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你的网络部分也不需要使用完整的（8位）八位字节。特定八位字节范围内的部分可以专门用于整个网络的地址（例如192.168.14.*x*），其余的留给设备（或主机，更常见的是这样称呼）。这样，你可以预留子网前两个八位字节的所有地址（192和168），以及第三八位字节的一些地址（0），作为网络地址。这可以表示为192.168.0.0/20或使用子网掩码255.255.240.0。
- en: Where did I get these notation numbers? Most experienced admins use their binary
    counting skills to work it out for themselves. But for a chapter on general network
    troubleshooting, that’s a bit out of scope and unnecessary for the normal work
    you’re likely to encounter. Nevertheless, there are many online subnet calculators
    that will do the calculation for you.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我从哪里得到这些符号编号？大多数经验丰富的管理员使用他们的二进制计数技能自己解决。但对于一个关于一般网络故障排除的章节，这有点超出范围，对于你可能会遇到的正常工作来说也是不必要的。尽管如此，仍然有许多在线子网计算器可以为你完成计算。
- en: Why would you want to divide your network into subnets? A common scenario involves
    groups of company assets that need to be accessible to some teams (developers,
    perhaps), but not others. Keeping them logically separated into their own subnets
    can be an efficient way to do that.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 你为什么要将你的网络划分为子网？一个常见的场景涉及需要某些团队（可能是开发者）访问但不需要其他团队访问的公司资产。将它们逻辑上分离到它们自己的子网中可以是一个有效的方法。
- en: 14.2\. Establishing network connectivity
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.2. 建立网络连接
- en: 'Everyone shows up for work bright and early one Monday morning. They exchange
    brief but cheerful greetings with each other, sit down at their laptops and workstations
    all ready for a productive week’s work, and discover the internet can’t be reached.
    With the possible exception of the cheerful and productive parts, you should expect
    that this will happen to you one day soon (if it hasn’t already). The source of
    a network outage could be any of the following:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 每个人都在周一早上早早地来到工作场所。他们互相交换简短但愉快的问候，坐在他们的笔记本电脑和工作站上，准备开始一周富有成效的工作，然后发现无法访问互联网。除了可能愉快和富有成效的部分，你应该预期这种情况很快就会发生在你身上（如果还没有发生的话）。网络中断的原因可能是以下任何一种：
- en: A hardware or operating system failure on a local machine
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本地机器上的硬件或操作系统故障
- en: Disruption to your physical cabling, routing, or wireless connections
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对你的物理布线、路由或无线连接的干扰
- en: A problem with the local routing software configuration
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本地路由软件配置问题
- en: A breakdown at the ISP level
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在ISP层面的故障
- en: An entire chunk of the internet itself going down
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 整个互联网本身出现故障
- en: Your first job will be to narrow the focus of your search by ruling out what’s
    not relevant. You do that by following a protocol that starts off closest to home,
    confirming that the fault doesn’t lie within your own local systems, and gradually
    expanding outward. [Figure 14.3](#ch14fig03) illustrates the process flow.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 你的第一项工作是通过排除不相关的内容来缩小搜索范围。你可以通过遵循一个从最接近的地方开始的协议来完成这项工作，确认故障不在你自己的本地系统中，然后逐渐向外扩展。[图14.3](#ch14fig03)展示了这个过程流程。
- en: Figure 14.3\. A flow chart illustrating the sequence you might follow when troubleshooting
    an outbound connectivity problem
  id: totrans-55
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图14.3. 展示在故障排除出站连接问题时可能遵循的顺序的流程图
- en: '![](Images/14fig03_alt.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![图14.3替代](Images/14fig03_alt.jpg)'
- en: Let’s see how all that might work. You’ll begin with fixing problems local computers
    might have accessing external resources, and then address problems external clients
    or users might have accessing resources on your servers.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这一切可能如何运作。你将从解决本地计算机可能访问外部资源的问题开始，然后解决外部客户端或用户可能访问你的服务器上的资源的问题。
- en: 14.3\. Troubleshooting outbound connectivity
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.3. 故障排除出站连接
- en: 'It’s possible that your computer was never assigned its own IP address, without
    which it’s impossible to exist as a member in good standing of a network. Run
    `ip` to display your network interface devices, and then confirm you’ve got an
    active external-facing device and that there’s a valid IP associated with it.
    In the following, the eth0 interface is using 10.0.3.57:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 有可能你的计算机从未被分配自己的IP地址，没有它，作为网络良好成员的存在是不可能的。运行`ip`来显示你的网络接口设备，并确认你有一个活跃的外部设备，并且与之关联了一个有效的IP地址。在以下示例中，eth0接口正在使用10.0.3.57：
- en: '[PRE1]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '***1* The addr argument for ip can also be shortened to a.**'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* ip的addr参数也可以缩短为a。**'
- en: '***2* The loopback (lo) interface through which local (localhost) resources
    are accessed**'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 通过回环（lo）接口访问本地（localhost）资源**'
- en: '***3* Note how the IP used by the loopback device is 127.0.0.1\. This follows
    standard networking conventions.**'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 注意回环设备使用的IP地址是127.0.0.1。这遵循了标准的网络约定。**'
- en: '***4* The interface is listed as UP.**'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 接口状态显示为UP。**'
- en: '***5* The computer’s current public IP address is displayed as the value of
    inet.**'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***5* 计算机的当前公共IP地址显示为inet的值。**'
- en: If there’s no IP address listed on the `inet` line, or there’s no network interface
    listed altogether, then that’s where you’ll focus your attention.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果`inet`行上没有列出IP地址，或者根本没有列出网络接口，那么这就是你需要集中注意力的地方。
- en: 14.3.1\. Tracking down the status of your network
  id: totrans-67
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.3.1. 跟踪网络状态
- en: 'First, confirm that you’ve got a physical *network adapter* (also called a
    *network interface card*, or NIC) installed on your computer and that Linux sees
    it. You can list all the PCI-based hardware currently installed using `lspci`.
    In the following output, `lspci` found a PCI Express Gigabit Ethernet Controller:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，确认你的计算机上安装了物理*网络适配器*（也称为*网络接口卡*，或NIC），并且Linux能够识别它。你可以使用`lspci`列出当前安装的所有基于PCI的硬件。在以下输出中，`lspci`发现了一个PCI
    Express千兆以太网控制器：
- en: '[PRE2]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '***1* The term ethernet controller refers to a hardware network interface device.**'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 术语“以太网控制器”指的是一种硬件网络接口设备。**'
- en: If `lspci` returns no NICs, you should consider the possibility that you’ve
    had some kind of hardware failure.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 如果`lspci`没有返回任何网络接口卡（NIC），你应该考虑你可能有某种硬件故障的可能性。
- en: '|  |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-73
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: The *Peripheral Component Interconnect* (PCI) is a hardware standard used to
    allow peripheral devices to connect to the microprocessors on computer motherboards
    through the PCI bus. Various newer standards, like PCI Express (PCIe), also exist,
    each using its own unique form factor to physically connect to a motherboard.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '*外围组件互连*（PCI）是一种硬件标准，用于允许外围设备通过PCI总线连接到计算机主板上的微处理器。还存在着各种更新的标准，如PCI Express（PCIe），每个标准都使用其独特的形式因子来物理连接到主板。'
- en: '|  |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Besides `lspci`, you can also use the lshw tool to display the networking hardware
    your system knows about. By itself, `lshw` returns a complete hardware profile,
    but `lshw-class network` will show you only the subset of that profile that relates
    to networking. Try it.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 除了`lspci`之外，你还可以使用`lshw`工具来显示系统所知的网络硬件。`lshw`本身返回一个完整的硬件配置文件，但`lshw-class network`将只显示与网络相关的配置文件子集。试试看。
- en: 'A positive result from `lspci` won’t, by itself, get you too far, because it
    doesn’t tell you how the device can be accessed from the command line. But it
    does give you some important information. Take, say, the word *Ethernet* from
    the `lspci` output and use it with grep to search the output of `dmesg`. As you
    might remember from [chapter 11](kindle_split_019.xhtml#ch11), `dmesg` is a record
    of kernel-related events involving devices. After some trial and error, I discovered
    that this particular search will work best by including the two `dmesg` lines
    immediately following the line containing my search string (using `-A 2`):'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '`lspci`的积极结果本身不会让你走得太远，因为它没有告诉你如何从命令行访问该设备。但它确实提供了一些重要信息。例如，从`lspci`输出中提取*以太网*这个词，并使用grep来搜索`dmesg`的输出。你可能还记得[第11章](kindle_split_019.xhtml#ch11)，`dmesg`是涉及设备的内核相关事件的记录。经过一些尝试和错误，我发现通过包括包含搜索字符串的行之后的两个`dmesg`行（使用`-A
    2`）进行搜索将是最有效的：'
- en: '[PRE3]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '***1* Device designation eth0 is shown as associated with the Gigabit Ethernet
    device.**'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 设备标识eth0显示与千兆以太网设备相关联。**'
- en: 'Success! You can see that the device was given the eth0 designation. Hold on.
    Not so fast. Even though eth0 was originally given to the device because Linux
    now uses predictable interface names (refer back to [chapter 10](kindle_split_018.xhtml#ch10)),
    it might not be the designation the interface is actually using. Just to be safe,
    you’ll want to search `dmesg` once again to see if eth0 shows up anywhere else:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 成功！您可以看到设备被分配了eth0的指定。等等。别急。尽管eth0最初被分配给设备是因为Linux现在使用可预测的接口名称（请参阅第10章），但这可能不是接口实际使用的指定。为了安全起见，您想再次搜索`dmesg`以查看eth0是否出现在其他地方：
- en: '[PRE4]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '***1* The eth0 designation was dropped and replaced with enp1s0.**'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* eth0的指定已被删除，并替换为enp1s0。**'
- en: Aha. It seems that at some point in the boot process the device was renamed
    enp1s0\. OK. You’ve got a properly configured network interface, but still no
    IP address and still no network connectivity, what’s next? `dhclient`, but first
    some background.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 哎。看起来在启动过程中某个时刻设备被重命名为enp1s0。好的。您已经配置了正确的网络接口，但仍然没有IP地址，也没有网络连接，接下来是什么？`dhclient`，但首先有一些背景知识。
- en: 14.3.2\. Assigning IP addresses
  id: totrans-84
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.3.2\. 分配IP地址
- en: 'Network devices can get their IP addresses in these ways:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 网络设备可以通过以下方式获取IP地址：
- en: Someone manually sets a static address that (hopefully) falls within the address
    range of the local network.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有些人手动设置了一个静态地址，希望它位于本地网络的地址范围内。
- en: A DHCP server automatically gives the device an unused address.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DHCP服务器会自动为设备提供一个未使用的地址。
- en: As is usually the case, each approach has its trade-offs. DHCP servers do their
    work automatically and invisibly, and guarantee that two managed devices are never
    trying to use the same address. But, on the other hand, those addresses are dynamic,
    meaning the addresses they’re using one day might not be the ones they get the
    next. With that in mind, if you’ve been successfully using, say, 192.168.1.34
    to SSH into a remote server, be prepared to accommodate for unexpected changes.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 如通常情况，每种方法都有其权衡。DHCP服务器自动且无形地完成工作，并保证两个管理设备永远不会尝试使用相同的地址。但另一方面，这些地址是动态的，这意味着它们今天使用的地址可能不是他们明天得到的。考虑到这一点，如果您一直在成功使用，比如说，192.168.1.34通过SSH远程连接到服务器，请准备好应对意外变化。
- en: Conversely, setting the IPs manually ensures that those addresses are permanently
    associated with their devices. But there’s always the chance that you may cause
    addressing conflicts—with unpredictable results. As a rule, unless you have a
    specific need for a static address—perhaps you need to reliably access a resource
    remotely using its address—I’d go with DHCP.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，手动设置IP地址确保这些地址永久关联到它们的设备。但总有可能您可能会引起地址冲突——结果不可预测。一般来说，除非您有特定的静态地址需求——比如您可能需要通过地址可靠地远程访问资源——否则我会选择DHCP。
- en: Defining a network route
  id: totrans-90
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 定义网络路由
- en: 'Before looking for an address, you’ll need to make sure Linux knows how to
    find the network in the first place. If Linux can already see its way through
    to a working network, then `ip route` will show you your computer’s routing table,
    including the local network and the IP address of the device that you’ll use as
    a gateway router:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在寻找地址之前，您需要确保Linux首先知道如何找到网络。如果Linux已经可以看到通往工作网络的路，那么`ip route`将显示您的计算机的路由表，包括本地网络和您用作网关路由器的设备的IP地址：
- en: '[PRE5]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '***1* Address of the gateway router through which the local computer will access
    the wider network**'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 本地计算机将通过该网关路由器访问更广泛的网络**'
- en: '***2* The NAT network (192.168.1.x) and netmask (/24) of the local NAT network**'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 本地NAT网络的NAT网络（192.168.1.x）和子网掩码（/24）**'
- en: 'If a working route isn’t listed, then you’ll need to create one, but you’ll
    have to figure out the subnet range of your local network first. If there are
    other computers using the same network, check out their IP addresses. If, say,
    one of those computers is using 192.168.1.34, then the odds are that the router’s
    address will be 192.168.1.1\. Similarly, if the IP of that connected computer
    is 10.0.0.45, then the router’s address would be 10.0.0.1\. You get the picture.
    Based on that, here’s the `ip` command to create a new default route to your gateway:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有列出工作路由，那么您需要创建一个，但首先您需要确定您本地网络的子网范围。如果有其他计算机使用相同的网络，请检查它们的IP地址。比如说，如果其中一台计算机正在使用192.168.1.34，那么路由器的地址很可能是192.168.1.1。同样，如果连接的计算机的IP地址是10.0.0.45，那么路由器的地址将是10.0.0.1。您应该明白了。基于此，以下是创建到网关的新默认路由的`ip`命令：
- en: '[PRE6]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '|  |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-98
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: The `ip` commands discussed in this chapter are relatively new and are meant
    to replace now-deprecated command sets like `ifconfig`, `route`, and `ifupdown`.
    You’ll still see plenty of how-to guides focusing on those old commands, and,
    for now at least, they’ll still work, but you should get used to using `ip`.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 本章讨论的 `ip` 命令相对较新，旨在取代现在已弃用的命令集，如 `ifconfig`、`route` 和 `ifupdown`。您仍然会看到大量专注于这些旧命令的指南，至少目前它们仍然有效，但您应该习惯使用
    `ip`。
- en: '|  |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Requesting a dynamic address
  id: totrans-101
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 请求动态地址
- en: 'The best way to request a DHCP address is to use `dhclient` to search for a
    DHCP server on your network and then request a dynamic address. Here’s how that
    might look, assuming your external network interface is called enp0s3:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 请求 DHCP 地址的最佳方式是使用 `dhclient` 在您的网络上搜索 DHCP 服务器，然后请求一个动态地址。以下是一个示例，假设您的外部网络接口名为
    enp0s3：
- en: '[PRE7]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '***1* The address of the DHCP server in this case is 192.168.1.1.**'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 在这种情况下 DHCP 服务器的地址是 192.168.1.1。**'
- en: '***2* The new address is successfully leased for a set time; renewal will be
    automatic.**'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 新地址已成功租用一定时间；续订将是自动的。**'
- en: Configuring a static address
  id: totrans-106
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 配置静态地址
- en: 'You can temporarily give an interface a static IP from the command line using
    `ip`, but that will only survive until the next system boot. Bearing that in mind,
    here’s how it’s done:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 `ip` 从命令行临时为接口分配一个静态 IP 地址，但这只会持续到下一次系统启动。考虑到这一点，以下是操作方法：
- en: '[PRE8]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: That’s great for quick and dirty one-off configurations, perhaps trying to get
    connectivity on a stricken system while troubleshooting. But the odds are that
    you’ll normally prefer to make your edits permanent. On Ubuntu machines, that’ll
    require some editing of the /etc/network/interfaces file. The file may already
    contain a section defining your interface as DHCP rather than static.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 这对于快速且简单的单次配置很有用，例如在故障排除时尝试在受影响的系统上获得连接。但通常您可能更喜欢使您的编辑永久化。在 Ubuntu 机器上，这需要编辑
    /etc/network/interfaces 文件。该文件可能已经包含一个部分，将您的接口定义为 DHCP 而不是静态。
- en: Listing 14.1\. A section in the /etc/network/interfaces file
  id: totrans-110
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 14.1\. /etc/network/interfaces 文件中的一个部分
- en: '[PRE9]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'You’ll edit that section, changing `dhcp` to `static`, entering the IP address
    you want it to have, the netmask (in *x.x.x.x* format), and the IP address of
    the network gateway (router) that the computer will use. Here’s an example:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 您将编辑该部分，将 `dhcp` 改为 `static`，输入您希望它拥有的 IP 地址，子网掩码（以 *x.x.x.x* 格式），以及计算机将使用的网络网关（路由器）的
    IP 地址。以下是一个示例：
- en: '[PRE10]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: On CentOS, each interface will have its own configuration file in the /etc/sysconfig/
    network-scripts/ directory. A typical interface set for DHCP addressing will look
    as shown in the next listing.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 上，每个接口都会在 /etc/sysconfig/network-scripts/ 目录中有一个自己的配置文件。一个典型的用于 DHCP
    地址设置的接口配置将如下所示。
- en: Listing 14.2\. Configurations in /etc/sysconfig/network-scripts/ifcfg-enp0s3
  id: totrans-115
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 14.2\. /etc/sysconfig/network-scripts/ifcfg-enp0s3 中的配置
- en: '[PRE11]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '***1* Tells Linux to request a dynamic IP for the interface**'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 告诉 Linux 为该接口请求一个动态 IP 地址**'
- en: The next listing shows how that file might look once you’ve edited it to allow
    static addressing.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个列表显示了在编辑以允许静态地址后该文件可能的样子。
- en: Listing 14.3\. The static version of a CentOS interface configuration file
  id: totrans-119
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 14.3\. CentOS 接口配置文件的静态版本
- en: '[PRE12]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '***1* DHCP addressing won’t be used.**'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 不会使用 DHCP 地址**'
- en: '***2* Sets the static IP address you want to use**'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 设置您想要使用的静态 IP 地址**'
- en: 'If you want your settings to take effect immediately, you’ll need to restart
    networking. Most of the time, networking on modern systems is managed by the systemd
    service, NetworkManager. Instead, on Ubuntu at least, starting or stopping interfaces
    that are defined in the /etc/network/interfaces file is handled by the networking
    service. Therefore, if you want to apply the newly edited settings in the interfaces
    file, you’ll run `systemctl restart networking` rather than `systemctl restart
    NetworkManager`. Alternatively, you could use `ip` to bring just one interface
    up (or down):'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望您的设置立即生效，您需要重新启动网络。大多数情况下，现代系统中的网络由 systemd 服务 NetworkManager 管理。但在 Ubuntu
    上至少，启动或停止 /etc/network/interfaces 文件中定义的接口是由网络服务处理的。因此，如果您想应用接口文件中的新编辑设置，您将运行
    `systemctl restart networking` 而不是 `systemctl restart NetworkManager`。或者，您可以使用
    `ip` 只启动（或关闭）一个接口：
- en: '[PRE13]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: It can’t hurt to know about some of the places on your system that NetworkManager
    hides its working files. There’s a configuration file called NetworkManager.conf
    in the /etc/ NetworkManager/ directory, configuration files for each of the network
    connections your computer has made historically in /etc/NetworkManager/system-connections/,
    and data detailing your computer’s historical DHCP connections in /var/lib/NetworkManager/.
    Why not take a quick look through each of those resources?
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 了解你的系统中NetworkManager隐藏工作文件的某些位置不会有害。在`/etc/NetworkManager/`目录中有一个名为`NetworkManager.conf`的配置文件，每个你的电脑历史上建立的网络的配置文件都在`/etc/NetworkManager/system-connections/`中，以及详细说明你的电脑历史DHCP连接的数据在`/var/lib/NetworkManager/`中。为什么不快速浏览一下这些资源呢？
- en: 14.3.3\. Configuring DNS service
  id: totrans-126
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.3.3. 配置DNS服务
- en: If you’ve got a valid network route and an IP address, but the connectivity
    problem hasn’t gone away, then you’ll have to cast your net a bit wider. Think
    for a moment about exactly what it is that you’re not able to do.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有一个有效的网络路由和IP地址，但连接问题还没有解决，那么你可能需要扩大你的搜索范围。想想看，你到底不能做什么。
- en: Is your web browser unable to load pages? (I don’t know, perhaps like bootstrap-it.com,
    if you’re looking for a great example.) It could be that you haven’t got connectivity.
    It could also mean that there isn’t any DNS translation happening.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 你的网页浏览器无法加载页面吗？（我不知道，也许像bootstrap-it.com这样的例子。）这可能意味着你没有连接性。也可能意味着没有发生DNS转换。
- en: What’s DNS?
  id: totrans-129
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 什么是DNS？
- en: It may not look it, but the World Wide Web is really all about numbers. There’s
    no place called manning.com or wikipedia.org. Rather, they’re 35.166.24.88 and
    208.80.154.224, respectively. The software that does all the work connecting us
    to the websites we know and love recognizes only numeric IP addresses.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然看起来不是这样，但万维网实际上完全是关于数字的。没有名为manning.com或wikipedia.org的地方。相反，它们分别是35.166.24.88和208.80.154.224。连接我们到我们所知和喜爱的网站的软件只识别数字IP地址。
- en: The tool that translates back and forth between text-loving humans and our more
    digitally oriented machines is called the *domain name system* (DNS). *Domain*
    is a word often used to describe a distinct group of networked resources, in particular,
    resources identified by a unique human-readable name. As shown in [figure 14.4](#ch14fig04),
    when you enter a text address in your browser, the services of a DNS server will
    be sought.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 在文本爱好者的人类和我们的更数字化机器之间进行翻译的工具被称为*域名系统*（DNS）。*域名*是一个常用来描述一个独特的网络资源组的词，特别是那些由唯一可读的名称标识的资源。如图14.4所示，当你你在浏览器中输入一个文本地址时，会寻求DNS服务器提供的服务。
- en: Figure 14.4\. DNS address query for stuff.com and the reply containing a (fictional)
    IP address
  id: totrans-132
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图14.4. 对stuff.com的DNS地址查询及其包含（虚构）IP地址的回复
- en: '![](Images/14fig04_alt.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/14fig04_alt.jpg)'
- en: How does DNS work?
  id: totrans-134
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: DNS是如何工作的？
- en: The first stop is usually a local index of names and their associated IP addresses,
    stored in a file that’s automatically created by the OS on your computer. If that
    local index has no answer for this particular translation question, it forwards
    the request to a designated public DNS server that maintains a much more complete
    index and can connect you to the site you’re after. Well-known public DNS servers
    include those provided by Google, which uses the deliciously simple 8.8.8.8 and
    8.8.4.4 addresses, and OpenDNS.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个地方通常是本地索引，其中包含名称及其关联的IP地址，这些信息存储在一个由电脑上的操作系统自动创建的文件中。如果这个本地索引没有回答这个特定的转换问题，它将请求转发到一个指定的公共DNS服务器，该服务器维护一个更完整的索引，并且可以连接到你想要的网站。知名的公共DNS服务器包括由Google提供的，它们使用美味的简单地址8.8.8.8和8.8.4.4，以及OpenDNS。
- en: Fixing DNS
  id: totrans-136
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 修复DNS
- en: 'Until something breaks, you normally won’t spend a lot of time thinking about
    DNS servers. But I’m afraid something might just have broken. You can confirm
    the problem using the ping tool. If pinging a normal website URL (like manning.com)
    doesn’t work, but using an IP address does, then you’ve found your trouble. Here’s
    how that might look:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 除非出了问题，否则你通常不会花很多时间去思考DNS服务器。但恐怕真的出了点问题。你可以使用ping工具来确认问题。如果你ping一个正常的网站URL（如manning.com）不起作用，但使用IP地址可以，那么你就找到了你的问题所在。这可能看起来是这样的：
- en: '[PRE14]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '***1* This symbol tells you that the Ctrl-c key combination was used to interrupt
    the ping operation.**'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 这个符号告诉你Ctrl-c键组合被用来中断ping操作。**'
- en: 'The fix? That depends. A lot of the time, individual computers will inherit
    the DNS settings from the router through which they connect to the wider network.
    Which, I guess, means that you’ll be spending the next couple of minutes searching
    through drawers to recover your router’s login password (hint: the default password
    is often printed on the router case itself).'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案？这取决于。很多时候，单个计算机将通过它们连接到更广网络的路由器继承DNS设置。我想这意味着你接下来几分钟将花费在抽屉里寻找路由器登录密码（提示：默认密码通常打印在路由器外壳上）。
- en: 'Once you do manage to log in, usually from a connected PC that’s running a
    browser pointed to the router’s IP address, work through the GUI menus of the
    router’s OS check to make sure the DNS settings are valid. You can also configure
    DNS settings on your local computer that will override what’s on the router. On
    a CentOS machine, add references to a couple of public DNS servers to your interface’s
    /etc/sysconfig/network-scripts/ifcfg-enp0s3 file. This example uses the two IPs
    used by Google’s DNS servers:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你成功登录，通常是从一个连接的PC登录，该PC运行一个指向路由器IP地址的浏览器，通过路由器操作系统的GUI菜单进行操作，确保DNS设置有效。你还可以在本地计算机上配置DNS设置，这将覆盖路由器上的设置。在CentOS机器上，将几个公共DNS服务器的引用添加到接口的`/etc/sysconfig/network-scripts/ifcfg-enp0s3`文件中。此示例使用Google
    DNS服务器使用的两个IP地址：
- en: '[PRE15]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'And on Ubuntu, add `dns-nameserver` values to the appropriate interface in
    the /etc/network/interfaces files:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在Ubuntu上，将`dns-nameserver`值添加到`/etc/network/interfaces`文件中相应的接口：
- en: '[PRE16]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 14.3.4\. Plumbing
  id: totrans-145
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.3.4\. 水暖工程
- en: Yep. It’s roll-up-your-sleeves-and-pull-out-the-drain-snake time. If you’ve
    got a working interface, a route, an IP address, and DNS service, and you still
    don’t have full connectivity, then there’s got to be something out there blocking
    the flow.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 是的。现在是卷起袖子，拿出排水蛇的时间了。如果你已经有了工作界面、路由、IP地址和DNS服务，但仍然没有完整的连接性，那么肯定有什么东西在外面阻挡了流量。
- en: The Linux equivalent of a drain snake, especially the fancy kind that comes
    with a video camera at the end, is Traceroute—which, as advertised, traces the
    route a packet takes across the network on its way to its target. If there’s anything
    blocking traffic anywhere down the line, Traceroute will at least show you where
    the clog is. Even if you’re in no position to investigate further, the information
    could be particularly valuable as your ISP tries to get things going again.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: Linux中排水蛇的等效物，特别是带有视频摄像头末端的复杂类型，是Traceroute——正如其名，它追踪数据包在网络中到达目标的路由。如果任何地方有阻塞流量，Traceroute至少会显示阻塞的位置。即使你无法进一步调查，这些信息也可能特别有价值，因为你的ISP试图让一切恢复正常。
- en: 'This example shows a successful end-to-end trip between my home workstation
    and google.com (represented by 172.217.0.238). If anything had gone wrong, the
    hops displayed would have stopped before reaching the goal. Lines of output containing
    nothing but asterisks (`*`) might sometimes represent packets failing to make
    it back. A complete failure will usually be accompanied by error messages:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例显示了从我的家庭工作站到google.com（表示为172.217.0.238）的成功端到端行程。如果出了任何问题，显示的跳转会在达到目标之前停止。只包含星号（`*`）的输出行有时可能表示数据包未能返回。通常，完全失败会伴随着错误信息：
- en: '[PRE17]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '***1* The first hop is my local router; the ~20 ms hop times displayed are
    a bit slow, but acceptable.**'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 第一跳是我的本地路由器；显示的~20毫秒跳转时间有点慢，但可以接受。**'
- en: '***2* My internet service provider**'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 我的互联网服务提供商**'
- en: Still nothing? Sounds like a good time to put in a phone call to your ISP.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 仍然没有解决问题？听起来是时候给你的ISP打电话了。
- en: 'Coming up next: what happens when people within your local network can access
    everything the big, bad internet has to offer, but your remote workers, clients,
    and visitors can’t get in to consume the services you offer.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来要讨论的是：当你的本地网络内的人可以访问互联网上的一切，但你的远程工作人员、客户和访客无法进入以消费你提供的服务时会发生什么。
- en: 14.4\. Troubleshooting inbound connectivity
  id: totrans-154
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.4\. 故障排除入站连接
- en: Whether it’s your company’s website, an API supporting your app, or an internal
    documentation wiki, there are parts of your infrastructure that you’ll want to
    be available 24/7\. Those kinds of inbound connectivity can be as important to
    your business or organization as the outgoing stuff we’ve just discussed.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 不论是你们公司的网站、支持你们应用的API还是内部文档维基，你们的基础设施中都有一些部分你们希望24/7可用。这类入站连接对于你们的企业或组织来说可能和刚刚讨论的出站连接一样重要。
- en: If your remote clients can’t connect to your services or if their connections
    are too slow, your business will suffer. Therefore, you’ll want to regularly confirm
    that your application is healthy and listening for incoming requests, that those
    requests have the access they need, and that there’s enough bandwidth to handle
    all the traffic. `netstat` and `netcat` can help with that.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的远程客户端无法连接到您的服务，或者它们的连接速度太慢，您的业务将受到影响。因此，您需要定期确认您的应用程序运行正常，正在监听传入的请求，这些请求拥有所需的访问权限，并且有足够的带宽来处理所有流量。`netstat`
    和 `netcat` 可以帮助您做到这一点。
- en: '14.4.1\. Internal connection scanning: netstat'
  id: totrans-157
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.4.1\. 内部连接扫描：netstat
- en: Running `netstat` on a server displays a wide range of network and interface
    statistics. What would interest you most when faced with a screaming horde of
    angry web clients, however, is a list of the services that are listening for network
    requests.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在服务器上运行 `netstat` 会显示广泛的网络和接口统计信息。然而，当面对一群愤怒的 Web 客户端时，您最感兴趣的可能是一份正在监听网络请求的服务列表。
- en: '`netstat -l` will show you all the sockets that are currently open. If it’s
    a website you’re running, then you can narrow down the results by filtering for
    `http`. In this case, both ports 80 (http) and 443 (https) appear to be active:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: '`netstat -l` 将显示当前所有打开的套接字。如果您正在运行一个网站，则可以通过过滤 `http` 来缩小结果。在这种情况下，端口 80（http）和
    443（https）似乎都是活跃的：'
- en: '[PRE18]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '***1* The protocol is shown as tcp6, suggesting that this is exclusively an
    IPv6 service. In fact, it covers both IPv6 and IPv4.**'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 协议显示为 tcp6，这表明这是一个专用的 IPv6 服务。实际上，它涵盖了 IPv6 和 IPv4。**'
- en: '|  |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**What exactly is a network socket?**'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络套接字究竟是什么？**'
- en: To be honest, I’m not 100% sure how to describe it. What it would mean to a
    C programmer might feel strange to a simple system administrator, like your humble
    servant. Nevertheless, I’ll risk oversimplification and say that a *service endpoint*
    is defined by the server’s IP address and the port (192.168.1.23:80, for instance).
    That combination identifies the *network socket*. A connection is created during
    a session involving two endpoints/sockets (a client and a server).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 坦白说，我不太确定如何描述它。对于一个 C 语言程序员来说，这可能感觉有些奇怪，但对于一个简单的系统管理员，比如我这样的谦卑仆人来说，可能感觉更奇怪。尽管如此，我还是冒险简化一下，说一个
    *服务端点* 是由服务器的 IP 地址和端口号（例如 192.168.1.23:80）定义的。这种组合确定了 *网络套接字*。在涉及两个端点/套接字（客户端和服务器）的会话期间创建连接。
- en: '|  |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '`netstat -i` will list your network interfaces. On the surface, that wouldn’t
    seem like such a big deal; after all, `ip addr` will do that too, right? Ah, yes.
    But `netstat` will also show you how many data packets have been received (`RX`)
    and transmitted (`TX`). `OK` indicates error-free transfers; `ERR`, damaged packets;
    and `DRP`, packets that were dropped. These statistics can be helpful when you’re
    not sure a service is active:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '`netstat -i` 将列出您的网络接口。表面上，这看起来可能不是什么大问题；毕竟，`ip addr` 也能做到这一点，对吧？啊，是的。但是 `netstat`
    还会显示接收到的数据包数量（`RX`）和发送的数据包数量（`TX`）。`OK` 表示无错误传输；`ERR` 表示损坏的数据包；`DRP` 表示丢弃的数据包。当您不确定服务是否活跃时，这些统计数据可能会有所帮助：'
- en: '[PRE19]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: That example appears to show a healthy and busy wireless interface (with the
    unfortunate name wlx9cefd5fe6a19), and an interface called enp1s0 that’s inactive.
    What’s going on? It’s a PC with an unused ethernet port that gets its internet
    via WiFi. In the code, `lo` is the localhost interface, also known as 127.0.0.1\.
    This is a great way to assess things from within the server, but how do things
    look from outside?
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 该示例似乎显示了一个健康且繁忙的无线接口（不幸的名称为 wlx9cefd5fe6a19），以及一个名为 enp1s0 的非活动接口。发生了什么事？这是一台带有未使用的以太网端口且通过
    WiFi 获取互联网的 PC。在代码中，`lo` 是 localhost 接口，也称为 127.0.0.1。这是一种从服务器内部评估事物的好方法，但外部看起来如何呢？
- en: '14.4.2\. External connection scanning: netcat'
  id: totrans-169
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 14.4.2\. 外部连接扫描：netcat
- en: 'You’ve used `cat` to stream text files and `zcat` to stream the contents of
    compressed archives. Now it’s time to meet another member of the (feline) family:
    `netcat` (often invoked as `nc`). As you might guess from its name, `netcat` can
    be used to stream files across networks, or even to serve as a simple two-way
    chat app.'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经使用 `cat` 来流式传输文本文件，使用 `zcat` 来流式传输压缩归档的内容。现在是时候认识（猫科）家族的另一位成员了：`netcat`（通常称为
    `nc`）。正如您从其名称中猜测的那样，`netcat` 可以用于在网络上流式传输文件，甚至可以作为简单的双向聊天应用程序。
- en: 'But right now you’re more interested in the status of your server and, in particular,
    how a client will see it. `nc`, when run against a remote address, tells you whether
    it was able to make a connection. `-z` restricts `netcat`’s output to the results
    of a scan for listening daemons (rather than trying to make a connection), and
    `-v` adds verbosity to the output. You’ll need to specify the port or ports you
    want to scan. Here’s an example:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 但现在您更感兴趣的是服务器状态，特别是客户端将如何看到它。`nc`在针对远程地址运行时，会告诉您是否能够建立连接。`-z`将`netcat`的输出限制为扫描监听守护进程的结果（而不是尝试建立连接），而`-v`增加了输出的详细程度。您需要指定要扫描的端口或端口。以下是一个示例：
- en: '[PRE20]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'If either or both of those services (HTTP and HTTPS) were not available, the
    scan would fail. That could be because the service isn’t running on the server
    (perhaps your Apache web server has stopped) or there’s an overly strict firewall
    rule blocking access. This is how a failed scan would look:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 如果其中任何一个或两个服务（HTTP和HTTPS）不可用，扫描将失败。这可能是因为服务没有在服务器上运行（例如，您的Apache网络服务器已停止）或者存在过于严格的防火墙规则阻止访问。失败的扫描将如下所示：
- en: '[PRE21]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'This is Linux, however, so you can be sure there’s more than one good way to
    get this job done. Therefore, be aware that `nmap` can be used to perform a similar
    scan:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这是Linux，所以您可以确信完成这项工作有不止一种好方法。因此，请注意，`nmap`可以用来执行类似的扫描：
- en: '[PRE22]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'And this `nmap` command will scan for any open ports between ports 1 and 1023,
    an excellent way to quickly audit your system to make sure there’s nothing open
    that shouldn’t be:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 这个`nmap`命令将扫描1到1023端口之间的任何开放端口，这是一种快速审计系统以确保没有不应该开放的端口的好方法：
- en: '[PRE23]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Which ports “should be” open? That depends on the software you’re running on
    the server. As a rule of thumb, if `nmap` reports any unfamiliar open ports, search
    online to find out what software uses those ports, and then ask yourself whether
    it’s reasonable for that software to be running on your server.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 哪些端口“应该”开放？这取决于您在服务器上运行的软件。作为一个经验法则，如果`nmap`报告任何不熟悉的开放端口，请在网上搜索以找出使用这些端口的软件，然后问问自己，该软件在您的服务器上运行是否合理。
- en: Summary
  id: totrans-180
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 摘要
- en: Practically at least, Linux defines and manages network interfaces and routes
    within the context of NAT networking protocols.
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少在实践上，Linux在NAT网络协议的上下文中定义和管理网络接口和路由。
- en: Linux needs to recognize attached hardware peripherals like network interfaces,
    but also designate device labels (like eth0) before they’re usable.
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux需要识别连接的硬件外围设备，如网络接口，但在它们可用之前还需要指定设备标签（如eth0）。
- en: Custom static IP addresses can be assigned to a device both through editing
    configuration files and from the command line (using `ip`). Dynamic address can
    be automatically requested from DHCP servers, but you can’t control the addresses
    you get.
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以通过编辑配置文件和从命令行（使用`ip`）为设备分配自定义静态IP地址。动态地址可以从DHCP服务器自动请求，但您无法控制获得的地址。
- en: Confirming that appropriate local services are accessible for remote clients
    involves scanning for open sockets and ports.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确认远程客户端可以访问适当的本地服务涉及扫描开放的套接字和端口。
- en: Key terms
  id: totrans-185
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 关键术语
- en: '*TCP/IP* is the Transmission Control Protocol and Internet Protocol conventions
    that define network behavior administration.'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*TCP/IP*是定义网络行为管理的传输控制协议和互联网协议约定。'
- en: '*Public-facing IP addresses* must be globally unique, whereas *NAT addresses*
    need to be unique only within their local network. The *Dynamic Host Configuration
    Protocol* (DHCP) is commonly used to manage dynamic (nonpermanent) address assignment.'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*公网IP地址*必须是全局唯一的，而*NAT地址*只需要在本地网络内是唯一的。*动态主机配置协议*（DHCP）通常用于管理动态（非永久性）地址分配。'
- en: A *network route* is the address of a gateway router through which a computer
    gains network access.
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*网络路由*是通过计算机获得网络访问的网关路由器的地址。'
- en: The *Domain Name System* (DNS) provides translations between numeric IP addresses
    and human-readable URLs allowing convenient navigation of internet resources.
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*域名系统*（DNS）提供数字IP地址和可读URL之间的转换，使得方便地导航互联网资源。'
- en: A *network socket* is the representation of an IP address and a port through
    which a network connection can be activated.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*网络套接字*是IP地址和端口的表示，通过网络连接可以通过它被激活。'
- en: Security best practices
  id: totrans-191
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安全最佳实践
- en: It’s good to periodically use a tool like `nmap` to audit your system for inappropriately
    open ports.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 定期使用像`nmap`这样的工具来审计您的系统，检查是否有不适当地开放的端口，这是一个好习惯。
- en: Command-line review
  id: totrans-193
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 命令行审查
- en: '`ip addr` lists the active interfaces on a Linux system. You can shorten it
    to `ip a` or lengthened it to `ip address`. It’s your choice.'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip addr` lists the active interfaces on a Linux system. You can shorten it
    to `ip a` or lengthened it to `ip address`. It’s your choice.'
- en: '`lspci` lists the PCI devices currently connected to your computer.'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`lspci` lists the PCI devices currently connected to your computer.'
- en: '`dmesg | grep -A 2 Ethernet` searches the `dmesg` logs for references to the
    string *Ethernet* and displays references along with the subsequent two lines
    of output.'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dmesg | grep -A 2 Ethernet` searches the `dmesg` logs for references to the
    string *Ethernet* and displays references along with the subsequent two lines
    of output.'
- en: '`ip route add default via 192.168.1.1 dev eth0` manually sets a new network
    route for a computer.'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip route add default via 192.168.1.1 dev eth0` manually sets a new network
    route for a computer.'
- en: '`dhclient enp0s3` requests a dynamic (DHCP) IP address for the enp0s3 interface.'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`dhclient enp0s3` requests a dynamic (DHCP) IP address for the enp0s3 interface.'
- en: '`ip addr add 192.168.1.10/24 dev eth0` assigns a static IP address to the eth0
    interface, which won’t persist past the next system restart.'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip addr add 192.168.1.10/24 dev eth0` assigns a static IP address to the eth0
    interface, which won’t persist past the next system restart.'
- en: '`ip link set dev enp0s3 up` starts the enp0s3 interface (useful after editing
    the configuration).'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ip link set dev enp0s3 up` starts the enp0s3 interface (useful after editing
    the configuration).'
- en: '`netstat -l | grep http` scans a local machine for a web service listening
    on port 80.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`netstat -l | grep http` scans a local machine for a web service listening
    on port 80.'
- en: '`nc -z -v bootstrap-it.com 443 80` scans a remote web site for services listening
    on the ports 443 or 80.'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`nc -z -v bootstrap-it.com 443 80` scans a remote web site for services listening
    on the ports 443 or 80.'
- en: Test yourself
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测试自己
- en: '**[1](#ch14qa2q0a1)**'
  id: totrans-204
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[1](#ch14qa2q0a1)**'
- en: ''
  id: totrans-205
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following is a valid NAT IP address?
  id: totrans-206
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个是有效的NAT IP地址？
- en: ''
  id: totrans-207
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 11.0.0.23
  id: totrans-208
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 11.0.0.23
- en: 72.10.4.9
  id: totrans-209
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 72.10.4.9
- en: 192.168.240.98
  id: totrans-210
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 192.168.240.98
- en: 198.162.240.98
  id: totrans-211
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 198.162.240.98
- en: '**[2](#ch14qa2q0a2)**'
  id: totrans-212
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[2](#ch14qa2q0a2)**'
- en: ''
  id: totrans-213
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: How would you describe an IPv4 network subnet using two octets for network addresses,
    both with CIDR and netmast notation?
  id: totrans-214
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你将如何描述使用两个八位字节作为网络地址的IPv4网络子网，同时使用CIDR和netmask表示法？
- en: ''
  id: totrans-215
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: x.x.x.x/16 or 255.255.0.0
  id: totrans-216
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: x.x.x.x/16 或 255.255.0.0
- en: x.x.x.x/24 or 255.255.255.0
  id: totrans-217
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: x.x.x.x/24 或 255.255.255.0
- en: x.x.x.x/16 or 255.0.0.0
  id: totrans-218
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: x.x.x.x/16 或 255.0.0.0
- en: x.x.x.x/16 or 255.255.240.0
  id: totrans-219
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: x.x.x.x/16 或 255.255.240.0
- en: '**[3](#ch14qa2q0a3)**'
  id: totrans-220
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[3](#ch14qa2q0a3)**'
- en: ''
  id: totrans-221
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following commands will help you discover the designation given
    by Linux to a network interface?
  id: totrans-222
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个命令可以帮助你发现Linux为网络接口指定的名称？
- en: ''
  id: totrans-223
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`dmesg`'
  id: totrans-224
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`dmesg`'
- en: '`lspci`'
  id: totrans-225
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`lspci`'
- en: '`lshw -class network`'
  id: totrans-226
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`lshw -class network`'
- en: '`dhclient`'
  id: totrans-227
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`dhclient`'
- en: '**[4](#ch14qa2q0a4)**'
  id: totrans-228
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[4](#ch14qa2q0a4)**'
- en: ''
  id: totrans-229
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: You’re setting up a PC in your office and want it to have reliable network connectivity.
    Which of the following profiles will work best?
  id: totrans-230
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你正在设置办公室的PC，并希望它具有可靠的网络连接。以下哪个配置文件将最适合？
- en: ''
  id: totrans-231
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Dynamic IP address connected directly to the internet
  id: totrans-232
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 动态IP地址，直接连接到互联网
- en: Static IP address that’s part of a NAT network
  id: totrans-233
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 静态IP地址，属于NAT网络的一部分
- en: Static IP address connected directly to the internet
  id: totrans-234
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 静态IP地址，直接连接到互联网
- en: Dynamic IP address that’s part of a NAT network
  id: totrans-235
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 动态IP地址，属于NAT网络的一部分
- en: '**[5](#ch14qa2q0a5)**'
  id: totrans-236
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[5](#ch14qa2q0a5)**'
- en: ''
  id: totrans-237
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following commands is used to request a dynamic IP address?
  id: totrans-238
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个命令用于请求动态IP地址？
- en: ''
  id: totrans-239
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`ip route`'
  id: totrans-240
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ip route`'
- en: '`dhclient enp0s3`'
  id: totrans-241
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`dhclient enp0s3`'
- en: '`ip client enp0s3`'
  id: totrans-242
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ip client enp0s3`'
- en: '`ip client localhost`'
  id: totrans-243
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ip client localhost`'
- en: '**[6](#ch14qa2q0a6)**'
  id: totrans-244
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[6](#ch14qa2q0a6)**'
- en: ''
  id: totrans-245
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which file would you edit to configure a network interface named enp0s3 on a
    CentOS machine?
  id: totrans-246
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你将编辑哪个文件来配置CentOS机器上名为enp0s3的网络接口？
- en: ''
  id: totrans-247
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: /etc/sysconfig/networking/ipcfg-enp0s3
  id: totrans-248
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/sysconfig/networking/ipcfg-enp0s3
- en: /etc/sysconfig/network-scripts/ipcfg-enp0s3
  id: totrans-249
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/sysconfig/network-scripts/ipcfg-enp0s3
- en: /etc/sysconfig/network-scripts/enp0s3
  id: totrans-250
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/sysconfig/network-scripts/enp0s3
- en: /etc/sysconfig/network-scripts/ifcfg-enp0s3
  id: totrans-251
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/sysconfig/network-scripts/ifcfg-enp0s3
- en: '**[7](#ch14qa2q0a7)**'
  id: totrans-252
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[7](#ch14qa2q0a7)**'
- en: ''
  id: totrans-253
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What line would you add to a network interface configuration section of the
    /etc/network/interfaces file on an Ubuntu machine to force the interface to use
    a Google DNS name server?
  id: totrans-254
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你会在Ubuntu机器的`/etc/network/interfaces`文件的哪个网络接口配置部分添加哪一行，以强制接口使用Google DNS名称服务器？
- en: ''
  id: totrans-255
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: DNS1=8.8.8.8
  id: totrans-256
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: DNS1=8.8.8.8
- en: dns-nameserver 8.8.8.8
  id: totrans-257
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: dns-nameserver 8.8.8.8
- en: nameserver 8.8.8.8
  id: totrans-258
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: nameserver 8.8.8.8
- en: dns-nameserver1 8.8.8.8
  id: totrans-259
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: dns-nameserver1 8.8.8.8
- en: '**[8](#ch14qa2q0a8)**'
  id: totrans-260
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[8](#ch14qa2q0a8)**'
- en: ''
  id: totrans-261
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following will scan the well-known TCP ports on a remote server
    for accessible, listening services?
  id: totrans-262
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个命令将扫描远程服务器上知名TCP端口，以查找可访问的监听服务？
- en: ''
  id: totrans-263
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`nmap -s -p1-1023 bootstrap-it.com`'
  id: totrans-264
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`nmap -s -p1-1023 bootstrap-it.com`'
- en: '`nmap -sU -p80 bootstrap-it.com`'
  id: totrans-265
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`nmap -sU -p80 bootstrap-it.com`'
- en: '`nmap -sT -p1-1023 bootstrap-it.com`'
  id: totrans-266
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`nmap -sT -p1-1023 bootstrap-it.com`'
- en: '`nc -z -v bootstrap-it.com`'
  id: totrans-267
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`nc -z -v bootstrap-it.com`'
- en: Answer key
  id: totrans-268
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 答案键
- en: '**[1.](#ch14qa1q1)**'
  id: totrans-269
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[1.](#ch14qa1q1)**'
- en: ''
  id: totrans-270
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: c
  id: totrans-271
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: c
- en: '**[2.](#ch14qa1q2)**'
  id: totrans-272
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[2.](#ch14qa1q2)**'
- en: ''
  id: totrans-273
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: a
  id: totrans-274
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: a
- en: '**[3.](#ch14qa1q3)**'
  id: totrans-275
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[3.](#ch14qa1q3)**'
- en: ''
  id: totrans-276
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: a
  id: totrans-277
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: a
- en: '**[4.](#ch14qa1q4)**'
  id: totrans-278
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[4.](#ch14qa1q4)**'
- en: ''
  id: totrans-279
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: d
  id: totrans-280
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: d
- en: '**[5.](#ch14qa1q5)**'
  id: totrans-281
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[5.](#ch14qa1q5)**'
- en: ''
  id: totrans-282
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: b
  id: totrans-283
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: b
- en: '**[6.](#ch14qa1q6)**'
  id: totrans-284
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[6.](#ch14qa1q6)**'
- en: ''
  id: totrans-285
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: d
  id: totrans-286
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: d
- en: '**[7.](#ch14qa1q7)**'
  id: totrans-287
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[7.](#ch14qa1q7)**'
- en: ''
  id: totrans-288
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: d
  id: totrans-289
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: d
- en: '**[8.](#ch14qa1q8)**'
  id: totrans-290
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[8.](#ch14qa1q8)**'
- en: ''
  id: totrans-291
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: c
  id: totrans-292
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: c
