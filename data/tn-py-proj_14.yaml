- en: '13 Twelve Days of Christmas: Algorithm design'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 13 åœ£è¯èŠ‚çš„åäºŒå¤©ï¼šç®—æ³•è®¾è®¡
- en: '| Perhaps one of the worst songs of all time, and the one that is sure to ruin
    my Christmas spirit, is â€œThe Twelve Days of Christmas.â€ WILL IT EVER STOP!? AND
    WHAT IS WITH ALL THE BIRDS?! Still, itâ€™s pretty interesting to write an algorithm
    to generate the song starting from any given day because you have to count *up*
    as you add each verse (day) and then count *down* inside the verses (recapitulating
    the previous daysâ€™ gifts). Youâ€™ll be able to build on what you learned writing
    the program for â€œ99 Bottles of Beer.â€ | ![](../Images/13-unnumb-1.png)  |'
  id: totrans-1
  prefs: []
  type: TYPE_TB
  zh: '| å¯èƒ½æ˜¯æœ‰å²ä»¥æ¥æœ€ç³Ÿç³•çš„æ­Œæ›²ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ä¸€å®šä¼šç ´åæˆ‘çš„åœ£è¯ç²¾ç¥çš„ä¸€é¦–æ­Œï¼Œâ€œåœ£è¯èŠ‚çš„åäºŒå¤©â€ã€‚å®ƒä»€ä¹ˆæ—¶å€™æ‰èƒ½åœæ­¢ï¼Ÿï¼è¿˜æœ‰ï¼Œæ‰€æœ‰è¿™äº›é¸Ÿæ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿï¼å°½ç®¡å¦‚æ­¤ï¼Œç¼–å†™ä¸€ä¸ªä»ä»»ä½•ç»™å®šæ—¥æœŸå¼€å§‹ç”Ÿæˆè¿™é¦–æ­Œçš„ç®—æ³•ä»ç„¶å¾ˆæœ‰è¶£ï¼Œå› ä¸ºä½ å¿…é¡»éšç€æ¯æ®µï¼ˆå¤©ï¼‰çš„å¢åŠ è€Œå‘ä¸Šè®¡æ•°ï¼Œç„¶ååœ¨æ®µè½ï¼ˆå›é¡¾å‰ä¸€å¤©çš„ç¤¼ç‰©ï¼‰ä¸­å‘ä¸‹è®¡æ•°ã€‚ä½ å°†èƒ½å¤Ÿåœ¨ä½ ä¸ºâ€œ99ç“¶å•¤é…’â€ç¼–å†™çš„ç¨‹åºçš„åŸºç¡€ä¸Šè¿›è¡Œæ„å»ºã€‚|
    ![å›¾ç‰‡](../Images/13-unnumb-1.png) |'
- en: 'Our program in this chapter will be called twelve_days.py, and it will generate
    the â€œTwelve Days of Christmasâ€ song up to a given day, specified by the `-n` or
    `--num` argument (default `12`). Note that there should be two newlines between
    verses but only one at the end:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬ç« ä¸­çš„ç¨‹åºå°†å‘½åä¸ºtwelve_days.pyï¼Œå®ƒå°†æ ¹æ®`-n`æˆ–`--num`å‚æ•°ï¼ˆé»˜è®¤`12`ï¼‰ç”Ÿæˆç»™å®šæ—¥æœŸçš„â€œåœ£è¯èŠ‚çš„åäºŒå¤©â€æ­Œæ›²ã€‚è¯·æ³¨æ„ï¼Œæ®µè½ä¹‹é—´åº”æœ‰ä¸¤ä¸ªæ¢è¡Œç¬¦ï¼Œä½†ç»“å°¾å¤„åªæœ‰ä¸€ä¸ªï¼š
- en: '[PRE0]'
  id: totrans-3
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The text will be printed to `STDOUT` unless there is an `-o` or `--outfile`
    argument, in which case the text should be placed inside a file with the given
    name. Note that there should be 113 lines of text for the entire song:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ²¡æœ‰æä¾›`-o`æˆ–`--outfile`å‚æ•°ï¼Œæ–‡æœ¬å°†æ‰“å°åˆ°`STDOUT`ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–‡æœ¬åº”æ”¾ç½®åœ¨ç»™å®šåç§°çš„æ–‡ä»¶ä¸­ã€‚è¯·æ³¨æ„ï¼Œæ•´ä¸ªæ­Œæ›²åº”æœ‰113è¡Œæ–‡æœ¬ï¼š
- en: '[PRE1]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: In this exercise, you will
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œä½ éœ€è¦
- en: Create an algorithm to generate â€œThe Twelve Days of Christmasâ€ from any given
    day in the range 1-12
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç¼–å†™ä¸€ä¸ªç®—æ³•ï¼Œä»1-12èŒƒå›´å†…çš„ä»»ä½•ç»™å®šæ—¥æœŸç”Ÿæˆâ€œåœ£è¯èŠ‚çš„åäºŒå¤©â€
- en: Reverse a list
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åè½¬ä¸€ä¸ªåˆ—è¡¨
- en: Use the `range()` function
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨`range()`å‡½æ•°
- en: Write text to a file or to `STDOUT`
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†æ–‡æœ¬å†™å…¥æ–‡ä»¶æˆ–`STDOUT`
- en: 13.1 Writing twelve_days.py
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.1 ç¼–å†™twelve_days.py
- en: As always, I suggest you create your program by running new.py or by copying
    the template/template.py file. This one must be called twelve_days.py and live
    in the 13_twelve_days directory.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: å’Œå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘å»ºè®®ä½ é€šè¿‡è¿è¡Œnew.pyæˆ–å¤åˆ¶template/template.pyæ–‡ä»¶æ¥åˆ›å»ºä½ çš„ç¨‹åºã€‚è¿™ä¸ªç¨‹åºå¿…é¡»å‘½åä¸ºtwelve_days.pyï¼Œå¹¶ä½äº13_twelve_daysç›®å½•ä¸­ã€‚
- en: 'Your program should take two options:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ çš„ç¨‹åºåº”è¯¥æ¥å—ä¸¤ä¸ªé€‰é¡¹ï¼š
- en: '`-n` or `--num`--An `int` with a default of 12'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-n`æˆ–`--num`--ä¸€ä¸ªé»˜è®¤å€¼ä¸º12çš„æ•´æ•°'
- en: '`-o` or `--outfile`--An optional filename for writing the output'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-o`æˆ–`--outfile`--ç”¨äºå†™å…¥è¾“å‡ºçš„å¯é€‰æ–‡ä»¶å'
- en: For the second option, you can go back to chapter 5 to see how we handled this
    in the Howler solution. That program writes its blistering output to the given
    filename if one is supplied, and otherwise writes to `sys.stdout`. For this program,
    I suggest you declare the `--outfile` using `type=argparse.FileType('wt')` to
    indicate that `argparse` will require an argument to name a *writable text* file.
    If the user supplies a valid argument, `args.outfile` will be an *open, writable
    file handle*. If you also use a default of `sys.stdout`, youâ€™ll have quickly handled
    both options of writing to a text file or `STDOUT`!
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºç¬¬äºŒä¸ªé€‰é¡¹ï¼Œä½ å¯ä»¥å›åˆ°ç¬¬5ç« æŸ¥çœ‹æˆ‘ä»¬å¦‚ä½•åœ¨Howlerè§£å†³æ–¹æ¡ˆä¸­å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚è¯¥ç¨‹åºå°†è¾“å‡ºå†™å…¥æŒ‡å®šçš„æ–‡ä»¶åï¼Œå¦‚æœæ²¡æœ‰æä¾›ï¼Œåˆ™å†™å…¥`sys.stdout`ã€‚å¯¹äºè¿™ä¸ªç¨‹åºï¼Œæˆ‘å»ºè®®ä½ ä½¿ç”¨`type=argparse.FileType('wt')`å£°æ˜`--outfile`ï¼Œä»¥è¡¨æ˜`argparse`å°†éœ€è¦ä¸€ä¸ªå‚æ•°æ¥å‘½åä¸€ä¸ª*å¯å†™æ–‡æœ¬æ–‡ä»¶*ã€‚å¦‚æœç”¨æˆ·æä¾›äº†æœ‰æ•ˆçš„å‚æ•°ï¼Œ`args.outfile`å°†æ˜¯ä¸€ä¸ª*æ‰“å¼€çš„ã€å¯å†™çš„æ–‡ä»¶å¥æŸ„*ã€‚å¦‚æœä½ è¿˜ä½¿ç”¨é»˜è®¤çš„`sys.stdout`ï¼Œä½ å°†å¾ˆå¿«å°±èƒ½å¤„ç†å†™å…¥æ–‡æœ¬æ–‡ä»¶æˆ–`STDOUT`çš„ä¸¤ç§é€‰é¡¹ï¼
- en: 'The only downside to this approach is that the usage statement for the program
    looks a little funny in describing the default for the `--outfile` parameter:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§æ–¹æ³•çš„å”¯ä¸€ç¼ºç‚¹æ˜¯ï¼Œç¨‹åºçš„ç”¨æ³•è¯´æ˜åœ¨æè¿°`--outfile`å‚æ•°çš„é»˜è®¤å€¼æ—¶çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼š
- en: '[PRE2]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Once youâ€™ve completed the usage, your program should pass the first two tests.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæˆç”¨æ³•è¯´æ˜åï¼Œä½ çš„ç¨‹åºåº”è¯¥é€šè¿‡å‰ä¸¤ä¸ªæµ‹è¯•ã€‚
- en: Figure 13.1 shows a holly, jolly string diagram to get you in the mood for writing
    the rest of the program.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾13.1æ˜¾ç¤ºäº†ä¸€ä¸ªå……æ»¡èŠ‚æ—¥æ°”æ°›çš„å­—ç¬¦ä¸²å›¾ï¼Œä»¥å¸®åŠ©ä½ ç¼–å†™ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†ã€‚
- en: '![](../Images/13-1.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![å›¾ç‰‡](../Images/13-1.png)'
- en: Figure 13.1 The twelve_days.py program takes options for which day to start
    on and an output file to write.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾13.1 twelve_days.pyç¨‹åºæ¥å—å¼€å§‹æ—¥æœŸå’Œè¾“å‡ºæ–‡ä»¶çš„é€‰é¡¹ã€‚
- en: 'The program should complain if the `--num` value is not in the range 1-12\.
    I suggest you check this inside the `get_args()` function and use `parser.error()`
    to halt with an error and usage message:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœ`--num`å€¼ä¸åœ¨1-12çš„èŒƒå›´å†…ï¼Œç¨‹åºåº”è¯¥ä¼šæŠ±æ€¨ã€‚æˆ‘å»ºè®®ä½ åœ¨`get_args()`å‡½æ•°å†…éƒ¨è¿›è¡Œæ£€æŸ¥ï¼Œå¹¶ä½¿ç”¨`parser.error()`æ¥åœæ­¢å¹¶æ˜¾ç¤ºé”™è¯¯å’Œç”¨æ³•ä¿¡æ¯ï¼š
- en: '[PRE3]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Once youâ€™ve handled the bad `--num`, you should pass the first three tests.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦ä½ å¤„ç†äº†é”™è¯¯çš„ `--num`ï¼Œä½ åº”è¯¥é€šè¿‡å‰ä¸‰ä¸ªæµ‹è¯•ã€‚
- en: 13.1.1 Counting
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.1 è®¡æ•°
- en: 'In the â€œ99 Bottles of Beerâ€ song, we needed to count down from a given number.
    Here we need to count up to `--num` and then count back down through the gifts.
    The `range()` function will give us what we need, but we must remember to start
    at `1` because we donâ€™t start singing â€œOn the zeroth day of Christmas.â€ Keep in
    mind that the upper bound is not included:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨â€œ99ç“¶å•¤é…’â€è¿™é¦–æ­Œä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä»ç»™å®šçš„æ•°å­—å¼€å§‹å€’æ•°ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦æ•°åˆ° `--num`ï¼Œç„¶åé€šè¿‡ç¤¼ç‰©å€’å›åˆ° `1`ã€‚`range()` å‡½æ•°ä¼šç»™æˆ‘ä»¬æ‰€éœ€çš„å†…å®¹ï¼Œä½†æˆ‘ä»¬å¿…é¡»è®°ä½ä»
    `1` å¼€å§‹ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ä¼šä»â€œåœ£è¯èŠ‚çš„é›¶å¤©â€å¼€å§‹å”±ã€‚è®°ä½ï¼Œä¸Šé™ä¸åŒ…æ‹¬åœ¨å†…ï¼š
- en: '[PRE4]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Youâ€™ll need to add 1 to whatever youâ€™re given for `--num`:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ éœ€è¦å°† `--num` ç»™å®šçš„ä»»ä½•å€¼åŠ  `1`ï¼š
- en: '[PRE5]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Letâ€™s start by printing something like the first line of each verse:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»æ‰“å°æ¯ä¸ªè¯—ç¯‡çš„ç¬¬ä¸€è¡Œå¼€å§‹ï¼š
- en: '[PRE6]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'At this point, Iâ€™m starting to think about how we wrote â€œ99 Bottles of Beer.â€
    There we ended up creating a `verse()` function that would generate any *one*
    verse. Then we used `str.join()` to put them all together with two newlines. I
    suggest we try the same approach here, so Iâ€™ll move the code inside the `for`
    loop into its own function:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å¼€å§‹æ€è€ƒæˆ‘ä»¬æ˜¯å¦‚ä½•å†™â€œ99ç“¶å•¤é…’â€çš„ã€‚åœ¨é‚£é‡Œï¼Œæˆ‘ä»¬æœ€ç»ˆåˆ›å»ºäº†ä¸€ä¸ª `verse()` å‡½æ•°ï¼Œå®ƒå¯ä»¥ç”Ÿæˆä»»ä½• *ä¸€ä¸ª* è¯—ç¯‡ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨
    `str.join()` å°†å®ƒä»¬å…¨éƒ¨æ”¾åœ¨ä¸€èµ·ï¼Œå¹¶æ·»åŠ ä¸¤ä¸ªæ¢è¡Œç¬¦ã€‚æˆ‘å»ºè®®æˆ‘ä»¬åœ¨è¿™é‡Œå°è¯•åŒæ ·çš„æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘å°† `for` å¾ªç¯å†…çš„ä»£ç ç§»åŠ¨åˆ°å®ƒè‡ªå·±çš„å‡½æ•°ä¸­ï¼š
- en: '[PRE7]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Notice that the function will not `print()` the string but will `return` the
    verse, so that we can test it:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè¯¥å‡½æ•°ä¸ä¼š `print()` å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ `return` è¯—ç¯‡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æµ‹è¯•å®ƒï¼š
- en: '[PRE8]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Letâ€™s see how we can use this `verse()` function:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™ä¸ª `verse()` å‡½æ•°ï¼š
- en: '[PRE9]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Hereâ€™s a simple `test_verse()` function we could start off with:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ `test_verse()` å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™é‡Œå¼€å§‹ï¼š
- en: '[PRE10]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This is incorrect, of course, because it should say â€œOn the *first* dayâ€ or
    the â€œ*second* day,â€ not â€œ1 dayâ€ or â€œ2 day.â€ Still, itâ€™s a place to start. Add
    the `verse()` and `test_verse()` functions to your twelve_days.py program, and
    then run `pytest` `twelve_days.py` to verify this much works.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å½“ç„¶æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå®ƒåº”è¯¥è¯´â€œOn the *first* dayâ€æˆ–â€œ*second* dayâ€ï¼Œè€Œä¸æ˜¯â€œ1 dayâ€æˆ–â€œ2 dayâ€ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªèµ·ç‚¹ã€‚å°†
    `verse()` å’Œ `test_verse()` å‡½æ•°æ·»åŠ åˆ°ä½ çš„ twelve_days.py ç¨‹åºä¸­ï¼Œç„¶åè¿è¡Œ `pytest` `twelve_days.py`
    æ¥éªŒè¯è¿™ä¸€ç‚¹æ˜¯å¦å·¥ä½œã€‚
- en: 13.1.2 Creating the ordinal value
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.2 åˆ›å»ºåºæ•°å€¼
- en: 'Maybe the first thing to do is to change the numeric value to its ordinal position,
    that is â€œ1â€ to â€œfirst,â€ â€œ2â€ to â€œsecond.â€ You could use a dictionary like we used
    in â€œJump The Fiveâ€ to associate each `int` value 1-12 with its `str` value. That
    is, you might create a new `dict` called `ordinal`:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: å¯èƒ½é¦–å…ˆè¦åšçš„äº‹æƒ…æ˜¯å°†æ•°å­—å€¼è½¬æ¢ä¸ºå®ƒçš„åºæ•°ä½ç½®ï¼Œå³â€œ1â€åˆ°â€œfirstâ€ï¼Œâ€œ2â€åˆ°â€œsecondâ€ã€‚ä½ å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åœ¨â€œè·³è¿‡äº”â€ä¸­ä½¿ç”¨çš„ç±»ä¼¼å­—å…¸æ¥å…³è”æ¯ä¸ª
    `int` å€¼ 1-12 ä¸å…¶ `str` å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯èƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ `dict` è¢«ç§°ä¸º `ordinal`ï¼š
- en: '[PRE11]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Then you could do this:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åä½ å¯ä»¥è¿™æ ·åšï¼š
- en: '[PRE12]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: You could also use a `list`, if you think about how you could use each `day`
    in the `range()` to index into a `list` of ordinal strings.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ª `list`ï¼Œå¦‚æœä½ è€ƒè™‘å¦‚ä½•ä½¿ç”¨ `range()` ä¸­çš„æ¯ä¸ª `day` æ¥ç´¢å¼•ä¸€ä¸ªåºæ•°å­—ç¬¦ä¸²çš„ `list`ã€‚
- en: '[PRE13]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Your `verse()` function might look something like this now:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ çš„ `verse()` å‡½æ•°ç°åœ¨å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š
- en: '[PRE14]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You can update your test with your expectations:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥ç”¨ä½ çš„é¢„æœŸæ¥æ›´æ–°ä½ çš„æµ‹è¯•ï¼š
- en: '[PRE15]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Once you have this working, you should be able to replicate something like
    this:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦è¿™ä¸ªå·¥ä½œæ­£å¸¸ï¼Œä½ åº”è¯¥èƒ½å¤Ÿå¤åˆ¶å‡ºç±»ä¼¼è¿™æ ·çš„ä¸œè¥¿ï¼š
- en: '[PRE16]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: If you put the `test_verse()` function inside your twelve_days.py program, you
    can verify that your `verse()` function works by running `pytest` `twelve_days.py`.
    The `pytest` module will run any function that has a name starting with `test_`.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ å°† `test_verse()` å‡½æ•°æ”¾åœ¨ä½ çš„ twelve_days.py ç¨‹åºä¸­ï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œ `pytest` `twelve_days.py`
    æ¥éªŒè¯ä½ çš„ `verse()` å‡½æ•°æ˜¯å¦å·¥ä½œã€‚`pytest` æ¨¡å—ä¼šè¿è¡Œä»»ä½•ä»¥ `test_` å¼€å¤´çš„å‡½æ•°åï¼š
- en: Shadowing
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: é®è”½
- en: 'You might be tempted to use the variable name `ord`, and you would be allowed
    by Python to do this. The problem is that Python has a function called `ord()`
    that returns â€œthe Unicode code point for a one-character stringâ€:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæƒ³ä½¿ç”¨å˜é‡å `ord`ï¼ŒPython å…è®¸ä½ è¿™æ ·åšã€‚é—®é¢˜æ˜¯ Python æœ‰ä¸€ä¸ªåä¸º `ord()` çš„å‡½æ•°ï¼Œå®ƒè¿”å›â€œä¸€ä¸ªå•å­—ç¬¦å­—ç¬¦ä¸²çš„ Unicode
    ç ç‚¹â€ï¼š
- en: '[PRE17]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Python will not complain if you define a variable or another function with the
    name `ord`,
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Python ä¸ä¼šæŠ±æ€¨å¦‚æœä½ å®šä¹‰ä¸€ä¸ªå˜é‡æˆ–å¦ä¸€ä¸ªå‡½æ•°åä¸º `ord`ï¼Œ
- en: '[PRE18]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'such that you could do this:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ ·ä½ å°±å¯ä»¥è¿™æ ·åšï¼š
- en: '[PRE19]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'But that overwrites the actual `ord` function and so breaks a function call:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†è¿™ä¼šè¦†ç›–å®é™…çš„ `ord` å‡½æ•°ï¼Œä»è€Œå¯¼è‡´å‡½æ•°è°ƒç”¨å‡ºé”™ï¼š
- en: '[PRE20]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This is called â€œshadowing,â€ and itâ€™s quite dangerous. Any code in the scope
    of the shadowing would be affected by the change.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™è¢«ç§°ä¸ºâ€œé®è”½â€ï¼Œå®ƒç›¸å½“å±é™©ã€‚ä»»ä½•åœ¨é®è”½ä½œç”¨åŸŸå†…çš„ä»£ç éƒ½ä¼šå—åˆ°å½±å“ã€‚
- en: 'Tools like Pylint can help you find problems like this in your programs. Assume
    you have the following code:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: åƒ Pylint è¿™æ ·çš„å·¥å…·å¯ä»¥å¸®åŠ©ä½ åœ¨ç¨‹åºä¸­æ‰¾åˆ°ç±»ä¼¼çš„é—®é¢˜ã€‚å‡è®¾ä½ æœ‰äº†ä»¥ä¸‹ä»£ç ï¼š
- en: '[PRE21]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Here is what Pylint has to say:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ Pylint çš„æ„è§ï¼š
- en: '[PRE22]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Itâ€™s good to double-check your code with tools like Pylint and Flake8!
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨åƒ Pylint å’Œ Flake8 è¿™æ ·çš„å·¥å…·æ£€æŸ¥ä½ çš„ä»£ç æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼
- en: 13.1.3 Making the verses
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.3 åˆ¶ä½œè¯—ç¯‡
- en: 'Now that we have the basic structure of the program, letâ€™s focus on creating
    the *correct* output. Weâ€™ll update `test_verse()` with the actual values for the
    first two verses. You can, of course, add more tests, but presumably if we can
    manage the first two days, we can handle all the other days:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†ç¨‹åºçš„åŸºæœ¬ç»“æ„ï¼Œè®©æˆ‘ä»¬ä¸“æ³¨äºåˆ›å»º*æ­£ç¡®*çš„è¾“å‡ºã€‚æˆ‘ä»¬å°†ç”¨å‰ä¸¤é¦–è¯—çš„å®é™…å€¼æ›´æ–° `test_verse()`ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥æ·»åŠ æ›´å¤šæµ‹è¯•ï¼Œä½†å¦‚æœæˆ‘ä»¬èƒ½ç®¡ç†å‰ä¸¤å¤©ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¤„ç†æ‰€æœ‰å…¶ä»–å¤©ï¼š
- en: '[PRE23]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'If you add this to your twelve_days.py program, you can run `pytest` `twelve_days.py`
    to see how your `verse()` function is failing:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ å°†æ­¤æ·»åŠ åˆ°ä½ çš„ twelve_days.py ç¨‹åºä¸­ï¼Œä½ å¯ä»¥è¿è¡Œ `pytest` `twelve_days.py` æ¥æŸ¥çœ‹ä½ çš„ `verse()`
    å‡½æ•°æ˜¯å¦‚ä½•å¤±è´¥çš„ï¼š
- en: '[PRE24]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: â‘  The leading > shows that this is the code that is creating an exception. We
    are running verse(1) and asking if itâ€™s equal to the expected verse.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: â‘  å‰å¯¼ > è¡¨ç¤ºè¿™æ˜¯åˆ›å»ºå¼‚å¸¸çš„ä»£ç ã€‚æˆ‘ä»¬æ­£åœ¨è¿è¡Œ verse(1) å¹¶æ£€æŸ¥å®ƒæ˜¯å¦ç­‰äºé¢„æœŸçš„è¯—ã€‚
- en: â‘¡ This is the text that verse(1) actually produced, which is only the first
    line of the verse.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: â‘¡ è¿™å®é™…ä¸Šæ˜¯ verse(1) ç”Ÿæˆçš„æ–‡æœ¬ï¼Œå®ƒåªæ˜¯è¯—çš„ç¬¬ä¸€è¡Œã€‚
- en: â‘¢ The lines following are what was expected.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: â‘¢ ä¸‹é¢çš„è¡Œæ˜¯é¢„æœŸçš„å†…å®¹ã€‚
- en: 'Now we need to supply the rest of the lines for each verse. They all start
    off the same:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬éœ€è¦ä¸ºæ¯é¦–è¯—æä¾›å…¶ä½™çš„è¡Œã€‚å®ƒä»¬éƒ½å¼€å§‹äºç›¸åŒçš„å†…å®¹ï¼š
- en: '[PRE25]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '| Then we need to add these gifts for each day:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: '| ç„¶åæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€å¤©æ·»åŠ è¿™äº›ç¤¼ç‰©ï¼š'
- en: A partridge in a pear tree
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸€åªæ¾é¸¡ç«™åœ¨æ¢¨æ ‘ä¸Š
- en: Two turtle doves
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸¤å¯¹ turtle doves
- en: Three French hens
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸‰åªæ³•å›½å…¬é¸¡
- en: Four calling birds
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å››åªæŠ¥å–œé¸Ÿ
- en: Five gold rings
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: äº”ä¸ªé‡‘æˆ’æŒ‡
- en: Six geese a laying
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å…­åªé¹…åœ¨äº§è›‹
- en: Seven swans a swimming
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸ƒåªå¤©é¹…åœ¨æ¸¸æ³³
- en: Eight maids a milking
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å…«ä¸ªå¥³ä»†åœ¨æŒ¤å¥¶
- en: Nine ladies dancing
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¹ä¸ªå¥³å£«åœ¨è·³èˆ
- en: Ten lords a leaping
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åä¸ªè´µæ—åœ¨è·³è·ƒ
- en: Eleven pipers piping
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åä¸€ä¸ªå¹ç¬›æ‰‹å¹ç¬›
- en: Twelve drummers drumming
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: åäºŒä¸ªé¼“æ‰‹åœ¨æ•²é¼“
- en: '| ![](../Images/13-unnumb-2.png)  |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/13-unnumb-2.png)  |'
- en: Note that for every day greater than 1, the last line changes â€œ*A* partridge...â€
    to â€œ*And a* partridge in a pear tree.â€
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œå¯¹äºå¤§äº 1 çš„æ¯ä¸€å¤©ï¼Œæœ€åä¸€è¡Œå°†â€œ*A* partridge...â€æ”¹ä¸ºâ€œ*And a* partridge in a pear treeã€‚â€
- en: Each verse needs to count backwards from the given `day`. For example, if the
    `day` is 3, then the verse lists
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯é¦–è¯—éƒ½éœ€è¦ä»ç»™å®šçš„ `day` å¼€å§‹å€’æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ `day` æ˜¯ 3ï¼Œé‚£ä¹ˆè¯—åˆ—å‡ºäº†
- en: Three French hens
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸‰åªæ³•å›½å…¬é¸¡
- en: Two turtle doves
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä¸¤å¯¹ turtle doves
- en: And a partridge in a pear tree
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä»¥åŠä¸€åªæ¾é¸¡ç«™åœ¨æ¢¨æ ‘ä¸Š
- en: 'We talked in chapter 3 about how you can reverse a `list`, either with the
    `list.reverse()` method or the `reversed()` function. We also used these ideas
    in chapter 11 to get the bottles of beer off the wall, so this code should not
    be unfamiliar:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åœ¨ç¬¬ 3 ç« ä¸­è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨ `list.reverse()` æ–¹æ³•æˆ– `reversed()` å‡½æ•°æ¥åè½¬ `list`ã€‚æˆ‘ä»¬ä¹Ÿåœ¨ç¬¬ 11 ç« ä¸­ä½¿ç”¨äº†è¿™äº›æƒ³æ³•æ¥ä»å¢™ä¸Šæ‹¿èµ°å•¤é…’ç“¶ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¸åº”è¯¥è®©ä½ æ„Ÿåˆ°é™Œç”Ÿï¼š
- en: '[PRE26]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Try to make the function return the first two lines and then the countdown
    of the days:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: å°è¯•è®©å‡½æ•°è¿”å›å‰ä¸¤è¡Œï¼Œç„¶åæ˜¯å€’è®¡æ—¶å¤©æ•°ï¼š
- en: '[PRE27]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Then, instead of `3` `2` `1`, add the actual gifts:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œè€Œä¸æ˜¯ `3` `2` `1`ï¼Œæ·»åŠ å®é™…çš„ç¤¼ç‰©ï¼š
- en: '[PRE28]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: If you can get that to work, you ought to be able to pass the `test_verse()`
    test.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ èƒ½è®©å®ƒå·¥ä½œï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡ `test_verse()` æµ‹è¯•ã€‚
- en: 13.1.4 Using the verse() function
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.4 ä½¿ç”¨ verse() å‡½æ•°
- en: 'Once you have that working, think about a final structure that calls your `verse()`.
    It could be a `for` loop:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦å®ƒå·¥ä½œæ­£å¸¸ï¼Œè€ƒè™‘ä¸€ä¸ªè°ƒç”¨ä½ çš„ `verse()` çš„æœ€ç»ˆç»“æ„ã€‚å®ƒå¯èƒ½æ˜¯ä¸€ä¸ª `for` å¾ªç¯ï¼š
- en: '|'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: '[PRE29]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Since weâ€™re trying to create a `list` of the verses, a list comprehension is
    a better choice:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºæˆ‘ä»¬è¯•å›¾åˆ›å»ºä¸€ä¸ªåŒ…å«è¯—çš„ `list`ï¼Œåˆ—è¡¨æ¨å¯¼å¼æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼š
- en: '[PRE30]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Or it could be a `map()`:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è€…å®ƒå¯èƒ½æ˜¯ä¸€ä¸ª `map()`ï¼š
- en: '[PRE31]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '| ![](../Images/13-unnumb-3.png)  |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/13-unnumb-3.png)  |'
- en: 13.1.5 Printing
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.5 æ‰“å°
- en: Once you have all the verses, you can use the `str.join()` method to print the
    output. The default is to print this to â€œstandard outâ€ (`STDOUT`), but the program
    will also take an optional `--outfile` that names a file to write the output to.
    You can copy exactly what we did in chapter 5, but itâ€™s really worth your time
    to learn how to declare output files using `type=argparse.FileType('wt')`. You
    can even set the default to `sys.stdout` so that youâ€™ll never have to `open()`
    the output file yourself!
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦ä½ æœ‰äº†æ‰€æœ‰è¿™äº›è¯—ï¼Œä½ å¯ä»¥ä½¿ç”¨ `str.join()` æ–¹æ³•æ¥æ‰“å°è¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šæ‰“å°åˆ°â€œæ ‡å‡†è¾“å‡ºâ€ï¼ˆ`STDOUT`ï¼‰ï¼Œä½†ç¨‹åºè¿˜ä¼šæ¥å—ä¸€ä¸ªå¯é€‰çš„
    `--outfile`ï¼ŒæŒ‡å®šä¸€ä¸ªæ–‡ä»¶æ¥å†™å…¥è¾“å‡ºã€‚ä½ å¯ä»¥å¤åˆ¶æˆ‘ä»¬åœ¨ç¬¬ 5 ç« ä¸­åšçš„ï¼Œä½†çœŸæ­£å€¼å¾—ä½ èŠ±æ—¶é—´å»å­¦ä¹ å¦‚ä½•ä½¿ç”¨ `type=argparse.FileType('wt')`
    å£°æ˜è¾“å‡ºæ–‡ä»¶ã€‚ä½ ç”šè‡³å¯ä»¥å°†é»˜è®¤å€¼è®¾ç½®ä¸º `sys.stdout`ï¼Œè¿™æ ·ä½ æ°¸è¿œä¸éœ€è¦è‡ªå·± `open()` è¾“å‡ºæ–‡ä»¶ï¼
- en: 13.1.6 Time to write
  id: totrans-118
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.6 å†™ä½œæ—¶é—´
- en: Itâ€™s not at all mandatory that you solve the problem the way that I describe.
    The â€œcorrectâ€ solution is one that you write and understand and that passes the
    test suite. Itâ€™s fine if you like the idea of creating a function for `verse()`
    and using the provided test. Itâ€™s also fine if you want to go another way, but
    do try to think of writing small functions *and tests* to solve small parts of
    your problem, and then combining them to solve the larger problem.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶éä¸€å®šè¦æŒ‰ç…§æˆ‘æè¿°çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½ è‡ªå·±ç¼–å†™å¹¶ç†è§£ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡æµ‹è¯•å¥—ä»¶çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æœä½ å–œæ¬¢ä¸º `verse()` åˆ›å»ºä¸€ä¸ªå‡½æ•°å¹¶ä½¿ç”¨æä¾›çš„æµ‹è¯•ï¼Œé‚£ä¹Ÿå¾ˆå¥½ã€‚å¦‚æœä½ æƒ³èµ°å¦ä¸€æ¡è·¯ï¼Œé‚£ä¹Ÿå¾ˆå¥½ï¼Œä½†è¯·å°½é‡è€ƒè™‘ç¼–å†™å°çš„å‡½æ•°
    *å’Œæµ‹è¯•* æ¥è§£å†³é—®é¢˜çš„å„ä¸ªå°éƒ¨åˆ†ï¼Œç„¶åå°†å®ƒä»¬ç»„åˆèµ·æ¥è§£å†³æ›´å¤§çš„é—®é¢˜ã€‚
- en: If you need more than one sitting or even several days to pass the tests, take
    your time. Sometimes a good walk or a nap can do wonders for solving problems.
    Donâ€™t neglect your hammock[1](#pgfId-1015005) or a nice cup of tea.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ éœ€è¦å¤šæ¬¡æˆ–å‡ å¤©æ—¶é—´æ¥é€šè¿‡æµ‹è¯•ï¼Œè¯·æ…¢æ…¢æ¥ã€‚æœ‰æ—¶å€™ï¼Œä¸€æ¬¡æ„‰å¿«çš„æ•£æ­¥æˆ–å°æ†©èƒ½å¯¹è§£å†³é—®é¢˜å¤§æœ‰è£¨ç›Šã€‚ä¸è¦å¿½è§†ä½ çš„åŠåºŠ[1](#pgfId-1015005)
    æˆ–ä¸€æ¯å¥½èŒ¶ã€‚
- en: 13.2 Solution
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.2 è§£å†³æ–¹æ¡ˆ
- en: A person would receive almost 200 birds in this song! Anyway, here is a solution
    that uses `map()`. After that youâ€™ll see versions that use `for` and list comprehensions.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é¦–æ­Œä¸­ï¼Œä¸€ä¸ªäººå‡ ä¹ä¼šæ”¶åˆ°200åªé¸Ÿï¼æ— è®ºå¦‚ä½•ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨ `map()` çš„è§£å†³æ–¹æ¡ˆã€‚ä¹‹åï¼Œä½ å°†çœ‹åˆ°ä½¿ç”¨ `for` å¾ªç¯å’Œåˆ—è¡¨æ¨å¯¼å¼çš„ç‰ˆæœ¬ã€‚
- en: '[PRE32]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: â‘  The --num option is an int with a default of 12.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: é€‰é¡¹ `--num` æ˜¯ä¸€ä¸ªé»˜è®¤å€¼ä¸º 12 çš„æ•´æ•°ã€‚
- en: â‘¡ The --outfile option is a type=argparse.FileType('wt') with a default of sys.stdout.
    If the user supplies a value, it must be the name of a writable file, in which
    case argparse will open the file for writing.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: é€‰é¡¹ `--outfile` æ˜¯ä¸€ä¸ªé»˜è®¤ä¸º `sys.stdout` çš„ `type=argparse.FileType('wt')`ã€‚å¦‚æœç”¨æˆ·æä¾›äº†å€¼ï¼Œå®ƒå¿…é¡»æ˜¯å¯å†™æ–‡ä»¶çš„åç§°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œargparse
    å°†ä¸ºå†™å…¥æ‰“å¼€æ–‡ä»¶ã€‚
- en: â‘¢ Capture the results of parsing the command-line arguments into the args variable.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: å°†è§£æå‘½ä»¤è¡Œå‚æ•°çš„ç»“æœæ•è·åˆ° `args` å˜é‡ä¸­ã€‚
- en: â‘£ Check that the given args.num is in the allowed range1-12, inclusive.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥ç»™å®šçš„ `args.num` æ˜¯å¦åœ¨å…è®¸çš„èŒƒå›´å†…1-12ï¼ŒåŒ…æ‹¬1å’Œ12ã€‚
- en: â‘¤ If args.num is invalid, use parser.error() to print a short usage statement
    and the error message to STDERR and exit the program with an error value. Note
    that the error message includes the bad value for the user and explicitly states
    that a good value should be in the range 1-12.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœ `args.num` æ— æ•ˆï¼Œä½¿ç”¨ `parser.error()` æ‰“å°ç®€çŸ­çš„ç”¨æ³•è¯´æ˜å’Œé”™è¯¯ä¿¡æ¯åˆ°æ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œå¹¶ä»¥é”™è¯¯å€¼é€€å‡ºç¨‹åºã€‚æ³¨æ„ï¼Œé”™è¯¯ä¿¡æ¯åŒ…æ‹¬ç”¨æˆ·çš„ä¸è‰¯å€¼ï¼Œå¹¶æ˜ç¡®æŒ‡å‡ºè‰¯å¥½çš„å€¼åº”åœ¨
    1-12 çš„èŒƒå›´å†…ã€‚
- en: â‘¥ Get the command-line arguments. Remember that all argument validation happens
    inside get_args(). If this call succeeds, we have good arguments from the user.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: è·å–å‘½ä»¤è¡Œå‚æ•°ã€‚è®°ä½ï¼Œæ‰€æœ‰å‚æ•°éªŒè¯éƒ½åœ¨ `get_args()` å†…éƒ¨è¿›è¡Œã€‚å¦‚æœè¿™ä¸ªè°ƒç”¨æˆåŠŸï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ç”¨æˆ·æä¾›çš„è‰¯å¥½å‚æ•°ã€‚
- en: â‘¦ Generate the verses for the given args.num of days.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºç»™å®šçš„ `args.num` å¤©ç”Ÿæˆè¯—å¥ã€‚
- en: â‘§ Join the verses on two newlines and print to args.outfile, which is an open
    file handle, or sys.stdout.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: å°†è¯—å¥é€šè¿‡ä¸¤ä¸ªæ¢è¡Œç¬¦è¿æ¥å¹¶æ‰“å°åˆ° `args.outfile`ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶å¥æŸ„ï¼Œæˆ–è€… `sys.stdout`ã€‚
- en: â‘¨ Define a function to create any one verse from a given number.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œä»ç»™å®šçš„æ•°å­—åˆ›å»ºä»»ä½•ä¸€é¦–è¯—å¥ã€‚
- en: â‘© The ordinal values is a list of str values.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: åºæ•°å€¼æ˜¯ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²å€¼çš„åˆ—è¡¨ã€‚
- en: â‘ª The gifts for the days is a list of str values.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: å¤©çš„ç¤¼ç‰©æ˜¯ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²å€¼çš„åˆ—è¡¨ã€‚
- en: â‘« The lines of each verse start off the same, substituting in the ordinal value
    of the given day.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯é¦–è¯—å¥çš„è¡Œéƒ½æ˜¯ä»¥ç›¸åŒçš„æ–¹å¼å¼€å§‹çš„ï¼Œç”¨ç»™å®šæ—¥æœŸçš„åºæ•°å€¼æ›¿æ¢ã€‚
- en: â‘¬ Use the list.extend() method to add the gifts, which are a slice from the
    given day and then reversed().
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ `list.extend()` æ–¹æ³•æ·»åŠ ç¤¼ç‰©ï¼Œè¿™äº›ç¤¼ç‰©æ˜¯ä»ç»™å®šæ—¥æœŸçš„åˆ‡ç‰‡ç„¶ååè½¬å¾—åˆ°çš„ã€‚
- en: â‘­ Check if this is for a day greater than 1.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: æ£€æŸ¥è¿™æ˜¯å¦é’ˆå¯¹å¤§äº 1 çš„æ—¥å­ã€‚
- en: â‘® Change the last of the lines to add â€œAnd â€ to the beginning, appended to the
    lowercased version of the line.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: å°†æœ€åä¸€è¡Œæ”¹ä¸ºåœ¨å¼€å¤´æ·»åŠ â€œå¹¶ä¸”â€ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°è¯¥è¡Œçš„å°å†™ç‰ˆæœ¬ã€‚
- en: â‘¯ Return the lines joined on the newline.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: è¿”å›é€šè¿‡æ¢è¡Œç¬¦è¿æ¥çš„è¡Œã€‚
- en: â‘° The unit test for the verse() function
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹ `verse()` å‡½æ•°è¿›è¡Œå•å…ƒæµ‹è¯•ã€‚
- en: 13.3 Discussion
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.3 è®¨è®º
- en: Not much in `get_args()` is new, so weâ€™ll throw it a sidelong, cursory glance.
    The `--num` option is an `int` value with a default value of `12`, and we use
    `parser.error()` to halt the program if the user provides a bad value. The `--outfile`
    option is a bit different, though, as weâ€™re declaring it with `type=argparse.FileType('wt')`
    to indicate the value must be a writable file. This means the value we get from
    `argparse` will be an open, writable file. We set the default to `sys.stdout`,
    which is also an open, writable file, so weâ€™ve handled the two output options
    entirely through `argparse`, which is a real time saver!
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨`get_args()`ä¸­æ²¡æœ‰ä»€ä¹ˆæ–°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªæ˜¯åŒ†åŒ†ä¸€ç¥ã€‚`--num`é€‰é¡¹æ˜¯ä¸€ä¸ªé»˜è®¤å€¼ä¸º`12`çš„`int`å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨`parser.error()`æ¥é˜»æ­¢ç¨‹åºï¼Œå¦‚æœç”¨æˆ·æä¾›äº†ä¸è‰¯å€¼ã€‚`--outfile`é€‰é¡¹ç•¥æœ‰ä¸åŒï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨`type=argparse.FileType('wt')`æ¥å£°æ˜å®ƒï¼Œè¡¨ç¤ºå€¼å¿…é¡»æ˜¯å¯ä»¥å†™å…¥çš„æ–‡ä»¶ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä»`argparse`å¾—åˆ°çš„ä»·å€¼å°†æ˜¯ä¸€ä¸ªæ‰“å¼€çš„ã€å¯å†™å…¥çš„æ–‡ä»¶ã€‚æˆ‘ä»¬å°†é»˜è®¤å€¼è®¾ç½®ä¸º`sys.stdout`ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªæ‰“å¼€çš„ã€å¯å†™å…¥çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨é€šè¿‡`argparse`å¤„ç†äº†ä¸¤ä¸ªè¾“å‡ºé€‰é¡¹ï¼Œè¿™çœŸæ˜¯ä¸€ä¸ªèŠ‚çœæ—¶é—´çš„æ–¹æ³•ï¼
- en: 13.3.1 Making one verse
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.1 åˆ¶ä½œä¸€è¡Œè¯—
- en: 'I chose to make a function called `verse()` to create any one verse given an
    `int` value of the `day`:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘é€‰æ‹©åˆ›å»ºä¸€ä¸ªåä¸º`verse()`çš„å‡½æ•°ï¼Œç”¨äºæ ¹æ®ç»™å®šæ—¥æœŸçš„`int`å€¼åˆ›å»ºä»»ä½•ä¸€è¡Œï¼š
- en: '[PRE33]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'I decided to use a `list` to represent the `ordinal` value of the `day`:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å†³å®šä½¿ç”¨`list`æ¥è¡¨ç¤ºâ€œæ—¥æœŸâ€çš„åºæ•°å€¼ï¼š
- en: '[PRE34]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Since the `day` is based on counting from 1, but Python lists start from 0
    (see figure 13.2), I have to subtract 1:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºâ€œæ—¥æœŸâ€æ˜¯åŸºäºä»1å¼€å§‹è®¡æ•°ï¼Œä½†Pythonåˆ—è¡¨ä»0å¼€å§‹ï¼ˆè§å›¾13.2ï¼‰ï¼Œæˆ‘å¿…é¡»å‡å»1ï¼š
- en: '[PRE35]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '![](../Images/13-2.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/13-2.png)'
- en: Figure 13.2 Our days start counting from 1, but Python indexes from 0.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾13.2 æˆ‘ä»¬ä»1å¼€å§‹è®¡æ•°ï¼Œä½†Pythonç´¢å¼•ä»0å¼€å§‹ã€‚
- en: 'I could just as easily have used a `dict`:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘åŒæ ·å¯ä»¥ä½¿ç”¨ä¸€ä¸ª`dict`ï¼š
- en: '[PRE36]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'In this case you donâ€™t have to subtract 1\. Whatever works for you:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ ä¸éœ€è¦å‡å»1ã€‚å¯¹ä½ æ¥è¯´ä»€ä¹ˆæœ‰æ•ˆï¼š
- en: '[PRE37]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'I also used a `list` for the `gifts`:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘è¿˜ä½¿ç”¨äº†`list`æ¥è¡¨ç¤ºâ€œç¤¼ç‰©â€ï¼š
- en: '[PRE38]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'This makes a bit more sense, as I can use a list slice to get the `gifts` for
    a given `day` (see figure 13.3):'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ ·ç¨å¾®æœ‰ç‚¹é“ç†ï¼Œå› ä¸ºæˆ‘å¯ä»¥ä½¿ç”¨åˆ—è¡¨åˆ‡ç‰‡æ¥è·å–ç»™å®šæ—¥æœŸçš„â€œç¤¼ç‰©â€ï¼ˆè§å›¾13.3ï¼‰ï¼š
- en: '[PRE39]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: '![](../Images/13-3.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/13-3.png)'
- en: Figure 13.3 The gifts are listed by their days in ascending order.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾13.3 ç¤¼ç‰©æŒ‰æ—¥æœŸçš„å‡åºåˆ—å‡ºã€‚
- en: 'But I want them in reverse order. The `reversed()` function is lazy, so I need
    to use the `list()` function in the REPL to coerce the values:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æˆ‘å¸Œæœ›å®ƒä»¬æ˜¯å€’åºçš„ã€‚`reversed()`å‡½æ•°æ˜¯æ‡’æƒ°çš„ï¼Œæ‰€ä»¥æˆ‘éœ€è¦åœ¨REPLä¸­ä½¿ç”¨`list()`å‡½æ•°æ¥å¼ºåˆ¶è½¬æ¢å€¼ï¼š
- en: '[PRE40]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The first two lines of any verse are the same, substituting in the `ordinal`
    value for the `day`:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: ä»»ä½•è¯—çš„å‰ä¸¤è¡Œéƒ½æ˜¯ç›¸åŒçš„ï¼Œç”¨â€œæ—¥æœŸâ€çš„åºæ•°å€¼æ›¿æ¢ï¼š
- en: '[PRE41]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: I need to put these two `lines` together with the `gifts`. Since each verse
    is made of some number of lines, I think it will make sense to use a `list` to
    represent the entire verse.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘éœ€è¦å°†è¿™äº›ä¸¤è¡Œä¸â€œç¤¼ç‰©â€ç»„åˆèµ·æ¥ã€‚ç”±äºæ¯è¡Œè¯—ç”±ä¸€å®šæ•°é‡çš„è¡Œç»„æˆï¼Œæˆ‘è®¤ä¸ºä½¿ç”¨`list`æ¥è¡¨ç¤ºæ•´ä¸ªè¯—æ˜¯æœ‰æ„ä¹‰çš„ã€‚
- en: 'I need to add the `gifts` to the `lines`, and I can use the `list.extend()`
    method to do that:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘éœ€è¦å°†â€œç¤¼ç‰©â€æ·»åŠ åˆ°â€œè¡Œâ€ä¸­ï¼Œå¹¶ä¸”æˆ‘å¯ä»¥ä½¿ç”¨`list.extend()`æ–¹æ³•æ¥å®Œæˆï¼š
- en: '[PRE42]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Now there are five `lines`:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æœ‰äº”è¡Œäº†ï¼š
- en: '[PRE43]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Note that I cannot use the `list.append()` method. Itâ€™s easy to confuse it with
    the `list.extend()` method, which takes another `list` as its argument, expands
    it, and adds all of the individual elements to the original `list`. The `list.append()`
    method is meant to add *just one* element to a `list`, so if you give it a `list`,
    it will tack that entire `list` onto the end of the original list!
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œæˆ‘ä¸èƒ½ä½¿ç”¨`list.append()`æ–¹æ³•ã€‚å¾ˆå®¹æ˜“å°†å®ƒä¸`list.extend()`æ–¹æ³•æ··æ·†ï¼Œåè€…æ¥å—å¦ä¸€ä¸ª`list`ä½œä¸ºå…¶å‚æ•°ï¼Œå°†å…¶å±•å¼€ï¼Œå¹¶å°†æ‰€æœ‰å•ä¸ªå…ƒç´ æ·»åŠ åˆ°åŸå§‹`list`ä¸­ã€‚`list.append()`æ–¹æ³•æ—¨åœ¨å‘`list`æ·»åŠ â€œä»…ä¸€ä¸ªâ€å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœä½ ç»™å®ƒä¸€ä¸ª`list`ï¼Œå®ƒå°†æŠŠæ•´ä¸ª`list`é™„åŠ åˆ°åŸå§‹åˆ—è¡¨çš„æœ«å°¾ï¼
- en: 'Here the `reversed()` iterator will be added to the end of `lines`, such that
    it would have three elements rather than the desired five:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`reversed()`è¿­ä»£å™¨å°†è¢«æ·»åŠ åˆ°`lines`çš„æœ«å°¾ï¼Œè¿™æ ·å®ƒå°†æœ‰ä¸‰ä¸ªå…ƒç´ è€Œä¸æ˜¯æ‰€éœ€çš„äº”ä¸ªï¼š
- en: '[PRE44]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Maybe youâ€™re thinking you could coerce `reversed()` with the `list()` function?
    Thinking you are, young Jedi, but, alas, that will still add a new `list` to the
    end:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½è®¤ä¸ºä½ å¯ä»¥ç”¨`list()`å‡½æ•°å¼ºåˆ¶è½¬æ¢`reversed()`ï¼Ÿæƒ³ç€ä½ æ˜¯ï¼Œå¹´è½»çš„ç»åœ°æ­¦å£«ï¼Œä½†é—æ†¾çš„æ˜¯ï¼Œè¿™ä»ç„¶ä¼šåœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªæ–°çš„`list`ï¼š
- en: '[PRE45]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'And we still have three `lines` rather than five:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»ç„¶æœ‰ä¸‰è¡Œè€Œä¸æ˜¯äº”è¡Œï¼š
- en: '[PRE46]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'If `day` is greater than 1, I need to change the last line to say â€œAnd aâ€ instead
    of â€œAâ€:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœâ€œæ—¥æœŸâ€å¤§äº1ï¼Œæˆ‘éœ€è¦å°†æœ€åä¸€è¡Œæ”¹ä¸ºè¯´â€œå¹¶ä¸”ä¸€ä¸ªâ€è€Œä¸æ˜¯â€œä¸€ä¸ªâ€ï¼š
- en: '[PRE47]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: Note that this is another good reason to represent the `lines` as a `list`,
    because the elements of a `list` are *mutable*. I could have represented the `lines`
    as a `str`, but strings are *immutable*, so it would be much harder to change
    the last line.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„ï¼Œè¿™æ˜¯å°†`lines`è¡¨ç¤ºä¸º`list`çš„å¦ä¸€ä¸ªå¾ˆå¥½çš„ç†ç”±ï¼Œå› ä¸º`list`çš„å…ƒç´ æ˜¯å¯å˜çš„ã€‚æˆ‘æœ¬æ¥å¯ä»¥å°†`lines`è¡¨ç¤ºä¸ºä¸€ä¸ª`str`ï¼Œä½†å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥ä¿®æ”¹æœ€åä¸€è¡Œä¼šå›°éš¾å¾—å¤šã€‚
- en: 'I want to return a single `str` value from the function, so I join the `lines`
    on a newline:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘æƒ³ä»å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªå•ä¸€çš„`str`å€¼ï¼Œæ‰€ä»¥æˆ‘å°†åœ¨æ¢è¡Œç¬¦ä¸Šè¿æ¥`lines`ï¼š
- en: '[PRE48]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: My function returns the joined `lines` and will pass the `test_verse()` function
    I provided.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘çš„å‡½æ•°è¿”å›è¿æ¥çš„`lines`ï¼Œå¹¶å°†ä¼ é€’æˆ‘æä¾›çš„`test_verse()`å‡½æ•°ã€‚
- en: 13.3.2 Generating the verses
  id: totrans-184
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.2 ç”Ÿæˆè¯—ç¯‡
- en: 'Given the `verse()` function, I can create all the needed verses by iterating
    from 1 to the given `--num`. I could collect them in a `list` of `verses`:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®š`verse()`å‡½æ•°ï¼Œæˆ‘å¯ä»¥é€šè¿‡ä»1è¿­ä»£åˆ°ç»™å®šçš„`--num`æ¥åˆ›å»ºæ‰€æœ‰éœ€è¦çš„è¯—ç¯‡ã€‚æˆ‘å¯ä»¥åœ¨`verses`çš„`list`ä¸­æ”¶é›†å®ƒä»¬ï¼š
- en: '[PRE49]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'I can test that I have the right number of verses:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¯ä»¥æµ‹è¯•æˆ‘æ˜¯å¦æœ‰æ­£ç¡®æ•°é‡çš„è¯—ç¯‡ï¼š
- en: '[PRE50]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'Whenever you see this pattern of creating an empty `str` or `list` and then
    using a `for` loop to add to it, consider instead using a list comprehension:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: æ¯å½“ä½ çœ‹åˆ°åˆ›å»ºä¸€ä¸ªç©ºçš„`str`æˆ–`list`ç„¶åä½¿ç”¨`for`å¾ªç¯å‘å…¶ä¸­æ·»åŠ å†…å®¹çš„æ¨¡å¼æ—¶ï¼Œè€ƒè™‘æ”¹ç”¨åˆ—è¡¨æ¨å¯¼å¼ï¼š
- en: '[PRE51]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'I personally prefer using `map()` over list comprehensions. See figure 13.4
    to review how the three methods fit together. I need to use the `list()` function
    to coerce the lazy `map()` function in the REPL, but itâ€™s not necessary in the
    program code:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä¸ªäººæ›´å–œæ¬¢ä½¿ç”¨`map()`è€Œä¸æ˜¯åˆ—è¡¨æ¨å¯¼å¼ã€‚å‚è§å›¾13.4å›é¡¾ä¸‰ç§æ–¹æ³•å¦‚ä½•ç»“åˆåœ¨ä¸€èµ·ã€‚æˆ‘éœ€è¦åœ¨REPLä¸­ä½¿ç”¨`list()`å‡½æ•°æ¥å¼ºåˆ¶`map()`å‡½æ•°æ‡’æƒ°ï¼Œä½†åœ¨ç¨‹åºä»£ç ä¸­è¿™ä¸æ˜¯å¿…è¦çš„ï¼š
- en: '[PRE52]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: All of these methods will produce the correct number of verses. Choose whichever
    one makes the most sense to you.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½ä¼šäº§ç”Ÿæ­£ç¡®æ•°é‡çš„è¯—ç¯‡ã€‚é€‰æ‹©å¯¹ä½ æœ€æœ‰æ„ä¹‰çš„ä¸€ä¸ªã€‚
- en: '![](../Images/13-4.png)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/13-4.png)'
- en: Figure 13.4 Building a `list` using a `for` loop, a list comprehension, and
    `map()`.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾13.4 ä½¿ç”¨`for`å¾ªç¯ã€åˆ—è¡¨æ¨å¯¼å¼å’Œ`map()`æ„å»º`list`ã€‚
- en: 13.3.3 Printing the verses
  id: totrans-196
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.3 æ‰“å°è¯—ç¯‡
- en: 'Just like with â€œ99 Bottles of Beerâ€ in chapter 11, I want to `print()` the
    verses with two newlines in between. The `str.join()` method is a good choice:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: å°±åƒç¬¬11ç« ä¸­çš„â€œ99ç“¶å•¤é…’â€ä¸€æ ·ï¼Œæˆ‘æƒ³åœ¨è¯—ç¯‡ä¹‹é—´æ‰“å°ä¸¤ä¸ªæ¢è¡Œç¬¦ã€‚`str.join()`æ–¹æ³•æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼š
- en: '[PRE53]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'You can use the `print()` function with the optional `file` argument to put
    the text into an open file handle. The `args.outfile` value will be either the
    file indicated by the user or `sys.stdout`:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥ä½¿ç”¨å¸¦æœ‰å¯é€‰`file`å‚æ•°çš„`print()`å‡½æ•°å°†æ–‡æœ¬æ”¾å…¥ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶å¥æŸ„ä¸­ã€‚`args.outfile`çš„å€¼å°†æ˜¯ç”¨æˆ·æŒ‡å®šçš„æ–‡ä»¶æˆ–`sys.stdout`ï¼š
- en: '[PRE54]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '| Or you can use the `fh.write()` method, but you need to remember to add the
    trailing newline that `print()` adds for you:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: '| æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨`fh.write()`æ–¹æ³•ï¼Œä½†ä½ éœ€è¦è®°ä½æ·»åŠ `print()`ä¸ºä½ æ·»åŠ çš„å°¾éšæ¢è¡Œç¬¦ï¼š'
- en: '[PRE55]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: There are dozens to hundreds of ways to write this algorithm, just as there
    are for â€œ99 Bottles of Beer.â€ If you came up with an entirely different approach
    that passed the test, thatâ€™s terrific! Please share it with me. I wanted to stress
    the idea of how to write, test, and use a single `verse()` function, but Iâ€™d love
    to see other approaches! | ![](../Images/13-unnumb-4.png)  |
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: å†™è¿™ä¸ªç®—æ³•æœ‰æ•°ååˆ°æ•°ç™¾ç§æ–¹æ³•ï¼Œå°±åƒâ€œ99ç“¶å•¤é…’â€ä¸€æ ·ã€‚å¦‚æœä½ æå‡ºäº†ä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ–¹æ³•å¹¶ä¸”é€šè¿‡äº†æµ‹è¯•ï¼Œé‚£å¤ªæ£’äº†ï¼è¯·ä¸æˆ‘åˆ†äº«ã€‚æˆ‘æƒ³å¼ºè°ƒå¦‚ä½•ç¼–å†™ã€æµ‹è¯•å’Œä½¿ç”¨å•ä¸ª`verse()`å‡½æ•°çš„æƒ³æ³•ï¼Œä½†æˆ‘å¾ˆä¹æ„çœ‹åˆ°å…¶ä»–æ–¹æ³•ï¼
    | ![](../Images/13-unnumb-4.png)  |
- en: 13.4 Going further
  id: totrans-204
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.4 è¿›ä¸€æ­¥æ¢ç´¢
- en: 'Install the `emoji` module ([pypi.org/project/emoji/](https://pypi.org/project/emoji/))
    and print various emojis for the gifts rather than text. For instance, you could
    use `'':bird:''` to print ğŸ¦ for every bird, like a hen or dove. I also used `'':man:''`,
    `'':woman:''`, and `'':drum:''`, but you can use whatever you like:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: å®‰è£…`emoji`æ¨¡å—([pypi.org/project/emoji/](https://pypi.org/project/emoji/))ï¼Œå¹¶ç”¨å„ç§è¡¨æƒ…ç¬¦å·ä»£æ›¿æ–‡æœ¬æ¥æ‰“å°ç¤¼ç‰©ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨`':bird:'`æ¥æ‰“å°æ¯åªé¸Ÿï¼Œæ¯”å¦‚æ¯é¸¡æˆ–é¸½å­ã€‚æˆ‘è¿˜ä½¿ç”¨äº†`':man:'`ã€`':woman:'`å’Œ`':drum:'`ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„ï¼š
- en: '[PRE56]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Summary
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ‘˜è¦
- en: There are many ways to encode algorithms to perform repetitive tasks. In my
    version, I wrote and tested a function to handle one task and then mapped a range
    of input values over that.
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å°†ç®—æ³•ç¼–ç ä»¥æ‰§è¡Œé‡å¤æ€§ä»»åŠ¡ã€‚åœ¨æˆ‘çš„ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ç¼–å†™å¹¶æµ‹è¯•äº†ä¸€ä¸ªå¤„ç†ä¸€ä¸ªä»»åŠ¡çš„å‡½æ•°ï¼Œç„¶åæ˜ å°„äº†ä¸€ç³»åˆ—è¾“å…¥å€¼åˆ°è¯¥å‡½æ•°ä¸Šã€‚
- en: The `range()` function will return `int` values between given start and stop
    values, the latter of which is not included.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`range()`å‡½æ•°å°†è¿”å›ç»™å®šèµ·å§‹å€¼å’Œåœæ­¢å€¼ä¹‹é—´çš„`int`å€¼ï¼Œåè€…ä¸åŒ…æ‹¬åœ¨å†…ã€‚'
- en: You can use the `reversed()` function to reverse the values returned by `range()`.
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥ä½¿ç”¨`reversed()`å‡½æ•°æ¥åè½¬`range()`è¿”å›çš„å€¼ã€‚
- en: If you use `type=argparse.FileType('wt')` to define an argument with `argparse`,
    you get a file handle that is open for writing text.
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦‚æœä½ ä½¿ç”¨`type=argparse.FileType('wt')`åœ¨`argparse`ä¸­å®šä¹‰ä¸€ä¸ªå‚æ•°ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªç”¨äºå†™å…¥æ–‡æœ¬çš„æ‰“å¼€æ–‡ä»¶å¥æŸ„ã€‚
- en: The `sys.stdout` file handle is always open and available for writing.
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sys.stdout`æ–‡ä»¶å¥æŸ„å§‹ç»ˆæ‰“å¼€å¹¶å¯ç”¨äºå†™å…¥ã€‚'
- en: Modeling `gifts` as a `list` allowed me to use a list slice to get all the gifts
    for a given day. I used the `reversed()` function to put them into the right order
    for the song.
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†`gifts`å»ºæ¨¡ä¸ºä¸€ä¸ª`list`ä½¿æˆ‘èƒ½å¤Ÿä½¿ç”¨åˆ—è¡¨åˆ‡ç‰‡æ¥è·å–ç»™å®šæ—¥æœŸçš„æ‰€æœ‰ç¤¼ç‰©ã€‚æˆ‘ä½¿ç”¨äº†`reversed()`å‡½æ•°æ¥å°†å®ƒä»¬æŒ‰ç…§æ­Œæ›²çš„æ­£ç¡®é¡ºåºæ’åˆ—ã€‚
- en: I modeled `lines` as a `list` because a `list` is mutable, which I needed in
    order to change the last line when the day is greater than 1.
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘å°†`lines`å»ºæ¨¡ä¸ºä¸€ä¸ª`list`ï¼Œå› ä¸º`list`æ˜¯å¯å˜çš„ï¼Œè¿™æ˜¯æˆ‘éœ€è¦ç”¨æ¥åœ¨å¤©æ•°å¤§äº1æ—¶æ›´æ”¹æœ€åä¸€è¡Œçš„ã€‚
- en: Shadowing a variable or function is reusing an existing variable or function
    name. If, for instance, you create a variable with the name of an existing function,
    that function is effectively hidden because of the shadow. Avoid shadowing by
    using tools like Pylint to find these and many other common coding problems.
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å˜é‡æˆ–å‡½æ•°çš„é˜´å½±æ˜¯é‡ç”¨ç°æœ‰çš„å˜é‡æˆ–å‡½æ•°åç§°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰ç°æœ‰å‡½æ•°åç§°çš„å˜é‡ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°ç”±äºé˜´å½±è€Œå®é™…ä¸Šè¢«éšè—äº†ã€‚é€šè¿‡ä½¿ç”¨Pylintç­‰å·¥å…·æ¥æŸ¥æ‰¾è¿™äº›ä»¥åŠå…¶ä»–è®¸å¤šå¸¸è§çš„ç¼–ç é—®é¢˜æ¥é¿å…é˜´å½±ã€‚
- en: '* * *'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '***'
- en: 1 Search the internet for the talk â€œHammock Driven Developmentâ€ by Rich Hickey,
    the creator of the Clojure language.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨äº’è”ç½‘ä¸Šæœç´¢Rich Hickeyï¼ŒClojureè¯­è¨€åˆ›é€ è€…çš„æ¼”è®²â€œHammock Driven Developmentâ€ã€‚
