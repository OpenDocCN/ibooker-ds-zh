- en: 5 Building user interfaces with React
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 5 使用 React 构建用户界面
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: An overview of the fundamental concepts of React
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: React 基本概念的概述
- en: Getting started with React, using the Create React App CLI tool
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Create React App CLI 工具开始 React
- en: Working with state in a React application, using React Hooks
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 React 应用中使用 React Hooks 处理状态
- en: 'So far in the book, we’ve been focused on the backend aspects of our application:
    building the GraphQL API and working with the database. Now it’s time to turn
    our attention to the frontend. In chapter 1, we got a very brief overview of React
    and looked at a minimal code snippet of a React component. In this chapter, we
    return to React and begin building a React application that will be a client of
    our GraphQL API, searching for businesses and rendering results in the browser.
    Of course, it would be impossible to include everything you need to know for an
    introduction to React in a single chapter, so rather than aiming to provide a
    comprehensive introduction to React, the goal of this chapter is to explain the
    fundamental concepts of React that are necessary to get started building a simple
    application. We offer an opinionated approach to getting started, using the Create
    React App command-line tool. For more in-depth coverage of React, you may be interested
    in the documentation and tutorials found at [https://reactjs.org/](https://reactjs.org/).'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，本书我们一直专注于应用的后端方面：构建 GraphQL API 和与数据库交互。现在是我们转向前端的时候了。在第 1 章，我们简要概述了 React
    并查看了一个 React 组件的最小代码片段。在本章中，我们回到 React 并开始构建一个将成为我们 GraphQL API 客户端的 React 应用，在浏览器中搜索企业和渲染结果。当然，在一个章节中包含所有你需要了解的
    React 介绍内容是不可能的，因此，而不是试图提供一个全面的 React 介绍，本章的目标是解释构建简单应用所需的 React 基本概念。我们提供了一个使用
    Create React App 命令行工具的见解方法。对于更深入的 React 覆盖，你可能对在 [https://reactjs.org/](https://reactjs.org/)
    找到的文档和教程感兴趣。
- en: In this chapter, we will attempt to create the skeleton of our React application,
    using Create React App to handle build tooling and configuration. We’ll then update
    the template application, creating the components necessary to search for businesses
    by category and view the results. Initially, our data will just be hardcoded in
    the application; then, in chapter 6, we’ll add data-fetching logic to the React
    application, connecting the GraphQL API we created in previous chapters using
    Apollo Client (see figure 5.1). Let’s get started!
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将尝试使用 Create React App 来处理构建工具和配置，创建我们 React 应用的骨架。然后，我们将更新模板应用，创建必要的组件以按类别搜索企业并查看结果。最初，我们的数据将直接硬编码在应用中；然后在第
    6 章，我们将向 React 应用添加数据获取逻辑，使用 Apollo Client 连接我们在前几章中创建的 GraphQL API（见图 5.1）。让我们开始吧！
- en: '![CH05_F01_Lyon](../../OEBPS/Images/CH05_F01_Lyon.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![CH05_F01_Lyon](../../OEBPS/Images/CH05_F01_Lyon.png)'
- en: Figure 5.1 This chapter focuses on building the React application that will
    become a client of our GraphQL API.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.1 本章重点在于构建将成为我们 GraphQL API 客户端的 React 应用。
- en: 5.1 React overview
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5.1 React 概述
- en: React is fundamentally a JavaScript library for building user interfaces (UIs).
    React can be used to build UIs for the web (ReactDOM), native mobile applications
    (React Native), and other interfaces, such as virtual reality (React VR). React
    uses the concept of *components* to encapsulate model data and logic. Components
    can be reused and composed together to build complex UIs but provide a standard
    abstraction to help developers reason about their applications. Important React
    concepts to understand include JSX, React elements, props, state, hooks, and component
    hierarchy.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: React 基本上是一个用于构建用户界面（UI）的 JavaScript 库。React 可以用来构建网页（ReactDOM）、原生移动应用（React
    Native）和其他界面，如虚拟现实（React VR）。React 使用 *组件* 的概念来封装模型数据和逻辑。组件可以被重用并组合在一起来构建复杂的 UI，同时提供标准抽象以帮助开发者理解他们的应用。需要理解的重要
    React 概念包括 JSX、React 元素、props、state、hooks 和组件层次结构。
- en: 5.1.1 JSX and React elements
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 5.1.1 JSX 和 React 元素
- en: In React, an *element* is the most fundamental building block. Elements should
    not be confused with components; rather, components are composed of React elements.
    You can think of an element as something you might see visually displayed in the
    user interface. For example, consider the simple React element in the following
    listing.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在 React 中，*元素* 是最基本的构建块。元素不应与组件混淆；相反，组件是由 React 元素组成的。你可以将元素视为可能在用户界面中直观显示的东西。例如，考虑以下列表中的简单
    React 元素。
- en: Listing 5.1 A simple React element defined with JSX
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.1 使用JSX定义的简单React元素
- en: '[PRE0]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: At first glance, this appears to be an HTML snippet but with hints of JavaScript.
    In fact, this is a JSX example. JSX is used to create React elements.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 初看之下，这似乎是一个HTML片段，但带有JavaScript的提示。实际上，这是一个JSX示例。JSX用于创建React元素。
- en: Note JSX is not required for working with React; however, using JSX is highly
    recommended, and the alternatives will not be covered in this book.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：JSX不是与React一起工作的必需品；然而，使用JSX被高度推荐，本书不会涵盖替代方案。
- en: You can think of JSX as a combination of HTML and JavaScript. We can use JavaScript
    expressions within JSX by wrapping expressions in curly braces. For example, if
    we wanted to personalize our *Welcome to GRANDstack* greeting, we could use a
    JavaScript variable to define the name of the user.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以将JSX视为HTML和JavaScript的组合。我们可以在JSX中使用JavaScript表达式，通过将表达式包裹在花括号中来使用。例如，如果我们想个性化我们的*欢迎来到GRANDstack*问候语，我们可以使用JavaScript变量来定义用户的姓名。
- en: Listing 5.2 Using JavaScript expressions within JSX
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.2 在JSX中使用JavaScript表达式
- en: '[PRE1]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: During build time, JSX is compiled into JavaScript and uses the React.createElement()
    JavaScript function to create React elements, which are fundamentally represented
    as JavaScript objects that are rendered to the DOM.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建时，JSX被编译成JavaScript，并使用React.createElement() JavaScript函数来创建React元素，这些元素本质上表示为渲染到DOM中的JavaScript对象。
- en: React elements are important because they help React maintain what is called
    the virtual DOM—a representation of the DOM that allows React to apply DOM updates
    to the desired state. This means that rather than rerendering the entire DOM when
    the application changes, React only rerenders the pieces necessary.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: React元素很重要，因为它们帮助React维护所谓的虚拟DOM——DOM的表示，允许React将DOM更新应用于所需状态。这意味着当应用发生变化时，React只需重新渲染必要的部分，而不是重新渲染整个DOM。
- en: 5.1.2 React components
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 5.1.2 React组件
- en: React allows us to construct the UI using smaller, reusable, composable pieces
    called *components*. Components are essentially functions that accept an input
    (*props*, or properties) and return React elements that make up the UI and are
    the building blocks of a React application. Listing 5.3 shows an example.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: React允许我们使用称为*组件*的较小、可重用、可组合的片段来构建UI。组件本质上是一些函数，它们接受输入（*props*，或属性）并返回构成UI的React元素，这些元素是React应用的构建块。列表5.3展示了示例。
- en: Note We will only use functional React components. You may see references to
    so-called React class components; however, with the introduction of the React
    Hooks class, components are no longer required.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：我们只会使用功能性的React组件。你可能会看到所谓的React类组件的引用；然而，随着React Hooks类的引入，组件不再需要。
- en: Listing 5.3 A simple React component
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.3 简单的React组件
- en: '[PRE2]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Components make use of two types of model data: *props* and *state*. Props
    are immutable; if we need to change values within our component that should trigger
    a rerender, then we need to work with state data.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 组件使用两种类型的数据模型：*props*和*state*。Props是不可变的；如果我们需要更改组件内部应触发重新渲染的值，那么我们需要处理状态数据。
- en: 5.1.3 Component hierarchy
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 5.1.3 组件层次结构
- en: React components can be composed of other components. This allows us to encapsulate
    and reuse logical components as we build our UI.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: React组件可以由其他组件组成。这允许我们在构建UI时封装和重用逻辑组件。
- en: Listing 5.4 Composing React components
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.4 组合React组件
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 5.2 Create React App
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5.2 Create React App
- en: Create React App is a command-line tool for creating React applications. It
    bundles together build tooling and requires no initial configuration. It is the
    easiest way to get started with React, as it automatically configures webpack,
    Babel, ESLint, and other tools, allowing developers to start writing React applications
    without struggling to set up and configure build tooling. You can learn more about
    Create React App at [create-react-app.dev/](https://create-react-app.dev/).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: Create React App是一个用于创建React应用的命令行工具。它将构建工具捆绑在一起，无需初始配置。这是开始使用React的最简单方法，因为它会自动配置webpack、Babel、ESLint和其他工具，让开发者能够无需费力设置和配置构建工具即可开始编写React应用。你可以在[create-react-app.dev/](https://create-react-app.dev/)了解更多关于Create
    React App的信息。
- en: 5.2.1 Creating a React application with Create React App
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 5.2.1 使用Create React App创建React应用
- en: 'Let’s create a React application using Create React App. We’ll do this in the
    directory alongside api, where we’ve been building our GraphQL API. We’ll start
    by building some initial functionality for our business review application, starting
    with a business search. The initial version of our React application should allow
    the user to search for businesses by category and display business details. For
    now, we’ll hardcode our data in a JavaScript object; then, in the next chapter,
    we’ll connect the React application to our GraphQL API as a data source. To get
    started with Create React App, run the following command in the terminal at the
    directory level, alongside the API directory with our GraphQL API code:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用 Create React App 创建一个 React 应用程序。我们将在与 api 目录相邻的目录中这样做，在那里我们一直在构建我们的 GraphQL
    API。我们将首先为我们的业务审查应用程序构建一些初始功能，从业务搜索开始。我们的 React 应用程序的初始版本应该允许用户通过类别搜索业务并显示业务详情。目前，我们将硬编码数据到一个
    JavaScript 对象中；然后在下一章中，我们将连接 React 应用程序到我们的 GraphQL API 作为数据源。要开始使用 Create React
    App，请在终端中运行以下命令，在 API 目录级别，与我们的 GraphQL API 代码相邻的目录中：
- en: '[PRE4]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The command npx is included with npm as of version 5.2.0, and can be used for
    executing npm packages and commands. One great feature of npx is that it will
    automatically download the package for us if we don’t have it installed locally,
    ensuring that we always run the latest version.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 从 npm 版本 5.2.0 开始，npx 命令包含在 npm 中，可用于执行 npm 包和命令。npx 的一个出色功能是，如果我们没有本地安装该包，它将自动为我们下载该包，确保我们始终运行最新版本。
- en: 'So far, we’ve been using npm; by default, Create React App uses the yarn package
    manager CLI, so we’ll use the --use-npm command flag when calling create-react-app.
    After running this command, we should see output telling us we’ve created a new
    React project and some helpful commands we can use to get started with our project:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们一直在使用 npm；默认情况下，Create React App 使用 yarn 包管理器 CLI，因此我们在调用 create-react-app
    时将使用 --use-npm 命令标志。运行此命令后，我们应该看到输出告诉我们已创建一个新的 React 项目以及一些我们可以用来开始项目的有用命令：
- en: '[PRE5]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Let’s take a look at what Create React App has created for us:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看 Create React App 为我们创建了什么：
- en: '[PRE6]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The README.md file contains comprehensive documentation for working with the
    React application we’ve just created and Create React App. The node_modules directory
    contains all the dependencies of our application, which were installed automatically.
    Inside the public directory, we can find static content that is served from the
    root when our application is started. In the src directory, we’ll find the JavaScript
    and CSS code that defines a skeleton React application. First, let’s examine the
    package.json file in the next listing to see the dependencies included and the
    scripts that are available.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: README.md 文件包含了与我们所创建的 React 应用程序和 Create React App 一起工作的全面文档。node_modules 目录包含了我们应用程序的所有依赖项，这些依赖项是自动安装的。在
    public 目录中，我们可以找到在应用程序启动时从根目录提供的静态内容。在 src 目录中，我们将找到定义骨架 React 应用的 JavaScript
    和 CSS 代码。首先，让我们查看下一列表中的 package.json 文件，以查看包含的依赖项和可用的脚本。
- en: Listing 5.5 package.json
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.5 package.json
- en: '[PRE7]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We can see the dependencies of our application included so far: the React library
    as well as a package called react-scripts. The react-scripts package is used to
    start, run, build, and test our application, as we can see in the “scripts” section
    of the package.json file. Let’s go ahead and run our application:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到到目前为止包含在我们的应用程序中的依赖项：React 库以及一个名为 react-scripts 的包。react-scripts 包用于启动、运行、构建和测试我们的应用程序，正如我们在
    package.json 文件的“scripts”部分中看到的那样。让我们继续运行我们的应用程序：
- en: '[PRE8]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The npm start command creates a development build of the application and starts
    a local webserver serving our React application. A watcher is used, so any changes
    we make to the source files trigger a live reload of the application; this means
    we typically won’t need to restart the web server after making changes to the
    code to see our changes reflected in the application:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: npm start 命令创建应用程序的开发版本，并启动一个本地 web 服务器，该服务器提供我们的 React 应用程序。使用了一个监视器，因此我们对源文件所做的任何更改都会触发应用程序的实时重新加载；这意味着我们通常在更改代码后不需要重新启动
    web 服务器，以便在应用程序中看到我们的更改：
- en: '[PRE9]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: If running our application is successful, we see a message telling us how to
    open our application in a web browser (see figure 5.2).
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行我们的应用程序成功，我们会看到一个消息，告诉我们如何在网页浏览器中打开我们的应用程序（见图 5.2）。
- en: '![CH05_F02_Lyon](../../OEBPS/Images/CH05_F02_Lyon.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![CH05_F02_Lyon](../../OEBPS/Images/CH05_F02_Lyon.png)'
- en: Figure 5.2 Our initial React application running in the web
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.2 我们在网页中运行的初始 React 应用程序
- en: Let’s open that src/App.js file and look at our initial application in the next
    listing.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们打开那个 src/App.js 文件，并在下一条列表中查看我们的初始应用程序。
- en: 'Listing 5.6 src/App.js: Initial code'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.6 src/App.js：初始代码
- en: '[PRE10]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: We are exporting an App component, but where is it used? If we open src/ index.js,
    we can see how the App component is used (see the next listing). It is passed
    to ReactDOM.render, telling ReactDOM to render the App component in an HTML element
    with the ID of root.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在导出一个 App 组件，但它被用在何处呢？如果我们打开 src/index.js，我们可以看到 App 组件是如何被使用的（见下一条列表）。它被传递给
    ReactDOM.render，告诉 ReactDOM 在具有 ID 为 root 的 HTML 元素中渲染 App 组件。
- en: Listing 5.7 src/index.js
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.7 src/index.js
- en: '[PRE11]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Let’s update the src/App.js file in the next listing. To start off, we’ll create
    a simple form with a select dropdown to search for businesses by category.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在下一条列表中更新 src/App.js 文件。首先，我们将创建一个简单的表单，包含一个下拉选择框，用于按类别搜索业务。
- en: 'Listing 5.8 src/App.js: Adding sample data and a simple form'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.8 src/App.js：添加示例数据和简单表单
- en: '[PRE12]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: ❶ For now, our business data is defined as a JavaScript array.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 目前，我们的业务数据被定义为 JavaScript 数组。
- en: ❷ Our React component is at the top of the component hierarchy and is not passed
    any props data; therefore, it takes no arguments.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 我们的 React 组件位于组件层次结构的顶部，并且没有传递任何 props 数据；因此，它不接受任何参数。
- en: ❸ We map over our businesses array, creating a row in the table for each business.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 我们遍历我们的业务数组，为每个业务创建一个表格行。
- en: For now, we just define our businesses as a JavaScript array, but later we’ll
    need to populate our application with data from our GraphQL API. Initially, all
    results are displayed in a simple HTML table (see figure 5.3).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，我们只是将业务定义为 JavaScript 数组，但稍后我们需要用来自我们的 GraphQL API 的数据填充我们的应用程序。最初，所有结果都显示在一个简单的
    HTML 表格中（见图 5.3）。
- en: '![CH05_F03_Lyon](../../OEBPS/Images/CH05_F03_Lyon.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![CH05_F03_Lyon](../../OEBPS/Images/CH05_F03_Lyon.png)'
- en: Figure 5.3 Our React application after updating src/App.js
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.3 更新 src/App.js 后的我们的 React 应用程序
- en: We render a table, but our form doesn’t really work. We can’t select a category,
    and nothing changes in our table when we try. Let’s update our app to filter results
    based on the category we’ve selected. To do that, we need to understand state,
    and along the way, we’ll learn about props! Since we’re exclusively using functional
    React components, we’ll need to make use of React Hooks to work with state.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我们渲染了一个表格，但我们的表单实际上不起作用。我们无法选择一个类别，当我们尝试时，表格中没有任何变化。让我们更新我们的应用程序，以便根据我们选择的类别过滤结果。为此，我们需要了解状态，在这个过程中，我们还将了解
    props！由于我们只使用功能 React 组件，我们需要使用 React Hooks 来处理状态。
- en: 5.3 State and React Hooks
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5.3 状态和 React Hooks
- en: React Hooks were introduced in React version 16.8 and provide a way of working
    with state (and other React concepts) while keeping React components as functions
    instead of classes. Previously, you may have seen React class components that
    included calls to a setState function, lifecycle methods, and constructors. With
    Hooks, none of that is required; instead, we can manage state through single function
    calls.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: React Hooks 是在 React 版本 16.8 中引入的，提供了一种在保持 React 组件为函数而不是类的同时，处理状态（和其他 React
    概念）的方法。之前，你可能见过包含对 setState 函数调用、生命周期方法和构造函数的 React 类组件。有了 Hooks，这一切都不再需要；相反，我们可以通过单个函数调用来管理状态。
- en: We’ll introduce Hooks in a hands-on way, updating our React application to add
    filtering functionality to allow us to filter our result table for businesses
    by category. Along the way, we’ll see how to use the State React Hook to manage
    state within our component.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过实践的方式介绍 Hooks，更新我们的 React 应用程序以添加过滤功能，允许我们根据类别过滤业务结果表。在这个过程中，我们将看到如何使用
    State React Hooks 在组件内部管理状态。
- en: Let’s create a new React component that will be responsible for rendering our
    result table, called BusinessResults. To do that, first create a new file called
    BusinessResults.js in the same directory as App.js, as shown in the next listing.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们创建一个新的 React 组件，该组件将负责渲染我们的结果表，称为 BusinessResults。为此，首先在 App.js 相同目录下创建一个名为
    BusinessResults.js 的新文件，如下一条列表所示。
- en: Listing 5.9 src/BusinessResults.js
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.9 src/BusinessResults.js
- en: '[PRE13]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: ❶ The component is passed props data as an argument.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 组件通过参数传递 props 数据。
- en: ❷ The props argument contains the business data to be rendered in the result
    table.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ props 参数包含要在结果表中渲染的业务数据。
- en: We move the result table into this src/BusinessResults.js file, passing in the
    businesses to be rendered by the component as props. Instead of rendering all
    businesses to the table, the component renders whatever data is passed through
    the props argument. Now, in our App component, we can import this new BusinessResults
    component and pass our array of business data as props to the component, as shown
    next.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将结果表移动到这个src/BusinessResults.js文件中，通过将组件要渲染的企业作为props传入。组件不再渲染所有企业到表中，而是渲染通过props参数传递的数据。现在，在我们的App组件中，我们可以导入这个新的BusinessResults组件，并将我们的企业数据数组作为props传递给组件，如下所示。
- en: 'Listing 5.10 src/App.js: Using the BusinessResults component'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.10 src/App.js：使用BusinessResults组件
- en: '[PRE14]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: ❶ Importing the BusinessResults component
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 导入BusinessResults组件
- en: ❷ Passing the businesses array as props to the BusinessResults component
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 将企业数组作为props传递给BusinessResults组件
- en: We’ve imported a new component, BusinessResults, and we’re passing in our businesses
    array, so the BusinessResults component can take care of rendering the results.
    Our App component now just needs to concern itself with allowing the user to choose
    the category to search.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们导入了一个新的组件BusinessResults，并将我们的企业数组传递给它，因此BusinessResults组件可以负责渲染结果。我们的App组件现在只需要关注允许用户选择搜索类别。
- en: After making this change, our application looks exactly the same in the web
    browser, and our select form still doesn’t work. In the next listing, let’s make
    our dropdown actually do something!
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行此更改后，我们的应用程序在网页浏览器中的外观完全相同，我们的选择表单仍然不起作用。在下一个列表中，让我们让我们的下拉菜单真正做一些事情！
- en: 'Listing 5.11 src/App.js: Using a state variable'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.11 src/App.js：使用状态变量
- en: '[PRE15]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: ❶ Import the useState hook.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 导入useState钩子。
- en: ❷ Call the useState hook to create a new state variable and the function to
    update its value.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 调用useState钩子创建一个新的状态变量及其更新值的函数。
- en: ❸ Bind the selected value of the dropdown to our new state variable.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 将下拉菜单的选中值绑定到我们的新状态变量。
- en: ❹ Update the value of our state variable when the user selects a new option
    in the form.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 当用户在表单中选择新的选项时，更新我们的状态变量值。
- en: ❺ Filter the business results passed to the BusinessResults component based
    on the selected category.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: ❺ 根据所选类别过滤传递给BusinessResults组件的企业结果。
- en: First, we import the useState hook and use it to create a new state variable
    selectedCategory. The call to useState also returns a function (which we call
    setSelectedCategory) that is used to update the value of selectedCategory. We
    bind this variable to the selected option of the select input by passing selectedCategory
    for the value prop to the select element and using the setSelectedCategory function
    to update the value of selectedCategory when a new option is selected. Now the
    user can select a value in the form and see the result table showing only businesses
    in the selected category (see figure 5.4).
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们导入useState钩子并使用它来创建一个新的状态变量selectedCategory。useState的调用还返回一个函数（我们称之为setSelectedCategory），用于更新selectedCategory的值。我们将这个变量绑定到选择输入的选择选项上，通过将selectedCategory传递给select元素的value
    prop，并使用setSelectedCategory函数在选中新选项时更新selectedCategory的值。现在用户可以在表单中选择一个值，并看到只显示所选类别的企业结果表（见图5.4）。
- en: '![CH05_F04_Lyon](../../OEBPS/Images/CH05_F04_Lyon.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![CH05_F04_Lyon](../../OEBPS/Images/CH05_F04_Lyon.png)'
- en: Figure 5.4 Our React application after adding state and filtering functionality
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.4 添加状态和过滤功能后的我们的React应用程序
- en: Now that we have a very basic React application, our next step will be adding
    data-fetching functionality to connect to our GraphQL API. We’ll do that in the
    next chapter, using Apollo Client React Hooks, and explore more React functionality
    along the way!
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经有一个非常基础的React应用程序，我们的下一步将是添加数据获取功能以连接到我们的GraphQL API。我们将在下一章中这样做，使用Apollo
    Client React Hooks，并在过程中探索更多的React功能！
- en: 5.4 Exercises
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5.4 练习
- en: Move the search logic into a new component called BusinessSearch, and render
    that component from within the App component.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将搜索逻辑移动到一个名为BusinessSearch的新组件中，并在App组件内部渲染该组件。
- en: Allow the business search to include filtering by city in addition to the business
    category. You’ll need to add the city to the sample data and include it in the
    table results.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许企业搜索除了企业类别外还可以按城市进行过滤。您需要将城市添加到样本数据中，并将其包含在表格结果中。
- en: How would you handle searching by multiple categories? Modify the sample data
    to include multiple categories. Change form handling to allow selecting multiple
    categories. Update the filtering logic to pass the correct business search results
    to the BusinessResults component.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你会如何处理多类别搜索？修改示例数据以包含多个类别。更改表单处理以允许选择多个类别。更新过滤逻辑，以便将正确的业务搜索结果传递给 BusinessResults
    组件。
- en: Summary
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: React is a JavaScript library for creating UIs and uses the concept of components
    to encapsulate logic. Components can be composed to create complex UIs.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: React 是一个用于创建 UI 的 JavaScript 库，它使用组件的概念来封装逻辑。组件可以被组合起来创建复杂的 UI。
- en: JSX is a syntax used to create React elements and allows us to use an HTML-like
    syntax when working with UI code.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: JSX 是一种用于创建 React 元素的语法，允许我们在处理 UI 代码时使用类似 HTML 的语法。
- en: 'React components use model data in two forms: props and state. Props (or properties)
    are immutable data passed to components as part of React’s one-way data flow.
    State data is local and private to a single component and, when changed, triggers
    a rerender of the component tree.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: React 组件以两种形式使用模型数据：props 和 state。Props（或属性）是作为 React 单向数据流的一部分传递给组件的不可变数据。State
    数据是局部且私有的，属于单个组件，当其发生变化时，会触发组件树的重新渲染。
- en: Create React App is a command-line tool for creating React applications. It
    bundles together build tooling and requires no initial configuration.
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Create React App 是一个用于创建 React 应用的命令行工具。它将构建工具捆绑在一起，无需初始配置。
- en: React Hooks allow the developer to work with state within a component, while
    still keeping components as functions.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: React Hooks 允许开发者在一个组件内处理状态，同时仍然保持组件作为函数。
