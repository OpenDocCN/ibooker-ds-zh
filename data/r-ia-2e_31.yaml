- en: Appendix C. Exporting data from R
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 C. 从 R 导出数据
- en: In chapter 2, we review a wide range of methods for importing data into R. But
    sometimes, you’ll want to go the other way—exporting data from R—so data can be
    archived or imported into external applications. In this appendix, you’ll learn
    how to output an R object to a delimited text file, an Excel spreadsheet, or a
    statistical application (such as SPSS, SAS, or Stata).
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二章中，我们回顾了将数据导入 R 的多种方法。但有时，您可能想要走另一条路——从 R 导出数据——以便数据可以存档或导入到外部应用中。在本附录中，您将学习如何将
    R 对象输出到分隔文本文件、Excel 电子表格或统计应用（如 SPSS、SAS 或 Stata）。
- en: C.1 Delimited text file
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: C.1 分隔文本文件
- en: You can use the `write.table()` function to output an R object to a delimited
    text file. The format is
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 `write.table()` 函数将 R 对象输出到分隔文本文件。格式如下
- en: '[PRE0]'
  id: totrans-4
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: where `x` is the object and `outfile` is the target file. For example, the statement
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 `x` 是对象，`outfile` 是目标文件。例如，以下语句
- en: '[PRE1]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: saves the dataset `mydata` to a comma-delimited file named mydata.txt in the
    current working directory. Include a path (for example, `"c:/myprojects/mydata.txt"`)
    to save the output file elsewhere. Replacing `sep=","` with `sep="\t"` saves the
    data in a tab-delimited file. By default, strings are enclosed in quotes (`""`),
    and missing values are written as `NA`.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据集 `mydata` 保存为当前工作目录中名为 mydata.txt 的逗号分隔文件。要保存输出文件到其他位置，请包含路径（例如，`"c:/myprojects/mydata.txt"`）。将
    `sep=","` 替换为 `sep="\t"` 将数据保存为制表符分隔文件。默认情况下，字符串用引号（`""`）括起来，缺失值以 `NA` 写入。
- en: C.2 Excel spreadsheet
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: C.2 Excel 电子表格
- en: The `write.xlsx()` function in the `xlsx` package can be used to save an R data
    frame to an Excel 2007 workbook. The format is
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '`xlsx` 包中的 `write.xlsx()` 函数可用于将 R 数据框保存到 Excel 2007 工作簿。格式如下'
- en: '[PRE2]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: For example, the statements
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，以下语句
- en: '[PRE3]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: export the data frame `mydata` to a worksheet (Sheet 1 by default) in an Excel
    workbook named mydata.xlsx in the current working directory. By default, the variable
    names in the dataset are used to create column headings in the spreadsheet, and
    row names are placed in the first column of the spreadsheet. If mydata.xlsx already
    exists, it’s overwritten.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据框 `mydata` 导出为当前工作目录中名为 mydata.xlsx 的 Excel 工作簿中的工作表（默认为 Sheet 1）。默认情况下，数据集中的变量名用于创建电子表格中的列标题，行名放置在电子表格的第一列。如果
    mydata.xlsx 已经存在，则会被覆盖。
- en: The `xlsx` package is a powerful tool for manipulating Excel workbooks. See
    the package documentation for more details.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '`xlsx` 包是操作 Excel 工作簿的强大工具。有关更多详细信息，请参阅包文档。'
- en: C.3 Statistical applications
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: C.3 统计应用
- en: 'The `write.foreign()` function in the `foreign` package can be used to export
    a data frame to an external statistical application. Two files are created: a
    free-format text file containing the data and a code file containing instructions
    for reading the data into the external statistical application. The format is'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '`foreign` 包中的 `write.foreign()` 函数可用于将数据框导出到外部统计应用。创建了两个文件：一个包含数据的自由格式文本文件和一个包含将数据读入外部统计应用的指令的代码文件。格式如下'
- en: '[PRE4]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: For example, the code
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，以下代码
- en: '[PRE5]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: exports the data frame `mydata` into a free-format text file named mydata.txt
    in the current working directory and an SPSS program named mycode.sps that can
    be used to read the text file. Other values of `package` include `"SAS"` and `"Stata"`.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据框 `mydata` 导出为当前工作目录中名为 mydata.txt 的自由格式文本文件，以及一个名为 mycode.sps 的 SPSS 程序，该程序可用于读取文本文件。`package`
    的其他值包括 `"SAS"` 和 `"Stata"`。
- en: To learn more about exporting data from R, see the “R Data Import/Export” documentation,
    available from [http://cran.r-project.org/doc/manuals/R-data.pdf](http://cran.r-project.org/doc/manuals/R-data.pdf).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于从 R 导出数据的信息，请参阅“R 数据导入/导出”文档，可在 [http://cran.r-project.org/doc/manuals/R-data.pdf](http://cran.r-project.org/doc/manuals/R-data.pdf)
    获取。
