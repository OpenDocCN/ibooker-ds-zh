- en: 1 Before you begin
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1 开始之前
- en: Kubernetes is big. Really big. It was released as an open source project on
    GitHub in 2014, and now it averages 200 changes every week from a worldwide community
    of 2,500 contributors. The annual KubeCon conference has grown from 1,000 attendees
    in 2016 to more than 12,000 at the most recent event, and it’s now a global series
    with events in America, Europe, and Asia. All the major cloud services offer a
    managed Kubernetes service, and you can run Kubernetes in a data center or on
    your laptop—*and they’re all the same Kubernetes*.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes很大。真的很大。它在2014年作为GitHub上的开源项目发布，现在每周平均有来自全球2,500名贡献者的200次更改。KubeCon年度会议从2016年的1,000名参与者增长到最近活动的超过12,000名，现在已成为一个全球系列，在美国、欧洲和亚洲都有活动。所有主要的云服务都提供托管Kubernetes服务，您可以在数据中心或您的笔记本电脑上运行Kubernetes——*它们都是相同的Kubernetes*。
- en: Independence and standardization are the main reasons Kubernetes is so popular.
    Once you have your apps running nicely in Kubernetes, you can deploy them anywhere,
    which is attractive for organizations moving to the cloud, because it enables
    them to move between data centers and other clouds without a rewrite. It’s also
    very attractive for practitioners—once you’ve mastered Kubernetes, you can move
    between projects and organizations and be productive quickly.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 独立性和标准化是Kubernetes如此受欢迎的主要原因。一旦您的应用程序在Kubernetes上运行良好，您就可以在任何地方部署它们，这对正在向云迁移的组织来说很有吸引力，因为它使他们能够在数据中心和其他云之间迁移而无需重写。它对从业者来说也非常有吸引力——一旦您掌握了Kubernetes，您就可以在项目和组织之间迁移，并快速变得高效。
- en: Getting to that point is hard, though, because Kubernetes is hard. Even simple
    apps are deployed as multiple components, described in a custom file format that
    can easily span many hundreds of lines. Kubernetes brings infrastructure-level
    concerns like load balancing, networking, storage, and compute into app configuration,
    which might be new concepts, depending on your IT background. In addition, Kubernetes
    is always expanding-new releases come out every quarter, often bringing a ton
    of new functionality.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然达到这个目标很困难，因为Kubernetes本身就很复杂。即使是简单的应用程序也作为多个组件部署，这些组件以自定义的文件格式描述，很容易跨越数百行。Kubernetes将基础设施级别的关注点，如负载均衡、网络、存储和计算，纳入应用程序配置中，这取决于您的IT背景，可能是一些新概念。此外，Kubernetes始终在扩展——每个季度都会发布新版本，通常带来大量的新功能。
- en: 'But it’s worth it. I’ve spent many years helping people learn Kubernetes, and
    a common pattern arises: the question “*Why is this so complicated*?” transforms
    to “*You can do that? This is amazing!*” Kubernetes truly is an amazing piece
    of technology. The more you learn about it, the more you’ll love it—and this book
    will accelerate you on your journey to Kubernetes mastery.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 但这是值得的。我花费了许多年帮助人们学习Kubernetes，一个常见的模式出现了：问题“*为什么这么复杂*？”转变为“*你可以做到这一点？这太神奇了!*”
    Kubernetes确实是一项令人惊叹的技术。你了解得越多，你会越喜欢它——这本书将加速你通往Kubernetes精通的旅程。
- en: 1.1 Understanding Kubernetes
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.1 理解Kubernetes
- en: This book provides a hands-on introduction to Kubernetes. Every chapter offers
    try-it-now exercises and labs for you to get lots of experience using Kubernetes.
    All except this one. :) We’ll jump into the practical work in the next chapter,
    but we need a little theory first. Let’s start by understanding what Kubernetes
    actually is and the problems it solves.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书为您提供了Kubernetes的实战入门。每一章都提供了即学即用的练习和实验室，让您能够获得大量使用Kubernetes的经验。除了这一章。 :)
    我们将在下一章开始实际工作，但在此之前我们需要一点理论知识。让我们先来了解一下Kubernetes实际上是什么以及它解决的问题。
- en: Kubernetes is a platform for running containers. It takes care of starting your
    containerized applications, rolling out updates, maintaining service levels, scaling
    to meet demand, securing access, and much more. The two core concepts in Kubernetes
    are the *API*, which you use to define your applications, and the *cluster*, which
    runs your applications. A cluster is a set of individual servers that have all
    been configured with a container runtime like Docker, and then joined into a single
    logical unit with Kubernetes. Figure 1.1 shows a high-level view of the cluster.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes是一个运行容器的平台。它负责启动您的容器化应用程序、部署更新、维护服务级别、按需扩展、确保访问安全以及更多。Kubernetes的两个核心概念是*API*，您使用它来定义您的应用程序，以及*集群*，它运行您的应用程序。集群是一组配置了容器运行时（如Docker）的独立服务器，然后通过Kubernetes联合成一个单一的逻辑单元。图1.1显示了集群的高级视图。
- en: '![](../Images/1-1.jpg)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1-1.jpg)'
- en: Figure 1.1 A Kubernetes cluster is a bunch of servers, which can run containers,
    joined into a group.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.1 Kubernetes集群是一组可以运行容器的服务器，它们被联合成一个组。
- en: Cluster administrators manage the individual servers, called *nodes* in Kubernetes.
    You can add nodes to expand the capacity of the cluster, take nodes offline for
    servicing, or roll out an upgrade of Kubernetes across the cluster. In a managed
    service like Microsoft Azure Kubernetes Service (AKS) or Amazon Elastic Kubernetes
    Service (EKS), those functions are all wrapped in simple web interfaces or command
    lines. In normal usage you forget about the underlying nodes and treat the cluster
    as a single entity.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 集群管理员管理着称为 Kubernetes 中的 *节点* 的单个服务器。您可以通过添加节点来扩展集群的容量，将节点下线进行维护，或者在整个集群中推出
    Kubernetes 的升级。在像 Microsoft Azure Kubernetes 服务 (AKS) 或 Amazon Elastic Kubernetes
    服务 (EKS) 这样的托管服务中，这些功能都封装在简单的网页界面或命令行中。在正常使用中，您会忘记底层的节点，并将集群视为一个单一实体。
- en: The Kubernetes cluster is there to run your applications. You define your apps
    in YAML files and send those files to the Kubernetes API. Kubernetes looks at
    what you’re asking for in the YAML and compares it to what’s already running in
    the cluster. It makes any changes it needs to get to the desired state, which
    could be updating a configuration, removing containers, or creating new containers.
    Containers are distributed around the cluster for high availability, and they
    can all communicate over virtual networks managed by Kubernetes. Figure 1.2 shows
    the deployment process, but without the nodes because we don’t really care about
    them at this level.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes 集群的存在是为了运行您的应用程序。您在 YAML 文件中定义您的应用程序，并将这些文件发送到 Kubernetes API。Kubernetes
    会查看您在 YAML 中请求的内容，并将其与集群中已运行的内容进行比较。它会进行任何必要的更改以到达期望的状态，这可能包括更新配置、删除容器或创建新的容器。容器被分布在整个集群中以实现高可用性，并且它们都可以通过
    Kubernetes 管理的虚拟网络进行通信。图 1.2 展示了部署过程，但没有显示节点，因为我们在这个层面上并不真正关心它们。
- en: '![](../Images/1-2.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/1-2.jpg)'
- en: Figure 1.2 When you deploy apps to a Kubernetes cluster, you can usually ignore
    the actual nodes.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.2 当您将应用程序部署到 Kubernetes 集群时，通常可以忽略实际的节点。
- en: Defining the structure of the application is your job, but running and managing
    everything is down to Kubernetes. If a node in the cluster goes offline and takes
    some containers with it, Kubernetes sees that and starts replacement containers
    on other nodes. If an application container becomes unhealthy, Kubernetes can
    restart it. If a component is under stress because of a high load, Kubernetes
    can start extra copies of the component in new containers. If you put the work
    into your Docker images and Kubernetes YAML files, you’ll get a self-healing app
    that runs in the same way on any Kubernetes cluster.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 定义应用程序的结构是您的职责，但运行和管理一切则是 Kubernetes 的工作。如果一个节点在集群中下线并带走了某些容器，Kubernetes 会注意到这一点，并在其他节点上启动替换容器。如果一个应用程序容器变得不健康，Kubernetes
    可以重新启动它。如果一个组件因为高负载而处于压力之下，Kubernetes 可以在新的容器中启动该组件的额外副本。如果您在 Docker 镜像和 Kubernetes
    YAML 文件上投入了工作，您将得到一个自我修复的应用程序，该应用程序在任何 Kubernetes 集群上都能以相同的方式运行。
- en: Kubernetes manages more than just containers, which is what makes it a complete
    application platform. The cluster has a distributed database, and you can use
    that to store both configuration files for your applications and secrets like
    API keys and connection credentials. Kubernetes delivers these seamlessly to your
    containers, which lets you use the same container images in every environment
    and apply the correct configuration from the cluster. Kubernetes also provides
    storage, so your applications can maintain data outside of containers, giving
    you high availability for stateful apps. Kubernetes also manages network traffic
    coming into the cluster by sending it to the right containers for processing.
    Figure 1.3 shows those other resources, which are the main features of Kubernetes.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes 管理的不仅仅是容器，这也是它成为一个完整应用程序平台的原因。集群有一个分布式数据库，您可以使用它来存储应用程序的配置文件以及像 API
    密钥和连接凭证这样的机密信息。Kubernetes 将这些无缝地传递到您的容器中，让您可以在每个环境中使用相同的容器镜像，并从集群中应用正确的配置。Kubernetes
    还提供存储，这样您的应用程序就可以在容器之外维护数据，为有状态应用程序提供高可用性。Kubernetes 还通过将其发送到正确的容器进行处理来管理进入集群的网络流量。图
    1.3 展示了这些其他资源，它们是 Kubernetes 的主要功能。
- en: '![](../Images/1-3.jpg)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/1-3.jpg)'
- en: Figure 1.3 There’s more to Kubernetes than just containers—the cluster manages
    other resources, too.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.3 Kubernetes 不仅管理容器，集群还管理其他资源。
- en: I haven’t talked about what those applications in the containers look like;
    that’s because Kubernetes doesn’t really care. You can run a new application built
    with cloud-native design across microservices in multiple containers. You can
    run a legacy application built as a monolith in one big container. They could
    be Linux apps or Windows apps. You define all types of applications in YAML files
    using the same API, and you can run them all on a single cluster. The joy of working
    with Kubernetes is that it adds a layer of consistency on top of all your apps—old
    .NET and Java monoliths and new Node.js and Go microservices are all described,
    deployed, and managed in the same way.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我还没有谈论容器中的应用程序看起来是什么样子；这是因为 Kubernetes 实际上并不关心。你可以在多个容器中的微服务上运行使用云原生设计构建的新应用程序。你可以在一个大型容器中运行作为单体构建的遗留应用程序。它们可以是
    Linux 应用程序或 Windows 应用程序。你可以使用相同的 API 在 YAML 文件中定义所有类型的应用程序，并在单个集群上运行它们。与 Kubernetes
    一起工作的乐趣在于，它为所有应用程序添加了一层一致性——无论是旧的 .NET 和 Java 单体还是新的 Node.js 和 Go 微服务，都是以相同的方式进行描述、部署和管理的。
- en: That’s just about all the theory we need to get started with Kubernetes, but
    before we go any further, I want to put some proper names on the concepts I’ve
    been talking about. Those YAML files are properly called *application manifests*,
    because they’re a list of all the components that go into shipping the app. Those
    components are Kubernetes *resources*; they have proper names, too. Figure 1.4
    takes the concepts from figure 1.3 and applies the correct Kubernetes resource
    names.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我们需要开始学习 Kubernetes 的所有理论，但在我们继续之前，我想把我一直在谈论的概念用一些正确的名字来命名。那些 YAML 文件正确地被称为
    *应用程序清单*，因为它们是所有组成应用的组件列表。这些组件是 Kubernetes *资源*；它们也有正确的名字。图 1.4 将图 1.3 中的概念应用于正确的
    Kubernetes 资源名称。
- en: '![](../Images/1-4.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/1-4.jpg)'
- en: 'Figure 1.4 The true picture: these are the most basic Kubernetes resources
    you need to master.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.4 真实的情况：这些是你需要掌握的最基本的 Kubernetes 资源。
- en: I told you Kubernetes was hard. :) But we will cover all of these resources
    one at a time over the next few chapters, layering on the understanding. By the
    time you’ve finished chapter 6, that diagram will make complete sense, and you’ll
    have had lots of experience in defining those resources in YAML files and running
    them in your own Kubernetes cluster.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我告诉你 Kubernetes 很难。 :) 但我们将在接下来的几章中逐一介绍这些资源，逐步加深理解。在你完成第 6 章时，那张图将完全有意义，你将在定义这些资源并在自己的
    Kubernetes 集群中运行它们方面获得大量的经验。
- en: 1.2 Is this book for you?
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.2 这本书适合你吗？
- en: The goal of this book is to fast-track your Kubernetes learning to the point
    where you have confidence defining and running your own apps in Kubernetes, and
    you understand what the path to production looks like. The best way to learn Kubernetes
    is to practice, and if you follow all the examples in the chapters and work through
    the labs, then you’ll have a solid understanding of all the most important pieces
    of Kubernetes by the time you finish the book.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的目标是加速你的 Kubernetes 学习，让你在完成本书后，能够自信地定义和运行自己的应用在 Kubernetes 中，并了解生产路径的样子。学习
    Kubernetes 的最佳方式是实践，如果你遵循章节中的所有示例并完成实验室练习，那么在完成本书时，你将对 Kubernetes 的所有最重要的组成部分有一个坚实的理解。
- en: 'But Kubernetes is a huge topic, and I won’t be covering everything. The biggest
    gaps are in administration. I won’t cover cluster setup and management in any
    depth, because they vary across different infrastructures. If you’re planning
    on running Kubernetes in the cloud as your production environment, then a lot
    of those concerns are taken care of in a managed service anyway. If you want to
    get a Kubernetes certification, this book is a great place to start, but it won’t
    get you all the way. There are two main Kubernetes certifications: Certified Kubernetes
    Application Developer (CKAD) and Certified Kubernetes Administrator (CKA). This
    book covers about 80% of the CKAD curriculum and about 50% of CKA.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 但 Kubernetes 是一个庞大的主题，我不会涵盖所有内容。最大的差距在于管理。我不会深入探讨集群设置和管理，因为它们在不同的基础设施中各不相同。如果你计划在云中运行
    Kubernetes 作为你的生产环境，那么许多这些担忧在托管服务中已经得到解决。如果你想获得 Kubernetes 认证，这本书是一个很好的起点，但它不会带你走完全程。有两个主要的
    Kubernetes 认证：认证 Kubernetes 应用开发者（CKAD）和认证 Kubernetes 管理员（CKA）。本书涵盖了 CKAD 课程的大约
    80% 和 CKA 的大约 50%。
- en: There’s also a reasonable amount of background knowledge you’ll need to work
    with this book effectively. I’ll explain lots of core principles as we encounter
    them in Kubernetes features, but I won’t fill in any gaps about containers. If
    you’re not familiar with ideas like images, containers, and registries, I’d recommend
    starting with my book, *Learn Docker in a Month of Lunches* (Manning, 2020). You
    don’t need to use Docker with Kubernetes, but it is the easiest and most flexible
    way to package your apps so you can run them in containers with Kubernetes.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你还需要一定的背景知识才能有效地使用这本书。我将在遇到Kubernetes功能时解释许多核心原则，但不会填补关于容器的任何空白。如果你不熟悉像镜像、容器和注册表这样的概念，我建议从我的书《一个月午餐时间学习Docker》（Manning，2020）开始。你不需要与Kubernetes一起使用Docker，但它是最简单、最灵活的方式来打包你的应用程序，以便你可以在Kubernetes容器中运行它们。
- en: If you classify yourself as a new or improving Kubernetes user, with a reasonable
    working knowledge of containers, then this is the book for you. Your background
    could be in development, operations, architecture, DevOps, or site reliability
    engineering (SRE)—Kubernetes touches all those roles, so they’re all welcome here,
    and you are going to learn an absolute ton of stuff.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你将自己归类为新手或正在提高的Kubernetes用户，并且对容器有合理的实际操作知识，那么这本书就是为你准备的。你的背景可能是开发、运维、架构、DevOps或站点可靠性工程（SRE）——Kubernetes触及了所有这些角色，所以所有这些角色都欢迎加入，你将学到大量的东西。
- en: 1.3 Creating your lab environment
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.3 创建你的实验室环境
- en: A Kubernetes cluster can have hundreds of nodes, but for the exercises in this
    book, a single-node cluster is fine. We’ll get your lab environment set up now
    so you’re ready to get started in the next chapter. Dozens of Kubernetes platforms
    are available, and the exercises in this book should work with any certified Kubernetes
    setup. I’ll describe how to create your lab on Linux, Windows, Mac, Amazon Web
    Services (AWS), and Azure, which covers all the major options. I’m using Kubernetes
    version 1.18, but earlier or later versions should be fine, too.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 一个Kubernetes集群可以有数百个节点，但在这本书的练习中，单个节点集群就足够了。我们现在将设置你的实验室环境，以便你准备好在下一章开始。有数十种Kubernetes平台可供选择，这本书中的练习应该适用于任何认证的Kubernetes设置。我将描述如何在Linux、Windows、Mac、Amazon
    Web Services（AWS）和Azure上创建你的实验室，这涵盖了所有主要选项。我使用的是Kubernetes版本1.18，但早期或晚期的版本也应该没问题。
- en: The easiest option to run Kubernetes locally is Docker Desktop, which is a single
    package that gives you Docker and Kubernetes and all the command-line tools. It
    also integrates nicely with your computer’s network and has a handy Reset Kubernetes
    button, which clears everything, if necessary. Docker Desktop is supported on
    Windows 10 and macOS, and if that doesn’t work for you, I’ll also walk through
    some alternatives.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在本地运行Kubernetes最简单的方法是Docker Desktop，这是一个包含Docker、Kubernetes以及所有命令行工具的单个包。它还很好地集成了你的计算机网络，并有一个方便的重置Kubernetes按钮，如果需要，可以清除所有内容。Docker
    Desktop支持Windows 10和macOS，如果这对你不起作用，我还会介绍一些替代方案。
- en: 'One point you should know: the components of Kubernetes itself need to run
    as Linux containers. You can’t run Kubernetes in Windows (although you can run
    Windows apps in containers with a multinode Kubernetes cluster), so you’ll need
    a Linux virtual machine (VM) if you’re working on Windows. Docker Desktop sets
    that up and manages it for you.'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该知道的一个要点是：Kubernetes自身的组件需要以Linux容器的形式运行。你无法在Windows上运行Kubernetes（尽管你可以在多节点Kubernetes集群中运行Windows应用程序的容器），所以如果你在Windows上工作，你需要一个Linux虚拟机（VM）。Docker
    Desktop会为你设置并管理它。
- en: 'And one last note for Windows users: please use PowerShell to follow along
    with the exercises. PowerShell supports many Linux commands, and the try-it-now
    exercises are built to run on Linux (and Mac) shells and PowerShell. If you try
    to use the classic Windows command terminal, you’re going to run into issues from
    the start.'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Windows用户，请注意：请使用PowerShell来跟随练习。PowerShell支持许多Linux命令，并且“立即尝试”练习是构建在Linux（和Mac）shell以及PowerShell上运行的。如果你尝试使用经典的Windows命令行终端，你可能会从一开始就遇到问题。
- en: 1.3.1 Download the book’s source code
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.1 下载本书的源代码
- en: 'Every example and exercise is in the book’s source code repository on GitHub,
    together with sample solutions for all of the labs. If you’re comfortable with
    Git and you have a Git client installed, you can clone the repository onto your
    computer with the following command:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 每个示例和练习都在GitHub上本书的源代码仓库中，包括所有实验室的示例解决方案。如果你熟悉Git并且安装了Git客户端，你可以使用以下命令将仓库克隆到你的计算机上：
- en: '[PRE0]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: If you’re not a Git user, you can browse to the GitHub page for the book at
    [https:// github.com/sixeyed/kiamol](https://github.com/sixeyed/kiamol) and click
    the Clone or Download button to download a zip file, which you can expand.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不是Git用户，你可以浏览到这本书的GitHub页面[https://github.com/sixeyed/kiamol](https://github.com/sixeyed/kiamol)并点击克隆或下载按钮来下载一个zip文件，然后你可以展开它。
- en: 'The root of the source code is a folder called `kiamol`, and within that is
    a folder for each chapter: `ch02`, `ch03`, and so on. The first exercise in the
    chapter usually asks you to open a terminal session and switch to the `chXX` directory,
    so you’ll need to navigate to your `kiamol` folder first.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 源代码的根目录是一个名为`kiamol`的文件夹，其中包含每个章节的文件夹：`ch02`、`ch03`等等。章节中的第一个练习通常要求你打开一个终端会话并切换到`chXX`目录，所以你需要首先导航到你的`kiamol`文件夹。
- en: The GitHub repository is the quickest way for me to publish any corrections
    to the exercises, so if you do have any problems, you should check for a README
    file with updates in the chapter folder.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: GitHub仓库是我发布任何练习更正的最快方式，所以如果你有任何问题，你应该检查章节文件夹中的更新README文件。
- en: 1.3.2 Install Docker Desktop
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.2 安装Docker Desktop
- en: Docker Desktop runs on Windows 10 or macOS Sierra (version 10.12 or higher).
    Browse to [https://www.docker.com/products/docker-desktop](https://www.docker.com/products/docker-desktop)
    and choose to install the stable version. Download the installer and run it, accepting
    all the defaults. On Windows, that might include a reboot to add new Windows features.
    When Docker Desktop is running, you’ll see Docker’s whale icon near the clock
    on the Windows taskbar or the Mac menu bar. If you’re an experienced Docker Desktop
    user on Windows, you’ll need to make sure you’re in Linux container mode (which
    is the default for new installations).
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: Docker Desktop可以在Windows 10或macOS Sierra（版本10.12或更高）上运行。浏览到[https://www.docker.com/products/docker-desktop](https://www.docker.com/products/docker-desktop)并选择安装稳定版本。下载安装程序并运行它，接受所有默认设置。在Windows上，这可能包括重启以添加新的Windows功能。当Docker
    Desktop运行时，你会在Windows任务栏或Mac菜单栏附近看到Docker的海豚图标。如果你是Windows上的经验丰富的Docker Desktop用户，你需要确保你处于Linux容器模式（这是新安装的默认设置）。
- en: Kubernetes isn’t set up by default, so you’ll need to click the whale icon to
    open the menu and click Settings. That opens the window shown in figure 1.5; select
    Kubernetes from the menu and select Enable Kubernetes.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes默认没有设置，所以你需要点击海豚图标打开菜单并点击设置。这会打开图1.5所示的窗口；从菜单中选择Kubernetes并选择启用Kubernetes。
- en: '![](../Images/1-5.jpg)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1-5.jpg)'
- en: Figure 1.5 Docker Desktop creates and manages a Linux VM to run containers,
    and it can run Kubernetes.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.5 Docker Desktop创建并管理一个Linux虚拟机来运行容器，并且它可以运行Kubernetes。
- en: Docker Desktop downloads all the container images for the Kubernetes runtime—which
    might take a while—and then starts up everything. When you see two green dots
    at the bottom of the Settings screen, your Kubernetes cluster is ready to go.
    Docker Desktop installs everything else you need, so you can skip to section 1.4.7.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Docker Desktop下载Kubernetes运行时的所有容器镜像——这可能需要一段时间——然后启动一切。当你看到设置屏幕底部的两个绿色圆点时，你的Kubernetes集群就准备就绪了。Docker
    Desktop安装了你需要的所有其他东西，所以你可以跳到1.4.7节。
- en: Other Kubernetes distributions can run on top of Docker Desktop, but they don’t
    integrate well with the network setup that Docker Desktop uses, so you’ll encounter
    problems running the exercises. The Kubernetes option in Docker Desktop has all
    the features you need for this book and is definitely the easiest option.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 其他Kubernetes发行版可以在Docker Desktop之上运行，但它们与Docker Desktop使用的网络设置集成得不好，所以你会在运行练习时遇到问题。Docker
    Desktop中的Kubernetes选项具有这本书所需的所有功能，并且绝对是最佳选择。
- en: 1.3.3 Install Docker Community Edition and K3s
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.3 安装Docker社区版和K3s
- en: If you’re using a Linux machine or a Linux VM, you have several options for
    running a single-node cluster. Kind and minikube are popular, but my preference
    is K3s, which is a minimal installation but has all the features you’ll need for
    the exercises. (The name is a play on “K8s,” which is an abbreviation of Kubernetes.
    K3s trims the Kubernetes codebase, and the name indicates that it’s half the size
    of K8s.)
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你正在使用Linux机器或Linux虚拟机，运行单节点集群有多种选择。Kind和minikube很受欢迎，但我的首选是K3s，它是一个最小化安装，但包含了你进行练习所需的所有功能。（这个名字是对“K8s”的戏谑，K8s是Kubernetes的缩写。K3s精简了Kubernetes代码库，名字表明它的大小是K8s的一半。）
- en: 'K3s works with Docker, so first, you should install Docker Community Edition.
    You can check the full installation steps at [https://rancher.com/docs/k3s/latest/en/
    quick-start/](https://rancher.com/docs/k3s/latest/en/quick-start/), but this will
    get you up and running:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: K3s 与 Docker 兼容，因此首先，您应该安装 Docker Community Edition。您可以在 [https://rancher.com/docs/k3s/latest/en/quick-start/](https://rancher.com/docs/k3s/latest/en/quick-start/)
    查看完整的安装步骤，但这将帮助您启动并运行：
- en: '[PRE1]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'If you prefer to run your lab environment in a VM and you’re familiar with
    using Vagrant to manage VMs, you can use the following Vagrant setup with Docker
    and K3s found in the source repository for the book:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您更喜欢在虚拟机中运行实验室环境，并且熟悉使用 Vagrant 来管理虚拟机，您可以使用以下 Vagrant 设置，其中包含 Docker 和 K3s，这些都可以在本书的源代码库中找到：
- en: '[PRE2]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: K3s installs everything else you need, so you can skip to section 1.4.7.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: K3s 安装了您需要的所有其他内容，因此您可以跳到 1.4.7 节。
- en: 1.3.4 Install the Kubernetes command-line tool
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.4 安装 Kubernetes 命令行工具
- en: You manage Kubernetes with a tool called kubectl (which is pronounced “cube-cuttle”
    as in “cuttlefish”—don’t let anyone tell you different). It connects to a Kubernetes
    cluster and works with the Kubernetes API. Both Docker Desktop and K3s install
    kubectl for you, but if you’re using one of the other options described below,
    you’ll need to install it yourself.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用名为 kubectl 的工具（发音为“cube-cuttle”，就像“章鱼”——不要让任何人告诉您不同）来管理 Kubernetes。它连接到
    Kubernetes 集群并与 Kubernetes API 一起工作。Docker Desktop 和 K3s 都会为您安装 kubectl，但如果您正在使用以下描述的另一种选项，您需要自行安装它。
- en: 'The full installation instructions are at [https://kubernetes.io/docs/tasks/tools/
    install-kubectl/](https://kubernetes.io/docs/tasks/tools/install-kubectl/). You
    can use Homebrew on macOS and Chocolatey on Windows, and for Linux you can download
    the binary:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 完整的安装说明请参阅[https://kubernetes.io/docs/tasks/tools/install-kubectl/](https://kubernetes.io/docs/tasks/tools/install-kubectl/).
    您可以在 macOS 上使用 Homebrew，在 Windows 上使用 Chocolatey，而对于 Linux，您可以下载二进制文件：
- en: '[PRE3]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 1.3.5 Run a single-node Kubernetes cluster in Azure
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.5 在 Azure 中运行单个节点 Kubernetes 集群
- en: You can run a managed Kubernetes cluster in Microsoft Azure using AKS. This
    might be a good option if you want to access your cluster from multiple machines
    or if you have an MSDN subscription with Azure credits. You can run a minimal
    single-node cluster, which won’t cost a huge amount, but bear in mind that there’s
    no way to stop the cluster and you’ll be paying for it 24/7 until you remove it.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 AKS 在 Microsoft Azure 中运行托管 Kubernetes 集群。如果您希望从多台机器访问集群或拥有 Azure 信用额的
    MSDN 订阅，这可能是一个不错的选择。您可以运行一个最小化单节点集群，这不会花费太多，但请注意，没有停止集群的方法，您将全天候付费，直到您将其删除。
- en: 'The Azure portal has a nice user interface for creating an AKS cluster, but
    it’s much easier to use the `az` command. You can check the latest docs at [https://docs
    .microsoft.com/en-us/azure/aks/kubernetes-walkthrough](https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough),
    but you can get started by downloading the az command-line tool and running a
    few commands, as follows:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 门户提供了一个很好的用户界面来创建 AKS 集群，但使用 `az` 命令会更简单。您可以在 [https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough](https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough)
    查看最新文档，但您可以通过下载 az 命令行工具并运行几个命令来开始，如下所示：
- en: '[PRE4]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: That final command downloads the credentials to connect to the Kubernetes API
    from your local kubectl command line.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一条命令将下载凭证，以便从您的本地 kubectl 命令行连接到 Kubernetes API。
- en: 1.3.6 Run a single-node Kubernetes cluster in AWS
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.6 在 AWS 中运行单个节点 Kubernetes 集群
- en: The managed Kubernetes service in AWS is called the Elastic Kubernetes Service
    (EKS). You can create a single-node EKS cluster with the same caveat as Azure—that
    you’ll be paying for that node and associated resources all the time it’s running.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: AWS 中的托管 Kubernetes 服务被称为弹性 Kubernetes 服务 (EKS)。您可以使用与 Azure 相同的注意事项创建单个节点的
    EKS 集群——那就是您将一直为该节点及其相关资源付费，只要它在运行。
- en: 'You can use the AWS portal to create an EKS cluster, but the recommended way
    is with a dedicated tool called eksctl. The latest documentation for the tool
    is at [https:// eksctl.io](https://eksctl.io), but it’s pretty simple to use.
    First, install the latest version of the tool for your operating system as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 AWS 门户创建 EKS 集群，但推荐的方式是使用一个名为 eksctl 的专用工具。该工具的最新文档位于 [https://eksctl.io](https://eksctl.io)，但使用起来相当简单。首先，按照以下步骤安装适用于您操作系统的最新版本的工具：
- en: '[PRE5]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Assuming you already have the AWS CLI installed, eksctl will use the credentials
    from the CLI (if not, then check the installation guide for authenticating eksctl).
    Then create a simple one-node cluster as follows:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 假设您已经安装了 AWS CLI，eksctl 将使用 CLI 的凭证（如果没有，请检查 eksctl 的认证指南）。然后按照以下步骤创建一个简单的单节点集群：
- en: '[PRE6]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The tool sets up the connection from your local kubectl to the EKS cluster.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 工具设置了从您本地的 kubectl 到 EKS 集群的连接。
- en: 1.3.7 Verify your cluster
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.7 验证您的集群
- en: 'Now you have a running Kubernetes cluster, and whichever option you chose,
    they all work in the same way. Run the following command to check that your cluster
    is up and running:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您有一个正在运行的 Kubernetes 集群，无论您选择了哪个选项，它们都以相同的方式工作。运行以下命令以检查您的集群是否正在运行：
- en: '[PRE7]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You should see output like that shown in figure 1.6\. It’s a list of all the
    nodes in your cluster, with some basic details like the status and Kubernetes
    version. The details of your cluster may be different, but as long as you see
    a node listed and in the ready state, then your cluster is good to go.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该看到如图 1.6 所示的输出。这是一个包含您集群中所有节点及其一些基本详情（如状态和 Kubernetes 版本）的列表。您的集群详情可能不同，但只要您看到有节点列出并且处于就绪状态，那么您的集群就可以正常运行了。
- en: '![](../Images/1-6.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/1-6.jpg)'
- en: Figure 1.6 If you can run kubectl and your nodes are ready, then you’re all
    set to carry on.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.6 如果您可以运行 kubectl 并且您的节点已就绪，那么您就可以继续进行了。
- en: 1.4 Being immediately effective
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.4 立即有效
- en: “Immediately effective” is a core principle of the Month of Lunches series.
    In all, the focus is on learning skills and putting them into practice, in every
    chapter that follows.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: “立即有效”是《午餐月系列》的核心原则。总的来说，重点是学习技能并将它们付诸实践，在接下来的每一章中都是如此。
- en: Each chapter starts with a short introduction to the topic, followed by try-it-now
    exercises where you put the ideas into practice using your own Kubernetes cluster.
    Then there’s a recap with some more detail, to fill in some of the questions you
    may have from diving in. Last, there’s a hands-on lab for you to try by yourself,
    to really gain confidence in your new understanding.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 每一章都从一个简短的主题介绍开始，然后是“立即尝试”练习，您可以使用自己的 Kubernetes 集群将这些想法付诸实践。然后是一个总结，其中包含更多细节，以填补您在深入研究时可能有的疑问。最后，有一个供您自己尝试的动手实验室，以真正增强您对新理解的自信。
- en: All the topics center on tasks that are genuinely useful in the real world.
    You’ll learn how to be immediately effective with the topic during the chapter,
    and you’ll finish by understanding how to apply the new skill. Let’s start running
    some containerized apps!
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 所有主题都围绕在现实世界中真正有用的任务。您将在本章中学习如何立即有效地使用主题，并通过理解如何应用新技能来结束学习。让我们开始运行一些容器化应用程序吧！
