- en: 3 Segmentation analysis
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 3 分段分析
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了
- en: Loading packages with `c()` and `lapply()`
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `c()` 和 `lapply()` 加载包
- en: Visualizing means and medians with bar charts
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用条形图可视化均值和中位数
- en: Creating Sankey diagrams
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建桑基图
- en: Computing expected values
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算期望值
- en: Performing a hierarchical clustering
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行层次聚类
- en: Creating and understanding dendrograms
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建和理解树状图
- en: In the previous chapter, we introduced several methods by which we can and should
    explore a data set as a prerequisite to conducting any statistical tests or performing
    specialized analysis. No doubt, the most significant finding from our analysis
    in chapter 2 is that, by and large, players who have the most productive professional
    careers were selected high in the first round of the NBA draft, whereas players
    who have modest careers, or even worse, were usually picked later in the first
    round—at least based on the 2000 to 2009 drafts. This finding creates an obvious
    incentive for teams to somehow get to the top of the draft board.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们介绍了几种方法，通过这些方法我们可以探索数据集，作为进行任何统计测试或执行专业分析的前提。毫无疑问，第二章分析的最显著发现是，总体而言，那些职业生涯最成功的球员在NBA选秀的第一轮中被选中，而那些职业生涯平庸，甚至更差的球员通常在第一轮后被选中——至少基于2000年至2009年的选秀。这一发现为球队提供了明显的动力，希望
    somehow 能进入选秀榜的首位。
- en: Tanking is the practice of purposely losing games in one season to secure a
    higher pick in the draft prior to the next season. The NBA draft, held annually
    during the offseason, is where teams take turns selecting the best eligible players
    from the United States and abroad. Like drafts in other US professional sports,
    the NBA draft is the exact opposite of a meritocracy; it’s a worst-selects-first
    system that “awards” teams with the lowest number of wins with the opportunity
    to pick highest in the draft and therefore obtain rights to the best available
    players.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '**摆烂**是指在某个赛季故意输掉比赛，以确保在下个赛季的选秀中能获得更高的选秀顺位。NBA选秀，每年在赛季结束后举行，是各支球队轮流选择美国和海外最佳合格球员的地方。与其他美国职业体育的选秀一样，NBA选秀与精英制正好相反；它是一个“最差选先”的系统，将“奖励”给胜场数最少的球队以在选秀中优先选择的机会，从而获得选择最佳球员的权利。'
- en: Given what we discovered in the previous chapter, our hypothesis in this chapter
    is that tanking is a rational and worthwhile strategy for losing teams that want
    to become winners. We intend to explore this hypothesis by segmenting our data
    and then demonstrating different and incrementally more technical analysis techniques
    against it. Segmentation analysis is the process by which data—usually customers,
    but it could also very well be NBA first-round draft picks—is divided based on
    one or more common characteristics.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 根据上一章的发现，本章的假设是，对于想要成为赢家的输球球队来说，摆烂是一种合理且值得的策略。我们打算通过分段我们的数据，然后对它展示不同的、逐步更技术性的分析技术来探索这个假设。分段分析是根据一个或多个共同特征对数据进行划分的过程——通常客户，但这也可能是NBA首轮选秀球员的情况。
- en: Teams tank because it seems to work; superstars are an absolute requirement
    to win championships, and superstars are almost always top-five selections in
    the draft (though top-five selections are not always superstars). Therefore, teams
    must lose way more games than they win—intentionally, if that’s what it takes—to
    draft a potential superstar. But let’s see what the data says about this.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 球队选择摆烂是因为这似乎有效；超级巨星是赢得冠军的绝对要求，而超级巨星几乎总是选秀前五名的选择（尽管前五名的选择并不总是超级巨星）。因此，球队必须输掉比赢得更多的比赛——如果需要的话，故意这样做——才能在选秀中选中潜在的超级巨星。但让我们看看数据对此有何说法。
- en: 3.1 More on tanking and the draft
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.1 关于摆烂和选秀的更多内容
- en: 'For those of you who are not overly familiar with the NBA, teams fixed on acquiring
    superstar talent to win championships generally follow one of two plans of action:
    through the draft or through veteran free agency. One of the unintended, yet perpetual,
    consequences of the NBA draft is that teams often tank when their rebuilding plans
    converge around it; that is, teams intentionally lose games by trading their best
    players and promoting benchwarmers in exchange for a long-term competitive edge
    made possible by the year-over-year accumulation of draft picks, especially *high*
    draft picks.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于那些不太熟悉NBA的你们来说，专注于获取超级巨星人才以赢得冠军的球队通常遵循两种行动计划之一：通过选秀或通过老将自由市场。NBA选秀的一个无意中但持续的后果是，当球队的重建计划围绕它时，球队往往会摆烂；也就是说，球队通过交易他们的最佳球员和提升板凳球员来故意输掉比赛，以换取通过每年选秀权的累积而可能获得的长期竞争优势，尤其是*高*选秀权。
- en: In 1985, right after the Houston Rockets tanked to the top of the draft and
    selected Hakeem Olajuwon, one of the league’s all-time greats, the NBA inaugurated
    a lottery for its worst teams. (The Rockets subsequently won a pair of league
    titles.) The lottery disincentivized tanking—and preserved the integrity of play
    in the process—by randomizing the draft order and depriving teams of guaranteed
    outcomes based on wins and losses. Sort of.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 1985年，在休斯顿火箭队摆烂到选秀榜顶端并选中了联盟历史上最伟大的球员之一哈基姆·奥拉朱旺之后，NBA为最差的球队推出了一个抽签。 (火箭队随后赢得了两座联赛冠军。)
    抽签通过随机化选秀顺序和剥夺球队基于胜负的保证结果来减少摆烂——在这个过程中也保护了比赛的完整性。某种程度上。
- en: 'The NBA draft remains a kakistocracy, where the worst teams from one season
    are rewarded before the next, because tanking gives teams no less than a reasonable
    chance of securing a top pick, and success provides virtually no chance. Take
    the Philadelphia 76ers: between 2013 and 2016, nearly 30 years after the first
    lottery, the 76ers tanked their way to the near top of the draft board, winning
    a *total* of 47 regular season games in the process, but then, minus the 2019-20
    season shortened because of COVID-19, *averaging* 51 wins per season after selecting
    Joel Embiid and others. Every NBA team, by the way, plays an 82-game regular season
    schedule; so an average team would have 41 wins per season.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: NBA选秀仍然是一个坏政府，因为最差的球队在下一个赛季之前被奖励，因为摆烂给球队带来了至少是合理的获得高选秀权的可能性，而成功几乎没有任何机会。以费城76人队为例：从2013年到2016年，在第一次抽签近30年后，76人队通过摆烂接近了选秀榜的顶端，在这个过程中赢得了47场常规赛，但在选中乔尔·恩比德和其他人之后，减去因COVID-19缩短的2019-20赛季，平均每赛季赢得51场比赛。顺便说一句，每个NBA球队都有一场82场的常规赛赛程；所以一个平均球队每赛季会有41场胜利。
- en: Championships are won with superstar talent, which is only available at or near
    the very top of the draft board. Aside from a previous trade, the only way to
    guarantee access to superstar talent is to tank.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 冠军是通过超级巨星人才赢得的，而这种人才只能在选秀榜的顶端或附近才能获得。除了之前的交易，保证获得超级巨星人才的唯一方式就是摆烂。
- en: The following analysis aims to establish beyond any reasonable doubt whether
    tanking is supported by the data. For this analysis, we’ll use R’s outstanding
    graphical capabilities, extend R’s functional footprint to compute expected values,
    and even create an unsupervised learning algorithm.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 以下分析旨在排除任何合理的怀疑，确定摆烂是否得到数据的支持。为此分析，我们将使用R的出色图形功能，扩展R的功能范围以计算预期值，甚至创建一个无监督学习算法。
- en: 3.2 Loading packages
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.2 加载包
- en: The first order of business is to call the base R `library()` function to load
    packages that then make it possible to go above and beyond base R functionality;
    you aren’t using the best of R without calling the latest or greatest packages
    and functions. As a reminder, packages must be loaded whenever and wherever they
    will be used; because we have a one-to-one relationship between scripts and chapters,
    some packages are loaded multiple times. Furthermore, packages must be loaded
    before calling any of their functions, which is why it’s a good practice to load
    packages prior to writing or running other lines of code.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 第一件事是调用R的基础`library()`函数来加载包，然后才能超越基础R功能；如果不调用最新或最好的包和函数，你就不在用R的最好功能。作为提醒，包必须在使用时和地点加载；因为我们有一个脚本和章节之间的一对一关系，一些包被多次加载。此外，必须在调用任何函数之前加载包，这就是为什么在编写或运行其他代码行之前加载包是一个好习惯。
- en: 'Two of our three packages, `tidyverse` and `patchwork`, were used in chapter
    2\. (Both of these packages, and especially `tidyverse`, will be used extensively
    going forward.) The one new package we’re loading here is the `networkD3` package,
    which makes it possible to create Sankey diagrams, or flow diagrams, and other
    unique visualizations. The one Sankey diagram we’ll create is one of just two
    visualizations in this chapter that are *not* created with the `ggplot2` graphics
    package, which is part of `tidyverse`. We then sequentially load these packages
    by making three calls to the `library()` function:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二章中，我们使用了三个包中的两个，即 `tidyverse` 和 `patchwork`。（这两个包，尤其是 `tidyverse`，将在此后的工作中被广泛使用。）我们在这里加载的新包是
    `networkD3` 包，它使得创建桑基图或流程图以及其他独特的可视化成为可能。我们将创建的桑基图是本章中两个不是用 `ggplot2` 图形包（它是 `tidyverse`
    的一部分）创建的可视化之一。然后我们通过调用 `library()` 函数三次来依次加载这些包：
- en: '[PRE0]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'There is, by the way, a method of loading multiple packages at the same time
    in lieu of sequentially calling the `library()` function. The first step is to
    create a vector containing the package names as arguments; next, we create a vector
    called packages—it can, in fact, be called anything you want—by calling the base
    R `c()` function and passing `tidyverse`, `networkD3`, and `patchwork` as arguments.
    Note that each package is bounded by quotation marks:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 顺便说一句，有一种方法可以同时加载多个包，而不是依次调用 `library()` 函数。第一步是创建一个包含包名的向量作为参数；接下来，我们通过调用基础
    R 的 `c()` 函数并传递 `tidyverse`、`networkD3` 和 `patchwork` 作为参数来创建一个名为 packages 的向量——实际上，你可以将其命名为任何你想要的名称。注意，每个包都被引号包围：
- en: '[PRE1]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The second and final step is to then call the base R `lapply()` function:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 第二步和最后一步是调用基础 R 的 `lapply()` 函数：
- en: '[PRE2]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Going forward, we’ll continue to call the `library()` function, but the tandem
    of `c``()` and `lapply``()` is a good alternative if your script requires lots
    of packages. Now that we have our packages loaded, we’re free to call any and
    all required functions to perform our analysis.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，我们将继续调用 `library()` 函数，但如果你的脚本需要很多包，`c()` 和 `lapply()` 的组合是一个很好的替代方案。现在我们已经加载了包，我们可以自由地调用任何所需的函数来执行我们的分析。
- en: 3.3 Importing and viewing data
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.3 导入和查看数据
- en: 'Obviously, we need to import our data before we can do much else. We concluded
    chapter 2 by executing the following operations:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，在我们可以做其他任何事情之前，我们需要导入数据。我们通过执行以下操作结束了第二章：
- en: A tibble called draft2 was created as a replica of the draft data set. The copy
    was made *after* draft was wrangled in which, for instance, many of the original
    variables were dropped, derived variables were created, and observations with
    missing data were deleted.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建了一个名为 draft2 的 tibble，它是 draft 数据集的副本。复制操作是在 draft 被整理之后进行的，其中，例如，许多原始变量被删除，创建了派生变量，并且删除了缺失数据的观测值。
- en: A call was then made to the base R `write.csv()` function to create and save
    draft2 as a .csv file.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后调用了基础 R 的 `write.csv()` 函数来创建并保存 draft2 为 .csv 文件。
- en: 'The `readr read_csv()` function is now called to import the draft2 data set.
    Because we’re importing draft2 rather than draft, it won’t be necessary to replicate
    the data wrangling operations performed in the previous chapter:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '`readr` 的 `read_csv()` 函数现在被用来导入 draft2 数据集。因为我们导入的是 draft2 而不是 draft，所以没有必要重复执行上一章中进行的那些数据整理操作：'
- en: '[PRE3]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The `dplyr` `glimpse()` function returns a transposed, yet truncated, version
    of draft2, where the column, or variable, names run vertically, and a subset of
    the data runs horizontally. A natural next step, albeit small, after importing
    a data set is to get its dimension as well as a sneak peek at its contents; `glimpse()`
    does this very well:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: '`dplyr` 的 `glimpse()` 函数返回 draft2 的转置版本，其中列名或变量名垂直排列，数据的一个子集水平排列。在导入数据集后，一个自然且虽小但重要的下一步是获取其维度以及对其内容的预览；`glimpse()`
    做得非常好：'
- en: '[PRE4]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The base R `dim()` function returns just the dimensions of an object; that
    is, the number of rows followed by the number of columns. It’s a good alternative
    to `glimpse()`, especially if you want to pair `dim()` with the `head()` and `tail()`
    functions to get views of your data that haven’t been transposed:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 基础 R 的 `dim()` 函数仅返回对象的维度；也就是说，行数后面跟着列数。它是一个很好的 `glimpse()` 的替代品，特别是如果你想将 `dim()`
    与 `head()` 和 `tail()` 函数配对以获取未转置的数据视图：
- en: '[PRE5]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: We’ll start by creating another derived variable that wasn’t at all needed in
    chapter 2 but will, in fact, drive much of our analysis in this chapter. We’ll
    go ahead and create that next.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将首先创建另一个派生变量，这在第 2 章中根本不需要，但事实上将驱动本章的大部分分析。我们将继续创建那个变量。
- en: 3.4 Creating another derived variable
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.4 创建另一个派生变量
- en: 'Now that we’ve gotten a peek at our data, we can proceed with prepping our
    data for why we’re here: to perform segmentation analysis. In chapter 2, the `dplyr
    mutate()` function and the base R `ifelse()` function were called in tandem to
    create variables that were then appended to the draft data set (and are therefore
    included in draft2). These same functions are called in a chunk of code (see the
    following discussion), where a new variable called `Pk2` is created and populated
    with attributes that logically tie back to an original variable called `Pk`. To
    evaluate our data by segments, we first need to derive those segments because
    they don’t natively exist.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经窥视了我们的数据，我们可以继续准备我们的数据，以便进行我们在这里的原因：进行分割分析。在第 2 章中，`dplyr mutate()` 函数和基础
    R 的 `ifelse()` 函数同时被调用，以创建随后附加到选秀数据集（因此包含在 draft2 中）的变量。这些相同的函数在一段代码中被调用（见以下讨论），其中创建了一个名为
    `Pk2` 的新变量，并用与原始变量 `Pk` 逻辑上相关的属性填充。为了按分割评估我们的数据，我们首先需要推导出这些分割，因为它们本身并不存在。
- en: 'The variable `Pk` is short for *pick*; it’s a numeric variable that represents
    the pick, or first-round selection number. For example, James Harden was the third
    player chosen in the 2009 NBA draft; therefore, the variable `Pk` equals `3` where
    the variable `Player` equals `James Harden`. Because there are up to 30 first-round
    selections, `Pk` has a minimum of `1` and a maximum of `30`. Following is a breakdown
    of our segmentations—our analysis will concentrate on these six `Pk2` segments
    rather than the 30 `Pk` attributes:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 变量 `Pk` 是指 *pick*；它是一个表示选择或第一轮选择编号的数值变量。例如，詹姆斯·哈登在 2009 年 NBA 选秀中被选为第三位球员；因此，当变量
    `Player` 等于 `James Harden` 时，变量 `Pk` 等于 `3`。由于最多有 30 个首轮选择，`Pk` 的最小值为 `1`，最大值为
    `30`。以下是我们对分割的分析——我们的分析将集中在这些六个 `Pk2` 分割上，而不是 30 个 `Pk` 属性上：
- en: The derived variable `Pk2` equals `1-5` when the original variable equals any
    number between `1` and `5`. The `%in%` operator in R identifies whether an element,
    such as a number, is included in a vector or data frame. If affirmative, `Pk2`
    is assigned the value `1-5`; otherwise, the next line of code is read and executed,
    and so forth.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当原始变量等于 `1` 到 `5` 之间的任何数字时，派生的变量 `Pk2` 等于 `1-5`。R 中的 `%in%` 操作符用于确定一个元素（如数字）是否包含在向量或数据框中。如果是肯定的，则将
    `Pk2` 分配值为 `1-5`；否则，读取并执行下一行代码，依此类推。
- en: '`Pk2` equals `6-10` if `Pk` equals any number between `6` and `10`.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 `Pk` 等于 `6` 到 `10` 之间的任何数字时，`Pk2` 等于 `6-10`。
- en: '`Pk2` equals `11-15` if `Pk` equals any number between `11` and `15`.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 `Pk` 等于 `11` 到 `15` 之间的任何数字时，`Pk2` 等于 `11-15`。
- en: '`Pk2` equals `16-20` if `Pk` equals any number between `16` and `20`.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 `Pk` 等于 `16` 到 `20` 之间的任何数字时，`Pk2` 等于 `16-20`。
- en: '`Pk2` equals `21-25` if `Pk` equals any number between `21` and `25`.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 `Pk` 等于 `21` 到 `25` 之间的任何数字时，`Pk2` 等于 `21-25`。
- en: '`Pk2` equals `26-30` if `Pk` equals any number between `26` and `30`.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 `Pk` 等于 `26` 到 `30` 之间的任何数字时，`Pk2` 等于 `26-30`。
- en: If the original variable `Pk` equals anything other than a number between `1`
    and `30`, the new variable `Pk2` will equal `NA`.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果原始变量 `Pk` 不等于 `1` 到 `30` 之间的任何数字，则新变量 `Pk2` 将等于 `NA`。
- en: 'Although `Pk2` is a character string by default, it’s really a categorical
    variable. All 291 players, or first-round selections, in the draft2 data set should
    be assigned to one of these six categories, or segments, depending on where exactly
    they were selected:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然默认情况下 `Pk2` 是一个字符字符串，但它实际上是一个分类变量。选秀数据集 draft2 中的所有 291 名球员或首轮选择，应根据他们确切的选择位置分配到这六个类别或分割中的一个：
- en: '[PRE6]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'In fact, our next line of code converts `Pk2` to a factor variable by calling
    the base R `as.factor()` function. Again, this is a best practice for variables
    that can only assume a finite or fixed set of values:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我们下一行代码通过调用基础 R 的 `as.factor()` 函数将 `Pk2` 转换为因子变量。同样，这是对只能假设有限或固定值集的变量的一种最佳实践：
- en: '[PRE7]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Our subsequent analysis—we’ll start by computing basic statistics and creating
    visual representations of the data—will be entirely focused on these and other
    segments.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 我们后续的分析——我们将从计算基本统计量和创建数据的视觉表示开始——将完全集中在这些和其他分割上。
- en: 3.5 Visualizing means and medians
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.5 可视化均值和中位数
- en: 'You won’t find more basic statistical measures than means and medians. These
    measures are helpful indicators of general differences between observed data and,
    therefore, represent a logical starting point for our segmentation analysis. The
    means and medians of the continuous variables in the draft2 data set will be visualized
    in a series of bar charts broken down by the six `Pk2` segments we just created:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 你找不到比平均值和中位数更基本的统计指标了。这些指标是观察数据之间一般差异的有用指标，因此代表了我们分段分析的逻辑起点。在 draft2 数据集中，连续变量的平均值和中位数将通过一系列条形图进行可视化，这些条形图按我们刚刚创建的六个
    `Pk2` 段进行细分：
- en: Total regular season games played
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总常规赛比赛数
- en: Minutes played per regular season game
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每场常规赛的分钟数
- en: Career win shares
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业生涯胜利份额
- en: Win shares for every 48 minutes of playing time (NBA games that end in regulation
    are 48 minutes in duration)
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每 48 分钟比赛时间的胜利份额（NBA 比赛以常规时间结束，持续时间为 48 分钟）
- en: We want to see where there are variances (if any) and where there are similarities
    (if any) in these performance and productivity measures between our six `Pk2`
    segments. We’ll examine each of these variables one by one as we progress through
    the remainder of this section.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想查看在这些绩效和生产率指标中，我们的六个 `Pk2` 段之间是否存在差异（如果有的话）以及是否存在相似性（如果有的话）。随着我们进入本节的剩余部分，我们将逐一检查这些变量。
- en: Based on our chapter 2 analysis of the 2000 to 2009 NBA drafts, we ultimately
    came to the conclusion—albeit preliminarily—that players who had the most productive
    professional careers, based on win shares, were generally picked higher in the
    first round than other players. We also discovered that the `win shares` variable
    is positively and highly correlated with regular season games played, minutes
    played per regular season game, and win shares for every 48 minutes of playing
    time. Thus, there could be a statistical justification for tanking if we see clear
    separation between the `1-5` segment and the other five segments—which is exactly
    what we intend to definitively determine.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们对 2000 年至 2009 年 NBA 选秀的分析，我们最终得出结论——尽管是初步的——基于胜利份额，那些职业生涯最成功的球员通常在第一轮被选中，比其他球员更高。我们还发现，`win
    shares` 变量与常规赛比赛数、每场常规赛的分钟数以及每 48 分钟比赛时间的胜利份额高度正相关。因此，如果我们看到 `1-5` 段与其他五个段之间有明显的分离，那么这可能是摆烂的统计依据——这正是我们打算明确确定的事情。
- en: 3.5.1 Regular season games played
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.5.1 常规赛比赛数
- en: The total number of regular season games played is a fair measure of talent.
    Injuries aside, the NBA’s best and most reliable players have longer careers and
    thus appear in more regular season games than lesser players who routinely get
    turned out in favor of younger and more promising players.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 总常规赛比赛数是衡量才能的一个合理指标。除了伤病之外，NBA 最优秀和最可靠的球员职业生涯更长，因此他们在常规赛中的出场次数比那些经常被年轻和更有潜力的球员取代的球员更多。
- en: 'In the following chunk of `dplyr` code, we call the `summarize()` function
    to first compute the mean and median of regular season games played grouped by
    each factor, or segment, in variable `Pk2`. Then, using the preceding line of
    code, we instruct `summarize()` to compute the percentage of regular season games
    played for each segment of `Pk2` against the total number of games played by all
    291 players in the draft2 data set. The result is a new 6 × 4 tibble called tibble1:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的 `dplyr` 代码块中，我们调用 `summarize()` 函数，首先按变量 `Pk2` 中的每个因子或段计算常规赛比赛的均值和中位数。然后，使用前面的代码行，我们指示
    `summarize()` 计算每个 `Pk2` 段的常规赛比赛数占所有 291 名球员在 draft2 数据集中比赛总数的百分比。结果是名为 tibble1
    的新 6 × 4 tibble：
- en: '[PRE8]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'These results are visualized with a pair of `ggplot2` bar charts between the
    mean and median:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果通过一对表示平均值和中位数的 `ggplot2` 条形图进行可视化：
- en: The `stat` `=` `"identity"` argument passed to the `geom_bar()` function tells
    R to compute the sum of the y-axis variable, grouped by the x-axis variable, and
    to display the results with a rectangular bar for each `Pk2` segment. Otherwise,
    `geom_bar()` would simply return counts of occurrences for each unique attribute
    in the x-axis variable. In addition, we’re narrowing the width of the bars to
    80% of the `ggplot2` default.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将 `stat` 参数设置为 `"identity"` 并传递给 `geom_bar()` 函数，告诉 R 计算按 x 轴变量分组的 y 轴变量的总和，并以矩形条形图的形式显示每个
    `Pk2` 段的结果。否则，`geom_bar()` 将仅返回 x 轴变量中每个唯一属性的出现次数。此外，我们还将条形的宽度缩小到 `ggplot2` 默认宽度的
    80%。
- en: The `scale_x_discrete()` function is called to hardcode the sequence of `Pk2`
    segments across the x-axis, from left to right. Otherwise, `ggplot2` would place
    the `Pk2` segment `6-10` last for the very simple reason that 6 is a digit that
    comes after 1 or 2.
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调用`scale_x_discrete()`函数来在x轴上硬编码`Pk2`段的序列，从左到右。否则，`ggplot2`会将`Pk2`段`6-10`放在最后，仅仅是因为6是一个在1或2之后的数字。
- en: The `geom_text()` function is called to affix labels—truncated versions of the
    mean and median after passing those measures to the base R `trunc()` function,
    which reduces the raw results to the nearest whole number—atop the bars.
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调用`geom_text()`函数来添加标签——通过将均值和中位数传递给基础R的`trunc()`函数，这些度量被截断为最接近的整数，然后在条形上方添加截断后的均值和中位数版本。
- en: The `geom_label()` function is called to add the tibble1 variable `pct`—truncated
    and multiplied by 100—inside the bars. Because the annotations in these and other
    plots have been truncated, some of the following results might seem “off,” but
    actually, the totals and percentages have merely been rounded down to their nearest
    whole numbers.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调用`geom_label()`函数来添加`tibble1`变量`pct`——截断并乘以100——在条形内部。由于这些和其他图表的注释已被截断，以下结果可能看起来“不正确”，但实际上，总数和百分比只是四舍五入到最接近的整数。
- en: The `ylim()` function is called to extend the length of the y-axis so that it
    starts at 0 and ends at 800; this is often necessary for aesthetic reasons if
    and when the `geom_text()` or `geom_label()` functions is called to add labels
    *above* the bars.
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调用`ylim()`函数来延长y轴的长度，使其从0开始，到800结束；如果调用`geom_text()`或`geom_label()`函数在条形上方添加标签，这通常是出于美观原因。
- en: '[PRE9]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'A subsequent call to the `plot_layout()` function from the `patchwork` package
    bundles these two visualizations, `g1` and `g2`, into a single graphical object
    where the first visualization is positioned atop the second (see figure 3.1).
    If the `ncol` argument passed to `plot_layout()`instead equaled `2`, these two
    visualizations would be printed side by side instead of `g1` stacked on top of
    `g2`:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 随后调用`plot_layout()`函数从`patchwork`包将这两个可视化，`g1`和`g2`，捆绑成一个单一的图形对象，其中第一个可视化位于第二个之上（见图3.1）。如果传递给`plot_layout()`的`ncol`参数等于`2`，这两个可视化将并排打印，而不是`g1`堆叠在`g2`之上：
- en: '[PRE10]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![CH03_F01_Sutton](../../OEBPS/Images/CH03_F01_Sutton.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F01_Sutton](../../OEBPS/Images/CH03_F01_Sutton.png)'
- en: Figure 3.1 Mean and median games played by the first-round segment affixed atop
    the bars. Percentages of the total games played are represented by the white-boxed
    labels inside the bars.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.1 第一轮段均值和中位数游戏，附加在条形上方。条形内部的白色框标签表示总游戏数的百分比。
- en: 'Visualizing data is much easier and quicker to interpret than reading rows
    of numbers. Following are the conclusions to draw from our first pair of bar charts:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 可视化数据比阅读一排排数字更容易、更快速地解读。以下是我们从第一对条形图中得出的结论：
- en: Players selected within the `1-5` segment played in more regular season games,
    based on means and medians, than any other group of first-round selections. In
    fact, though these players represent about 17% of the draft2 record count, they
    collectively played in more than 23% of the regular season games.
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在`1-5`段内选出的球员在常规赛中比赛次数多于其他任何一组首轮选择。实际上，尽管这些球员大约代表了17%的选秀记录，但他们共同参加了超过23%的常规赛。
- en: Players selected within the `6-10` segment played in more regular season games
    than players selected later in the first round. They, too, represent approximately
    17% of the draft2 record count but no less than 18% of the total regular season
    games played.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在`6-10`段内选出的球员在常规赛中比赛次数多于第一轮后期选出的球员。他们同样大约代表了17%的选秀记录，但不少于18%的总常规赛比赛。
- en: Therefore, about 34% of the first-round selections in draft2 account for more
    than 41% of the total regular season games played.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，在选秀2中，大约34%的首轮选择占到了总常规赛比赛数的41%以上。
- en: In no other segment does the percentage of regular season games played exceed
    or even equal their respective percentage of draft2 record counts; in other words,
    segments `11-15`, `16-20`, `21-25`, and `26-30` each contribute approximately
    17% of the records to the draft2 data set, yet the percentage of total regular
    season games played across those four segments is consistently less than 17%.
    This absolutely supports our hypothesis—teams that tank and move up the draft
    board as a result are more likely to draft a player who will then play in more
    games than other players.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在其他任何段位中，常规赛比赛的比例都没有超过或等于它们各自在选秀2记录中的比例；换句话说，`11-15`、`16-20`、`21-25`和`26-30`这四个段位各自向选秀2数据集贡献了大约17%的记录，然而这四个段位在常规赛中的总比赛比例始终低于17%。这绝对支持了我们的假设——那些摆烂并因此提升选秀板位的球队更有可能选秀到一名将比其他球员参加更多比赛的球员。
- en: 3.5.2 Minutes played per game
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.5.2 每场比赛的出场时间
- en: 'Minutes played per regular season game might actually be more telling than
    games played; after all, many players have long careers due to their health and
    dependability but don’t necessarily get significant playing time along the way.
    That being said, our next move is more or less a repeat of the exercise we just
    completed but with the following series of changes:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 每场常规赛的出场时间可能实际上比比赛次数更有说明力；毕竟，许多球员由于健康和可靠性而拥有漫长的职业生涯，但并不一定在过程中获得大量的出场时间。话虽如此，我们的下一步行动基本上是重复我们刚刚完成的练习，但以下是一些变化：
- en: The variable minutes played per regular season game is inserted into similar
    `dplyr` and `ggplot2` code chunks in place of regular season games played.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将每场常规赛的出场时间变量插入到类似的`dplyr`和`ggplot2`代码块中，以代替常规赛的比赛。
- en: Our subsequent chunk of `dplyr` code produces a new object, tibble2, which is
    then passed to the `ggplot()` function.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们随后的`dplyr`代码块产生了一个新的对象`tibble2`，然后将其传递给`ggplot()`函数。
- en: We then pass a different fill and color to the `geom_bar()` function.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后我们向`geom_bar()`函数传递不同的填充和颜色。
- en: The plot title and y-axis label, just two of the arguments passed to the `labs()`
    function, are changed out due to the variable swap.
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于变量交换，图表标题和y轴标签，即传递给`labs()`函数的两个参数，被更改了。
- en: The y-axis is rescaled accordingly, which is also due to the variable change.
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据变量变化相应地调整y轴的比例，这也是由于变量变化。
- en: 'Otherwise, we’re creating an additional pair of `ggplot2` bar charts, where
    the means are displayed on top and the medians displayed on the bottom, broken
    down by our six `Pk2` segments, of course (see figure 3.2):'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 否则，我们正在创建额外的成对`ggplot2`条形图，其中平均值显示在顶部，中位数显示在底部，当然，按我们的六个`Pk2`段位细分（见图3.2）：
- en: '[PRE11]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![CH03_F02_Sutton](../../OEBPS/Images/CH03_F02_Sutton.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F02_Sutton](../../OEBPS/Images/CH03_F02_Sutton.png)'
- en: Figure 3.2 Mean and median minutes played per game by the first-round segment
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.2 第一轮段位每场比赛平均和中值出场时间
- en: 'These results are similar but, at the same time, more definite than our first
    set of results. They are summarized for you here:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果与我们的第一组结果相似，但同时又更加明确。它们在这里为您总结：
- en: Players selected in the `1-5` segment played, on average, approximately 18%
    more minutes per game than players in the `6-10` segment and roughly 33% more
    minutes than players from the other four segments.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在`1-5`段被选中的球员，平均每场比赛比`6-10`段的球员多出约18%的出场时间，比其他四个段的球员多出约33%的出场时间。
- en: There is clear and obvious separation between segments `1-5` and `6-10` and
    further separation between `6-10` and all other segments.
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`1-5`段和`6-10`段之间存在明显的差异，而`6-10`段与其他所有段之间也存在进一步的差异。'
- en: There is almost no variance between segments `11-15`, `16-20`, `21-25`, and
    `26-30`.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在`11-15`、`16-20`、`21-25`和`26-30`段位之间几乎没有差异。
- en: All of this further supports our hypothesis that tanking makes sense—if that’s
    what it takes for a team to select in the `1-5` segment, or even the `6-10` segment,
    versus anywhere else in the first round. Let’s now take a look at win shares.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些进一步支持我们的假设，即摆烂是有意义的——如果这是球队在`1-5`段或甚至`6-10`段选择，而不是第一轮其他任何地方的话。现在让我们来看看胜利份额。
- en: 3.5.3 Career win shares
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.5.3 职业胜利份额
- en: As discussed in chapter 2, win shares is basically a roll-up of every player’s
    offensive and defensive statistics into a single metric. It otherwise equals each
    player’s overall contribution to, or share of, his team’s win total. To put things
    in perspective, players who accrued a minimum of 50 win shares over their careers
    were, for the most part, full-time starters for many years; players who accrued
    somewhere between 75 and 100 career win shares were frequent all-star selections;
    and players who accrued more than 100 career win shares are, without doubt, Hall
    of Fame material. On the flip side, players with 25 or fewer win shares were second-string,
    marginal, or sometimes worse.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 如第2章所述，赢分基本上是将每位球员的进攻和防守统计数据汇总成一个单一指标。否则，它等于每位球员对其球队总赢分的整体贡献或份额。为了更清楚地说明，在其职业生涯中累积至少50个赢分的球员，大多数情况下是多年的全职首发；累积75到100个职业生涯赢分的球员通常是频繁的全明星球员；而累积超过100个职业生涯赢分的球员无疑是名人堂材料。另一方面，赢分在25个或更少的球员通常是替补、边缘球员，有时甚至更糟。
- en: Kareem Abdul-Jabbar, who was drafted by the Milwaukee Bucks but who then played
    most of his career with the Los Angeles Lakers, once accrued an all-time best
    25.4 win shares over the course of just one season, and his 273.4 career win shares
    is still the all-time record. LeBron James, still playing, is not far behind.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 卡里姆·阿卜杜尔-贾巴尔，被密尔沃基雄鹿队选中，但后来在洛杉矶湖人队度过了大部分职业生涯，曾在一个赛季中累积了创纪录的25.4个赢分，他的273.4个职业生涯赢分仍然是历史记录。仍在比赛的勒布朗·詹姆斯并不落后。
- en: 'The following chunk of code is similar to our previous `dplyr` and `ggplot2`
    code chunks, except that we’re swapping in win shares. The corresponding changes
    to the `geom_bar``()`, `labs``()`, and `ylim``()` functions apply:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码块与我们的先前`dplyr`和`ggplot2`代码块类似，除了我们用赢分替换了它们。对`geom_bar()`、`labs()`和`ylim()`函数的相应更改也适用：
- en: '[PRE12]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'For a third time, our end game is a pair of `ggplot2` bar charts packed into
    one graphical representation of our results, with the computed means for every
    segment in the variable `Pk2` visualized on the top and the computed medians per
    `Pk2` segment on the bottom (see figure 3.3):'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 第三次，我们的最终目标是两个`ggplot2`条形图，它们被压缩在一个图形表示中，显示了每个`Pk2`段位的计算平均值，位于顶部，以及每个`Pk2`段位的计算中位数，位于底部（见图3.3）：
- en: '[PRE13]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![CH03_F03_Sutton](../../OEBPS/Images/CH03_F03_Sutton.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F03_Sutton](../../OEBPS/Images/CH03_F03_Sutton.png)'
- en: Figure 3.3 Mean and median career win shares by first-round segment
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.3 第一轮段位的平均和中位职业生涯赢分
- en: 'Wow, the separation between segments—`1-5` versus `6-10`, as well as `6-10`
    versus the remaining four segments—is even more pronounced than what we’ve previously
    seen. More specifically, consider the following:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 哇，段位之间的差距——`1-5`与`6-10`，以及`6-10`与其他四个段位之间的差距——甚至比我们之前看到的更加明显。更具体地说，考虑以下：
- en: Players in the `1-5` segment, on average, accrued almost twice as many career
    win shares as players in the `6-10` segment and about three times as many win
    shares as players from any other segment.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在`1-5`段位的球员，平均而言，累积的职业生涯赢分是`6-10`段位球员的两倍，是其他任何段位球员的三倍左右。
- en: These same players—again, 17% of the draft2 population—account for 34% of all
    win shares, and players in the top-two segments, roughly 34% of the draft2 population,
    account for at least 53% of all win shares.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些相同的球员——再次，占选秀2人口的17%——占所有赢分的34%，而排名前两段的球员，大约占选秀2人口的34%，占所有赢分的至少53%。
- en: While there are significant differences at the top end of the draft, there is
    little to no difference between the `11-15` through `26-30` segments.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虽然在选秀的前端存在显著差异，但在`11-15`到`26-30`段位之间几乎没有差异。
- en: This is the best evidence we have so far that our going-in hypothesis is correct;
    on the most important metric, we have the greatest differentiation between the
    top segments and the remaining segments.
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这是我们迄今为止最好的证据，证明我们的初始假设是正确的；在最重要的指标上，我们看到了顶级段位与其他段位之间最大的差异。
- en: Finally, let’s examine our second win shares variable, `WS48`. This variable
    represents win shares accrued for every 48 minutes of regular season playing time.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们来检查我们的第二个赢分变量，`WS48`。这个变量代表每48分钟常规赛比赛时间的累积赢分。
- en: 3.5.4 Win shares every 48 minutes
  id: totrans-112
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 3.5.4 每48分钟的赢分
- en: 'The following `dplyr` code computes means and medians for the variable `WS48`
    for each `Pk2` segment and the `ggplot2` code to visualize the same:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的`dplyr`代码计算了每个`Pk2`段位的变量`WS48`的平均值和中位数，以及用于可视化的`ggplot2`代码：
- en: '[PRE14]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: A fourth and final pair of bar charts immediately follows—a different metric,
    of course, but the same layout and more or less the same results (see figure 3.4).
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 紧接着是第四对和最后一对条形图——当然，这是不同的指标，但布局大致相同，结果也差不多（见图3.4）。
- en: '![CH03_F04_Sutton](../../OEBPS/Images/CH03_F04_Sutton.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F04_Sutton](../../OEBPS/Images/CH03_F04_Sutton.png)'
- en: Figure 3.4 Mean and median win shares for every 48 minutes played by the first-round
    segment
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.4 第一轮各段每48分钟的平均和中位胜分
- en: 'Because win shares for every 48 minutes of playing time is scaled significantly
    lower than our other measures, the variances between the top and bottom segments
    might appear less pronounced, but they are quite similar to our previous results.
    Our findings are summarized for you here:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 由于每48分钟比赛时间的胜分与其他指标相比显著降低，因此顶尖和底部段之间的差异可能看起来不那么明显，但它们与我们之前的结果非常相似。以下是我们为您总结的发现：
- en: Players in the `1-5` segment accrued almost 20% more win shares for every 48
    minutes of playing time than players in the `6-10` segment and nearly 40% more
    than players in the other segments.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`1-5`段的球员在每48分钟比赛时间的胜分比`6-10`段的球员多近20%，比其他段的球员多近40%。'
- en: In other words, there’s more than a 20% difference in win shares for every 48
    minutes of playing time between the `6-10` segment and the remaining four segments.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 换句话说，`6-10`段与剩余四个段之间，每48分钟比赛时间的胜分差异超过20%。
- en: As with the other measures, there is clear and obvious separation between the
    `1-5` and `6-10` segments and further separation between the `6-10` segment and
    remaining segments.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与其他指标一样，`1-5`段和`6-10`段之间存在明显的差异，而`6-10`段与剩余段之间也有进一步的差异。
- en: 'Performance and productivity are otherwise random across the `11-15` through
    `26-30` segments. Further evidence that our hypothesis is correct: tanking absolutely
    makes sense, especially for teams intent on rebuilding their rosters through the
    draft . . . if losing on purpose can elevate them enough to select a player in
    the `1-5` segment or, at worst, in the `6-10` segment.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在`11-15`到`26-30`段之间，性能和生产力是随机的。这是我们的假设正确的进一步证据：摆烂绝对是合理的，特别是对于意图通过选秀重建阵容的球队来说……如果故意输球能够让他们提升到足以选择`1-5`段或最坏的情况是`6-10`段的球员。
- en: Now that we’ve computed and visualized means and medians of the most significant
    draft2 variables—and in the process showed clear separation between the top of
    the draft and the rest of the first round—we should next document our most important
    takeaways thus far.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经计算并可视化了最重要的选秀2变量的平均值和众数——在这个过程中，我们展示了选秀顶端与其他第一轮之间的明显差异——我们接下来应该记录我们到目前为止最重要的发现。
- en: 3.6 Preliminary conclusions
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.6 初步结论
- en: So what have we established so far? What are the implications? And what have
    we *not* established?
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们到目前为止都确定了什么？有什么影响？以及我们还有什么没有确定的？
- en: Regardless of the measure, there is clear and obvious separation in performance
    and productivity between those players picked within the `1-5` segment versus
    those picked in the `6-10` segment, and there is further separation between the
    `6-10` segment and those players picked in the `11-15` segment.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无论从哪个角度衡量，`1-5`段选出的球员与`6-10`段选出的球员在性能和生产力上都有明显的差异，而`6-10`段与`11-15`段选出的球员之间也有进一步的差异。
- en: There are virtually no performance or productivity differences from the `11-15`
    segment through the rest of the first round, regardless of measure.
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在第一轮的`11-15`段以及之后的比赛中，几乎没有任何性能或生产力的差异，无论从哪个角度来衡量。
- en: Thus, there’s a definite incentive for teams to somehow get to the top, or very
    close to the top, of the draft board. Teams are clearly best off selecting at
    or near the top of the draft if they want—or *need*—a potential superstar.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，对于想要——*或者需要*——选择潜在超级巨星的球队来说，有一个明确的激励让他们设法达到选秀榜的顶端或非常接近顶端。如果球队想要——*或者需要*——选择一个潜在超级巨星，那么在选秀榜上选择或在接近顶端的位置选择无疑是最好的。
- en: But how to get there? Trading up is almost impossible because that, of course,
    would require another team to trade down. As long as the NBA rewards losing teams
    with high draft picks, teams will—*and should*—tank, which, of course, compromises
    the integrity of play.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 但如何达到这个目标呢？向上交易几乎是不可能的，因为这当然需要另一支球队向下交易。只要NBA继续奖励输球队伍以高选秀权，球队就会——*并且应该*——摆烂，这当然会损害比赛的完整性。
- en: Finally, we need to avoid sweeping conclusions that are above and beyond what
    we’re analyzing. Teams tanked in the 1970s too; they presumably did so because
    they wanted to increase their chances of selecting a potential superstar. But
    we can’t rationalize that. We can only say that tanking makes sense based on an
    analysis of the 2000 to 2009 NBA drafts and the subsequent professional careers
    of those players who were selected in the first round in those drafts. Don’t ever
    apply results to circumstances beyond the bounds of your testing and analysis.
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们需要避免得出超出我们分析范围的泛泛结论。20世纪70年代也有球队摆烂；他们可能这么做是因为他们想增加选中潜在超级巨星的几率。但我们无法合理化这一点。我们只能说，根据对2000年至2009年NBA选秀以及那些在首轮被选中的球员随后职业生涯的分析，摆烂是有道理的。永远不要将结果应用于测试和分析范围之外的情况。
- en: With that being said, bear in mind that of the players in the draft2 data set
    with 100-plus career win shares, all but two were top-five picks when they entered
    the NBA draft; only Tony Parker, selected 28th overall by San Antonio in 2001,
    and Stephen Curry, drafted by Golden State in 2009 as the 7th overall selection,
    were drafted outside the top five and have more than 100 career win shares. NBA
    champions, more often than not, have a minimum of two top-five picks on their
    rosters (only two league champions since 2000 had but one top-five pick, and no
    championship-winning team since then had zero); yet, top-five picks are not necessarily
    guaranteed to win a championship. Of the 50 top-five picks in our data set, only
    11 have since won a league championship.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 说到这里，请记住，在 draft2 数据集中，拥有100多场胜利贡献值的球员中，除了两个球员外，所有球员在进入NBA选秀时都是前五顺位的选择；只有托尼·帕克，2001年被圣安东尼奥以第28顺位选中，以及斯蒂芬·库里，2009年被金州勇士以第七顺位选中，他们的选秀顺位不在前五，并且拥有超过100场胜利贡献值。NBA冠军球队通常至少有两名前五顺位的选择（自2000年以来，只有两个联盟冠军只有一名前五顺位的选择，而且从那时起没有一支冠军球队没有前五顺位的选择）；然而，前五顺位的选择并不一定能保证赢得冠军。在我们数据集中的50名前五顺位的选择中，只有11名后来赢得了联盟冠军。
- en: 3.7 Sankey diagram
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.7桑基图
- en: 'Our next technique is a best attempt at consolidating our results into a single
    graphical object. A Sankey diagram is a type of flow diagram where the width of
    the connectors, or links, between a pair of nodes is proportional to quantity.
    Creating one is especially tedious—as you’re about to discover—but the return
    is definitely worth the investment. Sankey diagrams not only look impressive but
    also provide revealing and actionable insights. You might not be all that familiar
    with Sankey diagrams, but you should be because there are plenty of use cases
    for them. For instance, consider the following:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来的技术是尝试将我们的结果整合成一个单一的图形对象。桑基图是一种流程图，其中一对节点之间的连接器或链接的宽度与数量成比例。创建一个桑基图特别繁琐——正如你即将发现的那样——但回报绝对值得投资。桑基图不仅看起来令人印象深刻，而且还能提供揭示性和可操作的见解。你可能对桑基图并不那么熟悉，但你应该熟悉，因为它们有大量的应用场景。例如，考虑以下：
- en: A human resources leader analyzes their company’s end-to-end employment application
    process, starting with functional organizations and requisitions; then comprising
    the channels by which resumes and applications are ingested, including job boards,
    recruiting firms, and internal references; and, finally, a status breakdown of
    every candidate. They might then decide to advertise new opportunities on the
    two job boards that attracted the most or best candidates.
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 人力资源领导者分析他们公司从端到端的就业申请流程，从功能组织和工作需求开始；然后包括简历和申请的接收渠道，包括职位发布板、招聘公司和内部推荐；最后，对每个候选人的状态进行分解。他们可能会决定在吸引最多或最佳候选人的两个职位发布板上发布新的机会。
- en: A manager of a nonprofit tracks their organization’s revenue from donations,
    grants, and membership fees; their capital and operational expenses; and the monetary
    value of their awards for educational, scientific, religious, and literary purposes.
    The manager might then decide to increase membership fees, seek additional grant
    money earmarked for scientific pursuits, or find more affordable office space.
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非营利组织的管理者跟踪他们组织的收入来源，包括捐赠、补助金和会员费；资本和运营费用；以及用于教育、科学、宗教和文学目的的奖项的货币价值。管理者可能会决定提高会员费，寻求更多针对科学追求的补助金，或者寻找更便宜的办公空间。
- en: A marketing manager, without a machine learning background, diagrams yes/no
    responses to a direct marketing campaign by segmenting the customers using their
    education, job type, and marital status. The last pair of nodes—whether or not
    customers respond to the campaign—is the equivalent of a target, or response,
    variable in a machine learning model. The manager might then modify the marketing
    campaign by targeting customers with specific demographic attributes and ignoring
    other customers with other attributes.
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一位没有机器学习背景的市场经理，通过细分客户的学历、职业类型和婚姻状况，绘制了针对直接营销活动的肯定/否定响应图。最后成对的节点——客户是否对活动做出响应——相当于机器学习模型中的目标或响应变量。经理可能会通过针对具有特定人口统计特征的客户来修改营销活动，而忽略其他具有其他特征的客户。
- en: Figure 3.5 shows a relatively simple Sankey diagram, just for illustrative purposes.
    We have a fictional NBA team attempting to sell the last remaining tickets to
    its next home game. The team sends a marketing email or text message to the men
    and women in its booster club. There are significantly more mobile phone numbers
    on file than email addresses; also, there are way more men in the booster club
    than women. Most of the men then purchase one or more tickets, whereas most of
    the women pass.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.5显示了一个相对简单的桑基图，仅用于说明。我们有一个虚构的NBA球队试图出售下一场主场比赛的最后几张剩余门票。球队向其啦啦队中的男性和女性发送营销电子邮件或短信。记录在案的移动电话号码比电子邮件地址多得多；此外，啦啦队中的男性比女性多得多。然后，大多数男性购买了一张或多张门票，而大多数女性则放弃。
- en: '![CH03_F05_Sutton](../../OEBPS/Images/CH03_F05_Sutton.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F05_Sutton](../../OEBPS/Images/CH03_F05_Sutton.png)'
- en: Figure 3.5 A sample Sankey diagram created for illustrative purposes only. The
    vertical rectangles are nodes, and the bands connecting a pair of nodes are links.
    The width of the links is a representation of quantity. In this example, more
    text messages are sent than emails, more men receive some type of digital communication
    than do women, and most men then respond affirmatively, whereas most women do
    not.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.5 仅用于说明目的的桑基图样本。垂直的长方形是节点，连接一对节点的带状物是链接。链接的宽度是数量的表示。在这个例子中，发送的短信比电子邮件多，收到某种类型数字通信的男性比女性多，然后大多数男性做出肯定回应，而大多数女性则没有。
- en: 'Our next code chunk produces a Sankey diagram where the node groupings, from
    left to right, originate from these derived variables:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来的代码块生成一个桑基图，从左到右的节点分组源自这些派生变量：
- en: '`Born2`—A binary variable created in chapter 2 that equals `USA` or `World`.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Born2`—在第二章中创建的二进制变量，等于`USA`或`World`。'
- en: '`College2`—Another binary variable created in chapter 2 that equals `0` or
    `1` for `No` `College` and `College`, respectively.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`College2`—在第二章中创建的另一个二进制变量，分别对应“无大学”和“大学”时等于`0`或`1`。'
- en: '`Age2`—A new variable (discussed following this list) where the original variable
    `Age` is truncated to whole numbers. Every player in the draft2 data set was 17
    to 25 years of age when they turned professional.'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Age2`—一个新变量（在以下列表中讨论），原始变量`Age`被截断为整数。在draft2数据集中，每位球员在成为职业球员时年龄在17到25岁之间。'
- en: '`Pos2`—A variable created in chapter 2 where player positions were consolidated
    from the original variable `Pos` and also spelled out; this variable equals `Big`,
    `Center`, `Forward`, `Guard`, or `Swingman`.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Pos2`—在第二章中创建的变量，将原始变量`Pos`中的球员位置合并并拼写出来；此变量等于`Big`、`Center`、`Forward`、`Guard`或`Swingman`。'
- en: '`Pk2`—A variable derived from the original variable `Pk` that equals `1-5`,
    `6-10`, `11-15`, `16-20`, `21-25`, or `26-30`.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Pk2`—从原始变量`Pk`派生出的变量，等于`1-5`、`6-10`、`11-15`、`16-20`、`21-25`或`26-30`。'
- en: '`WS3`—A new variable (discussed following this list) where the original variable
    `WS` (short for *win shares*) is truncated to whole numbers and then assigned
    to one of six categories or segments.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`WS3`—一个新变量（在以下列表中讨论），原始变量`WS`（简称*win shares*）被截断为整数，然后分配到六个类别或细分市场之一。'
- en: 'Our first order of business is to create the variables `Age2` and then `WS3`.
    With respect to `Age2`, we pass the draft2 data set to the `dplyr` `mutate()`
    function and assign `Age2` to equal a truncated version of the original variable
    `Age`. For `WS3`, we first call `mutate``()`to create a variable called `WS2`,
    which is a truncated version of the original variable `WS`; then we pipe `WS2`
    to the `mutate()` and `case_when()` functions (`case_when()` is the `dplyr` equivalent
    of the base R `ifelse()` function) to create `WS3`, which is `WS2` split into
    six segments. For instance, if `WS2` equals `47`, then `WS3` should equal `40-59`.
    The net effect of creating `Age2` and `WS3` is to reduce the number of nodes and
    links in our Sankey diagram and therefore reduce the amount of code we need to
    write:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第一项任务是创建变量`Age2`，然后是`WS3`。关于`Age2`，我们将`draft2`数据集传递给`dplyr`的`mutate()`函数，并将`Age2`赋值为原始变量`Age`的截断版本。对于`WS3`，我们首先调用`mutate()`创建一个名为`WS2`的变量，它是原始变量`WS`的截断版本；然后我们将`WS2`通过管道传递到`mutate()`和`case_when()`函数（`case_when()`是基础R的`ifelse()`函数的`dplyr`等价物）来创建`WS3`，它是`WS2`分成六个部分。例如，如果`WS2`等于`47`，那么`WS3`应该等于`40-59`。创建`Age2`和`WS3`的净效果是减少桑基图中的节点和链接数量，从而减少我们需要编写的代码量：
- en: '[PRE15]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Our second order of business is to create the nodes. There should be a one-to-one
    relationship between variables and node groupings, which means our Sankey diagram
    will contain six node groupings. Additionally, there should be another one-to-one
    relationship between unique attributes across the six variables and the total
    number of nodes. For instance, `Born2` and `College2` are both binary variables,
    so those two node groupings should each contain two nodes. Our Sankey diagram
    will, in fact, contain 30 nodes. The next chunk of code creates a single-vector
    data frame, called nodes, by way of teaming the base R `data.frame``()` and `c()`
    functions:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二项任务是创建节点。变量和节点分组之间应该存在一对一的关系，这意味着我们的桑基图将包含六个节点分组。此外，六个变量之间的唯一属性和节点总数之间也应该存在一对一的关系。例如，`Born2`和`College2`都是二元变量，因此这两个节点分组各自应包含两个节点。实际上，我们的桑基图将包含30个节点。接下来的代码块通过组合基础R的`data.frame()`和`c()`函数创建了一个单向量数据框，称为`nodes`：
- en: '[PRE16]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Our third order of business is to create another data frame, called links.
    Each series of three numbers in the links data frame represents a link connecting
    two nodes, where the first number in the series is the node being connected from
    (source), the second number represents the node being connected to (target), and
    the third number represents the value, or quantity, of the flow between them (value):'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第三项任务是创建另一个数据框，称为`links`。链接数据框中的每一组三个数字代表连接两个节点的链接，其中序列中的第一个数字是连接的节点（源），第二个数字表示连接到的节点（目标），第三个数字表示它们之间流动的值或数量（值）：
- en: '[PRE17]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Our fourth and final order of business is to render the Sankey diagram by calling
    the `sankeyNetwork()` function from the `networkD3` package (see figure 3.6).
    The arguments passed to the `sankeyNetwork()` function are mandatory and fixed:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们第四和最后一项任务是调用`networkD3`包中的`sankeyNetwork()`函数来绘制桑基图（参见图3.6）。传递给`sankeyNetwork()`函数的参数是强制性的且固定的：
- en: '[PRE18]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![CH03_F06_Sutton](../../OEBPS/Images/CH03_F06_Sutton.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F06_Sutton](../../OEBPS/Images/CH03_F06_Sutton.png)'
- en: Figure 3.6 A Sankey diagram that displays the flow, or quantity, between adjacent
    sets of nodes. Going from left to right, most players selected in the first round
    of the 2000 to 2009 NBA drafts were born in the United States (USA) versus some
    other country (World). More players first attended a college or university (1)
    than those who did not (0). Most players were between 19 and 22 years of age when
    they entered the NBA draft. More players were selected as forwards and guards
    than other positions. Players are distributed across six equal “pick” segments,
    depending on where in the first round they were selected. All players then accrued
    some number of win shares; only a fraction of first-round picks then accrued many
    win shares, and most of them were picked in the `1-5` segment.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.6 显示相邻节点集之间流动或数量的桑基图。从左到右看，2000年至2009年NBA选秀第一轮被选中的大多数球员出生在美国（USA）而不是其他国家（世界）。选择大学或学院（1）的球员比没有选择（0）的球员多。大多数球员在19至22岁时进入NBA选秀。被选为前锋和后卫的球员比其他位置的球员多。球员被分配到六个相等的“选择”段，这取决于他们在第一轮被选中的位置。所有球员都积累了一定数量的胜利份额；只有一小部分首轮选秀球员积累了大量胜利份额，而且大多数都是在`1-5`段被选中的。
- en: A Sankey diagram is interactive in RStudio. When you navigate your cursor over
    one of the nodes, R will highlight the links to and from the node and produce
    a small pop-up that provides the node name and the flow quantity from it. When
    you navigate instead to a link, R will highlight it and provide a pop-up that
    identifies the connecting nodes and the flow quantity between them.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 桑基图在RStudio中是交互式的。当你将光标移至一个节点上时，R会突出显示节点之间的链接，并产生一个小弹出窗口，提供节点名称和从该节点流出的流量量。当你将光标移至链接上时，R会突出显示它，并产生一个弹出窗口，标识连接的节点以及它们之间的流量量。
- en: 'The following `dplyr` code returns the numbers, or values, that were previously
    supplied to the links data frame. The draft2 data set is piped five times to the
    `count()` function, which counts the number of draft2 observations between every
    combination of adjacent node groupings:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 以下`dplyr`代码返回之前提供给链接数据框的数字或值。`draft2`数据集被`count()`函数管道五次，该函数计算`draft2`观察值在相邻节点分组之间的每个组合中的数量：
- en: '[PRE19]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Due to space considerations, the results are not reproduced here, but they are,
    of course, reflected in the build-out of our Sankey diagram.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 由于空间考虑，结果在此未重复，但它们当然反映在我们桑基图的构建中。
- en: 'You might now appreciate why Sankey diagrams aren’t all that prevalent. Just
    imagine if there were even more nodes. However, this one chart effectively visualizes
    the quantitative breakdowns of our derived variables as well as the relationships
    between them. The Sankey diagram works because the “process” depicted here is
    serial or linear. For instance, we can readily see the following:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在可能明白了为什么桑基图并不那么普遍。想象一下，如果还有更多的节点。然而，这张图表有效地可视化了我们导出的变量的定量分解以及它们之间的关系。桑基图之所以有效，是因为这里描绘的“过程”是序列的或线性的。例如，我们可以轻松地看到以下内容：
- en: Approximately four times as many first-round picks between the 2000 and 2009
    NBA drafts were born in the United States versus some other country.
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在2000年至2009年的NBA选秀中，首轮选秀球员中出生在美国的人数是其他国家的四倍左右。
- en: Most first-round picks born in the United States played in college before turning
    professional, whereas a majority of first-round picks born outside the United
    States didn’t play in college.
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大多数在美国出生的首轮选秀球员在转为职业球员之前都曾在大学里打球，而大多数在美国以外出生的首轮选秀球员则没有在大学里打球。
- en: More first-round picks, regardless of where they were born and whether or not
    they first played in college, were aged 19 to 22 when they entered the NBA draft.
    Very few players were either younger than 19 or older than 22 when they turned
    professional.
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更多首轮选秀球员，无论他们出生在哪里以及他们是否在大学里首次亮相，当他们进入NBA选秀时，年龄都在19到22岁之间。当他们转为职业球员时，很少有球员年龄小于19岁或大于22岁。
- en: More first-round picks were forwards or guards than any other position.
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首轮选秀中，前锋和后卫比其他位置的球员更多。
- en: A large majority of the players with 100 or more win shares in their respective
    careers were selected at or near the very top of the draft.
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各自的职业生涯中拥有100次或更多胜场的球员大多数都是在选秀的非常顶端或附近被选中的。
- en: Most players with somewhere between 80 and 99 career win shares were selected
    between the `1-5` and `6-10` `Pk2` segments.
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数在80到99之间的球员大多数是在`1-5`和`6-10` `Pk2`段之间被选中的。
- en: Players with fewer than 20 career win shares come from all `Pk2` segments, but
    most of them were drafted somewhere between the `11-15` and `26-30` `Pk2` segments.
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数少于20次的球员来自所有`Pk2`段，但其中大多数球员是在`11-15`和`26-30` `Pk2`段之间被选中的。
- en: Players selected in the `1-5` or `6-10` segments, especially `1-5`, are more
    or less equally divided between the six segments of career win shares, but players
    drafted thereafter, starting with the `11-15` segment, were much more likely to
    accrue fewer than 20 win shares in their respective careers. When deciding to
    tank or not tank, teams should consider the results of our first segmentation
    analysis, but they should also bear in mind the demographics and other attributes
    of the best-available players.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在`1-5`或`6-10`段被选中的球员，尤其是`1-5`段的球员，在职业胜场数的六个段中大致平均分配，但之后被选中的球员，从`11-15`段开始，更有可能在他们的职业生涯中获得少于20次胜场。在决定是否摆烂时，球队应考虑我们首次分段分析的结果，但他们也应记住最佳可用球员的人口统计和其他属性。
- en: 3.8 Expected value analysis
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.8 预期值分析
- en: 'Our analysis thus far clearly shows that NBA teams should have very different
    expectations of a top-five pick versus any other first-round selection. Let’s
    carry that deduction forward by computing the expected value of a top-five pick,
    using results from the 2000 to 2009 NBA drafts, versus the expected value of any
    other first-round selection. *Expected value* is calculated by multiplying possible
    outcomes by their probability and then summing those results; it’s a series of
    simple mathematical calculations that are computed when outcomes are uncertain,
    yet we nonetheless get a likely value based on a weighted average of every conceivable
    possibility. Expected value is an analysis technique most prevalent in finance
    and risk, but it’s just as applicable in many other fields and endeavors. Following
    are some specifics about expected value:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们的分析清楚地表明，NBA球队应该对前五名选秀权和任何其他首轮选秀权有非常不同的期望。让我们通过计算2000年至2009年NBA选秀的结果来计算前五名选秀权的预期值，与任何其他首轮选秀权的预期值进行比较。*预期值*是通过将可能结果乘以其概率然后汇总这些结果来计算的；它是一系列简单的数学计算，当结果不确定时进行计算，但我们仍然可以根据每个可能性的加权平均得到一个可能的价值。预期值是一种在金融和风险分析中最普遍的技术，但它也适用于许多其他领域和事业。以下是关于预期值的一些具体信息：
- en: Expected value represents the average value, or payoff, that can be expected,
    usually from a specific decision or action, when more than one outcome is possible.
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预期值代表可以预期的平均价值或回报，通常来自特定的决策或行动，当有多种可能结果时。
- en: Expected value is computed by multiplying each possible outcome by its probability
    of occurrence and then summing the products. Thus, Expected value = (Outcome[1]
    × Probability[1]) + (Outcome[2] × Probability[2]) + . . . + (Outcome[N] × Probability[N]).
    The number of terms must equal the number of potential outcomes.
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预期值是通过将每个可能结果乘以其发生的概率然后汇总这些乘积来计算的。因此，预期值 = (结果[1] × 概率[1]) + (结果[2] × 概率[2])
    + ... + (结果[N] × 概率[N])。项数必须等于潜在结果的数量。
- en: Expected value is a common analysis technique when decisions must be made even
    as extenuating circumstances are uncertain and potentially risky. Whichever option
    returns the highest expected value should be considered the best choice.
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当必须做出决策，而外部环境不确定且可能具有风险时，预期值是一种常见的分析技术。应该考虑具有最高预期值的选项为最佳选择。
- en: It may go without saying, but outcomes and probabilities must be known in advance,
    or, alternatively, they can be accurately estimated from historical data.
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虽然可能不言而喻，但必须事先知道结果和概率，或者，作为替代，可以从历史数据中准确估计。
- en: 'The draft2 data set is subset into two populations, based on where in the first
    round each player was drafted (`1-5` or `6-30`), and then subset again based on
    the number of win shares each player earned or has earned so far (some players
    are still active). For the sake of this exercise, the following designations are
    used:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 根据每个球员在首轮选秀中的位置（`1-5`或`6-30`），将draft2数据集划分为两个群体，然后根据每个球员赢得或已赢得的胜场数再次划分（一些球员仍在活跃中）。为了这次练习，以下指定被使用：
- en: Players with 100 or more win shares are designated as *superstars*.
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数达到100或以上的球员被指定为**超级巨星**。
- en: Players with anywhere between 75 and 100 win shares are *stars*.
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数在75到100之间的球员是**明星球员**。
- en: Players with 50 to 75 career win shares are designated as *starters*.
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数在50到75之间的球员被指定为**首发球员**。
- en: Players with 25 to 50 win shares are *reserves*.
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数在25到50之间的球员被指定为**预备球员**。
- en: Players with fewer than 25 career win shares are designated as *marginal*.
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 职业胜场数少于25的球员被指定为**边缘球员**。
- en: Now, take a look at tables 3.1 and 3.2\. Both are structured the same (meaning
    they have the same columns and rows), but table 3.1 is dedicated to the `1-5`
    segment, and table 3\. 2 is dedicated to the `6-30` segment.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，看看表3.1和表3.2。它们结构相同（意味着它们有相同的列和行），但表3.1是针对`1-5`段的，而表3.2是针对`6-30`段的。
- en: Table 3.1 Expected value for an NBA draft pick from the `1-5` segment
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 表3.1 NBA选秀中`1-5`段的预期值
- en: '| Segment (A) | Win Shares (B) | Probability (C) | Median (D) | Expected Value
    (E) |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| 段（A） | 胜场数（B） | 概率（C） | 中位数（D） | 预期值（E） |'
- en: '| Superstar | > 100 | 0.24 | 127.00 | 30.48 |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| 超级巨星 | > 100 | 0.24 | 127.00 | 30.48 |'
- en: '| Star | 75-99.99 | 0.08 | 79.65 | 6.37 |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| 星级 | 75-99.99 | 0.08 | 79.65 | 6.37 |'
- en: '| Starter | 50-74.99 | 0.16 | 59.90 | 9.58 |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| 首发球员 | 50-74.99 | 0.16 | 59.90 | 9.58 |'
- en: '| Reserve | 25-49.99 | 0.20 | 39.95 | 7.99 |'
  id: totrans-188
  prefs: []
  type: TYPE_TB
  zh: '| 预订 | 25-49.99 | 0.20 | 39.95 | 7.99 |'
- en: '| Marginal | < 25 | 0.32 | 9.70 | 3.10 |'
  id: totrans-189
  prefs: []
  type: TYPE_TB
  zh: '| 边缘球员 | < 25 | 0.32 | 9.70 | 3.10 |'
- en: '|  |  | 1.00 |  | 57.53[¹](#pgfId-1017836) |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '|  |  | 1.00 |  | 57.53[¹](#pgfId-1017836) |'
- en: Table 3.2 Expected value for an NBA draft pick from the `11-15` through `26-30`
    segments
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3.2 从 `11-15` 到 `26-30` 段的 NBA 招募挑选期望值
- en: '| Segment (A) | Win Shares (B) | Probability (C) | Median (D) | Expected Value
    (E) |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| 段落（A） | 胜利份额（B） | 概率（C） | 中间值（D） | 期望值（E） |'
- en: '| Superstar | > 100 | 0.01 | 107.25 | 1.07 |'
  id: totrans-193
  prefs: []
  type: TYPE_TB
  zh: '| 超级巨星 | > 100 | 0.01 | 107.25 | 1.07 |'
- en: '| Star | 75-99.99 | 0.04 | 83.00 | 3.32 |'
  id: totrans-194
  prefs: []
  type: TYPE_TB
  zh: '| 明星 | 75-99.99 | 0.04 | 83.00 | 3.32 |'
- en: '| Starter | 50-74.99 | 0.11 | 60.60 | 6.67 |'
  id: totrans-195
  prefs: []
  type: TYPE_TB
  zh: '| 首发 | 50-74.99 | 0.11 | 60.60 | 6.67 |'
- en: '| Reserve | 25-49.99 | 0.21 | 35.00 | 7.35 |'
  id: totrans-196
  prefs: []
  type: TYPE_TB
  zh: '| 替补 | 25-49.99 | 0.21 | 35.00 | 7.35 |'
- en: '| Marginal | < 25 | 0.63 | 5.00 | 3.15 |'
  id: totrans-197
  prefs: []
  type: TYPE_TB
  zh: '| 边缘 | < 25 | 0.63 | 5.00 | 3.15 |'
- en: '|  |  | 1.00 |  | 21.21[²](#pgfId-1018049) |'
  id: totrans-198
  prefs: []
  type: TYPE_TB
  zh: '|  |  | 1.00 |  | 21.21[²](#pgfId-1018049) |'
- en: 'Going from left to right, we have the following:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 从左到右，我们有以下内容：
- en: The Segment (A) and Win Shares (B) columns together represent the player breakdown
    summarized in the previous list; that is, each of our two tables has, by necessity,
    five rows—one row for each segment of player designation.
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 段落（A）和胜利份额（B）列一起代表之前列表中总结的球员细分；也就是说，我们的两个表格都必然有五行——每一行对应于球员指定的每个部分。
- en: The Probability (C) column is really a conditional probability. For instance,
    teams have a 24% chance of selecting a future superstar when they own one of the
    first five picks (equal to 12 of 50 players with 100 win shares or more); teams
    drafting anywhere else in the first round instead have just a 1% probability of
    selecting a future superstar (equal to 2 of 50 players with 100 or more win shares).
    The five probability figures in each table therefore sum to 1.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 概率（C）列实际上是一个条件概率。例如，当球队拥有前五顺位之一时，他们有 24% 的机会选中未来的超级巨星（等于 50 名拥有 100 个或更多胜利份额的球员中的
    12 名）；而在第一轮的其他位置选秀的球队，选中未来超级巨星的概率仅为 1%（等于 50 名拥有 100 个或更多胜利份额的球员中的 2 名）。因此，每个表格中的五个概率数字加起来等于
    1。
- en: The Median (D) column represents the median number of career win shares for
    each Segment (A) and Win Shares (B) combination. For example, the median number
    of win shares for those players drafted within the `1-5` segment who then accrued
    100 or more win shares equals 127\. The median number of win shares was chosen
    here in lieu of the mean in order to mitigate the effect of outliers.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中间值（D）列代表每个段落（A）和胜利份额（B）组合的职业生涯胜利份额的中位数。例如，那些在 `1-5` 段落中被选中并积累了 100 个或更多胜利份额的球员的中位胜利份额为
    127。在这里选择中位数而不是平均值是为了减轻异常值的影响。
- en: The Expected Value (E) column represents the product of Probability (C) and
    Median (D). By then adding the result for each outcome, we get the Expected Value
    (E) of a `1-5` pick versus a `6-30` pick. A player selected in the `1-5` segment,
    based on the 2000 to 2009 NBA drafts, has an expected value of 57.53; in other
    words, an owner, a general manager, a fan—anyone—can expect a player drafted in
    spots 1, 2, 3, 4, or 5 to accrue about 58 win shares over the course of their
    career. Compare that to a player drafted sixth or below—these players can be expected
    to accrue just 21 win shares over their respective careers. This is the difference
    between a full-time starter for many years versus, at best, a career backup.
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 期望值（E）列代表概率（C）和中间值（D）的乘积。然后通过将每个结果的和相加，我们得到 `1-5` 挑选与 `6-30` 挑选的期望值（E）。根据 2000
    年至 2009 年的 NBA 招募，`1-5` 段落中被选中的球员的期望值为 57.53；换句话说，任何一位所有者、总经理、球迷——任何人——都可以预期在
    1、2、3、4 或 5 号位置被选中的球员在其职业生涯中积累大约 58 个胜利份额。相比之下，被选中为第六位或以下的球员——这些球员在其各自的职业生涯中可以预期积累仅
    21 个胜利份额。这就是多年全职首发与最多只是一个职业生涯替补之间的区别。
- en: There are many ways in R to perform an expected value analysis, one not necessarily
    any better than the others. Here, the base R `c()` function is called to create
    a vector called `probs1`. Values for `probs1` are created with `dplyr` code; the
    draft2 data set is repeatedly piped to the `dplyr filter()` function that subsets
    draft2 where, for instance, the variable `Pk` is less than `6` and the variable
    `WS` is greater than `100`. What remains of draft2 is counted with the `dplyr
    tally()` function and divided by `50`, which equals the number of players in draft2
    who were selected first to fifth in the NBA draft.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在 R 中有许多方法可以执行期望值分析，这些方法之间并不一定有哪一个比其他更好。在这里，我们调用基础 R 的 `c()` 函数来创建一个名为 `probs1`
    的向量。`probs1` 的值是通过 `dplyr` 代码创建的；将 draft2 数据集反复通过 `dplyr filter()` 函数，该函数对 draft2
    进行子集化，例如，变量 `Pk` 小于 `6` 且变量 `WS` 大于 `100`。剩余的 draft2 通过 `dplyr tally()` 函数计数，然后除以
    `50`，这等于在 NBA 招募中首先被选中至第五位的球员人数。
- en: 'This series of operations is repeated four times, returning a vector that equals
    the probabilities supplied to table 3.1:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 这一系列操作重复四次，返回一个向量，其值等于表3.1中提供的概率：
- en: '[PRE20]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The `c()` function is again called, this time to create a vector called `vals1`.
    Inside the `c()` function, we call the `filter()` function to subset the draft2
    data set just as before; this time, however, the results are then piped to the
    `dplyr summarize()` function, which calculates the median win shares. The end
    result is a second vector that equals the medians in table 3.1:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '`c()`函数再次被调用，这次是为了创建一个名为`vals1`的向量。在`c()`函数内部，我们调用`filter()`函数来像之前一样对draft2数据集进行子集化；然而，这一次，结果被传递到`dplyr
    summarize()`函数，该函数计算中位数胜利份额。最终结果是第二个向量，其值等于表3.1中的中位数：'
- en: '[PRE21]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'The base R `sum()` function computes the expected value of a top-five pick
    by multiplying `probs1` and `vals1`, both of which are first converted to numeric
    variables by a pair of calls to the base R `as.numeric()` function:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 基础R的`sum()`函数通过将`probs1`和`vals1`相乘来计算前五名挑选的期望值，这两个值都通过基础R的`as.numeric()`函数的两次调用转换为数值变量：
- en: '[PRE22]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The next chunk of code first produces a pair of vectors where
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 下一段代码首先生成一对向量，其中
- en: '`probs2` is more or less the same as `probs1`, except for the fact that the
    counts for each draft2 subset are divided by 241, which is the number of first-round
    picks in draft2 who were selected sixth or below.'
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`probs2`与`probs1`大致相同，只是每个draft2子集的计数被除以241，这是在draft2中被选中第六名或以下的第一个轮次挑选的人数：'
- en: '`vals2` is otherwise “equal” to `vals1`.'
  id: totrans-213
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`vals2`在其他方面与`vals1`“相等”：'
- en: 'The final line of code includes a second call to the `sum()` function to compute
    the expected value of a first-round pick when selecting in the `6-30` segment:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一行代码包括对`sum()`函数的第二次调用，以计算在`6-30`段选择时的第一轮挑选的期望值：
- en: '[PRE23]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Next, one last perspective that further supports our hypothesis: we’ll generate
    what’s called a hierarchical clustering algorithm and then create a plot called
    a dendrogram to visualize the results.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，最后一个支持我们假设的视角：我们将生成所谓的层次聚类算法，然后创建一个名为树状图的图表来可视化结果：
- en: 3.9 Hierarchical clustering
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.9 层次聚类
- en: Hierarchical clustering is just one type of clustering algorithm (we’ll demonstrate
    another clustering method in a subsequent chapter) that groups, or clusters, data
    points based on their similarities or dissimilarities. Hierarchical clustering
    is an unsupervised learning method that begins by assigning each observation,
    or data point, to its own cluster; the algorithm then churns and churns, reducing
    the number of clusters through each iteration, until we’re left with just one
    cluster. (It’s considered unsupervised because we’re not attempting to predict
    the value of a response variable, but instead find structure within a data set.)
    We get the final results by plotting a dendrogram, which more or less resembles
    an upside-down tree, but which, more importantly, represents the hierarchy of
    clusters.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 层次聚类是一种聚类算法类型（我们将在下一章演示另一种聚类方法），它根据数据点的相似性或差异性对数据进行分组或聚类。层次聚类是一种无监督学习方法，它首先将每个观察值或数据点分配到其自己的聚类中；然后算法不断迭代，通过每次迭代减少聚类数量，直到我们只剩下一个聚类。（它被认为是无监督的，因为我们不是试图预测响应变量的值，而是寻找数据集中的结构。）我们通过绘制树状图来获得最终结果，它大致类似于倒置的树，但更重要的是，它代表了聚类的层次结构：
- en: No doubt, the most common use case for clustering—hierarchical clustering included,
    of course—is in marketing. Marketing organizations typically segment their customers
    based on income, prior purchases, and demographic data, and then build tailored
    marketing campaigns that best fit each segment or cluster, thereby generating
    higher response rates than they would otherwise. Overall, hierarchical clustering
    is a powerful, yet moderately difficult, technique for discovering patterns and
    relationships within a data set where there is no shortage of use cases, not just
    in the marketing space but also in the biological and social sciences, for example.
    Hierarchical clustering doesn’t require us to determine in advance an optimal
    number of clusters, unlike k-means, which will be demonstrated in chapter 11\.
    In addition, the results are relatively easy to interpret. However, hierarchical
    clustering may bog down on large data sets, so be aware.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 毫无疑问，聚类（包括层次聚类）最常见的使用案例是在市场营销中。市场营销组织通常根据收入、先前购买和人口统计数据来细分客户，然后构建最适合每个细分市场或聚类的定制营销活动，从而产生比其他情况下更高的响应率。总的来说，层次聚类是一种强大但相对复杂的发现数据集中模式和关系的技巧，其中没有缺乏用例，不仅限于市场营销领域，还包括生物和社会科学等领域。与
    k-means 不同，层次聚类不需要我们事先确定最佳聚类数量，这一点将在第 11 章中演示。此外，结果相对容易解释。然而，层次聚类可能会在大数据集上变得缓慢，所以要有意识。
- en: 'We’re going to build our hierarchical clustering algorithm around just two
    of the draft2 variables: `Pk` and `WS`. So we start by calling the `dplyr select()`
    function to subset draft2 on those two variables and, in the process, create a
    new object called `draft_clust`:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将围绕 draft2 的两个变量：`Pk` 和 `WS` 来构建我们的层次聚类算法。因此，我们首先调用 `dplyr select()` 函数来对
    draft2 进行子集化，在这个过程中创建一个新的对象 `draft_clust`：
- en: '[PRE24]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Then, we pipe `draft_clust` to the `group_by``()` and `summarize()` functions
    to compute the average, or mean, career win shares for every value, 1-30, in the
    variable `Pk`. Our results are then cast into a 30 × 2 tibble called `draft_clust_final`.
    Subsequent calls to the `head``()` and `tail()` functions return the first three
    and last three observations, respectively:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们将 `draft_clust` 输送到 `group_by()` 和 `summarize()` 函数中，以计算变量 `Pk` 中每个值（1-30）的平均或平均职业生涯胜率。我们的结果随后被转换成一个
    30 × 2 的 tibble，称为 `draft_clust_final`。随后的 `head()` 和 `tail()` 函数调用分别返回前三个和最后三个观测值：
- en: '[PRE25]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'This is where matters get a little more complicated. Our next step is to compute
    and print what’s called a distance matrix by successively calling the base R `dist``()`
    and `print()` functions. The `dist()` function takes two arguments: the data source
    and the preferred distance measure. The preferred distance measure, sometimes
    called the pairwise dissimilarity measure, requires some explanation.'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是事情变得稍微复杂的地方。我们的下一步是计算并打印所谓的距离矩阵，通过连续调用基础 R 的 `dist()` 和 `print()` 函数。`dist()`
    函数接受两个参数：数据源和首选的距离度量。首选的距离度量，有时称为成对差异度量，需要一些解释。
- en: 'With respect to hierarchical clustering algorithms, by far the most common
    method of computing the distance between two points is the Euclidean distance.
    Take a look at two of the first three observations in `draft_clust_final`: where
    the variable `Pk` equals `1`, the variable `ws` equals `69.6`; and where `Pk`
    equals `3`, `ws` equals `66.9`. Thus, the difference in average win shares between
    players selected first overall versus players selected third equals 2.7, or the
    difference between 69.6 and 66.9.'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在层次聚类算法中，计算两点之间距离的最常见方法无疑是欧几里得距离。看看 `draft_clust_final` 中前三个观测值中的两个：当变量 `Pk`
    等于 `1` 时，变量 `ws` 等于 `69.6`；当 `Pk` 等于 `3` 时，`ws` 等于 `66.9`。因此，被选中作为第一轮选秀的球员与被选中作为第三轮选秀的球员之间的平均胜率差异为
    2.7，或者说差异在 69.6 和 66.9 之间。
- en: 'But that’s *not* the Euclidean distance between these points. To compute the
    (approximate) Euclidean distance, the data points must be plotted as coordinates
    in a two-dimensional space, where each observation has an x-coordinate and a y-coordinate.
    The Euclidean distance between two points (x1, y1) and (x2, y2) is computed by
    doing the following:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 但这**不是**这些点之间的欧几里得距离。为了计算（近似）欧几里得距离，数据点必须被绘制在二维空间中的坐标，其中每个观测值都有一个 x 坐标和一个 y
    坐标。两点（x1, y1）和（x2, y2）之间的欧几里得距离是通过以下步骤计算的：
- en: Squaring the differences between x2 and x1 and again between y2 and y1
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将 x2 和 x1 之间的差异平方，然后再将 y2 和 y1 之间的差异平方
- en: Adding the two differences together
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将两个差异相加
- en: Computing the square root of the sum
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算总和的平方根
- en: 'Thus, the approximate Euclidean distance between two of the first three observations
    in `draft_clust_final` equals `3.36`, where `x2` and `x1` equal the `Pk` values
    `1` and `3`, respectively, and `y2` and `y1` equal the `ws` values `69.6` and
    `66.9`, respectively:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，`draft_clust_final` 中前三个观测值之间的近似欧几里得距离等于 `3.36`，其中 `x2` 和 `x1` 分别等于 `Pk`
    值 `1` 和 `3`，而 `y2` 和 `y1` 分别等于 `ws` 值 `69.6` 和 `66.9`：
- en: '[PRE26]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'This is a fairly short distance. Let’s swap out the first `draft_clust_final`
    observation in favor of the second and compute the Euclidean distance between
    it and the third observation:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个相当短的距离。让我们用第二个 `draft_clust_final` 观测值替换第一个，并计算它与第三个观测值之间的欧几里得距离：
- en: '[PRE27]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This is still a short distance, but, obviously, the first and third `draft_clust_final`
    observations are more similar to one another than the second and third observations.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 这仍然是一个较短的距离，但显然，`draft_clust_final` 的第一个和第三个观测值彼此之间比第二个和第三个观测值更相似。
- en: 'Now, we can call `dist``()` and `print``()`. Note that in consideration of
    space, only the first 30 rows of the distance matrix are displayed; the total
    output would otherwise take up approximately two additional pages:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以调用 `dist``()` 和 `print``()`. 注意，为了节省空间，这里只显示了距离矩阵的前30行；否则，总输出将占用大约两页额外的空间：
- en: '[PRE28]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Though we’ve truncated the results, the distance matrix nevertheless returns
    the Euclidean distance between every pair of observations in `draft_clust_final`.
    Thus, we can compare our previous computations with the returns from our call
    to the `dist``()` function. The Euclidean distance between the first and third
    `draft_clust_final` observations is where (column) 1 and (row) 3 intersect. It
    equals 3.38, which is close enough to 3.36\. Immediately to the right of that
    is the Euclidean distance between the second and third observations. It equals
    15.45, which compares favorably to the 15.43 we previously computed.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们已截断结果，但距离矩阵仍然返回 `draft_clust_final` 中每对观测值之间的欧几里得距离。因此，我们可以将我们之前的计算与我们对
    `dist``()` 函数的调用返回值进行比较。`draft_clust_final` 的第一个和第三个观测值之间的欧几里得距离位于（列）1 和（行）3 的交点处。它等于
    3.38，这足够接近 3.36。紧接其右的是第二个和第三个观测值之间的欧几里得距离。它等于 15.45，这与我们之前计算的 15.43 相比是有利的。
- en: We then call the base R `hclust()` function, which performs the hierarchical
    clustering. The algorithm starts by assigning each of the 30 `draft_clust_final`
    records to their own cluster; it then iterates 30 times, *combining the most similar
    clusters each time based on the Euclidean distances*, until every data point rolls
    up to the same cluster.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们调用 base R 的 `hclust()` 函数，它执行层次聚类。算法首先将每个 30 个 `draft_clust_final` 记录分配给它们自己的聚类；然后它迭代
    30 次，每次基于欧几里得距离*合并最相似的聚类*，直到每个数据点都滚入同一个聚类。
- en: 'The `hclust()` function takes two arguments: our distance matrix, `distance_matrix`,
    is the first, and the preferred clustering method is the second. The *complete
    method* (aka *complete linkage method*) finds the maximum distance between points
    from different clusters to determine how close, or maybe not so close, a pair
    of clusters are to one another. R supports other methods, but this is by far the
    most common:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '`hclust()` 函数接受两个参数：我们的距离矩阵 `distance_matrix` 是第一个，而首选的聚类方法是第二个。*完全方法*（也称为
    *完全链接方法*）通过找到来自不同聚类的点之间的最大距离来确定一对聚类彼此之间有多接近，或者可能不是很接近。R 支持其他方法，但这是最常见的方法：'
- en: '[PRE29]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Now that we have our hierarchical clustering object, we can go about visualizing
    the results by calling the base R `plot()` function. We get a dendrogram, or a
    tree-like diagram, that displays the merging of clusters at different levels of
    similarity (see figure 3.7):'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了我们的层次聚类对象，我们可以通过调用 base R 的 `plot()` 函数来可视化结果。我们得到一棵树状图，它显示了不同相似度级别上聚类的合并（见图
    3.7）：
- en: The `as.dendrogram()` function, also from base R, is optional; however, we get
    a sharper visualization by adding it rather than just calling the `plot()` function.
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`as.dendrogram()` 函数，同样来自 base R，是可选的；然而，通过添加它而不是仅仅调用 `plot()` 函数，我们可以获得更清晰的可视化。'
- en: The `cex` argument is a number indicating how text and symbols should be scaled
    relative to the default; when set to `0.6`, we’re telling R to print labels at
    60% of their default size.
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cex` 参数是一个数字，表示文本和符号相对于默认值的缩放比例；当设置为 `0.6` 时，我们告诉 R 打印标签的大小为默认大小的 60%。'
- en: The `hang` argument adjusts the height of the dendrogram leaves, or the endpoints
    of our upside-down tree; when set to `-1`, we’re telling R to align or justify
    them along the width of the x-axis.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hang`参数调整树状图叶子的高度，或者倒置树的端点；当设置为`-1`时，我们告诉R沿着x轴的宽度对齐或调整它们。'
- en: The base R `rect.hclust()` function is also optional; it draws a *k* number
    of transparent boxes on top of the dendrogram to further delineate clusters, or
    segments. Considering our prior analysis centered on picks 1 through 5 versus
    every other first-round selection, it only makes sense to therefore set *k* equal
    to `2` and then await the results.
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基础R的`rect.hclust()`函数也是可选的；它在树状图上绘制了*k*个透明框，以进一步区分簇或段。考虑到我们之前的分析集中在选择1至5与其他所有第一轮选择上，因此将*k*设置为`2`并等待结果是合理的。
- en: 'The built-in `par()` function is used to set graphical parameters for base
    R plots. Here, we’re merely instructing R to draw a dark sea-green background
    behind our dendrogram:'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内置的`par()`函数用于设置基础R图形的参数。在这里，我们只是指示R在我们的树状图后面绘制一个深海绿色背景：
- en: '[PRE30]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![CH03_F07_Sutton](../../OEBPS/Images/CH03_F07_Sutton.png)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
  zh: '![CH03_F07_Sutton](../../OEBPS/Images/CH03_F07_Sutton.png)'
- en: Figure 3.7 A dendrogram that displays hierarchical clusters based on win shares
    and pick number
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 图3.7 显示基于赢分和选择编号的层次聚类的树状图
- en: 'It turns out, not surprisingly, that R draws one segment around first-round
    selections 1 through 5 and another segment around the remaining selection numbers.
    Otherwise, here’s how to interpret our dendrogram:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 令人惊讶的是，R在第一轮选择1至5周围绘制了一段线段，并在剩余的选择编号周围绘制了另一段线段。否则，这就是我们如何解释我们的树状图：
- en: Each “leaf” at the very bottom of the dendrogram represents a separate observation
    from `draft_clust_final`.
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 树状图最底部的每个“叶子”代表来自`draft_clust_final`的单独观察值。
- en: As we move up the dendrogram, observations that are similar to one another are
    fused to form a branch. Where our x-axis equals 1 and 3, for instance—or, put
    differently, where the `draft_clust_final` variable `Pk` equals `1` and `3`—those
    observations come together where the y-axis, or the Euclidean distance, equals
    3.38.
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当我们沿着树状图向上移动时，彼此相似的观察值会融合形成分支。例如，当我们的x轴等于1和3时——或者说，用不同的方式说，当`draft_clust_final`变量`Pk`等于`1`和`3`时——这些观察值会在y轴，即欧几里得距离等于3.38的地方聚集在一起。
- en: The closer observations are to one another, the more alike they are; conversely,
    the farther apart, the more dissimilar they are.
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 观察彼此越接近，它们就越相似；反之，它们越远，就越不相似。
- en: The height of the branch connecting selection numbers 1 through 5 equals 19.66
    because we chose a clustering method that computes the maximum distance separating
    any pair of “like” components. Take yet another look at our distance matrix—the
    maximum Euclidean distance across first-round picks 1 through 5 is between picks
    1 and 5.
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接选择编号1至5的分支高度等于19.66，因为我们选择了一种计算任何一对“类似”组件之间最大距离的聚类方法。再仔细看看我们的距离矩阵——第一轮选择1至5之间的最大欧几里得距离是在选择1和5之间。
- en: Likewise, the height of the branch connecting picks 1 through 5 and the other
    selection numbers equals 67.59; again, that’s because the greatest Euclidean distance
    separating any selection number between 1 and 5 and any other selection number
    is between picks 1 and 29, which equals 67.59 (take one last look at the distance
    matrix to confirm).
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 同样，连接选择1至5和其他选择编号的分支高度等于67.59；再次，这是因为1至5之间任何选择编号与任何其他选择编号之间最大的欧几里得距离是在选择1和29之间，等于67.59（再最后看看距离矩阵以确认）。
- en: These results are entirely consistent with our expected value analysis as well
    as our previous findings.
  id: totrans-256
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些结果与我们预期的价值分析和我们之前的发现完全一致。
- en: In this chapter, we told the same story through four separate and incrementally
    advanced statistical techniques. Only a few potential superstars are available
    in any NBA draft, and under the current set of league rules, the only way any
    team can control their own destiny and possibly draft one of these potential superstars
    is to tank. This is to otherwise say that the data and the methods we applied
    against it in whole support the hypothesis we presented in the very beginning.
    In the next chapter, we’ll introduce a method by which teams can best build up
    their rosters, which is not through the draft by tanking, but through the free
    agent market.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们通过四种不同的、逐步提高的统计技术讲述了相同的故事。在任何NBA选秀中，只有少数几位潜在超级巨星可供选择，根据当前联赛规则，任何球队想要控制自己的命运，并可能选中这些潜在超级巨星的唯一方法就是摆烂。换句话说，我们应用的数据和方法整体上支持我们在一开始提出的假设。在下一章中，我们将介绍一种球队可以最好地组建阵容的方法，这不是通过摆烂选秀，而是通过自由球员市场。
- en: Summary
  id: totrans-258
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: We showed that there’s a better way to load many packages at once instead of
    making successive calls to the `library()` function.
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们展示了有比连续调用`library()`函数更好的方法来一次性加载许多包。
- en: There are many ways in R to create segmentations from your original data. We
    called the `mutate()` and `ifelse()` functions in this and the previous chapter
    and, later on, called `mutate()` in tandem with the `case_when()` function.
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在R中，有许多方法可以从原始数据中创建分割。我们在本章和上一章中调用了`mutate()`和`ifelse()`函数，稍后还与`case_when()`函数一起调用了`mutate()`。
- en: We demonstrated several methods by which to perform segmentation analysis, using
    mathematical operations and sophisticated visualization techniques.
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们演示了多种进行分割分析的方法，包括数学运算和复杂的可视化技术。
- en: For instance, we further demonstrated how to visualize means and medians with
    `ggplot2` bar charts to display variances and similarities between our segmentations.
  id: totrans-262
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 例如，我们进一步演示了如何使用`ggplot2`条形图来可视化均值和中位数，以显示分割之间的方差和相似性。
- en: Knowing how to create and to interpret Sankey diagrams is a key advanced analytics
    technique with many use cases. We showed how to create a fairly complex Sankey
    diagram that contained six node groupings and 30 nodes overall.
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解如何创建和解释桑基图是许多用例的关键高级分析技术。我们展示了如何创建一个包含六个节点分组和总共30个节点的相当复杂的桑基图。
- en: Expected value is yet another technique with lots of use cases—investment opportunities
    and outcomes, indefinite weather patterns, gambling, and so on. We showed just
    one of the ways by which you can compute expected values in R.
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 期望值是另一种具有许多用例的技术——投资机会和结果、不确定的天气模式、赌博等等。我们展示了在R中计算期望值的一种方法。
- en: We demonstrated how to develop a hierarchical clustering and how to visualize
    and interpret the results.
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们演示了如何进行层次聚类以及如何可视化和解释结果。
- en: Regardless of method, it’s clear that not all first-round picks are created
    equal. There is clear and obvious separation between players drafted at or near
    the very top of any NBA draft and almost every other available player.
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无论采用何种方法，很明显，并非所有首轮选秀球员都是平等的。在NBA选秀中，被选中或接近顶端的球员与其他几乎所有可用球员之间有明显的区别。
- en: Acquiring superstar talent is an absolute necessity for teams wanting to build
    a championship-caliber roster.
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于想要组建冠军级阵容的球队来说，吸引超级巨星人才是绝对必要的。
- en: Therefore, teams must possess one of the first few picks to have a reasonable
    chance of selecting a potential superstar that can ultimately lead them to a championship.
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，球队必须拥有前几个选秀权之一，才有可能选择一个潜在的超级巨星，最终带领他们赢得冠军。
- en: Even with the lottery, about the only chance of selecting a superstar is by
    having a losing record during the prior season; better yet, teams should tank
    to ensure their record is worse than other teams.
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 即使有乐透选秀，选择超级巨星的唯一机会也在于在前一个赛季有输球记录；更好的是，球队应该摆烂以确保他们的记录比其他球队更差。
- en: '* * *'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '* * *'
- en: 1. The sum of the rows actually equals 57.52; 57.53 is the output from R.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 行的总和实际上等于57.52；57.53是R的输出。
- en: 2. Once more, the printed sum is from the R output and not a sum of the rows;
    variances are due to rounding right of the decimal point.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 再次强调，打印的总和来自R的输出，而不是行的总和；方差是由于小数点右边的四舍五入造成的。
