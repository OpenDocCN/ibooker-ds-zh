- en: Chapter 4\. Working with Time
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第四章：处理时间
- en: When we were debating the content of this book, no chapter contained more examples
    than this one. We had so many examples about time that we added them in practically
    all chapters—including earlier ones.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们辩论本书内容时，没有任何一章包含的示例比这个更多。我们有如此多关于时间的例子，以至于我们在几乎所有章节中都添加了它们，包括早期章节。
- en: What makes time interesting is that we can have a single column in our data
    related to time, and it makes our data extremely flexible to analyze. This is
    because time data is naturally hierarchical. Whether seconds, minutes, hours,
    days, weeks, months, quarters, or years, a column including time data gives you
    flexibility no other column of data will have.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 让时间变得有趣的是，我们可以在我们的数据中有一个与时间相关的单列，这使得我们的数据极其灵活。这是因为时间数据自然上具有层次结构。无论是秒、分钟、小时、天、周、月、季度还是年，包含时间数据的列都为您提供了其他任何数据列所不具备的灵活性。
- en: In [Chapter 3](ch03.xhtml#making_comparisons), we discussed categorical data.
    Categorical data is ideal for making comparisons. One underlying assumption about
    all comparisons is consistency. When we, the developers, visualize two non-time-based
    values, our audience assumes that we are making comparisons that are appropriate.
    Your audience probably assumes they are the same time period.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第三章](ch03.xhtml#making_comparisons)中，我们讨论了分类数据。分类数据非常适合进行比较。关于所有比较的一个基本假设是一致性。当我们作为开发者可视化两个非时间基准的值时，我们的观众假定我们正在进行适当的比较。您的观众可能认为它们是同一时间段。
- en: Imagine you are doing call-center analytics and are comparing total calls. If
    today is May 17, 2020, you probably wouldn’t want to compare total calls in 2019
    to 2020 because they are two, much different lengths! Whether we are trying to
    compare year-to-date from the current year, or comparing one month’s performance
    to the same month a year ago, our audience assumes consistency with time periods—it’s
    practically an unspoken contract between the developer and the user.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一下，您正在进行呼叫中心分析并比较总呼叫量。如果今天是2020年5月17日，您可能不希望将2019年和2020年的总呼叫量进行比较，因为它们的长度相差太大！无论我们是试图比较从当前年度开始到现在的日期，还是比较一个月的表现与一年前同月份的表现，我们的观众都会认为时间段的一致性是开发者与用户之间的一种默契。
- en: The goal of this chapter is to discuss the natural hierarchy of dates and datetimes
    and to help you develop calculations that can standardize and automate your visualizations.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的目标是讨论日期和日期时间的自然层次结构，并帮助您开发能够标准化和自动化您的可视化的计算方法。
- en: 'In this chapter, we’ll walk you through the foundational calculations to make
    you an expert in date calculations. After we’ve built out this foundational understanding,
    we’ll transition to strategies for specific, but regular challenges we’ve faced
    in working with dates data. And remember: in the remainder of the book, you will
    see plenty of examples that utilize dates too.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将为您详细介绍基础计算，使您成为日期计算的专家。在建立这种基础理解之后，我们将过渡到针对我们在处理日期数据时经常遇到的具体挑战的策略。请记住：在本书的其余部分，您将看到大量利用日期的示例。
- en: Understanding Dates and Time
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解日期和时间
- en: Tableau provides users with a very simple interface for working with time. By
    default, Tableau creates a hierarchy that allows users to easily navigate any
    datetime possibility. If you drag any date or datetime field onto the visualization,
    the field will automatically appear aggregated to the nearest year. This is the
    default of dates in Tableau.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau为用户提供了一个非常简单的界面来处理时间。默认情况下，Tableau创建一个层次结构，允许用户轻松导航到任何日期时间的可能性。如果您将任何日期或日期时间字段拖放到可视化中，该字段将自动按年份聚合显示。这是Tableau中日期的默认设置。
- en: In addition to Year as the default setting, Tableau places time values into
    a hierarchy. If you drill into the hierarchy, additional detail will be added
    to your view by quarter, month, week, day, hour, minute, and second.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 除了年份作为默认设置外，Tableau还将时间值放入层次结构中。如果您深入研究这种层次结构，将会通过季度、月份、周、日、小时、分钟和秒向您的视图添加额外的细节。
- en: Tip
  id: totrans-10
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: This hierarchy will be available to your audience too. If you do not want that
    functionality, you will need to create custom date calculations—which we highly
    recommend.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这种层次结构也将提供给您的观众。如果您不需要该功能，则需要创建自定义日期计算——这是我们强烈建议的。
- en: While the default setting for a time field is a year, you can right-click and
    edit the year calculation and select the appropriate time.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管时间字段的默认设置是年份，您可以右键单击编辑年份计算并选择适当的时间。
- en: If you do not want a year to be the default value, you can click and hold the
    Option key on a Mac, or right-click on a PC, while dragging the time field onto
    the view. From there, you can select the date part or value of interest ([Figure 4-1](#the_view_you_will_see_after_clicking_and)).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不希望年份成为默认值，您可以在 Mac 上点击并按住 Option 键，或者在 PC 上右键单击，同时将时间字段拖放到视图中。从那里，您可以选择感兴趣的日期部分或值（[图 4-1](#the_view_you_will_see_after_clicking_and)）。
- en: '![The view you will see after clicking and dragging a date onto a view and
    then right-clicking to change the date type (left). The view you will see after
    clicking and holding Ctrl (or Option on a Mac) while dragging a date onto the
    view (right).](Images/TAST_0401.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![点击并拖动日期到视图后，右键单击更改日期类型后您将看到的视图（左）。点击并按住 Ctrl 键（或 Mac 上的 Option 键）拖动日期到视图后您将看到的视图（右）。](Images/TAST_0401.png)'
- en: Figure 4-1\. The view you will see after clicking and dragging a date onto a
    view and then right-clicking to change the date type (left); the view you will
    see after clicking and holding Ctrl (or Option on a Mac) while dragging a date
    onto the view (right)
  id: totrans-15
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-1\. 点击并拖动日期到视图后，右键单击更改日期类型后您将看到的视图（左）；点击并按住 Ctrl 键（或 Mac 上的 Option 键）拖动日期到视图后您将看到的视图（右）
- en: Date Parts and Date Values
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日期部分和日期值
- en: The way you can work with dates opens up many possibilities. When you look at
    [Figure 4-1](#the_view_you_will_see_after_clicking_and), you see many of the options
    for working with dates. You can choose date *parts* like Year (2015), Quarter
    (Q2), or Month (May), and you can choose date *values* like Quarter (Q2 2015),
    Month (May 2015), or Day (May 8, 2015). The difference between these is that you’re
    either choosing a particular part of the date or truncating the date to the most
    recent date value.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以处理日期的方式开启了许多可能性。当您查看 [图 4-1](#the_view_you_will_see_after_clicking_and) 时，您会看到许多处理日期的选项。您可以选择像年份（2015）、季度（Q2）或月份（May）这样的日期*部分*，也可以选择像季度（Q2
    2015）、月份（May 2015）或日期（May 8, 2015）这样的日期*值*。它们之间的区别在于您要么选择日期的特定部分，要么截断日期到最近的日期值。
- en: Date Calculations
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日期计算
- en: Whether it’s figuring out the date part or the value to truncate to, Tableau
    offers the same flexibility in calculated fields through the `DATEPART()`, `DATENAME()`,
    and `DATETRUNC()` functions. `DATEPART(``)` returns a single numeric value for
    the part of the date of interest. For example, May 8, 2015 would return a value
    of 5 if set to return the month. `DATENAME()` returns a string for the part of
    the date of interest, so May 8, 2015 would return May if set to return the month.
    It’s a subtle difference, but the way the information is displayed will be different.
    Unlike `DATEPART()` and `DATENAME()`, `DATETRUNC()` returns an actual date or
    datetime value. With `DATETRUNC()`, values are rounded or truncated to the most
    recent specified date value.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 无论是确定日期部分还是截断到的值，Tableau 通过 `DATEPART()`、`DATENAME()` 和 `DATETRUNC()` 函数在计算字段中提供了相同的灵活性。`DATEPART()`
    返回感兴趣的日期部分的单个数值。例如，如果设置为返回月份，则 2015 年 5 月 8 日将返回值 5。`DATENAME()` 返回感兴趣的日期部分的字符串，因此如果设置为返回月份，则
    2015 年 5 月 8 日将返回 May。这是一个微妙的区别，但信息显示的方式将会不同。与 `DATEPART()` 和 `DATENAME()` 不同，`DATETRUNC()`
    返回实际的日期或日期时间值。使用 `DATETRUNC()`，值将四舍五入或截断到最近的指定日期值。
- en: Now, if the preceding two paragraphs sound familiar, it’s because we wanted
    it that way to show you this next point. While Tableau’s fields on your view might
    say YEAR, QUARTER, or MONTH, they actually are using these calculations behind
    the scenes. Let’s take a look at Figures [4-2](#the_columns_shelf_showing_discrete_month),
    [4-3](#the_datepartleft_parenthesisright_parent), and [4-4](#the_datetruncleft_parenthesisright_paren),
    and you’ll see we have the date part of Month and date value of Year on columns.
    If you double-click either of these values, Tableau will show the underlying calculations.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果前面的两段听起来耳熟能详，那是因为我们希望以此方式向您展示下一个要点。虽然 Tableau 视图上的字段可能显示为 YEAR、QUARTER
    或 MONTH，但实际上它们在幕后使用这些计算。让我们来看看图 [4-2](#the_columns_shelf_showing_discrete_month)、[4-3](#the_datepartleft_parenthesisright_parent)
    和 [4-4](#the_datetruncleft_parenthesisright_paren)，您将看到在列上有月份的日期部分和年份的日期值。如果您双击其中任何一个值，Tableau
    将显示底层计算。
- en: First, you have a discrete month and continuous year on the Columns shelf. These
    fields look nice and clean—and easy to understand. But underneath each of these
    fields are actually more-complicated functions.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在列架上有一个离散的月份和连续的年份。这些字段看起来漂亮而干净，并且易于理解。但是在每个字段的底层实际上都是更复杂的函数。
- en: '![The Columns shelf showing discrete month and continuous year](Images/TAST_0402.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![列架显示离散月份和连续年份](Images/TAST_0402.png)'
- en: Figure 4-2\. The Columns shelf showing discrete month and continuous year
  id: totrans-23
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-2\. 列架显示离散月份和连续年份
- en: If you double-click the MONTH(Order Date) discrete field, this will open up
    the ad hoc calculation editor. We’ll use this editor quite a bit in this book.
    [Figure 4-3](#the_datepartleft_parenthesisright_parent) shows the underlying calculation
    for MONTH(Order Date). It turns out this calculation uses the `DATEPART()` function
    and specifies `month` as the first argument in the function. This helps return
    the month part of the order date.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您双击离散字段 `MONTH(Order Date)`，将会打开即席计算编辑器。在本书中我们会经常使用这个编辑器。[图 4-3](#the_datepartleft_parenthesisright_parent)
    展示了 `MONTH(Order Date)` 的基础计算。原来这个计算使用了 `DATEPART()` 函数，并指定 `month` 作为函数的第一个参数。这有助于返回订单日期的月份部分。
- en: '![The DATEPART() function that makes up the infrastructure of the discrete
    MONTH(Order Date) field](Images/TAST_0403.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![`DATEPART()` 函数构建了离散 `MONTH(Order Date)` 字段的基础](Images/TAST_0403.png)'
- en: Figure 4-3\. The `DATEPART()` function that makes up the infrastructure of the
    discrete MONTH(Order Date) field
  id: totrans-26
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-3\. `DATEPART()` 函数构建了离散 `MONTH(Order Date)` 字段的基础
- en: And if you double-click the continuous field of YEAR(Order Date), the underlying
    function is `DATETRUNC()`, which as previously mentioned, rounds a field down
    to the specified level. This is shown in [Figure 4-4](#the_datetruncleft_parenthesisright_paren).
    In this case, `year` will return January 1 of the year in [Order Date].
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您双击年份字段 `YEAR(Order Date)` 的连续字段，则底层函数是 `DATETRUNC()`，如前所述，将字段舍入到指定级别。这在 [图 4-4](#the_datetruncleft_parenthesisright_paren)
    中有所显示。在这种情况下，`year` 将返回 [Order Date] 年份的 1 月 1 日。
- en: '![The DATETRUNC() field makes up the infrastructure of the continuous YEAR(Order
    Date) field](Images/TAST_0404.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![`DATETRUNC()` 函数构建了连续 `YEAR(Order Date)` 字段的基础](Images/TAST_0404.png)'
- en: Figure 4-4\. The `DATETRUNC()` field makes up the infrastructure of the continuous
    YEAR(Order Date) field
  id: totrans-29
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-4\. `DATETRUNC()` 函数构建了连续 `YEAR(Order Date)` 字段的基础
- en: What’s great about seeing these calculations is that it helps you learn date
    calculations inside Tableau while you’re using the default settings of any time
    field. What’s also great is that you can change these calculations quickly—even
    in meetings to share insights as conversation occurs.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: '观察这些计算的好处在于，它帮助您在使用 Tableau 中的任何时间字段的默认设置时学习日期计算。同样出色的是，您可以快速更改这些计算——甚至在会议中共享见解时进行。  '
- en: Date Hierarchies and Custom Dates
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 日期层次结构和自定义日期
- en: You’ll notice that all the dates in [Figure 4-4](#the_datetruncleft_parenthesisright_paren)
    include hierarchies—this is that little + button to the left of the field names
    on your date fields on Columns. By default, a date field will automatically create
    these hierarchies. When you add a date field to your view, your audience will
    have the ability to interact with that date hierarchy. If you are looking to interact
    with a specific hierarchy of a date field, working with dates can be a challenge.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 您会注意到 [图 4-4](#the_datetruncleft_parenthesisright_paren) 中的所有日期都包括层次结构——这是位于列字段名称左侧的小
    + 按钮。默认情况下，日期字段将自动创建这些层次结构。当您将日期字段添加到视图时，观众将能够与该日期层次结构进行交互。如果您希望与日期字段的特定层次结构交互，则处理日期可能会有所挑战。
- en: 'Luckily, there are ways to circumvent the automated date hierarchies. You can
    do this by creating a custom date: you right-click the original time field in
    the data source and choose Create → Custom date ([Figure 4-5](#the_menu_action_for_creating_custom_date)).
    From there, you must select the date part or date value of interest. Once you’ve
    created this field, place it somewhere in the view and you’ll notice the date
    has no hierarchy associated with it.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，有方法可以绕过自动化日期层次结构。您可以通过创建自定义日期来实现：右键单击数据源中的原始时间字段，选择创建 → 自定义日期（[图 4-5](#the_menu_action_for_creating_custom_date)）。然后，您必须选择感兴趣的日期部分或日期值。创建了这个字段后，将其放置在视图中的某个位置，您会注意到日期没有关联的层次结构。
- en: '![The menu action for creating custom dates](Images/TAST_0405.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![创建自定义日期的菜单操作](Images/TAST_0405.png)'
- en: Figure 4-5\. The menu action for creating custom dates
  id: totrans-35
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-5\. 创建自定义日期的菜单操作
- en: Discrete Versus Continuous Dates
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 离散日期与连续日期
- en: To better understand how dates are visually represented in Tableau, let’s look
    at four visualizations in which we vary two components on the horizontal axis.
    Let’s look at the difference between date part and date value, and let’s also
    look at how discrete and continuous axes vary for the two chart types. This gives
    you four options to explore ([Figure 4-6](#visual_output_differs_depending_on_wheth)).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解Tableau中如何直观表示日期，让我们看看四个可视化，在其中我们在水平轴上变化了两个组成部分。让我们看看日期部分和日期值之间的差异，也看看两种图表类型的离散和连续轴如何变化。这为您提供了四种探索选项（[图 4-6](#visual_output_differs_depending_on_wheth)）。
- en: '![Visual output differs depending on whether dates are discrete or continuous
    and whether you’re working with date parts or date values](Images/TAST_0406.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![视觉输出因日期是离散还是连续以及您是否使用日期部分或日期值而异](Images/TAST_0406.png)'
- en: Figure 4-6\. Visual output differs depending on whether dates are discrete or
    continuous and whether you’re working with date parts or date values
  id: totrans-39
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-6\. 视觉输出因日期是离散还是连续以及您是否使用日期部分或日期值而异
- en: 'You can see how changing just two options can yield four charts that operate
    quite differently. The two big differences that are worth reiterating: a date
    part selection returns only a single part of a date field, and the default option
    for a date part is typically Discrete. This creates *bins* that separate each
    date part.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到仅更改两个选项如何产生操作方式完全不同的四个图表。两个重要的差异值得重申：日期部分选择仅返回日期字段的单个部分，日期部分的默认选项通常是离散的。这会创建分隔每个日期部分的*区间*。
- en: You can still convert discrete date parts to continuous to make a continuous
    axis. The chart types will look similar, but the axes function differently. If
    you look at the continuous date part visualization at the top right, you will
    see that the axis ticks for each month are centered on the month name. With discrete
    date parts at the top left, the visualization has buckets for each month, and
    no ticks to align to the values for each month. These ticks make it easier for
    our audience to understand which months they are looking at, so for this reason
    we prefer working with continuous fields.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 您仍然可以将离散日期部分转换为连续以创建连续轴。图表类型看起来相似，但轴的功能不同。如果您查看右上角的连续日期部分可视化，您会发现每个月的轴刻度位于月份名称的中心。而左上角的离散日期部分，可视化具有每个月的桶，并且没有刻度与每个月的值对齐。这些刻度使我们的观众更容易理解他们正在查看的月份，因此出于这个原因，我们更喜欢使用连续字段。
- en: This extends to your date value options too. If you choose a date value of Month,
    Tableau rounds each value down to the start of each month by default. This gives
    you month-by-year views of the data. By default, date values are continuous fields,
    but you can convert them to discrete. You’ll notice on the axis on the bottom
    left of [Figure 4-6](#visual_output_differs_depending_on_wheth) that the axes
    are distinct buckets of label names. The continuous date values on the bottom
    right, however, show a single axis with ticks.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 这也适用于您的日期值选项。如果您选择月份的日期值，Tableau默认会将每个值舍入到每个月的开始。这样可以查看数据的逐年月视图。默认情况下，日期值是连续字段，但您可以将它们转换为离散字段。请注意，在[图 4-6](#visual_output_differs_depending_on_wheth)左下角的轴上，轴是不同的标签名称桶。然而，在右下角的连续日期值中，显示了一个带有刻度的单一轴。
- en: Tip
  id: totrans-43
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: Remember that discrete dimensions will create headers only for data that exists.
    If you have gaps in your dates, you may want to use a continuous axis to preserve
    any unrepresented dates.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，离散维度将仅为存在的数据创建标题。如果日期中存在间隔，您可能希望使用连续轴来保留任何未表示的日期。
- en: There is a place for discrete date axes. If you are planning on using a bar
    chart, you can use discrete date parts. If you are working with line charts, we
    recommend continuous axes.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在离散日期轴上有一个位置。如果您计划使用柱状图，可以使用离散日期部分。如果您使用折线图，我们建议使用连续轴。
- en: 'Call Frequency: Chips and Bolts Call Center Case Study'
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调用频率：芯片和螺栓呼叫中心案例研究
- en: The call center of a car part manufacturer, Chips and Bolts (CaB), is looking
    to improve its customer satisfaction scores. The executives need to better understand
    the basics before they can assess their performance. As a first step, they want
    to know how many calls they receive. They’re looking to track this data at 15-minute
    increments over a 2.5-year window to better understand how call volume may relate
    to their customer satisfaction surveys. How can this information be represented?
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 汽车零部件制造商Chips and Bolts (CaB)的呼叫中心正寻求提高其客户满意度得分。执行官们需要在评估他们的绩效之前更好地理解基础知识。作为第一步，他们想要知道他们接到了多少电话。他们希望在2.5年的时间窗口内以15分钟为间隔追踪这些数据，以更好地了解呼叫量可能如何与客户满意度调查相关联。如何表示这些信息？
- en: 'Working with time in Tableau is not without challenges. But it’s easy to place
    hours and minutes on a chart in Tableau: if you are working with a datetime field,
    Tableau automatically places it in the datetime hierarchy. Creating a plot on
    total calls, for instance, wouldn’t be that difficult.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在Tableau中处理时间并不是没有挑战的。但在Tableau中轻松将小时和分钟放在图表中：如果您使用的是日期时间字段，Tableau会自动将其放置在日期时间层次结构中。例如，创建一个关于总呼叫量的图表并不是那么困难。
- en: With the continuous date part example shown previously, it’s fairly easy to
    convert a single date part into a continuous axis to plot multiple time periods.
    Using continuous date values truncates a date up to a certain date part, but sometimes
    you want to do the opposite. In this example, we want a continuous axis for hour,
    minute, and day. Take a look at [Figure 4-7](#an_area_plot_of_total_calls_every_fiftee),
    showing total phone inbound calls received from the call center every 15 minutes
    over 2.5 years.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所示的连续日期部分示例，将单个日期部分转换为连续轴以绘制多个时间段是相当容易的。使用连续日期值截断日期到特定日期部分，但有时您希望做相反的操作。在这个例子中，我们希望为小时、分钟和天创建一个连续轴。看看[图 4-7](#an_area_plot_of_total_calls_every_fiftee)，显示了在2.5年内每15分钟从呼叫中心接收到的总入站电话呼叫。
- en: '![An area plot of total calls every 15 minutes](Images/TAST_0407.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![每15分钟总呼叫量的面积图](Images/TAST_0407.png)'
- en: Figure 4-7\. An area plot of total calls every 15 minutes
  id: totrans-51
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-7\. 每15分钟总呼叫量的面积图
- en: For the first four strategies, you will convert a datetime to various levels
    of aggregation. To complete the final analysis, call data aggregated on a continuous
    axis by every 15 minutes, you’ll need to get every date to be the exact same—but
    retain the time of each row in the data.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 对于前四个策略，您将把日期时间转换为各种聚合级别。要完成最终的分析，按每15分钟聚合的连续轴上的呼叫数据，您需要使每个日期都完全相同，但保留数据中每行的时间。
- en: 'Strategy: Determine Total Call Time by Hour'
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：按小时确定总通话时间
- en: In this strategy, we will tackle the challenge of working with time—particularly
    on a continuous axis. The result of this strategy is shown in [Figure 4-8](#a_line_plot_of_sales_by_hour_for_each_of).
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，我们将解决处理时间的挑战，特别是在连续轴上。该策略的结果显示在[图 4-8](#a_line_plot_of_sales_by_hour_for_each_of)中。
- en: '![A line plot of sales by hour for each of the three years of data](Images/TAST_0408.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![每年销售按小时绘制的线图](Images/TAST_0408.png)'
- en: Figure 4-8\. A line plot of sales by hour for each of the three years of data
  id: totrans-56
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-8\. 每年销售按小时绘制的线图
- en: 'In this strategy, we will plot the total calls by hour, broken down by year:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，我们将按小时绘制总呼叫量，按年份分类：
- en: Create a new sheet and set it to fit the entire view.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的工作表，并设置为适合整个视图。
- en: Place [Start Date Time] on Columns. Then change the display to discrete hours.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[开始日期时间]放在列上。然后将显示更改为离散小时。
- en: 'If you are using Tableau Desktop 2020.1 or older, your data source already
    comes with the [Number of Records] field. If you are working with Tableau 2020.2
    or newer, create a calculated field called `**[Number of Records]**` :'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您使用的是Tableau Desktop 2020.1或更早版本，您的数据源已经带有[记录数]字段。如果您使用的是Tableau 2020.2或更新版本，请创建一个名为`**[记录数]**`的计算字段：
- en: '[PRE0]'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Add [Number of Records] as a sum to Rows.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[记录数]作为总和添加到行中。
- en: Add the discrete year of [Start Date Time] to Color.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[开始日期时间]的离散年份添加到颜色中。
- en: Doing this allows you to see that—regardless of year—the calls begin to escalate
    around 7 a.m. but really pick up by 8 a.m. You also see that calls in 2020 are
    down across the board.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这样做可以让您看到，无论是哪一年，呼叫量都在早上7点左右开始上升，但真正在早上8点左右增加。您还可以看到，2020年的呼叫量全面下降。
- en: What’s missing from this analysis is a deeper investigation. Do calls occur
    at the beginning of each hour, or at mid-hour? If you are creating a staffing
    plan, the exact times might be more useful.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 这项分析缺少的是更深入的调查。通话是否发生在每个小时的开头或半小时？如果您正在制定人员配备计划，确切的时间可能更有用。
- en: 'Strategy: Create a Plot to Measure Total Call Time by Minute'
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建一个按分钟测量总通话时间的图表
- en: 'We will expand on the previous strategy by creating a visualization that plots
    total calls by minute of the day:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过创建一个可视化来扩展之前的策略，该可视化绘制了每天按分钟计的总通话量：
- en: Sort the data by minute by clicking the + on the HOUR hierarchy. [Figure 4-9](#a_line_plot_of_sales_by_hour_and_minute)
    shows the resulting visualization.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按小时的HOUR分层上点击“+”对数据进行排序。[图4-9](#a_line_plot_of_sales_by_hour_and_minute) 显示了结果可视化。
- en: '![A line plot of sales by hour and minute for each of the three years of data](Images/TAST_0409.png)'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![一条按小时和分钟分段销售的折线图，每年的三年数据](Images/TAST_0409.png)'
- en: Figure 4-9\. A line plot of sales by hour and minute for each of the three years
    of data
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-9\. 一条按小时和分钟分段销售的折线图，每年的三年数据
- en: 'The result shows calls by minute in the day, but now we have two discrete axes:
    the top axis partitioned by hour, and a second axis for minutes, also creating
    up to 60 individual partitions within each hour. This creates partitions only
    where data exists. So if there is no data for hour 0, minute 53 (and there isn’t),
    the partition doesn’t exist.'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果显示了一天中的通话次数，但现在我们有两个离散的轴：顶部轴按小时分割，第二个轴按分钟，每小时还创建了高达60个单独的分区。这仅在数据存在时创建分区。因此，如果小时0没有数据，分钟53（事实上没有），则分区不存在。
- en: Add any missing partitions. If you want to include missing partitions of any
    specified date part, right-click the date part and select Show Missing Values
    ([Figure 4-10](#to_show_missing_valuescomma_right-click)).
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加任何缺失的分区。如果要包含任何指定日期部分的缺失分区，请右键单击该日期部分并选择显示缺失值（图4-10右键单击）。
- en: '![To show missing values, right-click the date field and select Show Missing
    Values](Images/TAST_0410.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![要显示缺失值，请右键单击日期字段并选择显示缺失值](Images/TAST_0410.png)'
- en: Figure 4-10\. To show missing values, right-click the date field and select
    Show Missing Values
  id: totrans-74
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-10\. 若要显示缺失值，请右键单击日期字段，然后选择显示缺失值
- en: 'If you take a look at [Figure 4-9](#a_line_plot_of_sales_by_hour_and_minute),
    you’ll see that your visualization has two sets of discrete bins: one for hours
    and one for minutes. Using discrete values for hours and minutes is difficult
    because you end up with 1,440 partitions (24 hours × 60 minutes).'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您查看[图4-9](#a_line_plot_of_sales_by_hour_and_minute)，您会看到您的可视化具有两组离散的箱柜：一个用于小时，一个用于分钟。对于小时和分钟使用离散值是困难的，因为您最终会得到1,440个分区（24小时
    × 60分钟）。
- en: 'So how can you make a single axis? For this calculation, we are going to rely
    on two commonly used calculations: `DATEADD()` and `DATEDIFF()`.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 那么如何创建一个单一的轴？在这个计算中，我们将依赖于两个常用的计算：`DATEADD()` 和 `DATEDIFF()`。
- en: '`DATEADD()` adds or subtracts dates or time and requires three inputs:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: '`DATEADD()` 添加或减去日期或时间，并需要三个输入：'
- en: A specified date part, written inside quotation marks and in lowercase. This
    shows the units we are adding to a date, whether it’s seconds or hours or years.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指定的日期部分，用引号括起来且小写。这显示我们要添加到日期中的单位，无论是秒、小时还是年。
- en: Any integer indicating the amount of time we want to add or subtract. If a negative
    number is specified, time will be subtracted from the value.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何整数，表示我们想要添加或减去的时间量。如果指定了负数，将从值中减去时间。
- en: The initial datetime field.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 初始日期时间字段。
- en: This extremely versatile calculation is one we use all the time.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 这个非常多才多艺的计算是我们经常使用的。
- en: '`DATEDIFF()` calculates the difference between two dates based on the date
    part of interest and requires three inputs:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '`DATEDIFF()` 根据感兴趣的日期部分计算两个日期之间的差异，并需要三个输入：'
- en: A specified date part
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 指定的日期部分
- en: A starting date
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开始日期
- en: An ending date
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结束日期
- en: 'You can specify various date parts: `year`, `quarter`, `month`, `dayofyear`,
    `day`, `weekday`, `week`, `hour`, `minute`, `second`, `iso-year`, `iso-quarter`,
    `iso-week`, and `iso-weekday`.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以指定各种日期部分：`year`、`quarter`、`month`、`dayofyear`、`day`、`weekday`、`week`、`hour`、`minute`、`second`、`iso-year`、`iso-quarter`、`iso-week`
    和 `iso-weekday`。
- en: Tip
  id: totrans-87
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: For more technical help, read [Tableau’s documentation on date functions](https://oreil.ly/blPRT).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 欲获取更多技术帮助，请阅读[Tableau有关日期函数的文档](https://oreil.ly/blPRT)。
- en: 'Strategy: Create a Continuous Datetime Axis by the Second'
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建一个连续的按秒计的日期时间轴
- en: 'You’ll now create a calculation that allows you to have a single axis for time:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您将创建一个允许您拥有单一时间轴的计算：
- en: 'Create a calculated field called `**[time]**` and write the following calculation:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建名为`**[time]**`的计算字段，并编写以下计算：
- en: '[PRE1]'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This calculation will change all dates in your dataset to be equal to the maximum
    date in your dataset. The time (hour, minutes, and seconds) will remain the same.
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此计算将更改数据集中所有日期为数据集中的最大日期。时间（小时、分钟和秒）保持不变。
- en: 'Create a continuous axis as follows:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建如下连续轴：
- en: Remove all calculations on the columns.
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移除所有列上的计算。
- en: Add the [time] field as an exact date to the columns.
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[time]字段添加为列的确切日期。
- en: This will produce the visualization in [Figure 4-11](#total_calls_per_second_of_the_day_using).
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将生成[图4-11](#total_calls_per_second_of_the_day_using)中的可视化。
- en: '![Total calls per second of the day using a continuous axis](Images/TAST_0411.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![使用连续轴每秒的总呼叫量](Images/TAST_0411.png)'
- en: Figure 4-11\. Total calls per second of the day using a continuous axis
  id: totrans-99
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-11\. 使用连续轴每秒的总呼叫量
- en: You now have a continuous axis. However, the analysis is to the second, which
    isn’t extremely helpful or insightful. Instead of a per-second analysis, maybe
    you want to capture data every 15 seconds.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在有了一个连续的轴。然而，这个分析是秒级的，这并不是非常有用或深刻的。与其进行每秒的分析，也许您想捕捉每15秒的数据。
- en: 'Strategy: Create a Continuous Datetime Axis for 15-Second Intervals'
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：为15秒间隔创建连续的日期时间轴。
- en: 'You will continue exploring datetime by creating a custom calculation that
    aggregates calls based on every 15 seconds of the day:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 您将继续探索日期时间，创建一个自定义计算，基于每天每15秒的呼叫进行聚合：
- en: Use the visualization from our preceding strategy.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用我们之前策略的可视化。
- en: Create a new calculation and call it `**[time / 15 sec]**`.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的计算并命名为`**[time / 15 sec]**`。
- en: 'Write the following:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 撰写以下内容：
- en: '[PRE2]'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Here you’re first calculating the seconds for the time field. You are then using
    the modulo operator (`%`) to calculate the total seconds every 15 seconds. Therefore,
    rather than counting to 60, you are counting to 14; then, instead of continuing
    to 15, you restart at 0.
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这里首先计算时间字段的秒数。然后使用模运算符（`%`）计算每15秒的总秒数。因此，不是计数到60，而是计数到14；然后，而不是继续到15，重新从0开始。
- en: The result of this calculation is a datetime truncated to the most recent 15
    seconds.
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此计算的结果是将日期时间截断为最近的15秒。
- en: Click and drag [time / 15 sec] to replace the time field as a continuous axis.
    This produces the visualization in [Figure 4-12](#total_calls_every_fifteen_seconds_of_the).
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击并拖动[time / 15 sec]以替换时间字段为连续轴。这将生成[图4-12](#total_calls_every_fifteen_seconds_of_the)中的可视化。
- en: '![Total calls every 15 seconds of the day using a continuous axis](Images/TAST_0412.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![使用连续轴每15秒的总呼叫量](Images/TAST_0412.png)'
- en: Figure 4-12\. Total calls every 15 seconds of the day using a continuous axis
  id: totrans-111
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-12\. 使用连续轴显示每天每15秒的总呼叫量
- en: You’re starting to see patterns like those with the hourly plot, but this view
    is still too granular. Instead of every 15 seconds, what if you looked at every
    15 minutes?
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 您开始看到类似于每小时绘图的模式，但这个视图仍然过于详细。与其每15秒查看一次，不如每15分钟查看一次？
- en: 'Strategy: Create a Continuous Datetime Axis for 15-Minute Intervals'
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：为15分钟间隔创建连续的日期时间轴。
- en: When we started working with this data, we saw that information at the hour
    LOD was interesting, but we needed to see more information to get more specific.
    From there, we looked at the plots by every minute and every 15 seconds. Those
    plots were too detailed. In this strategy, we create a calculation that truncates
    time to every 15 minutes. The result will be a plot that is far more actionable
    than the previous three.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们开始处理这些数据时，我们发现每小时LOD的信息很有趣，但我们需要看更多信息以便更具体。从那里开始，我们看到了每分钟和每15秒的图表。这些图表太详细了。在这个策略中，我们创建了一个计算，将时间截断为每15分钟。结果将是比前三个更具可操作性的图表。
- en: Create a new calculation called `**[time / 15 min]**`.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建名为`**[time / 15 min]**`的新计算。
- en: 'Write the following:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 撰写以下内容：
- en: '[PRE3]'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The format for [time / 15 min] looks almost the same, except we’ve replaced
    `second` with `minute`, and our third argument is now `DATETRUNC("minute", [time])`
    instead of `time`. This is because our analysis with [time / 15 sec] was already
    at the lowest level in Tableau (seconds). Since we are working at a higher level
    of data, we need to roll up all the values to the nearest minute.
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[time / 15 min]的格式看起来几乎相同，只是我们用`minute`替换了`second`，我们的第三个参数现在是`DATETRUNC("minute",
    [time])`而不是`time`。这是因为我们使用[time / 15 sec]在Tableau中已经是最低级别（秒）。因为我们在更高级别的数据上工作，我们需要将所有值汇总到最近的分钟。'
- en: 'Roll up to the nearest minute:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向最近的分钟卷起：
- en: Click and drag to replace [time / 15 sec] with [time / 15 min].
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击并拖动以用[时间/15秒]替换[时间/15分钟]。
- en: On the Marks card, click Path and change the line type to Step. We like using
    a step path instead of a straight line because we know that the line represents
    all values across this 15-minute increment.
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在标记卡上，单击路径，将线型更改为步进。我们喜欢使用步进路径而不是直线，因为我们知道该线表示该15分钟增量中的所有值。
- en: Finally, in [Figure 4-13](#total_calls_every_fifteen_minutes_of_the), we have
    a single axis where we can see patterns in the data at 15-minute intervals. This
    plot gives us lots of great information about how quickly calls are scaling up
    each morning, with much greater precision than to the nearest hour (but not too
    precise).
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最后，在[图 4-13](#total_calls_every_fifteen_minutes_of_the)中，我们有一个单一的轴，可以看到数据在15分钟间隔内的模式。这个图表为我们提供了关于每天早晨通话快速增长速度的大量信息，比最近小时（但不太精确）要精确得多。
- en: '![Total calls every 15 minutes of the day using a continuous axis](Images/TAST_0413.png)'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![每天每15分钟的总通话次数，使用连续轴](Images/TAST_0413.png)'
- en: Figure 4-13\. Total calls every 15 minutes of the day using a continuous axis
  id: totrans-124
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-13\. 每天每15分钟的总通话次数，使用连续轴
- en: You still have the red line—representing 2020—much lower than all other values.
    This might be because we’ve collected data only up until April 14, 2020\. And
    because business might be seasonal, comparing time periods that are alike might
    be worthwhile. But before we do that, we want to take a deeper look at calls per
    15 minutes.
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你仍然有代表2020年的红线，比所有其他值都低得多。这可能是因为我们仅收集到了2020年4月14日为止的数据。由于业务可能是季节性的，比较类似的时间段可能是值得的。但在我们这样做之前，我们希望深入了解每15分钟的通话次数。
- en: Let’s look at calls per 15 minutes, by day of the week, by adjusting the dimension
    on Color. Right-click YEAR(Start Date Time) and change the date type to a discrete
    date part of `weekday` (this is located under the More section of the date part).
    Feel free to edit the colors afterward. [Figure 4-14](#total_calls_every_fifteen_minute-id00010)
    shows the resulting visualization.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们看看每15分钟的通话次数，通过调整颜色上的维度来按星期几进行。右键单击YEAR(开始日期时间)，将日期类型更改为`工作日`的离散日期部分（这位于日期部分的“更多”部分下）。之后可以随意编辑颜色。[图 4-14](#total_calls_every_fifteen_minute-id00010)显示了结果可视化。
- en: '![Total calls every 15 minutes of the day, colored by day of the week and using
    a continuous axis](Images/TAST_0414.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![每天每15分钟的总通话次数，按星期几着色，并使用连续轴](Images/TAST_0414.png)'
- en: Figure 4-14\. Total calls every 15 minutes of the day, colored by day of the
    week and using a continuous axis
  id: totrans-128
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-14\. 每天每15分钟的总通话次数，按星期几着色，并使用连续轴
- en: Heatmaps (Highlight Tables)
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 热图（突出显示表格）
- en: The information in [Figure 4-14](#total_calls_every_fifteen_minute-id00010)
    is extremely useful, but there are just too many lines to read through the insights.
    When we’re working with line charts that have eight or more lines, we immediately
    consider other chart types. Our go-to chart type for this scenario is the *heatmap*—though
    Tableau calls it a *highlight table*. Heatmaps allow audiences to see change via
    color, intensity, or hue rather than through direction. This heatmap is displayed
    as a matrix so that anyone can easily track changes for a single member in a dimension.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 4-14](#total_calls_every_fifteen_minute-id00010)中的信息非常有用，但要阅读这些洞察力，行数实在是太多了。当我们处理具有八条或更多线条的折线图时，我们会立即考虑其他图表类型。在这种情况下，我们选择的图表类型是*热图*—尽管Tableau称之为*突出显示表格*。热图允许观众通过颜色、强度或色调来看待变化，而不是通过方向。这个热图显示为一个矩阵，以便任何人都能轻松追踪维度中单个成员的变化。'
- en: 'Strategy: Build an Essential Heatmap'
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：构建一个基本的热图
- en: 'Let’s create a heatmap that reimagines the same analysis from the line chart
    in our preceding strategy:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们创建一个重新构想前一战略折线图分析的热图：
- en: Create a new sheet.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新工作表。
- en: Change the mark type to Square.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为方块。
- en: Create a custom date for the date part of weekday by using [Start Date Time]
    and place that on Columns.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过使用[开始日期时间]创建一个自定义的工作日日期部分，并将其放置在列上。
- en: Place [time / 15 min] on Rows but choose the Hour date part.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[时间/15分钟]放在行上，但选择小时日期部分。
- en: Place [Number of Records] on Color.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[记录数]放在颜色上。
- en: Choose a color palette that works for you. We’re choosing a custom color palette
    (we’ll talk about that more in [Chapter 12](ch12.xhtml#building_dashboards_and_data_products)).
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择适合你的调色板。我们选择了一个自定义调色板（我们将在[第12章](ch12.xhtml#building_dashboards_and_data_products)中更详细地讨论它）。
- en: The result is the heatmap in [Figure 4-15](#total_calls_every_hour_of_the_day_and_da).
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果是图4-15中的热图。
- en: '![Total calls every hour of the day and day of the week using a heatmap](Images/TAST_0415.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![使用热图显示每天每小时和周几的总通话量](Images/TAST_0415.png)'
- en: Figure 4-15\. Total calls every hour of the day and day of the week using a
    heatmap
  id: totrans-141
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-15\. 使用热图显示每天每小时和周几的总通话量
- en: Once again, you see that calls begin to pick up at 8 a.m., through change in
    color. But you are also able to spot that Mondays, particularly in the morning,
    are extremely busy. Weekends are quieter, and Sunday is exceptionally slow. We
    also see that calls begin falling off after 5 p.m. (depicted as 17 in the chart).
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 再次看到通话从上午8点开始增加，通过颜色变化。但您还能看到周一特别是早上非常繁忙。周末较为宁静，周日异常缓慢。我们还看到通话在下午5点后开始减少（图表中显示为17）。
- en: 'Strategy: Create a More Detailed Heatmap'
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建更详细的热图
- en: 'A heatmap can be extremely helpful even when the data is fairly granular. Heatmaps’
    value only increases as more complexities and detail are added to a visualization.
    Follow these steps to add more detail to your heatmap:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 即使数据相当精细，热图也可以非常有帮助。随着可视化的复杂性和细节增加，热图的价值也在不断提高。按照以下步骤为您的热图添加更多细节：
- en: Duplicate your visualization from the preceding strategy.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制前一策略中的可视化。
- en: Create a custom date for the date part of Month by using [Start Date Time].
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过使用[开始日期时间]创建一个定制日期以用作月份的日期部分。
- en: Place it on Columns and to the left of your weekday calculation on Columns.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将其放在列上并放在您的工作日计算左侧的列上。
- en: Click the + on HOUR(time / 15 min) on Rows. This will show time rounded to the
    nearest 15 minutes.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在行上单击HOUR(time / 15 min)上的+。这将显示四舍五入到最近15分钟的时间。
- en: 'You’ll notice some whitespace where there are no values on your dashboard.
    If you want to add marks for those locations, you’ll need to use a lookup calculation:
    `ZN(LOOKUP(SUM([Number of Records]),0))`. (We’ll talk about this in more detail
    in [Chapter 6](ch06.xhtml#building_impactful_tables).) Add this calculation to
    Color.'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您会注意到仪表板上没有值的地方有些空白。如果您想为这些位置添加标记，您需要使用查找计算：`ZN(LOOKUP(SUM([Number of Records]),0))`。（我们将在[第6章](ch06.xhtml#building_impactful_tables)中更详细地讨论这个。）将此计算添加到颜色中。
- en: Format your column and row headers to be more readable. [Figure 4-16](#total_calls_every_fifteen_minute-id00011)
    shows the resulting visualization.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 格式化您的列和行标题以使其更易读。[图4-16](#total_calls_every_fifteen_minute-id00011)显示了生成的可视化效果。
- en: '![Total calls every 15 minutes of the day by month and day of the week using
    a heatmap](Images/TAST_0416.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![使用热图显示每天每15分钟的总通话量按月和周几](Images/TAST_0416.png)'
- en: Figure 4-16\. Total calls every 15 minutes of the day by month and day of the
    week using a heatmap
  id: totrans-152
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-16\. 使用热图显示每天每15分钟的总通话次数按月和周几
- en: We’ve chosen to format dividers at the Hour and Month level. This allows your
    audience to quickly navigate to segments of analysis.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们选择在小时和月份级别上设置分隔符。这使您的观众可以快速导航到分析段落。
- en: This chart shows call volumes by 15-minute increments by month and day of the
    week. So what insights can you glean from this data?
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 该图表显示了按月和周几每15分钟递增的通话量。那么，您能从这些数据中获取哪些见解呢？
- en: Calls pick up at 8 a.m. on weekdays almost every month of the year.
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平均每年几乎每个月的工作日早上8点通话量增加。
- en: More calls tend to occur in the later evening during the summer months.
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更多通话倾向于在夏季晚些时候发生。
- en: Regardless of day of the week, a lot of calls typically occur in January.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无论一周的哪一天，通常一月份的通话量都很大。
- en: In April, July, and December, more calls happen on Mondays. This might be because
    a heater or air conditioner that broke over the weekend results in calls for service
    on Monday.
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在四月、七月和十二月，周一的通话量较多。这可能是因为周末暖气或空调出现故障，导致周一需要服务。
- en: Identifying call patterns from this visualization could be extremely helpful
    in staffing. Mondays are always busy, but it might make sense to bulk up on those
    days in April, July, and December. With call volumes higher later into the evening
    in the summer, staffing might be needed until 6 p.m. instead of 5 p.m. This could
    be offset with staff working fewer hours on non-Mondays during November and December.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 从这种可视化中识别通话模式可能对人员配备非常有帮助。周一总是很忙，但在四月、七月和十二月这些日子加强人员配备可能是有意义的。由于夏季晚些时候的通话量较高，可能需要在下午6点而不是下午5点之前进行人员配备。这可以通过在11月和12月的非周一减少工作时间来抵消。
- en: We love heatmaps. They are underrated tools for representing time and are particularly
    useful when data can be represented with many members of a dimension.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们喜欢热力图。它们是代表时间的被低估的工具，并且在数据可以用一个维度的许多成员表示时特别有用。
- en: 'Comparing Values Year-to-Date: CaB Call Center Case Study'
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 年初至今比较值：CaB呼叫中心案例研究
- en: Now that the call center better understands the number of calls coming in, the
    staff would like to understand how this has changed over time. It’s currently
    April, and they want to see the current year represented in the analysis. How
    can you create a like-to-like comparison against prior years?
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 现在呼叫中心更好地理解了呼入呼叫量，工作人员希望了解这种变化随时间的变化。现在是四月，他们想要在分析中看到当前年份的数据。您如何创建与前几年相比的同类比较？
- en: For this case study, we will continue our analysis of call center data. In this
    final analysis, we are concerned with making appropriate comparisons across years.
    To do so, let’s go back to our plot of total calls per 15 minutes by year ([Figure 4-17](#total_calls_every_fifteen_minute-id00012)).
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个案例研究中，我们将继续分析呼叫中心的数据。在最终分析中，我们关心的是跨年适当的比较。为此，让我们回到我们按年每15分钟的总呼叫量绘制的图表（[图4-17](#total_calls_every_fifteen_minute-id00012)）。
- en: '![Total calls every 15 minutes of the day by year](Images/TAST_0417.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![每15分钟按年的总呼叫量](Images/TAST_0417.png)'
- en: Figure 4-17\. Total calls every 15 minutes of the day by year
  id: totrans-165
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-17。每15分钟按年的总呼叫量
- en: We see that calls are down, but that’s because we’re at a different point in
    time in 2020 than the other years. This is partly because our data is only through
    April 14, 2020\. What might be fairer is to compare calls for 2018, 2019, and
    2020 through April 14 instead of their overall totals.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到呼叫量有所下降，但这是因为2020年与其他年份处于不同的时间点。部分原因是我们的数据仅截至2020年4月14日。可能更公平的比较是将2018年、2019年和2020年截至4月14日的呼叫量进行比较，而不是它们的整体总数。
- en: 'This is a challenge we face quite often, regardless of data type: being able
    to compare similar time periods. So how can you solve the problem? With a well-designed
    date calculation.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们经常面临的挑战，无论数据类型如何：能够比较相似的时间段。那么你如何解决这个问题呢？通过一个设计良好的日期计算。
- en: The goal of the next two strategies is to create a calculation to compare the
    most recent date for the most recent year to the same date in prior years. For
    the next strategy, you will re-create a bar chart that shows progress to the total.
    This will allow your audience to keep an eye on overall values while simultaneously
    displaying comparable year-to-date values. Then, we’ll apply a filter to our line
    chart, allowing for a proper year-to-date comparison, rather than the visualization
    shown in [Figure 4-18](#visualizations_showing_total_calls_versu).
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来两个策略的目标是创建一个计算，将最近一年的最近日期与前几年的相同日期进行比较。对于下一个策略，您将重新创建一个显示进度到总体的柱状图。这将使您的观众能够在同时显示可比较的年初至今值的同时关注总体值。然后，我们将在我们的折线图上应用一个过滤器，以进行适当的年初至今比较，而不是在[图4-18](#visualizations_showing_total_calls_versu)中显示的可视化。
- en: '![Visualizations showing total calls versus the total for the two previous
    years (top), and total calls filtered to the same day of the year for three years
    (bottom)](Images/TAST_0418.png)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![显示总呼叫量与前两年总呼叫量的可视化（顶部），以及三年同一天的总呼叫量（底部）](Images/TAST_0418.png)'
- en: Figure 4-18\. Visualizations showing total calls versus the total for the two
    previous years (top), and total calls filtered to the same day of the year for
    three years (bottom)
  id: totrans-170
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-18。显示总呼叫量与前两年总呼叫量的可视化（顶部），以及三年同一天的总呼叫量（底部）
- en: 'Strategy: Show Progress to the Total by Using Two Bar Charts'
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用两个柱状图显示总体进展
- en: 'In this strategy, you’ll use a bar chart to show progress to the total:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您将使用柱状图来显示总体进展：
- en: 'Build the calculations as follows:'
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按以下方式构建计算：
- en: 'Normalize the dates to the same year by creating a calculation called `**[Start
    Date Time | Same Year]**`:'
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将日期归一化为同一年，创建名为`**[开始日期时间 | 同一年]**`的计算：
- en: '[PRE4]'
  id: totrans-175
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Create a second calculation called `**[Start Date Time | Same Year | TF]**`.
    This is a Boolean that detects whether a date is less than or equal to the day
    of the year for the most recent year:'
  id: totrans-176
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建名为`**[开始日期时间 | 同一年 | TF]**`的第二个计算。这是一个布尔值，用于检测一个日期是否小于或等于最近一年的同一天的年初至今：
- en: '[PRE5]'
  id: totrans-177
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Create a third calculation called `**[Total Calls | YTD]**`:'
  id: totrans-178
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建名为`**[总呼叫量 | 年初至今]**`的第三个计算：
- en: '[PRE6]'
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: This will return year-to-date values for each year.
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将为每一年返回年初至今的值。
- en: 'Build the visualization:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建可视化：
- en: Add [Number of Records] to Rows.
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[记录数量]添加到行。
- en: Add [Total Calls | YTD] to the right of [Number of Records] on the Rows shelf.
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在行架上的 [Number of Records] 右侧添加 [Total Calls | YTD]。
- en: Create a synchronized dual-axis chart.
  id: totrans-184
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个同步双轴图表。
- en: Add [Start Date Time] as a discrete year name to Columns and to Color.
  id: totrans-185
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [Start Date Time] 作为离散年名称添加到列和颜色中。
- en: Set the opacity on the `SUM([Number of Records])` Marks card to 40%.
  id: totrans-186
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 `SUM([Number of Records])` Marks 卡片上的不透明度设置为40%。
- en: Format your visualization by removing the column and row dividers, adding a
    darker column axis ruler and tick marks, styling your grid lines, showing just
    a left axis, and renaming the axis.
  id: totrans-187
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 格式化您的可视化图表，删除列和行分隔线，添加较暗的列轴标尺和刻度线，样式化网格线，仅显示左轴，并重命名轴。
- en: Show labels on the AGG(Total Calls | YTD) Marks card.
  id: totrans-188
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 AGG(Total Calls | YTD) Marks 卡片上显示标签。
- en: This results in the bar-on-bar chart in [Figure 4-19](#the_resulting_visualization_showing_the).
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将导致 [图 4-19](#the_resulting_visualization_showing_the) 中的柱状图。
- en: '![The resulting visualization showing the year-to-date progress relative to
    the current date for the most recent year](Images/TAST_0419.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![显示截至当前日期的年度进展的可视化结果](Images/TAST_0419.png)'
- en: Figure 4-19\. The resulting visualization showing the year-to-date progress
    relative to the current date for the most recent year
  id: totrans-191
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-19\. 显示最近一年的截至当前日期的年度进展的结果可视化。
- en: In this visualization, we embedded an `IF` statement inside the aggregation
    to do the filtering inside the calculation. This is something you should regularly
    do to allow a visualization to be dynamic. As the year continues, we’ll see the
    2020 bar increase. The 100% opaque bars in 2018 and 2019 will also continue to
    grow. These bars will eventually cap at the values shown in the 40% opaque bars
    shown on the same axis.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个可视化中，我们在聚合内嵌了一个 `IF` 语句，以在计算内执行过滤。这是您应该经常做的事情，以使可视化变得动态。随着年度的推移，我们将看到2020年的柱子增加。2018年和2019年的100%不透明柱子也将继续增长。这些柱子最终将在同一轴上显示的40%不透明柱子值处达到顶峰。
- en: Take a look back at [Figure 4-17](#total_calls_every_fifteen_minute-id00012).
    That visualization shows total calls for all dates in 2018 and 2019\. It also
    shows just dates through April 14 in 2020\. It’s not a like-for-like comparison.
    It would be great if we could compare these values.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 回顾 [图 4-17](#total_calls_every_fifteen_minute-id00012)。该可视化显示了2018年和2019年所有日期的总通话次数。它还仅显示了2020年4月14日之前的日期。这不是一种直接对比。如果我们能够比较这些值，那将是很好的。
- en: 'Strategy: Compare Similar Periods on a Line Chart'
  id: totrans-194
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：在线图上比较类似期间。
- en: 'Unlike the preceding strategy, where we used an `IF` statement to filter our
    data, we are going to explicitly place a calculation created on the Filters shelf.
    Our goal with this strategy is to use a visualization created earlier in the chapter
    and add a year-to-date filter:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 与之前的策略不同，我们在这里使用一个 `IF` 语句来过滤我们的数据，我们将明确地在筛选架上放置一个计算。我们这个策略的目标是使用本章早些时候创建的可视化，并添加一个年度筛选：
- en: Duplicate your final visualization from the earlier continuous data strategy
    shown in [Figure 4-13](#total_calls_every_fifteen_minutes_of_the).
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制您在前述连续数据策略中展示的最终可视化图，如 [图 4-13](#total_calls_every_fifteen_minutes_of_the)
    所示。
- en: Ensure that you have completed step 1a and step 1b from the preceding strategy.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您已完成上述策略的步骤1a和步骤1b。
- en: Edit Weekday of [Start Date Time] currently on Color by changing the date type
    to discrete year.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑 [Start Date Time] 的工作日，当前在颜色上的离散年日期类型。
- en: Add [Start Time Date | Same Year | TF] to the Filters shelf, select True, and
    click OK.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [Start Time Date | Same Year | TF] 添加到筛选架上，选择 True，并点击确定。
- en: Edit the axis and remove the axis title. [Figure 4-20](#a_visualization_showing_total_calls_ever)
    shows the result.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑轴并移除轴标题。[图 4-20](#a_visualization_showing_total_calls_ever) 显示了结果。
- en: '![A visualization showing total calls every 15 minutes of the day filtered
    to the same day of the year for 2018, 2019, and 2020](Images/TAST_0420.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![显示每天每 15 分钟总通话次数的可视化图，过滤到2018年、2019年和2020年的同一年同一天](Images/TAST_0420.png)'
- en: Figure 4-20\. A visualization showing total calls every 15 minutes of the day
    filtered to the same day of the year for 2018, 2019, and 2020
  id: totrans-202
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-20\. 显示2018年、2019年和2020年同一天过滤的每天每 15 分钟总通话次数的可视化图。
- en: When you place the results from our preceding two strategies next to each other,
    the end result is a miniature year-to-date dashboard that allows your audience
    to track total calls year to date as well as when the calls occurred ([Figure 4-21](#a_mini_dashboard_showing_the_same-day-of)).
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 当将我们前两个策略的结果并列时，最终结果是一个迷你的年度仪表板，允许您的受众追踪今年以来的总呼叫量，以及呼叫发生的时间（[图4-21](#a_mini_dashboard_showing_the_same-day-of)）。
- en: '![A mini dashboard showing the same-day-of-year comparisons of total calls
    and every 15 minutes of the day for 2018, 2019, and 2020](Images/TAST_0421.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![显示2018年、2019年和2020年每天同一天的总呼叫量及每15分钟的比较的迷你仪表板](Images/TAST_0421.png)'
- en: Figure 4-21\. A mini dashboard showing the same-day-of-year comparisons of total
    calls and every 15 minutes of the day for 2018, 2019, and 2020
  id: totrans-205
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-21。显示2018年、2019年和2020年每天同一天的总呼叫量及每15分钟的比较的迷你仪表板
- en: Automated Reports
  id: totrans-206
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自动化报告
- en: In this section, we are going to look at automating reports by using custom
    calculations. Whether it’s call center data, financial reports, or student enrollment
    numbers, we spend a lot of time developing tables that automatically update at
    the end of a month. While implementing these tables takes a little bit of time,
    the effort goes a long way in saving time. One of the most common actions we see
    from novice users of Tableau is manually updating data, then going to a dashboard
    and editing a filter to include updated data. The goal of the next strategy is
    to show how to automatically update a dashboard based on the data that is on the
    dashboard.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一节中，我们将讨论通过使用自定义计算来自动化报告。无论是呼叫中心数据、财务报告还是学生注册人数，我们花费大量时间开发在月底自动更新的表格。虽然实施这些表格需要一点时间，但这些努力可以大大节省时间。Tableau的新手用户最常见的一个行为是手动更新数据，然后转到仪表板并编辑过滤器以包含更新后的数据。下一个策略的目标是展示如何根据仪表板上的数据自动更新仪表板。
- en: 'Automating Reports for Month-over-Month and Year-over-Year Change: CaB Call
    Center Case Study'
  id: totrans-208
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 月对比月和年对比年变化的自动化报告：CaB呼叫中心案例研究
- en: Now that the CaB call center is starting to understand overall call volume by
    year, the employees want to take a closer look at how manufacturing cycles and
    large orders impact their satisfaction scores. They have requested a month-over-month
    view in addition to the year-over-year reporting already provided. This view will
    show more-granular data. How would you build a report that is still easy to understand?
    What steps would you take to automate this report?
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 现在CaB呼叫中心开始了解年度整体呼叫量，员工们希望更仔细地查看制造周期和大订单对他们的满意度评分的影响。他们要求增加一个月对比一个月的视图，除了已提供的年度对比报告。这个视图将显示更详细的数据。你将如何构建一个依然易于理解的报告？你将采取哪些步骤来自动化这个报告？
- en: Take a look at the table in [Figure 4-22](#average_calls_per_day_and_percentage_of).
    It shows the average calls per day as well as the percentage of change in calls
    month-over-month and year-over-year. The table shows data from March 2019 through
    March 2020\. We decided to not report anything for April because our data reports
    only through April 14\. When we have data reported for the final day of April,
    the report will automatically update so that the table shows metrics from April
    2019 through April 2020\. Additionally, this table shows a breakdown of calls
    by call reason and aggregates to totals.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 看看[图4-22](#average_calls_per_day_and_percentage_of)中的表格。它显示了每天平均呼叫量以及月对比月和年对比年的呼叫变化百分比。该表格显示了2019年3月至2020年3月的数据。我们决定不报告4月的任何内容，因为我们的数据报告仅到4月14日。当我们有4月最后一天的数据报告时，报告将自动更新，以便表格显示2019年4月至2020年4月的指标。此外，该表格显示了按呼叫原因分解的呼叫量，并进行总计汇总。
- en: '![Average calls per day and percentage of change in calls, month-over-month
    and year-over-year, March 2019 through March 2020](Images/TAST_0422.png)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![2019年3月至2020年3月每天平均呼叫量及呼叫变化百分比，月对比月和年对比年](Images/TAST_0422.png)'
- en: Figure 4-22\. Average calls per day and percentage of change in calls, month-over-month
    and year-over-year, March 2019 through March 2020
  id: totrans-212
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-22。2019年3月至2020年3月每天平均呼叫量及呼叫变化百分比，月对比月和年对比年
- en: 'Strategy: Automated Rolling Table'
  id: totrans-213
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：自动滚动表
- en: 'In this strategy, you will re-create the table shown in [Figure 4-22](#average_calls_per_day_and_percentage_of).
    This will always show the last 13 fully completed months based on the date with
    the last entries:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您将重新创建[图4-22](#average_calls_per_day_and_percentage_of)中显示的表格。这将始终显示基于最后条目日期的最后13个完整的月份：
- en: 'Build the base table for this visualization. Create the metric for our table,
    `**[Calls/Day]**`:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为此可视化构建基本表格。为我们的表格创建指标，`**[Calls/Day]**`：
- en: '[PRE7]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Start by adding [Calls/Day] to Text. Add [Call Reason] to Columns and sort the
    dimension in descending order by calls per day. Create a new custom date called
    `**[Start Date Time | Month]**` that returns monthly date values. Place this as
    a discrete value on Columns. Add column totals and place them at the top, as shown
    in [Figure 4-23](#to_add_totals_to_the_top_of_the_columnsc).
  id: totrans-217
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[Calls/Day]添加到文本中。将[Call Reason]添加到列中，并按每天呼叫次数降序排列维度。创建一个名为`**[Start Date Time
    | Month]**`的新自定义日期，返回月度日期值。将其作为离散值放置在列中。添加列总计，并将它们放置在顶部，如[图 4-23](#to_add_totals_to_the_top_of_the_columnsc)所示。
- en: '![To add totals to the top of the columns, choose Analysis → Totals and then
    select Show Column Grand Totals and Column Totals to Top](Images/TAST_0423.png)'
  id: totrans-218
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![要将总计添加到列的顶部，请选择分析 → 总计，然后选择显示列总计和列总计到顶部](Images/TAST_0423.png)'
- en: Figure 4-23\. To add totals to the top of the columns, choose Analysis → Totals
    and then select Show Column Grand Totals and Column Totals to Top
  id: totrans-219
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-23\. 要将总计添加到列的顶部，请选择分析 → 总计，然后选择显示列总计和列总计到顶部
- en: Format your table so that only row dividers exist, as shown in [Figure 4-24](#the_table_showing_calls_per_day_by_call).
    Add band color to your totals only. This will serve as the base for your month-over-month
    calculation, your year-over-year calculation, and the automations you will create.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 格式化您的表格，以便仅存在行分隔符，如[图 4-24](#the_table_showing_calls_per_day_by_call)所示。仅为您的总计添加带色块。这将成为您的月对月计算、年对年计算以及将要创建的自动化的基础。
- en: '![The table showing calls per day by call reason and month](Images/TAST_0424.png)'
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![表格显示每天按呼叫原因和月份分类的呼叫次数](Images/TAST_0424.png)'
- en: Figure 4-24\. The table showing calls per day by call reason and month
  id: totrans-222
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-24\. 表格显示每天的呼叫次数按呼叫原因和月份分类
- en: 'Create the month-over-month calculation. This is done with a table calculation.
    Call this new calculation `**[Calls/Day | % Change 1]**`:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建月对月计算。这是通过表格计算完成的。将此新计算命名为`**[Calls/Day | % Change 1]**`：
- en: '[PRE8]'
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'This calculation creates a percent change based on the previous value, in this
    case the previous month. Because a business may be seasonal (and many are), it’s
    often better to compare values to the previous year. To do this, create a new
    calculation called `**[Calls/Day | % Change 12]**`:'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此计算基于前值创建百分比变化，即前一个月的值。因为企业可能是季节性的（许多企业都是如此），通常最好将值与前一年进行比较。要执行此操作，请创建一个名为`**[Calls/Day
    | % Change 12]**`的新计算：
- en: '[PRE9]'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'You’ll notice that the calculation is just slightly different: –1 has been
    changed to –12\. Double-click [Calls/Day | % Change 1] and [Calls/Day | % Change
    12]. This converts the table to include [Measure Names], and the text is now [Measure
    Values]. The table calculations in [Calls/Day | % Change 1] and [Calls/Day | %
    Change 12] need updating, but you can wait until we have all the components of
    the visualization on the view.'
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您会注意到，计算略有不同：–1已更改为–12\. 双击[Calls/Day | % Change 1]和[Calls/Day | % Change 12]。这将转换表格以包括[测量名称]，而文本现在为[测量值]。需要更新[Calls/Day
    | % Change 1]和[Calls/Day | % Change 12]中的表格计算，但您可以等到所有视图组件都准备好后再执行此操作。
- en: 'Let’s now move on to showing only full months. Start by calculating the maximum
    date of [Start Date Time] by writing a calculation called `**[Start Date Time
    | Max Date]**`:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们只展示完整的月份。通过编写一个名为`**[Start Date Time | Max Date]**`的计算来计算[开始日期时间]的最大日期：
- en: '[PRE10]'
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Here we use an LOD calculation to calculate the maximum date in our dataset.
    We’ll monitor this date so we know when to update our table. This will allow you
    to calculate relevant time periods dynamically. You just need to find the start
    and end points of your dynamic table. Let’s first calculate the last day of the
    last full month and call the calculation `**[Last Day of Last Full Month]**`:'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，我们使用一个LOD计算来计算数据集中的最大日期。我们将监视此日期，以便知道何时更新我们的表格。这将允许您动态计算相关的时间段。您只需找到动态表格的起点和终点。首先计算上个完整月份的最后一天，并将计算命名为`**[Last
    Day of Last Full Month]**`：
- en: '[PRE11]'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Use this calculation to create a Boolean to filter data in the current month—which
    is not yet complete. Create a calculation called `**[Start Date Time | Full Months]**`:'
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用此计算来创建一个布尔值以过滤当前月份的数据——当前月份尚未完成。创建一个名为`**[Start Date Time | Full Months]**`的计算：
- en: '[PRE12]'
  id: totrans-233
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Add this calculation to Filters and select True.
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将此计算添加到筛选器中，并选择True。
- en: 'Filter this visualization down to the most recent 13 complete months. Create
    a new calculation called `**[Start Date Time | Last 13 Months]**`:'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将此可视化结果筛选至最近的13个完整月。创建一个名为`**[开始日期时间 | 最近13个月]**`的新计算：
- en: '[PRE13]'
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Place this calculation to the left of [Start Date Time | Month]. Right-click
    the False header and select Hide. Then deselect Show Header from the same menu
    ([Figure 4-25](#hiding_the_header_by_deselecting_show_he)).
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将此计算放置在[开始日期时间 | 月]的左侧。右键单击假标题并选择隐藏。然后从同一菜单中取消选择显示标题（[图 4-25](#通过取消选择显示_he隐藏标题)）。
- en: '![Hiding the header by deselecting Show Header](Images/TAST_0425.png)'
  id: totrans-238
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![通过取消选择显示标题隐藏标题](Images/TAST_0425.png)'
- en: Figure 4-25\. Hiding the header by deselecting Show Header
  id: totrans-239
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-25\. 通过取消选择显示标题隐藏标题
- en: Finalize the table calculations by editing the [Calls/Day | % Change 1] and
    [Calls/Day | % Change 12] table calculations in the [Measure Values] Marks card
    so that only [Call Reason] is deselected, as shown in [Figure 4-26](#the_table_calculation_settings_for_left).
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过编辑[每天呼叫数 | %变化1]和[每天呼叫数 | %变化12]表计算设置在[度量值]标记卡中，只取消选择[呼叫原因]，如[图 4-26](#左侧表计算设置)所示，完成表格计算。
- en: '![The table calculation settings for [Calls/Day | % Change 1] and [Calls/Day
    | % Change 12]](Images/TAST_0426.png)'
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![[每天呼叫数 | %变化1]和[每天呼叫数 | %变化12]的表计算设置](Images/TAST_0426.png)'
- en: Figure 4-26\. The table calculation settings for [Calls/Day | % Change 1] and
    [Calls/Day | % Change 12]
  id: totrans-242
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-26\. [每天呼叫数 | %变化1]和[每天呼叫数 | %变化12]的表计算设置
- en: Be sure to format both month-over-month and year-over-year calculations as percentages.
    Finally, right-click and edit the alias ([Figure 4-27](#right-click_left_square_bracketmeasure_n)).
    [Change Calls/Day | % Change 1] to MoM (month-over-month) and change [Calls/Day
    | % Change 12] to YoY (year-over-year).
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保将月度同比和年度同比计算都格式化为百分比。最后，右键单击并编辑别名（[图 4-27](#右键单击左方括号度量_n)）。将[每天呼叫数 | %变化1]更改为MoM（月同比），将[每天呼叫数
    | %变化12]更改为YoY（年同比）。
- en: '![Right-click [Measure Names] and select Edit Alias](Images/TAST_0427.png)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![右键单击[度量名称]，选择编辑别名](Images/TAST_0427.png)'
- en: Figure 4-27\. Right-click [Measure Names] and select Edit Alias
  id: totrans-245
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-27\. 右键单击[度量名称]，选择编辑别名
- en: The result of all this work (shown previously in [Figure 4-22](#average_calls_per_day_and_percentage_of))
    is a humble table that provides a lot of great insights and is automatically updated
    each month.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些工作的结果（如前面显示的[图 4-22](#平均每天呼叫量和百分比)）是一个简单的表格，提供了许多重要见解，并且每月自动更新。
- en: For the most part, we as developers spend very little time thinking about what
    a year, month, or week even means. We just assume that a year goes from January
    1 to December 31\. But when it comes to organizations, a fiscal year is defined
    in many ways. This next section provides a brief overview of working with fiscal
    dates in Tableau.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数时候，作为开发人员，我们几乎不考虑一年、一个月或甚至一周的定义是什么意思。我们只是假设一年从1月1日到12月31日。但在组织中，财政年度可以用许多方式定义。下一节将简要介绍在Tableau中处理财政日期的工作原理。
- en: Nonstandard Calendars
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 非标准日历
- en: A *fiscal year* can start at any time; it can be January 1, June 5, or even
    the fifth Monday of the standard calendar year. It’s all relative. Tableau provides
    some flexibility.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: '*财政年度*可以在任何时间开始；可以是1月1日、6月5日，甚至是标准日历年的第五个星期一。这完全取决于具体情况。Tableau提供了一些灵活性。'
- en: If your calendar year starts at the beginning of a month, you can standardize
    this by right-clicking and then navigating to Default Properties → Fiscal Year
    Start → Month of Fiscal Year ([Figure 4-28](#right-click_a_date_to_change_the_default)).
    This simplifies the hierarchy associated with that particular date measure.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的日历年从月初开始，可以通过右键单击，然后导航到默认属性 → 财年起始日 → 财年月份（[图 4-28](#右键单击要更改默认值的日期)）。这简化了与该特定日期度量相关联的层次结构。
- en: '![Right-click a date to change the default properties of the fiscal year start.
    In this example, the fiscal year start is set to June.](Images/TAST_0428.png)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![右键单击日期以更改财年起始日的默认属性。在此示例中，财年起始日设为六月。](Images/TAST_0428.png)'
- en: Figure 4-28\. Right-click a date to change the default properties of the fiscal
    year start (in this example, the fiscal year start is set to June)
  id: totrans-252
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-28\. 右键单击日期以更改财年起始日的默认属性（在此示例中，财年起始日设为六月）
- en: 'Some organizations work with the standard Gregorian calendar as their fiscal
    year: January 1 thru December 31\. Other organizations, however, start the fiscal
    year or month on the first day of the week that month starts. So if January 1
    is on a Tuesday, the fiscal year would start on December 30\. This calendar type
    is called *ISO-8601*. While the name is funky, just know that the calendar is
    week-based. You can specify the calendar type by right-clicking the date value
    on your view and selecting ISO-8601 Week-Based. (We’ll just call it an *ISO calendar*
    in this section.)'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 一些组织使用标准的格里高利日历作为其财政年度：从1月1日至12月31日。然而，其他组织从每月开始的第一天开始财政年度或月份。因此，如果1月1日是星期二，则财政年度将从12月30日开始。这种日历类型称为*ISO-8601*。虽然名字很奇怪，但请知道该日历基于周。您可以通过右键单击视图中的日期值并选择ISO-8601周为基础来指定日历类型。（在本节中我们称之为*ISO日历*。）
- en: In Figures [4-29](#data_in_a_standard_calendar) and [4-30](#data_in_an_iso_calendar),
    you can see how data from a standard calendar can differ ever so slightly from
    an ISO calendar.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 在图4-29（#data_in_a_standard_calendar）和图4-30（#data_in_an_iso_calendar）中，您可以看到标准日历数据如何与ISO日历略有不同。
- en: '![Data in a standard calendar](Images/TAST_0429.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![标准日历中的数据](Images/TAST_0429.png)'
- en: Figure 4-29\. Data in a standard calendar
  id: totrans-256
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-29\. 标准日历中的数据
- en: '![Data in an ISO calendar](Images/TAST_0430.png)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![ISO日历中的数据](Images/TAST_0430.png)'
- en: Figure 4-30\. Data in an ISO calendar
  id: totrans-258
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-30\. ISO日历中的数据
- en: 'Strategy: Build a Monthly Bar Chart with a June 1 Fiscal Year Start'
  id: totrans-259
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：构建一个以六月1日为财政年度起点的月度柱状图。
- en: 'Let’s take a second to build a visualization with a June fiscal start. To keep
    it simple, imagine you are building a bar chart that shows total sales by month
    and fiscal year. You will replicate [Figure 4-31](#sales_by_monthcomma_colored_by_fiscal_ye):'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们花点时间来建立一个以六月为财政起点的可视化。为了简单起见，想象你正在构建一个柱状图，显示每月和财政年度的总销售额。您将复制[Figure 4-31](#sales_by_monthcomma_colored_by_fiscal_ye)：
- en: Connect to the Sample – Superstore dataset.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 连接到样本 - 超级商店数据集。
- en: Duplicate the [Order Date] field and call it `**[Order Date | June]**`.
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制[Order Date]字段，并将其命名为`**[Order Date | June]**`。
- en: Right-click [Order Date | June] and change the default fiscal year start to
    June.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击[Order Date | June]并将默认财政年度开始日期更改为六月。
- en: Add [Order Date | June] as a continuous data value by month to Columns.
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Order Date | June]添加为按月连续数据值到列中。
- en: Add `SUM([Sales])` to Rows.
  id: totrans-265
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将`SUM([Sales])`添加到行中。
- en: Add YEAR([Order Date | June]) to Color.
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将年份添加到颜色中（[Order Date | June]）。
- en: Change the mark type to Bar.
  id: totrans-267
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为柱形图。
- en: Right-click the September 2016 bar and add an annotation to the mark, displaying
    the date and the total sales.
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击2016年9月柱形图，并向标记添加注释，显示日期和总销售额。
- en: '![Sales by month, colored by fiscal year, using a June start to the fiscal
    year](Images/TAST_0431.png)'
  id: totrans-269
  prefs: []
  type: TYPE_IMG
  zh: '![按月销售，按财政年份着色，使用六月开始的财政年度](Images/TAST_0431.png)'
- en: Figure 4-31\. Sales by month, colored by fiscal year, using a June start to
    the fiscal year
  id: totrans-270
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图4-31\. 按月销售，按财政年份着色，使用六月开始的财政年度
- en: 'Visualizing the 4-5-4 Calendar: Office Essentials Case Study'
  id: totrans-271
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 可视化4-5-4日历：Office Essentials案例研究
- en: Our large retail store, OE, has relied on data metrics tied to a calendar year.
    The company would like to redesign some of its standard reports to now follow
    a 4-5-4 calendar. How would you complete this task?
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的大型零售店OE一直依赖与日历年相关的数据指标。该公司希望重新设计一些标准报告，现在采用4-5-4日历。您如何完成此任务？
- en: 'Retailers often use the *4-5-4 calendar*. This calendar allows them to compare
    sales by dividing the year into months based on a repeating four weeks, five weeks,
    and four weeks. Retailers use this calendar because holidays tend to line up,
    and because the same number of Saturdays and Sundays are displayed in comparable
    months. The 4-5-4 sales calendar is not perfect: because the calendar is based
    on 52 weeks, or 364 days, this leaves an extra day each year to be accounted for.
    To adjust for this, a week is added to the fiscal calendar every five to six years.
    These occurred in 2012 and 2017, and will happen again in 2023.'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 零售商通常使用*4-5-4日历*。这种日历允许他们通过将一年分为基于重复的四周、五周和四周的月份来比较销售额。零售商使用此日历是因为假期往往重叠，并且相似月份中显示相同数量的星期六和星期日。4-5-4销售日历并非完美：因为该日历基于52周或364天，这每年多余一天需要考虑。为了调整此问题，每五到六年将向财政日历添加一周。这发生在2012年和2017年，并将在2023年再次发生。
- en: The 4-5-4 calendar year varies from year to year. When February 1 occurs on
    Thursday, Friday, or Saturday, the calendar year starts the Sunday after February
    1\. If February 1 occurs on Sunday, Monday, Tuesday, or Wednesday, the calendar
    year starts the Sunday of the week of February 1.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 4-5-4 日历年随年而异。当二月一日是在星期四、星期五或星期六时，日历年在二月一日后的第一个星期天开始。如果二月一日是在星期天、星期一、星期二或星期三，则日历年在二月一日所在周的星期天开始。
- en: The next strategy is focused on building date components for the 4-5-4 retail
    calendar. These include week of the year, month of the year, quarter of the year,
    and week of the quarter. After you build the components, you will build a visualization
    highlighting some of those calculations.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个策略专注于构建 4-5-4 零售日历的日期组件。这些组件包括年度周数、年度月份、年度季度以及季度周数。在构建完组件后，将建立可视化突出显示其中一些计算。
- en: 'Strategy: Build a Bar Chart Using the 4-5-4 Retail Calendar'
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用 4-5-4 零售日历构建条形图
- en: 'Create a calculation that calculates February 1\. Call the calculation `**[Feb
    1]**`:'
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个计算，计算二月一日。将此计算命名为`**[Feb 1]**`：
- en: '[PRE14]'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Calculate the start of the calendar year based on whether February 1 is after
    Wednesday in the week. Name the calculation `**[454 Year Start]**`:'
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基于二月一日是否在周三之后计算日历年的开始日期。将此计算命名为`**[454 Year Start]**`：
- en: '[PRE15]'
  id: totrans-280
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Determine the start of the 4-5-4 calendar year for the prior year by calculating
    February 1 for the prior year. Name the calculation `**[Feb 1 | PY]**`:'
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定去年的 4-5-4 日历年的开始日期，计算去年的二月一日。将此计算命名为`**[Feb 1 | PY]**`：
- en: '[PRE16]'
  id: totrans-282
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Calculate the start of the previous calendar year. We will use this calculation
    with the current year values to determine the week number of the calendar year.
    Label the calculation `**[454 Prior Year Start]**`:'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 计算前一个日历年的开始日期。我们将使用此计算与当前年份的值来确定日历年的周数。将此计算标记为`**[454 Prior Year Start]**`：
- en: '[PRE17]'
  id: totrans-284
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Parse the retail weeks of the year:'
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 解析年度零售周：
- en: '[PRE18]'
  id: totrans-286
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Now that you have the week, you can create components like Retail Quarter,
    Retail Month of Quarter, Retail Week of Quarter, Retail Month, and Retail Week
    of Month. Build out each of these calculations:'
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在您有了这周的数据，您可以创建像零售季度、零售季度月、零售季度周、零售月和零售月周等组件。逐步构建每一个这些计算：
- en: '[PRE19]'
  id: totrans-288
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Having all of these calculations is extremely useful for any visualization using
    a retail calendar. Let’s create a visualization that we like to use to showcase
    the retail calendar.
  id: totrans-289
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 拥有所有这些计算对于使用零售日历的任何可视化都非常有用。让我们创建一个我们喜欢用来展示零售日历的可视化。
- en: Add a discrete dimension of [Retail Month of Quarter] to Columns. Add a discrete
    dimension of [Retail Quarter] to Rows. Add [Retail Week of Month] as a continuous
    dimension to Rows. Add 0.0 as an ad hoc continuous dimension to the right of [Retail
    Week of Month]. Create a synchronized dual axis.
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[零售季度月]作为离散维度添加到列中。将[零售季度]作为离散维度添加到行中。将[零售月周]作为连续维度添加到行中。在[零售月周]右侧创建一个临时的连续维度0.0。创建一个同步双轴。
- en: 'Add details as follows:'
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加如下详细信息：
- en: Set the Marks card of [Retail Week of Month] to a bar chart. Add `[Profit Ratio]
    * (SUM([Profit])/SUM([Sales]))` to Color. Add `SUM([Sales])` and the continuous
    dimension of [Retail Week] to Text. Format the text so it reads as shown in [Figure 4-32](#text_labels_for_the_four-five-four_bar_c).
  id: totrans-292
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[零售月周]的标记卡设置为条形图。将`[Profit Ratio] * (SUM([Profit])/SUM([Sales]))`添加到颜色中。将`SUM([Sales])`和[零售周]的连续维度添加到文本中。格式化文本，使其显示如[图 4-32](#text_labels_for_the_four-five-four_bar_c)所示。
- en: '![Text labels for the 4-5-4 bar chart](Images/TAST_0432.png)'
  id: totrans-293
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![4-5-4 条形图的文本标签](Images/TAST_0432.png)'
- en: Figure 4-32\. Text labels for the 4-5-4 bar chart
  id: totrans-294
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-32\. 4-5-4 条形图的文本标签
- en: On the Marks card of the 0.0 value, set the mark type to Text. Add [Retail Month]
    to Text.
  id: totrans-295
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在标记卡的0.0值上，将标记类型设置为文本。将[零售月]添加到文本中。
- en: 'For the last part, we need to place a value on Columns that will control both
    axes. Create a calculation called `**[bar]**` and add it to Columns:'
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于最后一部分，我们需要在控制两个轴的列上放置一个值。创建名为`**[bar]**`的计算并将其添加到列中：
- en: '[PRE20]'
  id: totrans-297
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: This calculation will show sales as a percentage of the maximum sales for a
    retail week for the bars and will place a label of each state at 0.9\. Change
    the table calculation and select all values, as shown in [Figure 4-33](#table_calculation_settings_for_the_four).
  id: totrans-298
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此计算将以零售周的最大销售额百分比显示条形图，并将每个州的标签放置在0.9上。更改表计算并选择所有值，如[图 4-33](#table_calculation_settings_for_the_four)所示。
- en: '![Table calculation settings for the 4-5-4 bar chart](Images/TAST_0433b.png)'
  id: totrans-299
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![4-5-4 条形图的表计算设置](Images/TAST_0433b.png)'
- en: Figure 4-33\. Table calculation settings for the 4-5-4 bar chart
  id: totrans-300
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-33\. 4-5-4条形图的表计算设置
- en: Set the bar axis range between 0 and 1.8, and then hide the axis. Reverse the
    axis of the [Retail Week of Month] field and then hide the axis.
  id: totrans-301
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置条形轴范围在0到1.8之间，然后隐藏轴。反转[零售月的周]字段的轴，然后隐藏轴。
- en: Finally, format the chart according to your design standards.
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，根据您的设计标准格式化图表。
- en: The resulting visualization is shown in [Figure 4-34](#bar_chart_showing_sales_and_profit_by_fo).
  id: totrans-303
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 展示的结果可见于[图 4-34](#bar_chart_showing_sales_and_profit_by_fo)。
- en: '![Bar chart showing sales and profit by 4-5-4 retail month and week](Images/TAST_0434.png)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
  zh: '![显示按4-5-4零售月和周销售和利润的条形图](Images/TAST_0434.png)'
- en: Figure 4-34\. Bar chart showing sales and profit by 4-5-4 retail month and week
  id: totrans-305
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 4-34\. 按照4-5-4零售月和周显示销售和利润的条形图
- en: Conclusion
  id: totrans-306
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: In this chapter, we scratched the tip of the dates-and-times iceberg. Because
    dates and times are naturally hierarchical, and because dates and times can be
    treated as either dimensions or measures, a single date field has a nearly unlimited
    number of combination options.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们只是浅尝了日期和时间的冰山一角。因为日期和时间具有自然的层次结构，并且可以被视为维度或度量，一个单独的日期字段有几乎无限的组合选项。
- en: In the chapter opening, we discussed the importance of understanding the difference
    between a date *part* and a date *value*. With date parts, Tableau returns a single
    component of a date or time field. The underlying calculation for date parts is
    the `DATEPART()` function.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 在章节开头，我们讨论了理解日期*部分*和日期*值*之间差异的重要性。使用日期部分，Tableau返回日期或时间字段的单个组成部分。日期部分的基础计算是`DATEPART()`函数。
- en: In the first two strategies, we showcased how to plot parts of a date. Combining
    multiple date parts (in this case, hour and minute) can lead to too many discrete
    values being shown.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 在前两种策略中，我们展示了如何绘制日期的部分。组合多个日期部分（在这种情况下是小时和分钟）可能导致显示过多的离散值。
- en: With date values, Tableau returns a date rounded down to the specified part
    of the date. This means a date part of Month will return the month name or number,
    while a date value of Month will return the year and month combination. The underlying
    calculation for a date value is the `DATETRUNC()` function.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 使用日期值，Tableau返回截断到指定日期部分的日期。这意味着月份的日期部分将返回月份的名称或数字，而月份的日期值将返回年份和月份的组合。日期值的基础计算是`DATETRUNC()`函数。
- en: Tableau defaults date parts to dimensions, and date values to continuous values.
    While those are the default values, we can convert either to discrete or continuous
    values. Our selection of discrete or continuous values affects what our axes might
    look like and therefore the type of chart we are most likely to select.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau默认将日期部分设置为维度，将日期值设置为连续值。虽然这些是默认值，但我们可以将其转换为离散或连续值。我们选择离散或连续值会影响我们的坐标轴可能的外观，从而影响我们最可能选择的图表类型。
- en: The final fundamental we discussed was Tableau making a date hierarchy available
    to your audience by default. If you are looking to limit the availability of this
    hierarchy, you must use a custom date.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个我们讨论的基础是Tableau默认提供日期层次结构给您的观众。如果您希望限制此层次结构的可用性，则必须使用自定义日期。
- en: For most audiences, working with a continuous axis is more intuitive because
    that’s how people think about time! This lends itself to the selection of line
    charts. One challenge of working with dates is creating continuous plots of a
    single date part. We tackled this challenge of creating continuous axes. In each
    of these challenges, we moved from showing data rounded to the nearest second
    of the day, to the nearest 15 seconds, and to the nearest 15 minutes.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数观众来说，使用连续轴更直观，因为这符合人们对时间的思考方式！这使得线形图成为首选。处理日期的一个挑战是创建单个日期部分的连续图。我们解决了创建连续轴的这一挑战。在这些挑战中，我们从展示数据精确到最接近一天内的秒，到最接近15秒，再到最接近15分钟。
- en: While line plots—and occasionally bar charts—are two common ways in which date
    and time values are visualized, we like to use heatmaps (which only Tableau calls
    *highlight tables*). Line charts provide a limited ability to describe more than
    five lines—any more, and it becomes difficult, even for the most data-savvy audience,
    to interpret patterns. One simple alternative to line charts is heatmaps. We highlighted
    the flexibility of this chart type when working with date and time fields.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然线形图和偶尔的条形图是展示日期和时间值的两种常见方式，我们喜欢使用热力图（仅 Tableau 称为 *高亮表格*）。线形图在描述超过五条线时能力有限——对于大多数数据精通的受众来说，即使是解释模式也变得困难。线形图的一个简单替代方案是热力图。我们强调了在处理日期和时间字段时，这种图表类型的灵活性。
- en: Another regular challenge when working with dates is comparing previous years
    to the current year to date. We showed you a calculation you can use to calculate
    the year-to-date values of any date. This can be used inside aggregate calculations
    and can be used to create a chart that shows progress to a total. We extended
    this same year-to-date calculation to adjust line charts to make fair comparisons.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 处理日期时的另一个常见挑战是将前年与本年到目前为止进行比较。我们向您展示了一个可以用来计算任意日期的年初至今值的计算公式。这可以用于聚合计算中，并且可以用来创建显示达到总体进度的图表。我们扩展了相同的年初至今计算方法以调整线形图，以进行公平比较。
- en: We also looked at how to create automated reports by using both LOD and table
    calculations. By using discrete date values and the `LAST()` function, you can
    easily show the last *N* months. We also showcased how you can use a table calculation
    to complete month-over-month and year-over-year calculations.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还研究了如何利用 LOD 和表计算创建自动化报告。通过使用离散日期值和 `LAST()` 函数，您可以轻松显示最近 *N* 个月的数据。我们还展示了如何使用表计算完成月对月和年对年的计算。
- en: We wrapped up the chapter talking about non-Gregorian calendars. Gregorian calendars
    are the standard, but some organizations have fiscal years that start at different
    months other than January. We even went beyond the traditional calendar and discussed
    the 4-5-4 calendar, which is common with retail and consumer-packaged goods companies.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在章节中讨论了非公历日历。公历是标准，但有些组织的财政年度起始月份不同于一月。我们甚至超越传统日历，讨论了 4-5-4 日历，这在零售和消费品公司中很常见。
- en: The next chapter covers key performance indicators (KPIs). KPIs are standalone
    metrics that your audience can use to drive day-to-day operations or guide strategic
    decisions. While KPIs are focused on the metric itself, they are often defined
    by a specific time period. If you become fluent with date fields in Tableau, creating
    dynamic, automated KPIs will come naturally.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将涵盖关键绩效指标（KPI）。KPI 是独立的度量标准，您的受众可以用来推动日常运营或指导战略决策。虽然 KPI 侧重于度量本身，但通常由特定时间段定义。如果您熟练掌握
    Tableau 中的日期字段，创建动态自动化的 KPI 将变得自然而然。
