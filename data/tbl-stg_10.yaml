- en: Chapter 10\. Advanced Data Modeling
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章。高级数据建模
- en: 'Sometimes you want to make a chart type that’s just out of grasp for out-of-the-box
    Tableau. Don’t fret: you can make any chart in Tableau with a little patience
    and some out-of-the-box thinking.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 有时候你想要制作一种图表类型，这在 Tableau 的默认功能中却难以实现。不要担心：只要有耐心和一些超越常规的思考，你可以在 Tableau 中制作任何类型的图表。
- en: In this chapter, you will tackle different approaches to data modeling in Tableau
    Desktop. When we use the term *data modeling*, we are referring to the inclusion
    of additional data that might not be necessary for standard visualizations. We
    will discuss several techniques to data modeling, including using table calculations,
    blends, unions, and joins. Each technique has a different time and place. If you
    aren’t yet familiar with these techniques, no worries; we will articulate these
    differences in this chapter’s scenarios.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将探讨 Tableau Desktop 中数据建模的不同方法。当我们使用术语*数据建模*时，我们指的是包括可能不适用于标准可视化的额外数据。我们将讨论几种数据建模技术，包括使用表计算、混合、联合和连接。每种技术都有其适用的时机和场合。如果你对这些技术还不熟悉，不用担心；我们将在本章的案例中详细阐述这些差异。
- en: In every case, you are trading dashboard performance for dashboard design. Some
    of these trade-offs will not compromise speed. Others can slow things significantly,
    particularly when you’re adding additional marks to your visualizations or rows
    and columns to your datasets.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在每种情况下，你都在权衡仪表板的性能和设计。有些权衡不会影响速度。其他情况下，特别是当你向可视化添加额外标记或向数据集添加行列时，可能会显著降低速度。
- en: Before you dive in deep, we’ll lay the foundations for understanding with some
    practical examples.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在你深入研究之前，我们将通过一些实际示例为你奠定理解的基础。
- en: All but two of the strategies use Tableau’s Sample – Superstore dataset. The
    other examples use sales pipeline data and a modified version of the superstore
    dataset. This chapter won’t have a single-threaded story for the use cases. Each
    is independent. As a result, we’ll set up the scenario in each of the strategies.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 除了两种策略之外，其余都使用了 Tableau 的 Sample – Superstore 数据集。其他示例使用了销售管道数据和超市数据集的修改版本。本章不会为使用情况提供单一的线性故事。每种情况都是独立的。因此，我们将在每种策略中设定场景。
- en: Data Modeling
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据建模
- en: Data modeling might be the most advanced concept in Tableau. *Data modeling*—sometimes
    called *data densification* (which is a subset)—is a technique for increasing
    the amount of data showing in your visualization.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 数据建模可能是 Tableau 中最高级的概念。*数据建模*——有时也称为*数据密集化*（这是其中的一个子集）——是一种增加可视化中显示数据量的技术。
- en: Data densification is most commonly used for creating curved charts, but there
    are many other practical uses for data modeling. We will discuss only a handful
    of possibilities. The most common type of data modeling is filling in potentially
    missing values (*domain padding*). It’s so common that you’ve already used this
    method in [Chapter 6](ch06.xhtml#building_impactful_tables)! In addition to filling
    in missing values, you can also add more values to the beginning or end of a series
    (*domain completion*). Both domain completion and domain padding do not have to
    be difficult; in fact, in our first strategy we’ll show you how to do both.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 数据密集化最常用于创建曲线图，但数据建模还有许多其他实际用途。我们只会讨论其中几种可能性。最常见的数据建模类型是填充潜在缺失值（*域填充*）。这种方法如此常见，以至于你在[第6章](ch06.xhtml#building_impactful_tables)中已经使用过它！除了填充缺失值，你还可以在系列的开头或结尾添加更多数值（*域完成*）。域填充和域完成都不必复杂；实际上，在我们的第一个策略中，我们将向你展示如何同时进行这两种操作。
- en: As you advance your skills, you will find yourself trying to develop unique
    solutions that reach beyond the base capabilities of Tableau Desktop. Remember,
    at its core, any visualization is just a compilation of dots, lines, and polygons.
    If you can’t make a base chart in Tableau, you can use data modeling to redefine
    your visualization.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 随着技能的提升，你会尝试开发超越 Tableau Desktop 基本功能的独特解决方案。记住，任何可视化本质上都只是点、线和多边形的组合。如果你无法在
    Tableau 中制作基本图表，你可以使用数据建模重新定义你的可视化。
- en: 'We can execute data modeling in at least three ways: unioning data sources,
    joining data sources, or bin/range densification. For most visualizations, you
    can use any of these methods. Each comes with trade-offs, but all add more data
    to your existing data sources to create your visualization.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过至少三种方式执行数据建模：联合数据源、连接数据源或进行分桶/范围密集化。对于大多数可视化，你可以使用其中任何一种方法。每种方法都有其权衡，但都会向现有数据源添加更多数据以创建你的可视化。
- en: The most simplistic approach to data modeling is *unioning*, or appending, a
    data source to itself. This duplicates the data you are working with—all of the
    data—but the process of unioning data to itself is the easiest of all the approaches.
    For instance, if you want to double your data and are working with the Sample
    – Superstore dataset, you will just union orders together. The downfall of this
    method is that you have to load all the data at least a second time for the union.
    If you are working with lots of data (a million records or more), this is probably
    not the best method to use.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 数据建模的最简单方法是*union*或附加数据源到其自身。这样可以复制你正在处理的所有数据，但将数据源附加到自身的过程是所有方法中最简单的。例如，如果你想要将数据加倍，并且正在使用Sample
    – Superstore数据集，你只需联合订单即可。这种方法的缺点是你至少需要再次加载所有数据进行联合。如果你处理大量数据（一百万条或更多记录），这可能不是最好的方法。
- en: The second approach is to simply take the data source of interest and join the
    data with a placeholder dataset. This placeholder dataset is often straightforward—usually
    a single column with rows counting up from 1 to whatever integer is necessary
    for analysis. This join will also effectively double your data. However, by using
    an extract, Tableau will just take a single snapshot of the data rather than duplicate
    as it would with a union. This method is the most efficient, in terms of performance,
    of the three methods.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种方法是简单地将感兴趣的数据源与一个占位数据集连接起来。这个占位数据集通常很简单，通常是一个单列，行数从1开始，逐步增加，直到需要进行分析的整数为止。这种连接也会有效地使你的数据加倍。然而，通过使用提取功能，Tableau只会对数据进行单次快照，而不会像联合操作那样复制数据。从性能上看，这种方法是三种方法中最高效的一种。
- en: 'In this case, if you were working with the Sample – Superstore dataset and
    wanted to replicate it five times over, you would first create a new placeholder
    dataset that looks like this:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，如果你正在使用Sample – Superstore数据集，并希望将其复制五次，你首先需要创建一个新的占位数据集，如下所示：
- en: '| `placeholder` |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| `placeholder` |'
- en: '| `1` |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| `1` |'
- en: '| `2` |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| `2` |'
- en: '| `3` |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| `3` |'
- en: '| `4` |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| `4` |'
- en: '| `5` |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| `5` |'
- en: Then you would join the dataset with Sample – Superstore by using a custom join,
    where 1 = 1 (we’ll show you how to do this later in this chapter). If you needed
    to duplicate the data 100 times, you would just have 101 rows with the header
    and then each row counting by 1s from 1 to 100\. When we are data modeling, this
    is our approach.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，你可以通过使用自定义连接，其中1 = 1（我们将在本章后面向你展示如何做到这一点），将数据集连接到Sample – Superstore。如果你需要将数据复制100次，你只需有101行，每行从1开始以1的增量计数。在数据建模时，这是我们的方法。
- en: 'The last method requires you to create a join to a supplementary data source
    containing two rows: the first row being the first value, and the last value being
    the maximum number of times you want the data source duplicated on a view. You
    then use bins and table calculations to pad the missing values. This method is
    often the least efficient in terms of performance because the data modeling occurs
    through table calculations. These types of calculations are completed on the rendering
    of your visual and are typically the slowest to return.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一种方法需要你创建一个连接到一个补充数据源的连接，该数据源包含两行：第一行是第一个值，最后一个值是你希望在视图上复制的数据源的最大次数。然后，你可以使用分段和表格计算来填充缺失的值。从性能角度来看，这种方法通常效率最低，因为数据建模是通过表格计算完成的。这些类型的计算在可视化渲染时完成，通常返回速度最慢。
- en: 'In this case, as in the preceding join example, if you were working with the
    Sample – Superstore dataset and wanted to replicate it five times over, you would
    first create new placeholder data. This time, the placeholder data is much simpler:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，与前述连接示例一样，如果你正在使用Sample – Superstore数据集，并希望将其复制五次，你首先需要创建新的占位数据。这次，占位数据要简单得多：
- en: '| `placeholder` |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| `placeholder` |'
- en: '| `1` |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| `1` |'
- en: '| `5` |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| `5` |'
- en: You’ll then join to the data as you would with the join example. This is where
    the methods diverge. From there, you need to fill in values 2, 3, and 4 by using
    bins and a few more steps that we won’t discuss. If you are interested in this
    technique, you can read about it in a [great blog post](https://oreil.ly/5miVm)
    by Ken Flerlage.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，你将像连接示例一样连接到数据。这是方法分歧的地方。从那里，你需要使用分段和一些我们不会讨论的其他步骤来填充值2、3和4。如果你对这种技术感兴趣，可以阅读Ken
    Flerlage的一篇[优秀博客文章](https://oreil.ly/5miVm)。
- en: As noted earlier, we’ll tackle the union and join methods in this chapter. It’s
    worth noting at this juncture that the bin/table calculation method is extremely
    prevalent in the Tableau community and remains the way many individuals perform
    data modeling. The reason we mostly move away from the technique is because Tableau
    has significantly improved the way it creates extracts, and the original method
    allowed for a workaround without significantly increasing data sources. We’ve
    found that using a simple join over the bin/table calculation method increases
    performance as much as 20 times when replicating data over 100 times.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 正如前文所述，我们将在本章讨论联合和连接方法。 值得注意的是，bin/table计算方法在Tableau社区中非常流行，并且仍然是许多人进行数据建模的方法。
    我们主要放弃这种技术的原因是Tableau在创建数据提取方面有了显著改进，而原始方法允许通过绕过显著增加数据源的方法进行工作。 我们发现，与bin/table计算方法相比，使用简单的连接在复制数据超过100次时可以提高性能高达20倍。
- en: 'Strategy: Create a Calendar with Data Densification'
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建一个具有数据致密性的日历
- en: 'Your manager wants a heatmap that shows the profitability by day of the year.
    To do this, you decide you are going to make the visualization in the shape of
    a calendar. The only challenge: you don’t have sales for every day of the year,
    causing many blanks in your calendar.'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 您的经理希望看到一个热力图，显示每年每天的盈利能力。 为此，您决定将可视化呈现为一个日历形式。 唯一的挑战是：您没有全年每天的销售数据，导致日历中有很多空白。
- en: With this strategy, we’ll show you how to create a calendar showing profit by
    day for four years on a calendar. In this example, you’ll learn how to do basic
    data densification using the Sample – Superstore dataset that fills in the missing
    values. Let’s start by looking at what Tableau would produce by default; take
    a look at [Figure 10-1](#a_calendar_without_data_modeling).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这种策略，我们将向您展示如何创建一个四年盈利日历。 在此示例中，您将学习如何使用Sample - Superstore数据集执行基本数据致密化以填充缺失值。
    让我们从查看Tableau默认生成的内容开始；请查看图10-1。
- en: '![A calendar without data modeling](Images/TAST_1001.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![没有数据建模的日历](Images/TAST_1001.png)'
- en: Figure 10-1\. A calendar without data modeling
  id: totrans-32
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-1. 没有数据建模的日历
- en: 'You can see that Tableau returns cells only where data exists. If we look at
    January 1 or in 2017, for example, they don’t show up. This is because there is
    no data in our dataset for these dates. Our goal with this strategy is to fill
    in those missing values so that our visualization renders as we would expect:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到，Tableau仅在存在数据的地方返回单元格。 例如，如果我们查看2017年1月1日或2017年中，它们不会显示出来。 这是因为我们的数据集中没有这些日期的数据。
    我们通过这种策略的目标是填补这些缺失值，以便我们的可视化效果如预期般呈现：
- en: 'Build the calendar as follows:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按以下步骤构建日历：
- en: Add Year of [Order Date] and Weekday of [Order Date] to Columns.
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Order Date]的年份和[Order Date]的工作日添加到列中。
- en: Add Month of [Order Date] and Week of [Order Date] to Rows. Right-click WEEK(Order
    Date) on Rows.
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Order Date]的月份和[Order Date]的星期添加到行中。右键单击行上的WEEK(Order Date)。
- en: Add Day of [Order Date] to Text and SUM(Profit) to Color, and then change the
    mark type to Square. The result is [Figure 10-2](#a_closer_look_at_the_columnscomma_rowsco).
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Order Date]的日期添加到文本和SUM(Profit)添加到颜色，然后将标记类型更改为方形。 结果见图10-2。
- en: '![A closer look at the columns, rows, and Marks card](Images/TAST_1002.png)'
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![更详细查看列、行和标记卡](Images/TAST_1002.png)'
- en: Figure 10-2\. A closer look at the columns, rows, and Marks card
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-2. 更详细查看列、行和标记卡
- en: This step is very simple. Right-click any dimension on the Rows or Columns shelf
    and select Show Missing Values ([Figure 10-3](#the_show_missing_values_option)).
    This fills in all the values, from the minimum to the maximum.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这一步非常简单。 右键单击行或列架上的任何维度，并选择显示缺失值（见图10-3）。 这将填充从最小到最大的所有值。
- en: '![The Show Missing Values option](Images/TAST_1003.png)'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![显示缺失值选项](Images/TAST_1003.png)'
- en: Figure 10-3\. The Show Missing Values option
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-3. 显示缺失值选项
- en: As you can see in [Figure 10-4](#a_filled_calendar_from_the_minimum_value),
    all values from January 3, 2017 through December 30, 2020 are filled. But if you
    are looking to show January 1, 2017, January 2, 2017, and December 31, 2020, you
    need to extend our methodology. We can do this through some Tableau trickery that
    layers sheets on top of each other.
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如您在[图10-4](#a_filled_calendar_from_the_minimum_value)中所见，从2017年1月3日到2020年12月30日的所有值均已填充。
    但是，如果您想显示2017年1月1日、2017年1月2日和2020年12月31日，您需要扩展我们的方法。 通过一些Tableau技巧，我们可以通过将图层叠加到彼此上来完成这一点。
- en: '![A filled calendar from the minimum value through the maximum value](Images/TAST_1004.png)'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![从最小值到最大值的填充日历](Images/TAST_1004.png)'
- en: Figure 10-4\. A filled calendar from the minimum value through the maximum value
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-4\. 从最小值到最大值的填充日历
- en: To format the existing visualization, right-click it and set the background
    fill of the worksheet to None. Also change your text color to a dark gray.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要格式化现有的可视化图表，右键单击它，并将工作表的背景填充设置为无。同时将文本颜色更改为深灰色。
- en: 'Build the background sheet as follows:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建背景表如下：
- en: 'Create a calculated field called `**[Order Date Domain]**`. If the date in
    the dataset is equal to the earliest date, it will return January 1 of the earliest
    date; and if the date is equal to the latest date, it will return December 31
    of the year of the latest date:'
  id: totrans-48
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Order Date Domain]**`的计算字段。如果数据集中的日期等于最早的日期，则返回最早日期的1月1日；如果日期等于最晚日期，则返回最晚日期所在年的12月31日：
- en: '[PRE0]'
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Create a new sheet that will be used for the background. Follow steps 1 and
    2 for the [Order Date Domain] date field. After showing the missing values, you
    will notice that values now go from January 1, 2017 through December 31, 2020.
  id: totrans-50
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个用于背景的新表。按照[Order Date Domain]日期字段的步骤1和2操作。显示缺失值后，您会注意到值现在从2017年1月1日到2020年12月31日。
- en: 'Edit the color by choosing a custom diverging palette and setting the color
    to #E1E1E1 for both options. Then set the stepped color to 2 units. This will
    create an all-gray sheet ([Figure 10-5](#the_background_sheet)).'
  id: totrans-51
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过选择自定义分歧调色板并设置颜色为#E1E1E1来编辑颜色。然后将阶梯颜色设置为2个单位。这将创建一个全灰色的表格（[图10-5](#the_background_sheet)）。
- en: '![The background sheet](Images/TAST_1005.png)'
  id: totrans-52
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![背景表](Images/TAST_1005.png)'
- en: Figure 10-5\. The background sheet
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-5\. 背景表
- en: With the calculation, you completed domain padding by “adding” dates to your
    dataset. You then used Show Missing Values to execute domain completion.
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用计算完成了域填充，通过“添加”日期到您的数据集中。然后使用显示缺失值来执行域完成。
- en: 'For this calendar, you will layer the two visualizations on top of each other:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于这个日历，您将将两个可视化图层叠在一起：
- en: If you do not have a dashboard yet, create a new dashboard and add a vertical
    container. Add the background sheet to the container and fit the sheet to the
    entire container.
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您还没有仪表板，请创建一个新的仪表板并添加一个垂直容器。将背景表添加到容器中，并将表格适应整个容器。
- en: Add a floating container on top of the background view. Add the top layer to
    the top container. Hide all the headers and then size the top container to match
    the background layer. You can match the size by matching the left, top, width,
    and height between the two sheets.
  id: totrans-57
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在背景视图上添加一个浮动容器。将顶层添加到顶部容器中。隐藏所有标题，然后调整顶部容器的大小以匹配背景层。您可以通过匹配两个表格之间的左、顶部、宽度和高度来匹配大小。
- en: The final result is two visualizations that look like one full calendar ([Figure 10-6](#the_final_resultcolon_a_two_layered_shee)).
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 最终结果是两个看起来像一个完整日历的可视化图表（[图10-6](#the_final_resultcolon_a_two_layered_shee)）。
- en: '![The final result: a two-layered sheet](Images/TAST_1006.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![最终结果：两层表格](Images/TAST_1006.png)'
- en: 'Figure 10-6\. The final result: a two-layered sheet'
  id: totrans-60
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-6\. 最终结果：两层表格
- en: With this strategy, you applied domain padding and domain completion by using
    a single calculation and Show Missing Values. This is the most simplistic version
    of data densification. In the rest of the chapter, you will learn more-complicated
    versions of data modeling.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 使用此策略，您通过单一计算和显示缺失值应用了域填充和域完成。这是数据稠密化的最简单版本。在本章的其余部分，您将学习更复杂的数据建模版本。
- en: 'Strategy: Create Rounded Bar Charts'
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建圆角柱状图
- en: 'For this strategy, you’ll create a summary of sales by sub-category. At first,
    you may think, “This seems easy,” but what if your stakeholder wants to see a
    very specific type of chart: a rounded bar chart? You know that this isn’t ideal
    for interpretation but agree it’s a break from the mundane bar charts everyone
    typically gets.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个策略，您将创建一个按子类别销售总结的报表。起初，您可能会想：“这看起来很容易”，但是如果您的利益相关者希望看到一种非常特定类型的图表：圆角柱状图呢？您知道这对于解释并不理想，但同意这是一个摆脱通常得到的乏味柱状图的方法。
- en: '![The final output of the rounded bar chart strategy](Images/TAST_1007.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![圆角柱状图策略的最终输出](Images/TAST_1007.png)'
- en: Figure 10-7\. The final output of the rounded bar chart strategy
  id: totrans-65
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-7\. 圆角柱状图策略的最终输出
- en: 'In this strategy, you’ll learn how to make rounded bar charts, as shown in
    [Figure 10-7](#the_final_output_of_the_rounded_bar_char), but more importantly,
    you will begin to learn the essentials of data modeling. With data modeling, you
    add more data to your dataset to build out-of-the-box solutions. As mentioned
    earlier, this can be done one of three ways: unions, joins, and table calculations.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您将学习如何制作圆形条形图，如[图 10-7](#the_final_output_of_the_rounded_bar_char)所示，但更重要的是，您将开始学习数据建模的基础知识。通过数据建模，您可以向数据集添加更多数据，以构建出色的解决方案。正如前面提到的，这可以通过三种方式之一来完成：联合操作、连接和表计算。
- en: 'For this rounded bar chart strategy, and the next strategy that refers to lessons
    learned in [Chapter 6](ch06.xhtml#building_impactful_tables), we will use a union.
    Again, we could accomplish this using the other techniques, but we will start
    with the option we find the easiest:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种圆形条形图策略，以及下一节参考[第 6 章](ch06.xhtml#building_impactful_tables)中学到的经验，我们将使用联合操作。再次强调，我们可以通过其他技术来完成这一操作，但我们将从我们认为最简单的选项开始：
- en: Let’s begin by connecting to the Sample – Superstore dataset. Instead of using
    any quick connections you have, select Microsoft Excel and find Sample – Superstore.xls.
    Once you have connected, click and drag the Orders table to the data source. The
    result is shown in [Figure 10-8](#connecting_to_the_orders_tab_of_the_data).
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们从连接到 Sample – Superstore 数据集开始。而不是使用您拥有的任何快速连接，选择 Microsoft Excel 并找到 Sample
    – Superstore.xls。连接后，点击并拖动订单表到数据源。结果如[图 10-8](#connecting_to_the_orders_tab_of_the_data)所示。
- en: '![Connecting to the Orders tab of the dataset](Images/TAST_1008.png)'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![连接到数据集的订单选项卡](Images/TAST_1008.png)'
- en: Figure 10-8\. Connecting to the Orders tab of the dataset
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-8\. 连接到数据集的订单选项卡
- en: What you have done is very typical. But we’re not done with the Data pane yet.
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您所做的事情非常典型。但我们还没有完成数据窗格的工作。
- en: Let’s take the same Orders table you selected from the Connections pane and
    create a union with the Orders data you already added to the data source window,
    shown in [Figure 10-9](#unioning_orders_to_orders).
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们使用与连接窗格中选定的订单表相同的订单表，并将其与已添加到数据源窗口的订单数据联合，如[图 10-9](#unioning_orders_to_orders)所示。
- en: '![Unioning Orders to Orders](Images/TAST_1009.png)'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![将订单与订单联合](Images/TAST_1009.png)'
- en: Figure 10-9\. Unioning Orders to Orders
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-9\. 将订单与订单联合
- en: By unioning the Orders data to itself, we are essentially creating a second
    layer of data to work with. This duplicate layer of data provides increased flexibility
    for working in Tableau, but it also requires us to track each layer all the time.
    You constantly have to ask yourself, What is happening with the first layer of
    data? What’s happening with the second layer of data? If you can track what you
    are doing with both, you are well on your way to becoming a next-level professional
    of Tableau Desktop.
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过将订单数据与自身联合，我们实际上创建了第二层数据以便操作。这个重复的数据层不仅提供了在 Tableau 中工作的更大灵活性，同时也要求我们始终跟踪每一层。您不断需要问自己，第一层数据发生了什么？第二层数据又如何？如果您能同时追踪这两层，您就已经在成为
    Tableau Desktop 的高级专业人士的道路上迈出了重要的一步。
- en: 'So how do you track both layers of data? When you union data sources together,
    Tableau creates two new fields in your dataset to help track the layers: [Sheet]
    and [Table Name]. As you are building out our data, you can see the [Sheet] and
    [Table Name] by scrolling all the way to the right ([Figure 10-10](#after_a_unioncomma_the_left_square_brack)).'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 那么，如何跟踪这两层数据呢？当您将数据源联合在一起时，Tableau 会在数据集中创建两个新字段来帮助跟踪这些层：[Sheet] 和 [表名]。在构建数据时，您可以通过向右滚动屏幕看到
    [Sheet] 和 [表名]（参见[图 10-10](#after_a_unioncomma_the_left_square_brack)）。
- en: '![After a union, the [Sheet] and [Table Name] dimensions are added](Images/TAST_1010.png)'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![联合后，[Sheet] 和 [表名] 维度被添加](Images/TAST_1010.png)'
- en: Figure 10-10\. After a union, the [Sheet] and [Table Name] dimensions are added
  id: totrans-78
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-10\. 联合后，[Sheet] 和 [表名] 维度被添加
- en: For our strategies, you will use the [Table Name] dimension to track what is
    happening with each layer.
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于我们的策略，您将使用 [表名] 维度来跟踪每个层面的情况。
- en: 'Click on Sheet 1\. Before we start building, add [Sales] to Columns and [Table
    Name] to Rows. You will see that we have two members of [Table Name]: Orders (our
    first layer), and Orders1 (our second layer, whose name Tableau updated by appending
    a 1 to the end). You’ll also notice that the sales are equal. That’s because our
    layers are identical.'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击 Sheet 1\. 在开始构建之前，将 [销售额] 添加到列和 [表名] 添加到行。您将看到我们有两个 [表名] 的成员：Orders（我们的第一层）和
    Orders1（我们的第二层，Tableau 在名称末尾添加了 1）。您还会注意到销售额相等。这是因为我们的层是相同的。
- en: 'Half the battle of data modeling is getting the data in order. The other battle:
    tracking where the data is on your visualization.'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 数据建模的一半是将数据整理好。另一半是跟踪数据在可视化中的位置。
- en: 'Now that we have two layers of data, we have to think about what our rounded
    bar chart really is: it’s just two overlapping lines. We need to control the start
    and end of each lines. And we can do that with our two data layers. Let’s consider
    the final product in [Figure 10-6](#the_final_resultcolon_a_two_layered_shee).
    The start of our main bars is at zero. We’ll need one layer to be equal to zero.
    The other layer of our data needs to go to the total sales.'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们有两层数据，我们必须考虑我们的圆形条形图实际上是什么：它只是两条重叠的线。我们需要控制每条线的起始和结束。我们可以通过我们的两个数据层来做到这一点。让我们考虑[图 10-6](#the_final_resultcolon_a_two_layered_shee)中的最终产品。我们主要条形的起始点是零。我们需要一层数据等于零。另一层数据需要达到总销售额。
- en: 'Let’s build out a calculation called `**[Bars]**` to do exactly this:'
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 让我们构建一个称为`**[Bars]**`的计算来完成这个任务：
- en: '[PRE1]'
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'You also have our background bar, whose overall length is equal to the maximum
    sales across each [Sub-Category]. Create a calculation called `**[Background]**`:'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您还有我们的背景条形，其整体长度等于每个[Sub-Category]的最大销售额。创建一个名为`**[Background]**`的计算：
- en: '[PRE2]'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: To build the visualization, create a new sheet and change the view from Standard
    to Entire View.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要构建可视化效果，请创建一个新工作表，并将视图从标准更改为整个视图。
- en: Add [Sub-Category] to Rows.
  id: totrans-88
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Sub-Category]添加到行中。
- en: Add the sum of [Sales] to Rows. Convert the data to discrete. Then format the
    number to currency and right-align the text. [Figure 10-11](#the_view_after_formatting_the_discrete_s)
    shows the view after this step.
  id: totrans-89
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Sales]总和添加到行中。将数据转换为离散值。然后将数字格式设置为货币并右对齐文本。[图 10-11](#the_view_after_formatting_the_discrete_s)显示了此步骤后的视图。
- en: '![The view after formatting the discrete sum of sales](Images/TAST_1011.png)'
  id: totrans-90
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![格式化后的销售离散总和视图](Images/TAST_1011.png)'
- en: Figure 10-11\. The view after formatting the discrete sum of sales
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-11\. 格式化后的销售离散总和视图
- en: Add [Table Name] to Detail on the Marks card.
  id: totrans-92
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Table Name]添加到标记卡的详细信息中。
- en: Add the [Bars] calculation to Columns, change the mark type to Line, and adjust
    the size to be about 75% of the maximum value. [Figure 10-12](#the_view_after_adding_the_bars_calculati)
    shows the view after this step.
  id: totrans-93
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Bars]计算添加到列中，将标记类型更改为线性，并调整大小为最大值的约75%。[图 10-12](#the_view_after_adding_the_bars_calculati)显示了此步骤后的视图。
- en: '![The view after adding the Bars calculation to rows](Images/TAST_1012.png)'
  id: totrans-94
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![将Bars计算添加到行后的视图](Images/TAST_1012.png)'
- en: Figure 10-12\. The view after adding the Bars calculation to rows
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-12\. 将Bars计算添加到行后的视图
- en: Add the [Background] calculation to Columns. Make sure the mark type is set
    to Line. Create a dual axis between [Bars] and [Background]. Right-click the [Background]
    axis and select “Move marks to back.” (Depending on your version of Tableau, you
    may need to change the mark type of [Table Name] to Line instead of Detail.)
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Background]计算添加到列中。确保标记类型设置为线性。在[Bars]和[Background]之间创建双轴。右键单击[Background]轴，选择“将标记移至后面”。（根据您使用的Tableau版本，可能需要将[Table
    Name]的标记类型更改为线性，而不是详细信息。）
- en: Remove [Measure Names] from both Marks cards. Edit the opacity of the color
    on the [Background] Marks card to 25%. [Figure 10-13](#the_view_after_formatting_the_color_of_t)
    shows the visualization at this point.
  id: totrans-97
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从两个标记卡中删除[Measure Names]。编辑[Background]标记卡上颜色的不透明度为25%。[图 10-13](#the_view_after_formatting_the_color_of_t)显示了此时的可视化效果。
- en: '![The view after formatting the color of the background marks card.](Images/TAST_1013.png)'
  id: totrans-98
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![格式化背景标记卡颜色后的视图。](Images/TAST_1013.png)'
- en: Figure 10-13\. The view after formatting the color of the background marks card.
  id: totrans-99
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-13\. 格式化背景标记卡颜色后的视图。
- en: Format the view by hiding the axes and removing grid lines, zero lines, axis
    rulers, and column dividers. Format your tooltip.
  id: totrans-100
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过隐藏轴线、删除网格线、零线、轴标尺和列分隔线来格式化视图。格式化您的工具提示。
- en: Once you’ve done these steps, you’ve created your final product ([Figure 10-14](#a_formatted_rounded_bar_chart)).
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 完成这些步骤后，您已经创建了最终产品（[图 10-14](#a_formatted_rounded_bar_chart)）。
- en: Tip
  id: totrans-102
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: It’s important to know that not all data sources can create unions in Tableau.
    For a full list, see Tableau’s [help doc on unions](https://oreil.ly/t5N03).
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 需要知道并非所有数据源都能在Tableau中创建联合。有关完整列表，请参阅Tableau的[联合帮助文档](https://oreil.ly/t5N03)。
- en: '![A formatted rounded bar chart](Images/TAST_1014.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![一个格式化的圆形条形图](Images/TAST_1014.png)'
- en: Figure 10-14\. A formatted rounded bar chart
  id: totrans-105
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-14\. 一个格式化的圆形条形图
- en: 'Strategy: Create an Accordion Table'
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建手风琴表格
- en: You build lots of tables because your audience demands that they can just get
    to the numbers quickly. You use hierarchies to allow your users to drill up and
    down through the data. But one of the common complaints you hear is that when
    a user expands the table, they see too much information and can’t compare one
    level to the next.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 您构建了很多表格，因为您的受众要求快速获取数字。您使用层次结构允许用户通过数据上下钻取。但您经常听到的一个普遍抱怨是，当用户展开表格时，他们看到了太多信息，无法比较一个层次和下一个层次。
- en: For example, say a user is looking for the profit ratio in [Figure 10-15](#a_standard_hierarchy_in_tableau)
    for Office Supplies. The user would have to drill back up the hierarchy to get
    the number.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设用户想要查看[图 10-15](#a_standard_hierarchy_in_tableau)中办公用品的利润率。用户需要向上钻取层次以获取数字。
- en: '![A standard hierarchy in Tableau](Images/TAST_1015.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![Tableau中的标准层次结构](Images/TAST_1015.png)'
- en: Figure 10-15\. A standard hierarchy in Tableau
  id: totrans-110
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-15\. Tableau中的标准层次结构
- en: One alternative to help reduce the cognitive complexity is an *accordion table*.
    At a high level, you see only top-level information. In [Figure 10-16](#an_overview_at_the_category_level),
    this means seeing values only at the category level.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 减少认知复杂性的一种替代方法是*手风琴表格*。在高层次上，您只看到顶层信息。在[图 10-16](#an_overview_at_the_category_level)中，这意味着仅查看类别级别的值。
- en: '![An overview at the category level](Images/TAST_1016.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![类别级别概览](Images/TAST_1016.png)'
- en: Figure 10-16\. An overview at the category level
  id: totrans-113
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-16\. 类别级别概览
- en: However, if your users want to see details about office supplies, they could
    open the accordion and understand details one level lower without revealing too
    much information, as shown in [Figure 10-17](#using_the_accordion_table_to_drill_into).
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，如果您的用户想要查看有关办公用品的详细信息，他们可以打开手风琴并在不泄露过多信息的情况下理解更低一级的细节，如[图 10-17](#using_the_accordion_table_to_drill_into)所示。
- en: '![Using the accordion table to drill into the Office Supplies category and
    see the performance by sub-category](Images/TAST_1017.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![使用手风琴表格来钻取到办公用品类别并查看子类别的表现](Images/TAST_1017.png)'
- en: Figure 10-17\. Using the accordion table to drill into the Office Supplies category
    and see the performance by sub-category
  id: totrans-116
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-17\. 使用手风琴表格来钻取到办公用品类别并查看子类别的表现
- en: When we are building drillable tables, we often use accordion tables. So how
    is this done?
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们构建可钻取的表格时，通常会使用手风琴表格。那么这是如何完成的呢？
- en: 'For this strategy, we will be using the same Samples – Superstore data source
    as in our preceding strategy. If you are not connected to this data source, follow
    steps 1 and 2 of [“Strategy: Create Rounded Bar Charts”](#strategycolon_create_rounded_bar_charts)
    to connect.'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于这种策略，我们将使用与前一策略相同的Samples – Superstore数据源。如果您未连接到此数据源，请按照[“策略：创建圆角条形图”](#strategycolon_create_rounded_bar_charts)的步骤1和2进行连接。
- en: 'Rather than selecting Standard or Entire View, set your view size to Fit Width.
    Build the visualization as follows:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不要选择标准或整体视图，而是将视图大小设置为适合宽度。构建可视化如下：
- en: Add [Category] to Rows.
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Category]添加到行中。
- en: Add [Table Name] to the right of [Category] on Rows. Make sure that the Orders
    member occurs before Orders1.
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Category]添加到[Table Name]的右侧行。确保Orders成员出现在Orders1之前。
- en: Right-click [Category] in the Data pane and create a new set. Call the set `**[Category
    Set]**`. Do not select any values yet.
  id: totrans-122
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在数据窗格中右键单击[Category]并创建一个新集。将该集命名为`**[Category Set]**`。暂时不要选择任何值。
- en: 'Create a calculation for the arrows called `**[Arrow]**`:'
  id: totrans-123
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Arrow]**`的箭头计算：
- en: '[PRE3]'
  id: totrans-124
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This will show a down arrow when an accordion is open and a right arrow when
    an accordion is closed. Place [Arrows] to the right of [Table Name] on Rows.
  id: totrans-125
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当手风琴展开时显示向下箭头，当手风琴关闭时显示向右箭头。将[Arrows]放置在[Table Name]的右侧行。
- en: 'Create a calculation called `**[Level]**`. This calculation will show either
    [Category] or [Sub-Category], depending on which layer of data we are working
    with:'
  id: totrans-126
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Level]**`的计算字段。此计算将根据我们处理的数据层次显示[Category]或[Sub-Category]：
- en: '[PRE4]'
  id: totrans-127
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Place [Level] to the right of [Arrow] on Rows.
  id: totrans-128
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[Level]放置在[Arrow]的右侧行。
- en: Add [Measure Names] to Columns and add [Measure Values] to Text on the Marks
    card. Include only the metrics you are interested in. For this example, we are
    using SUM(Sales), SUM(Profit), [Profit Ratio], and COUNTD(Orders).
  id: totrans-129
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[Measure Names]添加到列中，并将[Measure Values]添加到标记卡上的文本。仅包括您感兴趣的指标。例如，我们使用SUM(Sales)、SUM(Profit)、[Profit
    Ratio]和COUNTD(Orders)。
- en: 'If [Profit Ratio] and COUNTD(Order ID) don’t exist, you can create the following
    calculated fields:'
  id: totrans-130
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果[Profit Ratio]和COUNTD(Order ID)不存在，您可以创建以下计算字段：
- en: '[PRE5]'
  id: totrans-131
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: You now have a fully built-out table.
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您现在已经有一个完全建立的表格。
- en: Hide the [Category] and [Table Name] dimensions on Rows by right-clicking each
    and deselecting Show Header.
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过右键单击每个，并取消选择显示标题的方式，隐藏[类别]和[表名]维度。
- en: Format your table by removing row banding, zero lines, axis rulers, and grid
    lines. Add row dividers so they match the view in [Figure 10-18](#the_accordion_after_hiding_the_category).
  id: totrans-134
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过删除行带、零线、轴标尺和网格线来格式化您的表格。添加行分隔线，使其与[图 10-18](#the_accordion_after_hiding_the_category)中的视图匹配。
- en: '![The accordion after hiding the Category and Table Name headers and format](Images/TAST_1018.png)'
  id: totrans-135
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![隐藏类别和表名标题及格式后的手风琴](Images/TAST_1018.png)'
- en: Figure 10-18\. The accordion after hiding the Category and Table Name headers
    and format
  id: totrans-136
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-18\. 隐藏类别和表名标题及格式后的手风琴
- en: 'You want to show data only when it is selected. To do so, you need to create
    a filter. Create a calculation called `**[Filter]**`:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您仅希望在选择时显示数据时。为此，您需要创建一个筛选器。创建一个名为`**[Filter]**`的计算：
- en: '[PRE6]'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Add Filter to the Filters shelf and select True. [Figure 10-19](#the_accordion_after_adding_the_filter_ca)
    shows the visualization at this stage.
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将筛选器添加到筛选架上并选择 True。[图 10-19](#the_accordion_after_adding_the_filter_ca)显示了此阶段的可视化。
- en: '![The accordion after adding the filter calculation](Images/TAST_1019.png)'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![添加筛选器计算后的手风琴](Images/TAST_1019.png)'
- en: Figure 10-19\. The accordion after adding the filter calculation
  id: totrans-141
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-19\. 添加筛选器计算后的手风琴
- en: After you have added your visualization to the dashboard, from the top menu
    choose Dashboard → Actions and add an action. Alternatively, you can add an action
    on the sheet by choosing Worksheet → Actions from the top menu.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在将可视化添加到仪表板后，从顶部菜单选择仪表板 → 操作 并添加一个操作。或者，您可以通过从顶部菜单选择工作表 → 操作 在工作表上添加操作。
- en: Select to Change Set Values to add a set action. On select, assign a value to
    Category Set, and when the selection is cleared, remove all values. Click OK.
    Then click OK again. These options are shown in [Figure 10-20](#adding_the_set_action_to_the_category_se).
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 选择更改集合值以添加一个集合操作。在选择时，将一个值分配给类别集合，当选择被清除时，移除所有值。点击“确定”。然后再次点击“确定”。这些选项显示在[图 10-20](#adding_the_set_action_to_the_category_se)中。
- en: Go ahead and test your table by selecting Furniture. You will notice that your
    table expands to show the four sub-categories of information, as shown in [Figure 10-21](#the_accordion_table_after_drilling_into).
    You will now be able to drill in and out of your data without revealing an overwhelming
    amount of information to your audience.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 继续测试您的表格，选择家具。您会注意到，您的表格会展开，显示四个子类别的信息，如[图 10-21](#the_accordion_table_after_drilling_into)所示。现在，您将能够在不向观众展示过多信息的情况下深入了解和分析您的数据。
- en: '![Adding the set action to the Category Set calculation](Images/TAST_1020.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![将集合操作添加到类别集合计算中](Images/TAST_1020.png)'
- en: Figure 10-20\. Adding the set action to the Category Set calculation
  id: totrans-146
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-20\. 将集合操作添加到类别集合计算中
- en: '![The accordion table after drilling into the Furniture category](Images/TAST_1021.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![打开家具类别后的手风琴表格](Images/TAST_1021.png)'
- en: Figure 10-21\. The accordion table after drilling into the Furniture category
  id: totrans-148
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-21\. 打开家具类别后的手风琴表格
- en: 'Strategy: Create a Sales Funnel'
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建销售漏斗
- en: Data provides modern sales teams with motivation and an incentive to sell, and
    the most common visualization they want to see is a sales funnel. The *sales funnel*
    shows the conversion rate from stage to stage in the sales cycle.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 数据为现代销售团队提供动力和销售激励，而他们最想看到的最常见的可视化是销售漏斗。*销售漏斗*显示了销售周期中从阶段到阶段的转化率。
- en: In this strategy, you’ll create the sales funnel in [Figure 10-22](#the_sales_funnel).
    You will work with mock sales data that contains 1,000 records of sales opportunities,
    the values of the opportunities, and the stage of the pipeline. Your sales pipeline
    consists of six stages, but this varies from organization to organization. These
    stages are Prospect, Lead, Qualified, Opportunity, Negotiations, and Closed. Every
    deal must go through each of these stages.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种策略中，您将在[图 10-22](#the_sales_funnel)中创建销售漏斗。您将使用包含 1,000 条销售机会记录、机会价值以及管道阶段的模拟销售数据。您的销售管道包括六个阶段，但这在不同组织之间可能有所不同。这些阶段分别是潜在客户、领导、合格、机会、谈判和关闭。每笔交易都必须经过每个阶段。
- en: '![The sales funnel](Images/TAST_1022.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![销售漏斗](Images/TAST_1022.png)'
- en: Figure 10-22\. The sales funnel
  id: totrans-153
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-22\. 销售漏斗
- en: The sales funnel is a nonstandard data visualization. While there are some ways
    to create a funnel without data modeling, the biggest issue with those techniques
    is that areas in each stage of the funnel end up misrepresented. Additionally,
    a common retort against the sales funnel is that a funnel is a metaphor that could
    be represented by a series of bar charts instead. This is absolutely true. However,
    when we think about our audiences and how they engage with data, sometimes a sales
    funnel metaphor is the exact visualization they need to understand their pipeline
    conversion. And a sales pipeline with areas that are proportionally correct can’t
    be built in Tableau without a little data modeling.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 销售漏斗是一种非标准的数据可视化。虽然有一些方法可以在没有数据建模的情况下创建漏斗，但是这些技术的最大问题是漏斗各阶段的区域最终被误表示。此外，对销售漏斗的普遍反驳是，漏斗是一个可以用一系列条形图代替的隐喻。这是完全正确的。然而，当我们考虑我们的受众及其如何与数据互动时，有时销售漏斗的隐喻是他们理解管道转化的确切可视化工具。而且在
    Tableau 中创建比例正确的具有正确区域的销售管道是不可能的，除非稍作数据建模。
- en: 'This will be the first data model to use a join. We will use a join to duplicate
    the data four times over: one for each corner of the sales polygons. Here are
    the steps:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这将是第一个使用连接的数据模型。我们将使用连接四次复制数据：每个销售多边形的每个角落一个。以下是步骤：
- en: 'In Notepad or any text editor, create your modeling data source by typing the
    following:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在记事本或任何文本编辑器中，通过输入以下内容创建您的建模数据源：
- en: '[PRE7]'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Save the file as *funnel_model.csv*.
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将文件保存为 *funnel_model.csv*。
- en: 'When modeling the data, you need to connect to two data sources: the sales
    data source and the modeling data. You also need to join the two sources together
    with a custom join:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在建模数据时，您需要连接到两个数据源：销售数据源和建模数据。您还需要使用自定义连接将这两个源连接在一起：
- en: Connect to the *funnel_model.csv* data source. Click and drag *funnel_model.csv*
    to the Drag Tables Here section.
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 连接到 *funnel_model.csv* 数据源。单击并拖动 *funnel_model.csv* 到这里拖动表格部分。
- en: Add another data source connection to the sales stage data. Click and drag *sales_stage_data*
    to the *funnel_model.csv* data source.
  id: totrans-161
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将另一个数据源连接到销售阶段数据。单击并拖动 *sales_stage_data* 到 *funnel_model.csv* 数据源。
- en: To bring the two data sources together, you need to edit the join. Create custom
    relationship calculations for both data sources and set the value for each to
    1 ([Figure 10-23](#creating_the_custom_relationship_for_the)).
  id: totrans-162
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将两个数据源合并在一起，您需要编辑连接。为两个数据源创建自定义关系计算，并将每个值设置为1（[图10-23](#creating_the_custom_relationship_for_the)）。
- en: '![Creating the custom relationship for the sales_stage_data.csv data source](Images/TAST_1023.png)'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![为 *sales_stage_data.csv* 数据源创建自定义关系](Images/TAST_1023.png)'
- en: Figure 10-23\. Creating the custom relationship for the sales_stage_data.csv
    data source
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-23\. 为 *sales_stage_data.csv* 数据源创建自定义关系
- en: Your data source connection will change from a red warning sign to an orange
    line. This line indicates the relationship between the two data sources. Data
    is ready for analysis. Create a new sheet to begin building our sales funnel.
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您的数据源连接将从红色警告标志变为橙色线条。此线表示两个数据源之间的关系。数据准备好进行分析。创建一个新表开始构建我们的销售漏斗。
- en: 'To determine and fill in the values of the funnel, we need to code the order
    of the funnel sections. Use a case statement to put stage names into a numeric
    order by creating a calculation called `**[Sort]**`:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要确定并填写销售漏斗的值，我们需要编写漏斗部分的顺序代码。使用 case 语句按阶段名称创建一个名为 `**[排序]**` 的计算：
- en: '[PRE8]'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: In this example, our stages are ordered as Prospect, Lead, Qualified, Opportunity,
    Negotiations, and then Closed.
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这个例子中，我们的阶段按照潜在客户、领导、合格、机会、谈判、以及关闭的顺序排列。
- en: 'Calculate the total value of the sales opportunities as follows:'
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算销售机会的总价值如下：
- en: 'Create a calculation called `**[Total Value]**`:'
  id: totrans-170
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为 `**[总价值]**` 的计算：
- en: '[PRE9]'
  id: totrans-171
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: We will use this calculation to determine the total value of opportunities throughout
    the pipeline.
  id: totrans-172
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们将使用这个计算来确定整个管道中机会的总价值。
- en: 'As part of creating the funnel chart, you need to calculate the value of each
    stage, but you also need to calculate the value of the next stage. Create a calculation
    called `**[Next Value]**`:'
  id: totrans-173
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在创建漏斗图表的过程中，您需要计算每个阶段的价值，但还需要计算下一个阶段的价值。创建一个名为 `**[下一个价值]**` 的计算：
- en: '[PRE10]'
  id: totrans-174
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: You may not want the stages of your funnel touching one another. You can fix
    this by adding padding. Rather than hardcoding the padding between stages, create
    a float parameter called `**[padding]**`. We’ve assigned a value of 1.05 to our
    parameter. We suggest a value from 1 (no padding) to 1.3 (a lot of padding).
  id: totrans-175
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 也许你不希望漏斗的各个阶段相互接触。你可以通过添加填充来解决这个问题。与其在阶段之间硬编码填充，不如创建一个名为`**[padding]**`的浮动参数。我们给我们的参数分配了一个值为1.05。建议的值范围从1（无填充）到1.3（大量填充）。
- en: 'Create a calculation called `**[size]**` that assigns values to your data model.
    This will help create the sides of your funnel:'
  id: totrans-176
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[size]**`的计算，为你的数据模型分配值。这将有助于创建你漏斗的侧面：
- en: '[PRE11]'
  id: totrans-177
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Create two calculations, one for the *x* coordinates and one for the *y* coordinates,
    as follows:'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建两个计算，一个用于*x*坐标，一个用于*y*坐标，如下所示：
- en: 'For the *x* coordinates, create a calculation called `**[x]**`:'
  id: totrans-179
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于*x*坐标，创建一个名为`**[x]**`的计算：
- en: '[PRE12]'
  id: totrans-180
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'For the *y* coordinates, create a calculation called `**[y]**`:'
  id: totrans-181
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于*y*坐标，创建一个名为`**[y]**`的计算：
- en: '[PRE13]'
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: In this case, `[size]` is just the overall height of the funnel, and the `[sort]
    * [padding]` will specify the start of each section of the sales funnel.
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这种情况下，`[size]`只是漏斗的总高度，而`[sort] * [padding]`将指定销售漏斗每个部分的起始位置。
- en: 'Now that you have the calculations to create a funnel, you can begin to build
    the funnel chart. You will eventually create a dual-axis chart, so this is only
    part of the visualization, but if you can build the funnel, then the final steps
    will be a piece of cake:'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在你已经有了创建漏斗的计算，你可以开始构建漏斗图表。最终你会创建一个双轴图表，因此这只是可视化的一部分，但如果你能够构建漏斗，那么最后的步骤将变得非常容易：
- en: Change the mark type to Polygon. Then add [Stage] to Color and [Model] as a
    dimension to Path.
  id: totrans-185
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为多边形。然后将[Stage]添加到颜色中，将[Model]作为路径的维度。
- en: Add [y] to Rows. Change the aggregation to Average. Don’t forget the average
    aggregation; this is critical later!
  id: totrans-186
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[y]添加到行中。更改聚合为平均值。不要忘记平均聚合，这对后续步骤至关重要！
- en: Add [x] as a dimension to Columns. Right-click to edit the table calculations.
    Because you are working with nested calculations, you have two table calculations
    to edit. For the [Next Value] calculation, set the Compute Using option to Specific
    Dimensions and then select only the Stage checkbox. From the “Sort order” list,
    select Custom Sort, and do a custom ascending sort on the [Sort] calculation you
    created, using Minimum as the aggregation type. Use sort ascending for Next Value
    and use sort descending for Total Value. Use the exact same settings for the [Total
    Value] table calculation, which is shown in [Figure 10-24](#table_calculation_for_the_x_calculated_f).
  id: totrans-187
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[x]作为列的维度添加到表中。右键单击编辑表计算。因为你正在处理嵌套计算，你有两个表计算需要编辑。对于[Next Value]计算，设置“计算使用”选项为特定维度，然后仅选择阶段复选框。从“排序顺序”列表中，选择自定义排序，在你创建的[Sort]计算上执行升序排序，使用最小作为聚合类型。对于[Total
    Value]表计算，使用相同的设置，这在[图 10-24](#table_calculation_for_the_x_calculated_f)中显示。
- en: '![Table calculation for the x calculated field for the funnel chart](Images/TAST_1024.png)'
  id: totrans-188
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![漏斗图表的 x 计算字段的表格计算](Images/TAST_1024.png)'
- en: Figure 10-24\. Table calculation for the x calculated field for the funnel chart
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-24\. 漏斗图表的 x 计算字段的表格计算
- en: Remove all lines and dividers, and hide the headers. Then click the color and
    remove the border around the polygons. Edit the colors of the stages.
  id: totrans-190
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除所有线条和分隔线，并隐藏标题。然后点击颜色并删除多边形周围的边框。编辑阶段的颜色。
- en: 'You have three options for coloring the stages: keep the color the same because
    you are already using the shape of the funnel to encode change; use discrete colors
    to emphasize that each stage is separate; use a custom sequential color palette
    (which, as mentioned, acts as a double encoding of the information). The result
    is [Figure 10-25](#the_first_half_of_the_funnel_chartcomma).'
  id: totrans-191
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 有三种选项可以为各个阶段着色：保持颜色不变，因为你已经利用漏斗的形状来编码变化；使用离散的颜色来强调每个阶段是独立的；使用自定义的顺序颜色调色板（如前所述，这将信息双重编码）。结果如[图
    10-25](#the_first_half_of_the_funnel_chartcomma)所示。
- en: '![The first half of the funnel chart, formatted](Images/TAST_1025.png)'
  id: totrans-192
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![格式化的漏斗图表的前半部分](Images/TAST_1025.png)'
- en: Figure 10-25\. The first half of the funnel chart, formatted
  id: totrans-193
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-25\. 格式化的漏斗图表的前半部分
- en: 'You will add context to the funnel by adding text and labels. To do so, you
    need to build a calculation that centers labels on the chart:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过添加文本和标签来为漏斗增加上下文。为此，你需要构建一个在图表上居中标签的计算：
- en: 'Create a calculation called `**[Center Label]**`:'
  id: totrans-195
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Center Label]**`的计算：
- en: '[PRE14]'
  id: totrans-196
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Because you modeled your data four times over, you need to place labels to calculate
    the totals for only a single point in the data model. In this case, you are going
    to calculate them for when the model dimension is equal to 1.
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 因为您对数据进行了四次建模，所以只需为数据模型中的单个点计算总计。在这种情况下，您将计算模型维度等于1时的值。
- en: Add [Center Label] to Columns. The default aggregation is sum, and you won’t
    need to update this. Create a synchronized dual axis with [x] and sum of [Center
    Label]; don’t forget to remove [Measure Names] from both Marks cards. When you
    are done with the axes, change the mark type to Text.
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在列中添加[Center Label]。默认聚合是求和，您无需更新此项。使用[x]和[Center Label]的求和创建同步双轴；不要忘记从两个标记卡中删除[Measure
    Names]。完成轴设置后，将标记类型更改为文本。
- en: Add [Stage] to Label.
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[Stage]添加到标签中。
- en: You will want to show the value of each stage in the pipeline. Remember that
    regardless of which stage any opportunity is at, it will have passed through each
    of the previous stages. This means that we need to roll back the values of each
    stage into the prior stage—even though the data does not technically exist in
    our dataset. We can do this with table calculations.
  id: totrans-200
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将希望显示管道中每个阶段的值。请记住，无论机会处于哪个阶段，它都将通过每个前期阶段。这意味着我们需要将每个阶段的值回滚到上一个阶段，即使这些数据在我们的数据集中技术上并不存在。我们可以通过表格计算来实现这一点。
- en: 'Create a calculation called `**[Stage Value Label]**`:'
  id: totrans-201
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Stage Value Label]**`的计算：
- en: '[PRE15]'
  id: totrans-202
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: This will add labels to model values that are equal to 1.
  id: totrans-203
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将为模型值添加标签，其值等于1。
- en: 'Since your values will be in both thousands of dollars and millions of dollars,
    there is no need to show precision to the nearest dollar. You might prefer to
    show a *K* for thousands and an *M* for millions. You can do that with a custom
    calculation:'
  id: totrans-204
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 由于您的值将分别为千元和百万元，因此无需显示到最接近的美元。您可能更喜欢在千位数和百万位数中显示*K*和*M*。您可以通过自定义计算来实现这一点：
- en: '[PRE16]'
  id: totrans-205
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This calculation will round to values below one billion.
  id: totrans-206
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这个计算将四舍五入到低于十亿的值。
- en: Add [Stage Value Suffix] to Text on the Marks card. Edit the table calculation
    and select Specific Dimensions and then select the Stage checkbox. You will also
    want to add a custom sort. Use a descending sort on the Sort calculation, using
    Minimum as the aggregation. This table calculation is shown in [Figure 10-26](#the_table_calculation_and_custom_sort_fo).
  id: totrans-207
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在Marks卡上的文本中添加[Stage Value Suffix]。编辑表格计算，选择特定维度，然后选择阶段复选框。您还需要添加自定义排序。使用Minimum作为聚合的排序计算进行降序排序。此表格计算显示在[图10-26](#the_table_calculation_and_custom_sort_fo)中。
- en: The result of this table calculation is actually a great hidden trick of Tableau.
    We are doing a table calculation up the table! Tableau regularly suggests “Table
    (across)” and “Table (down).” But there is never a Table (up) option. This proves
    you can do it; you just have to use a custom sort.
  id: totrans-208
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这个表格计算的结果实际上是Tableau的一个伟大的隐藏技巧。我们正在对表格进行表格计算！Tableau经常建议“表格（横向）”和“表格（纵向）”。但从来没有“表格（上）”选项。这证明你可以做到；你只需要使用自定义排序。
- en: '![The table calculation and custom sort for the labels in the funnel calculation](Images/TAST_1026.png)'
  id: totrans-209
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![漏斗计算中标签的表格计算和自定义排序](Images/TAST_1026.png)'
- en: Figure 10-26\. The table calculation and custom sort for the labels in the funnel
    calculation
  id: totrans-210
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-26\. 漏斗计算中标签的表格计算和自定义排序
- en: 'Create a calculation called `**[% Closed]**` that will show the percentage
    of opportunities that closed at each stage:'
  id: totrans-211
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[% Closed]**`的计算，显示每个阶段关闭的机会百分比：
- en: '[PRE17]'
  id: totrans-212
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Add [% Closed] to Text and then edit the table calculations. Set both of the
    [% Closed] table calculations to match the table calculation in step 7b, and sort
    minimum descending.
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[% Closed]添加到文本，然后编辑表格计算。将两个[% Closed]表格计算设置为与步骤7b中的表格计算匹配，并按最小降序排序。
- en: Format the text to match [Figure 10-27](#the_text_editor_for_the_funnel_labels),
    including changing [% Closed] to display as a percentage. [Stage] should be a
    smaller font than [Stage Value Suffix]. Format [% Closed] to be the smallest,
    lightest-colored font.
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 格式化文本以匹配[图10-27](#the_text_editor_for_the_funnel_labels)，包括将[% Closed]更改为百分比显示。[Stage]应该比[Stage
    Value Suffix]字体小。将[% Closed]格式化为最小、最轻色的字体。
- en: '![The text editor for the funnel labels](Images/TAST_1027.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![漏斗标签的文本编辑器](Images/TAST_1027.png)'
- en: Figure 10-27\. The text editor for the funnel labels
  id: totrans-216
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-27\. 漏斗标签的文本编辑器
- en: '[Figure 10-28](#the_final_funnel_chart) shows the resulting funnel. It shows
    the change from stage to stage while maintaining the look and feel of an actual
    funnel. You put a lot of effort into this chart. You probably don’t need to put
    this sort of effort into every chart you create—but in some cases, your audiences
    will want more-polished, infographic-like charts. In these cases, you’ll probably
    need to use data modeling.'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '[图10-28](#the_final_funnel_chart)展示了生成的漏斗图。它显示了从阶段到阶段的变化，同时保持了实际漏斗的外观和感觉。您在这个图表中投入了很多精力。您可能不需要在每个创建的图表中投入这种程度的努力，但在某些情况下，您的观众可能会希望得到更加精致、信息图表般的图表。在这些情况下，您可能需要使用数据建模。'
- en: In addition to learning how to apply principles of data modeling, you learned
    how to execute a table calculation that will go up (rather than down) a table.
    Remember that when you are modeling data, you need to think about what’s happening
    at every level. In this example, you have to think about what is going to happen
    for all four members of the Model dimension. You’ve modeled data for four corners
    of each stage. You’ve also controlled where the labels display by using `IF` statements.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 除了学习如何应用数据建模原则，您还学会了执行一个表计算，该计算将会上升（而不是下降）到一个表格。记住，在建模数据时，您需要考虑每个层次发生的情况。在本例中，您需要考虑模型维度的所有四个成员将会发生什么。您已经为每个阶段的四个角建模了数据。您还通过使用`IF`语句控制标签显示位置。
- en: This method of using placeholder data to model your visualization could have
    been used in the previous strategy. To do so, you would have had to model only
    two rows. But sometimes our data modeling doesn’t involve creating a placeholder
    dataset for the join; sometimes we just need to join back to our existing data
    source.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 此使用占位符数据来建模可视化的方法可以用于先前的策略。为此，您只需对两行数据进行建模。但有时我们的数据建模不涉及创建用于连接的占位数据集；有时我们只需将数据连接回我们现有的数据源即可。
- en: '![The final funnel chart](Images/TAST_1028.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![最终的漏斗图](Images/TAST_1028.png)'
- en: Figure 10-28\. The final funnel chart
  id: totrans-221
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-28\. 最终的漏斗图
- en: Market Basket Analysis
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Market Basket Analysis
- en: '*Market basket analysis* is a technique used by retailers, restaurants, and
    manufacturers to uncover associations among products. Market basket analysis looks
    for combinations of items that occur together frequently in transactions. By understanding
    transactions, you can understand the behaviors of customers.'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '*Market basket analysis* 是零售商、餐厅和制造商用来发现产品之间关联的技术。市场篮子分析寻找在交易中经常一起出现的物品组合。通过理解交易，您可以了解客户的行为。'
- en: 'Basket analysis is not an out-of-the-box analysis in Tableau. To complete this
    analysis, we need to use data modeling. But for this data model, we will relate
    one instance of the data source back to a duplicate version of the data. When
    you model data to itself, you will be increasing your data exponentially. Good
    news: Tableau’s logical layer makes the relationships simple, so your data doesn’t
    get too out of hand. Logical layers are one of two ways to work with data in Tableau.
    Starting with Tableau Desktop 2020.2, Tableau has allowed its users to build interactions
    at both the logical level and the physical level.'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 在Tableau中，篮子分析不是一个开箱即用的分析方法。要完成这种分析，我们需要使用数据建模。但是对于这个数据模型，我们将把数据源的一个实例与数据的一个副本版本相关联。当您将数据建模到自身时，您将会将数据指数增长。好消息是：Tableau的逻辑层使关系变得简单，因此您的数据不会变得混乱。逻辑层是在Tableau中处理数据的两种方法之一。从Tableau
    Desktop 2020.2开始，Tableau允许用户在逻辑层和物理层上构建交互。
- en: With logical levels, which Tableau calls *noodle relationships*, you can drag
    any data source onto the canvas and allow the data sources to have flexible relationships
    depending on the level of analysis on a worksheet. You do not need to specify
    join types for relationships, and instead Tableau will automatically select appropriate
    join types based on the fields and type of analysis on each worksheet. In some
    cases, Tableau may use the relationships to join the data types together; other
    times it might not use those relationships. It all depends on the analysis in
    your workbook. [Figure 10-29](#from_tableaucomma_this_is_an_example_of) shows
    an example of a logical table.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Tableau称为*noodle relationships*的逻辑层，您可以将任何数据源拖放到画布上，并允许数据源根据工作表上的分析级别具有灵活的关系。您无需为关系指定连接类型，而是Tableau会根据字段和工作表上的分析类型自动选择适当的连接类型。在某些情况下，Tableau可能会使用关系将数据类型连接在一起；其他时候可能不会使用这些关系。这完全取决于您工作簿中的分析。[图10-29](#from_tableaucomma_this_is_an_example_of)展示了一个逻辑表的示例。
- en: '![From Tableau, this is an example of a logical table](Images/TAST_1029.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![来自Tableau，这是逻辑表的一个示例](Images/TAST_1029.png)'
- en: Figure 10-29\. From [Tableau](https://oreil.ly/hTOcx), this is an example of
    a logical table
  id: totrans-227
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-29\. 来自[Tableau](https://oreil.ly/hTOcx)，这是逻辑表的一个示例。
- en: Tip
  id: totrans-228
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: For more detail on how the relationships work, we highly recommend this [Tableau
    Help article](https://oreil.ly/n2sVV).
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更详细的关系工作，请参阅这篇[Tableau 帮助文章](https://oreil.ly/n2sVV)。
- en: Think of a relationship as a contract between two tables. When you are building
    a visualization with fields from these tables, Tableau brings in data from the
    tables by using that contract to build a query with the appropriate joins.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 将关系视为两个表之间的合同。当您使用这些表的字段构建可视化时，Tableau使用该合同构建查询，并进行适当的连接，从表中引入数据。
- en: Unlike logical tables, *physical tables* use joins to merge data from two tables
    into a single table before your analysis begins. Unlike the logical model, merging
    tables can cause data to be duplicated, filtered from one or both tables, or cause
    NULL rows to be added to your data. Joins provide you greater control over your
    data, but also require you to understand exactly what you are doing to your data
    and where consequences could occur. For many of our examples, we are going to
    use physical tables. [Figure 10-30](#from_tableaucomma_this_is_an_exa-id00029)
    shows an example.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 与逻辑表不同，*物理表*在分析开始前使用连接将两个表中的数据合并到一个表中。与逻辑模型不同，合并表可能导致数据重复，来自一个或两个表的数据被过滤，或者数据中添加
    NULL 行。连接可以让您更好地控制数据，但也需要您准确理解操作数据的方式及其可能产生的后果。在我们的许多示例中，我们将使用物理表。[图 10-30](#from_tableaucomma_this_is_an_exa-id00029)显示了一个示例。
- en: '![From Tableau, this is an example of a physical table](Images/TAST_1030.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![来自Tableau，这是物理表的一个示例](Images/TAST_1030.png)'
- en: Figure 10-30\. From [Tableau](https://oreil.ly/DCVR7), this is an example of
    a physical table
  id: totrans-233
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-30\. 来自[Tableau](https://oreil.ly/DCVR7)，这是物理表的一个示例。
- en: 'Strategy: Basket Analysis'
  id: totrans-234
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：篮子分析
- en: 'When doing basket analysis, you often need to calculate three metrics: support,
    confidence, and lift. Each is somewhat dependent on the next. Of these metrics,
    lift is the most important. *Lift* is a ratio that represents the odds of two
    items occurring within a single transaction over the odds of the two items showing
    up independently in transactions.'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行篮子分析时，您通常需要计算三个指标：支持度、置信度和提升度。这些指标彼此有一定的依赖关系。其中，提升度最重要。*提升度*是一个比率，表示两个项目在单个交易中出现的几率与两个项目在独立交易中出现的几率之比。
- en: Let’s consider an example. Imagine we have a dataset with 100 transactions.
    In 25 of the transactions, customers bought binders; 10 of the transactions were
    for fasteners; and 5 transactions included both binders and fasteners. Let’s say
    our hypothesis is that Binders lifts (increases) Fasteners sales.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一个例子。假设我们有一个包含 100 笔交易的数据集。在其中 25 笔交易中，顾客购买了活页夹；有 10 笔交易是购买紧固件；而有 5 笔交易同时包含了活页夹和紧固件。假设我们的假设是活页夹提升（增加）了紧固件的销售。
- en: '*Support* is calculated by finding the percentage of occurrences in which both
    items were purchased—in this case, 5/100, which is 5%.'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '*支持度*通过计算同时购买两个项目的出现百分比来计算—在这种情况下为 5/100，即 5%。'
- en: '*Confidence* is simply the number of purchases including both items divided
    by the number of transactions for fasteners—in this case, 5/10, or 0.5\. Confidence
    can also be calculated as the support percentage divided by the percent of transactions
    for fasteners—in this case, again, 5%/10%, which is 50%.'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: '*置信度*是包括两个项目的所有购买次数除以紧固件交易次数的比率—在这种情况下为 5/10，或者 0.5。置信度还可以通过支持百分比除以紧固件交易百分比来计算—在这种情况下为
    5%/10%，即 50%。'
- en: Finally, we can calculate *lift*, which is confidence divided by the percent
    of transactions for binders—in this case, 0.5/0.25, which is 2.0\. So, for the
    lift of binders on fasteners—or vice versa—our final number is 2.0\. This means
    if you know a customer is purchasing binders, the probability of purchasing fasteners
    is 2.0, or double.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以计算*提升度*，即置信度除以活页夹交易百分比—在这种情况下为 0.5/0.25，即 2.0。因此，对于活页夹对紧固件的提升度—或反之—我们的最终数字是
    2.0。这意味着如果您知道客户正在购买活页夹，那么购买紧固件的概率是 2.0，即两倍。
- en: A lift value greater than 1 means the items depend on each other. Values equal
    to 1 mean there is no relationship. Values less than 1 mean there is a negative
    effect between the two and could mean that the items are substitutes for each
    other.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 提升值大于 1 表示项目彼此依赖。等于 1 的值表示没有关系。小于 1 的值表示两者之间存在负面影响，可能意味着两者是彼此的替代品。
- en: 'For this strategy, we will use logical tables—though the process would be nearly
    identical for physical tables. To complete a basket analysis, typically you need
    a lot of information to compare products. The Sample – Superstore dataset has
    9,994 rows of data, 1,849 products, and 5,009 transactions. This is not enough
    to do a basket analysis at the product level. For 1,849 we would probably need
    closer to 100,000 transactions to make the analysis worthwhile. Instead, we can
    roll our basket analysis to a higher level: the sub-category level. In our basket
    analysis, we will determine which sub-categories provide a lift for other sub-categories:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种策略，我们将使用逻辑表格 — 尽管对于物理表格，流程几乎相同。要完成购物篮分析，通常需要大量信息来比较产品。样本 – 超级商店数据集有 9,994
    行数据，1,849 种产品和 5,009 个交易。这些信息并不足以在产品级别进行购物篮分析。对于 1,849 种产品，我们可能需要接近 100,000 个交易来进行有意义的分析。因此，我们可以将购物篮分析转移到更高级别：子类别级别。在我们的购物篮分析中，我们将确定哪些子类别对其他子类别提供了提升：
- en: Open Tableau and add a data source. Connect to the Sample – Superstore dataset
    and then click and drag the Orders table onto the data view ([Figure 10-31](#connecting_to_the_orders_table_in_sample)).
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 Tableau 并添加数据源。连接到样本 – 超级商店数据集，然后点击并拖动订单表到数据视图中（参见[图 10-31](#连接到样本 – 超级商店中的订单表)）。
- en: '![Connecting to the Orders table in Sample – Superstore](Images/TAST_1031.png)'
  id: totrans-243
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![连接到样本 – 超级商店中的订单表](Images/TAST_1031.png)'
- en: Figure 10-31\. Connecting to the Orders table in Sample – Superstore
  id: totrans-244
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-31\. 连接到样本 – 超级商店中的订单表
- en: Next, take the same Orders table from Sheets on the Connections pane and click
    and drag the same Orders table onto the Data pane. These sources will attempt
    to connect with a noodle, shown in [Figure 10-32](#editing_the_logical_relationship_between).
    Because you are using the same dataset twice, Tableau will require you to select
    fields to join on. Let’s join [Order ID] on Orders to [Order ID] on Orders1\.
    Let’s also join [Sub-Category] to [Sub-Category]—but change the sign from equal-to
    to less-than-or-equal-to. Without giving too much away, this sign change will
    create a cleaner final visualization showing just a cross-section of analysis
    in the matrix, rather than the full matrix.
  id: totrans-245
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 接下来，从连接面板的表格中选取同样的订单表，并将其拖放到数据面板上。这些数据源将尝试通过一根连接线连接，如[图 10-32](#编辑相同数据源之间的逻辑关系)所示。由于您使用了同一数据集两次，Tableau
    将要求您选择用于连接的字段。让我们将[订单 ID]与 Orders 表上的 [订单 ID] 进行连接。同时，将 [子类别] 连接到 [子类别]，但更改等于符号为小于或等于符号。不多说了，这种符号变更将创建一个更清晰的最终可视化，仅显示矩阵分析的交叉部分，而不是整个矩阵。
- en: Remember, we are going to do our basket analysis at the Sub-Category level.
    If we were doing analysis at the product level, you would join on Product. You
    do not need to make any other joins—even though the data is identical.
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请记住，我们将在子类别级别进行购物篮分析。如果我们进行产品级别的分析，您将连接到产品。您无需进行其他连接，即使数据是相同的。
- en: '![Editing the logical relationship between the same data sources. Note the
    less-than-or-equal-to sign on Sub-Category](Images/TAST_1032.png)'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![编辑相同数据源之间的逻辑关系。请注意子类别上的小于或等于符号](Images/TAST_1032.png)'
- en: Figure 10-32\. Editing the logical relationship between the same data sources.
    Note the less-than-or-equal-to sign on Sub-Category
  id: totrans-248
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-32\. 编辑相同数据源之间的逻辑关系。请注意子类别上的小于或等于符号
- en: When you are done creating these joins, you can go to a new sheet.
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当您完成创建这些连接后，可以进入新的工作表。
- en: You’ll notice with this data connection you have each field duplicated on your
    Data pane—one for the initial Orders dataset and one for the Orders dataset you
    joined in. Tableau renamed the Orders dataset you joined in to Orders1, to help
    clarify the data sources. This is also why you see half of your measures and dimensions
    with (Orders1) as a suffix in the field name.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您会注意到，在此数据连接中，您的数据面板上的每个字段都重复出现 — 一个是初始订单数据集的，另一个是您加入的订单数据集的。Tableau 将加入的订单数据集重命名为
    Orders1，以帮助澄清数据源。这也是您在字段名称中看到一半度量和维度带有 (Orders1) 后缀的原因。
- en: Add [Sub-Category] to Columns and [Sub-Category (Order1)] to Rows. You will
    notice that Abc shows up on only half of the fields separated on the diagonal
    ([Figure 10-33](#the_market_basket_analysis_after_adding)).
  id: totrans-251
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [子类别] 添加到列中，将 [子类别 (Orders1)] 添加到行中。您会注意到 Abc 只显示在对角线上的一半字段上（参见[图 10-33](#添加维度到行和列后的市场篮分析)）。
- en: '![The market basket analysis after adding dimensions to Rows and Columns](Images/TAST_1033.png)'
  id: totrans-252
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![添加维度到行和列后的市场篮分析](Images/TAST_1033.png)'
- en: Figure 10-33\. The market basket analysis after adding dimensions to Rows and
    Columns
  id: totrans-253
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-33。在行和列中添加维度后的市场篮分析
- en: 'In market basket analysis, *support* is the total transactions containing *x*
    and *y* divided by the total transactions. Create a calculation called `**[Support]**`:'
  id: totrans-254
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在市场篮分析中，*支持*是包含*x*和*y*的总交易数除以总交易数。创建一个名为`**[支持]**`的计算：
- en: '[PRE18]'
  id: totrans-255
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'If you are asking yourself which Order ID you should be using: it doesn’t matter.
    Because we joined our datasets on [Order ID], they will be identical. We personally
    prefer the shorter version because it makes our functions easier to read.'
  id: totrans-256
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您在问自己应该使用哪个订单ID：没关系。因为我们在[订单ID]上加入了数据集，它们将是相同的。我们个人更喜欢较短的版本，因为这样更容易阅读我们的函数。
- en: Note that we are using an LOD calculation to return the total orders in the
    entire dataset. In one quirk of Tableau, it is not possible to calculate the total
    orders by using a table calculation because of the use of the `COUNTD()` function.
  id: totrans-257
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，我们使用LOD计算来返回整个数据集中的总订单数。在Tableau的一个特殊情况中，由于使用了`COUNTD()`函数，无法使用表计算来计算总订单数。
- en: '*Confidence* is calculated by counting the total transactions containing *x*
    and *y* and dividing it by the transactions containing only *x*. There are several
    ways to write this calculation, but for this example, we’ll use the [Support]
    calculation to create the `**[Confidence]**` calculation:'
  id: totrans-258
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*置信度*通过计算包含*x*和*y*的总交易量并除以仅包含*x*的交易量来计算。有几种编写此计算的方法，但在此示例中，我们将使用[支持]计算来创建`**[置信度]**`计算：'
- en: '[PRE19]'
  id: totrans-259
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '*Lift* is calculated by taking the confidence calculation and dividing it by
    the proportion of orders containing *y*. Create a calculation called `**[Lift]**`:'
  id: totrans-260
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '*Lift*通过将置信度计算除以包含*y*的订单比例来计算。创建一个名为`**[Lift]**`的计算：'
- en: '[PRE20]'
  id: totrans-261
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: After you have created the [Lift] calculation. Add [Lift] to Text on the Marks
    card. Then change the mark type to Square and add [Lift] to Color as well. The
    result is [Figure 10-34](#the_market_basket_analysis_after-id00030).
  id: totrans-262
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 创建了[Lift]计算后。将[Lift]添加到标记卡上的文本。然后将标记类型更改为正方形，并将[Lift]也添加到颜色中。结果是[图 10-34](#the_market_basket_analysis_after-id00030)。
- en: '![The market basket analysis after adding [Lift] to Text and Color](Images/TAST_1034.png)'
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![在文本和颜色中添加[Lift]后的市场篮分析](Images/TAST_1034.png)'
- en: Figure 10-34\. The market basket analysis after adding [Lift] to Text and Color
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-34。在添加[Lift]到文本和颜色后的市场篮分析
- en: If you take a look at the analysis, you will notice a very high association
    between Paper and Copiers. This probably makes sense! What about Tables and Copiers?
    Does every person need to buy a table to go with a copier? Maybe to put the copier
    on a table. Or maybe we don’t have enough data to make that kind of inference.
    What might make sense is that we have a minimum number of orders in each cell
    before we show data.
  id: totrans-265
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您仔细观察分析，您会注意到纸张和复印机之间存在非常高的关联性。这可能是有道理的！那么桌子和复印机呢？每个人都需要买一个桌子来配合复印机吗？也许是为了把复印机放在桌子上。或者也许我们没有足够的数据来做这种推断。也许有意义的是，我们在显示数据之前在每个单元格中有一个最小订单数。
- en: 'Let’s say we need at least 10 orders before we want to show a cell. We could
    add a filter, but that would just make that cell disappear. It would be better
    if the cell was a different color and the text was omitted. We can do that with
    a parameter and a few different colors:'
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设我们至少需要10个订单才能显示一个单元格。我们可以添加一个过滤器，但这只会使该单元格消失。如果单元格是不同的颜色并且文本被省略，会更好。我们可以通过参数和几种不同的颜色来做到这一点：
- en: Create an integer parameter called `**[Min Orders]**` and set the value to 10.
  id: totrans-267
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[最小订单]**`的整数参数，并将其值设置为10。
- en: 'Create a calculation called `**[Lift | Color]**`:'
  id: totrans-268
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Lift | Color]**`的计算：
- en: '[PRE21]'
  id: totrans-269
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Click and drag [Lift | Color] to replace Lift. Edit the color to change the
    palette to Green-Blue-White Diverging (or whatever palette you prefer). Click
    Apply. Then edit the blue to be #D3D3D3\. Select the Use Full Color Range and
    Reversed checkboxes. Under your advanced settings, change the range to be hardcoded
    from –1 to 5 (which is a lot in real life). Fix the center to 0\. [Figure 10-35](#color_settings_for_left_square_bracketli)
    shows the color settings.'
  id: totrans-270
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[Lift | Color]拖动到替换Lift。编辑颜色以将调色板更改为绿-蓝-白分散（或您喜欢的任何调色板）。点击应用。然后编辑蓝色以设置为#D3D3D3。选择使用全色范围和反转复选框。在高级设置下，将范围硬编码设置为从-1到5（这在实际生活中是很多的）。将中心固定为0。[图 10-35](#color_settings_for_left_square_bracketli)展示了颜色设置。
- en: '![Color settings for [Lift | Color] on the market basket analysis](Images/TAST_1035.png)'
  id: totrans-271
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![市场篮分析上的[Lift | Color]的颜色设置](Images/TAST_1035.png)'
- en: Figure 10-35\. Color settings for [Lift | Color] on the market basket analysis
  id: totrans-272
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-35\. [Lift | Color]的市场篮分析的颜色设置
- en: 'Create a new label calculation for lift called `**[Lift | Label]**`:'
  id: totrans-273
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[提升 | 标签]**`的新标签计算：
- en: '[PRE22]'
  id: totrans-274
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Click and drag [Lift | Label] to replace [Lift]. The resulting visual is shown
    in [Figure 10-36](#the_market_basket_analysiscomma_adjusted).
  id: totrans-275
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 点击并拖动[Lift | Label]以替换[Lift]。结果视觉效果如[图10-36](#the_market_basket_analysiscomma_adjusted)所示。
- en: '![The market basket analysis, adjusted to show at least 10 orders per cell](Images/TAST_1036.png)'
  id: totrans-276
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![市场篮分析，调整以显示每个单元格至少10个订单](Images/TAST_1036.png)'
- en: Figure 10-36\. The market basket analysis, adjusted to show at least 10 orders
    per cell
  id: totrans-277
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-36\. 调整后的市场篮分析，以显示每个单元格至少10个订单
- en: You have completed a market basket analysis and are showing only cells with
    enough orders. You now have enough orders to say the lift between Paper and Copiers
    is extremely high! (PS. While we used a threshold of only 10 with our example,
    you might want this to be closer to 100 or even 300 in reality—there’s no reason
    to return a false positive on any relationship.)
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你已完成了市场篮分析，并且仅显示具有足够订单的单元格。现在你有足够的订单来说明纸张和复印机之间的提升非常高！（附注：虽然我们在示例中使用了仅为10的阈值，但在实际情况下，您可能希望将其接近100甚至300——没有理由在任何关系上返回假阳性。）
- en: If you wanted to call your analysis complete here, you could. And you would
    probably want to add row and column dividers for every cell. But we’re not going
    to stop here.
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你想在这里完成你的分析，你可以。你可能想为每个单元格添加行和列分隔符。但我们不会停在这里。
- en: 'One frustration with this chart is that the labels are at the top! We want
    the labels to be on the left (and right-aligned) and on the bottom (and top-aligned).
    How can we do this? Well, we have to trick Tableau just a little:'
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这个图表的一个令人沮丧的地方是标签在顶部！我们希望标签在左侧（右对齐）和底部（顶对齐）。我们该怎么做呢？好吧，我们必须稍微欺骗Tableau：
- en: Double-click Rows and type `**MIN(0.0)**` to create an ad hoc calculation. This
    is going to significantly change our chart type. Don’t panic! First, notice that
    our chart now has squares on each cell; this matches our mark type selection of
    Square! Next, notice we’ve added an axis next to the members of [Sub-Category];
    see [Figure 10-37](#if_you_see_thiscomma_donapostrophet_pani).
  id: totrans-281
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击行并输入`**MIN(0.0)**`来创建一个临时计算。这将显著改变我们的图表类型。不要惊慌！首先注意到我们的图表现在每个单元格都有方块；这与我们选择的标记类型Square相匹配！接下来，注意我们在[子类别]成员旁边添加了一个轴；参见[图10-37](#if_you_see_thiscomma_donapostrophet_pani)。
- en: '![If you see this, don’t panic! This is what your chart should look like after
    step 4a.](Images/TAST_1037.png)'
  id: totrans-282
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![如果你看到这个，请不要惊慌！这是你的图表在第4a步之后应该看起来的样子。](Images/TAST_1037.png)'
- en: Figure 10-37\. If you see this, don’t panic! This is what your chart should
    look like after step 4a.
  id: totrans-283
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-37\. 如果你看到这个，请不要惊慌！这是你的图表在第4a步之后应该看起来的样子。
- en: Change your mark type from Square to Gantt. Create an ad hoc calculation on
    the Marks card by typing `**MIN(1.0)**`. Then add this calculation to Size. This
    will change the depth of the bars. Edit the width by changing the slider to the
    largest size possible.
  id: totrans-284
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型从方块更改为甘特图。通过在Marks卡片上输入`**MIN(1.0)**`创建一个临时计算。然后将此计算添加到大小。这将改变条形的深度。通过将滑块调整到最大尺寸来编辑宽度。
- en: Edit the MIN(0.0) axes and set the range of the axes from 0 to 1; then hide
    the axes.
  id: totrans-285
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑MIN(0.0)轴，并将轴的范围设置为0到1；然后隐藏轴。
- en: Click the Text button and then align the text to the center and middle.
  id: totrans-286
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击文本按钮，然后将文本对齐到中心和中间。
- en: Remove all the grid lines, axis lines, and axis rulers.
  id: totrans-287
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除所有网格线、轴线和轴标尺。
- en: Add row and column dividers that match your background. Adjust the size on the
    Marks card down ever so slightly to match the row dividers.
  id: totrans-288
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加与背景匹配的行和列分隔符。稍微调整Marks卡片上的大小，以匹配行分隔符。
- en: Right-align the members of [Sub-Category]. Top-align members of [Sub-Category
    (Orders1)]. Finally, hide label fields for rows and columns to get the visual
    shown in [Figure 10-38](#our_market_basket_analysis_for_sub-categ).
  id: totrans-289
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右对齐[子类别]成员。顶部对齐[子类别（订单1）]成员。最后，隐藏行和列的标签字段，以获得[图10-38](#our_market_basket_analysis_for_sub-categ)中显示的视觉效果。
- en: '![Our market basket analysis for Sub-Category using the Sample – Superstore
    dataset](Images/TAST_1038.png)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![使用样本-超级商店数据集的子类别的我们的市场篮分析](Images/TAST_1038.png)'
- en: Figure 10-38\. Our market basket analysis for Sub-Category using the Sample
    – Superstore dataset
  id: totrans-291
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-38\. 使用样本-超级商店数据集的子类别的我们的市场篮分析
- en: In this strategy, you learned how to model data to itself. This allowed you
    to do a market basket analysis. In addition to building out the matrix, you were
    able to calculate lift for each sub-category. To do this, you couldn’t use a table
    calculation and had to use an LOD calculation. You also learned how to place labels
    at the bottom of a visualization that looks like a grid by using a Gantt chart.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您学习了如何将数据建模到自身。这使您能够进行市场篮分析。除了构建矩阵之外，您还能够计算每个子类别的提升。为此，您不能使用表计算，而必须使用LOD计算。您还学会了如何通过使用甘特图在可视化的底部放置类似网格的标签。
- en: In the end, our final product is a very clean-looking matrix displaying lift
    for all categories. With the addition of the spacing between each cell, the eyes
    of our audience will be able to quickly track which two sub-categories they are
    comparing—and identify the total lift.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，我们的最终产品是一个非常干净的矩阵，显示了所有类别的提升。通过增加每个单元格之间的间距，我们的观众可以快速追踪他们正在比较的两个子类别，并确定总提升。
- en: 'Strategy: Build a Multidimension Waterfall'
  id: totrans-294
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：构建多维瀑布图
- en: In this chapter, we’ve tackled data modeling through table calculations, unions,
    and joins. You will be able to get to 90% of your solutions through these techniques.
    One of the last unique, but consistent, problems we’ve encountered are with financial
    statements that use multiple measures to calculate a final metric.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们通过表计算、联合和连接解决了数据建模的问题。通过这些技术，您将能够解决90%的问题。我们遇到的最后一个独特但一贯的问题是使用多个度量计算最终指标的财务报表。
- en: For instance, if you are creating a profit-and-loss statement, revenue minus
    cost of goods is gross profit. Gross profit minus operating expenses is earnings
    before interest and taxes (EBIT). If you consider the flowing nature of the metrics,
    you can think of them almost as a waterfall. And many people like to visualize
    these as a waterfall too. Waterfall charts are used only in accounting; they are
    used to analyze everything from supply chains to human capital.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您正在创建损益表，收入减去商品成本就是毛利润。毛利润减去营业费用就是利息和税前利润（EBIT）。如果您考虑指标的流动性质，您几乎可以将它们视为瀑布。许多人也喜欢将这些可视化为瀑布图。瀑布图仅用于会计；它们用于分析从供应链到人力资本的所有内容。
- en: For this strategy, we will work with a modified version of Sample – Superstore.
    This modified data source has several additional columns including MSRP (Manufacturer
    Suggested Retail Price), Promotional Cost, Manufacturing Cost, Transportation
    Cost, and Administrative Cost. Unlike most tutorials, where you create a waterfall
    chart with a single measure and a single dimension, we want you to visualize this
    waterfall with multiple dimensions.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个策略，我们将使用Sample – Superstore的修改版本。这个修改后的数据源有几个额外的列，包括MSRP（制造商建议零售价）、促销成本、制造成本、运输成本和管理成本。与大多数教程不同，在那里您使用单一度量和单一维度创建瀑布图，我们希望您使用多维度来可视化这个瀑布图。
- en: 'The use of multiple dimensions puts your data in a less-than-ideal state for
    Tableau. And ideally, you would pivot all of your measures into a set of dimensions
    and values by using a tool like SQL, Tableau Prep, Alteryx, Python, or R. But
    sometimes you don’t get that luxury because of your data source. So we want to
    show you how to create a waterfall chart when you are stuck using multiple dimensions.
    There’s good news with this method, though: even though it’s harder to use, you
    can actually build more flexible visualizations. With this technique. your waterfall
    is fully customizable: you can create totals at any point in your waterfall, place
    labels on specific bars, or update labels with very little effort.'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 使用多维度会使您的数据处于不理想的状态，不适合Tableau。理想情况下，您应该通过使用SQL、Tableau Prep、Alteryx、Python或R等工具将所有测量数据旋转成一组维度和值。但由于数据源的原因，有时候您无法这样做。因此，我们想向您展示如何在使用多维度时创建瀑布图。不过，这种方法也有好消息：即使难以使用，您实际上可以构建更灵活的可视化。通过这种技术，您的瀑布图是完全可定制的：您可以在瀑布的任意点创建总计，将标签放置在特定的柱形图上，或者仅需很少的努力就可以更新标签。
- en: '![A waterfall chart using multiple dimensions](Images/TAST_1039.png)'
  id: totrans-299
  prefs: []
  type: TYPE_IMG
  zh: '![使用多维度的瀑布图](Images/TAST_1039.png)'
- en: Figure 10-39\. A waterfall chart using multiple dimensions
  id: totrans-300
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-39\. 使用多维度的瀑布图
- en: For instance, if you take a look at [Figure 10-39](#a_waterfall_chart_using_multiple_dimensi),
    you will notice that we have full bars not just for the starting and ending values
    of MSRP and Profit, but we’ve also included a total for Sales. In this strategy,
    we will re-create this example and add a filter for the region of sales. Remember,
    we’re going to do some data modeling, so you’ll need your text editor handy to
    build a custom dataset.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您查看[图10-39](#a_waterfall_chart_using_multiple_dimensi)，您会注意到，我们不仅为MSRP和利润的起始和结束值设置了完整的条形，还为销售总额包含了一个总数。在这个策略中，我们将重新创建这个示例，并为销售地区添加一个过滤器。请记住，我们将进行一些数据建模，因此您需要将您的文本编辑器方便地用于构建自定义数据集。
- en: The reason you need to create a placeholder dataset is that your only option
    for a sustainable single-sheet solution would be to use [Measure Names] and [Measure
    Values.] And under our current constraints, you’re going to have to apply a table
    calculation to [Measure Values].
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要创建一个占位符数据集的原因是，您的唯一可持续单表解决方案选项将是使用[测量名称]和[测量值]。根据我们目前的限制条件，您将不得不对[测量值]应用表计算。
- en: Before we start building our solution, let’s take a look at [Figure 10-40](#a_waterfall_solution_that_just_wonapostr)
    to see how far you would have gotten by using [Measure Names] and [Measure Values]
    with no additional calculations.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始构建解决方案之前，让我们看看[图10-40](#a_waterfall_solution_that_just_wonapostr)，看看如果您仅使用[测量名称]和[测量值]且没有额外的计算，您能达到多远。
- en: '![A waterfall solution that just won’t work using [Measure Names] and [Measure
    Values]](Images/TAST_1040.png)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
  zh: '![一个无法使用[测量名称]和[测量值]解决的瀑布图解决方案](Images/TAST_1040.png)'
- en: Figure 10-40\. A waterfall solution that just won’t work using [Measure Names]
    and [Measure Values]
  id: totrans-305
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-40. 一个无法使用[测量名称]和[测量值]解决的瀑布图解决方案
- en: 'To make a waterfall with multiple measures, you need to create a very simple
    secondary data source:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建带有多个措施的瀑布图，您需要创建一个非常简单的辅助数据源：
- en: Find and connect to the Sample – Superstore – Modified data source. Nothing
    special, yet.
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找并连接到样本 - 超级商店 - 修改后的数据源。没什么特别的。
- en: To build our solution, we are going to do a data blend. But we don’t need a
    particularly interesting dataset for the blend.
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要构建我们的解决方案，我们将进行数据混合。但是我们并不需要一个特别有趣的数据集用于混合。
- en: Note
  id: totrans-309
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注
- en: A *blend* allows you to place measures or dimensions from multiple data sources
    on the same sheet. If you want to read more, we suggest you start with Tableau’s
    help section on [blends](https://oreil.ly/jz9Bk).
  id: totrans-310
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*混合* 允许您在同一张表上放置来自多个数据源的措施或维度。如果您想要阅读更多信息，建议从Tableau关于[混合](https://oreil.ly/jz9Bk)的帮助部分开始。'
- en: 'For our example, we are working with seven separate measures. We need to build
    a new data source to help support these measures. In your text editor, type the
    following:'
  id: totrans-311
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于我们的示例，我们正在处理七个单独的措施。我们需要建立一个新的数据源来支持这些措施。在您的文本编辑器中，输入以下内容：
- en: '[PRE23]'
  id: totrans-312
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Then save the file as *values.csv*. These seven values will eventually be assigned
    to each of our measures of interest.
  id: totrans-313
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 然后将文件保存为*values.csv*。这七个值最终将分配给我们感兴趣的每一个措施。
- en: Create a new data source connection and connect to *values.csv*. You do not
    need to join your data sources together. In, fact we want them as two completely
    different data sources.
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的数据源连接，并连接到*values.csv*。您无需将数据源连接在一起。事实上，我们希望它们是两个完全不同的数据源。
- en: Before we start building our calculations, we just want to tell you that we
    are going to do something slightly unorthodox; we are going to include measures
    from our modified superstore data and add them to calculations in the Values data
    source. This was far more commonplace in the earlier versions of Tableau, before
    the existence of LOD calculations or being able to join multiple data sources
    together.
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在我们开始构建计算之前，我们只想告诉您，我们将要做一些略显非正统的事情；我们将从我们修改后的超级商店数据中包含措施，并将它们添加到Values数据源的计算中。这在Tableau早期版本中非常常见，早在LOD计算或能够连接多个数据源之前。
- en: With this visualization, we are going to create a Gantt mark type. With a Gantt
    chart, we need to identify the start point for each Gantt bar and to specify the
    length of the bar. Additionally, we’re going to use a line to connect all the
    bars together. To do this, we need three separate calculations. In addition to
    calculations specific to the Gantt bars, we’ll use calculations that control the
    labels of our chart and the color of the bar—technically, this color could apply
    to any chart type.
  id: totrans-316
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过这个可视化，我们将创建一个甘特标记类型。在甘特图中，我们需要确定每个甘特条的起始点并指定条的长度。此外，我们将使用一条线连接所有的条。为此，我们需要三个单独的计算。除了专门用于甘特条的计算外，我们还将使用控制图表标签和条形颜色的计算
    —— 从技术上讲，这种颜色可以适用于任何图表类型。
- en: Click the Values data source. Then click and drag [Values] to Detail on the
    Marks card. Make sure [Values] is set to be a dimension and not an aggregation.
    Change the mark type to Gantt.
  id: totrans-317
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击Values数据源。然后点击并将[Values]拖动到Marks卡片的详细信息上。确保[Values]设置为维度而不是聚合。更改标记类型为甘特。
- en: 'Using the Values data source, not the Sample – Superstore — Modified data source,
    create a new calculation called `**[Labels]**`. Type and save the following:'
  id: totrans-318
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Values数据源，而不是Sample – Superstore — Modified数据源，创建一个名为`**[标签]**`的新计算。键入并保存以下内容：
- en: '[PRE24]'
  id: totrans-319
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Since we will be completing a blend on our data sources, the key is that we
    use an aggregation, hence the `MIN()` function wrapped around [Values]. We will
    build a series of calculations around each of the members of the [Values] dimension.
  id: totrans-320
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 因为我们将在数据源上完成混合，关键是我们使用聚合函数，因此在[Values]周围包装了`MIN()`函数。我们将围绕[Values]维度的每个成员构建一系列计算。
- en: Click and add [Labels] to Columns. Right-click [Labels] on the Columns shelf
    and edit the sort. Select Manual and adjust the values to match the order shown
    in [Labels].
  id: totrans-321
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 点击并将[标签]添加到列。右键单击列架上的[标签]并编辑排序。选择手动并调整值以匹配[标签]中显示的顺序。
- en: 'Using the Values data source, not the Sample – Superstore — Modified data source,
    create a new calculation called `**[Start]**`. Type and save the following:'
  id: totrans-322
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Values数据源，而不是Sample – Superstore — Modified数据源，创建一个名为`**[起始]**`的新计算。键入并保存以下内容：
- en: '[PRE25]'
  id: totrans-323
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: The first thing you should notice is that we have measures that start with Orders
    (Sample – Superstore – Modified).
  id: totrans-324
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您应该注意到的第一件事是，我们有从Orders（Sample – Superstore – Modified）开始的度量。
- en: For [MSRP], [Sales], and [Profit], these bars are just the total values. Set
    those values to zero. All other values are part of the waterfall.
  id: totrans-325
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于[MSRP]、[Sales]和[Profit]，这些条只是总值。将这些值设为零。所有其他值都属于瀑布图。
- en: Add this calculation to Rows. You might get an error prompt asking how you should
    blend your data (you won’t need to worry about your blend) since it’s at a global
    level. At this point, your visualization will look similar to [Figure 10-41](#our_waterfall_chart_after_adding_start_t).
  id: totrans-326
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将此计算添加到行。您可能会收到一个错误提示，询问您应如何混合数据（您不需要担心混合），因为它是在全局级别进行的。此时，您的可视化将类似于[图 10-41](#our_waterfall_chart_after_adding_start_t)。
- en: '![Our waterfall chart after adding Start to the Rows shelf](Images/TAST_1041.png)'
  id: totrans-327
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![我们的瀑布图添加Start到Rows货架后](Images/TAST_1041.png)'
- en: Figure 10-41\. Our waterfall chart after adding Start to the Rows shelf
  id: totrans-328
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-41\. 我们的瀑布图添加Start到Rows货架后
- en: 'Using the Values data source, create a new calculation called `**[Bars]**`
    to determine the length of the Gantt bars. Type and save the following:'
  id: totrans-329
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Values数据源，创建一个名为`**[条形]**`的新计算，以确定甘特条的长度。键入并保存以下内容：
- en: '[PRE26]'
  id: totrans-330
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Add this calculation to Size. The chart will start looking correct.
  id: totrans-331
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将此计算添加到大小。图表将开始正确显示。
- en: Add [Bars] to Label on the Marks card. Align the text to the center and middle.
  id: totrans-332
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[条形]添加到Marks卡片的标签上。将文本对齐到中心和中间。
- en: 'Once again, using the Values data source, create a new calculation called `**[Color]**`.
    Type and save the following:'
  id: totrans-333
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次使用Values数据源，创建一个名为`**[颜色]**`的新计算。键入并保存以下内容：
- en: '[PRE27]'
  id: totrans-334
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: With Color, we will use the sign calculation. If a value is positive, it returns
    1; if it is negative, it returns –1; and if it is 0, it returns 0\. With our blend
    calculation, we need to do this for each value, but the results will be consistent.
  id: totrans-335
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用颜色，我们将使用符号计算。如果值为正，返回1；如果为负，返回–1；如果为0，则返回0。在我们的混合计算中，我们需要对每个值执行此操作，但结果将是一致的。
- en: Add [Color] to Color on the Marks card. Your visual will now look like [Figure 10-42](#our_waterfall_chart_after_adding_bar_len).
  id: totrans-336
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将[颜色]添加到Marks卡片的颜色上。现在您的可视化看起来像[图 10-42](#our_waterfall_chart_after_adding_bar_len)。
- en: '![Our waterfall chart after adding bar length and labels](Images/TAST_1042.png)'
  id: totrans-337
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![我们的瀑布图添加条长度和标签后](Images/TAST_1042.png)'
- en: Figure 10-42\. Our waterfall chart after adding bar length and labels
  id: totrans-338
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-42\. 在添加条长度和标签后的瀑布图表
- en: 'We’re almost there: we just need to add a line to help the eye coordinate all
    the values.'
  id: totrans-339
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们快要完成了：我们只需要添加一条线来帮助眼睛协调所有的值。
- en: 'One last time, using the Values data source, create a new calculation called
    `**[Line]**`. Type and save the following:'
  id: totrans-340
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后一次，使用值数据源，创建一个名为`**[Line]**`的新计算。输入并保存以下内容：
- en: '[PRE28]'
  id: totrans-341
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE28]'
- en: You will use this calculation to help your audience track the values across
    the waterfall. Add this measure to the left of the start bars. Remove [Color]
    and [Bars] from this [Lines] Marks card. Change size to be about one-quarter of
    the maximum value. Click Path and change the mark type to Jump.
  id: totrans-342
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您将使用这个计算来帮助您的观众跟踪瀑布图中的值。将此度量添加到起始柱的左侧。从这个[Lines] Marks卡中移除[Color]和[Bars]。将大小更改为最大值的四分之一。点击路径并将标记类型更改为Jump。
- en: Right-click the Start axis and create a synchronized dual-axis chart. This gets
    you to [Figure 10-43](#the_waterfall_chart_after_adding_a_line), but there still
    a few steps to go.
  id: totrans-343
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 右键单击起始轴并创建一个同步的双轴图表。这将使您到达[图 10-43](#the_waterfall_chart_after_adding_a_line)，但还有几个步骤要走。
- en: '![The waterfall chart after adding a line to help your audience track its values](Images/TAST_1043.png)'
  id: totrans-344
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![在添加一条线帮助您的观众跟踪其值后的瀑布图表](Images/TAST_1043.png)'
- en: Figure 10-43\. The waterfall chart after adding a line to help your audience
    track its values
  id: totrans-345
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-43\. 在添加一条线帮助您的观众跟踪其值后的瀑布图表
- en: 'You are basically done. But it might make sense to clean up the details:'
  id: totrans-346
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 基本上就完成了。但清理细节可能是有道理的：
- en: Hide the Start axis on the right.
  id: totrans-347
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隐藏右侧的起始轴。
- en: Remove the [Lines] axis label.
  id: totrans-348
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除[Lines]轴标签。
- en: Set the row and column dividers to None.
  id: totrans-349
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将行和列的分隔线设置为无。
- en: Set the zero line to None.
  id: totrans-350
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将零线设置为无。
- en: Set the columns axis ruler and axis ticks to a very dark gray.
  id: totrans-351
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将列轴标尺和轴刻度设置为非常深灰色。
- en: Hide the field labels for Rows.
  id: totrans-352
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隐藏行的字段标签。
- en: The formatted result, shown in [Figure 10-44](#our_waterfall_chart), is a radiant
    waterfall chart that looks as if it came from a single data source.
  id: totrans-353
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 格式化的结果，显示在[图 10-44](#our_waterfall_chart)中，是一个光辉的瀑布图表，看起来好像来自单一的数据源。
- en: '![Our waterfall chart](Images/TAST_1044.png)'
  id: totrans-354
  prefs: []
  type: TYPE_IMG
  zh: '![我们的瀑布图表](Images/TAST_1044.png)'
- en: Figure 10-44\. Our waterfall chart
  id: totrans-355
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-44\. 我们的瀑布图表
- en: 'While this visualization looks great, you probably will want to know if we
    can filter this visualization. The answer: yes. There are two solutions to consider.
    We could use a standard filter or we could build a filter using a parameter.'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这个可视化看起来很棒，您可能想知道我们是否可以过滤这个可视化。答案是肯定的。有两种解决方案可供考虑。我们可以使用标准过滤器，或者可以使用参数构建过滤器。
- en: Let’s take a look at the standard filter. Go to the Orders (Sample – Superstore
    – Modified) dataset. Click and drag [Region] to Filters. Select Central and then
    show the filter. You will notice in [Figure 10-45](#our_waterfall_chart_with_a_region_filter)
    that the standard four regions show, but so does a Null value. This Null value
    shows up because of our blend. If your audience will be able to handle the Null
    option, then your visualization is complete!
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看标准过滤器。转到Orders（Sample – Superstore – Modified）数据集。点击并将[Region]拖动到过滤器中。选择Central然后显示过滤器。您将注意到在[图 10-45](#our_waterfall_chart_with_a_region_filter)中显示了标准的四个区域，但还有一个Null值。由于我们的混合，这个Null值出现了。如果您的观众能处理Null选项，那么您的可视化就完成了！
- en: '![Our waterfall chart with a region filter](Images/TAST_1045.png)'
  id: totrans-358
  prefs: []
  type: TYPE_IMG
  zh: '![我们带有区域过滤器的瀑布图表](Images/TAST_1045.png)'
- en: Figure 10-45\. Our waterfall chart with a region filter
  id: totrans-359
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-45\. 我们带有区域过滤器的瀑布图表
- en: But if your audience is not going to be satisfied with a Null value being shown,
    we can use a parameter as a filter. Right-click [Region] and select Create → Parameter.
    Name the parameter `**[Region Parameter]**`. Add an additional Parameter option
    called All and place the All member as the first value in the parameter list,
    as shown in [Figure 10-46](#when_setting_up_our_left_square_bracketr).
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，如果您的观众不满意显示空值，我们可以使用参数作为过滤器。右键单击[Region]，选择创建 → 参数。命名参数为`**[Region Parameter]**`。在参数列表中添加一个名为All的额外选项，并将All成员放置在参数列表的第一个位置，如[图 10-46](#when_setting_up_our_left_square_bracketr)所示。
- en: '![When setting up our [Region Parameter], it should look like.](Images/TAST_1046.png)'
  id: totrans-361
  prefs: []
  type: TYPE_IMG
  zh: '![在设置我们的[Region Parameter]时，它应该看起来像。](Images/TAST_1046.png)'
- en: Figure 10-46\. When setting up our [Region Parameter], it should look like.
  id: totrans-362
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-46\. 在设置我们的[Region Parameter]时，它应该看起来像。
- en: 'Create a new calculation called `**[Region | TF]**`:'
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Region | TF]**`的新计算：
- en: '[PRE29]'
  id: totrans-364
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Add [Region | TF] to Filters and select True. Then show [Region Parameter].
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 添加[Region | TF]到过滤器并选择True。然后显示[Region Parameter]。
- en: Congrats—you now have a filter driven by a parameter that does not include a
    Null label.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜您——您现在拥有了由参数驱动的过滤器，不包括空标签。
- en: In this strategy, you learned how to use a simple blend to create a visualization
    using multiple measures. This blend was extremely simple, but required you to
    use a rarely used method. In our next strategy, we’ll show you a new hack that
    is possible through mapping.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您学会了如何使用简单的混合技术创建使用多个度量值的可视化。这种混合技术非常简单，但要求您使用一种不常用的方法。在我们的下一个策略中，我们将向您展示通过地图可能的新技巧。
- en: 'Strategy: Layer Marks with Maps Without Making a Map'
  id: totrans-368
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用地图图层的分层标记但不制作地图
- en: 'In Tableau 2020.4, Tableau introduced map layers. There are some constraints
    for using map layers: for instance, values need to be between –180 and 180 for
    Latitude. However, map layers unlock the ability to have more than two mark types
    layered on the same sheet.'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 在Tableau 2020.4中，Tableau引入了地图图层。使用地图图层有一些限制：例如，纬度的值需在–180和180之间。但是，地图图层解锁了在同一工作表上分层超过两种标记类型的能力。
- en: In this strategy, we will show you how to create a multilayered visualization
    using map layers, as shown in [Figure 10-47](#a_small-multiple_area_and_line_chart_usi).
    This visualization will encompass many of the concepts you’ve learned throughout
    this book. You will create a small multiple of sales by sub-category. You will
    provide a summary by using a text layer. You will visualize prior-year sales with
    an area chart, and current-year sales with a line and two circle layers. And you
    will use custom shapes to create axes and labels.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，我们将向您展示如何使用地图图层创建多层次可视化，如[图 10-47](#a_small-multiple_area_and_line_chart_usi)所示。这种可视化将涵盖您在本书中学到的许多概念。您将创建一个按子类别分组的小多个销售。您将使用文本图层提供摘要信息。您将使用区域图可视化去年销售，使用线条和两个圆形图层可视化今年销售。您将使用自定义形状创建坐标轴和标签。
- en: '![A small-multiple area and line chart using map layers from Tableau 2020.4](Images/TAST_1047.png)'
  id: totrans-371
  prefs: []
  type: TYPE_IMG
  zh: '![从Tableau 2020.4中使用地图图层的小多个区域和线条图](Images/TAST_1047.png)'
- en: Figure 10-47\. A small-multiple area and line chart using map layers from Tableau
    2020.4
  id: totrans-372
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-47\. 从Tableau 2020.4中使用地图图层的小多个区域和线条图
- en: 'For this strategy, you will first build a series of calculations; then you
    will build the visualization from the top layer and work to the bottom. Many of
    our calculations will be repeated as we will calculate versions for current-year
    sales and prior-year sales:'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种策略，您将首先构建一系列计算，然后从顶层向底层构建可视化。我们的许多计算将会重复，因为我们将为当前年销售和去年销售计算版本：
- en: 'Build your calculations as follows:'
  id: totrans-374
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按以下方式构建您的计算：
- en: 'Create a calculation called `**[Sales | CY]**` to calculate current-year sales:'
  id: totrans-375
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Sales | CY]**`的计算，用于计算今年销售额：
- en: '[PRE30]'
  id: totrans-376
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Create a calculation called `**[Sales | PY]**` to calculate prior-year sales:'
  id: totrans-377
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Sales | PY]**`的计算，用于计算去年销售额：
- en: '[PRE31]'
  id: totrans-378
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Create a calculation called `**[Sales | Delta]**` to calculate year-over-year
    change in sales as a percent. You will use this as text to provide context:'
  id: totrans-379
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Sales | Delta]**`的计算，用于计算销售额的年度同比变化百分比。您将将其用作文本，提供上下文信息：
- en: '[PRE32]'
  id: totrans-380
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Change the default formatting to a percentage with no decimals. When the values
    are positive, have an arrow pointing up. When the values are negative, have an
    arrow pointing down.
  id: totrans-381
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将默认格式更改为百分比，且没有小数。当值为正时，箭头指向上。当值为负时，箭头指向下。
- en: 'Create an LOD calculation called `**[Sales | CY | Sub Mo]**` to calculate current-year
    sales by sub-category and month:'
  id: totrans-382
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个LOD计算称为`**[Sales | CY | Sub Mo]**`，用于按子类别和月份计算今年销售额：
- en: '[PRE33]'
  id: totrans-383
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'Create an LOD calculation called `**[Sales | CY | Sub Mo]**` to calculate prior-year
    sales by sub-category and month:'
  id: totrans-384
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个LOD计算称为`**[Sales | CY | Sub Mo]**`，用于按子类别和月份计算去年销售：
- en: '[PRE34]'
  id: totrans-385
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Because sales values will find themselves greater than 180, and therefore won’t
    render on our “map,” we need to normalize our values. Create a calculation called
    `**[Sales | CY | Sub Mo | Norm]**`:'
  id: totrans-386
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因为销售值可能大于180，因此不会在我们的“地图”上显示，我们需要对数值进行归一化处理。创建一个名为`**[Sales | CY | Sub Mo |
    Norm]**`的计算：
- en: '[PRE35]'
  id: totrans-387
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Complete the same normalization, but for prior-year sales. Create a calculation
    called `**[Sales | PY | Sub Mo | Norm]**`:'
  id: totrans-388
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于去年销售，完成相同的归一化处理。创建一个名为`**[Sales | PY | Sub Mo | Norm]**`的计算：
- en: '[PRE36]'
  id: totrans-389
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'You are going to plot values by sub-category and month. To plot this on our
    map, we need to use a function called `MAKEPOINT()`. This worker function plots
    any value to a map. You need to specify two values under this function. Make the
    map layer by creating a new calculated field called `**[Sales | CY | MP]**`:'
  id: totrans-390
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你将按子类别和月份绘制值。为了在地图上绘制这个图表，我们需要使用一个叫做 `MAKEPOINT()` 的函数。这个工作函数将任何值绘制到地图上。你需要在这个函数下指定两个值。通过创建一个名为
    `**[Sales | CY | MP]**` 的新计算字段来创建地图层：
- en: '[PRE37]'
  id: totrans-391
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Replicate the same process for the prior-year values by creating a new calculated
    field called `**[Sales | PY | MP]**`:'
  id: totrans-392
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过创建一个名为 `**[Sales | PY | MP]**` 的新计算字段来复制前一年的值。
- en: '[PRE38]'
  id: totrans-393
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Create a placeholder for the labels for the small multiples. The `MAKEPOINT()`
    calculation can be encoded with values in our data source, or you can hardcode
    the data. You’ll hardcode the header at 1.1 (slightly above the plot) and 6.5
    (between June and July). Create a calculated field called `**[Sub-Category | MP]**`:'
  id: totrans-394
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为小多个计算标签的占位符。`MAKEPOINT()` 计算可以使用数据源中的值编码，或者你可以硬编码数据。你需要在 1.1（略高于图表之上）和 6.5（6
    月和 7 月之间）处硬编码头部。创建一个名为 `**[Sub-Category | MP]**` 的计算字段：
- en: '[PRE39]'
  id: totrans-395
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Create a placeholder for the axis labels. You can actually mix values in the
    `MAKEPOINT()` function. Specify –.05 so the values show up below the axis. You
    will also alternate the labels so they show up every other month:'
  id: totrans-396
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为轴标签创建占位符。你可以在 `MAKEPOINT()` 函数中混合值。指定 -0.05 以便值显示在轴线下方。你还会交替标签，以便它们每隔一个月显示一次：
- en: '[PRE40]'
  id: totrans-397
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'To go with the axis points, you’ll need labels, which you can create with the
    following calculation:'
  id: totrans-398
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要匹配轴点，你需要标签，可以通过以下计算创建：
- en: '[PRE41]'
  id: totrans-399
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'For our last two calculations, we need to specify the grid for our small multiples.
    You’ve seen these calculations in [Chapter 4](ch04.xhtml#working_with_time):'
  id: totrans-400
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于我们的最后两个计算，我们需要为小多个指定网格。你在 [Chapter 4](ch04.xhtml#working_with_time) 中看到了这些计算：
- en: '[PRE42]'
  id: totrans-401
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE42]'
- en: After 14 calculations, we’re ready to build this visualization!
  id: totrans-402
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 经过 14 次计算，我们准备好构建这个可视化图表了！
- en: 'Build our base (and our summary labels) as follows; many of our calculations
    will be repeated as we will calculate versions for current-year sales and prior-year
    sales:'
  id: totrans-403
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照以下方式构建我们的基础（以及我们的汇总标签）；许多计算将会重复，因为我们将计算当前年销售和前一年销售的版本：
- en: The [Sub-Category] dimension has 17 members. You want only 16 for this visualization.
    Click and drag [Sub-Category] to the Filters shelf and exclude Copiers. You are
    filtering copiers because there is some missing data that will give us extra headaches
    that we don’t want to solve in this strategy.
  id: totrans-404
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[Sub-Category] 维度有 17 个成员。在这个可视化中，你只需要 16 个。将 [Sub-Category] 拖放到筛选架上，并排除复印机。由于策略中不想解决的一些缺失数据，你需要过滤复印机。'
- en: To add your first map layer, click and drag [Sub-Category | MP] to Detail on
    the Marks card. If everything is going as planned right now, you will see a blue
    dot just north of the island nation of Sao Tome and Principe. Don’t worry, this
    won’t show up on your “map” when you are done.
  id: totrans-405
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要添加第一个地图层，请将 [Sub-Category | MP] 拖放到标记卡的详细信息中。如果目前一切顺利，你会看到一个蓝点，位于圣多美和普林西比岛的北部。别担心，完成后这不会显示在你的“地图”上。
- en: Change the mark type from Automatic to Text.
  id: totrans-406
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将标记类型从自动更改为文本。
- en: To add labels, add [Sub-Category], sum of [Sales | CY], sum of [Sales | PY],
    and [Sales | Delta] to Text. Then format by placing [Sub-Category] on the first
    line with size 15 font and the default font color. On the second line, place sum
    of [Sales | CY] with the default font and color, but changing the font size to
    11\. On the third line, place [Sales | Delta] and sum of [Sales | PY] and type
    `**from**` (with a space on each side) between the two measures, as shown in [Figure 10-48](#text_formatting_for_the_sub-category_lab).
  id: totrans-407
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要添加标签，请在文本中添加 [Sub-Category]、[Sales | CY] 的总和、[Sales | PY] 的总和和 [Sales | Delta]。然后按以下格式排列：在第一行放置
    [Sub-Category]，字体大小为 15，字体颜色默认。在第二行，放置 [Sales | CY] 的总和，字体大小为 11，字体颜色默认。在第三行，放置
    [Sales | Delta] 和 [Sales | PY] 的总和，并在两个度量值之间输入 `**from**`（两侧有空格），如图 [Figure 10-48](#text_formatting_for_the_sub-category_lab)
    所示。
- en: '![Text formatting for the sub-category labels](Images/TAST_1048.png)'
  id: totrans-408
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![子类别标签的文本格式化](Images/TAST_1048.png)'
- en: Figure 10-48\. Text formatting for the sub-category labels
  id: totrans-409
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-48\. 子类别标签的文本格式化
- en: When you click OK in the text editor, you will immediately notice a bunch of
    overlapping text.
  id: totrans-410
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当你在文本编辑器中点击确认后，你会立即注意到一堆重叠的文本。
- en: You will now start building out the grid. Double-click to the right of [Longitude
    (generated)] on the Columns shelf and type the `**[Cols]**` calculation. Press
    Enter. Change the [Cols] calculation from continuous to discrete.
  id: totrans-411
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您将开始构建网格。在**Columns shelf**中**[Longitude (generated)]**的右侧双击，并键入`**[Cols]**`计算。按Enter键。将**[Cols]**计算从连续更改为离散。
- en: Edit the [Cols] table calculation. Select Specific Dimensions and Sub-Category.
    Then create a custom sort order by descending sum of sales.
  id: totrans-412
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 编辑**[Cols]**表格计算。选择**特定维度**和**子类别**。然后按销售总和降序创建自定义排序顺序。
- en: Repeat the same process for [Rows] by double-clicking the Rows shelf. Edit the
    table calculation and edit the two nested table calculations of rows, using Specific
    Dimensions, selecting Sub-Category, and then sort in descending order by sum of
    sales. Remember, you need to do this for both table calculations in the rows calculation.
  id: totrans-413
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了通过双击**[Rows]**在**Rows shelf**上重复相同的过程，请编辑表格计算并编辑行的两个嵌套表格计算，使用**特定维度**，选择**子类别**，然后按销售总和降序排序。请记住，你需要对行计算中的两个表格计算都执行此操作。
- en: The result, shown in [Figure 10-49](#progress_on_the_small_multiples_after_ad),
    is a grid of labels on a map.
  id: totrans-414
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果如[Figure 10-49](#progress_on_the_small_multiples_after_ad)所示，是地图上标签的网格。
- en: '![Progress on the small multiples after adding and formatting the [Rows] calculation
    on the Rows shelf](Images/TAST_1049.png)'
  id: totrans-415
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![在Rows shelf上添加并格式化[Rows]计算后的小倍数进展](Images/TAST_1049.png)'
- en: Figure 10-49\. Progress on the small multiples after adding and formatting the
    [Rows] calculation on the Rows shelf
  id: totrans-416
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 10-49\. 在Rows shelf上添加并格式化[Rows]计算后的小倍数进展
- en: Now let’s show you some of the magic. Our final visualization won’t actually
    be a map (even though it’s on a map). You can turn off your map from the top menu
    by choosing Map → Background Maps → None. This turns off your map and shows a
    standard chart!
  id: totrans-417
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在让我们展示一些神奇的东西。我们最终的可视化实际上不会是地图（尽管它在地图上）。您可以通过从顶部菜单选择**地图** → **背景地图** → **无**
    来关闭地图，显示标准图表！
- en: Edit the [Latitude (generated)] axis and set the range from –.5 to 1.5\. Edit
    the [Longitude (generated)] axis and set the range from –1 to 14\. [Figure 10-50](#your_small_multiples_after_turning_off_t)
    now shows the potential of our visualization.
  id: totrans-418
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑**[Latitude (generated)]**轴并设置范围从–.5到1.5。编辑**[Longitude (generated)]**轴并设置范围从–1到14。现在，[Figure 10-50](#your_small_multiples_after_turning_off_t)显示了我们可视化的潜力。
- en: '![Your small multiples after turning off the map layers and editing the axes](Images/TAST_1050.png)'
  id: totrans-419
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![在关闭地图图层并编辑轴之后显示的小倍数进展](Images/TAST_1050.png)'
- en: Figure 10-50\. Your small multiples after turning off the map layers and editing
    the axes
  id: totrans-420
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 10-50\. 在关闭地图图层并编辑轴之后您的小倍数
- en: 'You’ve completed the first layer, but now it is time to add the second layer.
    Here’s the deal: you can’t add additional layers without seeing the map view.
    This means we need to turn back on the map layers. From the top menu, choose Maps
    → Background Maps → Light.'
  id: totrans-421
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您已完成第一层，但现在是时候添加第二层了。这里的问题是：你不能在看不到地图视图的情况下添加额外的图层。这意味着我们需要重新打开地图图层。从顶部菜单选择**地图**
    → **背景地图** → **轻**。
- en: 'Add a layer for the blue dots for the current year:'
  id: totrans-422
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为当前年份的蓝色点添加一个图层：
- en: After you have turned your map layer back on, click and drag your [Sales | CY
    | MP] calculation onto your map visualization. As you do this, an option to Add
    a Marks Layer will appear. Place your field on the callout. This will add another
    map layer to your visualization. By default, any layer you add is added to the
    top of your visualization. You can see this by looking at your Marks cards and
    seeing that the new field is sitting above your [Sub-Category | MP] layer, shown
    in [Figure 10-51](#our_marks_cards_after_adding_our_first_l).
  id: totrans-423
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您重新打开地图图层后，单击并将**[Sales | CY | MP]**计算拖放到地图可视化中。在此过程中，将会出现添加标记层的选项。将您的字段放在标注上。这将向您的可视化添加另一地图层。默认情况下，您添加的任何图层都会添加到可视化顶部。您可以通过查看**Marks
    cards**来查看这一点，并看到新字段位于您的**[Sub-Category | MP]**层上方，如[Figure 10-51](#our_marks_cards_after_adding_our_first_l)所示。
- en: '![Our Marks cards after adding our first layer](Images/TAST_1051.png)'
  id: totrans-424
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![在添加第一层后我们的Marks卡片](Images/TAST_1051.png)'
- en: Figure 10-51\. Our Marks cards after adding our first layer
  id: totrans-425
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 10-51\. 在添加我们的第一层后我们的Marks卡片
- en: You can easily change the layers by clicking the header and dragging the value
    below the [Sub-Category | MP] layer. You can also rename the layer to Blue Circles
    by clicking the drop-down, selecting Rename, and typing `**Blue Circles**`.
  id: totrans-426
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您可以通过单击标题并将值拖动到[Sub-Category | MP]层下方轻松更改图层。您还可以通过单击下拉菜单，选择**重命名**，并键入`**Blue
    Circles**`来重命名图层为**Blue Circles**。
- en: Change the mark type from Automatic to Circle.
  id: totrans-427
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将标记类型从自动更改为圆圈。
- en: Add [Sub-Category] to Detail of the Blue Circles layer. Double-click the [Blue
    Circles] Marks card to create an ad hoc calculation and type `**MONTH([Order Date])**`.
  id: totrans-428
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[子类别]添加到Blue Circles层的详细信息中。双击[Blue Circles]标记卡创建一个临时计算，并键入`**MONTH([订购日期])**`。
- en: Edit the size of the dots to be approximately 20% of the maximum value. [Figure 10-52](#our_visualization_after_step_three)
    shows the visualization at this point.
  id: totrans-429
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑点的大小，使其大约为最大值的20%。[图10-52](#our_visualization_after_step_three)显示了此时的可视化效果。
- en: '![Our visualization after step 3](Images/TAST_1052.png)'
  id: totrans-430
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_IMG
  zh: '![我们第3步之后的可视化](Images/TAST_1052.png)'
- en: Figure 10-52\. Our visualization after step 3
  id: totrans-431
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-52\. 我们第3步之后的可视化
- en: 'To add the white circles behind the blue circles, you’ll generally follow the
    same steps from step 3 for creating the circles. This layer will give the appearance
    that the blue dots and the gray lines are not touching:'
  id: totrans-432
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要在蓝色圆圈后面添加白色圆圈，通常需要按照步骤3创建圆圈的相同步骤。这一层将使蓝色点和灰色线条看起来不接触：
- en: Click and drag your [Sales | CY | MP] calculation onto your map visualization.
    Move the layer to the bottom. Change the name of the layer to `**White Circles**`.
  id: totrans-433
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击并拖动您的[Sales | CY | MP]计算到地图可视化中。将该层移动到底部。将该层的名称更改为`**White Circles**`。
- en: Add [Sub-Category] and MONTH([Order Date]) to Detail.
  id: totrans-434
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[子类别]和MONTH([订购日期])添加到详细信息中。
- en: Change the mark type to Circle. Change the size of the circle to be about 25%
    of the maximum value. This should be where the tick is on the left. Change the
    color of the mark to white and set the opacity to 85%.
  id: totrans-435
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为圆圈。将圆圈的大小更改为最大值的约25%。这应该是左侧标记的位置。将标记的颜色更改为白色，并设置不透明度为85%。
- en: 'Add lines that connect the dots; these steps look very similar to steps 3 and
    4, but with some small changes:'
  id: totrans-436
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加连接点的线条；这些步骤看起来与步骤3和4非常相似，但有一些小的变化：
- en: For the final time, click and drag [Sales | CY | MP] to add a marks layer. Move
    the layer to the bottom and change the name to `**Gray Lines**`.
  id: totrans-437
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后一次，点击并拖动[Sales | CY | MP]添加一个标记层。将该层移动到底部并更改名称为`**Gray Lines**`。
- en: Add [Sub-Category] and MONTH([Order Date]) to Detail.
  id: totrans-438
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[子类别]和MONTH([订购日期])添加到详细信息中。
- en: Change the mark type to Line. Change the size of the line to be about 10% of
    the maximum value. Change the color of the mark to a medium gray and set the opacity
    to 85%.
  id: totrans-439
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为线条。将线条的大小更改为最大值的约10%。将标记的颜色更改为中灰色，并设置不透明度为85%。
- en: Layering two dots and a line chart together gives the effect of a singular,
    cohesive line chart, which is shown in [Figure 10-53](#your_visualization_after_step_fiveem_das).
    But, as you know, it is not. Let’s add context to this line chart with an area
    chart.
  id: totrans-440
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将两个点和一条线图层叠在一起，形成一个单一的、连贯的线图效果，如[图10-53](#your_visualization_after_step_fiveem_das)所示。但是，正如你所知道的，它并不是。让我们通过一个区域图表为这条线图增加一些上下文。
- en: '![Your visualization after step 5—notice that the line and dots look like a
    singular component](Images/TAST_1053.png)'
  id: totrans-441
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![第5步之后的可视化—请注意，线条和点看起来像一个单一组件](Images/TAST_1053.png)'
- en: Figure 10-53\. Your visualization after step 5—notice that the line and dots
    look like a singular component
  id: totrans-442
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图10-53\. 第5步之后的您的可视化—请注意，线条和点看起来像一个单一组件
- en: 'When we create our charts, we like to show as much context as possible. This
    can be done by adding a layer showing last year’s sales:'
  id: totrans-443
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们创建图表时，我们喜欢展示尽可能多的上下文。可以通过添加一个显示去年销售额的层来实现：
- en: This time, bring in prior-year sales by clicking and dragging [Sales | PY |
    MP] and adding a marks layer. Move the layer to the bottom and change the name
    to `**PY Area Chart**`.
  id: totrans-444
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这次，通过点击并拖动[Sales | PY | MP]并添加一个标记层，引入前一年的销售额。将该层移动到底部并更改名称为`**PY Area Chart**`。
- en: Like a broken record, add [Sub-Category] and MONTH([Order Date]) to Detail.
  id: totrans-445
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 像一张损坏的唱片，将[子类别]和MONTH([订购日期])添加到详细信息中。
- en: Change the mark type to Area. Change the color to light gray.
  id: totrans-446
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为区域。将颜色更改为浅灰色。
- en: 'For our last layer, we are going to create one that looks like a customized
    axis:'
  id: totrans-447
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于我们的最后一层，我们将创建一个看起来像定制轴的图层：
- en: Find [Month | MP] and add a new layer. Move the layer to the bottom and change
    the name to `**Axis**`.
  id: totrans-448
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到[Month | MP]并添加一个新的层。将该层移动到底部并更改名称为`**Axis**`。
- en: Add [Sub-Category] and MONTH(Order Date) to Detail. Add our custom calculation,
    [Months Label], to Text on the layer.
  id: totrans-449
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[子类别]和MONTH(Order Date)添加到详细信息中。将我们的自定义计算，[Months Label]，添加到层上的文本中。
- en: Change the mark type to Shape. Edit the shape and select an arrow pointing up
    in the Thin Arrows folder. Format the text label to show at the bottom center.
    You have now completed the build portion; [Figure 10-54](#your_visualization_after_completing_the)
    shows the resulting visualization.
  id: totrans-450
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将标记类型更改为形状。编辑形状，并在“细箭头”文件夹中选择指向上的箭头。将文本标签格式化为显示在底部中心。您现在已完成构建部分；[Figure 10-54](#your_visualization_after_completing_the)
    显示了结果可视化。
- en: '![Your visualization after completing the build](Images/TAST_1054.png)'
  id: totrans-451
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![完成构建后的您的可视化](Images/TAST_1054.png)'
- en: Figure 10-54\. Your visualization after completing the build
  id: totrans-452
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-54\. 完成构建后的您的可视化
- en: To complete the visualization, turn off the map from the top menu by choosing
    Map → Background Maps → None.
  id: totrans-453
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要完成可视化，从顶部菜单中选择地图 → 背景地图 → 无。
- en: 'Format the visualization as follows:'
  id: totrans-454
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 格式化可视化如下：
- en: Hide all the headers.
  id: totrans-455
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隐藏所有标题。
- en: Turn off the grid lines.
  id: totrans-456
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关闭网格线。
- en: Remove the zero line on columns.
  id: totrans-457
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除列上的零线。
- en: Set the zero line on rows to a black solid line.
  id: totrans-458
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将行上的零线设置为黑色实线。
- en: Change the row and column dividers to the thickest white line possible.
  id: totrans-459
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将行和列分隔线更改为最粗的白色线。
- en: 'Disable selection and format tooltips:'
  id: totrans-460
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 禁用选择并格式化工具提示：
- en: With map layers, you can disable the selection of any values on your visualization
    by clicking the drop-down on the header of each layer and selecting Disable Selection
    ([Figure 10-55](#disabling_the_selection_on_your_map_laye)). Disable selection
    for all of your layers.
  id: totrans-461
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用地图图层，您可以通过单击每个图层标题栏上的下拉菜单并选择禁用选择 ([Figure 10-55](#disabling_the_selection_on_your_map_laye))
    来禁用可视化中任何值的选择。禁用所有图层的选择。
- en: For each layer, you can control your tooltips. We suggest turning off tooltips
    for the Sub-Category | MP and Axis layers. For the Blue Circle, White Circle,
    Gray Line, and PY Area Chart layers, we suggest showing the month name and the
    value associated.
  id: totrans-462
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于每个图层，您可以控制工具提示。我们建议关闭子类别 | MP 和轴图层的工具提示。对于蓝色圆圈、白色圆圈、灰线和PY区域图表图层，建议显示月份名称及其相关值。
- en: After you have formatted the tooltips, your visualization should match that
    in [Figure 10-56](#the_resulting_visualization_for_this_str).
  id: totrans-463
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在格式化工具提示后，您的可视化应与 [Figure 10-56](#the_resulting_visualization_for_this_str)
    中的相匹配。
- en: '![Disabling the selection on your map layers](Images/TAST_1055.png)'
  id: totrans-464
  prefs: []
  type: TYPE_IMG
  zh: '![禁用地图图层上的选择](Images/TAST_1055.png)'
- en: Figure 10-55\. Disabling the selection on your map layers
  id: totrans-465
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-55\. 禁用地图图层上的选择
- en: '![The resulting visualization for this strategy](Images/TAST_1056.png)'
  id: totrans-466
  prefs: []
  type: TYPE_IMG
  zh: '![此策略的可视化结果](Images/TAST_1056.png)'
- en: Figure 10-56\. The resulting visualization for this strategy
  id: totrans-467
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 10-56\. 此策略的可视化结果
- en: In this strategy, you learned how to build a visualization by using map layers.
    You specified values on a map by using `MAKEPOINT()`. You learned that you can
    build layers with the same data used to build a customized component, like the
    line chart with dots. You also learned that with map layers, you can use multiple
    mark types without having to do complex data modeling.
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种策略中，您学会了如何通过使用地图图层构建可视化。您可以使用 `MAKEPOINT()` 在地图上指定值。您还学到，可以使用相同数据构建图层来构建自定义组件，例如带有点的折线图。您还了解到，使用地图图层可以在无需进行复杂数据建模的情况下使用多种标记类型。
- en: Conclusion
  id: totrans-469
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: 'As its title indicates, this chapter was all about reshaping your data to create
    novel visualizations. With data modeling, you aren’t necessarily creating aggregations
    of your data; rather, you are padding your data. This padding can occur in many
    forms: through table calculations, through joins, or with blends to the same data
    source. You also learned about scenarios when you might want to join a dataset
    to itself. Finally, we looked at how map layers can take visualizations to a new
    level.'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: 正如其标题所示，本章主要讨论了重塑数据以创建新颖可视化的方法。通过数据建模，您不一定要创建数据的聚合，而是在数据中填充数据。这种填充可以通过多种方式进行：通过表计算、连接或与同一数据源的混合。您还了解了在何种情况下可能希望将数据集连接到自身。最后，我们看了地图图层如何将可视化推向新的高度。
- en: All of our examples are just breaking the iceberg with each data modeling type
    shown. There are so many more possibilities with each data modeling type. We didn’t
    intend to show you each type, but to give you an important introduction to the
    concepts around data modeling. If you can understand how to model your data, you
    can build any advanced chart type.
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
  zh: 我们所有的示例仅仅触及到了每种数据建模类型的表面。每种数据建模类型都有更多可能性。我们并不打算展示每一种类型，而是为您提供了围绕数据建模概念的重要介绍。如果您能理解如何对数据进行建模，就能构建任何高级图表类型。
- en: In the next chapter, we will take some of the concepts shown here and in previous
    chapters and start to use them to build a series of visualizations that, when
    put together, build interactive visual systems. We stop short of calling these
    dashboards or even data products because we’ll be focusing on the components that
    will go into dashboard building, not necessarily the dashboards themselves.
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将借鉴这里和前几章节展示的一些概念，开始使用它们来构建一系列可视化，这些可视化组合在一起构建了交互式视觉系统。我们暂时不称其为仪表板甚至数据产品，因为我们将专注于用于仪表板构建的组件，而不一定是仪表板本身。
- en: Further Reading
  id: totrans-473
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: Read Jeff Shaffer’s blog post on [domain completion and domain padding](https://oreil.ly/qNgjI).
  id: totrans-474
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阅读Jeff Shaffer在[域完成和域填充](https://oreil.ly/qNgjI)方面的博客文章。
- en: Read Ken Flerlage’s blog post on [data densification](https://oreil.ly/KiDdA).
  id: totrans-475
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阅读Ken Flerlage在[数据稠密化](https://oreil.ly/KiDdA)方面的博客文章。
- en: Learn more about map layering from [Jeff Shaffer’s blog](https://oreil.ly/Drn2n).
  id: totrans-476
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从[Jeff Shaffer的博客](https://oreil.ly/Drn2n)了解更多关于地图分层的信息。
- en: If you are looking for a challenge, try making the [radial stacked bar chart](https://oreil.ly/lgZzd)
    by Toan Hoang.
  id: totrans-477
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你正在寻找挑战，请尝试由Toan Hoang制作的[径向堆叠条形图](https://oreil.ly/lgZzd)。
- en: Or practice the stepped area chart by Klaus Schulte and reproduced in [blog
    form by Rosario Gauna](https://oreil.ly/TeoxI).
  id: totrans-478
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 或者通过Klaus Schulte的步进区域图表，并在[Rosario Gauna的博客形式](https://oreil.ly/TeoxI)中复制。
- en: Or re-create an English Premier League table in a blog post by [Donna Coles](https://oreil.ly/4Sbof).
  id: totrans-479
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 或者通过[Donna Coles](https://oreil.ly/4Sbof)的博客文章重新创建英格兰足球超级联赛积分榜。
