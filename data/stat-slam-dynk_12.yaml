- en: 12 Computing and plotting inequality
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 12 计算和绘制不平等
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Computing and understanding Gini coefficients
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算和理解基尼系数
- en: Creating and interpreting Lorenz curves
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建和解读洛伦兹曲线
- en: Performing significance testing
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进行显著性检验
- en: Conducting effect size testing
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进行效应量检验
- en: Social scientists, economists, philosophers, and others have claimed for many
    years that income inequality exacerbates crime and other social ills. This is
    why, they say, taxation, income redistribution, and other state-level corrective
    actions aren’t zero-sum, but critical for the common good. An equal society is
    a prosperous society, and an unequal society is a declining society.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 社会学家、经济学家、哲学家和其他人多年来一直声称，收入不平等加剧了犯罪和其他社会问题。这就是为什么他们说，税收、收入再分配和其他国家层面的纠正措施不是零和游戏，而是对公共利益的至关重要。一个平等的社会是一个繁荣的社会，一个不平等的社会是一个衰落的社会。
- en: How might this idea translate to the NBA? The NBA is a remarkably unequal “society”
    in that most of the money paid out in salaries is distributed to just a few players.
    In fact, you’ll discover soon enough that salary inequality across the league
    is most recently much higher than it used to be. But at the same time, salary
    inequality varies significantly from one team or “community” to the next.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 这种想法如何转化为NBA呢？NBA是一个极其不平等的社会，“社会”中大部分的薪资支出都分配给了少数球员。事实上，你很快就会发现，整个联盟的薪资不平等程度最近比以前要高得多。但与此同时，薪资不平等在不同球队或“社区”之间差异显著。
- en: Might it be true that teams with relatively *equal* salary distributions are
    more prosperous than other teams? That is, do such teams win more regular season
    games and more league championships than teams with relatively *unequal* salary
    distributions? In any event, that’s our going-in hypothesis.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 是否可能相对*平等*薪资分配的球队比其他球队更繁荣？也就是说，这样的球队是否赢得更多常规赛和更多联赛冠军，而相对*不平等*薪资分配的球队则不然？无论如何，这是我们进入时的假设。
- en: 'Here’s what you can expect to get out of this chapter:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从本章中获得以下内容：
- en: You’ll learn anything and everything you need to know about the Gini coefficient,
    which is a statistical measure of inequality. We’ll discuss what the Gini coefficient
    is exactly, how to compute it manually, how to do the same in R, and how to interpret
    results.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你将了解有关基尼系数的所有必要知识，基尼系数是不平等的统计指标。我们将讨论基尼系数的确切含义，如何手动计算它，如何在R中执行相同的操作，以及如何解读结果。
- en: You’ll learn how to create a Lorenz curve, which is a graphical representation
    of inequality, and how to estimate the Gini coefficient from the same.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你将学习如何创建洛伦兹曲线，这是一种不平等的图形表示，以及如何从同一数据中估算基尼系数。
- en: You’ll get refreshers on t-testing and Cohen’s d effect size testing.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你将对t检验和Cohen的d效应量检验进行复习。
- en: You’ll learn some data wrangling operations that we haven’t yet had an opportunity
    to introduce—until now.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你将学习一些我们尚未有机会介绍的数据处理操作——直到现在。
- en: Because so much in this chapter hinges on the Gini coefficient and Lorenz curves,
    let’s start with a primer on both topics before we load our packages, import our
    data, and perform our analysis.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 由于本章的大部分内容都依赖于基尼系数和洛伦兹曲线，在我们加载包、导入数据并进行分析之前，让我们先对这两个主题进行简要介绍。
- en: 12.1 Gini coefficients and Lorenz curves
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.1 基尼系数和洛伦兹曲线
- en: 'The Gini coefficient is a statistical measure of income inequality across a
    population, usually applied at the nation-state level, where 0 represents perfect
    equality (i.e., everyone earns the same income or has the same amount of wealth)
    and 1 represents perfect inequality (just one person possesses all the income
    or wealth, and everyone else is left with nothing). Generally speaking, the following
    are true:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 基尼系数是衡量一个群体收入不平等的统计指标，通常应用于国家层面，其中0代表完全平等（即，每个人都获得相同的收入或拥有相同数量的财富），而1代表完全不平等（只有一个人拥有所有收入或财富，其他人则一无所获）。一般来说，以下情况是正确的：
- en: Low inequality translates to a Gini coefficient of less than 0.3.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 低不平等对应于小于0.3的基尼系数。
- en: Moderate inequality translates to a Gini coefficient between 0.3 and 0.4.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 中等不平等程度对应于0.3到0.4之间的基尼系数。
- en: Significant inequality translates to a Gini coefficient between 0.4 and 0.6.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显著不平等对应于0.4到0.6之间的基尼系数。
- en: High inequality translates to a Gini coefficient greater than 0.6.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高不平等对应于大于0.6的基尼系数。
- en: The Gini coefficient was developed by the Italian statistician Corrado Gini
    in 1912, and while Gini’s worldview has long since fallen out of favor (Gini was
    a eugenicist), his coefficient to measure income inequality is regularly computed
    and published by the World Bank, the United Nations, and many other organizations
    to this day. This is why we’ve selected the Gini coefficient as our measure of
    inequality over a short list of alternatives, such as the standard deviation (see
    the previous chapter).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 基尼系数是由意大利统计学家科拉多·基尼在1912年开发的，尽管基尼的世界观早已不再受到青睐（基尼是一位优生学家），但他的衡量收入不平等系数的方法至今仍由世界银行、联合国和其他许多组织定期计算和发布。这就是为什么我们在一系列替代方案中选择了基尼系数作为我们的不平等度量标准，例如标准差（参见上一章）。
- en: 'Regarding the Gini coefficient, it’s critical to point out the following:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 关于基尼系数，以下几点至关重要：
- en: The Gini coefficient is a *relative* measure, not an *absolute* measure, which
    conceals distributions and other details; for example, two countries might have
    equal Gini coefficients but radically different standards of living. From a statistical
    perspective, that means one country might have a negative-skewed income distribution
    with a long left tail, while the other country might have a positive-skewed income
    distribution with a long right tail.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基尼系数是一个*相对*度量，而不是*绝对*度量，它掩盖了分布和其他细节；例如，两个国家可能具有相同的基尼系数，但生活水平却截然不同。从统计学的角度来看，这意味着一个国家可能有一个负偏斜的收入分布，左尾较长，而另一个国家可能有一个正偏斜的收入分布，右尾较长。
- en: The Gini coefficient probably loses some of its accuracy where products and
    services are partially or wholly subsidized by the government; it’s not easy,
    after all, to convert socialist or mixed economy benefits such as medicine, housing,
    and education into personal income or wealth.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基尼系数可能在产品和服务部分或全部由政府补贴的地方失去一些准确性；毕竟，将社会主义或混合经济的好处，如医疗、住房和教育，转化为个人收入或财富并不容易。
- en: 'A Lorenz curve is a graphical representation of cumulative income or wealth
    distribution within a population that was developed, interestingly enough, in
    1905 by an American doctoral student named Max Lorenz, seven years before Gini
    developed the Gini coefficient. Drawing a Lorenz curve involves plotting a pair
    of numeric variables: the cumulative share of income or wealth along either axis
    and the cumulative share of the population along the opposite axis. (We’ll plot
    cumulative salary distribution as our x-axis variable and cumulative share of
    NBA players as our y-axis variable.) A diagonal line is drawn to represent a state
    of perfect equality where, for instance, half the income is earned by half the
    population, and a Lorenz curve is drawn beneath the diagonal line to show, let’s
    say, that half the income or wealth is actually owned by just 25% of the population.
    When perfect inequality exists, a Lorenz curve will take on a shape resembling
    a backward C.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 洛伦兹曲线是1905年由一位名叫马克斯·洛伦兹的美国博士生开发的，它是一种图形表示人口内累积收入或财富分布的方法，有趣的是，这比基尼系数的提出早了七年。绘制洛伦兹曲线涉及绘制一对数值变量：沿任一轴的累积收入或财富份额以及沿相对轴的累积人口份额。（我们将累积薪酬分布作为我们的x轴变量，累积NBA球员份额作为我们的y轴变量。）绘制一条对角线来表示完全平等的状态，例如，一半的收入由一半的人口赚取，然后在对角线下绘制洛伦兹曲线，以显示，比如说，一半的收入或财富实际上只由25%的人口拥有。当存在完全不平等时，洛伦兹曲线将呈现出类似倒C的形状。
- en: We can estimate or even compute the Gini coefficient from a Lorenz curve; the
    Gini coefficient is the ratio of the area between the Lorenz curve and the line
    of perfect equality to the total area beneath the perfect equality line. So the
    greater the area between a Lorenz curve and the line of perfect equality, the
    greater the inequality.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从洛伦兹曲线中估计或计算基尼系数；基尼系数是洛伦兹曲线与完全平等线之间的面积与完全平等线下总面积的比率。因此，洛伦兹曲线与完全平等线之间的面积越大，不平等程度就越大。
- en: Now that we have Gini coefficients and Lorenz curves out of the way, at least
    for the time being, we’ll load our packages, import our data, and then start with
    our analysis.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经处理好了基尼系数和洛伦兹曲线，至少暂时如此，我们将加载我们的包，导入我们的数据，然后开始我们的分析。
- en: 12.2 Loading packages
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.2 加载包
- en: 'We’ll go above and beyond built-in R functions to wrangle, pull, and test data
    and otherwise compute and visualize our results. This time, we’ll call the `library()`
    function six times to load packages that extend R’s functional footprint:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将超越内置的R函数，进行数据整理、提取、测试，以及其他计算和可视化结果。这次，我们将调用`library()`函数六次来加载扩展R功能范围的包：
- en: '[PRE0]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Four of these packages—`tidyverse`, `sqldf`, `scales`, and `effsize`—we’ve loaded
    before; two others, `ineq` and `gglorenz`, are used here for the first time. The
    `ineq` package contains the `ineq()` function, which takes a vector of numerals
    and computes the Gini coefficient; the `gglorenz` package is a `ggplot2` extension
    that draws Lorenz curves.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 这四个包——`tidyverse`、`sqldf`、`scales`和`effsize`——我们之前已经加载过；另外两个包，`ineq`和`gglorenz`，这次是首次使用。`ineq`包包含`ineq()`函数，该函数接受一个数字向量并计算基尼系数；`gglorenz`包是`ggplot2`的扩展，用于绘制洛伦兹曲线。
- en: 'As a friendly reminder, packages must be installed prior to importing them,
    and packages must be imported before calling their functions. For example, if
    the `ineq` package had not already been installed, we would have first called
    the `install.packages()` function and passed the `ineq` package between a pair
    of single or double quotation marks as an argument:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 作为友好的提醒，在导入之前必须安装包，并且在调用它们的函数之前必须导入包。例如，如果`ineq`包尚未安装，我们首先会调用`install.packages()`函数，并将`ineq`包作为参数传递，用一对单引号或双引号括起来：
- en: '[PRE1]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We’ll import our first data set next.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将导入我们的第一个数据集。
- en: 12.3 Importing and viewing data
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.3 导入和查看数据
- en: 'Our first data set is in the form of a .csv file, previously downloaded from
    [https://data.world](https://data.world). We therefore make a call to the `read_csv()`
    function from the `readr` package to import our data that’s since been stored
    in our default working directory. In the process, we create an object called gini:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第一份数据集是以.csv文件的形式，之前从[https://data.world](https://data.world)下载的。因此，我们调用`read_csv()`函数从`readr`包中导入存储在我们默认工作目录中的数据。在这个过程中，我们创建了一个名为gini的对象：
- en: '[PRE2]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Our data set contains annual salaries for every NBA player between 1985 and
    2018.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据集包含了1985年至2018年间每位NBA球员的年薪。
- en: 'We then call the `glimpse()` function from the `dplyr` package to perform a
    quick assessment of our data:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用`dplyr`包中的`glimpse()`函数来对我们的数据进行快速评估：
- en: '[PRE3]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The gini data set is 14,163 rows long and seven columns wide; it contains a
    combination of numeric variables (`int`) and character strings (`chr`). Some back-of-the-envelope
    math—taking into account the number of NBA seasons contained in our data set,
    the number of teams, and the number of players a team usually carries on its active
    roster—suggests that 14,163 records is rather high. It *might* be due to so many
    players rotating in and out of the league on short-term or temporary contracts,
    or it could be the result of something entirely different.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 基尼数据集有14,163行，七列宽；它包含数字变量（`int`）和字符字符串（`chr`）的组合。一些粗略的计算——考虑到我们数据集中包含的NBA赛季数量、球队数量以及球队通常在其活跃阵容中携带的球员数量——表明14,163条记录相当高。这*可能*是由于许多球员在短期或临时合同中进出联盟，或者可能是其他完全不同的事情的结果。
- en: Because players frequently change teams *during* a season—they can be traded
    to another team or signed by another team after being waived, the equivalent of
    being fired or laid off—it’s only fitting to check and tag duplicate records between
    the variables `player_id` (a unique identifier) and `season_end` (the calendar
    year in which an NBA regular season concluded). This is a good example of the
    importance of understanding the ecosystem in which your data resides; a blind
    analysis that lacks context in terms of the potential movement or interaction
    of variables is liable to spoil the integrity of your analysis.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 由于球员在赛季中经常转会——他们可以被交易到另一支球队，或者在被放弃后被另一支球队签下，这相当于被解雇或裁员——因此，检查和标记`player_id`（一个唯一标识符）和`season_end`（NBA常规赛结束的日历年份）之间的重复记录是合适的。这是一个理解数据所在生态系统中重要性的好例子；缺乏关于变量潜在移动或交互的上下文的无视分析可能会破坏分析的整体性。
- en: It would be nice if there were some quick and easy way of detecting or confirming
    the presence of duplicate records, but unfortunately, the data dictionary that
    attended our data makes no mention of intra-season player movements or if salaries
    are double-counted in such instances, meaning we’ll have to fend for ourselves.
    But this is how it often works in the real world.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有一种快速简单的方法来检测或确认重复记录的存在，那将很理想，但不幸的是，伴随我们的数据的数据字典没有提及赛季内球员的移动或在这种情况下工资是否被重复计算，这意味着我们不得不自己应对。但在现实世界中，这通常是这种情况。
- en: 'In the following chunk of `dplyr` code, we first pass the gini data set to
    the `group_by()` function, where the variables `player_id` and `season_end` are
    additional arguments, and then we call the `mutate()` function to create a logical
    variable called `duplicate`. The `duplicate` variable will equal `TRUE` if and
    when gini contains more than one record where `player_id` *and* `season_end` are
    identical, or `duplicate` will equal `FALSE` if otherwise. Our results are cast
    to a tibble called gini2, which we’ll use only temporarily:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的`dplyr`代码块中，我们首先将gini数据集传递给`group_by()`函数，其中`player_id`和`season_end`是额外的参数，然后我们调用`mutate()`函数创建一个名为`duplicate`的逻辑变量。如果gini包含一个或多个`player_id`和`season_end`相同的记录，则`duplicate`变量将等于`TRUE`；否则，`duplicate`将等于`FALSE`。我们的结果被转换为一个名为gini2的tibble，我们只临时使用它：
- en: '[PRE4]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Then, we pass gini2 to the `group_by``()` and `tally()` functions to return
    row counts where the variable `duplicate` equals `TRUE` or `FALSE` to get a count
    of (potentially) duplicate records in our data:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们将`gini2`传递给`group_by()`和`tally()`函数，以返回变量`duplicate`等于`TRUE`或`FALSE`时的行计数，以获取数据中（可能）重复记录的数量：
- en: '[PRE5]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Our data set does contain duplicates—lots of them, or so it would seem if we
    stopped here.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据集中确实包含重复项——很多，如果我们在这里停下来，这似乎就是如此。
- en: 'Next, we call the `sqldf()` function from the `sqldf` package and the `head()`
    function from base R to return the first six observations from gini2 where the
    variable `duplicate` equals `TRUE`. This gives us a read on a few of our duplicate
    records as well as a starter set by which to do some additional research:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们从`sqldf`包中调用`sqldf()`函数，从基础R中调用`head()`函数，以返回`gini2`中变量`duplicate`等于`TRUE`的前六个观测值。这让我们对一些重复记录有了了解，并为我们进行一些额外研究提供了一个起点：
- en: '[PRE6]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Upon further investigation, it turns out our duplicates aren’t really duplicates
    after all. Quincy Acy is a typical case in point (see `player_id acyqu01` from
    our `sqldf` output). Acy was a marginal and forgettable player, but he did earn
    more than $8 M in salary over a seven-year professional career. According to his
    [www.basketball-reference.com](https://www.basketball-reference.com/) profile,
    Acy started the 2016-17 season as a member of the Dallas Mavericks. About a month
    into the season, in which he appeared in only six games, Acy was waived and, two
    months later, signed by the Brooklyn Nets. Most importantly for us, the Mavericks
    paid Acy more than $1 M, *and* the Nets paid him an additional $1.9 M; thus, Acy
    earned more than $2.9 M during the 2016-17 season. Other checks on other “duplicates”
    reveal the same pattern; there are, indeed, duplicates on the variables `player_id`
    and `season_end`, but the salaries are unique. That last part is what’s key for
    us: the salaries are unique, or mutually exclusive, for each `player_id`, `season`,
    *and* `team` combination. Now that we have that settled, we know what needs to
    be done and what doesn’t need to be done from a data wrangling perspective.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 经过进一步调查，我们发现我们的重复项根本不是重复项。Quincy Acy是一个典型的例子（参见我们的`sqldf`输出中的`player_id acyqu01`）。Acy是一个边缘化和被遗忘的球员，但他在一个七年的职业生涯中赚了超过800万美元的薪水。根据他的[www.basketball-reference.com](https://www.basketball-reference.com/)个人资料，Acy在2016-17赛季开始时是达拉斯小牛队的一员。在赛季开始大约一个月后，他只参加了六场比赛，Acy被放弃，两个月后被布鲁克林篮网队签下。对我们来说最重要的是，小牛队支付给Acy超过100万美元，*并且*篮网队额外支付给他190万美元；因此，Acy在2016-17赛季赚了超过290万美元。对其他“重复项”的其他检查揭示了相同的模式；在变量`player_id`和`season_end`上确实存在重复，但薪水是唯一的。对我们来说，最后这部分是关键：对于每个`player_id`、`season`和`team`组合，薪水是唯一的或互斥的。现在我们已经解决了这个问题，我们就知道从数据处理的角度需要做什么，以及不需要做什么。
- en: 12.4 Wrangling data
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.4 数据处理
- en: 'Going forward, we only need three of the eight variables in gini—these being
    `salary`, `season_end`, and `team`. There’s no use keeping unnecessary data around,
    so we’ll reduce the gini data set by calling the `select()` function from the
    `dplyr` package to include just these three variables:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，我们只需要 gini 中的八个变量中的三个——这些是 `salary`、`season_end` 和 `team`。没有必要保留不必要的数据，因此我们将通过调用
    `dplyr` 包中的 `select()` 函数来减少 gini 数据集，只包括这三个变量：
- en: '[PRE7]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Next, we convert the variables `season_end` and `team` to factors by calling
    the base R `as.factor()` function twice:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过两次调用基础 R 的 `as.factor()` 函数将变量 `season_end` 和 `team` 转换为因子：
- en: '[PRE8]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Then, we run the base R `summary()` function to return descriptive statistics
    for each of the three remaining variables in gini; the `maxsum` argument tells
    R to return up to but no more than 40 levels for factors. The variable `season_end`
    contains 34 levels, one for each season or year, and the variable `team`, because
    our data recognizes iterations in team names, contains 39 levels.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们运行基础 R 的 `summary()` 函数，以返回 gini 中剩余三个变量的描述性统计信息；`maxsum` 参数告诉 R 返回最多但不超过
    40 个级别的因子。变量 `season_end` 包含 34 个级别，每个赛季或年份一个，而变量 `team` 因为我们的数据识别了队名迭代，包含 39
    个级别。
- en: 'For variables that are numeric, such as `salary`, the `summary()` function
    returns the mean, median, minimum and maximum values, and the first and third
    quartiles; for variables that are factors, such as `season_end` and `team`, `summary()`
    instead returns the observation counts for each group:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 对于数值变量，例如 `salary`，`summary()` 函数返回平均值、中位数、最小值和最大值，以及第一和第三四分位数；对于因子变量，例如 `season_end`
    和 `team`，`summary()` 则返回每个组的观测计数：
- en: '[PRE9]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The `summary()` function output has revealed a couple of problems—one fairly
    minor but the other not so much. First, we have four observations in gini where
    the variable `team` is blank. This might have been an oversight when the data
    set was created, maybe these are players who had guaranteed contracts but didn’t
    play for any team due to injury, or it’s something else altogether. The following
    `SELECT` statement returns these four records from the gini data set:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '`summary()` 函数的输出揭示了一些问题——一个相对较小，另一个则不然。首先，我们在 gini 中有四个观测值，其中变量 `team` 为空。这可能是在创建数据集时的疏忽，也许这些是签订了保证合同但因为没有受伤而未为任何球队出场的球员，或者完全是其他原因。以下
    `SELECT` 语句从 gini 数据集中返回了这四个记录：'
- en: '[PRE10]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: It’s interesting that all are from the 1984-85 season.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 很有趣的是，所有这些数据都来自 1984-85 赛季。
- en: 'The second problem is that the record counts are low—very low in some cases—where
    the variable `season_end` is less than, or before, 1991\. This is likely because
    salaries weren’t always so public back in the day. The following pair of `SELECT`
    statements returns every record for two random teams, one from 1987 and the other
    from 1990, where, it turns out, the record counts are especially low:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个问题是记录计数较低——在某些情况下非常低——当变量 `season_end` 小于或早于 1991 年时。这很可能是由于当时薪水并不总是那么公开。以下两个
    `SELECT` 语句返回了两个随机队伍的每条记录，一个来自 1987 年，另一个来自 1990 年，结果发现记录计数特别低：
- en: '[PRE11]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'It’s possible to pull the same data and, of course, return the same results
    with `dplyr` code by substituting the `WHERE` clause in favor of the `filter()`
    function. That’s up to you. Just be aware that `dplyr` and `sqldf` don’t usually
    share the same syntax; for instance, `sqldf` uses `AND`, whereas `dplyr` uses
    `&`:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 有可能用相同的数据，当然，通过用 `dplyr` 代码替换 `WHERE` 子句来返回相同的结果，以使用 `filter()` 函数。这取决于你。只是要注意，`dplyr`
    和 `sqldf` 通常不使用相同的语法；例如，`sqldf` 使用 `AND`，而 `dplyr` 使用 `&`：
- en: '[PRE12]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The gini data set contains just three records for the 1987 Boston Celtics and
    just four records for the 1990 Los Angeles Lakers.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: gini 数据集只包含 1987 年波士顿凯尔特人队的三个记录和 1990 年洛杉矶湖人队的四个记录。
- en: Due to these discoveries, we then subset the gini data set by removing all rows
    where the *factor* variable `season_end` equals `1985`, `1986`, `1987`, `1988`,
    `1989`, or `1990` to remove NBA seasons with incomplete data. We then have a new
    working data set called gini3.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这些发现，我们随后通过删除所有 `factor` 变量 `season_end` 等于 `1985`、`1986`、`1987`、`1988`、`1989`
    或 `1990` 的行来对 gini 数据集进行子集化，以删除数据不完整的 NBA 赛季。然后我们有一个新的工作数据集，称为 gini3。
- en: 'To make this happen, we call the base R `c()` function to create a vector containing
    the `season_end` levels 1985 through 1990\. Next, because we’re filtering by vector,
    we use the `%in%` operator, which instructs R to sift through the variable `season_end`
    and remove—rather than retain because our code is fronted by the logical negation
    operator denoted by `!`—those records where the level equals one of the values
    inside our vector:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实现这一点，我们调用基础R的`c()`函数来创建一个包含1985年至1990年`season_end`级别的向量的向量。接下来，因为我们通过向量进行过滤，所以我们使用`%in%`运算符，该运算符指示R通过变量`season_end`筛选并移除（而不是保留，因为我们的代码前面有表示逻辑否定运算符的`!`运算符）那些级别等于我们向量中值的记录：
- en: '[PRE13]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'We then call the `dim()` function to return the dimension of the gini3 data
    set:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用`dim()`函数来返回gini3数据集的维度：
- en: '[PRE14]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: As a result, our working data set has been reduced to 12,929 records from an
    original row count of 14,163, which is a difference of 1,234 records.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们的工作数据集已从原始的14,163行减少到12,929行，相差1,234行。
- en: 'Following are two quick points on our data:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我们数据中的两个快速要点：
- en: A typical NBA regular season starts in mid-October and ends in mid-April, thereby
    starting in one calendar year and ending in another. So, for instance, because
    the 2018 season actually started in October 2017, it’s sometimes called the 2017-18
    season. We previously removed the variables `season` and `season_start` from the
    gini data set because neither one, or even the two together, add more value than
    the variable `season_end` by itself.
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NBA常规赛通常在十月中旬开始，在四月中旬结束，因此开始于一个日历年份，结束于另一个日历年份。所以，例如，因为2018赛季实际上是在2017年10月开始，有时被称为2017-18赛季。我们之前从gini数据集中删除了变量`season`和`season_start`，因为它们（甚至两个一起）比单独的变量`season_end`本身增加的价值不多。
- en: Unlike the salaries data set, which we worked with in the prior two chapters,
    the gini data set recognizes franchise moves and subsequent changes in team names
    that occurred between the 1985 and 2018 seasons. This is why the variable `team`
    contains significantly more than 30 levels.
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与我们在前两章中使用的薪资数据集不同，gini数据集识别了1985年至2018赛季之间的特许经营变动和随后的球队名称变更。这就是为什么变量`team`包含的级别比30多个级别显著更多。
- en: 'In the following chunk of code, we further reduce the gini3 data set by retaining
    no more than the top 14 player salaries for each `team` and `season_end` combination.
    Our results would otherwise be unfairly or inaccurately skewed by including the
    league’s lowest salary players, who are usually playing on short-term or temporary
    contracts. We make this happen by following these steps:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下代码块中，我们进一步通过仅保留每个`team`和`season_end`组合中排名前14位的球员薪资来减少gini3数据集。否则，包括联赛最低薪资球员的结果可能会不公平或不准确，这些球员通常在短期或临时合同上打球。我们通过以下步骤实现这一点：
- en: We start by passing the gini3 data set via the pipe operator to the `dplyr arrange()`
    function, which sorts gini by each of its three variables.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先通过管道运算符将gini3数据集传递给`dplyr arrange()`函数，该函数按gini的每个三个变量进行排序。
- en: We then call the `dplyr group_by``()` and `mutate()` functions and the base
    R `rank()` function to create a new variable called `rank`, where the variable
    salary is sorted in descending order, 1 through *n*, by every `team` and `season_end`
    combination. The minus, or negative, sign inside the `rank()` function sorts,
    or ranks, the variable salary in descending order. The `ties.method` argument
    specifies how ties should be handled; when equal to `first`, R assigns tied elements
    consecutive, and thus different, ranks.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们调用`dplyr group_by()`和`mutate()`函数以及基础R的`rank()`函数来创建一个名为`rank`的新变量，其中变量薪资按每个`team`和`season_end`组合的降序排列，1到*n*。`rank()`函数中的负号或负号对变量薪资进行排序或排名。`ties.method`参数指定如何处理平局；当等于`first`时，R将平局元素分配为连续的、因此不同的排名。
- en: 'Finally, we call the `dplyr filter()` function to include only those records
    where the variable rank is less than or equal to 14\. The results are thrown into
    a tibble called gini4:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们调用`dplyr filter()`函数，仅包括变量排名小于或等于14的记录。结果被放入一个名为gini4的tibble中：
- en: '[PRE15]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: This leaves us with a working data set in which the record count for every `season_end`
    and `team` combination equals a maximum of 14\. But let’s perform a series of
    integrity checks to validate that.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这使得我们拥有一个工作数据集，其中每个`season_end`和`team`组合的记录数最多为14。但让我们进行一系列完整性检查以验证这一点。
- en: 'In the next code chunk, we twice call the `sqldf()` function from the `sqldf`
    package to write `SELECT` statements that pull data from the gini3 data set and
    the gini4 tibble where the variable `season_end` equals `2012` and the variable
    `team` equals `Denver Nuggets` for both. Notice that we use double quotation marks
    on the outside and single quotation marks on the inside; this style makes it easier
    for R to read and interpret the code:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个代码块中，我们两次调用`sqldf()`函数，该函数来自`sqldf`包，编写`SELECT`语句从gini3数据集和gini4 tibble中提取数据，其中变量`season_end`等于`2012`且变量`team`等于丹佛掘金队。注意我们在外面使用双引号，在内部使用单引号；这种风格使R更容易阅读和解释代码：
- en: '[PRE16]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: The first `SELECT` statement returns every record and every variable from gini3
    where `season_end` equals `2012` and `team` equals `Denver Nuggets`; 15 records
    are returned, one for each player who was on Denver’s payroll that season.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个`SELECT`语句返回gini3中`season_end`等于`2012`且`team`等于`Denver Nuggets`的每条记录和每个变量；返回了15条记录，每条记录代表那个赛季在丹佛掘金队工资名单上的每位球员。
- en: The second `SELECT` statement returns every record and every variable from gini4
    where `season_end` also equals `2012` and `team` also equals `Denver Nuggets`;
    14 records are then returned where the variable salary is sorted in ascending
    order and the variable rank is sorted in descending order. This is exactly what
    we were expecting.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个`SELECT`语句返回gini4中`season_end`也等于`2012`且`team`也等于`Denver Nuggets`的每条记录和每个变量；然后返回了14条记录，其中工资变量按升序排序，排名变量按降序排序。这正是我们预期的。
- en: 'Let’s try this again, this time by swapping out the 2012 Denver Nuggets for
    the 2018 Chicago Bulls:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们再次尝试，这次用2012年的丹佛掘金队替换为2018年的芝加哥公牛队：
- en: '[PRE17]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The first `SELECT` statement returns 23 records, and the second returns the
    top 14 player salaries sorted from lowest to highest. That’s perfect.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个`SELECT`语句返回23条记录，第二个返回从最低到最高排序的前14位球员工资。这很完美。
- en: 'Finally, let’s run two more `SELECT` statements that compute the gini4 row
    counts where the variable `team` equals `Denver Nuggets` and then when the variable
    `team` equals `Chicago Bulls`. Row counts should equal a maximum of 392, which
    is the product of 28 seasons multiplied by a maximum of 14 player salaries per
    season (some teams in some seasons had fewer than 14 players on their respective
    payrolls):'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们运行两个额外的`SELECT`语句，计算`gini4`行数，其中变量`team`等于`Denver Nuggets`，然后当变量`team`等于`Chicago
    Bulls`时。行数应该等于最大值392，这是28个赛季乘以每个赛季最多14位球员工资的结果（有些队伍在某些赛季的工资名单上球员人数少于14人）：
- en: '[PRE18]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Because the row counts equal 388 for the Nuggets and 387 for the Bulls, these
    two checks further validate the integrity of our data.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 因为掘金队的行数是388，公牛队的行数是387，这两个检查进一步验证了我们的数据完整性。
- en: It’s always a worthwhile investment of time and effort to validate operations
    that aren’t necessarily performed every day. Let’s now start our analysis by computing
    Gini coefficients.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 验证那些并非每天都必须执行的操作，始终是时间和精力的值得投资。现在，让我们通过计算基尼系数来开始我们的分析。
- en: 12.5 Gini coefficients
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.5 基尼系数
- en: Once more, the Gini coefficient is a measure of *inequality*, so higher coefficients
    therefore mean greater dispersion. Let’s demonstrate Gini coefficients with a
    series of very simple examples.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，基尼系数是衡量*不平等*的指标，因此系数越高意味着差异越大。让我们通过一系列非常简单的例子来演示基尼系数。
- en: 'For starters, suppose we have a group of 10 individuals who each earn an income
    of $50 per month. We create a vector with 10 like elements by calling the `rep``()`
    and `c()` functions and telling R to repeat 50 ten times. Then, we pass our vector
    to the `ineq()` function from the `ineq` package to compute the Gini coefficient:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，假设我们有一组10个人，每人每月收入50美元。我们通过调用`rep()`和`c()`函数并告诉R重复50十次来创建一个包含10个相同元素的向量。然后，我们将我们的向量传递给`ineq()`函数，该函数来自`ineq`包，以计算基尼系数：
- en: '[PRE19]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Because everyone earns the exact same income, there’s perfect equality, and
    therefore, the Gini coefficient equals 0.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 因为每个人的收入都完全相同，所以存在完美的平等，因此基尼系数等于0。
- en: 'In our second example, we have five individuals earning $50 per month and another
    five individuals earning twice that; thus, two-thirds of the total income is earned
    by just half the individuals:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的第二个例子中，有五个人每月赚50美元，另外五个人赚两倍于此；因此，三分之二的收入仅由一半的人赚取：
- en: '[PRE20]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: As a result, we have a Gini coefficient equal to 0.17.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们得到的基尼系数等于0.17。
- en: 'In our third example, half the individuals earn $150 per month, and the other
    half earn $300 per month:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的第三个例子中，一半的人每月赚取150美元，另一半的人每月赚取300美元：
- en: '[PRE21]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Compared to our prior example, monthly incomes are higher across the board;
    nevertheless, the Gini coefficient also equals 0.17 because exactly two-thirds
    of the total income is again earned by just half the individuals. As previously
    mentioned, we can have right- and left-skewed distributions but equal Gini coefficients.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 与先前的例子相比，月收入普遍较高；然而，基尼系数也等于0.17，因为总收入的三分之二再次仅由一半的人赚取。正如之前提到的，我们可以有右偏和左偏的分布，但基尼系数相等。
- en: 'In our fourth example, we have a perfectly normal monthly income distribution
    where both the mean and the median equal 80 and the standard deviation is minimal:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的第四个例子中，我们有一个完美的月收入分布，平均值和中位数都是80，标准差最小：
- en: '[PRE22]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Nearly half of the total monthly income is earned by just four individuals;
    as a result, we have a Gini coefficient equal to 0.10.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎一半的月收入是由仅四个人赚取的；因此，我们有一个基尼系数等于0.10。
- en: 'In our fifth example, we again have a perfectly normal income distribution;
    this time, the mean and median equal 100, and the standard deviation is twice
    what it was before:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的第五个例子中，我们再次有一个完美的正常收入分布；这次，平均值和中位数都是100，标准差是之前的两倍：
- en: '[PRE23]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: As a result, 55% of the monthly income is earned by just 4 of the 10 individuals,
    and our Gini coefficient doubles to 0.20.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，10个人中有4个人的月收入占55%，我们的基尼系数翻倍至0.20。
- en: 'In our sixth and final example, nine individuals earn just $10 every month
    while a 10th individual earns $100:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的第六个和最后一个例子中，九个人每月仅赚取10美元，而第十个人每月赚取100美元：
- en: '[PRE24]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: This last individual is therefore earning just more than twice the income of
    everyone else combined, so we have a much higher Gini coefficient, 0.43, as a
    result.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，最后这个人的收入是其他所有人收入的两倍多，因此基尼系数因此大幅上升至0.43。
- en: 'Now, in the following chunk of code, we pass the most recent version of our
    working data set, gini4, to the `dplyr group_by``()` and `summarize()` functions
    and the `ineq()` function to compute the Gini coefficient by each remaining factor
    in the variable `season_end`. The results are cast into a tibble called gini_summary.
    By calling the base R `round()` function, we’re limiting the results to include
    just two digits right of the decimal point:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在下面的代码块中，我们将我们工作数据集的最新版本gini4传递给`dplyr::group_by()`和`summarize()`函数以及`ineq()`函数，以根据变量`season_end`中的每个剩余因素计算基尼系数。结果被转换成一个名为gini_summary的tibble。通过调用基础R的`round()`函数，我们限制结果只包含小数点后两位数字：
- en: '[PRE25]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'These results are then visualized in a `ggplot2` line, or time series, chart
    (see figure 12.1). Following are some pointers around the key `ggplot2` functions
    that are called:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果随后在`ggplot2`线图或时间序列图中进行可视化（见图12.1）。以下是关于被调用的关键`ggplot2`函数的一些提示：
- en: The `geom_line()` function draws a single line that is 1.5 times the default
    `ggplot2` width.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_line()`函数绘制了一条宽度为默认`ggplot2`宽度的1.5倍的线条。'
- en: The `geom_point()` function adds points along the line that are three times
    the default size.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_point()`函数在沿线添加了大小为默认大小的三倍的点。'
- en: The `geom_smooth()` function draws a thin regression line across the entire
    data series without any confident band because we’re adding the `se = FALSE` argument
    to `geom_smooth()` to overwrite the default functionality.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_smooth()`函数在整个数据系列上绘制了一条细的回归线，没有置信区间，因为我们向`geom_smooth()`添加了`se = FALSE`参数来覆盖默认功能。'
- en: The second call to the `theme()` function orients the x-axis labels at 45 degrees
    and aligns them horizontally just beneath the plot.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第二次调用`theme()`函数将x轴标签旋转至45度，并将它们水平对齐在图表下方。
- en: Descriptive statistics are annotated in the lower-right corner of the plot by
    making successive calls to the `annotate()` function.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过连续调用`annotate()`函数，在图表的右下角标注描述性统计信息。
- en: '![CH12_F01_Sutton](../../OEBPS/Images/CH12_F01_Sutton.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![CH12_F01_Sutton](../../OEBPS/Images/CH12_F01_Sutton.png)'
- en: Figure 12.1 The year-over-year, or season-over-season, Gini coefficient of salary
    distribution across the NBA
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.1 NBA年薪分布的年度或季节性基尼系数
- en: 'That being said, here’s our code chunk:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，以下是我们的代码块：
- en: '[PRE26]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'These results are really fascinating:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果真的很令人着迷：
- en: Between 1991 and 1995, the Gini coefficient equaled 0.41 or 0.42 every year
    except in 1994, when it then equaled a gini_summary minimum of 0.39.
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在1991年至1995年之间，基尼系数每年都是0.41或0.42，除了1994年，当时它达到了gini_summary的最小值0.39。
- en: The Gini coefficient then spiked in 1995, again in 1996, and especially in 1997,
    where it equaled a gini_summary maximum of 0.52, despite static populations.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基尼系数在1995年激增，在1996年再次激增，特别是在1997年，尽管人口保持静态，基尼系数达到了0.52，这是基尼系数的最大值。
- en: The coefficient then dropped modestly in 1998 and again in 1999.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系数在1998年适度下降，并在1999年再次下降。
- en: A new norm was established by 1999 and maintained through 2018, where the Gini
    coefficient “bounced” between 0.47, the 1991-2018 mean, and 0.50.
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1999年建立了一个新的标准，并在2018年维持了这个标准，其中基尼系数在0.47（1991-2018年的平均值）和0.50之间“弹跳”。
- en: This all suggests that, while NBA salary distributions were *moderately* unequal
    back in the day, they are without doubt *significantly* unequal now.
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有这些都表明，尽管NBA薪资分布在过去是*适度*不平等的，但毫无疑问现在是*显著*不平等的。
- en: Inequality is visualized with a Lorenz curve, as we discussed earlier in the
    chapter. Next, we’ll demonstrate how to build a Lorenz curve with a `ggplot2`
    extension, show how a Gini coefficient can be estimated or even computed, and
    then discuss how to properly interpret the results.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 不平等性通过洛伦兹曲线进行可视化，正如我们在本章前面讨论的那样。接下来，我们将演示如何使用`ggplot2`扩展构建洛伦兹曲线，展示如何估计或甚至计算基尼系数，然后讨论如何正确解释结果。
- en: 12.6 Lorenz curves
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.6 洛伦兹曲线
- en: Once more, the Lorenz curve is a graphical representation of income or wealth
    distribution, where the percentage of income or salary distribution is usually
    the x-axis variable, and the percentage of individuals earning that income or
    drawing that salary is then the y-axis variable (though it would be perfectly
    fine to flip the variables).
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，洛伦兹曲线是收入或财富分布的图形表示，其中收入或薪资分布的百分比通常是x轴变量，而获得该收入或领取该薪资的个人百分比则是y轴变量（尽管翻转变量也是完全可以接受的）。
- en: 'It’s possible to create a Lorenz curve using built-in R functions; however,
    we’ll instead use the `ggplot2` package in conjunction with a `ggplot2` extension
    called `gglorenz`. Our first Lorenz curve visualizes salary distribution for the
    1993-94 season, where the Gini coefficient equaled 0.39, the minimum in our data
    set (see figure 12.2):'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 使用内置的R函数可以创建洛伦兹曲线；然而，我们将使用`ggplot2`包以及一个名为`gglorenz`的`ggplot2`扩展。我们的第一条洛伦兹曲线可视化了1993-94赛季的薪资分布，基尼系数为0.39，这是我们的数据集中的最小值（见图12.2）：
- en: We start by calling the `dplyr filter()` function to subset the gini4 data set
    where the variable `season_end` equals `1994`. In the process, we create a new
    data set called gini1994.
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们首先调用`dplyr filter()`函数，对gini4数据集进行子集化，其中变量`season_end`等于`1994`。在这个过程中，我们创建了一个名为gini1994的新数据集。
- en: Because our Lorenz curve is fundamentally no different from any other `ggplot2`
    object, we then initialize our plot by calling the `ggplot()` function and passing
    the gini1994 data set as a parameter and the variable `salary` as the only aesthetic
    mapping.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于我们的洛伦兹曲线在本质上与其他任何`ggplot2`对象没有区别，因此我们通过调用`ggplot()`函数并传递gini1994数据集作为参数以及变量`salary`作为唯一的美学映射来初始化我们的绘图。
- en: The `stat_lorenz()` function from the `gglorenz` package draws the Lorenz curve.
    When set to `TRUE`, the population is arranged in descending order; when set to
    `FALSE`, the population is instead arranged in ascending order. Because most Lorenz
    curves are created with the population arranged in ascending order, rather than
    vice versa, we set the `desc` argument, short for descending, to equal `FALSE`.
    Furthermore, we instruct R to draw the line a solid red and to make it twice the
    default width.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 来自`gglorenz`包的`stat_lorenz()`函数绘制洛伦兹曲线。当设置为`TRUE`时，人口按降序排列；当设置为`FALSE`时，人口则按升序排列。由于大多数洛伦兹曲线都是按人口升序排列创建的，而不是相反，因此我们将`desc`参数（表示降序）设置为`FALSE`。此外，我们指示R用实线红色绘制线条，并将其宽度增加到默认宽度的两倍。
- en: The `ggplot2 coord_fixed()` function fixes the ratios of the x- and y-axes so
    that their scales are equal. This isn’t absolutely necessary, but it’s highly
    recommended for Lorenz curves because it’s so important to keep the x- and y-axes
    aligned and with the same aspect ratio. It would be difficult to interpret the
    results otherwise.
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ggplot2 coord_fixed()`函数固定了x轴和y轴的比率，使它们的刻度相等。这并不是绝对必要的，但对于洛伦兹曲线来说，这是高度推荐的，因为保持x轴和y轴对齐以及相同的纵横比非常重要。否则，解释结果将很困难。'
- en: The `geom_abline()` function draws a dashed diagonal line that represents a
    state of perfect equality that we can compare to our inequality curve.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_abline()`函数绘制了一条虚线对角线，它代表了一种完美的平等状态，我们可以将其与我们的不平等曲线进行比较。'
- en: The `scale_x_continuous``()` and `scale_y_continuous()` functions, combined
    with the `scales` package—part of the `ggplot2` package, which, of course, is
    part of `tidyverse`—convert our x- and y-axis labels from decimals to percentages.
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`scale_x_continuous()` 和 `scale_y_continuous()` 函数，结合 `scales` 包——它是 `ggplot2`
    包的一部分，而 `ggplot2` 包当然又是 `tidyverse` 的一部分——将我们的x轴和y轴标签从小数转换为百分比。'
- en: '![CH12_F02_Sutton](../../OEBPS/Images/CH12_F02_Sutton.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![CH12_F02_Sutton](../../OEBPS/Images/CH12_F02_Sutton.png)'
- en: Figure 12.2 Lorenz curve for the 1993-94 NBA season when the Gini coefficient
    equaled 0.39
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.2 1993-94赛季的洛伦兹曲线，当吉尼系数等于0.39时
- en: 'Our data wrangling and data visualization code is shown here:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据整理和数据处理代码如下：
- en: '[PRE27]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Here’s how to interpret our Lorenz curve:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们如何解释我们的洛伦兹曲线：
- en: The x-axis represents the percentage of US dollars paid out in player salaries.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: x轴代表球员薪水的美元支付百分比。
- en: The y-axis represents the percentage of NBA players.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: y轴代表NBA球员的百分比。
- en: The dashed line represents a state of perfect equality where, for instance,
    50% of all dollars paid out in salaries are distributed to exactly 50% of the
    players in the league.
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚线线代表完全平等的状态，例如，50%的所有薪水都分给了联赛中50%的球员。
- en: The Lorenz curve represents the measure of salary inequality; the larger the
    area between it and the dashed line, the more inequality there is, and vice versa.
    In 1994, 75% of all dollars paid out in salaries were earned by just 50% of the
    players.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 洛伦兹曲线代表薪资不平等的程度；它与虚线之间的面积越大，不平等越严重，反之亦然。在1994年，75%的所有薪水都由50%的球员获得。
- en: The Gini coefficient can be derived by computing the area between the Lorenz
    curve and the line of perfect equality and dividing that by the total area beneath
    the line of perfect equality (you’ll see much more on this in chapter 13).
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 吉尼系数可以通过计算洛伦兹曲线与完全平等线之间的面积，并将其除以完全平等线下方的总面积来得出（你将在第13章中了解更多关于这一点）。
- en: 'Let’s draw a second Lorenz curve, if only for comparison purposes (see figure
    12.3). This can best be done by subsetting the gini4 data set where the variable
    `season_end` equals `1997`, when the Gini coefficient equaled a maximum of 0.52\.
    You’ll see how much additional area there is between the Lorenz curve and the
    line of perfect equality versus our previous plot. More of a gap between the Lorenz
    curve and the line of perfect equality means more inequality:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们再画一条洛伦兹曲线，仅为了比较目的（见图12.3）。这最好通过子集化 gini4 数据集来完成，其中变量 `season_end` 等于 `1997`，此时吉尼系数达到了最大值0.52。你会看到洛伦兹曲线与完全平等线之间的额外面积与之前的图表相比有多大。洛伦兹曲线与完全平等线之间的差距越大，意味着不平等越严重：
- en: '[PRE28]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![CH12_F03_Sutton](../../OEBPS/Images/CH12_F03_Sutton.png)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![CH12_F03_Sutton](../../OEBPS/Images/CH12_F03_Sutton.png)'
- en: Figure 12.3 Lorenz curve for the 1996-97 NBA season when the Gini coefficient
    equaled 0.53
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.3 1996-97赛季的洛伦兹曲线，当吉尼系数等于0.53时
- en: Whereas 75% of salaries were paid out to 50% of the players in 1994, 75% of
    salaries were distributed to just 38% of the players in 1997; that’s the difference
    between Gini coefficients equal to 0.39 versus 0.52.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 而1994年，75%的薪水发放给了50%的球员，而到了1997年，75%的薪水只发放给了38%的球员；这就是吉尼系数从0.39变为0.52的差异。
- en: Now that you have a good understanding of Gini coefficients and Lorenz curves,
    let’s apply what we’ve just learned by exploring how salary inequality might be
    associated with winning and losing.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经很好地理解了吉尼系数和洛伦兹曲线，让我们通过探索薪资不平等可能与胜负的关系来应用我们刚刚学到的知识。
- en: 12.7 Salary inequality and championships
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.7 薪资不平等与冠军
- en: We’ll begin by comparing and contrasting championship-winning teams versus all
    other teams. Recall that our going-in hypothesis is that teams with more equal
    salary distributions are generally more successful than other teams with less
    equal salary distributions.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从比较和对比冠军球队与其他所有球队开始。回想一下，我们的假设是，薪资分配更平等的球队通常比薪资分配不平等的球队更成功。
- en: We’ll need to wrangle our data first, however.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们首先需要整理我们的数据。
- en: 12.7.1 Wrangling data
  id: totrans-161
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.7.1 数据整理
- en: 'The following chunk of code reshapes the gini4 data set so that each player
    salary for every `team` and `season_end` combination is its own column:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码块将 gini4 数据集重塑，使得每个 `team` 和 `season_end` 组合的球员薪水都是其自己的列：
- en: First, however, we call the `dplyr select()` function to remove the variable
    `rank` from gini4.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然而，首先，我们调用 `dplyr select()` 函数从 gini4 中移除变量 `rank`。
- en: We then pass the gini4 data set to the `dplyr group_by``()`, `mutate``()`, and
    `row_ number()` functions to create a new variable called `id`, which is merely
    a column of consecutive numbers with separate and independent sequences for every
    `team` and `season_end` combination.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，我们将 gini4 数据集传递给 `dplyr` 的 `group_by()`、`mutate()` 和 `row_number()` 函数，以创建一个名为
    `id` 的新变量，它仅是一个连续数字的列，每个 `team` 和 `season_end` 组合都有独立的序列。
- en: Finally, we call the `tidyr pivot_wider()` function, which transposes gini4
    to a wide format from a long format where the variable `id` is broken out into
    columns and the values from the variable `salary` are used to populate the cells
    in these new columns.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们调用 `tidyr` 的 `pivot_wider()` 函数，该函数将 gini4 从长格式转换为宽格式，其中变量 `id` 被拆分为列，变量
    `salary` 的值用于填充这些新列中的单元格。
- en: 'The result is a new tibble called gini5\. A call to the base R `head()` function
    returns the first six observations (note that R automatically returns some of
    the values in scientific notation):'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个名为 gini5 的新 tibble。调用基础 R 的 `head()` 函数返回前六个观测值（注意 R 自动将一些值以科学记数法返回）：
- en: '[PRE29]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Note that columns 1 through 14 are now merely column names and not ranks; in
    fact, salaries are now sorted horizontally in ascending order from left to right.
    This is okay—we previously ranked salaries just to subset our data on the top
    14 salaries for every `team` and `season_end` combination. How salaries are otherwise
    arranged no longer matters.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，第 1 至 14 列现在只是列名，而不是排名；实际上，薪资现在是按从左到右的顺序水平排序。这是可以接受的——我们之前对薪资进行排名只是为了对每个
    `team` 和 `season_end` 组合的前 14 个薪资进行子集化。薪资如何排列不再重要。
- en: Then, we call the base R `names()` function to rename most of the gini5 column
    names; `season_end` and `team` will be left as is, but the remaining columns that
    originated as values in the former variable `rank` will be renamed so that `1`,
    for instance, is converted to `s1` (`s` being short for salaries), `2` is converted
    to `s2`, and so forth.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用基础 R 的 `names()` 函数来重命名 gini5 的大多数列名；`season_end` 和 `team` 将保持不变，但来自先前变量
    `rank` 的其余列将被重命名，例如，`1` 被转换为 `s1`（`s` 是 salaries 的缩写），`2` 被转换为 `s2`，依此类推。
- en: 'Once more, note that R returns the larger values in scientific notation when
    we again call the `head()` function to get the first six observations, which is
    perfectly fine for our purposes here:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 再次注意，当我们再次调用 `head()` 函数以获取前六个观测值时，R 会以科学记数法返回较大的值，这对于我们的目的来说完全没问题：
- en: '[PRE30]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Then, we call the `mutate()` function from the `dplyr` package to create a new
    variable called `gini_index`, which equals the computed Gini coefficient for every
    `team` and `season_end` combination in the gini5 data set, rounded to two digits
    right of the decimal point. The Gini coefficient is again computed by calling
    the `ineq()` function from the `ineq` package, which takes the variables `s1`
    through `s14` as arguments. By setting the `na.rm` argument to `TRUE`, we’re instructing
    the `ineq()` function to skip Not Available (NA) values in our data; if we had
    instead set it to `FALSE`, the `ineq()` function would return NA for every `team`
    and `season_end` combination with fewer than 14 salaries. (Remember, we set 14
    players/salaries as the maximum per team per season, not the minimum.)
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用 `dplyr` 包中的 `mutate()` 函数来创建一个名为 `gini_index` 的新变量，该变量等于 gini5 数据集中每个
    `team` 和 `season_end` 组合的 Gini 系数，四舍五入到小数点后两位。Gini 系数再次通过调用 `ineq` 包中的 `ineq()`
    函数来计算，该函数将变量 `s1` 到 `s14` 作为参数。通过将 `na.rm` 参数设置为 `TRUE`，我们指示 `ineq()` 函数跳过数据中的不可用（NA）值；如果我们将其设置为
    `FALSE`，则 `ineq()` 函数将为每个 `team` 和 `season_end` 组合中少于 14 个薪资的情况返回 NA。 （记住，我们将
    14 名球员/薪资设定为每个团队每个赛季的最大值，而不是最小值。）
- en: 'The result is a new data set called gini6\. The `head()` function prints the
    first six observations:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个名为 gini6 的新数据集。`head()` 函数打印出前六个观测值：
- en: '[PRE31]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Next, we call the `read_csv()` function again to import a second data set,
    called records:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们再次调用 `read_csv()` 函数来导入第二个数据集，称为 records：
- en: '[PRE32]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'A subsequent call to the `dplyr glimpse()` function returns the records row
    and column counts as well as a small sample of the data:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 调用 `dplyr` 的 `glimpse()` 函数的后续操作会返回记录的行数和列数，以及数据的一个小样本：
- en: '[PRE33]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The records data set includes variables called `season_end` and `team` that
    align perfectly with the same variables from gini6\. It also contains the following
    variables:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: records 数据集包括名为 `season_end` 和 `team` 的变量，它们与 gini6 中的相同变量完全匹配。它还包含以下变量：
- en: '`wins`—Equals the number of regular season wins. As a reminder, teams play
    an 82-game regular season schedule. But in 1999 and again in 2012, the seasons
    were cut short due to lockouts over disagreements between the owners and players
    over money. As a result, the 1999 season was cut to just 50 games, and the 2012
    season was reduced to 66 games.'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`wins`——等于常规赛的胜利次数。作为提醒，球队参加82场比赛的常规赛。但在1999年和2012年，由于所有者和球员之间关于金钱的分歧而发生的停摆，赛季都被缩短了。因此，1999赛季缩短到只有50场比赛，2012赛季减少到66场比赛。'
- en: '`losses`—Equals the number of regular season losses.'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`losses`——等于常规赛的失败次数。'
- en: '`pct`—Short for winning percentage, a derived variable equal to wins divided
    by the sum of wins and losses.'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pct`——代表胜率，是一个派生变量，等于胜利次数除以胜利次数和失败次数的总和。'
- en: '`champ`—A binary variable equal to `0` or `1`, where `0` indicates a team didn’t
    win a championship and `1` indicates otherwise.'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`champ`——一个等于`0`或`1`的二元变量，其中`0`表示一支球队没有赢得冠军，而`1`表示否则。'
- en: 'We then convert the variables `season_end`, `team`, and `champ` to factor variables:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们将变量`season_end`、`team`和`champ`转换为因子变量：
- en: '[PRE34]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Next, we perform a left join on the gini6 and records data sets by calling
    the `left_ join()` function from the `dplyr` package. The two data sets are joined
    on the variables `season_end` and `team`; otherwise, `left_join``()` returns a
    new data set, gini_records, that contains every row and every column from gini6
    and records:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们通过调用`dplyr`包中的`left_join()`函数在gini6和records数据集上执行左连接。两个数据集在变量`season_end`和`team`上连接；否则，`left_join()`返回一个新数据集，gini_records，它包含gini6和records中的每一行和每一列：
- en: '[PRE35]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Our new data set has a dimension of 816 rows and 21 columns—816 rows because
    that’s the row count from gini6 and records, and 21 columns because that’s the
    number of mutually exclusive variables between gini6 and records, plus the two
    shared variables `season_end` and `team`:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的新数据集有816行和21列——816行是因为来自gini6和records的行数，21列是因为gini6和records之间相互排斥的变量数量，加上两个共享变量`season_end`和`team`：
- en: '[PRE36]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'The `head()` function returns the first three observations from gini_records:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '`head()`函数返回gini_records的前三个观测值：'
- en: '[PRE37]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Now that the gini6 and records data sets have been joined into a single object,
    we can perform operations that would not otherwise be possible and then execute
    on our analysis goals.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，由于gini6和records数据集已经合并成一个单一的对象，我们可以执行那些在其他情况下不可能的操作，然后执行我们的分析目标。
- en: 12.7.2 T-test
  id: totrans-193
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.7.2 t-test
- en: 'Because we’re first evaluating championship-winning teams versus all other
    teams, we’ll compute the average Gini coefficient grouped by the gini_records
    binary variable `champ` and then perform a t-test to determine if any variance
    is statistically significant. The variable `champ` equals `0` for those teams
    that failed to win a league championship or `1` for the one team per season where
    a team did win a title. Two reminders are in order:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我们是首先评估赢得冠军的球队与所有其他球队，我们将计算按gini_records二元变量`champ`分组的平均基尼系数，然后执行t-test以确定任何方差是否在统计上显著。变量`champ`对于未能赢得联赛冠军的球队等于`0`，对于每个赛季赢得冠军的那支球队等于`1`。以下是两个注意事项：
- en: Our expectation is that teams with more equal salary distributions are more
    successful than teams with less equal salary distributions. In other words, we
    should expect championship-winning teams to have, on average, a lower Gini coefficient
    than the average team that didn’t win a championship.
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的预期是，薪酬分配更平均的团队比薪酬分配不平均的团队更成功。换句话说，我们应该预期赢得冠军的团队的平均基尼系数低于没有赢得冠军的平均团队。
- en: From a purely statistical perspective, our null hypothesis is that any variance,
    one way or the other, is due to chance. We’ll therefore need our t-test to return
    a p-value below the 5% threshold for significance to reject the null hypothesis
    and accept the alternative hypothesis that differences in salary distributions
    are meaningful.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从纯粹统计的角度来看，我们的零假设是任何方差，无论是一方还是另一方，都是由于偶然性造成的。因此，我们需要我们的t-test返回一个低于5%显著性阈值的p-value，以拒绝零假设并接受备择假设，即薪酬分配的差异是有意义的。
- en: 'We start with a chunk of `dplyr` code by which the gini_records data set is
    passed to the `group_by``()` and `summarize()` functions; again, we’re computing
    the average of the variable gini_index by the binary variable `champ`. Our results
    are cast into a tibble called gini_summary2:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从一段`dplyr`代码开始，通过这段代码将`gini_records`数据集传递给`group_by()`和`summarize()`函数；再次，我们通过二元变量`champ`计算变量`gini_index`的平均值。我们的结果被转换成一个名为`gini_summary2`的tibble：
- en: '[PRE38]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: So the 28 championship-winning teams in our data set—one per season between
    1991 and 2018—have an average Gini coefficient equal to 0.53, while teams that
    didn’t win a league championship had an average Gini coefficient equal to 0.48\.
    In other words, championship-winning teams between 1991 and 2018 had more unequal
    salary distributions than other teams.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在我们的数据集中有 28 支冠军球队——从 1991 年到 2018 年每赛季一支——平均基尼系数等于 0.53，而未赢得联赛冠军的球队的平均基尼系数等于
    0.48。换句话说，1991 年到 2018 年间，冠军球队比其他球队的工资分布更加不平等。
- en: Is this variance statistically significant? Let’s perform our t-test to find
    out. A t-test is a statistical test that compares the means from two, and only
    two, data series. It considers the difference in means, group variances, and record
    counts to determine if the variance is essentially equal to zero or different
    from zero. If the former, we’ll fail to reject our null or going-in hypothesis
    that the means are equal; if the latter, we’ll reject the null hypothesis and
    instead accept the alternative hypothesis that the means are different.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方差在统计学上是否显著？让我们进行 t 检验来找出答案。t 检验是一种统计检验，它比较两个（且仅两个）数据系列的均值。它考虑均值差异、组方差和记录数，以确定方差是否本质上等于零或不同于零。如果前者，我们将无法拒绝我们的零假设或进入假设，即均值相等；如果后者，我们将拒绝零假设，并接受备择假设，即均值不同。
- en: 'With that in mind, we establish two new data sets, giniX, which is gini_records
    filtered on the variable `champ` equaling `0`, and giniY, which is gini_records
    filtered on the variable `champ` instead equaling `1`. The t-test is performed
    against the gini_records variable `gini_index` by calling the `t.test()` function
    from base R:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个前提下，我们建立了两个新的数据集，giniX，它是通过变量 `champ` 等于 `0` 过滤的 gini_records，而 giniY，它是通过变量
    `champ` 而不是等于 `1` 过滤的 gini_records。t 检验是通过从基础 R 调用 `t.test()` 函数对 gini_records
    变量 `gini_index` 进行的：
- en: '[PRE39]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The p-value, defined as the probability that a statistical measure will be
    greater than or equal to the observed results, of the t-test essentially equals
    0\. Because it’s below the predefined and generally accepted 5% threshold for
    significance, we reject the null hypothesis that the means are statistically equal.
    This means the variance is statistically significant: that championship-winning
    teams have more *unequal* salary distributions than all other teams is a statistically
    significant differentiator. This is likely due to championship-winning teams having
    superstar and high-priced talent on their respective rosters, which, because of
    the salary cap, leaves less money available for other players.'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: t 检验的 p 值，定义为统计量大于或等于观察结果的概率，基本上等于 0。因为它低于预定义的通常接受的 5% 显著性阈值，所以我们拒绝均值在统计学上相等的零假设。这意味着方差在统计学上是显著的：冠军球队比所有其他球队有更多
    *不平等* 的工资分布是一个具有统计学意义的差异。这可能是由于冠军球队在其阵容中有超级明星和高价人才，由于工资帽的限制，这为其他球员留下了更少的资金。
- en: 'We’ll visualize these results with paired `ggplot2` boxplots. Consider just
    a few notes about our code first:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用配对的 `ggplot2` 箱线图来可视化这些结果。首先，关于我们的代码有一些注意事项：
- en: We first call the `rbind()` function from base R to join the giniX and giniY
    data sets by rows, thereby creating a new object called giniXY in the process.
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们首先从基础 R 调用 `rbind()` 函数将 giniX 和 giniY 数据集按行连接，从而在过程中创建了一个名为 giniXY 的新对象。
- en: Our data source is therefore the giniXY data set.
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，我们的数据源是 giniXY 数据集。
- en: Our x-axis variable is the binary variable `champ`, and our y-axis variable
    is `gini_index`.
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的自变量是二元变量 `champ`，而我们的因变量是 `gini_index`。
- en: The `ggplot()` function automatically draws horizontal lines to represent the
    medians. The `stat_summary()` function adds light dots to represent the means.
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ggplot()` 函数自动绘制水平线来表示中位数。`stat_summary()` 函数添加了轻点来表示均值。'
- en: The `scale_x_discrete()` function adds the labels `League Champions` and `All
    Other Teams` in lieu of the `1` and `0`, respectively, from the binary variable
    `champ`.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`scale_x_discrete()` 函数将二元变量 `champ` 的标签 `1` 和 `0` 分别替换为 `League Champions`
    和 `All Other Teams`。'
- en: Shape options with ggplot2
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: ggplot2 的形状选项
- en: 'We digressed in a previous chapter by briefly mentioning the different types
    of lines that you can draw with the `ggplot2` graphics package, so it’s about
    time we did the same with respect to shapes. Because there are many options, shapes
    are referenced by numbers:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 在前一章中，我们简要提到了可以使用 `ggplot2` 图形包绘制不同类型的线条，因此现在是时候对形状进行同样的介绍了。因为有很多选项，形状通过数字进行引用：
- en: 'Circles: 1, 10, 13, 16, 19, 20, 21'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 圆形：1，10，13，16，19，20，21
- en: 'Triangles: 2, 6, 17, 24, 25'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 三角形：2，6，17，24，25
- en: 'Diamonds: 5, 9, 18, 23'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 方形：5，9，18，23
- en: 'Squares: 0, 7, 12, 14, 15, 22'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 正方形：0，7，12，14，15，22
- en: 'Other: 3, 4, 8, 11'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 其他：3，4，8，11
- en: All of these can be manipulated by adding or changing colors, fills, and sizes.
    As always, you’ll want to experiment with different combinations of shapes, colors,
    fills, and sizes.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 所有这些都可以通过添加或更改颜色、填充和大小来调整。一如既往，您会想尝试不同的形状、颜色、填充和大小的组合。
- en: 'Here’s our data wrangling and data visualization code; the fruits of this,
    our paired box plots, follow (see figure 12.4):'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是我们的数据处理和可视化代码；其成果，即我们的配对箱线图，如下所示（见图12.4）：
- en: '[PRE40]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '![CH12_F04_Sutton](../../OEBPS/Images/CH12_F04_Sutton.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![CH12_F04_Sutton](../../OEBPS/Images/CH12_F04_Sutton.png)'
- en: Figure 12.4 Paired boxplots that visualize the means, medians, and Gini coefficient
    distributions between championship-winning teams and all other teams. The variances
    are statistically significant.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.4 配对箱线图，可视化冠军队伍与其他所有队伍之间的均值、中位数和基尼系数分布。方差具有统计学意义。
- en: We already know, of course, that the mean Gini coefficient is greater for championship-winning
    teams than it is for all other teams. The boxplots show that the medians, too,
    are quite different and that the distribution for league champions is less dispersed
    than it is for the remaining teams. Recall that the boxplots decompose the distribution
    of a data series between the Interquartile Range (IQR), which represents the middle
    50% of the data; the whiskers that extend below and above the IQR that represent,
    respectively, the lower 25% and upper 25% of the data; and outliers, represented
    by solid dots beyond the whiskers.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们已经知道冠军队伍的基尼系数平均值大于其他所有队伍。箱线图显示，中位数也相当不同，联赛冠军的分布比其他队伍的分布更分散。回想一下，箱线图将数据系列的分布分解为四分位数范围（IQR），代表数据的中间50%；分别代表数据的下25%和上25%的IQR延伸到四分位数范围以下和以上的触须；以及代表超出触须的异常值，由实心点表示。
- en: Next, we’ll complement our t-test with a Cohen’s d effect size test.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将用Cohen’s d效应量测试来补充我们的t检验。
- en: 12.7.3 Effect size testing
  id: totrans-224
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.7.3 效应量测试
- en: 'Let’s now perform a Cohen’s d test, which is a type of effect size test based
    on population means and standard deviations. Unlike a t-test, a Cohen’s d test
    isn’t influenced by record counts. The syntax resembles that of a t-test, or even
    a correlation test, for that matter; we merely substitute the `t.test()` function
    or the `cor.test()` function with the `cohen.d()` function from the `effsize`
    package, as follows:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们进行Cohen’s d测试，这是一种基于总体均值和标准差的效果量测试。与t检验不同，Cohen’s d测试不受记录计数的影响。语法类似于t检验，甚至可以说类似于相关测试；我们只是用`effsize`包中的`cohen.d()`函数替换了`t.test()`函数或`cor.test()`函数，如下所示：
- en: '[PRE41]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Whereas a t-test returns a p-value from which we either reject or fail to reject
    a null hypothesis, a Cohen’s d test, by contrast, returns a categorical indicator
    representing the effect size, or magnitude of the variance, ranging from negligible
    to large, that ties back to the d estimate, which is defined as the number of
    standard deviations separating the two means. The d estimate will be positive
    or negative depending on how we sequenced the arguments passed to the `cohen.d()`
    function. Because the variable `gini_index` has a lower mean in giniX than in
    giniY, our Cohen’s d test returned a negative d estimate. Results somewhere between
    0.40 and 0.70 standard deviations, plus or minus, will translate into a medium
    effect size, which is what we see here.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 与t检验返回一个p值，从而我们拒绝或未能拒绝零假设相比，Cohen’s d检验则返回一个表示效应量或方差大小的分类指标，范围从可忽略到很大，这与d估计值相关联，d估计值定义为两个均值之间分离的标准差数。d估计值将根据我们传递给`cohen.d()`函数的参数顺序是正数还是负数。由于`gini_index`在giniX中的平均值低于在giniY中的平均值，我们的Cohen’s
    d检验返回了一个负的d估计值。结果在0.40到0.70标准差之间，正负波动，将转化为中等效应量，这正是我们所看到的。
- en: 12.8 Salary inequality and wins and losses
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.8 薪酬不平等与胜负
- en: We’ve thus determined that salary distributions matter when it comes to winning
    or not winning an NBA championship, but maybe not how we might have imagined when
    we started this journey. There’s not much additional data wrangling required,
    so we’ll jump into a second t-test and then a second Cohen’s d effect size test;
    this time, we’ll be comparing and contrasting winning and losing teams during
    the regular season.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们确定，在赢得或未赢得NBA总冠军时，薪资分布很重要，但可能并非我们开始这段旅程时所想象的那样。不需要进行太多额外的数据处理，所以我们将直接进行第二次t检验和第二次Cohen’s
    d效应量测试；这次，我们将比较和对比常规赛中的获胜和失败队伍。
- en: 12.8.1 T-test
  id: totrans-230
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.8.1 t检验
- en: 'Here and in the following section, we’ll be keying on the derived variable
    `pct`, which is equal to regular season winning percentage. We start by passing
    the gini_records data set to the `dplyr group_by``()` and `summarize()` functions;
    the `summarize()` function computes the Gini coefficient, rounded to two digits
    right of the decimal point, and the `group_by()` function divides the results
    between teams that had winning percentages equal to or greater than 0.50 versus
    less than 0.50\. Because we’ve included a logical operator inside the argument
    to the `group_by()` function, our results will therefore be split between `TRUE`
    and `FALSE`:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节和以下章节中，我们将关注派生变量`pct`，它等于常规赛胜率。我们首先将gini_records数据集传递给`dplyr group_by()`和`summarize()`函数；`summarize()`函数计算基尼系数，四舍五入到小数点后两位，而`group_by()`函数将结果分为胜率等于或大于0.50的队伍与胜率小于0.50的队伍。因为我们已经在`group_by()`函数的参数中包含了一个逻辑运算符，所以我们的结果将在`TRUE`和`FALSE`之间分割：
- en: '[PRE42]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Winning teams, on average, have higher Gini coefficients, and therefore more
    unequal salary distributions, than teams with losing records, at least between
    the 1991 and 2018 seasons. These results are probably statistically significant,
    but let’s see for sure.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 获胜队伍的平均基尼系数高于战绩不佳的队伍，至少在1991年至2018年赛季之间是这样的。这些结果可能具有统计学意义，但让我们确保这一点。
- en: 'We therefore create two more data sets, giniA, which is gini_records subset
    where the variable `pct` is equal to or greater than `0.50`, and giniB, which
    is gini_records subset where the variable `pct` is less than 0.50\. Our t-test
    compares the gini_index means between the giniA and giniB data sets:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们创建了另外两个数据集，giniA，它是gini_records的子集，其中变量`pct`等于或大于`0.50`，以及giniB，它是gini_records的子集，其中变量`pct`小于`0.50`。我们的t检验比较了giniA和giniB数据集中的gini_index均值：
- en: '[PRE43]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: The p-value, not surprisingly, is again essentially 0; therefore, we again reject
    the null hypothesis and instead accept the alternative hypothesis that the variance
    in means is statistically significant.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: p值不出所料，再次几乎为0；因此，我们再次拒绝零假设，并接受备择假设，即均值方差在统计上具有显著性。
- en: 'In the following chunk of code, we call the base R `rbind()` function to join
    giniA and giniB into a new data set called giniAB. Then, we call the `dplyr mutate()`
    function to create a new variable called `win_pct` to divide teams into one of
    two populations, depending on their regular season winning percentage. The `ggplot2`
    code that follows has a syntax similar to our first set of boxplots (see figure
    12.5):'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下代码块中，我们调用基础R的`rbind()`函数将giniA和giniB合并到一个新的数据集giniAB中。然后，我们调用`dplyr mutate()`函数创建一个名为`win_pct`的新变量，根据球队的常规赛胜率将球队分为两个群体。接下来的`ggplot2`代码的语法与我们的第一组箱线图类似（见图12.5）：
- en: '[PRE44]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '![CH12_F05_Sutton](../../OEBPS/Images/CH12_F05_Sutton.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![CH12_F05_Sutton](../../OEBPS/Images/CH12_F05_Sutton.png)'
- en: Figure 12.5 Paired boxplots that visualize the means, medians, and Gini coefficient
    distributions between winning and losing teams. Once more, the variances are statistically
    significant.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.5展示了获胜和失败队伍之间均值、中位数和基尼系数分布的配对箱线图。再次强调，方差在统计上具有显著性。
- en: While our test results are rather straightforward, they nevertheless become
    more compelling when visualized. We could *almost* (if it weren’t for the relevance
    of record counts) set aside our t-test and instead put our complete trust in these
    paired boxplots, which clearly show significant enough differences in means, medians,
    and distributions. Let’s run a second Cohen’s d test to get a read on the effect
    size.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们的测试结果相当直接，但它们在可视化后变得更加引人注目。我们几乎可以（如果不是因为记录计数的相关性）将t检验放在一边，而是完全信任这些配对箱线图，它们清楚地显示了均值、中位数和分布之间的显著差异。让我们运行第二次Cohen’s
    d测试来了解效应量。
- en: 12.8.2 Effect size testing
  id: totrans-242
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.8.2 效应量测试
- en: 'We call the `cohen.d()` function and pass the same pair of arguments we originally
    passed for our t-test:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 我们调用 `cohen.d()` 函数，并传递与最初为我们的 t-test 传递的相同的一对参数：
- en: '[PRE45]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'Because the d estimate equals 0.62, our Cohen’s d test returns a medium effect
    size. Our d estimate is positive this time because the first argument passed to
    the `cohen.d()` function has a larger mean than the second argument passed; that
    is, the average Gini coefficient for salary distribution is higher for teams that
    won at least half of their regular season games than it is for teams that won
    fewer than half their games. Thus, our analysis so far has returned results we
    weren’t necessarily expecting, as summarized here:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 d 估计值为 0.62，我们的 Cohen’s d 测试返回了一个中等效应大小。这次我们的 d 估计值是正的，因为传递给 `cohen.d()`
    函数的第一个参数的平均值大于第二个参数的平均值；也就是说，赢得至少一半常规赛比赛的球队的薪酬分布的平均基尼系数高于赢得少于一半比赛的球队。因此，到目前为止，我们的分析得到了一些我们并不一定预期的结果，如下所述：
- en: Championship-winning teams between the 1991 and 2018 NBA seasons had, on average,
    more unequal salary distributions, at least based on Gini coefficients, than teams
    that didn’t win a championship.
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1991 年至 2018 年 NBA 赛季的冠军球队，根据基尼系数至少，比没有赢得冠军的球队具有更不平等的薪酬分布。
- en: These variances are statistically significant, and according to our Cohen’s
    d effect size test, which measures the practical significance rather than the
    statistical significance, the differences in means are graded as medium (which
    is less than large, but greater than negligible or small).
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些差异在统计学上是显著的，根据我们的 Cohen’s d 效应大小测试，它衡量的是实际意义而不是统计意义，平均值的差异被评定为中等（这小于大型，但大于可忽略或小型）。
- en: Teams that won at least half of their regular season games between 1991 and
    2018 had, on average, more unequal salary distributions than other teams that
    finished their regular seasons with losing records.
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 1991 年至 2018 年间，至少赢得一半常规赛比赛的球队，平均而言，比那些常规赛以失利结束的球队具有更不平等的薪酬分布。
- en: These variances, too, are statistically significant, and our subsequent Cohen’s
    d test returned more or less the same result as our first effect size test.
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些差异同样在统计学上是显著的，我们随后的 Cohen’s d 测试返回的结果与我们的第一次效应大小测试大致相同。
- en: We’ll take these last results a step further by categorizing every NBA team
    in our data set into one of five bins, or bands, and computing the average Gini
    coefficient for each.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把这些最后的结果进一步深入，通过将数据集中的每个 NBA 球队分类到五个区间之一，或称为档位，并计算每个档位的平均基尼系数。
- en: 12.9 Gini coefficient bands versus winning percentage
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.9 基尼系数档位与胜率对比
- en: Finally, we’ll create a `ggplot2` bar chart that plots Gini coefficients against
    regular season winning percentages. We’re about to see how well unequal salary
    distributions and higher regular season winning percentages are correlated with
    one another. This will first require some additional data wrangling, however.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将创建一个 `ggplot2` 条形图，该图将基尼系数与常规赛胜率进行对比。我们将看到不平等的薪酬分布和较高的常规赛胜率之间是如何相互关联的。然而，这首先需要一些额外的数据处理。
- en: We’ll start by passing the gini_records data set to the `dplyr mutate``()` and
    `case_when()` functions to create a categorical variable called `gini_band` derived
    from the numeric variable `gini_index`. When the variable `gini_index`, for instance,
    is equal to or greater than `0.60`, `gini_band` will equal `>0.60`; when `gini_index`
    is greater than or equal to `0.50` and less than `0.60`, `gini_band` will equal
    `>0.50`; and so forth. We want to see how Gini coefficients trend as regular season
    winning percentages increase from one band to the next.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先将 `gini_records` 数据集传递给 `dplyr mutate()` 和 `case_when()` 函数，以创建一个名为 `gini_band`
    的分类变量，该变量是从数值变量 `gini_index` 派生出来的。当变量 `gini_index`，例如，等于或大于 `0.60` 时，`gini_band`
    将等于 `>0.60`；当 `gini_index` 大于或等于 `0.50` 且小于 `0.60` 时，`gini_band` 将等于 `>0.50`；依此类推。我们想看看基尼系数是如何随着常规赛胜率从一档增加到下一档而变化的。
- en: 'Our new variable is then converted to a factor variable. The `head()` function
    returns the first three observations:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们的新变量被转换为因子变量。`head()` 函数返回前三个观测值：
- en: '[PRE46]'
  id: totrans-255
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Then, we pass gini_records to the `dplyr group_by``()` and `summarize()` functions,
    by which the `summarize()` function computes the mean of the variable `pct`, rounded
    two digits to the right of the decimal point, and the `group_by()` function separates
    the results for each factor in the variable `gini_band`. The results are cast
    to a tibble called gini_summary3:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们将gini_records传递给`dplyr group_by``()`和`summarize()`函数，通过`summarize()`函数计算变量`pct`的平均值，保留两位小数，而`group_by()`函数将变量`gini_band`中的每个因素的结果分开。结果被转换为名为gini_summary3的tibble：
- en: '[PRE47]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Here’s our `ggplot2` bar chart that takes gini_summary3 as a data source and
    plots the variable `gini_band` along the x-axis and the variable `mean_pct` along
    the y-axis (see figure 12.6):'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们使用`ggplot2`绘制的条形图，以gini_summary3作为数据源，并将变量`gini_band`沿x轴绘制，变量`mean_pct`沿y轴绘制（见图12.6）：
- en: '[PRE48]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '![CH12_F06_Sutton](../../OEBPS/Images/CH12_F06_Sutton.png)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![CH12_F06_Sutton](../../OEBPS/Images/CH12_F06_Sutton.png)'
- en: Figure 12.6 A bar chart that shows higher Gini coefficients—that is, more unequal
    salary distributions—to be very well aligned with higher regular season winning
    percentages
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.6 一个条形图显示了更高的基尼系数——即更不平等的工资分布——与更高的常规赛胜率非常一致
- en: There is a significant increase in regular season winning percentages as salary
    distributions become more unequal. Teams with Gini coefficients equal to or greater
    than 0.40 win, on average, at least 54% of their regular season games. By contrast,
    teams with Gini coefficients less than 0.40 win, on average, 43% or less of their
    regular season games. This is the difference between possibly winning a league
    championship and not even qualifying for postseason play.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 随着工资分布变得更加不平等，常规赛胜率显著增加。基尼系数等于或大于0.40的球队平均至少赢得常规赛比赛的54%。相比之下，基尼系数小于0.40的球队平均只赢得常规赛比赛的43%或更少。这是赢得联赛冠军的可能性和连季后赛资格都拿不到之间的区别。
- en: Salary inequality, then, at least in the NBA between 1991 and 2018, actually
    *creates* prosperity. That’s because superstars—who are fairly paid (based on
    performance) millions more per year than other players—are the motor that powers
    the NBA. We learned in chapter 3 that teams can’t even entertain the idea of winning
    a championship without one or, probably, two legitimate superstars on their roster.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，至少在1991年至2018年间的NBA中，工资不平等实际上*创造了*繁荣。这是因为超级巨星——他们的收入（基于表现）每年比其他球员多出数百万美元——是推动NBA的动力。我们在第3章中了解到，球队甚至不能考虑赢得冠军的想法，除非他们的阵容中有一名或可能两名真正的超级巨星。
- en: In the next chapter, we’ll explore inequality around win share distributions
    and how that may or may not be associated with winning and losing.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探讨围绕胜利份额分布的不平等，以及这可能与胜负有何关联。
- en: Summary
  id: totrans-265
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Maybe the most important point worth understanding about t-tests is that their
    results are dependent upon the difference in means *and* the record counts. Small
    variances on small data sets won’t register as statistically significant, but
    small variances on larger data sets might very well return different results.
    By the same token, large variances will absolutely return statistically significant
    results on large data sets and might or might not return the same on smaller data
    sets.
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于t检验，可能最值得理解的重要观点是，其结果取决于均值差异和记录数。在小数据集上，小的方差不会显示出统计显著性，但在大数据集上，小的方差可能会得到不同的结果。同样，在大数据集上，大的方差绝对会显示出统计显著的结果，而在小数据集上可能或可能不会得到相同的结果。
- en: Effect size tests, by contrast, don’t consider record counts. You can therefore
    get like returns on a pair of effect size tests when the variances are equal,
    but the record counts are not. As such, effect size tests should complement t-tests
    or other “like” statistical tests and should never be a substitute. You reject
    or fail to reject a null hypothesis based on the results of a statistical test
    such as a t-test or a chi-square test for independence; you would never do likewise
    based on the results of an effect size test. In addition, you should never draw
    like conclusions from like variances where the record counts are very different.
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与此相反，效应量测试并不考虑记录数。因此，当方差相等但记录数不相等时，你可能会得到一对效应量测试的类似回报。因此，效应量测试应该补充t检验或其他“类似”的统计测试，而不应该作为替代。你根据t检验或卡方检验等统计测试的结果拒绝或未能拒绝零假设；你永远不会根据效应量测试的结果做同样的事情。此外，当记录数差异很大时，你永远不应该从类似方差中得出类似结论。
- en: Make the investment in exploring your data. Not only does a thorough data exploration
    exercise return valuable insights, but often it will help guide your subsequent
    data wrangling and data analysis operations. Would our results have been any different
    had we heedlessly removed supposedly duplicate records in our data set?
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在探索你的数据上投资。不仅彻底的数据探索练习能带来宝贵的见解，而且它通常会帮助你指导后续的数据整理和分析操作。如果我们不假思索地移除数据集中所谓的重复记录，我们的结果会有所不同吗？
- en: Make additional investments in the course of your data wrangling activities
    to periodically check and verify the integrity of your operations, especially
    when those operations are atypical and relatively complex. Repetition, if it’s
    fair to call it that, should always take a back seat to periodic and even frequent
    integrity checks.
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在你的数据整理活动中进行额外的投资，定期检查和验证操作的完整性，尤其是在这些操作不典型且相对复杂时。如果可以称之为“重复”，那么它应该始终让位于定期甚至频繁的完整性检查。
- en: With respect to our results, championship-winning teams have, on average, more
    unequal salary distributions than other teams, and winning teams have, on average,
    more unequal salary distributions than losing teams. Our t-tests proved that these
    variances are, in fact, statistically significant. Our Cohen’s d tests further
    verified that these same variances are above negligible in magnitude.
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于我们的结果，冠军球队的平均薪资分布不平等程度比其他球队更高，获胜球队的平均薪资分布不平等程度比输球球队更高。我们的t检验证明，这些差异实际上在统计学上是显著的。我们的Cohen's
    d检验进一步证实，这些相同的差异在幅度上实际上是微不足道的。
- en: We know from prior chapters that winning teams, and especially championship-winning
    teams, usually have one or more superstars on their rosters who, of course, command
    the highest salaries. This leaves less money for other player salaries and undoubtedly
    helps explain our results.
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从前面的章节中我们知道，获胜的球队，尤其是冠军球队，通常在其阵容中有一到多个超级巨星，他们当然拥有最高的薪资。这留给其他球员的薪资就少了，这无疑有助于解释我们的结果。
- en: The league-wide Gini coefficient in player salaries has been and remains up
    significantly—by eight or so percentage points—since 1997 than before 1997\. Some
    of this is surely due to league expansion over the years and the increase in roster
    sizes. But the remainder may very well be due to increased awareness around the
    efficacy of larger investments in superstar talent.
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自从1997年以来，球员薪资的联赛范围内基尼系数已经显著上升——比1997年之前高出大约八个百分点。其中一部分原因无疑是由于多年来联赛的扩张和阵容规模的增加。但剩余的部分可能非常可能是由于对超级巨星人才更大投资的效益的认识增加。
