- en: 1 Why deep learning with structured data?
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1 为什么使用结构化数据的深度学习？
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章节涵盖
- en: A high-level overview of deep learning
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习的高级概述
- en: Benefits and drawbacks of deep learning
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习的利弊
- en: Introduction to the deep learning software stack
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习软件堆栈的介绍
- en: Structured versus unstructured data
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结构化数据与非结构化数据
- en: Objections to deep learning with structured data
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对结构化数据深度学习的反对意见
- en: Advantages of deep learning with structured data
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结构化数据深度学习的优势
- en: Introduction to the code accompanying this book
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍本书所附代码
- en: Since 2012, we have witnessed what can only be called a renaissance of artificial
    intelligence. A discipline that had lost its way in the late 1980s is important
    again. What happened?
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 自2012年以来，我们见证了只能称之为人工智能的复兴。一个在20世纪80年代末迷失方向的学科再次变得重要。发生了什么？
- en: 'In October 2012, a team of students working with Geoffrey Hinton (a leading
    academic proponent of deep learning based at the University of Toronto) announced
    a result in the ImageNet computer vision contest that achieved an error rate in
    identifying objects that was close to half that of the nearest competitor. This
    result exploited deep learning and ushered in an explosion of interest in the
    topic. Since then, we have seen deep learning applications with world-class results
    in many domains, including image processing, audio to text, and machine translation.
    In the past couple of years, the tools and infrastructure for deep learning have
    reached a level of maturity and accessibility that make it possible for nonspecialists
    to take advantage of deep learning’s benefits. This book shows how you can use
    deep learning to get insights into and make predictions about *structured data*:
    data organized as tables with rows and columns, as in a relational database. You
    will see the capability of deep learning by going step by step through a complete,
    end-to-end example of deep learning, from ingesting the raw input structured data
    to making the deep learning model available to end users. By applying deep learning
    to a problem with a real-world structured dataset, you will see the challenges
    and opportunities of deep learning with structured data.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 2012年10月，一支与多伦多大学深度学习主要倡导者杰弗里·辛顿（Geoffrey Hinton）合作的学生团队在ImageNet计算机视觉竞赛中宣布了一个结果，该结果在识别物体时的错误率接近竞争对手的一半。这一结果利用了深度学习，并引发了人们对这一主题的极大兴趣。从那时起，我们在许多领域看到了具有世界级结果的深度学习应用，包括图像处理、音频转文本和机器翻译。在过去的几年里，深度学习的工具和基础设施已经达到了成熟和易于访问的水平，使得非专业人士能够利用深度学习的优势。本书展示了您如何使用深度学习来深入了解和预测*结构化数据*：以表格形式组织的数据，如关系数据库中的行和列。您将通过逐步通过一个完整的、端到端的深度学习示例来了解深度学习的能力，从摄取原始输入结构化数据到将深度学习模型提供给最终用户。通过将深度学习应用于具有现实世界结构化数据集的问题，您将看到深度学习在结构化数据中的挑战和机遇。
- en: 1.1 Overview of deep learning
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.1 深度学习概述
- en: 'Before reviewing the high-level concepts of deep learning, let’s introduce
    a simple example that we can use to explore these concepts: detection of credit
    card fraud. Chapter 2 introduces the real-world dataset and an extensive code
    example that prepares this dataset and uses it to train a deep learning model.
    For now, this basic fraud detection example is sufficient for a review of some
    of the concepts of deep learning.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在回顾深度学习的高级概念之前，让我们介绍一个简单的例子，我们可以用它来探索这些概念：信用卡欺诈检测。第二章介绍了现实世界的数据集和大量的代码示例，该示例准备了这个数据集并使用它来训练一个深度学习模型。目前，这个基本的欺诈检测示例足以回顾一些深度学习的概念。
- en: 'Why would you want to exploit deep learning for fraud detection? There are
    several reasons:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 您为什么要利用深度学习进行欺诈检测？有几个原因：
- en: Fraudsters can find ways to work around the traditional rules-based approaches
    to fraud detection ([http://mng.bz/emQw](http://mng.bz/emQw)).
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 欺诈者可以找到绕过传统基于规则欺诈检测方法的方法([http://mng.bz/emQw](http://mng.bz/emQw))。
- en: A deep learning approach that is part of an industrial-strength pipeline—in
    which the model performance is frequently assessed and the model is automatically
    retrained if its performance drops below a given threshold—can adapt to changes
    in fraud patterns.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 作为工业级管道一部分的深度学习方法——在该管道中，模型的性能经常被评估，如果性能低于给定的阈值，模型将自动重新训练——可以适应欺诈模式的变化。
- en: A deep learning approach has the potential to provide near-real-time assessment
    of new transactions.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习方法有可能提供对新的交易进行近乎实时的评估。
- en: 'In summary, deep learning is worth considering for fraud detection because
    it can be the heart of a flexible, fast solution. Note that in addition to these
    advantages, there is a downside to using deep learning as a solution to the problem
    of fraud detection: compared with other approaches, deep learning is harder to
    explain. Other machine learning approaches allow you to determine which input
    characteristics most influence the outcome, but this relationship can be difficult
    or impossible to establish with deep learning.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，深度学习对于欺诈检测来说是值得考虑的，因为它可以成为灵活、快速解决方案的核心。请注意，除了这些优点之外，使用深度学习作为欺诈检测问题的解决方案也有一个缺点：与其他方法相比，深度学习更难以解释。其他机器学习方法允许你确定哪些输入特征对结果影响最大，但这个关系可能很难或无法用深度学习建立。
- en: Assume that a credit card company maintains customer transactions as records
    in a table. Each record in this table contains information about the transaction,
    including an ID that uniquely identifies the customer, as well as details about
    the transaction, including the date and time of the transaction, the ID of the
    vendor, the location of the transaction, and the currency and amount of the transaction.
    In addition to this information, which is added to the table every time a transaction
    is reported, every record has a field to indicate whether the transaction was
    reported as a fraud.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 假设一家信用卡公司将其客户交易记录作为表格中的记录。该表格中的每条记录都包含有关交易的信息，包括一个唯一标识客户的ID，以及有关交易的详细信息，包括交易日期和时间、供应商ID、交易地点以及交易的货币和金额。除了这些信息，每次报告交易时都会添加到表格中，每条记录都有一个字段来指示交易是否被报告为欺诈。
- en: The credit card company plans to train a deep learning model on the historical
    data in this table and use this trained model to predict whether new incoming
    transactions are fraudulent. The goal is to identify potential fraud as quickly
    as possible (and take corrective action) rather than waiting days for the customer
    or vendor to report that a particular transaction is fraudulent.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 信用卡公司计划使用该表格中的历史数据训练一个深度学习模型，并使用这个训练好的模型来预测新到达的交易是否为欺诈。目标是尽快识别潜在的欺诈（并采取纠正措施），而不是等待几天让客户或供应商报告特定交易为欺诈。
- en: Let’s examine the customer transaction table. Figure 1.1 contains a snippet
    of what some records in this table would look like.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们检查客户交易表。图1.1包含了这个表格中一些记录的片段。
- en: '![CH01_F01_Ryan](../Images/CH01_F01_Ryan.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![CH01_F01_Ryan](../Images/CH01_F01_Ryan.png)'
- en: Figure 1.1 Dataset for credit card fraud example
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.1 信用卡欺诈示例数据集
- en: 'The columns customer ID, transaction date, transaction time, vendor ID, City,
    Country, currency, and amount contain details about individual credit card transactions
    for the previous quarter. The fraud column is special because it contains the
    label: the value that we want the deep learning model to predict when it has been
    trained on the training data. Assume that the default value in the fraud column
    is `0` (meaning “not a fraud”), and that when one of our customers or vendors
    reports a fraudulent transaction, the value in the fraud column for that transaction
    in the table is set to `1`.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 列客户ID、交易日期、交易时间、供应商ID、城市、国家、货币和金额包含关于上一季度单个信用卡交易的详细信息。欺诈列是特殊的，因为它包含标签：当我们用训练数据训练深度学习模型时，我们希望模型预测的值。假设欺诈列的默认值为`0`（表示“非欺诈”），并且当我们的客户或供应商报告欺诈交易时，该交易在表格中的欺诈列的值被设置为`1`。
- en: As new transactions arrive, we want to be able to predict whether they are fraudulent
    so that we can quickly take corrective action. By training the deep learning model
    on the historical dataset, we will be defining a function that can predict whether
    new credit card transactions are fraudulent. In this example of supervised learning
    ([http://mng.bz/pzBE](http://mng.bz/pzBE)), the model is trained by means of a
    dataset that incorporates examples with labels. The dataset that is used to train
    the model includes the value that the trained model will predict (in this case,
    whether a transaction is fraudulent). By contrast, in unsupervised learning the
    training dataset does not include labels.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 当新的交易到来时，我们希望能够预测它们是否是欺诈性的，这样我们就可以迅速采取纠正措施。通过在历史数据集上训练深度学习模型，我们将定义一个可以预测新的信用卡交易是否欺诈的函数。在这个监督学习（[http://mng.bz/pzBE](http://mng.bz/pzBE)）的例子中，模型是通过包含带有标签的示例的数据集来训练的。用于训练模型的数据库包括训练模型将预测的值（在这种情况下，是否为欺诈交易）。相比之下，在无监督学习中，训练数据集不包含标签。
- en: 'Now that we have introduced the credit card fraud example, let’s use it to
    take a brief tour of some of the concepts of deep learning. For a more in-depth
    description of these concepts, see François Chollet’s *Deep Learning with Python,
    2nd ed. (*[http://mng.bz/OvM2](http://mng.bz/OvM2)*),* which includes excellent
    descriptions of these concepts:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经介绍了信用卡欺诈的例子，让我们用它来简要地浏览一下深度学习的一些概念。对于这些概念的更深入描述，请参阅弗朗索瓦·肖莱特的《Python深度学习，第2版》（*[http://mng.bz/OvM2](http://mng.bz/OvM2)*），其中对这些概念有出色的描述：
- en: '*Deep learning* is a machine learning approach in which multilayer artificial
    neural networks are trained by setting weights and offsets at each layer by optimizing
    a *loss function* (the delta between the actual outcome [the values in the fraud
    column] and the predicted outcome) through the use of gradient-based optimization
    and backpropagation.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*深度学习*是一种机器学习方法，通过在每个层设置权重和偏置来训练多层人工神经网络，通过使用基于梯度的优化和反向传播来优化*损失函数*（实际结果[欺诈列中的值]与预测结果之间的差异）。'
- en: Neural networks in a deep learning model have a series of layers, starting with
    the input layer, followed by several hidden layers, and culminating with an output
    layer.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习模型中的神经网络有一系列层，从输入层开始，接着是几个隐藏层，最后是输出层。
- en: In each of these layers, the output of the previous layer (or, in the case of
    the first layer, the training data, which for our example is the dataset columns
    from customer ID, date, time, vendor ID, City, Country, currency and amount) goes
    through a series of operations (multiplication by a matrix of weights, addition
    of an offset [bias], and application of a nonlinear activation function) to produce
    the input for the next layer. In figure 1.2, each circle (node) has its own set
    of weights. The inputs are multiplied by those weights, the bias is added, and
    an activation function is applied to the result to produce the output that is
    taken in by the next layer.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在这些每一层中，前一层（或者，在第一层的情况下，训练数据，对于我们的例子来说，是来自客户ID、日期、时间、供应商ID、城市、国家、货币和金额的数据集列）的输出会经过一系列操作（通过权重矩阵相乘、添加偏置[偏差]以及应用非线性激活函数）以产生下一层的输入。在图1.2中，每个圆圈（节点）都有自己的权重集。输入会被这些权重相乘，加上偏置，然后对结果应用激活函数以产生下一层接收的输出。
- en: '![CH01_F02_Ryan](../Images/CH01_F02_Ryan.png)'
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![CH01_F02_Ryan](../Images/CH01_F02_Ryan.png)'
- en: Figure 1.2 Multilayered neural network
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图1.2 多层神经网络
- en: The final output layer generates the prediction of the model based on the input.
    In our example of predicting credit card fraud, the output indicates whether the
    model predicts a fraud (output of `1`) or not a fraud (output of `0`) for a given
    transaction.
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 模型的最终输出层根据输入生成预测。在我们的预测信用卡欺诈的例子中，输出指示模型是否预测了欺诈（输出为`1`）或不是欺诈（输出为`0`）对于特定的交易。
- en: Deep learning works by iteratively updating the weights in the network to minimize
    the loss function (the function that defines the aggregate difference between
    the predictions of the model and the actual result values in the training dataset).
    As the weights are adjusted, the model’s predictions in aggregate get closer to
    the actual result values in the fraud column of the input table. With each training
    iteration, the weights are adjusted based on the gradient of the loss function.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习通过迭代更新网络中的权重来最小化损失函数（该函数定义了模型预测与训练数据集中实际结果值之间的总差异）。随着权重的调整，模型在总体上的预测将更接近输入表欺诈列中的实际结果值。每次训练迭代时，根据损失函数的梯度调整权重。
- en: You can think of the gradient of the loss function as being roughly equivalent
    to the slope of a hill. If you make small, incremental steps in the direction
    opposite the slope of the hill, you will eventually get to the bottom of the hill.
    By making small changes to the weights in the direction opposite to the gradient
    for each iteration through the network, you reduce the loss function bit by bit.
    A process called *backpropagation* is used to get the gradient of the loss function,
    which can then be applied to update the weights for each node in the neural network
    in such a way that with repeated applications, the loss function is minimized
    and the accuracy of the model’s predictions is maximized. The training process
    is summarized in figure 1.3.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以将损失函数的梯度视为大致等同于山丘的斜率。如果你朝着与山丘斜率相反的方向迈出小而渐进的步伐，你最终会到达山丘的底部。通过在网络的每次迭代中对权重进行与梯度相反方向的小幅调整，你可以逐步减少损失函数。一个称为*反向传播*的过程用于获取损失函数的梯度，然后可以将它应用于更新神经网络中每个节点的权重，这样通过重复应用，损失函数被最小化，模型的预测准确性被最大化。训练过程总结在图1.3中。
- en: '![CH01_F03_Ryan](../Images/CH01_F03_Ryan.png)'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![CH01_F03_Ryan](../Images/CH01_F03_Ryan.png)'
- en: Figure 1.3 Training data is used when weights are iteratively updated in the
    network to train the model.
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图1.3 当在网络上迭代更新权重以训练模型时，使用训练数据。
- en: When the training is complete (the weights in the model have been repeatedly
    updated using the gradient provided by backpropagation to achieve the desired
    performance with the training data), the resulting model can be used to make predictions
    on new data that the model has never seen.
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当训练完成（模型中的权重已经通过反向传播提供的梯度反复更新，以达到使用训练数据所期望的性能）时，得到的模型可以用于对新数据进行预测，这些数据模型之前从未见过。
- en: The output of the process is a trained deep learning model that incorporates
    the final weights and can be used to predict outputs from new input data, as shown
    in figure 1.4.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程的输出是一个经过训练的深度学习模型，它包含了最终的权重，并可用于从新的输入数据中预测输出，如图1.4所示。
- en: '![CH01_F04_Ryan](../Images/CH01_F04_Ryan.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![CH01_F04_Ryan](../Images/CH01_F04_Ryan.png)'
- en: Figure 1.4 A trained model generates predictions on new data.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.4 训练好的模型对新数据进行预测。
- en: This book does not cover the mathematical basis of deep learning. The section
    on the mathematical building blocks of deep learning in *Deep Learning with Python*
    , 2nd ed., provides a clear, concise description of the math behind deep learning.
    You can also see the reference to the deeplearning.ai curriculum in chapter 9
    for a good overview of the math behind deep learning.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 本书不涵盖深度学习的数学基础。在《Python深度学习》第2版中关于深度学习数学构建块的章节提供了对深度学习背后数学的清晰、简洁描述。你还可以在第九章中找到对深度学习背后数学的概述，该章节提到了deeplearning.ai课程。
- en: 1.2 Benefits and drawbacks of deep learning
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.2 深度学习的利弊
- en: 'The core point of deep learning is both simple and profound: a trained deep
    learning model can incorporate a function of incredible complexity that accurately
    characterizes patterns implicit in the data on which the model is trained. Given
    enough labeled data to train on (such as a large-enough dataset of credit card
    transactions with a column to indicate whether each transaction is a fraud), deep
    learning can define a model that predicts the label values for new data that the
    model never saw during the training process. The functions that deep learning
    defines in the form of trained models can include millions of parameters, well
    beyond what any human could create by hand.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 深度学习的核心观点既简单又深刻：一个训练好的深度学习模型可以包含一个极其复杂的函数，该函数可以准确描述模型训练数据中隐含的模式。给定足够的标记数据来训练（例如，足够大的信用卡交易数据集，其中有一列指示每笔交易是否为欺诈），深度学习可以定义一个模型，该模型可以预测模型在训练过程中从未见过的新的数据标签值。深度学习以训练模型的形式定义的函数可以包括数百万个参数，远远超出任何人类可以手动创建的数量。
- en: In some use cases, such as image recognition, deep learning models have the
    benefit of being trainable on data that is closer to the raw input data than is
    possible with non-deep-learning machine learning approaches. Those approaches
    may require extensive *feature engineering* (hand-coded transformations of the
    input data and new columns in the input table) to achieve good performance.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些用例中，例如图像识别，深度学习模型有在比非深度学习机器学习方法更接近原始输入数据的数据上进行训练的优势。那些方法可能需要广泛的 *特征工程*（输入数据的编码转换和输入表中的新列）以达到良好的性能。
- en: The benefits of deep learning don’t come free. Deep learning has several significant
    drawbacks that you need to be prepared to deal with. For deep learning to work,
    you need
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 深度学习的益处并非免费。深度学习有几个显著的缺点，你需要准备好应对。为了使深度学习有效，你需要
- en: '*Lots of labeled data* —You may need millions of examples, depending on the
    domain.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*大量的标记数据* — 根据领域不同，你可能需要数百万个示例。'
- en: '*Hardware capable of doing massive matrix manipulations* —As you will see in
    chap-ter 2, a modern laptop may be sufficient to train a simple deep learning
    model. Bigger models will require specialized hardware (GPUs and TPUs) to train
    efficiently.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*能够进行大量矩阵操作的硬件* — 正如你在第二章中将会看到的，现代笔记本电脑可能足以训练一个简单的深度学习模型。更大的模型将需要专门的硬件（GPU和TPU）来高效训练。'
- en: '*Tolerance for the model’s imperfect transparency* —When you compare deep learning
    with classic, non-deep-learning machine learning, it can be more difficult to
    spell out why a deep learning model is making the predictions it is making. In
    particular, if a model is trained on a certain set of features (customer ID, transaction
    date, transaction time, and so on), it can be difficult to determine which features
    contribute most to the model’s capability to predict an outcome.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*对模型不完美透明度的容忍度* — 当你将深度学习与经典的非深度学习机器学习进行比较时，可能更难解释为什么深度学习模型会做出这样的预测。特别是，如果一个模型是在某个特征集（客户ID、交易日期、交易时间等）上训练的，那么确定哪些特征对模型预测结果的能力贡献最大可能很困难。'
- en: '*Significant engineering to avert common pitfalls* —These pitfalls include
    overfitting (the model is accurate for the data it was trained on, but doesn’t
    generalize to new data) and vanishing/exploding gradients (backpropagation blows
    up or grinds to a halt because the modifications to the weights become too large
    or too small at each step).'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*避免常见陷阱的重大工程* — 这些陷阱包括过拟合（模型对其训练数据准确，但不能推广到新数据）和梯度消失/爆炸（反向传播因为权重的修改在每个步骤变得过大或过小而爆炸或停止）。'
- en: '*Ability to manipulate multiple hyperparameters* —Data scientists need to control
    a set of knobs called *hyperparameters* , including learning rate (the size of
    the steps taken each time the weights are updated), regularization (various tactics
    to avert overfitting), and the number of times the training process iterates through
    the input dataset to train the model. Adjusting these knobs to get a good result
    can be like trying to fly a helicopter. As a helicopter pilot needs to coordinate
    hands and feet in harmony to keep the machine on a steady path and avoid crashing,
    a data scientist training a deep learning model needs to coordinate the hyperparameters
    in harmony to get desired results out of the model and avoid pitfalls such as
    overfitting. See chapter 5 for details about the hyperparameters used to train
    the model for this book’s extended example.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*操纵多个超参数的能力* — 数据科学家需要控制一组被称为*超参数*的旋钮，包括学习率（每次更新权重时采取的步长大小）、正则化（避免过拟合的各种策略）以及训练过程迭代输入数据集的次数以训练模型。调整这些旋钮以获得良好的结果就像尝试驾驶直升机。作为一名直升机飞行员需要协调双手和双脚以保持机器稳定路径并避免坠毁，训练深度学习模型的数据科学家需要协调超参数以从模型中获得期望的结果并避免过拟合等陷阱。有关本书扩展示例中使用的超参数的详细信息，请参阅第5章。'
- en: '*Tolerance* *for less-than-perfect accuracy* —Deep learning is, by its nature,
    not going to produce 100% accurate predictions. If absolute accuracy is required,
    it’s better to use a more deterministic approach.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*对不完美准确度的容忍度* — 深度学习本质上不可能产生100%准确的预测。如果需要绝对准确度，最好使用更确定性的方法。'
- en: 'Here are some mitigations for these drawbacks:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一些缓解这些缺点的措施：
- en: '*Lots of labeled data* —Deep learning’s thirst for massive amounts of labeled
    data can be tempered with *transfer learning* : reusing models or subsets of models
    that are trained to perform one task on a related task. A model trained on a large,
    general set of labeled image data can be used to jump-start a model that is being
    applied to a specific domain in which labeled image data is scarce. The extended
    example in this book does not apply transfer learning, but you can see *Transfer
    Learning for Natural Language Processing* by Paul Azunre ([http:// mng.bz/GdVV](http://mng.bz/GdVV))
    for details on the key role that transfer learning plays in deep learning use
    cases such as natural language processing and computer vision.'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*大量标记数据* — 深度学习对大量标记数据的渴望可以通过*迁移学习*来缓解：重用训练用于在相关任务上执行一个任务的模型或模型子集。在大型、通用的标记图像数据集上训练的模型可以用来启动应用于特定领域（在该领域中标记图像数据稀缺）的模型。本书的扩展示例不使用迁移学习，但您可以查看Paul
    Azunre的《自然语言处理中的迁移学习》（[http:// mng.bz/GdVV](http://mng.bz/GdVV)），了解迁移学习在深度学习用例（如自然语言处理和计算机视觉）中的关键作用。'
- en: '*Hardware capable of doing massive matrix manipulations* — Today, it’s easy
    to get access to environments (including the cloud environments introduced in
    chapter 2) with sufficient hardware power to train challenging models at modest
    cost. The extended deep learning example in this book can be exercised faster
    in a cloud environment with hardware specifically designed for deep learning,
    but you can also exercise it on a reasonably provisioned modern laptop.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*能够进行大规模矩阵操作的硬件* — 现在，很容易获得具有足够硬件能力的环境（包括第2章中介绍的云环境），以较低的成本训练具有挑战性的模型。本书中扩展的深度学习示例在专门为深度学习设计的硬件的云环境中可以更快地运行，但你也可以在配置合理的现代笔记本电脑上运行它。'
- en: '*Tolerance for the model’s imperfect transparency* — Several vendors (including
    Amazon, Google, and IBM) now offer solutions to help make deep learning models
    more transparent and explain the behavior of deep learning models.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*对模型不透明性的容忍度* — 一些供应商（包括亚马逊、谷歌和IBM）现在提供解决方案，帮助使深度学习模型更加透明，并解释深度学习模型的行为。'
- en: '*Significant engineering to avert common pitfalls* — Algorithm improvements
    keep making their way into common deep learning frameworks to help insulate you
    from problems like exploding gradients.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*避免常见陷阱的重大工程* — 算法改进不断进入常见的深度学习框架，以帮助您避免梯度爆炸等问题。'
- en: '*Ability to manipulate multiple hyperparameters* — Automated approaches to
    optimizing hyperparameters have the potential to reduce the complexity of tuning
    hyperparameters and make the experience of training a deep learning model less
    like flying a helicopter and more like driving a car, in that a limited set of
    inputs (steering wheel, accelerator) has direct results (car changes direction,
    car changes speed).'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*调整多个超参数的能力* — 自动化超参数优化方法有可能减少调整超参数的复杂性，并使训练深度学习模型的体验更像开车而不是驾驶直升机，因为有限的一组输入（方向盘、油门）会产生直接的结果（汽车改变方向，汽车改变速度）。'
- en: Less-than-perfect accuracy remains a challenge. The impact of imperfect accuracy
    depends on the problem that you are trying to solve. If you are predicting whether
    a client is going to churn (take its business to a competitor), being right 85%
    or 90% of the time may be more than sufficient for the problem. If you are predicting
    a potentially fatal medical condition, however, the intrinsic limits of deep learning
    are harder to get around. How much inaccuracy you can tolerate will depend on
    the problem you are solving.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 准确度不足仍然是一个挑战。不完美准确度的影响取决于您试图解决的问题。如果您正在预测客户是否会流失（将其业务带到竞争对手那里），85% 或 90% 的时间正确可能已经足够解决该问题。然而，如果您正在预测可能致命的医疗状况，那么深度学习的内在限制就更加难以克服。您可以容忍多少不准确将取决于您正在解决的问题。
- en: 1.3 Overview of the deep learning stack
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.3 深度学习堆栈概述
- en: A variety of deep learning frameworks is available today. The two most popular
    are TensorFlow ([https://www.tensorflow.org](https://www.tensorflow.org)), which
    dominates in industrial applications of deep learning, and PyTorch ([https://pytorch.org](https://pytorch.org)),
    which has a strong following in the research community.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，有各种各样的深度学习框架可供选择。其中最受欢迎的两个是 TensorFlow ([https://www.tensorflow.org](https://www.tensorflow.org))，它在深度学习的工业应用中占据主导地位，以及
    PyTorch ([https://pytorch.org](https://pytorch.org))，它在研究社区中拥有众多支持者。
- en: In this book, we’re going to use Keras ([https://keras.io](https://keras.io))
    as our deep learning library. Keras began life as a freestanding project that
    could be used as a frontend for a variety of deep learning frameworks. As explained
    in chapter 5, as of TensorFlow 2.0, Keras is integrated into TensorFlow. Keras
    is the recommended high-level API for TensorFlow. The code accompanying this book
    has been validated with TensorFlow 2.0, but you should not have any issues using
    later versions of TensorFlow.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，我们将使用 Keras ([https://keras.io](https://keras.io)) 作为我们的深度学习库。Keras 最初是一个独立的项目，可以用作各种深度学习框架的前端。正如第
    5 章所述，截至 TensorFlow 2.0，Keras 已集成到 TensorFlow 中。Keras 是 TensorFlow 推荐的高级 API。本书附带的代码已在
    TensorFlow 2.0 上进行了验证，但您应该可以使用 TensorFlow 的后续版本，而不会遇到任何问题。
- en: 'Here is a brief introduction to the main components of the stack:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是对堆栈主要组件的简要介绍：
- en: '*Python* —This easy-to-learn, flexible interpreted language is by far the most
    popular language for machine learning. Python’s growth in popularity has closely
    tracked the machine learning renaissance in the past decade, and it now far outstrips
    its closest rival, R, as the lingua franca of machine learning. Python has a huge
    ecosystem and a massive set of libraries that cover not only everything you want
    to do with machine learning, but also the gamut of development. In addition, Python
    has a huge developer community, and you can easily find answers online to almost
    any Python question or problem. The code examples in this book are written entirely
    in Python, with the exception of the YAML config files described in chapter 3;
    an SQL example in chapter 2; and the deployments described in chapter 8, which
    include code in Markdown, HTML, and JavaScript.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Python* — 这种易于学习、灵活的解释性语言是目前机器学习最受欢迎的语言。Python 的普及增长与过去十年中机器学习的复兴紧密相关，现在它远远超过了其最接近的竞争对手
    R，成为机器学习的通用语言。Python 拥有一个庞大的生态系统和一套庞大的库，不仅涵盖了您想用机器学习做的所有事情，还包括了开发的全套工具。此外，Python
    拥有一个庞大的开发者社区，您几乎可以在线找到几乎任何 Python 问题或问题的答案。本书中的代码示例完全用 Python 编写，除了第 3 章中描述的 YAML
    配置文件；第 2 章中的 SQL 示例；以及第 8 章中描述的部署，这些部署包括 Markdown、HTML 和 JavaScript 中的代码。'
- en: '*Pandas* —This Python library gives you everything you need to conveniently
    deal with tabular, structured data within Python. You can easily import structured
    data (whether from CSV or Excel files or directly from a table in a relational
    database) into a Pandas dataframe and then manipulate it with table operations
    (such as dropping and adding columns, filtering by column values, and joining
    tables). You can think of Pandas as being Python’s answer to SQL. Chapter 2 contains
    several examples of loading data into Pandas dataframes and using Pandas to perform
    common SQL-type operations.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Pandas* —这个Python库为你提供了在Python中方便地处理表格结构化数据的所有工具。你可以轻松地将结构化数据（无论是从CSV或Excel文件中还是直接从关系数据库中的表中）导入到Pandas数据框中，然后通过表操作（如删除和添加列、按列值过滤和连接表）来操作它。你可以将Pandas视为Python对SQL的回应。第二章包含了一些将数据加载到Pandas数据框中并使用Pandas执行常见SQL类型操作的示例。'
- en: '*scikit-learn* —scikit-learn is an extensive Python library for machine learning.
    The extended example in this book makes extensive use of this library, including
    the data transformation utilities described in chapters 3 and 4 and the facility
    described in chapter 8, to define trainable data pipelines that prepare data both
    for training the deep learning model and for getting predictions from the trained
    model.'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*scikit-learn* —scikit-learn是一个广泛的Python机器学习库。本书中的扩展示例大量使用了这个库，包括第3章和第4章中描述的数据转换工具以及第8章中描述的功能，以定义可训练的数据管道，这些管道既为训练深度学习模型做准备，也为从训练好的模型中获得预测做准备。'
- en: '*Keras* —Keras is a straightforward library for deep learning that gives you
    ample flexibility and control while abstracting out some of the complexity of
    the low-level TensorFlow API. Keras has a large, active community that includes
    beginners and experienced machine learning practitioners, and it’s easy to find
    solid examples of using Keras for deep learning applications.'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Keras* —Keras是一个简单的深度学习库，它提供了足够的灵活性和控制，同时抽象出了一些底层TensorFlow API的复杂性。Keras有一个庞大而活跃的社区，包括初学者和经验丰富的机器学习从业者，并且很容易找到使用Keras进行深度学习应用的可靠示例。'
- en: 1.4 Structured vs. unstructured data
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.4 结构化数据与非结构化数据
- en: 'The title of this book contains two terms that do not commonly appear together:
    *deep learning* and *structured data*. Structured data (in the context of this
    book) refers to data that is organized in tables with rows and columns—the kind
    of data that resides in relational databases. Deep learning is an advanced machine
    learning technique that has demonstrated success on a range of problems with data
    that is not commonly stored in tables, such as images, video, audio, and text.'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书的标题包含两个不常一起出现的术语：*深度学习*和*结构化数据*。结构化数据（在本书的上下文中）是指以行和列的形式组织的数据，这种数据存储在关系数据库中。深度学习是一种高级机器学习技术，它在处理不常存储在表中的数据（如图像、视频、音频和文本）的一系列问题上已经证明了其成功。
- en: Why apply deep learning to structured data? Why combine a data paradigm that
    is 40 years old with cutting-edge deep learning? Aren’t there simpler approaches
    to solving problems that involve structured data? Aren’t there better applications
    of the power of deep learning than attempting to train models with data that resides
    in tables?
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么要将深度学习应用于结构化数据？为什么将一个40年之久的数据库范式与前沿的深度学习相结合？对于涉及结构化数据的问题，难道没有更简单的方法来解决吗？难道没有比尝试用存储在表中的数据训练模型更好的深度学习应用吗？
- en: To answer these valid questions, we’re first going to define in a bit more detail
    what we mean by structured and unstructured data; in section 1.5, we’ll address
    these and other objections to applying deep learning to structured tabular data.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 为了回答这些有效的问题，我们首先将更详细地定义我们所说的结构化和非结构化数据；在1.5节中，我们将解决这些以及其他关于将深度学习应用于结构化表格数据的反对意见。
- en: In this book, *structured data* is data that has been organized to reside in
    a relational database with rows and columns. The columns can contain numeric values
    (such as currency amounts, temperatures, time durations, or other quantities expressed
    as integer or floating-point values) or non-numeric values (such as strings, embedded
    structured objects, or unstructured objects).
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，*结构化数据*是指已经被组织起来以存储在具有行和列的关系数据库中的数据。列可以包含数值（例如货币金额、温度、时间长度或其他以整数或浮点值表示的数量）或非数值（例如字符串、嵌入的结构化对象或非结构化对象）。
- en: 'All relational databases support SQL (albeit with varying dialects) as the
    primary interface to the database. Common relational databases include the following:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 所有关系型数据库都支持SQL（尽管有不同的方言）作为数据库的主要接口。常见的关系型数据库包括以下几种：
- en: '*Proprietary databases* —Oracle, SQL Server, Db2, Teradata'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*专有数据库* —Oracle、SQL Server、Db2、Teradata'
- en: '*Open source databases* —Postgres, MySQL, MariaDB'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*开源数据库* —Postgres、MySQL、MariaDB'
- en: '*Propriety database offerings based on open source* —AWS Redshift (based on
    Postgres)'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*基于开源的专有数据库* —AWS Redshift（基于Postgres）'
- en: Relational databases can include relationships between tables, such as foreign
    keys (in which the permissible values in the column of one table depend on the
    values in an identified column in another table). Tables can be joined to create
    new tables that contain combinations of the rows and columns from the tables participating
    in the join. Relational databases can also incorporate sets of code, such as sets
    of SQL statements called stored procedures, that can be invoked to access and
    manipulate data in the database. For the purposes of this book, we will be focusing
    on the row and typed column nature of tables rather than the additional intertable
    interactions and code interfaces provided by relational databases.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 关系型数据库可以包含表之间的关系，例如外键（其中一个表列的可允许值取决于另一个表中标识列的值）。可以通过连接表来创建新的表，这些新表包含参与连接的表的行和列的组合。关系型数据库还可以包含代码集，例如存储过程，这些存储过程可以调用以访问和操作数据库中的数据。为了这本书的目的，我们将重点关注表的行和类型化列的性质，而不是关系型数据库提供的额外表间交互和代码接口。
- en: Relational databases are not the only possible repositories of structured tabular
    data. As shown in figure 1.5, data in Excel or CSV files is intrinsically structured
    in rows and columns, although unlike in relational tables, the types of the columns
    are not encoded as part of the structure but inferred from the column contents.
    The dataset for the main example in this book comes from a set of Excel files.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 关系型数据库并不是结构化表格数据的唯一可能存储库。如图1.5所示，Excel或CSV文件中的数据在本质上是以行和列结构化的，尽管与关系表不同，列的类型不是作为结构的一部分编码，而是从列内容中推断出来的。本书主要示例的数据集来自一组Excel文件。
- en: '![CH01_F05_Ryan](../Images/CH01_F05_Ryan.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![CH01_F05_Ryan](../Images/CH01_F05_Ryan.png)'
- en: Figure 1.5 Examples of tabular structured data
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.5 表格结构化数据的示例
- en: For the purposes of this book, we will not be looking at unstructured data—data
    that is not organized to reside in tabular form in a relational database. As shown
    in figure 1.6, unstructured data includes image, video, and audio files, as well
    as text and tagged formats such as XML, HTML, and JSON. By this definition, unstructured
    data doesn’t necessarily have zero structure. The key/value pairs in JSON are
    a kind of structure, for example, but in its native state JSON is not organized
    in a tabular form with rows and columns, so for the purposes of this book, it
    is unstructured. To complicate matters further, structured data can contain unstructured
    elements, such as columns in a table that contain freeform text or that refer
    to XML documents or BLOBs (binary large objects).
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 为了这本书的目的，我们不会探讨非结构化数据——那些没有组织成关系数据库中表格形式的数据。如图1.6所示，非结构化数据包括图像、视频和音频文件，以及文本和标记格式，如XML、HTML和JSON。根据这个定义，非结构化数据并不一定完全没有结构。例如，JSON中的键值对就是一种结构，但JSON在其原生状态下并不是以行和列的表格形式组织，因此，为了这本书的目的，它被视为非结构化数据。更复杂的是，结构化数据可以包含非结构化元素，例如表格中的自由文本列或引用XML文档或BLOBs（二进制大对象）的列。
- en: '![CH01_F06_Ryan](../Images/CH01_F06_Ryan.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![CH01_F06_Ryan](../Images/CH01_F06_Ryan.png)'
- en: Figure 1.6 Examples of unstructured data
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.6 非结构化数据的示例
- en: Many books cover applications of deep learning to unstructured data such as
    images and text. This book takes a different direction by focusing exclusively
    on deep learning applied to tabular structured data. Sections 1.5 and 1.6 provide
    some justification for this focus on structured data, first discussing some reasons
    why you might be skeptical about a focus on structured data, and then reviewing
    the benefits of exploring a structured data problem with deep learning.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 许多书籍涵盖了深度学习在非结构化数据（如图像和文本）中的应用。本书则采取不同的方向，专注于深度学习在表格结构化数据上的应用。第1.5节和第1.6节提供了一些对结构化数据关注的理由，首先讨论了一些你可能会对结构化数据关注持怀疑态度的原因，然后回顾了使用深度学习探索结构化数据问题的好处。
- en: 1.5 Objections to deep learning with structured data
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.5 使用结构化数据进行深度学习的反对意见
- en: Many of the celebrated applications of deep learning have involved unstructured
    data such as images, audio, and text. Some deep learning experts question whether
    deep learning should be applied to structured data at all and insist that a non-deep-learning
    approach is best for structured data.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 许多备受赞誉的深度学习应用都涉及非结构化数据，如图像、音频和文本。一些深度学习专家质疑是否应该将深度学习应用于结构化数据，并坚持认为非深度学习的方法最适合结构化数据。
- en: 'To motivate your exploration of deep learning with structured data, let’s review
    some of the objections:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 为了激励你探索结构化数据中的深度学习，让我们回顾一些反对意见：
- en: '*Structured datasets are too small to feed deep learning.* Whether this objection
    is valid depends on the domain. Certainly, there are many domains (including the
    problem explored in this book) in which the labeled structured dataset contains
    tens of thousands or even millions of examples, making them large enough to be
    in contention for training a deep learning model.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*结构化数据集太小，无法用于深度学习。* 这个反对意见是否有效取决于领域。当然，有许多领域（包括本书中探讨的问题）中的标记结构化数据集包含数万个甚至数百万个示例，使它们足够大，可以用于训练深度学习模型。'
- en: '*Keep it simple.* Deep learning is hard and complicated, so why not use an
    easier solution, such as non-deep-learning machine learning or traditional business
    intelligence applications? This objection was more valid three years ago than
    it is today. Deep learning has reached a tipping point in terms of simplicity
    and widespread use. Thanks to the popularity of deep learning, the tools available
    to exploit it are much easier to use. As you will see in the extended coding examples
    in this book, deep learning is now accessible to nonspecialists.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*保持简单。* 深度学习既困难又复杂，为什么不使用更简单的解决方案，比如非深度学习机器学习或传统的商业智能应用？这个反对意见三年前比现在更有道理。在简单性和广泛应用方面，深度学习已经达到了一个转折点。多亏了深度学习的普及，利用它的工具现在使用起来要容易得多。正如你将在本书的扩展编码示例中看到的那样，深度学习现在对非专业人士来说也是可访问的。'
- en: '*Handcrafted deep learning solutions are becoming less necessary.* Why go through
    the effort of creating an end-to-end deep learning solution, particularly if you
    are not a full-time data scientist, if handcrafted solutions will increasingly
    be replaced by solutions that require little or no coding? The fast.ai library
    ([https://docs.fast.ai](https://docs.fast.ai)), for example, allows you to create
    powerful deep learning models with a few lines of code, and data science environments
    like Watson Studio offer GUI-based model builders (as shown in figure 1.7) that
    let you create a deep learning model without doing any coding at all.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*手工制作的深度学习解决方案变得越来越不必要了。* 为什么要费劲去创建一个端到端的深度学习解决方案，尤其是如果你不是全职数据科学家，如果手工解决方案将越来越多地被需要少量或不需要编码的解决方案所取代？例如，fast.ai库([https://docs.fast.ai](https://docs.fast.ai))允许你用几行代码创建强大的深度学习模型，像Watson
    Studio这样的数据科学环境提供基于GUI的模型构建器（如图1.7所示），让你无需编写任何代码就能创建深度学习模型。'
- en: With these solutions, why make the effort to learn how to code a deep learning
    model directly? To understand how to use low-code or no-code solutions, you still
    need to understand how a deep learning model is put together, and the fastest
    way to learn that is to write the code to harness deep learning frameworks. If
    you deal primarily with tabular data in your job, it makes sense to be able to
    apply deep learning to that data. By coding a deep learning solution to a problem
    that involves structured tabular data that you understand thoroughly, you gain
    understanding of the concepts, strengths, and limitations of deep learning. Armed
    with that understanding, you will be able to exploit deep learning (whether hand-coded
    or not) to solve further problems. The extended example in this book takes you
    through an end-to-end example of applying deep learning to structured tabular
    data. In chapter 9, you will learn how to adapt the example in this book to your
    own structured data datasets.
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用这些解决方案，为什么还要努力学习如何直接编写深度学习模型的代码？为了理解如何使用低代码或无代码解决方案，你仍然需要了解深度学习模型是如何构建的，而最快的学习方式就是编写代码来利用深度学习框架。如果你主要处理工作中的表格数据，那么能够将深度学习应用于这些数据是有意义的。通过为涉及你彻底理解的有序表格数据的特定问题编写深度学习解决方案，你将了解深度学习的概念、优势和局限性。有了这种理解，你将能够利用深度学习（无论是否手工编码）来解决更多的问题。本书中的扩展示例将带你通过将深度学习应用于结构化表格数据的端到端示例。在第9章，你将学习如何将本书中的示例适应你自己的结构化数据集。
- en: '![CH01_F07_Ryan](../Images/CH01_F07_Ryan.png)'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![CH01_F07_Ryan](../Images/CH01_F07_Ryan.png)'
- en: Figure 1.7 Creating a deep learning model by using a GUI (Watson Studio)
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图1.7 使用GUI（Watson Studio）创建深度学习模型
- en: 'In this section, we looked at common objections to using deep learning to solve
    problems involving structured data and reviewed subjective responses. A subjective
    response is not sufficient, however; we also need to compare working code implementations
    of deep learning versus non-deep learning. In chapter 7, we make a head-to-head
    comparison of two solutions to the extended example in this book: the deep learning
    solution and a solution based on a non-deep-learning approach called XGBoost.
    We compare these two approaches in terms of performance, model training time,
    code complexity, and flexibility.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们探讨了使用深度学习解决涉及结构化数据的问题的常见反对意见，并回顾了主观回应。然而，主观回应是不够的；我们还需要比较深度学习与非深度学习的代码实现。在第7章中，我们对本书中的扩展示例的两个解决方案进行了面对面比较：深度学习解决方案和基于非深度学习方法XGBoost的解决方案。我们比较了这两种方法在性能、模型训练时间、代码复杂性和灵活性方面的差异。
- en: 1.6 Why investigate deep learning with a structured data problem?
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.6 为什么要用结构化数据问题来研究深度学习？
- en: In section 1.5, we reviewed some of the objections to applying deep learning
    to structured data. Let’s assume that you are satisfied with how these objections
    were handled. There’s still the question of what benefit you will get by taking
    the time to go through an extended example of applying deep learning to structured
    data. Many books can take you through the process of applying deep learning to
    a wide variety of problems and datasets. What distinguishes this book? What is
    the benefit of going through an end-to-end problem using a structured dataset
    with deep learning?
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在1.5节中，我们回顾了将深度学习应用于结构化数据的一些反对意见。假设你对这些反对意见的处理方式感到满意。然而，还有一个问题，那就是通过花时间通过一个扩展示例来应用深度学习于结构化数据，你将获得什么好处。许多书籍可以带你通过将深度学习应用于各种问题和数据集的过程。这本书有什么独特之处？使用结构化数据集通过深度学习完成端到端问题的好处是什么？
- en: 'Let’s start with the big picture: there is a lot more unstructured data in
    the world than structured data ([https://learn.g2.com/structured-vs-unstructured-data](https://learn.g2.com/structured-vs-unstructured-data)).
    If 80% of data is unstructured, why bother trying to apply deep learning to the
    small subset of all data that is structured? Although there may be four times
    as much unstructured data as structured data, the slice of the pie that is structured
    is extremely important. Banks, retailers, insurance companies, manufacturers,
    governments—the building blocks of modern life—run on relational databases. Every
    day as you go about your daily activities, you generate updates in dozens or even
    hundreds of tables in various relational databases. When you pay for something
    with your debit card, make a mobile phone call, or check your bank balance online,
    you are accessing or updating data in a relational database. On top of the importance
    of structured data to our daily lives, many jobs revolve around structured tabular
    data. Using deep learning on images and video is fun, but what if your job doesn’t
    deal with this kind of data? What if your job is all about tables in relational
    databases or CSV and Excel files? If you master the techniques of applying deep
    learning to structured data, you will be able to apply these techniques to solve
    real problems with the kinds of datasets that you encounter in your job.'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从大局开始：世界上非结构化数据比结构化数据多得多（[https://learn.g2.com/structured-vs-unstructured-data](https://learn.g2.com/structured-vs-unstructured-data)）。如果80%的数据是非结构化的，为什么还要费心尝试将深度学习应用于所有数据中结构化数据的小部分呢？尽管非结构化数据可能是结构化数据的四倍，但结构化数据在数据饼图中的份额极其重要。银行、零售商、保险公司、制造商、政府——现代生活的基石——都依赖于关系数据库。每天当你进行日常活动时，你会在各种关系数据库中的数十个甚至数百个表中生成更新。当你用借记卡支付东西、打手机或在线查看银行余额时，你正在访问或更新关系数据库中的数据。除了结构化数据对我们日常生活的重大意义外，许多工作都围绕着结构化表格数据展开。在图像和视频上使用深度学习很有趣，但如果你从事的工作不涉及这类数据怎么办？如果你的工作完全是关于关系数据库中的表格或CSV和Excel文件怎么办？如果你掌握了将深度学习应用于结构化数据的技术，你将能够将这些技术应用于解决你在工作中遇到的实际问题。
- en: In this book, you’ll learn from start to finish how to apply deep learning to
    a tabular structured dataset. You’ll learn how to prepare a real-world dataset
    (with all the typical warts and problems that these datasets have) for training
    a deep learning model, how to categorize the dataset by the column types in the
    table, and how to create a simple deep learning model that is automatically defined
    by this categorization of the data. You will learn how this model combines layers
    that are adapted to each category of data so that you can take advantage of different
    types of data in the source tables (text, categorical, and continuous) to train
    the model. You will also learn how to deploy the deep learning model and make
    it available for other people to use. The techniques that you will learn in this
    book are applicable to a wide variety of structured datasets and will allow you
    to unlock the potential of deep learning to solve problems with these datasets.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，您将从始至终学习如何将深度学习应用于表格结构化数据集。您将学习如何准备一个现实世界的数据集（这些数据集具有所有典型的瑕疵和问题），以便为训练深度学习模型做准备，如何根据表格中的列类型对数据集进行分类，以及如何创建一个由这种数据分类自动定义的简单深度学习模型。您将学习这个模型如何结合适应每个数据类别层的组合，以便您可以利用源表中的不同类型的数据（文本、分类和连续）来训练模型。您还将学习如何部署深度学习模型，使其可供其他人使用。本书中您将学习的技巧适用于各种结构化数据集，并允许您释放深度学习解决这些数据集问题的潜力。
- en: 1.7 An overview of the code accompanying this book
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.7 伴随本书的代码概述
- en: The heart of this book is an extended coding example that applies deep learning
    to solve a problem with a real-world structured dataset. Chapter 2 introduces
    the problem and describes all the code used in this example. In this section,
    we briefly summarize the most important programs used to solve the problem.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的核心是一个扩展的编码示例，它将深度学习应用于解决一个具有现实世界结构化数据集的问题。第二章介绍了这个问题，并描述了在此示例中使用的所有代码。在本节中，我们简要总结了用于解决此问题的最重要的程序。
- en: 'The code that accompanies this book is made up of a series of Jupyter Notebooks
    and Python programs that take you from the raw input dataset to a deployed, trained
    deep learning model. You can find all the code, along with associated data and
    configuration files, at [http://mng.bz/v95x](http://mng.bz/v95x). Following are
    some of the key files in the repo:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 伴随本书的代码由一系列Jupyter笔记本和Python程序组成，这些程序将您从原始输入数据集引导到部署并训练好的深度学习模型。您可以在[http://mng.bz/v95x](http://mng.bz/v95x)找到所有代码，以及相关的数据和配置文件。以下是一些存储库中的关键文件：
- en: '*chapter2.ipynb* —Code snippets associated with introductory code in chapter
    2.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*第二章.ipynb* —与第二章中介绍性代码相关的代码片段。'
- en: '*chapter5.ipynb* —Code snippets associated with using Pandas to do SQL-type
    operations, as described in chapter 2.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*第五章.ipynb* —与第2章中描述的如何使用Pandas进行SQL类型操作相关的代码片段。'
- en: '*Data preparation notebook* —Code to ingest the raw dataset and perform common
    data cleansing and preparation steps. The output of this notebook is a Python
    pickle file that contains the Pandas dataframe with the cleansed training data.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数据准备笔记本* —用于摄取原始数据集并执行常见的数据清洗和准备步骤的代码。此笔记本的输出是一个包含清洗后的训练数据的Pandas数据框的Python
    pickle文件。'
- en: '*Basic data exploration notebook* —Basic exploratory data analysis of the dataset
    for the main example in this book, as described in chapter 3.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*基本数据探索笔记本* —对本书主要示例的数据集进行的基本探索性数据分析，如第3章所述。'
- en: '*Data preparation for geocoding* —Code for preparing the latitude and longitude
    values derived from location values in the main dataset, as described in chapter
    4.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*地理编码数据准备* —从主数据集中的位置值中提取纬度和经度值的相关代码，如第4章所述。'
- en: '*Time-series forecasting* *data exploration notebook* —Additional exploration
    of the dataset for the main example in this book, using time-series forecasting
    techniques, as described in chapter 3.'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*时间序列预测数据探索笔记本* —使用第3章中描述的时间序列预测技术，对本书中主要示例的数据集进行额外探索。'
- en: '*Deep learning model training notebook* —Code to refactor the cleansed data
    in a format that accounts for periods when there are no delays for a given streetcar
    and prepares this refactored form of the data for input to the Keras deep learning
    model, as described in chapters 5 and 6\. The output of this notebook is a trained
    deep learning model.'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*深度学习模型训练笔记本* —将清洗后的数据重构为考虑特定电车没有延迟期间的格式，并将这种重构的数据形式准备为输入到Keras深度学习模型，如第5章和第6章所述。此笔记本的输出是一个训练好的深度学习模型。'
- en: '*XGBoost model training notebook* —Code for exercising a non-deep-learning
    model. This notebook is identical to the notebook for training the deep learning
    model up to the actual model training code. In chapter 7, we compare the results
    of this model with the deep learning model.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*XGBoost模型训练笔记本* —用于练习非深度学习模型的代码。这个笔记本与用于训练深度学习模型的笔记本在真正的模型训练代码之前是相同的。在第7章中，我们比较了该模型与深度学习模型的结果。'
- en: '*Web deployment* —Code for a simple web-based deployment of the trained deep
    learning model, as described in chapter 8.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Web部署* —将训练好的深度学习模型以简单Web方式部署的代码，如第8章所述。'
- en: '*Facebook Messenger deployment* —Code for a deployment of the trained deep
    learning model as a chatbot in Facebook Messenger, as described in chapter 8.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Facebook Messenger部署* —将训练好的深度学习模型作为聊天机器人部署到Facebook Messenger中的代码，如第8章所述。'
- en: The raw dataset used by the main example in the book is not in the repo but
    is published at [http://mng.bz/4B2B](http://mng.bz/4B2B).
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 书中主要示例所使用的原始数据集不在repo中，而是发布在[http://mng.bz/4B2B](http://mng.bz/4B2B)。
- en: 1.8 What you need to know
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.8 您需要了解的内容
- en: 'To get the most out of this book, you should be comfortable with coding in
    Python in the context of Jupyter Notebooks as well as raw Python files. You should
    also be familiar with non-deep-learning machine learning approaches. In particular,
    you should have a grasp of the following concepts: overfitting, underfitting,
    loss function, and objective function. You should be comfortable with basic operations
    in one of the common cloud environments, such as AWS, Google Cloud, or Azure.
    For the deployment section, you should have some basic familiarity with web programming.
    Finally, you should have a background in relational databases and be comfortable
    with SQL.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 要充分利用本书，您应该熟悉在Jupyter Notebooks以及原始Python文件中用Python进行编码。您还应该熟悉非深度学习机器学习方法。特别是，您应该掌握以下概念：过拟合、欠拟合、损失函数和目标函数。您应该熟悉常见云环境中的基本操作，例如AWS、Google
    Cloud或Azure。对于部署部分，您应该对Web编程有一些基本的了解。最后，您应该具备关系型数据库的背景知识，并且对SQL感到舒适。
- en: 'This book covers the essentials of deep learning but does not dig into the
    theoretical details. Instead, it takes you through an extended example of applying
    deep learning on a practical example. If you need a deeper examination of deep
    learning and its implementation in the Python environment, *Deep Learning with
    Python* is an excellent resource. I heartily recommend the whole book as a complement
    to this one. Here are three chapters that provide additional background on general
    deep learning topics:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 本书涵盖了深度学习的核心内容，但并未深入探讨理论细节。相反，它通过一个实际应用的深度学习示例的扩展示例来引导您。如果您需要更深入地了解深度学习及其在Python环境中的实现，*《Python深度学习》*
    是一个极好的资源。我强烈推荐这本书作为本书的补充。以下是提供关于一般深度学习主题背景的三个章节：
- en: “The mathematical building blocks of neural networks”—Provides background on
    concepts that are fundamental to deep learning, including tensors (the core theoretical
    data container for deep learning) and backpropagation.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “神经网络数学基础”——提供了对深度学习基本概念背景的介绍，包括张量（深度学习核心理论数据容器）和反向传播。
- en: “Getting started with neural networks”—Walks through a variety of simple deep
    learning problems covering classification (predicting which class an input data
    point belongs to) and regression (predicting a continuous value target for an
    input data point).
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “神经网络入门”——通过一系列简单的深度学习问题进行指导，涵盖分类（预测输入数据点属于哪个类别）和回归（预测输入数据点的连续值目标）。
- en: “Advanced deep learning best practices”—Examines a variety of deep learning
    architectures and includes details on Keras callbacks (a topic introduced in chapter
    6 of this book) and monitoring your deep learning model with TensorBoard.
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “高级深度学习最佳实践”——探讨了各种深度学习架构，并包括关于Keras回调（本书第6章介绍的主题）以及使用TensorBoard监控深度学习模型的详细信息。
- en: In this book, I emphasize providing a practical exploration of the end-to-end
    process of deep learning with tabular, structured data, starting with the raw
    input data and going right to the deployed, trained deep learning model. Because
    this book covers such a broad scope, it won’t always be possible to go into details
    about every related technical topic. Throughout this book, where appropriate,
    I will refer to *Deep Learning with Python* , other Manning publications, and
    technical articles for more details on related topics. In addition, chapter 9
    recommends resources on the theoretical background of deep learning.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书中，我强调提供对深度学习端到端过程的实用探索，从原始输入数据开始，一直到最后部署和训练好的深度学习模型。由于本书涵盖范围广泛，不可能总是深入探讨每个相关技术主题。在整个书中，在适当的地方，我会参考《用Python进行深度学习》以及其他Manning出版社的出版物和技术文章，以获取更多相关主题的详细信息。此外，第9章推荐了关于深度学习理论背景的资源。
- en: Summary
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Deep learning is a powerful technology that has come into its own in the past
    decade. So far, the celebrated applications of deep learning deal with nontabular
    data, such as images and text. In this book, I demonstrate that deep learning
    should also be considered for problems related to tabular, structured data.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习是一种强大的技术，在过去十年中已经崭露头角。到目前为止，深度学习备受赞誉的应用主要处理非表格型数据，如图像和文本。在这本书中，我展示了深度学习也应该被考虑用于与表格型、结构化数据相关的问题。
- en: Deep learning applies a set of techniques (including gradient-based optimization
    and backpropagation) to input data to automatically define functions that can
    predict outcomes on new data.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习通过应用一系列技术（包括基于梯度的优化和反向传播）到输入数据上，自动定义可以预测新数据上结果的功能。
- en: Deep learning has produced state-of-the-art results in a range of domains, but
    it has drawbacks compared with other machine learning techniques. These drawbacks
    include a lack of transparency about which features matter most to the model and
    a thirst for training data.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度学习在多个领域已经取得了最先进的结果，但与其他机器学习技术相比，它也存在一些缺点。这些缺点包括模型对哪些特征最为重要的透明度不足，以及对训练数据的强烈需求。
- en: Some people think that deep learning should not be applied to tabular, structured
    data. These people say that deep learning is too complex, structured datasets
    are too small to train deep learning models, and simpler alternatives are adequate
    for structured data problems.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有些人认为深度学习不应该应用于表格型、结构化数据。这些人认为深度学习过于复杂，结构化数据集太小，不足以训练深度学习模型，而更简单的替代方案对于结构化数据问题来说是足够的。
- en: At the same time, structured data is essential to modern life. Why limit deep
    learning’s scope to images and freeform text? Many important problems involve
    structured data, so it’s worthwhile to learn how to harness deep learning to solve
    structured data problems.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 同时，结构化数据对现代生活至关重要。为什么要把深度学习的范围限制在图像和自由文本上呢？许多重要问题都涉及结构化数据，因此学习如何利用深度学习来解决结构化数据问题是非常有价值的。
