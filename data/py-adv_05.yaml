- en: '5 Working with files: Being a shop manager'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 5 与文件一起工作：成为一名商店经理
- en: In this chapter
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中
- en: Erik learns what a coffee shop manager needs
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Erik学习咖啡店经理需要什么
- en: Erik reads his menus from files
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Erik从文件中读取他的菜单
- en: Erik writes his second Python function
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Erik编写他的第二个Python函数
- en: “Last time, you said something about a coffee shop manager,” Erik started with
    his brother the next day. “Something about changing menus? I forgot.”
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: “上次，你提到咖啡店经理的事情，”Erik第二天开始和哥哥说话。“是关于更改菜单的吗？我忘了。”
- en: “Yes, I said it might be good if your coffee shop manager could change the menus
    without going into Python code,” Simon said.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，我说过如果咖啡店经理可以在不进入Python代码的情况下更改菜单，那可能是个好主意，”Simon说。
- en: “Yes, good idea,” Erik said. “Not everyone knows Python.”
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，好主意，”Erik说。“不是每个人都懂Python。”
- en: “My idea is to create simple text files for each menu—call them `drinks.txt`,
    `flavors.txt`, and `toppings.txt`. Then your program can read from those files
    and create lists from the items in the files.”
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: “我的想法是为每个菜单创建简单的文本文件——可以叫它们`drinks.txt`、`flavors.txt`和`toppings.txt`。然后你的程序可以从这些文件中读取并创建列表。”
- en: “Why did you name them all with `.txt` at the end?” Erik asked. “Shouldn’t they
    be `.docx` so the manager could edit them in Microsoft Word?”
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: “你为什么给它们都加上`.txt`结尾？”Erik问。“它们不应该用`.docx`结尾，这样经理就可以在Microsoft Word中编辑它们吗？”
- en: “Good point,” Simon said. “Yes, the manager might be more familiar with Word,
    but we need a *plain text file*, without fonts, headers, or a table of contents.
    It’s similar to your Python code—these files should have nothing but lines of
    plain text, and the manager should use a plain text editor to work with them.
    When I name them with `.txt` at the end, I tell the operating system—whether it’s
    Windows, macOS, or Linux—that this file should be opened with a plain text editor
    and not a word processor like Word. In all those systems, there is always a text
    editor that can edit these files. You can also install another application for
    that, like we did with the Mu editor. Also, it’s much easier for Python to read
    from a plain text file than from a `.docx` file.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: “好主意，”Simon说。“是的，经理可能更熟悉Word，但我们需要一个*纯文本文件*，没有字体、标题或目录。它和你的Python代码类似——这些文件应该只有纯文本行，经理应该使用纯文本编辑器来处理它们。当我用`.txt`结尾命名它们时，我告诉操作系统——无论是Windows、macOS还是Linux——这个文件应该用纯文本编辑器打开，而不是像Word这样的文字处理器。在这些系统中，总是有一个文本编辑器可以编辑这些文件。你也可以安装另一个应用程序来做到这一点，就像我们安装Mu编辑器一样。此外，Python从纯文本文件中读取比从`.docx`文件中读取要容易得多。
- en: “Let’s create these files,” Simon continued. “You can use your Mu editor for
    that. Just don’t forget to add the `.txt` extension when saving the files. Otherwise,
    it will automatically add `.py`.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: “让我们创建这些文件，”Simon继续说。“你可以用你的Mu编辑器来做这件事。只是别忘了在保存文件时添加`.txt`扩展名。否则，它会自动添加`.py`。
- en: “Create a new file, enter your drinks on separate lines, and save it with the
    name `drinks.txt`. Then do the same for flavors and toppings.”
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: “创建一个新文件，将你的饮料分别输入到单独的行中，并将其保存为`drinks.txt`。然后为口味和配料做同样的事情。”
- en: 'Erik started working. After several minutes he had three files:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Erik开始工作。几分钟之后，他有了三个文件：
- en: Listing 5.1 `drinks.txt`
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.1 `drinks.txt`
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Listing 5.2 `flavors.txt`
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.2 `flavors.txt`
- en: '[PRE1]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Listing 5.3 `toppings.txt`
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 列表5.3 `toppings.txt`
- en: '[PRE2]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '*Your Turn!* Create your own menu files'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 创建你自己的菜单文件'
- en: Create text files with menu items like Erik just did. Make sure they are plain
    text files. Try using your favorite flavors and toppings in your menus.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 按照Erik刚刚做的样子创建文本文件，确保它们是纯文本文件。尝试在你的菜单中使用你最喜欢的口味和配料。
- en: “Now what?” he asked his brother.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: “现在怎么办？”他问他的哥哥。
- en: “Now let’s learn how to work with files in Python. Let’s create a new program
    for that. We’ll practice a little bit, and then we’ll add this code to our main
    program. I usually do this when I’m learning something new—I try it in a separate,
    simple program before adding it to the main application.”
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: “现在让我们学习如何在Python中处理文件。为此，我们将创建一个新的程序。我们会练习一下，然后把这个代码添加到我们的主程序中。我通常在学习新东西时这样做——我在添加到主应用程序之前，先在一个独立的简单程序中尝试它。”
- en: Simon continued, “Create another file in the editor and save it as `files.py`.”
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Simon继续说，“在编辑器中创建另一个文件，并将其保存为`files.py`。”
- en: Erik had done that several times already, so it took him just a couple seconds.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: Erik已经做过好几次了，所以这只需要几秒钟。
- en: “Working with files is a difficult topic, so I’ll start with a diagram,” Simon
    said.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: “处理文件是一个难题，所以我将从一张图开始，”Simon说。
- en: '![](../Images/05-01-open_file.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![打开文件](../Images/05-01-open_file.png)'
- en: “When you work with a file in your computer, you use its name. You tell your
    editor program to *open* a file called `drinks.txt`. Your editor program then
    *reads* the file and shows you its content. Then you edit the file and save it,
    which means you *write* the file on the computer disk. So far, so good?” Simon
    asked.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: “当你用电脑中的文件工作时，你使用它的名字。你告诉你的编辑程序*打开*一个名为`drinks.txt`的文件。然后你的编辑程序会*读取*文件并显示其内容。然后你编辑文件并保存它，这意味着你在电脑磁盘上*写入*文件。到目前为止，一切顺利吗？”西蒙问道。
- en: “Yes,” Erik said. “But disks are only used in very old computers. In my computer,
    it’s called an SSD drive—it’s not a disk anymore. My friend Alex told me.”
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，”埃里克说，“但是磁盘只用于非常老的电脑。在我的电脑里，它被称为固态硬盘——它不再是磁盘了。我的朋友亚历克斯告诉我的。”
- en: “You’re absolutely right!” Simon was glad to hear that from his brother. “Yes,
    it’s an SSD now in most computers—it’s not a disk, and it’s not spinning.”
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: “你完全正确！”西蒙很高兴听到他的兄弟这么说。“是的，现在大多数电脑里都是固态硬盘——它不是磁盘，也不是在旋转的。”
- en: “But let’s get back to my files,” Erik said. “I see that you wrote ‘computer’
    and ‘Python’ at the top of your picture. What does that mean?”
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: “但是让我们回到我的文件上来，”埃里克说，“我看到你在你的图片顶部写了‘电脑’和‘Python’。那是什么意思？”
- en: “That means,” Simon said, “that in Python, if you want to work with a file you
    have to create a special *object*, which is usually called a *file handle*. You
    use this object to read and write the file. You use a function called `open()`
    to create such an object. You call the `open()` function, and you pass the filename
    as an argument. In our case, it will be `open("drinks.txt")`. The function returns
    the file handle, which you put in a variable. In this case, the variable is called
    `f`, but you can use any name here.”
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: “这意味着，”西蒙说，“在Python中，如果你想处理一个文件，你必须创建一个特殊的*对象*，这通常被称为*文件句柄*。你使用这个对象来读取和写入文件。你使用一个名为`open()`的函数来创建这样的对象。你调用`open()`函数，并将文件名作为参数传递。在我们的例子中，它将是`open("drinks.txt")`。该函数返回文件句柄，你将其放入变量中。在这个例子中，变量名为`f`，但你可以在这里使用任何名字。”
- en: “Why is it so complicated?” Erik asked. “Why can’t we just use the filename?”
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: “为什么这么复杂？”埃里克问道，“为什么我们不能直接使用文件名？”
- en: “Yes, it looks a bit complicated the first time. The reason for that is the
    filename is just a string, remember? When we want to read from the file, we want
    to read from *the file with that name*, not from the string. The *filename* and
    the file *itself* are different things. When we use the `open()` function, we
    create a connection between the filename and the file itself. We tell Python,
    ‘Please find the file named `drinks.txt` inside the computer and use it *as a
    file*.’ Don’t worry too much about it right now. Sometimes the best way to understand
    something is to start using it.”
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，第一次看起来确实有点复杂。原因在于文件名只是一个字符串，记得吗？当我们想要从文件中读取时，我们想要读取的是*具有该名称的文件*，而不是字符串。*文件名*和*文件本身*是不同的事物。当我们使用`open()`函数时，我们在文件名和文件本身之间建立了一个连接。我们告诉Python，‘请找到电脑里名为`drinks.txt`的文件，并使用它*作为文件*。’现在不用太担心这个。有时候，理解某件事物的最好方式就是开始使用它。”
- en: “Okay,” Erik said. He was still a bit confused about all that, but he wanted
    to see how he could read his menus from the text files he just created.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: “好吧，”埃里克说。他对这一切仍然有些困惑，但他想看看他是如何从刚才创建的文本文件中读取菜单的。
- en: '“Now let’s write a simple Python program to work with files,” Simon said. “Go
    to the tab in your editor where you have your `files.py` program opened. Look
    at my diagram: you have to call the `open()` function; pass the filename, such
    as `drinks.txt`; and store the result in the variable `f`. Can you write it?”'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: “现在让我们写一个简单的Python程序来处理文件，”西蒙说，“去你编辑器里打开`files.py`程序的标签页。看看我的图示：你必须调用`open()`函数；传递文件名，比如`drinks.txt`；并将结果存储在变量`f`中。你能写出来吗？”
- en: '![](../Images/05-02-open_file.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![打开文件](../Images/05-02-open_file.png)'
- en: '“Let me try,” Erik said, and he wrote this:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: “让我试试，”埃里克说，然后他写了这样一段：
- en: '[PRE3]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '“Good!” Simon said. “Now you have a file object named `f`, and you can read
    from it. To do that, you call a *method* named `read()`. Methods look and behave
    a lot like functions, but methods are applied to *objects*. We’ll talk about objects
    later, but for now all you have to know is that to call a method of an object,
    you use the object’s name, and then you put a dot and then the method name with
    parentheses, similar to calling a function, like this: `f.read()`. Methods also
    can return something, like functions, so you have to store the result somewhere.
    What do you think this `read()` method will return when you call it?”'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: “好！”西蒙说，“现在你有一个名为 `f` 的文件对象，你可以从中读取内容。要这样做，你需要调用一个名为 `read()` 的 *方法*。方法和函数看起来和行为有很多相似之处，但方法应用于
    *对象*。我们稍后会讨论对象，但你现在只需要知道，要调用一个对象的方法，你使用对象的名字，然后放一个点，然后是方法名和括号，就像调用函数一样，就像这样：`f.read()`。方法也可以返回一些东西，就像函数一样，所以你必须将结果存储在某个地方。你认为当你调用这个
    `read()` 方法时，它会返回什么？”
- en: “What’s inside the file, I think,” Erik answered.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: “我想知道文件里有什么，”艾瑞克回答。
- en: “Absolutely correct!” Simon said. “Save it in a variable called `drinks` and
    then try to print it.”
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: “绝对正确！”西蒙说，“将它保存在一个名为 `drinks` 的变量中，然后尝试打印它。”
- en: 'Erik wrote the following:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克写下了以下内容：
- en: '[PRE4]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: “Now run it,” Simon suggested.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: “现在运行它，”西蒙建议。
- en: 'Erik clicked Run and got this output:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克点击运行并得到了以下输出：
- en: '[PRE5]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '*Your Turn!* Read from a file'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '*你的回合！* 从文件中读取'
- en: Write the same short program and try to read from the `drinks.txt` file. Make
    sure you can print out the whole file’s content.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 编写相同的简短程序并尝试从 `drinks.txt` 文件中读取。确保你可以打印出整个文件的内容。
- en: “It works!” He was really glad. His Python program opened a file, read it, and
    printed it on the page! “Now I know how to print my menus from Python. Let me
    write the same for the other two files.”
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: “它工作了！”他非常高兴。他的Python程序打开了一个文件，读取了它，并在页面上打印了它！“现在我知道如何从Python打印我的菜单了。让我为其他两个文件也写一个。”
- en: “Right,” Simon said. “But that’s not exactly what we want.”
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: “对，”西蒙说，“但这不是我们想要的。”
- en: “Why?” Erik couldn’t understand.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: “为什么？”艾瑞克无法理解。
- en: “Remember, in your program, you don’t just print out your menus. You also let
    the user choose from the menu, and then you find that item in the list, right?”
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: “记住，在你的程序中，你不仅打印出你的菜单。你还让用户从菜单中选择，然后你找到列表中的那个项目，对吧？”
- en: “Yes, but isn’t it a list here?” Erik asked. “It looks like a list.”
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，但这里不是列表吗？”艾瑞克问，“它看起来像列表。”
- en: “It may look like a list, but it’s not a list. It’s a string,” Simon said. “When
    you called the `read()` method, you copied the whole file’s content into a variable
    called `drinks`. So this variable is just one large string. If you don’t believe
    me, you can test it right here. See these three angle brackets in the output window?
    You can type any Python command here to continue working with your program—the
    same way we did with REPL, remember? Type `type(drinks)` here, and you’ll see
    the type of this variable.”
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: “它看起来像列表，但不是列表。它是一个字符串，”西蒙说，“当你调用 `read()` 方法时，你将整个文件的内容复制到一个名为 `drinks` 的变量中。所以这个变量只是一个大字符串。如果你不相信我，你可以在输出窗口这里测试它。你看到输出窗口里的这三个尖括号吗？你可以在这里输入任何Python命令来继续使用你的程序——就像我们使用REPL时一样，记得吗？在这里输入
    `type(drinks)`，你就会看到这个变量的类型。”
- en: 'Erik did and saw this:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克这样做并看到了以下内容：
- en: '[PRE6]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: “You see, Python says it’s a string,” Simon said. “And we need a list.”
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: “你看，Python说它是一个字符串，”西蒙说，“而我们需要一个列表。”
- en: “What should we do?” Erik asked.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: “我们该怎么办？”艾瑞克问。
- en: “Luckily, Python developers knew that we might need this and created another
    method for the file object. It’s called `readlines()`. Try changing your `read()`
    to `readlines()` and see what happens. Don’t forget to click Stop before running
    your program again.”
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: “幸运的是，Python开发者知道我们可能需要这个，并为文件对象创建了一个新的方法。它被称为 `readlines()`。试着将你的 `read()`
    改为 `readlines()`，看看会发生什么。别忘了在再次运行程序之前点击停止。”
- en: 'Erik changed his program to the following:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克更改了他的程序如下：
- en: '[PRE7]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'He clicked Stop and then Run again and got this output:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 他点击了停止，然后再次运行，得到了以下输出：
- en: '[PRE8]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: “Try checking its type again,” Simon suggested.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: “试着再次检查它的类型，”西蒙建议。
- en: 'Erik switched to the output window and typed `type(drinks)` again:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克切换到输出窗口并再次输入 `type(drinks)`：
- en: '[PRE9]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '*Your Turn!* Check Python types'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '*你的回合！* 检查Python类型'
- en: Repeat the checks that Erik just did. Do you see the difference between a string
    and a list?
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 重复艾瑞克刚才做的检查。你看到字符串和列表之间的区别了吗？
- en: “It’s a list!” he said. “But what are those *slash-n* characters? I don’t have
    them in my drinks file.”
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: “它是一个列表！”他说，“但那些 *slash-n* 字符是什么？我的饮料文件里没有这些。”
- en: '“You don’t *see* them in your file, but they are there. These are *invisible*
    characters. When you see this *backslash-n*, it’s a single character called a
    *newline* character. It tells the computer that it should print the next item
    at the beginning of the next line. Without it, all your drinks would be printed
    like this: `coffeechocolatedecaf`. You don’t want that, right?” Simon smiled.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: “你在文件中看不到它们，但它们确实存在。这些都是不可见的字符。当你看到这个*反斜杠-n*时，它是一个称为*换行符*的单个字符。它告诉计算机应该在下一行的开头打印下一个项目。没有它，你所有的饮料都会像这样打印出来：`coffeechocolatedecaf`。你不想这样，对吧？”西蒙微笑着。
- en: “Of course not!” Erik said. “But we don’t need them in the list, right? I think
    the menu lists should look like what’s in my main program, right?”
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: “当然不是！”艾瑞克说，“但我们不需要它们在列表中，对吧？我认为菜单列表应该看起来像我主程序里的那样，对吧？”
- en: “You’re absolutely right. And again, Python developers created a very useful
    method for that. It’s called `strip()`, and it removes invisible characters from
    both ends of the string. We just have to apply it to every item in the list. What
    do you think we should use here?”
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: “你完全正确。而且，再次强调，Python 开发者为这个创建了非常实用的方法。它被称为`strip()`，它从字符串的两端移除不可见字符。我们只需要将其应用于列表中的每个项目。你认为我们应该在这里使用什么？”
- en: “A loop?” Erik suggested.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: “一个循环？”艾瑞克建议。
- en: “Right, a loop!” Simon said. “We’ll go over the list and remove those newline
    characters with the `strip()` method.”
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: “对，一个循环！”西蒙说，“我们将遍历列表，并使用`strip()`方法移除那些换行符。”
- en: 'Simon paused for a moment, thinking. Then he continued, “There are several
    ways to do it. Some are shorter, but they are more difficult to understand. Let’s
    use the one that is easier to read and follow. Actually, this is a good rule in
    programming: when choosing between different ways of doing something, always use
    the one that is easier to read and follow. If somebody is reading your code, they
    will thank you for that. Even yourself—if you’re reading your own code three months
    later.”'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙停顿了一下，思考着。然后他继续说，“有几种方法可以做到。有些更短，但更难理解。让我们使用更容易阅读和跟随的方法。实际上，这是编程中的一个好规则：在比较不同的实现方式时，总是选择更容易阅读和跟随的那一个。如果有人正在阅读你的代码，他们会为此感谢你。即使是你自己——如果你三个月后再次阅读自己的代码。”
- en: He quickly drew a diagram.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 他迅速画了一个图表。
- en: '![](../Images/05-03-temp_list.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![临时列表](../Images/05-03-temp_list.png)'
- en: '“Let’s read into a temporary list from the file. Then we’ll go through that
    temporary list, convert each item, and append it to the new list. We’ll call that
    new list `drinks`. Then we’ll repeat the same steps for flavors and toppings.
    We can use the same temporary variable for all of them. Let me help you,” said
    Simon. He started typing in Erik’s program. Here is what it looked like after
    he finished:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: “让我们从文件中读取到一个临时列表。然后我们将遍历那个临时列表，转换每个项目，并将其追加到新列表中。我们将把这个新列表称为`drinks`。然后我们将对风味和配料重复相同的步骤。我们可以为它们使用相同的临时变量。让我来帮你，”西蒙说。他开始在艾瑞克的程序中输入。完成之后，它看起来是这样的：
- en: '[PRE10]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'He clicked Run, and they saw the result:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 他点击运行，他们看到了结果：
- en: '[PRE11]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '*Your Turn!* Remove the newline characters'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 移除换行符'
- en: Remove the newline characters from the menu items using the `strip()` method.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`strip()`方法从菜单项中移除换行符。
- en: “Looks better, doesn’t it?” he asked Erik. “Now go ahead and do the same thing
    for the other menu files.”
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: “看起来好多了，不是吗？”他问艾瑞克，“现在去为其他的菜单文件做同样的事情。”
- en: Erik started working on his program, and when he was almost done with the `flavors.txt`
    file, he exclaimed, “Wait! I’m repeating myself! You told me I shouldn’t repeat
    myself.”
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克开始编写他的程序，当他快完成`flavors.txt`文件时，他惊呼，“等等！我在重复自己了！你告诉我不应该重复自己。”
- en: Simon smiled. He was happy that his little brother grasped this concept so quickly.
    “What should we do to *not* repeat ourselves?” he asked.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙微笑。他很高兴他的小弟弟这么快就掌握了这个概念。“我们怎样才能*不*重复自己？”他问。
- en: “Write a function?” Erik said.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: “写一个函数？”艾瑞克说。
- en: '“Yes, exactly! Look at this code: what’s the same, and what’s changing? What’s
    going to be an argument, and what’s this function going to return?”'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，完全正确！看看这段代码：哪些是相同的，哪些是变化的？哪些将成为参数，这个函数将要返回什么？”
- en: Erik started thinking out loud, “I open different files, so the filename should
    be an argument, right?”
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克开始大声思考，“我打开不同的文件，所以文件名应该是一个参数，对吧？”
- en: “Correct,” Simon confirmed. “What do you want to return?”
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: “正确，”西蒙确认道，“你想要返回什么？”
- en: “I think I’ll return the list with menu options—after we remove those newline
    characters, of course. But what should I call this list?”
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: “我想我会返回一个包含菜单选项的列表——当然，在移除那些换行符之后。但我应该把这个列表叫什么呢？”
- en: “You can call it anything you want because it’s not *visible* from the outside.
    Call it `result`, for example. Then you can write `return result` at the end of
    the function. When you call the function, that `result` list is *assigned* to
    the variable in the main program, like `drinks` or `flavors`, depending on the
    file you’re reading from. *Inside* the function, the variable will be always called
    `result`, but *outside* the function, in the main program, you can assign the
    result to any variable.”
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: “你可以叫它任何你想要的名字，因为它从外面是不可见的。例如，你可以叫它 `result`。然后你可以在函数的末尾写 `return result`。当你调用函数时，那个
    `result` 列表会被 *分配* 到主程序中的变量，比如 `drinks` 或 `flavors`，这取决于你正在读取的文件。*在函数内部*，变量将始终被称为
    `result`，但在 *外部* 函数，在主程序中，你可以将结果分配给任何变量。”
- en: '![](../Images/05-04-return-result.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/05-04-return-result.png)'
- en: “Go ahead and write that function,” Simon encouraged his brother. “Remember
    how to do it? Start with `def`, name the function something like `read_menu`,
    pass `filename` as an argument, and copy the code we just wrote.”
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: “继续写那个函数，”西蒙鼓励他的兄弟。“记得怎么做吗？从 `def` 开始，给函数起一个像 `read_menu` 这样的名字，将 `filename`
    作为参数传递，并复制我们刚刚写的代码。”
- en: “Okay, I’ll try,” Erik said. He started writing his second Python function.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: “好吧，我会试试，”艾瑞克说。他开始编写他的第二个 Python 函数。
- en: 'Simon helped his brother a little, and here is what they wrote together:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙稍微帮助了他的兄弟，他们一起写了以下内容：
- en: Listing 5.4 `files.py`
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.4 `files.py`
- en: '[PRE12]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Erik saved the file and clicked Run. Of course, he got the expected result:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克保存了文件并点击了运行。当然，他得到了预期的结果：
- en: '[PRE13]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '*Your Turn!* Create a `read_menu` function'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 创建一个 `read_menu` 函数'
- en: Create a `read_menu` function the same way Erik did. Make sure you don’t have
    typos in the filenames, but what if you do? Try changing the filename and see
    what error Python gives you. Don’t forget to fix the filename so your program
    works again.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 按照艾瑞克的方式创建一个 `read_menu` 函数。确保你没有在文件名中打错字，但如果打错了呢？尝试更改文件名并看看 Python 会给出什么错误。别忘了修复文件名，让你的程序再次工作。
- en: “It’s my second function, and it works!” he proudly said to his brother.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: “这是我的第二个函数，而且它工作了！”他自豪地对他的兄弟说。
- en: “Yes, you’re building your own function library already—great!” Simon said.
    “Now let’s copy your new function to the main program. Don’t copy the `print()`
    lines—we used them just for testing. I think that file is called `menu_function.py`,
    right?”
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，你已经在构建自己的函数库了——太棒了！” 西蒙说。“现在让我们把你的新函数复制到主程序中。不要复制 `print()` 行——我们只是用它们来测试。我认为那个文件叫做
    `menu_function.py`，对吧？”
- en: “Right,” Erik said. “But where should I put my function in that file? At the
    beginning or at the end?”
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: “对，”艾瑞克说。“但我在那个文件中应该把函数放在哪里？开始还是结束？”
- en: “The rule in Python is that you should define your function *before* you start
    using it. Because of that, functions are usually placed at the beginning of the
    file, before the main program. You can place it right after your first function.”
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: “Python 中的规则是，你应该在开始使用它之前定义你的函数。正因为如此，函数通常放在文件的开始部分，在主程序之前。你可以在你的第一个函数之后放置它。”
- en: '“Okay,” Erik said. He started working, and this is what he got:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: “好吧，”艾瑞克说。他开始工作，这是他得到的结果：
- en: Listing 5.5 Erik’s menu with files
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 5.5 艾瑞克的带文件菜单
- en: '[PRE14]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '*Your Turn!* Copy your function to your main program'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 将你的函数复制到主程序中'
- en: Copy the new `read_menu()` function to your main program and try it.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 将新的 `read_menu()` 函数复制到你的主程序中并尝试运行。
- en: He tested the program, and it worked exactly as before.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 他测试了程序，它工作得和之前一样。
- en: “This is good,” Simon said. “Now try to add something to the toppings file.
    See if it changes the menu.”
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: “这很好，”西蒙说。“现在尝试向配料文件中添加一些内容。看看它是否改变了菜单。”
- en: 'Erik opened the `toppings.txt` file, added ‘vanilla powder’ to the end of the
    file, and saved it. He ran the program again, and there was an additional line
    in the last menu: `4 vanilla powder`.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克打开了 `toppings.txt` 文件，在文件末尾添加了‘香草粉’，并保存了文件。他再次运行了程序，最后菜单中多了一行：`4 香草粉`。
- en: '*Your Turn!* Add another item'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 添加另一个项目'
- en: Add a new item to one of the menus. Change one of the items. Don’t forget to
    save the menu files after you change them. Check whether your program prints the
    updated menus.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 向其中一个菜单添加一个新项目。更改其中一个项目。别忘了更改菜单文件后保存它们。检查程序是否打印了更新的菜单。
- en: “This is good, I like it!” Erik said. “Now anybody who can edit a text file
    can change the menu! Wait . . . ,” he had an idea. “So I can put *anything* in
    these menus! Ice cream, sandwiches, or whatever! Cool, I like it! I should tell
    my friend Alex about it—he likes LEGO minifigures. Maybe he can use this program
    to exchange figures with friends!”
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: “这很好，我喜欢！”埃里克说。“现在任何能编辑文本文件的人都可以更改菜单！等等……，”他有了个主意。“所以我可以把这些菜单里的任何东西都放进去！冰淇淋、三明治，或者任何东西！酷，我喜欢！我应该告诉我朋友亚历克斯这件事——他喜欢乐高迷你人偶。也许他可以用这个程序和朋友交换人偶！”
- en: “Exactly right!” Simon said. “I’m glad you have so many ideas about how to use
    your program. This is great! I have some ideas too, but we’d better talk about
    them tomorrow. We also have to create the main menu tomorrow.”
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: “完全正确！”西蒙说。“我很高兴你对如何使用你的程序有很多想法。太好了！我也有一些想法，但我们最好明天再讨论。我们明天还得创建主菜单。”
- en: “What do you mean?”
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: “你的意思是什么？”
- en: “Well, currently you have to start your program every time you want to take
    an order. You take the order, you print it, and your program finishes. It would
    be better if your program could return to the initial dialogue where you ask the
    customer’s name.”
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: “嗯，目前每次你想下单时，你都得启动你的程序。你下单，打印出来，然后程序就结束了。如果程序能返回到询问顾客名字的初始对话会更好。”
- en: “Yes, right,” Erik agreed. “It should be like a kiosk where you order something,
    press ‘Done’, and it goes to the first screen with ‘Welcome to our shop’. Yes,
    let’s do it!”
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，没错，”埃里克同意。“它应该像自动售货机一样，你下单，按‘完成’，然后它会回到‘欢迎光临我们的商店’的第一个屏幕。是的，让我们这么做！”
- en: “Let’s recap today’s progress,” Simon suggested. “What did we do today?”
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: “让我们回顾一下今天的进展，”西蒙建议。“我们今天做了什么？”
- en: “First, you said that the coffee shop manager will want to edit our menus in
    files. Then I wrote three files with menus for drinks, flavors, and toppings.”
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: “首先，你说咖啡店经理会想要编辑我们的菜单文件。然后我写了三个文件，分别用于饮料、口味和配料菜单。”
- en: “Very good, what next?”
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: “非常好，接下来是什么？”
- en: “Then I opened the files and read from them. I first read line by line, but
    then I had those strange ‘backslash-n’ characters. Then we used the `strip()`
    method to remove them.”
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: “然后我打开了文件并从中读取。我一开始是逐行读取，但后来出现了那些奇怪的‘反斜杠-n’字符。然后我们使用了`strip()`方法来移除它们。”
- en: “Good,” Simon said. “And did you remember what I told you about objects?”
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: “好，”西蒙说。“你还记得我跟你说的关于对象的事情吗？”
- en: “Not really. You said that the file is an object in Python, and it’s not the
    same as its name. And you said that functions with objects are called ‘methods.’”
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: “其实并没有。你说文件在Python中是一个对象，它和它的名字并不相同。你还说带有对象的函数被称为‘方法。’”
- en: “Yes, that’s right,” Simon said. “Objects are complicated. For now we’ll just
    use them and their methods, but we’ll learn more about them later. We’ll create
    our own objects and methods too, like we did with functions.”
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，没错，”西蒙说。“对象很复杂。现在我们只使用它们和它们的方法，但以后我们会了解更多。我们也会创建自己的对象和方法，就像我们处理函数一样。”
- en: “Right,” Erik said. “You reminded me—I wrote my second Python function, and
    it worked!”
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: “没错，”埃里克说。“你提醒了我——我写了我的第二个Python函数，而且它工作了！”
- en: “Indeed. You’re becoming a serious programmer now,” Simon said and smiled. “Let’s
    take a rest for now. Tomorrow, we’ll make your program even better.”
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: “确实如此。你现在正成为一个严肃的程序员，”西蒙说，然后微笑。“现在我们先休息一下。明天，我们会让你的程序变得更好。”
- en: New things you have learned today
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 你今天学到的新东西
- en: '*What it means to open a file*—You have learned the difference between the
    filename and the file handle inside the program.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*打开文件的意义*——你学到了程序内文件名和文件句柄之间的区别。'
- en: '*What* `\n` *is and how you can remove it from strings*—You learned that the
    `\n` symbol means “start a new line.” You don’t need it in your menu items, so
    you used the `strip()` function to remove it.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*`\n`是什么以及如何从字符串中移除它*——你学到了`\n`符号代表“开始新行”。在你的菜单项中你不需要它，所以你使用了`strip()`函数来移除它。'
- en: '*What you return from a function is assigned to a variable in the main program*—You
    learned that the variable inside a function is not *visible* in the main program.
    To pass its value, you have to *return* that variable from the function and *assign*
    its value to another variable in the main program.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*从函数返回的内容被分配到主程序中的变量*——你学到了函数内部的变量在主程序中是不可见的。为了传递它的值，你必须从函数中返回那个变量，并将其值分配给主程序中的另一个变量。'
- en: Code for this chapter
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 本章的代码
- en: 'You can find the code for this chapter here: [https://github.com/pavelanni/pythonicadventure-code/tree/main/ch05](https://github.com/pavelanni/pythonicadventure-code/tree/main/ch05).'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处找到本章的代码：[https://github.com/pavelanni/pythonicadventure-code/tree/main/ch05](https://github.com/pavelanni/pythonicadventure-code/tree/main/ch05).
