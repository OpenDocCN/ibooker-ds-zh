- en: 15 The Lindy effect
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 15 林迪效应
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Examining the 80-20 rule
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检验80-20法则
- en: Visualizing the 80-20 rule with Pareto charts
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用帕累托图可视化80-20法则
- en: Creating violin plots
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建小提琴图
- en: Creating paired histograms
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建成对直方图
- en: The Lindy effect, or Lindy’s Law, suggests that nonperishable items, such as
    a book in print or a business, have life expectancies equal to their current age.
    For instance, if *The Great Gatsby* has been in print for 100 years, we can expect
    it to remain in print for another 100 years. Basically, the longer something has
    been in existence, the longer it’s likely to continue existing. The concept is
    named after a *former* delicatessen in New York City named Lindy’s that nonetheless
    remained open for nearly a century. The Lindy effect doesn’t apply to human beings,
    fruit, or other perishable items; after all, we can’t expect a man aged 75 years
    to live another 75 years or a banana to stay ripe indefinitely.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 林迪效应，或称林迪定律，表明非易腐物品，如印刷书籍或企业，其预期寿命等于其当前年龄。例如，如果《了不起的盖茨比》已经印刷了100年，我们可以预期它还会再印刷100年。基本上，某物存在的时间越长，它继续存在的机会就越大。这个概念是以纽约市一家名为林迪的*前*熟食店的名字命名的，尽管如此，它还是开业了近一个世纪。林迪效应不适用于人类、水果或其他易腐物品；毕竟，我们无法期望一个75岁的男人再活75年，或者香蕉永远保持新鲜。
- en: From a statistical perspective, the Lindy effect follows a right-skewed, or
    positive-skewed, probability distribution; that is, the distribution of a numeric
    variable over a continuous interval peaks when x is close to 0 and then tapers
    as x increases. Our first visualization (see figure 15.1) demonstrates this effect;
    it’s a `ggplot2` density plot that displays the distribution of NBA franchises
    by years present, from 1946, when the NBA was founded, through 2020 (where the
    number of franchises equals unique team names between cities, states, and nicknames).
    Put simply, it shows that most NBA franchises existed, or have existed, for just
    a few years, whereas fewer franchises have been, or were, in existence for many
    years.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 从统计学的角度来看，林迪效应遵循右偏态，或正偏态，的概率分布；也就是说，一个数值变量在连续区间上的分布，当x接近0时达到峰值，然后随着x的增加而逐渐变薄。我们的第一个可视化（见图15.1）展示了这一效应；它是一个`ggplot2`密度图，显示了从1946年NBA成立到2020年（各城市、各州和昵称之间的独特球队名称数量等于球队数量）NBA球队的年数分布。简单来说，它显示大多数NBA球队只存在了几年的时间，而较少的球队存在了很长时间。
- en: '![CH15_F01_Sutton](../../OEBPS/Images/CH15_F01_Sutton.png)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![CH15_F01_Sutton](../../OEBPS/Images/CH15_F01_Sutton.png)'
- en: Figure 15.1 The distribution of NBA franchises visualized by number of years
    in the league; when the Lindy effect applies, we’ll see a right-skewed, or positive-skewed,
    distribution. Thus, the Lindy effect corresponds to a Pareto probability distribution
    that is closely aligned with the 80-20 rule.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.1 NBA球队在联盟中的年数分布可视化；当林迪效应适用时，我们会看到一个右偏态，或正偏态，的分布。因此，林迪效应对应于与80-20法则紧密相关的帕累托概率分布。
- en: 'The distribution is clearly right-skewed; there are more values clustered around
    the left tail of the distribution than anywhere else, while the right tail of
    the distribution is significantly longer. This sort of distribution corresponds
    well with a Pareto probability distribution. Named after the Italian civil engineer,
    economist, and sociologist Vilfredo Pareto, the Pareto distribution is a power
    law and, therefore, nonlinear probability distribution that, at least in spirit
    if not the letter, suggests that 80% of all outcomes are due to just 20% of causes.
    For instance, 80% of a company’s sales are generated from 20% of its clients,
    or 80% of all R code is powered by just 20% of the libraries. The inverse is also
    true: you might wear only 20% of your wardrobe 80% of the time, or maybe you watch
    just 20% of your television channels 80% of the time. We all know this as the
    80-20 rule.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 分布明显呈右偏态；分布的左侧尾部聚集的值比其他任何地方都多，而分布的右侧尾部则显著更长。这种分布与帕累托概率分布非常吻合。帕累托分布是以意大利土木工程师、经济学家和社会学家维弗雷多·帕累托的名字命名的，它是一种幂律分布，因此是非线性概率分布。至少在精神上，如果不是在字面上，它暗示了80%的所有结果都只是由20%的原因造成的。例如，一家公司的80%的销售额来自其20%的客户，或者所有R代码的80%都是由20%的库驱动的。反之亦然：你可能只有80%的时间穿20%的衣服，或者你可能只有80%的时间观看20%的电视频道。我们把这称为80-20法则。
- en: Our purpose here is to test the 80-20 rule with respect to games played and
    games won across all NBA franchises between 1946 and 2020\. Might it be true that
    20% of all NBA franchises—which continuously come and go—account for 80% of the
    games played and won? In the process, we’ll demonstrate two ways in which to create
    a Pareto chart, which is a combination bar and line chart that displays unit and
    incremental frequencies across primary and secondary y axes, respectively. We’ll
    start, as usual, by loading our required packages.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们的目的是测试1946年至2020年间所有NBA球队在比赛和胜利方面的80-20法则。是否可能的情况是，所有NBA球队中20%的球队——这些球队不断涌现和消失——占所有比赛和胜利的80%？在这个过程中，我们将展示两种创建帕累托图的方法，帕累托图是一种组合条形图和折线图，分别显示主要和次要y轴上的单元和增量频率。我们将像往常一样，首先加载我们所需的包。
- en: 15.1 Loading packages
  id: totrans-12
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 15.1 加载包
- en: 'Once again, we’ll use a combination of familiar and not-so-familiar packages:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将再次使用熟悉和不那么熟悉的包的组合：
- en: Our data will be wrangled with a mix of `dplyr` and `tidyr` functions, and some
    of our visualizations will be created in `ggplot2`, so we start by loading the
    `tidyverse` package.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的数据将通过 `dplyr` 和 `tidyr` 函数的混合进行整理，并且一些可视化将在 `ggplot2` 中创建，因此我们首先加载 `tidyverse`
    包。
- en: Some of our visualizations will be bundled into a single graphical object for
    printing and presentation purposes, so we then load the `patchwork` package.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的一些可视化将捆绑成一个单独的图形对象，用于打印和展示目的，因此我们随后加载 `patchwork` 包。
- en: We’ll again make a call to the `recode()` function from the `car` package to
    rename elements in a vector.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将再次调用 `car` 包中的 `recode()` 函数来重命名向量中的元素。
- en: 'Through the `ggpubr` package, we’ll introduce two new visualization types:
    a violin plot and a paired histogram.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过 `ggpubr` 包，我们将介绍两种新的可视化类型：小提琴图和成对直方图。
- en: The `ggQC` and `gcc` packages are new. Our first of two Pareto charts will be
    created with a combination of `ggplot2` and `ggQC` functions; our second Pareto
    chart will be created with the `gcc` package.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ggQC` 和 `gcc` 包是新的。我们的第一个帕累托图将通过 `ggplot2` 和 `ggQC` 函数的组合创建；我们的第二个帕累托图将使用
    `gcc` 包创建。'
- en: 'We therefore call the `library()` function six times to sequentially load these
    six packages:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们调用 `library()` 函数六次，依次加载这六个包：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We’ll import our data set next.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将导入我们的数据集。
- en: 15.2 Importing and viewing data
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 15.2 导入和查看数据
- en: 'Our data set is a Microsoft Excel spreadsheet saved in our default working
    directory with a .csv extension; it contains the number of games played and won
    for every NBA franchise between the 1946 and 2020 seasons, scraped from [www.nba.com](https://www.nba.com/)
    and [www.basketball-reference.com](https://www.basketball-reference.com/). We
    make a call to the `readr` `read_csv()` function to import our data:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据集是一个保存在我们默认工作目录中的Microsoft Excel电子表格，以.csv扩展名保存；它包含1946年至2020赛季每个NBA球队的比赛和胜利次数，从
    [www.nba.com](https://www.nba.com/) 和 [www.basketball-reference.com](https://www.basketball-reference.com/)
    爬取而来。我们调用 `readr` 的 `read_csv()` 函数来导入我们的数据：
- en: '[PRE1]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Then, we call the `glimpse()` function from the `dplyr` package to return a
    transposed view of our data set:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们从 `dplyr` 包中调用 `glimpse()` 函数来返回我们数据集的转置视图：
- en: '[PRE2]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Our data set, df1, contains 89 rows, or 1 row per NBA franchise, and just eight
    columns. Bear in mind that while the NBA now comprises 30 teams or franchises,
    the NBA usually had only eight teams between 1946 and 1965, had no more than 20
    teams until 1977, and didn’t have 30 teams until the 2004 season. Here’s a variable-by-variable
    breakdown:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据集，df1，包含89行，即每个NBA球队一行，以及八个列。请注意，尽管NBA现在由30支球队或球队组成，但NBA在1946年至1965年期间通常只有八支球队，直到1977年不超过20支球队，直到2004赛季才有30支球队。以下是按变量分解的说明：
- en: '`franchise`—The full name of every franchise in NBA history dating back to
    1946\. Let’s walk through a pair of examples. The Atlanta Hawks are one of 30
    active NBA teams (franchises). Their roots go back to 1949, when they alternated
    their home games between three small towns in Illinois and Iowa and were then
    known as the Tri-Cities Blackhawks. In 1951, they relocated to Milwaukee and became
    the Milwaukee Hawks; in 1955, they relocated again, this time to St. Louis, and
    thus became the St. Louis Hawks. Finally, in 1968, they relocated to Atlanta.
    Consequently, there are five “Hawks” records in df1—one for each unique team,
    or child, plus one roll-up, or parent, record that aggregates the sums of all
    the child records. Or take a team (franchise) such as the Boston Celtics. They’ve
    always played in Boston and have always been known as the Celtics, so df1 contains
    just one record for the Boston Celtics franchise. This is now a character string,
    but in a moment, we’ll be converting it to a factor variable.'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`franchise`—自1946年以来NBA历史上每个特许经营的全名。让我们通过两个例子来了解一下。亚特兰大老鹰队是30支活跃的NBA球队（特许经营）之一。他们的根源可以追溯到1949年，当时他们在伊利诺伊州和爱荷华州的三座小城镇之间交替进行主场比赛，当时被称为三城老鹰队。1951年，他们搬迁到了密尔沃基，并成为了密尔沃基老鹰队；1955年，他们再次搬迁，这次搬到了圣路易斯，因此成为了圣路易斯老鹰队。最后，在1968年，他们搬到了亚特兰大。因此，df1中有五个“老鹰”记录——每个独特的球队或子记录一个，还有一个汇总记录，即父记录，它汇总了所有子记录的总和。或者以波士顿凯尔特人队为例。他们一直都在波士顿打球，并且一直被称为凯尔特人队，所以df1中只包含一个波士顿凯尔特人特许经营的记录。现在这是一个字符字符串，但很快我们就会将其转换为因子变量。'
- en: '`parent_child`—Now a character string that will soon be converted to a factor
    variable. This variable equals `parent`, `parent_only`, or `child`. With respect
    to the lone Boston Celtics record in df1, `parent_child` equals `parent_only`
    because there are no child records. With respect to the five “Hawks” records,
    `parent_child` equals parent for the one roll-up record and child for the remaining
    four records.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`parent_child`—现在是一个字符字符串，很快将被转换为因子变量。该变量等于`parent`、`parent_only`或`child`。就df1中唯一的波士顿凯尔特人记录而言，`parent_child`等于`parent_only`，因为没有子记录。对于五个“老鹰”记录，`parent_child`对于汇总记录等于`parent`，而对于剩余的四个记录等于`child`。'
- en: '`active_inactive`—Also a character variable that will be converted to a factor;
    this variable equals `active` for all parent and child records if the team (franchise)
    is currently in the NBA; if not, it equals `inactive`.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`active_inactive`—也是一个字符变量，将被转换为因子；如果球队（特许经营）目前处于NBA中，则该变量对所有父记录和子记录等于`active`；如果不处于NBA中，则等于`inactive`。'
- en: '`start`—Equals the first season for any franchise or franchise name where,
    for instance, 1949 equals the 1948-49 season. This is now an integer and will
    remain an integer.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`start`—等于任何特许经营或特许经营名称的第一个赛季，例如，1949年等于1948-49赛季。现在这是一个整数，并将保持为整数。'
- en: '`end`—Equals the final season for any franchise or franchise name; this is
    also an integer.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`end`—等于任何特许经营或特许经营名称的最后一个赛季；这也是一个整数。'
- en: '`years`—Equals the number of years, or seasons, in existence; this is another
    integer.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`years`—等于存在的年数或赛季数；这也是一个整数。'
- en: '`games`—An integer that equals the total number of games played.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`games`—一个整数，等于所玩的总比赛数。'
- en: '`wins`—An integer that equals the total number of games won.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`wins`—一个整数，等于赢得的总比赛数。'
- en: 'Let’s now convert the variables `franchise`, `parent_child`, and `active_inactive`
    to factors by calling the base R `as.factor()` function three times. Once more,
    variables are best being factors if and when they can only take on a finite set
    of values:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们通过三次调用基础R的`as.factor()`函数将变量`franchise`、`parent_child`和`active_inactive`转换为因子。再次强调，当变量只能取有限集合的值时，它们最好被转换为因子：
- en: '[PRE3]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We then call the base R `summary()` function, which returns descriptive statistics
    on our df1 numeric variables and record counts by level on our factor variables:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们随后调用基础R的`summary()`函数，该函数返回关于df1数值变量的描述性统计信息以及关于因子变量的按层级的记录计数：
- en: '[PRE4]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Here’s a synopsis of what the `summary()` function just told us about our data
    set:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是`summary()`函数刚刚告诉我们关于数据集的概要：
- en: There are 31 franchises, including the Boston Celtics, with no child records.
    These are teams that never relocated or changed names, but they aren’t necessarily
    active.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有31个特许经营，包括波士顿凯尔特人队，没有子记录。这些球队从未搬迁或更改名称，但它们不一定活跃。
- en: There are 16 additional franchises (so 47 in all) that either started play in
    some other city from where they are now located or at least changed their name
    one or more times since their first year in the league.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有 16 个额外的特许经营商（总共 47 个），它们要么是从现在所在城市以外的其他城市开始比赛的，要么至少在联盟的第一年就更改了名称一次或多次。
- en: There are 30 active franchises, which is derived by subtracting the 46 active
    franchise count by the 16 records where the `parent_child` variable equals `parent`.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有 30 个活跃的特许经营商，这是通过减去 46 个活跃特许经营商的数量和 16 个记录（其中 `parent_child` 变量等于 `parent`）得到的。
- en: At least one team played only one year, and at least one team has been around
    for 75 years.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少有一支球队只打了一年，而至少有一支球队已经存在了 75 年。
- en: At least one team played only 60 games before they folded, and one team has
    played in 5,869 games.
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少有一支球队在解散前只打了 60 场比赛，而有一支球队参加了 5,869 场比赛。
- en: At least one team won just 11 games, while at least one other team has won 3,462
    games.
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 至少有一支球队只赢了 11 场比赛，而至少有一支球队赢得了 3,462 场比赛。
- en: With respect to the variables `years`, `games`, and `wins`, the mean is consistently
    greater than the median; this, of course, corresponds well with right-skewed,
    or positive-skewed, distributions.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于变量 `years`、`games` 和 `wins`，平均值始终大于中位数；这当然很好地对应了右偏斜，或正偏斜的分布。
- en: Now that we have some good, but mostly tabular, insights into our data, we’ll
    next visualize much of the same by creating two violin plots and paired histograms.
    You’ll see that violin plots share many of the same properties as boxplots; however,
    violin plots also display the density of a numeric variable at different values
    along the y-axis. Paired histograms, sometimes referred to as overlaid histograms
    (you’ll see why in just a moment), provide a type of visualization by which two
    distributions are compared side by side rather than in separate plots, which,
    of course, makes it that much easier to compare and contrast the distributions
    of two numeric variables at once. One of the aims of this book is to introduce
    visualizations outside the mainstream, discuss best cases for their use, and demonstrate
    how to create them. This chapter in particular includes a few such plots.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们对数据有一些好的，但主要是表格式的洞察，我们将通过创建两个小提琴图和成对直方图来可视化大部分相同的内容。你会看到小提琴图与箱线图有许多相同的属性；然而，小提琴图还显示了沿
    y 轴不同值处的数值变量的密度。成对直方图，有时被称为叠加直方图（你很快就会明白为什么），提供了一种可视化方式，通过这种方式，两个分布是并排比较的，而不是在单独的图表中，这当然使得同时比较和对比两个数值变量的分布变得容易得多。本书的一个目标就是介绍主流之外的可视化，讨论它们使用的最佳案例，并演示如何创建它们。特别是这一章包括了一些这样的图表。
- en: 15.3 Visualizing data
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 15.3 可视化数据
- en: 'Our next order of business is to call the `filter()` function from the `dplyr`
    package to subset df1 where the variable `parent_child` doesn’t equal parent;
    once more, the `!=` operator in R means not equal to. In other words, we’re subsetting
    df1—and creating a new object called f2—where the variable `parent_child` equals
    `parent_only` or `child`. So we’ve effectively eliminated the df1 roll-up records
    while creating df2:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来的任务是调用 `dplyr` 包中的 `filter()` 函数来对 df1 进行子集化，其中变量 `parent_child` 不等于 `parent`；再次强调，R
    中的 `!=` 运算符表示不等于。换句话说，我们正在对 df1 进行子集化——创建一个名为 f2 的新对象——其中变量 `parent_child` 等于
    `parent_only` 或 `child`。因此，我们在创建 df2 的同时有效地消除了 df1 的汇总记录：
- en: '[PRE5]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Then, we call the `dim()` function from base R, which returns the dimension
    of df2, or the row and column counts:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用基础 R 中的 `dim()` 函数，它返回 df2 的维度，即行和列计数：
- en: '[PRE6]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: We still have the original eight variables, of course, but df2 contains just
    73 records whereas df1 contains 89.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们仍然有原始的八个变量，但 df2 只包含 73 条记录，而 df1 包含 89 条。
- en: 15.3.1 Creating and evaluating violin plots
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.3.1 创建和评估小提琴图
- en: 'Now let’s create our pair of violin plots. A violin plot is a hybrid between
    a boxplot and a density plot that visualizes the distribution of a numeric data
    series. Our first plot visualizes the distribution of the variable `games`, and
    the second visualizes the distribution of the variable `wins`:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们创建我们的成对小提琴图。小提琴图是箱线图和密度图的混合体，它可视化数值数据系列的分布。我们的第一个图可视化变量 `games` 的分布，第二个图可视化变量
    `wins` 的分布：
- en: Both plots are created by calling the `ggviolin()` function from the `ggpubr`
    package, which is just one of many `ggplot2` extensions. If there’s a challenge
    with `ggpubr` and other `ggplot2` extensions, it’s with the syntax; they tend
    to use a random mix of `ggplot2`, base R, and other miscellaneous commands. But
    if you can work through the idiosyncrasies of the code, the reward will be worth
    the effort.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两个图表都是通过调用 `ggpubr` 包中的 `ggviolin()` 函数创建的，而 `ggpubr` 只是众多 `ggplot2` 扩展之一。如果遇到
    `ggpubr` 和其他 `ggplot2` 扩展的问题，通常是语法问题；它们倾向于使用 `ggplot2`、基础 R 和其他杂项命令的随机组合。但如果你能克服代码的怪癖，那么回报将是值得努力的。
- en: The object we just created, df2, is the data source for both plots. This means
    we’re visualizing the distributions of games and wins for every unique franchise
    or team name and disregarding those records where in df1 the variable `parent_child`
    equals `parent`.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们刚刚创建的对象，df2，是两个图表的数据源。这意味着我们正在可视化每个独特的特许经营或团队名称的游戏和胜利分布，并忽略那些在 df1 中变量 `parent_child`
    等于 `parent` 的记录。
- en: Violin plots require just a y-axis variable; y equals `games` in our first plot
    and `wins` in our second plot.
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 小提琴图只需要一个 y 轴变量；在我们的第一个图中，y 等于 `games`，在第二个图中，y 等于 `wins`。
- en: Our violin plots each contain an embedded boxplot; that way, we can still make
    out the Interquartile Range (IQR), mean and median, lower and upper quartiles,
    and any outliers. As with our previous boxplots in prior chapters, R automatically
    denotes the median with a horizontal line somewhere within the IQR; after the
    `ggviolin()` function, we *add* the `stat_summary()` function, as we’ve done so
    many times before, to add a solid dot that represents the mean.
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的小提琴图每个都包含一个嵌入的箱线图；这样我们仍然可以识别出四分位数范围 (IQR)、均值和中位数、下四分位数和上四分位数以及任何异常值。与之前章节中的箱线图一样，R
    自动在 IQR 内部用水平线表示中位数；在 `ggviolin()` 函数之后，我们 *添加* `stat_summary()` 函数，就像我们之前多次做的那样，以添加一个代表均值的实心点。
- en: The `ggplot2 theme()` function applies a bold font to both titles.
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ggplot2 theme()` 函数将粗体字体应用于两个标题。'
- en: 'The chunks of code for both plots, p2 and p3, are shown here:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 两个图表，p2 和 p3 的代码块如下所示：
- en: '[PRE7]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Rather than instantly printing our violin plots, we’ll instead hold them in
    memory while we proceed with creating our `ggpubr` paired histograms. But first,
    we need to do a bit of data wrangling.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不会立即打印出小提琴图，而是将它们保存在内存中，同时我们继续创建 `ggpubr` 配对直方图。但首先，我们需要做一些数据处理。
- en: 15.3.2 Creating paired histograms
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.3.2 创建配对直方图
- en: We pass the df2 data set via the pipe operator to the `pivot_longer()` function
    from the `tidyr` package. The `pivot_longer()` function takes the df2 variables
    `games` and `wins`, converts them to levels within a new variable called `games`,
    and throws their values to another new variable called `counts`. The end result
    is a tibble called df3\. Then we call the `as.factor()` function to convert the
    variable `games` from a character string to a factor; the `counts` variable is
    an integer.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过管道操作符将 df2 数据集传递给 `tidyr` 包中的 `pivot_longer()` 函数。`pivot_longer()` 函数将 df2
    中的 `games` 和 `wins` 变量转换为新变量 `games` 中的级别，并将它们的值投掷到另一个新变量 `counts` 中。最终结果是名为 df3
    的 tibble。然后我们调用 `as.factor()` 函数将变量 `games` 从字符字符串转换为因子；`counts` 变量是整数。
- en: Next, we call the `recode()` function from the `car` package to rename the `games`
    and `wins` elements within the `games` variable to `Played` and `Won`, respectively.
    The `recode()` function is typically called to modify values in a variable, but
    as we’re demonstrating here, it can also be called when there’s a need to rename
    variables. Thus, it’s a suitable substitute for the `rename()` function.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们调用 `car` 包中的 `recode()` 函数，将 `games` 变量中的 `games` 和 `wins` 元素分别重命名为 `Played`
    和 `Won`。通常，`recode()` 函数用于修改变量中的值，但正如我们在这里所展示的，当需要重命名变量时也可以调用它。因此，它适合作为 `rename()`
    函数的替代品。
- en: 'The base R `head()` function returns the first 10 records in df3, but subset
    on the variables `franchise`, `games`, and `counts`. You must include the variable
    positions rather than the variable names for this last line of code to run:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: R 基础函数 `head()` 返回 df3 中的前 10 条记录，但在此代码的最后部分对变量 `franchise`、`games` 和 `counts`
    进行了子集操作。为了使此代码行运行，你必须包含变量位置而不是变量名称：
- en: '[PRE8]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now we can create our paired histograms by calling the `gghistogram()` function
    from the `ggpubr` package. By calling the `gghistogram()` function, we’re creating
    two histograms within the same graphical object. We’re able to overlay two plots
    in the same visualization because `gghistogram()` automatically prints both histograms
    in opaque hues, thereby making it possible to view both distributions even when
    and where they overlap one another:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以通过调用 `ggpubr` 包中的 `gghistogram()` 函数来创建我们的成对直方图。通过调用 `gghistogram()` 函数，我们在同一个图形对象中创建两个直方图。我们能够在同一个可视化中叠加两个图表，因为
    `gghistogram()` 自动以不透明的色调打印两个直方图，从而使得即使在它们重叠的地方也能查看两个分布：
- en: The tibble we just created, df3, is our data source.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们刚刚创建的 tibble，df3，是我们的数据源。
- en: Whereas boxplots only require a y-axis variable, histograms just require an
    x-axis variable; here, our x-axis variable is `counts`. Because `counts` ties
    back to the factor variable `games`, with levels equal to `games` and `wins`,
    one of our histograms therefore visualizes the distribution of games, or games
    played, and our other histogram visualizes the distribution of wins.
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与箱线图只需要 y 轴变量不同，直方图只需要 x 轴变量；在这里，我们的 x 轴变量是 `counts`。因为 `counts` 与因子变量 `games`
    相关联，其水平等于 `games` 和 `wins`，因此我们的一个直方图因此可视化游戏的分布，或所玩的游戏，而我们的另一个直方图可视化胜利的分布。
- en: As with `ggplot2` boxplots, we control the number of bins. Both of our boxplots
    contain 15 bins, which is close enough to the square root of the df3 record count.
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与 `ggplot2` 箱线图一样，我们控制箱的数量。我们的两个箱线图都包含 15 个箱，这接近于 df3 记录数的平方根。
- en: The `add` argument inserts vertical dashed lines that represent the mean for
    each distribution.
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`add` 参数插入代表每个分布均值的垂直虚线。'
- en: By setting the `rug` argument equal to `TRUE`, R adds a rug plot in the margin
    along the x-axis. A rug plot is a one-dimensional display of a data distribution
    in the form of marks, which often complements a two-dimensional display of the
    same data series. Rug plots are only practical when your data set contains a relatively
    modest number of records.
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过将 `rug` 参数设置为 `TRUE`，R 在 x 轴边缘添加一个 rug 图。Rug 图是以标记形式显示数据分布的一维展示，通常与同一数据系列的二维展示相辅相成。当你的数据集包含相对较少的记录时，rug
    图才实用。
- en: 'The code chunk for our paired histograms, p4, follows:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们成对直方图 p4 的代码块如下：
- en: '[PRE9]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 15.3.3 Printing our plots
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.3.3 打印我们的图表
- en: 'We temporarily hold p4 in memory and then bundle it with p2 and p3 into a single
    object by calling the `plot_layout()` function from the `patchwork` package (see
    figure 15.2). Plots p2 and p3 are printed side by side on the top row, and plot
    p4, which assumes a width equal to p2 plus p3, is displayed on the bottom row
    (take note of the minus operator in our code):'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们暂时将 p4 保存在内存中，然后通过调用 `patchwork` 包中的 `plot_layout()` 函数将其与 p2 和 p3 合并成一个单一的对象（见图
    15.2）。p2 和 p3 在顶部行并排打印，而 p4（其宽度等于 p2 加 p3）在底部行显示（注意我们代码中的减号运算符）：
- en: '[PRE10]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![CH15_F02_Sutton](../../OEBPS/Images/CH15_F02_Sutton.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![CH15_F02_Sutton](../../OEBPS/Images/CH15_F02_Sutton.png)'
- en: Figure 15.2 Violin plots on the top display the distributions of games played
    and games won, respectively, by all current and past NBA franchises between 1946
    and 2020\. On the bottom, paired histograms visualize the same data series.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.2 顶部显示的是 1946 年至 2020 年间所有当前和过去 NBA 联盟的球队所玩和赢得的比赛的分布。底部，成对直方图可视化相同的数据系列。
- en: 'While violin plots are less common, or less popular, than boxplots, and therefore
    might not resonate as well across a random sample of end users, there is at least
    one reason why you should favor violin plots: they display the full distribution
    of a data series, whereas boxplots merely show the summary statistics. (Of course,
    we’ve chosen to provide the best of both worlds by adding embedded boxplots to
    our violin plots.) You might want to select one or the other depending upon the
    sophistication level of your audience.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管小提琴图比箱线图少见或不受欢迎，因此在随机样本的最终用户中可能不会引起太大的共鸣，但至少有一个原因让你应该更喜欢小提琴图：它们显示了数据系列的完整分布，而箱线图仅仅显示了汇总统计量。（当然，我们选择提供两者的最佳结合，通过在小提琴图中添加嵌入的箱线图来实现。）你可能根据受众的复杂程度选择其中之一。
- en: Violin plots also display the shape of a data series by using a probability
    density function (PDF) just like a density plot. In fact, if it were possible
    to slice our violin plots vertically down the middle and then rotate the left
    halves 90 degrees, they would look very much like the density plot we created
    earlier (refer to figure 15.1). The width of the PDF represents how frequently
    corresponding values can be observed in the data, where wider regions indicate
    higher frequencies and tapered regions indicate lower frequencies.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 小提琴图也通过使用概率密度函数（PDF）来显示数据系列的形状，就像密度图一样。事实上，如果可能的话，我们可以垂直切割我们的小提琴图中间，然后旋转左半部分90度，它们看起来会非常像我们之前创建的密度图（参见图15.1）。PDF的宽度表示对应值在数据中观察到的频率，其中较宽的区域表示较高的频率，而细长的区域表示较低的频率。
- en: The data is right-skewed. We know this because the widest regions in both of
    our violin plots are where y equals some number not far from 0\. We also know
    this because both means, represented by the solid dots inside our embedded boxplots,
    are greater than the medians, represented by the horizontal lines inside the same.
    That the data is right-skewed is perhaps made more obvious by our paired histograms.
    Plotting two histograms within the same visualization is a good technique to know
    when you want or need to compare and contrast two distributions down to the factor
    level.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 数据呈右偏态。我们知道这一点，因为在我们两个小提琴图中，最宽的区域是y值接近0的一些数字。我们也知道这一点，因为在我们嵌入的箱线图中，代表均值（用实心点表示）的线条都高于代表中位数（用相同图中的水平线表示）的线条。数据呈右偏态这一点可能通过我们的配对直方图变得更加明显。在同一个可视化中绘制两个直方图是一种很好的技术，当你想要或需要比较和对比两个分布到因子级别时。
- en: However, our violin plots and paired histograms don’t tell us if the 80-20 rule
    is in effect; in other words, we don’t yet know if 20% of current and past NBA
    franchises account for 80% of games played or won. The data is definitely nonlinear,
    but *how* nonlinear we haven’t yet figured out. That’s why we need Pareto charts.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们的小提琴图和配对直方图并没有告诉我们80-20规则是否生效；换句话说，我们还没有弄清楚当前和过去的NBA球队中，是否有20%的球队占据了80%的比赛或胜利。数据肯定是非线性的，但我们还没有弄清楚非线性到什么程度。这就是为什么我们需要帕累托图。
- en: 15.4 Pareto charts
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 15.4 帕累托图
- en: Let’s talk about Pareto charts for a moment before we demonstrate how to create
    and interpret them. A Pareto chart is both a bar chart and a line chart with primary
    and secondary y-axes. The bar length usually represents frequency, but it can
    also represent time, money, or some other cost function. The bars are usually
    arranged vertically and must be in descending order. Whereas the bars represent
    unit frequencies, the line represents cumulative frequency measured in percentages;
    the points along the line therefore correspond to the bars.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们演示如何创建和解释帕累托图之前，让我们先谈谈帕累托图。帕累托图既是柱状图也是线形图，具有主要和次要的y轴。柱状图的长度通常代表频率，但它也可以代表时间、金钱或某种其他成本函数。柱状图通常垂直排列，并且必须按降序排列。而柱状图代表单位频率，线代表按百分比测量的累积频率；因此，线上的点对应于柱状图。
- en: 'A Pareto chart is essentially a quality control tool that provides a visual
    cue into causes and effects that are, more often than not, on the order of 80-20
    or at least nonlinear. For instance, a Pareto chart might show that 80% of application
    failures are caused by just 20% of the known bugs. To an application development
    manager prioritizing their team’s workload, that’s more than just an interesting
    tidbit of information—it’s an actionable insight. Here are some more examples
    to consider:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 帕累托图本质上是一种质量控制工具，它提供了一个视觉提示，揭示了原因和效果，这些原因和效果往往遵循80-20规则或至少是非线性的。例如，帕累托图可能显示80%的应用程序故障是由20%已知的错误引起的。对于一个优先考虑团队工作负载的应用程序开发经理来说，这不仅仅是一个有趣的信息片段——这是一个可操作的见解。以下是一些需要考虑的更多例子：
- en: A customer service manager is analyzing complaints. A Pareto chart might show
    that 80% of in-store complaints tie back to associate behavior and poor lighting,
    which when combined account for just 20% of all complaint types. This suggests
    that complaint volume can be reduced by as much as 80% merely by addressing these
    two areas.
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个客户服务经理正在分析投诉。帕累托图可能显示80%的店内投诉与员工行为和照明不佳有关，这两者加起来只占所有投诉类型的20%。这表明，仅通过解决这两个领域，投诉量可以减少多达80%。
- en: A call center supervisor is reviewing average speed to answer data that reveals
    daily breaches to self-imposed service levels. A Pareto analysis subsequently
    shows that 80% of the inbound calls with unacceptable average speeds to answer
    occur within just 20% of the 30-minute time intervals. The supervisor then knows
    when or where to staff up.
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一位呼叫中心主管正在审查平均应答速度数据，该数据显示了每日违反自我设定的服务水平。随后进行的帕累托分析显示，80%的平均应答速度不达标的来电发生在30分钟时间间隔的20%内。主管随后知道何时或何地增派人员。
- en: The principal of a car dealership is presented with a Pareto chart which shows
    that 80% of the vehicles are sold by just 20% of the salespeople. Now the manager
    knows which employees merit rewards and which employees may require additional
    sales training.
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一家汽车经销商的经理被展示了一个帕累托图，显示80%的车辆是由20%的销售人员销售的。现在经理知道哪些员工值得奖励，哪些员工可能需要额外的销售培训。
- en: An e-commerce director sees that 80% of their customer’s browsing time is spent
    on just 20% of the website pages; this tells the director where to stick most
    of the ads and how to charge for them.
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一位电子商务经理发现，他们的客户80%的浏览时间花在了网站的20%页面上；这告诉经理在哪里放置大部分广告以及如何收费。
- en: A Pareto chart might not always display 80-20 proportions, and that’s okay.
    It’s the *spirit* of the 80-20 rule that truly matters, which simply suggests
    that most outcomes have a small number of causes. That means many problems can
    be resolved, or at least mitigated, with lower effort levels.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 帕累托图不一定总是显示80-20的比例，这是可以的。真正重要的是80-20法则的*精神*，它仅仅建议大多数结果都有少数几个原因。这意味着许多问题可以通过较低的努力水平得到解决，或者至少得到缓解。
- en: We’ll now create a pair of Pareto charts that display relatively innocuous relationships
    between NBA franchises and games played and then games won. Our Pareto charts
    will be created from different R packages so you can choose the packages and the
    methods that work best for you.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将创建一对帕累托图，显示NBA球队和所玩游戏以及所赢游戏的相对无害的关系。我们的帕累托图将使用不同的R包创建，这样您可以选择最适合您的包和方法。
- en: 15.4.1 ggplot2 and ggQC packages
  id: totrans-96
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.4.1 ggplot2和ggQC包
- en: 'Our first of two Pareto charts is built from a combination of `ggplot2` and
    a package called `ggQC`, which can be used to create a number of quality control
    charts. We start by creating a data source for both Pareto charts. We call the
    `dplyr filter()` function to subset df1 where the variable `parent_child` doesn’t
    equal `child`, which also means we’re subsetting df1 where the same variable equals
    `parent` or `parent_only`:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的两个帕累托图中的第一个是由`ggplot2`和名为`ggQC`的包组合构建的，这个包可以用来创建多种质量控制图。我们首先为两个帕累托图创建数据源。我们调用`dplyr
    filter()`函数来对df1进行子集化，其中变量`parent_child`不等于`child`，这也意味着我们在对df1进行子集化，其中相同的变量等于`parent`或`parent_only`：
- en: '[PRE11]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Then, we run the `dim()` function from base R to get the row count from the
    data set we just created, df4:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们运行基础R中的`dim()`函数来获取我们刚刚创建的数据集df4的行数：
- en: '[PRE12]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Our data set contains 47 rows. The following chunk of `dplyr` code tallies
    the record counts by the variable `active_inactive`:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的数据集包含47行。以下`dplyr`代码块统计了变量`active_inactive`的记录数：
- en: '[PRE13]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: These results make perfect sense—the NBA now comprises 30 teams or franchises,
    so the fact that df4 contains 30 active franchises and 17 inactive franchises
    is the result we should have expected.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果完全合理——NBA现在由30支球队或分支机构组成，因此df4包含30个活跃的分支机构以及17个非活跃的分支机构是我们应该预期的结果。
- en: Our first Pareto chart (see figure 15.3) plots the number of games played for
    each of the 47 past and present NBA franchises (the bars) and the cumulative percentage
    of total games played (the line).
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第一张帕累托图（见图15.3）显示了47个过去和现在的NBA球队（条形图）所玩游戏的数量以及总游戏量的累积百分比（折线图）。
- en: '![CH15_F03_Sutton](../../OEBPS/Images/CH15_F03_Sutton.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![CH15_F03_Sutton](../../OEBPS/Images/CH15_F03_Sutton.png)'
- en: Figure 15.3 A Pareto chart built in `ggplot2` and `ggQC` that displays the nonlinear
    relationship between NBA franchises and games played
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.3 使用`ggplot2`和`ggQC`构建的帕累托图，显示了NBA球队和所玩游戏之间的非线性关系
- en: Because we’re creating a `ggplot2` visualization, we initialize our plot with
    the `ggplot()` function using df4, where the variable `games` is grouped by the
    variable `franchise`, as a data source. If we were to instead create our `ggplot2`
    Pareto chart without first piping `dplyr code` to the `ggplot()` function, our
    x-axis labels would not be properly sequenced.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我们正在创建`ggplot2`可视化，所以我们使用df4初始化我们的绘图，其中变量`games`按变量`franchise`分组，作为数据源。如果我们不先将`dplyr`代码通过管道传递到`ggplot()`函数，我们的x轴标签就不会正确排序。
- en: 'Our x-axis variable is `franchise`, and our primary y-axis variable is `games`.
    The `stat_pareto()` function from the `ggQC` package automatically draws a line
    that maps to a secondary y-axis. The x-axis labels are angled at 90 degrees for
    fit:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的自变量是`franchise`，而我们的主要y轴变量是`games`。`ggQC`包中的`stat_pareto()`函数会自动绘制一条映射到次要y轴的线。x轴标签以90度角倾斜以便于适配：
- en: '[PRE14]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'A few points bear mentioning:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 有几点需要提及：
- en: Our primary y-axis (on the left) represents all games played by all NBA franchises;
    if our 47 bars were stacked on top of each other instead of representing different
    ticks along the x-axis, the one bar would reach the exact same height as the line.
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的主要y轴（在左侧）代表所有NBA球队所进行的所有比赛；如果我们的47个条形堆叠在一起而不是代表x轴上的不同刻度，那么一个条形将达到与线相同的精确高度。
- en: Had we binned the 47 NBA franchises into, let’s say, 8 or 10 groups, we would,
    of course, have fewer, but much taller, bars. While this operation surely would
    have improved the aesthetics by eliminating much of the white space, it also would
    have camouflaged the results. Think of the Pareto chart for our fictional call
    center supervisor—binning the 30-minute increments into one-hour increments might
    conceal the results and, more significantly, make it that much more challenging
    to implement a corrective action plan.
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果我们将47个NBA球队分成，比如说，8或10组，我们当然会有更少的条形，但条形会更高。虽然这种操作无疑会通过消除大部分空白空间来改善美观，但它也会掩盖结果。想想我们虚构的呼叫中心主管的帕累托图——将30分钟的增量合并为一小时的增量可能会隐藏结果，更重要的是，使得实施纠正行动计划变得更加困难。
- en: The 80-20 rule isn’t in effect—20% of the active and inactive franchises participated
    in less than 50% of all NBA games between the 1946 and 2020 seasons, and 80% of
    the games played tie back to about 45% of all NBA franchises, past or present.
    But while the 80-20 rule isn’t in effect, the relationship between NBA franchises
    and games played is nevertheless nonlinear.
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 80-20法则并不适用——在1946年至2020赛季之间，活跃和停用的20%的球队参加了不到50%的所有NBA比赛，而80%的比赛都与大约45%的所有NBA球队有关，无论是过去还是现在。但尽管80-20法则并不适用，NBA球队和比赛之间的关系仍然是非线性的。
- en: 'Our Pareto chart—or any Pareto chart, for that matter—resembles a plot of diminishing
    returns. The law of diminishing returns says that, for instance, throwing additional
    headcount into a project that’s behind schedule will yield incrementally less
    benefit to the point where no value is gained from supplementary new hires. For
    another example, consider a multiple linear regression: we can throw more and
    more independent variables into a model, thereby increasing R², but meanwhile,
    the adjusted R² incrementally drops with each subsequent variable that adds zero
    predictive value. The active NBA franchises account for more than 98% of all NBA
    games played between 1946 and 2020; thus, we didn’t necessarily need the other
    17 franchises to get a comprehensive-enough read on the total games count.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的帕累托图——或者任何帕累托图——类似于递减回报的图表。递减回报定律指出，例如，将额外的人手投入到进度落后的项目中，将带来递减的收益，直到补充的新员工不再带来任何价值。另一个例子是多元线性回归：我们可以将更多的独立变量投入模型中，从而提高R²，但与此同时，随着每个添加零预测价值的后续变量，调整后的R²会递减。活跃的NBA球队在1946年至2020年之间占所有NBA比赛的98%以上；因此，我们并不一定需要其他17个球队来全面了解总比赛数。
- en: Pareto charts are mirror images of Lorenz curves (see chapters 12 and 13). One
    shows nonlinearity, and the other displays inequality, but at the end of the day,
    the two are more or less synonymous. Both nonlinearity and inequality represent
    departures from uniformity or linearity. Nonlinearity pertains to the deviation
    from a straight, proportional, or linear relationship, while inequality refers
    to the deviation from equal distribution or treatment.
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 帕累托图是洛伦兹曲线的镜像（参见第 12 章和第 13 章）。一个显示了非线性，另一个显示了不平等，但最终，这两个是或多或少同义的。非线性和不平等都代表了与均匀性或线性的偏离。非线性涉及对直线、比例或线性关系的偏离，而不平等则是指对平等分布或处理的偏离。
- en: Now, let’s move on to our second Pareto chart.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们继续我们的第二个帕累托图。
- en: 15.4.2 qcc package
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 15.4.2 qcc 包
- en: 'Our second and final Pareto chart uses the `pareto.chart()` function from the
    `qcc` package, which is yet another package that enables the build of quality
    control charts. This time, our purpose is to visualize the relationship between
    past and present NBA franchises with games won. What’s nice about the `pareto.chart()`
    function is that it not only draws a Pareto chart but also returns a tabular view
    of the data. Otherwise, take note of the following operations to trim our plot
    (see figure 15.4):'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二个也是最后一个帕累托图使用 `qcc` 包中的 `pareto.chart()` 函数，这是一个允许构建质量控制图的另一个包。这次，我们的目的是可视化过去和现在
    NBA 联盟之间通过赢得的比赛建立的关系。`pareto.chart()` 函数的优点是它不仅绘制了帕累托图，还返回了数据的表格视图。否则，请注意以下操作来修剪我们的图形（见图
    15.4）：
- en: We’ve added an x-axis label and defaulted both y-axis labels.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们添加了 x 轴标签，并默认了两个 y 轴标签。
- en: We’ve modified the color scheme for the bars, at least when viewed online, so
    that they resemble a heat index.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们已经修改了条形图的颜色方案，至少在线上看起来，使其类似于热指数。
- en: 'The `pareto.chart()` function takes a data set and a numeric variable as an
    argument; unlike `ggplot()`, it doesn’t allow us to set an x-axis variable. Consequently,
    the `pareto.chart()` function inserts a letter and number scheme for the x-axis
    labels that tie back to the tabular results. We then chose to remove those with
    the `xaxt` argument:'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pareto.chart()` 函数接受一个数据集和一个数值变量作为参数；与 `ggplot()` 不同，它不允许我们设置 x 轴变量。因此，`pareto.chart()`
    函数插入了一个字母和数字方案，用于 x 轴标签，这些标签与表格结果相关联。然后我们选择使用 `xaxt` 参数来移除这些标签：'
- en: '[PRE15]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![CH15_F04_Sutton](../../OEBPS/Images/CH15_F04_Sutton.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![CH15_F04_Sutton](../../OEBPS/Images/CH15_F04_Sutton.png)'
- en: Figure 15.4 A Pareto chart built with the `gcc` package that displays a similar
    nonlinear relationship with respect to games won, followed by a tabular view of
    the data, both of which are simultaneously produced with the same code base
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.4 使用 `gcc` 包构建的帕累托图，显示了与赢得的比赛相关的类似非线性关系，随后是数据的表格视图，这两者都是使用相同的代码库同时生成的
- en: While the aesthetics are obviously different from our first Pareto chart, the
    results aren’t so different—between the 1946 and 2020 NBA seasons, 20% of the
    active and inactive franchises won approximately 45% of all the games played,
    and 80% of the games won tie back to roughly 42% of all past and present franchises.
    Again, no 80-20 rule is in effect, but there is more nonlinearity nonetheless.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然美学上显然与我们的第一个帕累托图不同，但结果并没有那么不同——在 1946 年和 2020 年 NBA 赛季之间，大约 20% 的活跃和非活跃联盟赢得了所有比赛的
    45%，而赢得的 80% 的比赛都与大约 42% 的过去和现在联盟相关联。再次强调，没有 80-20 规则，但仍然存在更多的非线性。
- en: In the next chapter, we’ll consider the possibility that randomness might actually
    be present when others see causality.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将考虑当其他人看到因果关系时，随机性可能实际上确实存在的可能性。
- en: Summary
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: It’s impossible to understand most cause-and-effect relationships without first
    understanding the 80-20 rule.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在理解 80-20 规则之前，很难理解大多数因果关系。
- en: The 80-20 rule is really a euphemism for nonlinearity; after all, 80% of outcomes
    don’t always map to 20% of root causes. That much of the world is nevertheless
    nonlinear to *some* extent, and therefore untidy, must be understood and accepted
    to then trigger the right sort of analysis.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 80-20 规则实际上是对非线性的一种委婉说法；毕竟，80% 的结果并不总是映射到 20% 的根本原因。然而，世界上的许多方面在某种程度上是非线性的，因此是杂乱的，必须理解和接受，然后才能触发正确的分析类型。
- en: Pareto charts are a best solution for visualizing causes and effects and enabling
    “best-bang-for-the-buck” corrective actions.
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 帕累托图是可视化原因和效果以及实现“物有所值”的纠正措施的最佳解决方案。
- en: R provides a plethora of options for Pareto chart creation, including built-in
    functions and `ggplot2` without extensions. We demonstrated just two of the best
    options.
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R提供了大量创建帕累托图的选项，包括内置函数和`ggplot2`（无需扩展）。我们仅展示了其中两种最佳选项。
- en: In the process, we also demonstrated that the relationships between NBA franchises
    and games played and won are both nonlinear.
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在此过程中，我们还证明了NBA球队与比赛进行和赢得的关系都是非线性的。
- en: 'We introduced new visualization techniques: violin plots as yet another alternative
    for graphically displaying the distribution of continuous data, and then paired
    histograms within the same plot.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们介绍了新的可视化技术：小提琴图作为图形显示连续数据分布的另一种选择，然后在同一图表中配对直方图。
