- en: Appendix B. Solutions to exercises
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 B. 练习题解答
- en: Exercise 1.1
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 练习题 1.1
- en: Choose an infrastructure script or configuration in your organization. Assess
    whether it adheres to the principles of IaC. Does it promote reproducibility,
    use idempotency, help with composability, and ease evolvability?
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的组织中选择一个基础设施脚本或配置。评估它是否遵循 IaC 原则。它是否促进可重复性、使用幂等性、帮助组合性和简化可进化性？
- en: 'Answer:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: 'You can use the following steps to identify whether your script of configuration
    follows IaC principles:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用以下步骤来识别您的脚本或配置是否遵循 IaC 原则：
- en: '*Reproducibility*—Copy and paste the script or configuration, share it with
    someone else, and ask them to create the resources without modifying or changing
    the configuration.'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*可重复性*—复制并粘贴脚本或配置，与他人分享，并要求他们创建资源，而无需修改或更改配置。'
- en: '*Idempotency*—Run the script a few times. It should not change your infrastructure.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*幂等性*—运行脚本几次。它不应该改变您的基础设施。'
- en: '*Composability*—Copy a portion of the configuration and build it on top of
    other infrastructure resources.'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*组合性*—复制配置的一部分，并在其他基础设施资源之上构建它。'
- en: '*Evolvability*—Add a new infrastructure resource to the configuration and verify
    that you can make changes without affecting other resources.'
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*可进化性*—向配置中添加一个新的基础设施资源，并验证您是否可以在不影响其他资源的情况下进行更改。'
- en: Exercise 2.1
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 练习题 2.1
- en: Does the following use the imperative or declarative style of configuring infrastructure?
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配置基础设施是使用命令式还是声明式风格？
- en: '[PRE0]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Answer:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: The code snippet uses the *imperative* style of configuring infrastructure.
    It defines how to configure a server *step-by-step* in a specific sequence rather
    than declaring a specific target configuration.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 代码片段使用配置基础设施的*命令式*风格。它定义了如何以特定顺序逐步配置服务器，而不是声明特定的目标配置。
- en: Exercise 2.2
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 练习题 2.2
- en: Which of the following changes benefit from the principle of immutability? (Choose
    all that apply.)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 以下哪些更改受益于不可变性的原则？（选择所有适用的选项。）
- en: A) Reducing a network to have fewer IP addresses
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: A) 减少网络以拥有更少的 IP 地址
- en: B) Adding a column to a relational database
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: B) 向关系数据库添加列
- en: C) Adding a new IP address to an existing DNS entry
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: C) 向现有的 DNS 条目添加新的 IP 地址
- en: D) Updating a server’s packages to backward-incompatible versions
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: D) 将服务器的软件包更新到向后不兼容的版本
- en: E) Migrating infrastructure resources to another region
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: E) 将基础设施资源迁移到另一个区域
- en: 'Answer:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: The correct answers are A, D, and E. Each change benefits from a new set of
    resources that implement the change. If you try to make the changes in place,
    you may accidentally bring down the existing system. For example, reducing a network
    to have fewer IP addresses may displace any resources using the network.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 正确答案是 A、D 和 E。每个更改都受益于一组实现更改的新资源。如果您尝试就地更改，可能会意外地关闭现有系统。例如，减少网络以拥有更少的 IP 地址可能会替换使用该网络的任何资源。
- en: Updating packages to backward-incompatible versions means that a broken package
    update can affect the server’s ability to handle user requests. Migrating infrastructure
    resources to another region takes time. Not all cloud provider regions support
    every type of resource. Creating new resources helps mitigate problems with migration.
    You can make changes for answers B and C mutably, likely without affecting the
    system.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 将软件包更新到向后不兼容的版本意味着一个损坏的包更新可能会影响服务器处理用户请求的能力。将基础设施资源迁移到另一个区域需要时间。并非所有云服务提供商的区域都支持每种类型的基础设施资源。创建新的资源有助于减轻迁移问题。您可以对答案
    B 和 C 进行可变更改，可能不会影响系统。
- en: Exercise 3.1
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 练习题 3.1
- en: To which module pattern(s) does the following IaC apply? (Choose all that apply.)
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 以下 IaC 应用于哪些模块模式？（选择所有适用的选项。）
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: A) Factory
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: A) 工厂
- en: B) Singleton
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: B) 单例
- en: C) Prototype
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: C) 原型
- en: D) Builder
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: D) 构造器
- en: E) Composite
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: E) 组合
- en: 'Answer:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: The infrastructure as code applies A, C, and E. The network module uses the
    composite pattern to compose a subnet and a network. The tag module uses the prototype
    pattern to return status metadata. The server module uses the factory pattern
    to return a single server based on name, network, and tags.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 基础设施即代码适用于 A、C 和 E。网络模块使用组合模式来组合子网和网络。标签模块使用原型模式来返回状态元数据。服务器模块使用工厂模式根据名称、网络和标签返回单个服务器。
- en: The code does not use singleton or builder patterns. It does not create singular
    global resources or internal logic to build specific resources.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 代码不使用单例或构造器模式。它不创建单一的全局资源或内部逻辑来构建特定资源。
- en: Exercise 4.1
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 练习题 4.1
- en: How can we better decouple the database’s dependency on the network via the
    following IaC?
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们如何通过以下IaC更好地解耦数据库对网络的依赖？
- en: '[PRE2]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: A) The approach adequately decouples the database from the network.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: A) 该方法充分解耦了数据库和网络。
- en: B) Pass the network ID as a variable instead of hardcoding it as `default`.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: B) 将网络ID作为变量传递，而不是将其硬编码为`default`。
- en: C) Implement and pass a `NetworkOutput` object to the database module for all
    network attributes.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: C) 为所有网络属性实现并传递一个`NetworkOutput`对象到数据库模块。
- en: D) Add a function to the network module to push its network ID to the database
    module.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: D) 向网络模块添加一个函数，将其网络ID推送到数据库模块。
- en: E) Add a function to the database module to call the infrastructure API for
    the `default` network ID.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: E) 向数据库模块添加一个函数来调用`default`网络ID的基础设施API。
- en: 'Answer:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: You can implement the adapter pattern to output the network attributes (C).
    The database chooses which network attributes it uses, such as network ID or CIDR
    block. This approach best follows the principle of dependency injection. While
    D does implement dependency inversion, it does not implement inversion of control.
    Answer E does implement dependency injection but continues to hardcode the network
    ID.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以实现适配器模式来输出网络属性（C）。数据库选择它使用的网络属性，例如网络ID或CIDR块。这种方法最好遵循依赖注入的原则。虽然D实现了依赖反转，但它没有实现控制反转。答案E实现了依赖注入，但继续硬编码网络ID。
- en: Exercise 6.1
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 练习6.1
- en: You notice that a new version of a load balancer module is breaking your DNS
    configuration. A teammate updated the module to output private IP addresses instead
    of public IP addresses. What can you do to help your team better remember the
    module needs public IP addresses?
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 你注意到负载均衡器模块的新版本破坏了你的DNS配置。一个队友更新了模块，使其输出私有IP地址而不是公共IP地址。你能做些什么来帮助你的团队更好地记住模块需要公共IP地址？
- en: A) Create a separate load balancer module for private IP addresses.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: A) 为私有IP地址创建一个单独的负载均衡器模块。
- en: B) Add module contract tests to verify that the module outputs both private
    and public IP addresses.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: B) 添加模块合同测试以验证模块输出私有和公共IP地址。
- en: C) Update the module’s documentation with a note that it needs public IP addresses.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: C) 在模块的文档中添加一个备注，说明它需要公共IP地址。
- en: D) Run integration tests on the module and check the IP address is publicly
    accessible.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: D) 在模块上运行集成测试并检查IP地址是否公开可访问。
- en: 'Answer:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: Rather than creating a new module, you can add a contract test to help the team
    remember that high-level resources need both private and public IP addresses (B).
    You could create a separate load balancer module (A). However, it may not help
    your team remember that specific modules must output specific variables. Updating
    the module’s documentation (C) means that your team must remember to read the
    documentation first. Integration tests have a time and financial cost for running
    (D) when contract tests adequately solve the problem.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 而不是创建一个新的模块，你可以添加一个合同测试来帮助团队记住高级资源需要私有和公共IP地址（B）。你可以创建一个单独的负载均衡器模块（A）。然而，这可能不会帮助你的团队记住特定模块必须输出特定的变量。更新模块的文档（C）意味着你的团队必须记得首先阅读文档。当合同测试足够解决问题时，集成测试运行的时间和财务成本（D）可能不会帮助。
- en: Exercise 6.2
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 练习6.2
- en: You add some firewall rules to allow an application to access a new queue. Which
    combination of tests would be most valuable to your team for the change?
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 你添加了一些防火墙规则以允许应用程序访问一个新的队列。对于这个变更，以下哪种测试组合对你的团队最有价值？
- en: A) Unit and integration tests
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: A) 单元和集成测试
- en: B) Contract and end-to-end tests
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: B) 合同和端到端测试
- en: C) Contract and integration tests
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: C) 合同和集成测试
- en: D) Unit and end-to-end tests
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: D) 单元和端到端测试
- en: 'Answer:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: The two most valuable tests would be unit and end-to-end tests (D). Unit tests
    will help ensure that someone doesn’t remove the new rules going forward. End-to-end
    tests check that the application can access the queue successfully. Contract tests
    would not provide any help because you do not need to test inputs and outputs
    for firewall rules.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 两个最有价值的测试是单元和端到端测试（D）。单元测试将帮助确保没有人会删除新的规则。端到端测试检查应用程序是否可以成功访问队列。合同测试不会提供任何帮助，因为你不需要测试防火墙规则输入和输出。
- en: Exercise 7.1
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 练习7.1
- en: Choose a standard infrastructure change in your organization. What do you need
    in order to confidently continuously deliver the change to production? What about
    continuous deployment? Outline or diagram stages in your delivery pipelines for
    both.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 选择您组织中的一个标准基础设施更改。为了自信地持续将更改交付到生产，您需要什么？关于持续部署呢？概述或绘制您的交付管道中的阶段。
- en: 'Answer:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: 'As you go through this exercise, consider the following:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行此练习时，请考虑以下问题：
- en: Do you have unit, integration, or end-to-end tests?
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您是否有单元测试、集成测试或端到端测试？
- en: What kind of branching model do you use?
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您使用哪种分支模型？
- en: Does your company have compliance requirements? For example, two people must
    approve the change before production.
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您的公司是否有合规性要求？例如，在生产前必须两人批准更改。
- en: What happens when someone needs to make a change?
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当有人需要做出更改时会发生什么？
- en: Exercise 9.1
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 练习9.1
- en: 'Consider the following code:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下代码：
- en: '[PRE3]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The queue depends on the network. The server depends on the network and queue.
    How would you run a blue-green deployment to upgrade the queue with SSL?
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 队列依赖于网络。服务器依赖于网络和队列。您将如何运行带有SSL升级的蓝绿部署？
- en: 'Answer:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: You create a `green` queue with SSL enabled. Then, you create a new `green`
    server that depends on the queue. Test that the application on the green server
    can access the queue with the SSL configuration. If it passes, you can add the
    green server to the load balancer. Gradually send traffic through the green server
    by using a canary deployment until you confirm that all requests succeed. Then,
    you remove the original server and queue.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 您创建了一个启用SSL的`绿色`队列。然后，您创建了一个新的`绿色`服务器，该服务器依赖于队列。测试绿色服务器上的应用程序是否可以使用SSL配置访问队列。如果通过，您可以将绿色服务器添加到负载均衡器。通过使用金丝雀部署逐渐将流量发送到绿色服务器，直到您确认所有请求都成功。然后，您移除原始服务器和队列。
- en: Optionally, you can omit the step creating the green server and send traffic
    from the original server to SSL. However, this approach may not allow you to run
    a canary deployment. You update the server’s configuration to directly communicate
    with the new queue.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 可选地，您可以选择省略创建绿色服务器的步骤，并将流量从原始服务器发送到SSL。然而，这种方法可能无法运行金丝雀部署。您更新服务器的配置以直接与新的队列通信。
- en: Exercise 10.1
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 练习10.1
- en: Given the following code, what order and grouping of resources would you use
    to refactor and break down the monolith?
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 给定以下代码，您会使用什么顺序和资源分组来重构和分解单体应用？
- en: '[PRE4]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: A) DNS, load balancer, servers, database, network + subnets, project
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: A) DNS，负载均衡器，服务器，数据库，网络+子网，项目
- en: B) Load balancer + DNS, database, servers, network + subnets, project
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: B) 负载均衡器+DNS，数据库，服务器，网络+子网，项目
- en: C) Project, network + subnets, servers, database, load balancer + DNS
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: C) 项目，网络+子网，服务器，数据库，负载均衡器+DNS
- en: D) Database, load balancer + DNS, servers, network + subnets, project
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: D) 数据库，负载均衡器+DNS，服务器，网络+子网，项目
- en: 'Answer:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: 'The order and grouping that mitigates the risk of refactor starts with DNS
    and proceeds with the load balancer, queue, database, servers, network and subnets,
    and project (A). You want to start with DNS as the highest-level dependency and
    evolve it separately from the load balancer, since the load balancer requires
    project and network attributes. Refactor the next resources as follows: the servers,
    database, network, and project.'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 减少重构风险的顺序和分组从DNS开始，然后是负载均衡器、队列、数据库、服务器、网络和子网，以及项目（A）。您希望从DNS作为最高级依赖项开始，并独立于负载均衡器进行演变，因为负载均衡器需要项目和网络属性。以下是对下一组资源的重构：服务器、数据库、网络和项目。
- en: You refactor the servers before the database because servers do not manage data
    directly but depend on the database. If you do not feel confident that you can
    refactor the database, at least you’ve moved the servers out of the monolith!
    You can always leave the database in the monolith with the network and project.
    Refactoring the bulk of resources out of the monolith sufficiently decouples the
    system to scale.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 您在数据库之前重构服务器，因为服务器不直接管理数据，而是依赖于数据库。如果您对重构数据库没有信心，至少您已经将服务器从单体应用中移除！您总是可以将数据库、网络和项目留在单体应用中。将大部分资源从单体应用中移除可以充分解耦系统以进行扩展。
- en: Exercise 11.1
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 练习11.1
- en: A team reports that that its application can no longer connect to another application.
    The application worked last week, but requests have failed since Monday. The team
    has made no changes to its application and suspects the problem may be a firewall
    rule. Which steps can you take to troubleshoot the problem? (Choose all that apply.)
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 一个团队报告说，它的应用程序无法再连接到另一个应用程序。该应用程序上周工作正常，但自周一以来请求失败。团队没有对其应用程序进行任何更改，并怀疑问题可能是防火墙规则。你可以采取哪些步骤来解决这个问题？（选择所有适用的。）
- en: A) Log into the cloud provider and check the firewall rules for the application.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: A) 登录云提供商并检查应用程序的防火墙规则。
- en: B) Deploy new infrastructure and applications to a green environment for testing.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: B) 将新的基础设施和应用程序部署到绿色环境进行测试。
- en: C) Examine the changes in IaC for the application.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: C) 检查应用程序的IaC中的变化。
- en: D) Compare the firewall rules in the cloud provider with IaC.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: D) 将云提供商中的防火墙规则与IaC进行比较。
- en: E) Edit the firewall rules and allow all traffic between the applications.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: E) 编辑防火墙规则，允许应用程序之间的所有流量。
- en: 'Answer:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: The steps are A, C, and D. You can troubleshoot by checking for any drift in
    firewall rules. If you do not find drift, you can search the IaC running the application
    for other discrepancies. From a troubleshooting perspective, this problem may
    not need a new environment for testing or allowing all traffic between applications.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 步骤是A、C和D。你可以通过检查防火墙规则中的任何漂移来进行故障排除。如果没有发现漂移，你可以在运行应用程序的IaC中搜索其他差异。从故障排除的角度来看，这个问题可能不需要新的测试环境或允许应用程序之间的所有流量。
- en: Exercise 12.1
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 练习12.1
- en: Given the following code, which of the following statements are true? (Choose
    all that apply.)
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 给定以下代码，以下哪些陈述是正确的？（选择所有适用的。）
- en: '[PRE5]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: A) The test will pass because the cost of the database is within the budget.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: A) 测试将通过，因为数据库的成本在预算内。
- en: B) The test estimates the monthly cost of databases.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: B) 测试估计数据库的月度成本。
- en: C) The test does not account for different database types.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: C) 测试没有考虑不同的数据库类型。
- en: D) The test calculates the monthly cost per database instance.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: D) 测试计算每个数据库实例的月度成本。
- en: E) The test includes a buffer of 10% for any cost overage as a soft mandatory
    policy.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: E) 测试包括10%的成本超支缓冲作为软强制性政策。
- en: 'Answer:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: The answers are B, C, and E. The total estimated cost of the databases per month
    is $7,300, while the monthly budget with a 10% buffer is $5,500, which means the
    test fails. The test itself does not account for different database types or calculate
    monthly cost per database instance. It calculates based on the hourly rate and
    the number of databases. Adding a 10% buffer to the monthly budget creates a soft
    mandatory policy for the budget. Small changes that result in minor cost overage
    will reduce the friction of delivery to production but flag any major cost changes.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 答案是B、C和E。数据库每月的总估计成本为7,300美元，而包含10%缓冲的月度预算为5,500美元，这意味着测试失败。测试本身没有考虑不同的数据库类型或计算每个数据库实例的月度成本。它是基于每小时率和数据库数量进行计算的。将10%的缓冲添加到月度预算中为预算创建了一个软强制性政策。导致轻微成本超支的小变化将减少将产品交付到生产中的摩擦，但会标记任何重大的成本变化。
- en: Exercise 12.2
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 练习12.2
- en: 'Imagine you have three servers. You examine their utilization and notice the
    following:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你有三个服务器。你检查它们的利用率，并注意到以下情况：
- en: You need one server to serve the minimum traffic.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要一个服务器来处理最小流量。
- en: You need three servers to serve the maximum traffic.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你需要三个服务器来处理最大流量。
- en: The server handles traffic 24 hours a day, seven days a week.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器每天24小时、每周7天都在处理流量。
- en: What can you do to optimize the cost of the servers for the next month?
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 你下个月可以采取哪些措施来优化服务器的成本？
- en: A) Schedule the resources to stop on the weekends.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: A) 安排资源在周末停止。
- en: B) Add an `autoscaling_policy` to scale based on memory.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: B) 添加`autoscaling_policy`以根据内存进行扩展。
- en: C) Set an expiration of three hours for all servers.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: C) 为所有服务器设置三小时的过期时间。
- en: D) Change the servers to smaller CPU and memory machine types.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: D) 将服务器更改为较小的CPU和内存机器类型。
- en: E) Migrate the application to containers and pack applications more densely
    on servers.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: E) 将应用程序迁移到容器中，并在服务器上更密集地打包应用程序。
- en: 'Answer:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: You can add an `autoscaling_policy` to scale based on memory (B). You cannot
    schedule a resource stop on weekends because you need at least one server on weekends.
    Setting an expiration or downsizing the servers does not help with cost in this
    situation. Migrating applications to containers involves a long-term solution
    that will not optimize cost for the next month.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以添加一个`autoscaling_policy`来根据内存进行扩展（B）。您不能在周末安排资源停止，因为您周末至少需要一个服务器。设置过期时间或缩减服务器规模在这种情况下并不能帮助降低成本。将应用程序迁移到容器涉及一个长期的解决方案，这不会优化下一个月的成本。
