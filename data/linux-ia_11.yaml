- en: Chapter 12\. Sharing data over a private network
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第12章\. 在私有网络上共享数据
- en: '*This chapter covers*'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '*本章涵盖*'
- en: Sharing documents with Network File System (NFS)
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用网络文件系统（NFS）共享文档
- en: Fine-tuning restricted access to an NFS share
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 微调对NFS共享的受限访问
- en: Automating remote file shares using /etc/fstab
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 /etc/fstab 自动化远程文件共享
- en: Securing and encrypting NFS shares
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保护并加密NFS共享
- en: Configuring Samba for sharing files with Windows clients
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为与Windows客户端共享文件配置Samba
- en: Organizing your system resources with symbolic and hard links
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用符号链接和硬链接组织系统资源
- en: If you read [chapter 8](kindle_split_016.xhtml#ch08) then you’re already up
    to speed with using Nextcloud to share files between clients over insecure networks
    like the internet. But for trusted local networks, there are simpler ways to collaborate
    that are more deeply integrated into the Linux file system itself.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经阅读了[第8章](kindle_split_016.xhtml#ch08)，那么你已经熟悉了如何使用Nextcloud在互联网等不安全网络上共享文件。但对于受信任的本地网络，有更简单的方法进行协作，这些方法与Linux文件系统本身更加紧密地集成。
- en: I’m not suggesting that you can only do this locally. It’s possible to fully
    encrypt and secure file system-based sharing tools to safely use them over the
    internet, but doing it right is not going to be easy. And the particular strengths
    of these tools are best exploited closer to home.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我并不是建议你只能在本地做这件事。完全加密和确保基于文件系统的共享工具的安全性，以便在互联网上安全使用是可能的，但正确地做到这一点并不容易。而且，这些工具的特定优势最好在更接近家的环境中发挥。
- en: 'In this chapter, you’re going to learn how to expose carefully defined parts
    of a server’s file system to allow remote trusted clients to collaborate on files
    and documents. You won’t need to create a separate document store the way you
    did for Nextcloud, as your clients will be able to access the documents where
    they are in their native locations. This can be useful in a number of common scenarios:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你将学习如何将服务器文件系统中精心定义的部分暴露出来，以便远程受信任的客户端可以协作处理文件和文档。你不需要像Nextcloud那样创建一个单独的文档存储，因为你的客户端将能够访问它们在本地位置的文档。这在许多常见场景中可能很有用：
- en: You want workers to be able to log in to any physical workstation throughout
    the building and have instant access to the files in their own home directories.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你希望工作人员能够登录到建筑内任何物理工作站，并立即访问他们自己的家目录中的文件。
- en: You want to make specific data collections available to the members of appropriate
    teams, wherever they might be.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你希望将特定的数据集合提供给适当团队的成员，无论他们可能在何处。
- en: You want to provide full document read/write access to some remote workers,
    but read-only access to others.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你希望为一些远程工作人员提供完整的文档读写访问权限，但为其他人提供只读访问权限。
- en: A bit later we’ll look at setting up Samba, which is the tool of choice for
    sharing Linux-based documents with Windows clients. But most of our attention
    will be focused on using NFS to permit integrated collaboration among Linux systems.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 稍后我们将探讨设置Samba的方法，这是与Windows客户端共享基于Linux文档的首选工具。但我们的大部分注意力将集中在使用NFS允许Linux系统之间集成协作。
- en: 12.1\. Sharing files through Network File System (NFS)
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1\. 通过网络文件系统（NFS）共享文件
- en: Time to get stuff done. Just how do individuals share full access to documents
    across a network? As represented in [figure 12.1](#ch12fig01), NFS works by allowing
    clients to mount specific directories hosted on a remote server as though they
    were local partitions. Once mounted, the contents of those directories will be
    visible on the client system both at the command-line level and from the desktop
    GUI.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 完成事情的时间。个人如何通过网络共享对文档的完全访问权限？如图12.1所示，NFS通过允许客户端将远程服务器上托管的特定目录挂载为本地分区来实现。一旦挂载，这些目录的内容将在客户端系统上可见，无论是在命令行级别还是在桌面GUI中。
- en: Figure 12.1\. A mounted file share will appear like a local resource on the
    remote client.
  id: totrans-17
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图12.1\. 挂载的文件共享将像远程客户端上的本地资源一样出现。
- en: '![](Images/12fig01.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/12fig01.jpg)'
- en: 'Back in [chapter 6](kindle_split_014.xhtml#ch06), you learned how to mount
    a peripheral media drive to allow access from the file system. Here’s a reminder:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第6章](kindle_split_014.xhtml#ch06)中，你学习了如何挂载外围媒体驱动器以允许从文件系统访问。这里是一个提醒：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You’re going to use the `mount` command here too, but this time to mount the
    directories from the remote NFS server as a local partition. We’ve got some business
    to take care of before we get there, though. Here, step by step, is how it’s going
    to go:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 你将在这里使用`mount`命令，但这次是将远程NFS服务器上的目录挂载为本地分区。不过，在我们到达那里之前，还有一些事情要做。以下是如何一步一步进行的：
- en: Install NFS on the server.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在服务器上安装NFS。
- en: Define client access to server resources through the /etc/exports file.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过 /etc/exports 文件定义客户端对服务器资源的访问。
- en: Update NFS on the server.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新服务器上的NFS。
- en: Install NFS on the client.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在客户端安装NFS。
- en: Mount an NFS share.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 挂载NFS共享。
- en: Configure the NFS share to mount at boot time.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置NFS共享在启动时挂载。
- en: Open any firewalls you’ve got running (if necessary).
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开你正在运行的任何防火墙（如果需要）。
- en: 12.1.1\. Setting up the NFS server
  id: totrans-29
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 12.1.1. 设置NFS服务器
- en: Let me show you how to share home directories on your server so that multiple
    users will be able to access the contents remotely. For a CentOS server, the package
    you’re looking to install is nfs-utils. On Ubuntu, that’ll be nfs-kernel-server.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 让我向你展示如何在你的服务器上共享家目录，以便多个用户可以远程访问内容。对于CentOS服务器，你想要安装的包是 nfs-utils。在Ubuntu上，那将是
    nfs-kernel-server。
- en: '|  |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: Note
  id: totrans-32
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: It may be possible to install NFS server software on an LXC container and trick
    it into thinking it has sufficient access to the kernel to run properly, but I
    suspect it won’t be worth your time. If you want to virtualize this exercise,
    stick with VirtualBox.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在LXC容器上安装NFS服务器软件并欺骗它认为它有足够的内核访问权限来正常运行可能是可能的，但我怀疑这不会值得你花费时间。如果你想虚拟化这个练习，请坚持使用VirtualBox。
- en: '|  |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: 'Either way, the configuration file you’re going to work with is called exports,
    and it lives in the /etc/ directory. On Ubuntu at least, the file comes with a
    number of useful example directives, each disabled with the `#` comment character.
    For our simple example (and assuming the IP address used by your client computer
    is 192.168.1.11), this is the only active line that file will need:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 无论哪种方式，你将要工作的配置文件叫做 exports，它位于 /etc/ 目录下。至少在Ubuntu上，该文件包含了一些有用的示例指令，每个指令都通过
    `#` 注释字符禁用。对于我们的简单示例（并且假设你的客户端计算机使用的IP地址是 192.168.1.11），这是文件中唯一的活动行：
- en: '[PRE1]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Let’s break that down:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分解一下：
- en: '`/home` tells NFS that you want to expose the /home directory on the server
    along with all its subdirectories. As long as you don’t unnecessarily expose sensitive
    system or personal data, you’re free to expose any directories you like.'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home` 告诉NFS你想要在服务器上公开 /home 目录及其所有子目录。只要你不无谓地公开敏感的系统或个人数据，你可以自由地公开你喜欢的任何目录。'
- en: '`192.168.1.11` is the IP address of the NFS client you want to let in.'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`192.168.1.11` 是你想要允许进入的NFS客户端的IP地址。'
- en: '`rw` assigns that client both read and write permissions on the files in the
    exposed directories.'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rw` 为该客户端分配了在暴露目录中的文件上的读写权限。'
- en: '`sync` maintains a stable environment by writing changes to disk before replying
    to remote requests.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sync` 通过在回复远程请求之前将更改写入磁盘来维护一个稳定的环境。'
- en: The default NFS values include `ro` (read-only, meaning write operations are
    blocked) and `root_squash` (remote client users aren’t permitted to perform actions
    on the server as root, no matter what status they have on their own systems).
    Both settings provide protection for the server and its files. If you’re trying
    to open up some resources to serve as a kind of knowledge library, then the defaults
    will work best.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 默认的NFS值包括 `ro`（只读，意味着阻止写操作）和 `root_squash`（远程客户端用户不允许以root身份在服务器上执行操作，无论他们在自己的系统上有什么状态）。这两个设置都为服务器及其文件提供了保护。如果你试图开放一些资源作为某种知识库，那么默认设置将是最合适的。
- en: 'If you wanted to override the `root_squash` default and permit `root` actions
    to remote users, you would add the `no_root_squash` value. Although potentially
    a serious security vulnerability, `no_root_squash` can sometimes be necessary
    when you need your client users to perform administrative work on system files.
    Here’s how that would look:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要覆盖 `root_squash` 默认设置并允许远程用户执行 `root` 操作，你可以添加 `no_root_squash` 值。尽管可能是一个严重的安全漏洞，但在你需要客户端用户对系统文件执行管理任务时，`no_root_squash`
    有时可能是必要的。下面是这样的样子：
- en: '[PRE2]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Based on the use-case scenario that provides a single network-based home directory
    hierarchy for all the users in your company, you’ll want to open up access to
    more than just one client. This next example will permit anyone coming from anywhere
    on the local network to mount and use the server’s /home/ directory. It assumes
    that there’s no one you don’t trust with access to the 192.168.1.0 network. If,
    however, that network is accessible from a WiFi service you provide visitors to
    your business, then this might not be a good idea:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 根据为贵公司所有用户提供单一基于网络的home目录层次结构的用例场景，你可能希望为不仅仅是单个客户端开放访问权限。接下来的示例将允许来自本地网络任何地方的人挂载并使用服务器的/home/目录。它假设你信任所有访问192.168.1.0网络的人。然而，如果这个网络可以通过你为商务访客提供的WiFi服务访问，那么这可能不是一个好主意：
- en: '[PRE3]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: If you’re confused about what that `255.255.255.0` might be doing and how all
    these network structures work, [section 14.1](kindle_split_022.xhtml#ch14lev1sec1)
    should set you straight.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你对于`255.255.255.0`可能的作用以及所有这些网络结构是如何工作的感到困惑，[第14.1节](kindle_split_022.xhtml#ch14lev1sec1)应该能让你明白。
- en: '|  |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-49
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: Once again, spelling counts in Linux—and punctuation, too. Be aware that `192.168.1.11
    (rw,sync)` means that a client from 192.168.1.11 will get read/write permissions.
    But adding a space so that the directive reads `192.168.1.11 (rw,sync)` would
    give anyone in the world `rw` rights, and clients logging in from the 192.168.1.11
    IP address the default read-only rights!
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，在Linux中拼写很重要——标点符号也同样重要。请注意，`192.168.1.11 (rw,sync)`表示来自192.168.1.11的客户端将获得读写权限。但是，如果在这个指令中添加一个空格，使其变为`192.168.1.11
    (rw,sync)`，那么世界上任何地方的人都将获得`rw`权限，而来自192.168.1.11 IP地址的客户端将默认只有只读权限！
- en: '|  |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 'When you finish editing the exports file, you’ll need to run `exportfs` to
    force NFS to adopt your new settings. You’ll probably see a notice telling you
    that subtree checking is disabled by default. This is a change to the default
    behavior because, for most modern use cases, it’s generally not worth the trouble:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 当你完成编辑exports文件后，你需要运行`exportfs`来强制NFS采用你的新设置。你可能会看到一个通知告诉你默认禁用了子树检查。这是对默认行为的更改，因为对于大多数现代用例，这通常不值得麻烦：
- en: '[PRE4]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '***1* The r flag tells exportfs to synchronize the file systems, and the flag
    a applies the action to all directories.**'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* r标志告诉exportfs同步文件系统，而a标志将操作应用于所有目录。**'
- en: If you’re interested, subtree checking when enabled is used to ensure that file
    use is consistent with the policies governing both server-based file systems and
    exported trees.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你感兴趣，当启用时，子树检查用于确保文件使用与基于服务器的文件系统和导出的树所遵循的政策保持一致。
- en: 'You can view any NFS file systems currently exposed to clients using `exportfs`:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用`exportfs`查看当前向客户端公开的所有NFS文件系统：
- en: '[PRE5]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'To make it easy to test your share from the client end, create a new file in
    your home directory on the server, and add some text. If you’re running your NFS
    server on CentOS, don’t forget to open the firewall (which comes fully operational
    by default) and start NFS (which will be stopped by default). And here’s how that
    would look:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 为了便于从客户端测试共享，在服务器上的家目录中创建一个新文件，并添加一些文本。如果你在CentOS上运行NFS服务器，别忘了打开防火墙（默认完全启用）并启动NFS（默认停止）。以下是这样做的外观：
- en: '[PRE6]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: You’re now ready to set up NFS on a client computer. Learn all about that next.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在可以开始在一台客户端计算机上设置NFS了。关于这一点，你将在下一节中详细了解。
- en: 12.1.2\. Setting up the client
  id: totrans-61
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 12.1.2\. 设置客户端
- en: 'Things are fast and easy from the client side. Install the same nfs-utils package
    you used for the server on CentOS, and nfs-common for Ubuntu. Just two more steps
    from here. First, create a new directory where you’ll mount the remote file system.
    Then mount it using the NFS server’s IP address and the file system address you
    exposed in the server’s /etc/export configuration file:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 从客户端来看，事情变得快速且简单。在CentOS上安装与服务器相同的nfs-utils包，在Ubuntu上安装nfs-common。从这里开始只需再走两步。首先，创建一个新目录，你将在其中挂载远程文件系统。然后使用NFS服务器的IP地址和服务器/etc/export配置文件中公开的文件系统地址挂载它：
- en: '[PRE7]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '***1* The -p flag tells Linux to create any directories in the path that don’t
    yet exist (like /nfs/).**'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* -p标志告诉Linux创建路径中尚不存在任何目录（如/nfs/）。**'
- en: 'At this point, you should be able to open and edit shared files. Navigate to
    the mount point you created, and you should find at least one subdirectory, the
    one belonging to your server’s main user (ubuntu in my case). Enter the directory,
    and try opening, editing, and saving the file, then head back to the server to
    see if you can see the new, updated version:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你应该能够打开和编辑共享文件。导航到您创建的挂载点，你应该会找到一个子目录，即属于您服务器主用户的目录（以我的情况为例是ubuntu）。进入该目录，尝试打开、编辑和保存文件，然后返回服务器查看您是否可以看到新的、更新的版本：
- en: '[PRE8]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Success? Congratulations! Although it’s kind of creepy that you’re having a
    conversation with yourself. I promise not to tell anyone else.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 成功？恭喜！虽然和你自己对话有点诡异。我保证不会告诉任何人。
- en: 'No success? Here are some troubleshooting tips to consider:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 没有成功？以下是一些可以考虑的故障排除技巧：
- en: Make sure your client and the server have basic network connectivity with each
    other and can actually talk. Ping the IP address of the client from the server
    and the IP address of the server from the client (for example, `ping 192.168.1.23`)
    and confirm that you’re getting an appropriate response. Remember how you did
    this back in [chapter 3](kindle_split_011.xhtml#ch03)?
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保您的客户端和服务器之间有基本的网络连接，并且实际上可以通信。从服务器ping客户端的IP地址，从客户端ping服务器的IP地址（例如，`ping 192.168.1.23`），并确认您得到了适当的响应。记得你在
    [第3章](kindle_split_011.xhtml#ch03) 中是如何做的吗？
- en: 'Make sure there isn’t a firewall blocking traffic. By default, NFS needs the
    TCP port 2049 open to do its work. If you’re using ufw, you don’t need to remember
    that port number: `ufw allow nfs` will get it done (for a full list of available
    service aliases, see the /etc/services file).'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保没有防火墙阻止流量。默认情况下，NFS需要打开TCP端口2049才能工作。如果你使用ufw，你不需要记住端口号：`ufw allow nfs` 就可以完成这项工作（有关可用服务别名的完整列表，请参阅
    /etc/services 文件）。
- en: Make sure NFS is running properly on the server. Check your configuration with
    `exportfs` to verify that NFS is using your latest version with `exportfs -a`.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保NFS在服务器上运行正常。使用 `exportfs` 检查您的配置，以验证NFS是否使用您最新的版本 `exportfs -a`。
- en: Make sure the IP address of your server hasn’t changed. This can easily happen
    if the server is getting its IP dynamically from a DHCP server. Ideally, your
    NFS server should use a static address (see [chapter 14](kindle_split_022.xhtml#ch14)
    for details). In any case, you can temporarily solve this problem by updating
    the directive in /etc/fstab (see the next section).
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保服务器的IP地址没有更改。如果服务器从DHCP服务器动态获取IP地址，这很容易发生。理想情况下，您的NFS服务器应使用静态地址（有关详细信息，请参阅
    [第14章](kindle_split_022.xhtml#ch14)）。在任何情况下，您都可以通过更新 /etc/fstab 中的指令（见下一节）临时解决这个问题。
- en: 'If you want to remove the NFS mount from the client, use `umount`:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想从客户端删除NFS挂载，请使用 `umount`：
- en: '[PRE9]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 12.1.3\. Mounting an NFS share at boot time
  id: totrans-75
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 12.1.3\. 在启动时挂载NFS共享
- en: Although you can access those remote files now, I’m afraid your happiness won’t
    persist past the next system shutdown. You could run the `mount` command each
    time you boot, but that’s a habit that probably won’t last long. Instead, you
    can tell Linux to automatically mount the share each time you boot by editing
    the /etc/fstab file.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然你现在可以访问那些远程文件，但我恐怕你的快乐不会持续到下一次系统关闭。你可以每次启动时都运行`mount`命令，但这可能不会是一个持久的习惯。相反，你可以通过编辑
    /etc/fstab 文件来告诉Linux每次启动时自动挂载共享：
- en: Listing 12.1\. Contents of a typical /etc/fstab file
  id: totrans-77
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表12.1\. 典型 /etc/fstab 文件的内容
- en: '[PRE10]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '***1* Instructions for finding the UUID identifier for devices that may not
    yet be listed**'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 寻找尚未列出设备的UUID标识符的说明**'
- en: As you can see, an active fstab line will include six fields containing pieces
    of information about each listed device (see [table 12.1](#ch12table01)).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，一个活跃的 fstab 行将包括包含有关每个列出设备信息的六个字段（有关表格12.1的详细信息，请参阅 [table 12.1](#ch12table01)）。
- en: '|  |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-82
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: Some fstab options include `exec` (or `noexec`) to control whether binaries
    will be executable from the file system, `ro` to restrict access to read-only,
    `rw` to permit read and write access, and `defaults` to invoke the default settings
    (`rw`, `suid`, `dev`, `exec`, `auto`, `nouser`, and `async`).
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 一些 fstab 选项包括 `exec`（或 `noexec`）来控制是否可以从文件系统执行二进制文件，`ro` 来限制只读访问，`rw` 来允许读写访问，以及
    `defaults` 来调用默认设置（`rw`、`suid`、`dev`、`exec`、`auto`、`nouser` 和 `async`）。
- en: '|  |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Table 12.1\. Fields in the fstab file
  id: totrans-85
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 表12.1\. fstab文件中的字段
- en: '| Field | Purpose |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '| 字段 | 目的 |'
- en: '| --- | --- |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| File system | Identifies a device either by its boot-time designation (/dev/sda1,
    which can sometimes change) or, preferably, by its more reliable UUID. |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '| File system | 通过启动时的指定（例如/dev/sda1，有时会发生变化）或更可靠的UUID来识别设备。|'
- en: '| Mount point | Identifies the location on the file system where the device
    is currently mounted. |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| Mount point | 识别文件系统中设备当前挂载的位置。|'
- en: '| Type | The file system type. |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| Type | 文件系统类型。|'
- en: '| Options | Mount options assigned to the device. |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| Options | 分配给设备的挂载选项。|'
- en: '| Dump | Tells the (outdated) Dump program whether (1) or not (0) to back up
    the device. |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| Dump | 告诉（过时的）Dump程序是否（1）或不是（0）备份设备。|'
- en: '| Pass | Tells the fsck program which file system to check first at boot time.
    The root partition should be first (1). |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| Pass | 在启动时告诉fsck程序首先检查哪个文件系统。根分区应该是第一个（1）。|'
- en: 'The fstab file is initially populated with references to attached hardware
    devices during the OS installation. As admin, you have the right to add your own
    devices so they too are mounted at boot. Bear in mind the way a device is referenced.
    Adding a new line (in the client’s fstab file) for your NFS share might look like
    this:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: fstab文件最初在OS安装期间填充了附加硬件设备的引用。作为管理员，您有权添加自己的设备，以便它们在启动时也能挂载。请记住设备的引用方式。为您的NFS共享在客户端的fstab文件中添加新行可能看起来像这样：
- en: '[PRE11]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Reboot your client. This time, don’t manually mount the NFS share, but immediately
    head over to the directory where it’s supposed to be mounted (/nfs/home/) to make
    sure you can see the server-based files. If it’s there, then you know fstab has
    done its job. Run the `mount` command by itself; along with a long list of other
    file systems, you should see your new NFS share with the options that were assigned
    to it.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 重新启动您的客户端。这次，不要手动挂载NFS共享，而是立即前往它应该挂载的目录(/nfs/home/)，以确保您可以看到基于服务器的文件。如果它在那里，那么您就知道fstab已经完成了它的任务。单独运行`mount`命令；除了其他文件系统外，您应该看到分配给它的新NFS共享及其选项。
- en: Listing 12.2\. Partial output of mounted file systems on the client
  id: totrans-97
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表12.2\. 客户端挂载的文件系统部分输出
- en: '[PRE12]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '***1* The root partition**'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 根分区**'
- en: '***2* The NFS share followed by its boot options**'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 随后是NFS共享及其启动选项**'
- en: 12.1.4\. NFS security
  id: totrans-101
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 12.1.4\. NFS安全
- en: Take another quick look at the title of this chapter (“Sharing data over a private
    network”) and note the word *private*. As I mentioned earlier, NFS if left to
    its own devices won’t encrypt the data it hurls back and forth between hosts.
    You should only use it in private spaces.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 再快速看一下本章标题（“通过私有网络共享数据”）并注意单词*private*。正如我之前提到的，如果NFS任其自然，它不会加密在主机之间来回传输的数据。您应该只在私有空间中使用它。
- en: 'But how secure are private spaces? We call a network *private* when it can’t
    be reached from the outside using normal access rules. But if you don’t know yet,
    let me break it to you as gently as possible: hackers aren’t shy about using abnormal
    access rules. Or, more accurately, they’re likely to generate and deploy their
    own homemade rules.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 但是私有空间有多安全呢？当我们说一个网络*私有*时，意味着它不能通过正常的访问规则从外部访问。但是如果您还不知道，让我尽可能温和地告诉您：黑客并不害羞地使用异常访问规则。或者，更准确地说，他们很可能会生成和部署他们自己的自制规则。
- en: If the security of your NFS server share depends on how well you trust the folks
    in the office, then it could probably use some improvements. It’s not that you
    should never trust the people you know and work with, it’s that you can’t always
    be sure that their workstations and accounts haven’t been compromised by outsiders.
    Nor can you be certain that there’s no one from the outside listening in to your
    network traffic.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您对NFS服务器共享的安全性取决于您对办公室里的人的信任程度，那么它可能需要一些改进。这并不是说您永远不应该信任您认识并与之共事的人，而是您不能总是确定他们的工作站和账户是否已被外部人员破坏。您也不能确定是否有外部人员正在监听您的网络流量。
- en: 'Your general approach should be to follow the *principle of least privilege*:
    never open up a resource any wider than absolutely necessary, and never give users
    (or clients) any more access than they absolutely need to get their work done.
    For example, if your clients don’t need to edit the files, by all means pass the
    `ro` (read-only) option in the /etc/exports file. Or, if your clients need access
    to only some of the files in a directory hierarchy, block all the others.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 您的一般方法应该是遵循*最小权限原则*：永远不要打开比绝对必要更宽的资源，永远不要给用户（或客户端）提供他们完成工作所绝对需要的更多访问权限。例如，如果您的客户端不需要编辑文件，那么在/etc/exports文件中绝对可以通过`ro`（只读）选项。或者，如果您的客户端只需要访问目录层次结构中的某些文件，那么阻止其他所有文件。
- en: Firewall rules
  id: totrans-106
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 防火墙规则
- en: 'An important line of defense will be your firewall. If there are any individual
    workstations within your trusted private network that don’t need access to your
    NFS server, lock them out:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 一条重要的防御线将是您的防火墙。如果您的受信任私有网络中有任何不需要访问NFS服务器的个人工作站，请将其锁定：
- en: '[PRE13]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: On CentOS, that would be
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CentOS 上，那将是
- en: '[PRE14]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Speaking of locking them out, following a change of firewall rules on the NFS
    server, you may need to reboot the client machine before the NFS share is fully
    blocked.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 谈到将它们锁定在外，在NFS服务器上更改防火墙规则之后，在NFS共享完全被阻止之前，您可能需要重新启动客户端机器。
- en: 'Sometimes you’ll want your server to host more than just NFS files. There might
    also be unrelated data stores and configuration files needed by developer or admin
    teams working on their own machines. Here’s how you can block a developer, whose
    laptop has the IP 192.168.1.10, from accessing NFS on the server, while retaining
    full access to other server resources:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 有时候你可能希望你的服务器不仅仅托管NFS文件。可能还需要存储与开发团队或管理员团队无关的数据和配置文件，这些团队在自己的机器上工作。以下是如何阻止一个IP地址为192.168.1.10的开发者访问服务器上的NFS，同时保留对其他服务器资源的完全访问权限的方法：
- en: '[PRE15]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'To test this, consider installing the Apache web server in addition to NFS
    on your NFS server. If your NFS share fails to load on the client, but you can
    still access the web application on the server, then you’ll know you’ve found
    your sweet spot:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试这一点，考虑在你的NFS服务器上除了NFS之外还安装Apache网络服务器。如果你的NFS共享在客户端无法加载，但你仍然可以访问服务器上的网络应用程序，那么你就知道你已经找到了你的最佳平衡点：
- en: '[PRE16]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '***1* curl retrieves the contents of a web page, if accessible.**'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**1* curl 获取可访问网页的内容。**'
- en: Encryption
  id: totrans-117
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 加密
- en: As always, restricting access to your resources doesn’t mean that the data you
    transfer between servers and clients is safe—at least when that data is not encrypted.
    If you’re only transferring data within your local private network, and you’re
    confident that it truly is local and private, then you can be excused for relying
    on what you’ve already got going. But any data that will move across insecure
    networks requires some extra protection.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 和往常一样，限制对您资源的访问并不意味着您在服务器和客户端之间传输的数据是安全的——至少当这些数据未加密时是这样的。如果您只是在您的本地私有网络内传输数据，并且您确信这些数据确实是本地且私有的，那么您依赖现有的系统是可以被原谅的。但是，任何将在不安全网络上传输的数据都需要额外的保护。
- en: 'Here’s a brief list of ways you can deal with the problem (besides squeezing
    your eyes shut and hoping only good things happen to you, which, strictly speaking,
    is more of a coping mechanism):'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一份简短的列表，列出了你可以用来处理问题的方法（除了闭上眼睛并希望只有好事发生给你，这在严格意义上来说，更像是一种应对机制）：
- en: You can run an NFS share on top of a VPN much the same way you used a VPN to
    encrypt data movement back in [chapter 10](kindle_split_018.xhtml#ch10).
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以在VPN之上运行一个NFS共享，这与你在[第10章](kindle_split_018.xhtml#ch10)中使用VPN加密数据传输的方式非常相似。
- en: The IPSec protocol secures data at the IP network level by preventing IP spoofing
    and packet tampering. It encrypts all data contained in IP packets through the
    use of session keys. You can configure IPSec as a tunnel that, in broad terms,
    would work in a way that’s similar to that OpenVPN tunnel.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IPSec 协议通过防止 IP 欺骗和包篡改，在 IP 网络级别确保数据安全。它通过使用会话密钥加密 IP 数据包中包含的所有数据。您可以将 IPSec
    配置为隧道，从广义上讲，其工作方式与 OpenVPN 隧道相似。
- en: NFS can be configured to run over an underlying SSH session, which is another
    kind of tunnel. It’s always good to have multiple options available in case you
    run into an unusual use case. Note that this is a nonstandard option.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NFS 可以配置为在底层的 SSH 会话上运行，这又是一种隧道形式。在遇到不寻常的使用场景时，拥有多个选项总是好的。请注意，这是一个非标准选项。
- en: Assuming you already have a Kerberos authentication server running as part of
    your infrastructure and you’re using at least NFS v.4, adding the `sec=krb5p`
    line to your NFS configuration will pass managing the problem into the capable
    hands of Kerberos.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 假设您已经在您的基础设施中运行了一个Kerberos身份验证服务器，并且您至少使用了NFS v.4，将`sec=krb5p`行添加到您的NFS配置中，将把管理问题的任务交给Kerberos的强大之手。
- en: Finally, an alternative to NFS is SSH Filesystem (SSHFS). SSHFS similarly mounts
    remote file systems as local volumes, but works through the SFTP protocol using
    the Filesystem in Userspace (FUSE) software interface.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，NFS 的一个替代方案是 SSH 文件系统（SSHFS）。SSHFS 类似地将远程文件系统挂载为本地卷，但通过使用用户空间文件系统（FUSE）软件接口通过
    SFTP 协议工作。
- en: 12.2\. Sharing files with Windows users using Samba
  id: totrans-125
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2. 使用 Samba 与 Windows 用户共享文件
- en: If your office network includes users who need to access Linux-based files from
    their Windows PCs, then Samba is a solution that’s both simple and devilishly
    complex. What do I mean? Setting up a basic connection like the one I’m going
    to demonstrate won’t take much work at all. But integrating authentication with
    a Windows Active Directory domain or struggling with SELinux on the Linux server
    can give you considerably more trouble. It’s no accident that a whole library
    of Samba configuration books has been published over the years.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的办公网络包括需要从他们的 Windows PC 访问基于 Linux 文件的用户，那么 Samba 是一个简单而复杂得令人难以置信的解决方案。我的意思是什么？设置一个基本连接，就像我将要演示的那样，不会花费太多精力。但是，将身份验证与
    Windows Active Directory 域集成或与 Linux 服务器上的 SELinux 作斗争可能会给您带来相当多的麻烦。多年来出版了一整套
    Samba 配置书籍，这并非偶然。
- en: 'For our purposes, you can get away with installing only the samba and smbclient
    packages on Ubuntu. For CentOS, it’s simpler to run `yum` against `samba*` to
    grab the whole collection of Samba-related tools (remember: the `*` character
    is interpreted to return all results containing the preceding text). Here’s how
    the rest of the process will unfold:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的目的，您可以在 Ubuntu 上仅安装 samba 和 smbclient 软件包。对于 CentOS，运行 `yum` 对 `samba*`
    进行操作以获取整个 Samba 相关工具集合要简单得多（记住：`*` 字符被解释为返回包含前面文本的所有结果）。以下是其余过程将如何展开：
- en: Create a Samba user account on the Linux server.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Linux 服务器上创建一个 Samba 用户账户。
- en: Designate a share directory.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定共享目录。
- en: Define the share through the edit smb.conf file.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过编辑 smb.conf 文件来定义共享。
- en: Test the configuration.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 测试配置。
- en: Connect from a Windows client.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 Windows 客户端连接。
- en: 'You’ll need to use a program called smbpasswd to set up a Samba user as an
    account clients will use to log in to. But because the Samba authority will be
    added to an existing account, you should first create a new Linux account. I’ll
    call mine sambauser, but you can choose any name you like:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要使用一个名为 smbpasswd 的程序来设置一个 Samba 用户，作为客户端将用于登录的账户。但由于 Samba 权限将添加到现有账户中，您应该首先创建一个新的
    Linux 账户。我将称它为 sambauser，但您可以选择任何您喜欢的名称：
- en: '[PRE17]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Next, you can create a directory where the share will be based. I’m going to
    follow the same pattern I used earlier for my NFS share. To make it easier to
    test things later, I’ll create a file within the new directory. Because multiple
    clients might end up working with files in this directory, you can avoid potential
    permissions issues by using `chmod` to open up the directory permissions to 777
    (read, write, and execute for all users):'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您可以创建一个共享将基于的目录。我将遵循我之前为我的 NFS 共享使用的相同模式。为了便于稍后测试，我将在新目录中创建一个文件。因为多个客户端最终可能会在这个目录中处理文件，您可以通过使用
    `chmod` 将目录权限设置为 777（所有用户的读取、写入和执行权限）来避免潜在权限问题：
- en: '[PRE18]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'That’s the Samba environment all built up. Now you can add a configuration
    to the smb.conf file in the /etc/samba/ directory. You should browse through the
    configuration file to get a feel for how much customization is possible, and how
    complicated things can get:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这样，Samba 环境就全部搭建好了。现在您可以将配置添加到 /etc/samba/ 目录下的 smb.conf 文件中。您应该浏览配置文件，以了解可以进行的多少定制以及事情可能会变得多么复杂：
- en: '[PRE19]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: For your humble aspirations right how, however, you’ll only need to add a single
    section that defines your share. I’ll throw all caution to the wind and call the
    share sharehome. The two entries that you absolutely must include are `path`,
    which points to the directory you plan to use for your shared documents, and,
    assuming you want your clients to be able to create and edit files, `writable`
    with a value of `yes`. With that done, save the file and close your text editor.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，就您目前谦逊的愿望而言，您只需要添加一个定义您的共享的单个部分。我将冒险将其称为 sharehome。您绝对必须包含的两个条目是 `path`，它指向您计划用于共享文档的目录，以及，假设您希望客户端能够创建和编辑文件，`writable`
    的值为 `yes`。完成这些操作后，保存文件并关闭文本编辑器。
- en: Listing 12.3\. A file share configuration section from the /etc/samba/smb.conf
    file
  id: totrans-140
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 12.3\. 来自 /etc/samba/smb.conf 文件的文件共享配置部分
- en: '[PRE20]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Now use systemctl to start and enable the Samba daemon. Ubuntu knows Samba
    as `smbd`, but on CentOS, it’ll be `smb` (without the *d*):'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 现在请使用 systemctl 启动并启用 Samba 守护进程。Ubuntu 将 Samba 识别为 `smbd`，但在 CentOS 上，它将是 `smb`（不带
    *d*）：
- en: '[PRE21]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '***1* Note that smbd is the daemon name systemctl recognizes on Ubuntu; on
    CentOS it will be smb.**'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 注意，smbd 是 Ubuntu 上 systemctl 识别的守护进程名称；在 CentOS 上将是 smb。**'
- en: 12.2.1\. Testing your Samba configuration
  id: totrans-145
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 12.2.1\. 测试您的 Samba 配置
- en: 'It’s always a good idea to test your configuration before digging in too deeply,
    so running `testparm` will show you whether the section you added can be properly
    read by the Samba service. This output suggests that everything is fine:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在深入挖掘之前测试你的配置总是一个好主意，所以运行 `testparm` 将会显示你添加的章节是否可以被 Samba 服务正确读取。这个输出表明一切正常：
- en: '[PRE22]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '***1* testparm tests and displays your Samba configuration.**'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* testparm 测试并显示你的 Samba 配置。**'
- en: '***2* Confirmation that your sharehome section is recognized**'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 确认你的 sharehome 部分被识别**'
- en: 'One more test before you invite your Windows friends in: you can use the smbclient
    program to log in to your Samba share from the local machine. You’ll first need
    to switch the user (`su`) to the sambauser account you associated with Samba earlier.
    You can then run `smbclient` against the share’s host address and name (//localhost/sharehome):'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在邀请你的 Windows 朋友加入之前，还有一个测试：你可以使用 smbclient 程序从本地机器登录到你的 Samba 共享。首先，你需要切换用户（`su`）到之前与
    Samba 关联的 sambauser 账户。然后，你可以运行 `smbclient` 对共享的主机地址和名称（//localhost/sharehome）进行操作：
- en: '[PRE23]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '***1* Note the special Samba command prompt telling you that you’re now in
    a Samba shell session.**'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 注意特殊的 Samba 命令提示符告诉你你现在处于 Samba 壳层会话中。**'
- en: 'In this case, as you can see from the command-line prompt, you’ve been dropped
    into a Samba shell. Run `ls` to display the contents, and you should see the myfile
    file you created:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，正如你从命令行提示符中可以看到的，你已经进入了 Samba 壳层。运行 `ls` 来显示内容，你应该能看到你创建的 myfile 文件：
- en: '[PRE24]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: By the way, as you already know from [chapter 9](kindle_split_017.xhtml#ch09),
    poorly trained and/or impatient admins will sometimes be tempted to switch off
    SELinux at the first sign of conflict. This is a bad thing and certainly nothing
    highly trained and infinitely patient Linux folk like us would ever consider.
    Most of the time.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 顺便说一句，正如你从第 9 章[章节 9](kindle_split_017.xhtml#ch09)中已经知道的，训练不足和/或缺乏耐心的管理员有时会一遇到冲突就倾向于关闭
    SELinux。这是件坏事，而且绝对不是像我们这样受过高度训练且极具耐心的 Linux 用户会考虑的事情。大多数时候。
- en: 'If you’re running this demo on CentOS and find yourself unable to access the
    files in your share, it might be because SELinux is getting in the way:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在这个演示中运行 CentOS 并且发现自己无法访问共享中的文件，那可能是因为 SELinux 在作祟：
- en: '[PRE25]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Don’t ever do what I’m about to tell you. Not even for a simple demo on a non-production
    server. Never. But if you did want to disable SELinux for a minute or two to avoid
    having to read through the smb.conf file documentation to figure out how to fix
    the problem properly, I’m sure you’ll remember that running `setenforce 0` will
    disable SELinux. But I never told you that. In fact, this whole paragraph never
    happened.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 千万不要做我即将告诉你的事情。即使是在非生产服务器上的简单演示也不要做。永远不要。但如果你想禁用 SELinux 一分钟或两分钟以避免不得不阅读 smb.conf
    文件文档来找出如何正确修复问题，我确信你会记得运行 `setenforce 0` 将会禁用 SELinux。但我从未告诉你这一点。事实上，这个段落从未发生过。
- en: If you’ve got a firewall protecting your server, you’ll need to open up some
    ports so Samba can get in and out. But the specific ports you’ll need will at
    least partly depend on what you include in your Samba configuration. Kerberos,
    LDAP, DNS, and NetBIOS are common services to run in conjunction with Samba.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你服务器上有防火墙保护，你需要打开一些端口以便 Samba 可以进出。但你需要的具体端口将至少部分取决于你在 Samba 配置中包含的内容。Kerberos、LDAP、DNS
    和 NetBIOS 是与 Samba 一起运行的常见服务。
- en: 'Using `netstat` on the server to scan for ports being used by Samba (using
    the `smbd` search term) will give you the key ports on a basic system. This example
    returns 139 and 445, but there could be many more:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在服务器上使用 `netstat` 扫描 Samba（使用 `smbd` 搜索词）使用的端口将给出基本系统上的关键端口。这个例子返回了 139 和 445，但可能有更多：
- en: '[PRE26]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '***1* If you don’t have netstat on your machine, install the net-tools package.**'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 如果你机器上没有 netstat，请安装 net-tools 软件包。**'
- en: 12.2.2\. Accessing a Samba server from Windows
  id: totrans-163
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 12.2.2\. 从 Windows 访问 Samba 服务器
- en: 'From the Windows client machine, create a desktop shortcut (they’ve got those
    things in Windows, too!) and give it a location pointing to the Samba share on
    your Linux server. Assuming the Linux server’s IP address is 192.168.1.23 and
    the name you gave the Samba share was sharehome, the address you’ll enter will
    look like this:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Windows 客户端机器创建一个桌面快捷方式（Windows 也有这些功能！），并将其位置指向你的 Linux 服务器上的 Samba 共享。假设
    Linux 服务器的 IP 地址是 192.168.1.23，你给 Samba 共享起的名字是 sharehome，你将输入的地址将看起来像这样：
- en: '[PRE27]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: To connect, the Windows user must authenticate using the Linux Samba username
    and password you created earlier, unless you chose to integrate your Samba authentication
    with a Windows Active Directory domain. That’s something that can be both more
    efficient in the long run and more secure than relying on a simple password. I’d
    show you how that’s done, but first let me grab a quick look at the book cover
    to confirm my suspicion. Yup. This is a Linux book. Sorry, no Windows configuration
    guides.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 为了连接，Windows用户必须使用你之前创建的Linux Samba用户名和密码进行身份验证，除非你选择将Samba身份验证与Windows Active
    Directory域集成。这可能是长期来看更高效且更安全的方法，而不是依赖于简单的密码。我会向你展示如何做到这一点，但首先让我快速看一下书封面以确认我的怀疑。是的，这是一本Linux书。抱歉，没有Windows配置指南。
- en: 12.3\. Sharing files with yourself using symbolic links
  id: totrans-167
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3. 使用符号链接与自身共享文件
- en: Granted, the connection to this chapter might seem a bit stretched, but users
    will sometimes want to share their files with themselves. Creating symbolic links
    (also known as *symlinks*) can make that happen. Just to be clear, I’m not talking
    about making your files available to both you and your evil twin, but making them
    more readily accessible from wherever you might happen to be.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 承认，这个章节与本章的联系可能有点牵强，但用户有时会想要与自己共享文件。创建符号链接（也称为**symlinks**）可以实现这一点。为了明确，我并不是在谈论让你的文件同时对你和你邪恶的李生兄弟可用，而是在你可能在的任何地方都能更方便地访问它们。
- en: Let me illustrate that. Earlier in the chapter, you used an NFS share to give
    your users access to a central /home/ directory. The goal was to let any user
    sit down in front of any workstation in the office and, through the /nfs/home/
    directory you created, immediately get to work with their own documents.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 让我来举例说明。在本章的早期部分，你使用了一个NFS共享来让你的用户能够访问中央/home/目录。目标是让任何用户坐在办公室的任何工作站前，通过你创建的/nfs/home/目录，立即开始使用自己的文档。
- en: But what if not all of your users are so comfortable with the Linux file system
    hierarchy, not to mention the command line? Perhaps some users don’t know where
    on the file system their files live. Feel free to create a symbolic link to, say,
    a mounted shared directory that will display on the user’s GUI desktop.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 但如果并非所有用户都对Linux文件系统层次结构如此熟悉，更不用说命令行了怎么办？也许有些用户不知道他们的文件在文件系统中的具体位置。你可以自由地创建一个指向挂载的共享目录的符号链接，该目录将在用户的GUI桌面上显示。
- en: '|  |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-172
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: User accounts on GUI Linux systems are given a set of subdirectories (like Documents
    and Pictures) in their /home/username/ directory where they can conveniently organize
    their documents. One of those subdirectories is called Desktop, and whatever files
    are saved to it will appear as icons on the GUI screen users will see first when
    they log in. Keep in mind that those subdirectories won’t be created until the
    user logs in to the new account for the first time.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: GUI Linux系统上的用户账户在他们的/home/username/目录中有一组子目录（如文档和图片），他们可以在其中方便地组织他们的文档。其中一个子目录被称为桌面，任何保存到其中的文件都将作为图标出现在用户登录时首先看到的GUI屏幕上。请记住，这些子目录直到用户首次登录新账户时才会创建。
- en: '|  |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 'You create a symbolic link with the `ln` command followed by the `-s` argument,
    the file system object you want to link, and the location where you’d like the
    link placed:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过使用带有 `-s` 参数的 `ln` 命令，想要链接的文件系统对象，以及你希望放置链接的位置来创建一个符号链接：
- en: '[PRE28]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: That’s all there is to it. In fact, it’s so simple that you might wonder why
    it deserves a section all for itself. It’s about the `-s` argument. The *s* stands
    for symbolic, which means there must also be a different flavor of link. Indeed,
    by default, `ln` will create a hard link.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是全部内容。事实上，它如此简单，你可能想知道为什么它值得单独成节。这与 `-s` 参数有关。这里的 `s` 代表符号，这意味着也必须有一种不同类型的链接。确实，默认情况下，`ln`
    命令会创建一个硬链接。
- en: But what’s the difference? A *symbolic link* points to a separate file system
    object. Reading, executing, or editing the symbolic link will read, execute, or
    edit the linked object. But if you move or delete the original the symbolic link,
    being nothing more than a pointer to a separate object, it will break.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 但区别在哪里呢？一个**符号链接**指向一个独立的文件系统对象。读取、执行或编辑符号链接将会读取、执行或编辑链接的对象。但如果移动或删除原始的符号链接，由于它仅仅是一个指向独立对象的指针，它将会断开。
- en: 'A *hard link*, by contrast, is an exact duplicate of its target to the point
    that the two files will share a single inode. An inode, as you recall from [chapter
    1](kindle_split_009.xhtml#ch01), is metadata describing an object’s attributes:
    in particular, its location within the file system.'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 与之相反，*硬链接*是其目标的精确副本，以至于两个文件将共享一个单一的inode。正如你从[第1章](kindle_split_009.xhtml#ch01)中回忆的那样，inode是描述对象属性的元数据：特别是它在文件系统中的位置。
- en: 'Let’s see all this in action. Create two files, and add a different bit of
    text to each. Now create a hard link for one of the files and a symbolic link
    for the other:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这一切是如何付诸实践的。创建两个文件，并为每个文件添加不同的文本。现在为其中一个文件创建一个硬链接，为另一个文件创建一个符号链接：
- en: '[PRE29]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Run `ls` with the `i` argument to display inode IDs. Note that the hard-linked
    files share an identical inode ID number. Note also how the file2-sym file points
    to file2:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`i`参数运行`ls`来显示inode ID。注意，硬链接文件共享相同的inode ID号码。注意文件2-sym文件指向文件2：
- en: '[PRE30]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'If you were to delete, rename, or move file2, its symbolic link would break
    and, depending on your shell’s color scheme, be displayed with an angry red background.
    The hard link, on the other hand, will survive all changes to the original. Try
    both yourself: rename the file1 and file2 files, and see what happens to their
    respective links:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你删除、重命名或移动文件2，它的符号链接将会断裂，并且根据你的shell颜色方案，将以愤怒的红色背景显示。另一方面，硬链接将能够承受对原始文件的所有更改。试着亲自试试：重命名文件1和文件2，看看它们的链接会发生什么变化：
- en: '[PRE31]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: As you may notice when you run `ls -il` once again, even after using `mv` to
    rename file1, file1-hard is still there and, more important, still shares the
    same inode with newname1\. Any edits to one file will be reflected in the other.
    file2-sym, sadly, has been orphaned.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 当你再次运行`ls -il`时，你可能已经注意到，即使在用`mv`重命名文件1之后，file1-hard仍然存在，更重要的是，它仍然与newname1共享相同的inode。对其中一个文件的任何编辑都会反映在另一个文件上。遗憾的是，file2-sym已经被遗弃。
- en: Why bother with all this? Why not just make copies? Think about the case you
    saw a bit earlier where you created a link to a file system location on a user’s
    desktop. Or what about the connection between the /sbin/init and /lib/systemd/systemd
    files you saw back in [chapter 8](kindle_split_016.xhtml#ch08), or the contents
    of /etc/apache2/sites-available/ and /etc/apache2/sites-enabled/ from [chapter
    3](kindle_split_011.xhtml#ch03)? Those are all examples of links being used to
    enhance system functionality.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么要费这么大的劲？为什么不直接复制呢？想想你之前看到的情况，你创建了一个指向用户桌面文件系统位置的链接。或者，关于你在[第8章](kindle_split_016.xhtml#ch08)中看到的/sbin/init和/lib/systemd/systemd文件之间的连接，或者[第3章](kindle_split_011.xhtml#ch03)中/etc/apache2/sites-available/和/etc/apache2/sites-enabled/的内容？这些都是使用链接来增强系统功能的事例。
- en: Hard links are much more widely used in Linux, but their purpose is not always
    so obvious. In one common use case, even though files are kept in disparate locations
    in the file system, they’ll be linked together. This can make it easier to back
    up important but widely scattered configuration files without having to regularly
    make new copies. And because hard links don’t take up any space, you won’t have
    to worry about extra disk usage.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 硬链接在Linux中应用得更为广泛，但它们的目的并不总是那么明显。在一种常见的使用场景中，尽管文件存储在文件系统的不同位置，但它们会被链接在一起。这可以使得备份重要的但分布广泛的配置文件变得更加容易，而无需定期创建新的副本。并且由于硬链接不占用任何空间，你不必担心额外的磁盘使用。
- en: Summary
  id: totrans-189
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 摘要
- en: NFS shares expose defined file system resources on remote computers, allowing
    convenient document access and collaboration among teams.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NFS共享在远程计算机上公开定义的文件系统资源，允许方便的文档访问和团队之间的协作。
- en: File systems and devices can be mounted (and used) either manually from the
    command line or at boot time through entries in the /etc/fstab file.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文件系统和设备可以通过命令行手动挂载（并使用），或者通过在/etc/fstab文件中的条目在启动时挂载。
- en: You can secure NFS shares through smart configuration policies, firewall rules,
    and encryption delivered through third-party solutions like Kerberos and IPSec.
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以通过智能配置策略、防火墙规则以及通过第三方解决方案（如Kerberos和IPSec）提供的加密来确保NFS共享的安全。
- en: Windows clients can consume Linux-based files using Samba and Samba-generated
    account authentication.
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows客户端可以使用Samba以及Samba生成的账户认证来消费基于Linux的文件。
- en: Symbolic links point to file system objects, whereas hard links create objects
    that are exact copies of the original without taking up storage space.
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 符号链接指向文件系统对象，而硬链接创建的对象是原始文件的精确副本，不占用存储空间。
- en: Key terms
  id: totrans-195
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 关键术语
- en: A *share* is a set of documents or a file system that’s shared with a remote
    client.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*共享*是一组文档或文件系统，与远程客户端共享。'
- en: A *Samba server configuration* can be tested using `testparm`.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以使用`testparm`测试一个*Samba服务器配置*。
- en: '*Symbolic and hard links* allow Linux file system objects (files and directories)
    to be represented in multiple locations.'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*符号链接和硬链接*允许Linux文件系统对象（文件和目录）在多个位置表示。'
- en: Security best practices
  id: totrans-199
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安全最佳实践
- en: NFS shares should be as specific as possible, including only those clients who
    need access and only the rights needed by each client. This is in keeping with
    the *principle of least privilege*.
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NFS共享应尽可能具体，包括需要访问的客户端以及每个客户端需要的权限。这符合*最小权限原则*。
- en: Where possible, NFS share policies should always include `squash_root` to ensure
    that remote clients don’t get unconstrained root access to the server.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在可能的情况下，NFS共享策略应始终包括`squash_root`，以确保远程客户端不会获得对服务器的无限制root访问。
- en: NFS (and Samba) shares are not encrypted by default. If your clients will be
    accessing them via an untrusted network, then you should apply encryption.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NFS（和Samba）共享默认不加密。如果您的客户端将通过不受信任的网络访问它们，那么您应该应用加密。
- en: Command-line review
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 命令行审查
- en: '`/home 192.168.1.11(rw,sync)` (the entry in the NFS server /etc/exports file)
    defines a remote client share.'
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/home 192.168.1.11(rw,sync)`（NFS服务器/etc/exports文件中的条目）定义了一个远程客户端共享。'
- en: '`firewall-cmd --add-service=nfs` opens a CentOS firewall for client access
    to your NFS share.'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`firewall-cmd --add-service=nfs` 为CentOS防火墙打开客户端访问您的NFS共享。'
- en: '`192.168.1.23:/home /nfs/home nfs` (a typical entry in the /etc/fstab file
    of an NFS client) loads an NFS share.'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`192.168.1.23:/home /nfs/home nfs`（NFS客户端/etc/fstab文件中的典型条目）加载了一个NFS共享。'
- en: '`smbpasswd -a sambauser` adds Samba functionality (and a unique password) to
    an existing Linux user account.'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`smbpasswd -a sambauser` 为现有Linux用户账户添加Samba功能（以及一个唯一的密码）。'
- en: '`nano /etc/samba/smb.conf` controls Samba on the server.'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`nano /etc/samba/smb.conf` 控制服务器上的Samba。'
- en: '`smbclient //localhost/sharehome` logs in to a local Samba share using the
    Samba user account.'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`smbclient //localhost/sharehome` 使用Samba用户账户登录到本地Samba共享。'
- en: '`ln -s /nfs/home/ /home/username/Desktop/` creates a symbolic link allowing
    a user to easily access an NFS share by clicking a desktop icon.'
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ln -s /nfs/home/ /home/username/Desktop/` 创建了一个符号链接，允许用户通过点击桌面图标轻松访问NFS共享。'
- en: Test yourself
  id: totrans-211
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 测试自己
- en: '**[1](#ch12qa2q0a1)**'
  id: totrans-212
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[1](#ch12qa2q0a1)**'
- en: ''
  id: totrans-213
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following directives would provide read-only access to an NFS client
    using the 192.168.1.11 IP address?
  id: totrans-214
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个指令可以为使用192.168.1.11 IP地址的NFS客户端提供只读访问？
- en: ''
  id: totrans-215
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`/home 192.168.1.11(ro,sync)`'
  id: totrans-216
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`/home 192.168.1.11(ro,sync)`'
- en: '`192.168.1.11 /home(ro,sync)`'
  id: totrans-217
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`192.168.1.11 /home(ro,sync)`'
- en: '`/home 192.168.1.11(rw,sync)`'
  id: totrans-218
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`/home 192.168.1.11(rw,sync)`'
- en: '`192.168.1.11 /home(r,sync)`'
  id: totrans-219
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`192.168.1.11 /home(r,sync)`'
- en: '**[2](#ch12qa2q0a2)**'
  id: totrans-220
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[2](#ch12qa2q0a2)**'
- en: ''
  id: totrans-221
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which client-side configuration file should be edited to ensure an NFS share
    is loaded at boot-time?
  id: totrans-222
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 应编辑哪个客户端配置文件以确保在启动时加载NFS共享？
- en: ''
  id: totrans-223
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: /etc/nfs
  id: totrans-224
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/nfs
- en: /etc/exports
  id: totrans-225
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/exports
- en: /etc/nfs/exports
  id: totrans-226
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/nfs/exports
- en: /etc/fstab
  id: totrans-227
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/fstab
- en: '**[3](#ch12qa2q0a3)**'
  id: totrans-228
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[3](#ch12qa2q0a3)**'
- en: ''
  id: totrans-229
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: What will the `exportfs -ra` command accomplish?
  id: totrans-230
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`exportfs -ra`命令将完成什么？'
- en: ''
  id: totrans-231
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Force NFS to reload the policies from the configuration file
  id: totrans-232
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 强制NFS重新加载配置文件中的策略
- en: List current NFS file systems
  id: totrans-233
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出当前NFS文件系统
- en: Test a Samba configuration
  id: totrans-234
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 测试Samba配置
- en: Reload all attached devices
  id: totrans-235
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新加载所有附加设备
- en: '**[4](#ch12qa2q0a4)**'
  id: totrans-236
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[4](#ch12qa2q0a4)**'
- en: ''
  id: totrans-237
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following will completely block a single remote client machine
    from server access?
  id: totrans-238
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个将完全阻止单个远程客户端机器从服务器访问？
- en: ''
  id: totrans-239
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`ufw deny ALL 192.168.1.10/UDP`'
  id: totrans-240
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ufw deny ALL 192.168.1.10/UDP`'
- en: '`ufw deny ALL 192.168.1.10`'
  id: totrans-241
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ufw deny ALL 192.168.1.10`'
- en: '`ufw deny to 192.168.1.10`'
  id: totrans-242
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ufw deny to 192.168.1.10`'
- en: '`ufw deny to 192.168.1.10/255.255.255.0`'
  id: totrans-243
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ufw deny to 192.168.1.10/255.255.255.0`'
- en: '**[5](#ch12qa2q0a5)**'
  id: totrans-244
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[5](#ch12qa2q0a5)**'
- en: ''
  id: totrans-245
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following security tools will not help protect data while in transit
    between server and client machines?
  id: totrans-246
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个安全工具在服务器和客户端机器之间传输数据时不会帮助保护数据？
- en: ''
  id: totrans-247
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Kerberos
  id: totrans-248
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: Kerberos
- en: firewalld
  id: totrans-249
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: firewalld
- en: SSHFS
  id: totrans-250
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: SSHFS
- en: IPSec
  id: totrans-251
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: IPSec
- en: '**[6](#ch12qa2q0a6)**'
  id: totrans-252
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[6](#ch12qa2q0a6)**'
- en: ''
  id: totrans-253
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following is the correct name and location of the Samba server
    configuration file?
  id: totrans-254
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个是Samba服务器配置文件的正确名称和位置？
- en: ''
  id: totrans-255
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: /etc/samba/smb.conf
  id: totrans-256
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/samba/smb.conf
- en: /etc/smb.cfg
  id: totrans-257
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/smb.cfg
- en: /etc/samba/smb.conf
  id: totrans-258
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/samba/smb.conf
- en: /etc/samba.cfg
  id: totrans-259
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: /etc/samba.cfg
- en: '**[7](#ch12qa2q0a7)**'
  id: totrans-260
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[7](#ch12qa2q0a7)**'
- en: ''
  id: totrans-261
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following commands will start Samba on an Ubuntu server?
  id: totrans-262
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个命令将在Ubuntu服务器上启动Samba？
- en: ''
  id: totrans-263
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`systemctl start sambad`'
  id: totrans-264
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`systemctl start sambad`'
- en: '`systemctl start smbd`'
  id: totrans-265
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`systemctl start smbd`'
- en: '`systemctl start smb`'
  id: totrans-266
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`systemctl start smb`'
- en: '`systemctl start samba`'
  id: totrans-267
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`systemctl start samba`'
- en: '**[8](#ch12qa2q0a8)**'
  id: totrans-268
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[8](#ch12qa2q0a8)**'
- en: ''
  id: totrans-269
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Which of the following commands makes the most sense for creating a link to
    a configuration file to make regular backups simpler and more reliable?
  id: totrans-270
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 以下哪个命令在创建指向配置文件的链接以使常规备份更简单、更可靠方面最有意义？
- en: ''
  id: totrans-271
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '`ln -s /var/backups/important_config_file_backup.cfg /etc/important_config_file.cfg`'
  id: totrans-272
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ln -s /var/backups/important_config_file_backup.cfg /etc/important_config_file.cfg`'
- en: '`ln /var/backups/important_config_file_backup.cfg /etc/important_config_file.cfg`'
  id: totrans-273
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ln /var/backups/important_config_file_backup.cfg /etc/important_config_file.cfg`'
- en: '`ln -s /etc/important_config_file.cfg /var/backups/important_config_file_backup.cfg`'
  id: totrans-274
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ln -s /etc/important_config_file.cfg /var/backups/important_config_file_backup.cfg`'
- en: '`ln /etc/important_config_file.cfg /var/backups/important_config_file_backup.cfg`'
  id: totrans-275
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`ln /etc/important_config_file.cfg /var/backups/important_config_file_backup.cfg`'
- en: Answer key
  id: totrans-276
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 答案键
- en: '**[1.](#ch12qa1q1)**'
  id: totrans-277
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[1.](#ch12qa1q1)**'
- en: ''
  id: totrans-278
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: a
  id: totrans-279
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: a
- en: '**[2.](#ch12qa1q2)**'
  id: totrans-280
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[2.](#ch12qa1q2)**'
- en: ''
  id: totrans-281
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: d
  id: totrans-282
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: d
- en: '**[3.](#ch12qa1q3)**'
  id: totrans-283
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[3.](#ch12qa1q3)**'
- en: ''
  id: totrans-284
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: a
  id: totrans-285
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: a
- en: '**[4.](#ch12qa1q4)**'
  id: totrans-286
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[4.](#ch12qa1q4)**'
- en: ''
  id: totrans-287
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: c
  id: totrans-288
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: c
- en: '**[5.](#ch12qa1q5)**'
  id: totrans-289
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[5.](#ch12qa1q5)**'
- en: ''
  id: totrans-290
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: b
  id: totrans-291
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: b
- en: '**[6.](#ch12qa1q6)**'
  id: totrans-292
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[6.](#ch12qa1q6)**'
- en: ''
  id: totrans-293
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: c
  id: totrans-294
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: c
- en: '**[7.](#ch12qa1q7)**'
  id: totrans-295
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[7.](#ch12qa1q7)**'
- en: ''
  id: totrans-296
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: b
  id: totrans-297
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: b
- en: '**[8.](#ch12qa1q8)**'
  id: totrans-298
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[8.](#ch12qa1q8)**'
- en: ''
  id: totrans-299
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: d
  id: totrans-300
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: d
