- en: Appendix B. Setting up a development environment
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录B. 设置开发环境
- en: 'There are many reasons to start with a fresh slate when working on a new project.
    The following list shows a few of the more relevant ones with respect to ML project
    work:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理新项目时，从一张白纸开始有许多原因。以下列表展示了与ML项目工作更相关的几个原因：
- en: Dependency management is easier with a clean environment.
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在干净的环境中管理依赖关系更为容易。
- en: Isolation of temporary files, logs, and artifacts is simpler.
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 临时文件、日志和文件的隔离更为简单。
- en: Scripted environment creation makes porting to production easier.
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 脚本化环境创建使得迁移到生产环境更为简单。
- en: Installation of libraries is less complex with fewer dependency collisions.
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在依赖冲突较少的情况下，库的安装更为简单。
- en: While many options exist for creating isolable environments for development
    of new projects, this appendix provides guidance on using Docker along with Conda’s
    package management suite of tools, just as the companion repository to this book
    does.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然存在许多创建可隔离环境以开发新项目的方法，但本附录提供了使用Docker以及Conda的包管理工具套件的指导，正如本书的配套仓库所做的那样。
- en: B.1 The case for a clean experimentation environment
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.1 清洁实验环境的案例
- en: A major struggle that data scientists have once they’ve been building prototypes
    on their local computers for long enough is that older projects simply can’t run
    anymore in the updated environments that subsequent projects have necessitated.
    As libraries evolve, the DSs upgrade library versions and add new packages with
    updated dependencies on other packages; dependencies change within this truly
    massive ecosystem comprising the large web of interconnected APIs
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学家在长时间在本地计算机上构建原型后面临的一个主要挑战是，旧项目无法在后续项目所需的更新环境中运行。随着库的发展，数据科学家升级库版本，并添加新的包，这些包依赖于其他包的新依赖项；在这个真正庞大的生态系统中，库的依赖关系发生了变化，这个生态系统由大量的相互连接的API网络组成。
- en: This incredibly complex and frustrating concept of maintaining compatibility
    among libraries is known as *dependency hell*, a moniker that is well-earned.
    Figure B.1 shows a typical scenario that happens with dependency struggles.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 维护库之间兼容性的这个极其复杂且令人沮丧的概念被称为*依赖地狱*，这是一个当之无愧的称号。图B.1展示了依赖冲突的典型场景。
- en: '![B-01](../Images/B-01.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![B-01](../Images/B-01.png)'
- en: Figure B.1 Dependency hell in a common Python development environment. Package
    management struggles can waste a great deal of time.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 图B.1 常见Python开发环境中的依赖地狱。包管理冲突可能会浪费大量时间。
- en: As you can see, the options for resolving library conflicts on a single local
    environment are quite dire. On one hand, you could be forced to refactor code
    bases and train runtime environments, both actions being untenable as the number
    of projects grows at a company. Alternatively, the DS team members would have
    to waste countless hours modifying their installed packages (reverting or upgrading)
    each time that they wanted to work on a new project. It’s simply not a scalable
    solution.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所见，在单个本地环境中解决库冲突的选项相当严峻。一方面，你可能被迫重构代码库和训练运行时环境，随着公司项目数量的增长，这两项行动都是不可行的。另一方面，数据科学团队成员每次想要开始一个新项目时，都必须浪费无数小时修改他们安装的包（回滚或升级）。这显然不是一个可扩展的解决方案。
- en: Regardless of the operating system that you’re running, if you have Python already
    installed on your machine, you’re going to have some deep dependencies among the
    packages that are also installed. Some of the experimentation and testing will
    require library installations that could break either previously developed projects
    or utility applications that are available to you on the command line. Not to
    mention that each team member’s computer likely has slight different versions
    of each of these critical packages, resulting in reproducibility issues if those
    team members run one another’s code.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 无论你运行的是哪种操作系统，如果你已经在你的机器上安装了Python，你将会有一些深层次的依赖关系，这些依赖关系也存在于已安装的包中。一些实验和测试可能需要安装库，这可能会破坏之前开发的项目或命令行上可用的实用应用程序。更不用说，每个团队成员的电脑可能都有这些关键包的不同版本，如果这些团队成员运行彼此的代码，就会导致可重复性问题。
- en: B.2 Containers to deal with dependency hell
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.2 解决依赖地狱的容器
- en: 'This frustrating and time-wasting endeavor of making everything work together
    at all times has multiple solutions. One of the most popular is the prepackaged
    builds that are graciously provided as open source distributions (under a New
    BSD License) to the ML community by the company Anaconda. These tested and validated
    collections of packages are guaranteed to work well with one another, saving you
    from the arduous task of ensuring that behavior for yourself. There are three
    primary ways of creating a new, pristine environment with an Anaconda build of
    Python:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 这种令人沮丧且浪费时间的工作，即始终确保所有东西都能协同工作，有多种解决方案。其中最受欢迎的是由 Anaconda 公司慷慨地作为开源发行版（在新的 BSD
    许可证下）提供给机器学习社区的预包装构建。这些经过测试和验证的软件包集合保证能够很好地协同工作，让您免于自行确保这些软件包的行为。创建一个全新的、纯净的 Python
    环境的 Anaconda 构建，主要有以下三种主要方式：
- en: '*Conda environment manager*—Command-line tool that can create isolated Python
    environments locally from images that will not interfere with system Python installations'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Conda 环境管理器*——命令行工具，可以从不会干扰系统 Python 安装的镜像中在本地创建隔离的 Python 环境'
- en: '*Anaconda Navigator*—GUI that allows for one-click setup of many popular development
    tools using isolated Conda environments on a local machine'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Anaconda Navigator*——图形用户界面，允许在本地机器上使用隔离的 Conda 环境一键设置许多流行的开发工具'
- en: '*Docker Container deployment of a Conda environment for use in a virtual machine
    (VM)*—Portable container definition that will create an isolated Python environment
    with the Conda package build that can run either on a local VM or in a cloud-based
    VM'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Docker 容器部署 Conda 环境，用于在虚拟机（VM）中使用*——可移植的容器定义，将创建一个隔离的 Python 环境，该环境包含 Conda
    包构建，可以在本地虚拟机或基于云的虚拟机中运行'
- en: Figure B.2 shows the first two approaches, which are applicable to ML experimentation
    in Python and use purely open source (free) solutions to isolate the runtime environments.
    The top portion can be done via the command-line interface (CLI) or through the
    Anaconda Navigator GUI.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 图 B.2 展示了前两种方法，这些方法适用于 Python 中的机器学习实验，并使用纯开源（免费）解决方案来隔离运行时环境。顶部部分可以通过命令行界面（CLI）或通过
    Anaconda Navigator 图形用户界面（GUI）完成。
- en: '![B-02](../Images/B-02.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![B-02](../Images/B-02.png)'
- en: Figure B.2 Conda environment management vs. container service environment management.
    Both are good choices for streamlining experimentation, development, and production.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 B.2 Conda 环境管理对比容器服务环境管理。两者都是简化实验、开发和生产的良好选择。
- en: These approaches solve the problem of having version conflicts within different
    project requirements, allowing for a massive savings in time and effort for the
    frustrating work that would otherwise be required to manage all of the packages
    for ML. For further explanation of what Docker is and why it is important, see
    the following sidebar.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这些方法解决了不同项目需求中存在版本冲突的问题，大大节省了时间和精力，否则您将不得不进行令人沮丧的工作来管理所有机器学习软件包。有关 Docker 是什么以及为什么它很重要的进一步解释，请参阅以下侧边栏。
- en: What is Docker?
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 什么是 Docker？
- en: '*Docker* is a containerization service. It is a platform that allows for operating
    system-level virtualization (think: a computer inside a computer) that can be
    configured with resources from the machine it’s running on and can have full process-level
    isolation from other applications and operating system entities on the host machine.'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '*Docker* 是一种容器化服务。它是一个平台，允许操作系统级别的虚拟化（想想：计算机中的计算机），可以配置为使用运行在其上的机器的资源，并且可以从主机机器上的其他应用程序和操作系统实体中实现完全的过程级隔离。'
- en: This allows you to package up your software, libraries needed to run your software,
    and configuration files to run in different environments. You can even open up
    ports to communicate as if the container were its own computer.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 这允许您打包您的软件、运行软件所需的库以及配置文件，以便在不同的环境中运行。您甚至可以打开端口，就像容器是其自己的计算机一样进行通信。
- en: 'Containerization for ML enables you to handle the dependency hell problem:
    each project can have its own set of libraries guaranteed to just work with your
    code in a repeatable and consistent manner. Containerization also gives you the
    ability to run the container in any environment—an on-premises server, a cloud-based
    server, or any virtual machine environment capable of running the container. This
    introduces portability to ML project work that is increasingly becoming not only
    more prevalent in the experimentation phases, but also absolutely critical for
    production-scale ML.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习的容器化使你能够处理依赖地狱问题：每个项目都可以拥有自己的库集合，这些库保证与你的代码以可重复和一致的方式协同工作。容器化还使你能够在任何环境中运行容器——本地服务器、基于云的服务器或任何能够运行容器的虚拟机环境。这为机器学习项目工作引入了可移植性，这在实验阶段越来越普遍，对于生产规模的机器学习来说也绝对至关重要。
- en: B.3 Creating a container-based pristine environment for experimentation
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.3 为实验创建基于容器的原始环境
- en: In this section, we’re going to define and initiate a basic isolated runtime
    environment by using Docker. I’m rather partial to Anaconda for experimentation
    that doesn’t require a paid service, so we’re going to be using one of its preconfigured
    Docker containers that has a bootstrapped environment for Python 3 and the vast
    majority of core ML libraries already installed (well, at least the ones we’ll
    need for this book, at any rate).
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将通过使用Docker定义并初始化一个基本的隔离运行时环境。我相当偏爱Anaconda，因为它不需要付费服务就可以进行实验，所以我们将使用其预配置的Docker容器之一，该容器已经为Python
    3和大多数核心机器学习库搭建了启动环境（至少对于本书中我们需要的功能来说是这样）。
- en: To ensure that we have the image on our system, we’re going to run via the command
    line `docker``pull``continuumio/anaconda3`. This command will fetch the prebuilt
    Docker container from Docker Hub, a repository of Docker images with both free
    and restricted images. The container includes a Linux operating system, the latest
    version of the Anaconda Python stack, and all of the configurations already completed
    for having a fully operable development environment for most DS work tasks with
    nearly no additional action required by the user.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保我们的系统上有这个镜像，我们将通过命令行运行`docker pull continuumio/anaconda3`。这个命令将从Docker Hub获取预构建的Docker容器，Docker
    Hub是一个包含免费和受限镜像的Docker镜像仓库。该容器包括Linux操作系统、Anaconda Python的最新版本，以及为大多数数据科学工作任务提供完全可操作的开发环境所需的所有配置，用户几乎不需要进行任何额外操作。
- en: NOTE It’s always advisable, particularly through the experimentation phase,
    to have an isolated environment where we can, as the kids say, “go absolutely
    nuts” with various packages, versions of those packages, and configurations that
    we might not want to have contaminating our computer’s general environment. There
    is no more exquisite pain than realizing that your other project that you’ve been
    working on is now throwing dozens of exceptions because you updated to a newer
    version of NumPy.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：尤其是在实验阶段，始终建议有一个隔离的环境，我们可以像孩子们说的那样，“尽情地疯狂”使用各种包、这些包的版本以及我们可能不想污染计算机一般环境的配置。没有比意识到你一直在工作的其他项目现在因为更新到NumPy的新版本而抛出成百上千个异常更痛苦的了。
- en: To get a basic ML-enabled environment (a runnable VM image) built for us to
    perform the first phases of testing and research for a project, we can run the
    following (after ensuring that we install Docker, of course).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 为了获得一个基本的机器学习环境（可运行的虚拟机镜像），用于执行项目的测试和研究的初期阶段，我们可以在安装Docker之后运行以下命令。
- en: Listing B.1 Docker run command to create a basic ML environment
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 列表B.1 创建基本机器学习环境的Docker run命令
- en: '[PRE0]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: ❶ Feel free to name the container anything you’d like. If you omit this configuration,
    Docker will choose a fun name for you that makes it impossible to remember what
    is in the container.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 你可以随意命名容器。如果你省略这个配置，Docker会为你选择一个有趣的名字，让你很难记住容器中有什么。
- en: ❷ Absolute path to local filesystem (you hopefully don’t have a root users directory
    of benwilson)—change this.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 本地文件系统的绝对路径（你希望没有benwilson的root用户目录）——需要更改。
- en: ❸ This is the image that we pulled from Docker Hub with the “docker pull continuumio/anaconda3”
    command.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 这是我们使用“docker pull continuumio/anaconda3”命令从Docker Hub拉取的镜像。
- en: ❹ Bash commands to allow us to install Jupyter and set it up to function with
    port forwarding so we can open up a local browser window and interface with the
    container’s environment
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ Bash命令，允许我们安装Jupyter并将其配置为使用端口转发，这样我们就可以打开本地浏览器窗口并与容器的环境交互
- en: Some slight modifications to this script—in particular, overriding the mount
    location (the first portion after the `-v` option that precedes the colon)—and
    a paste into the command line will have the container up and running. After the
    packages are collected and the image is built, the command line will give you
    a hint (a local host reference of `http://127.0.0.7:8888/?token=...`) that you
    can paste into your web browser to bring up Jupyter so you can start writing code
    in a notebook.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 对这个脚本进行一些轻微的修改——特别是覆盖挂载位置（冒号之前带有`-v`选项的第一个部分）——然后将其粘贴到命令行中，容器就会启动并运行。在收集完软件包并构建了镜像之后，命令行会给你一个提示（一个本地主机引用`http://127.0.0.7:8888/?token=...`），你可以将其粘贴到你的网页浏览器中，以便打开Jupyter，这样你就可以开始在笔记本中编写代码了。
- en: NOTE If you have a development environment hosted in the cloud somewhere that
    makes it remarkably easy for someone else to create this pristine environment
    for you, for a nominal fee, feel free to ignore this. This is for all my sisters
    and brothers of the maths who are on the laptop struggle bus with ML.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：如果你在云上托管了一个开发环境，这使得其他人可以非常容易地为你创建这样一个原始环境，只需象征性的费用，那么你可以忽略这一点。这是给所有在笔记本电脑上挣扎学习机器学习的数学姐妹和兄弟们。
