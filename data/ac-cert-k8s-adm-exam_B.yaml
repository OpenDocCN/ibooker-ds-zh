- en: Appendix B. Setting the context for a kind cluster
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 B. 为 kind 集群设置上下文
- en: This appendix shows you how to set the context in a Kubernetes cluster with
    multiple kubeconfig files. You will learn how to use `kubectl config` to determine
    which context you are currently in and how to switch to a different context, which
    should help you to become comfortable accessing multiple clusters for the CKA
    exam.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录向您展示如何在具有多个 kubeconfig 文件的 Kubernetes 集群中设置上下文。您将学习如何使用 `kubectl config`
    确定您当前所在的上下文以及如何切换到不同的上下文，这应该有助于您在 CKA 考试中舒适地访问多个集群。
- en: B.1 Setting the context with kubeconfig
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.1 使用 kubeconfig 设置上下文
- en: As you learned in chapter 3, you can have multiple kubeconfig files that pertain
    to different clusters, or you can merge all the cluster-access information into
    one kubeconfig file. You can now read the individual kubeconfig file and its contents.
    This kubeconfig file (named `admin.conf`) is located in the `/etc/kubernetes/`
    directory. During the bootstrap process, the file is copied, renamed to `config`,
    and placed into the `~/.kube/` directory. Why is this? Well, `/etc` is a system
    directory, which requires root privilege to access. Because you’re running `kubectl`
    commands as a regular user (not root), copying it to your home directory allows
    full ownership of the file. Simply running the command `kind get kubeconfig --name
    "kind"` will allow you to view the contents of that kubeconfig file(`~/.kube/config`).
    Similarly, you can view the contents of the kubeconfig file with the command `kubectl
    config view --minify``.`
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您在第 3 章中学到的，您可以有多个与不同集群相关的 kubeconfig 文件，或者您可以将所有集群访问信息合并到一个 kubeconfig 文件中。您现在可以阅读单个
    kubeconfig 文件及其内容。此 kubeconfig 文件（命名为 `admin.conf`）位于 `/etc/kubernetes/` 目录中。在引导过程中，该文件被复制，重命名为
    `config` 并放置在 `~/.kube/` 目录中。为什么是这样呢？因为 `/etc` 是一个系统目录，需要 root 权限才能访问。由于您是以普通用户（而非
    root）运行 `kubectl` 命令，将其复制到您的家目录允许对文件拥有完全所有权。只需运行命令 `kind get kubeconfig --name
    "kind"` 就可以查看该 kubeconfig 文件的内容（`~/.kube/config`）。同样，您可以使用命令 `kubectl config view
    --minify` 来查看 kubeconfig 文件的内容。
- en: 'Alternatively, you can use a kubeconfig file that’s in a different location
    that can be set with the `KUBECONFIG` environment variable. If you get a shell
    inside the `kind-control-plane` container again, you’ll see the environment variable
    is already set. You can echo the environment variable with the command `echo $KUBECONFIG`:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您可以使用位于不同位置的 kubeconfig 文件，该文件可以通过 `KUBECONFIG` 环境变量进行设置。如果您再次进入 `kind-control-plane`
    容器中的 shell，您会看到环境变量已经设置。您可以使用命令 `echo $KUBECONFIG` 来输出环境变量：
- en: '[PRE0]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Let’s say you have an additional kubeconfig file named `config2.` This file
    is in the `~/Downloads` directory, but you still want `kubectl` to use it to access
    your Kubernetes cluster. You can tell `kubectl` to use that kubeconfig file to
    authenticate to your cluster by typing `export KUBECONFIG=~/Downloads/config2`,
    and from that point forward, it will access the cluster using that `config2` kubeconfig
    file. If you want to use two different kubeconfig files, both of which are located
    in different directories, you can type `export KUBECONFIG=~/.kube/config:~/Downloads/config2`
    and use both. To access each cluster, you can switch contexts by using the command
    `kubectl config use-context`:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 假设您有一个名为 `config2` 的附加 kubeconfig 文件。此文件位于 `~/Downloads` 目录中，但您仍然希望 `kubectl`
    使用它来访问您的 Kubernetes 集群。您可以通过输入 `export KUBECONFIG=~/Downloads/config2` 来告诉 `kubectl`
    使用该 kubeconfig 文件对集群进行身份验证，从那时起，它将使用该 `config2` kubeconfig 文件访问集群。如果您想使用两个不同的
    kubeconfig 文件，这两个文件位于不同的目录中，您可以输入 `export KUBECONFIG=~/.kube/config:~/Downloads/config2`
    并使用它们。要访问每个集群，您可以通过使用命令 `kubectl config use-context` 来切换上下文：
- en: '[PRE1]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: You will need to know how to switch contexts for the exam; however, the exam
    instructions will tell you how to do it. There will be multiple contexts on the
    exam because each question will contain one or more tasks to perform on different
    clusters. You will need to switch to a new context each time the exam prompts
    you to do so to proceed with completing the given task.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要知道如何切换上下文以进行考试；然而，考试说明将告诉您如何操作。考试中将有多个上下文，因为每个问题都包含在多个集群上执行的一个或多个任务。每次考试提示您进行操作以完成给定任务时，您都需要切换到新的上下文。
- en: B.2 Setting an alias for kubectl
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.2 为 kubectl 设置别名
- en: 'You can set an abbreviated name for `kubectl`, as it might be time-consuming
    to type `kubectl` over and over again. This is called an alias, and the most common
    alias is `k`. For example, instead of typing `kubectl get no`, you can type `k
    get no` with the alias set to `k`. To set the alias, type the command `alias k=kubectl`
    from within the control plane Bash shell (e.g., `docker exec -it kind-control-plane
    bash`). Then type the command `k get no` to verify that the alias was set correctly.
    The output should look similar to this:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以为 `kubectl` 设置一个缩写名称，因为反复输入 `kubectl` 可能会耗费时间。这被称为别名，最常用的别名是 `k`。例如，设置别名后，你可以输入
    `k get no` 而不是 `kubectl get no`。要设置别名，请在控制平面 Bash shell 中输入命令 `alias k=kubectl`（例如，`docker
    exec -it kind-control-plane bash`）。然后输入命令 `k get no` 以验证别名是否设置正确。输出应类似于以下内容：
- en: '[PRE2]'
  id: totrans-11
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'If you want the setting to persist after you exit the shell and reenter, you
    can add it to the .bashrc file in your home folder. An easy way to do this is
    by typing the command `echo ''alias k=kubectl'' >> ~/.bashrc` from a Bash shell
    to the control plane node. Then type `source ~/.bashrc` to have this implemented
    immediately, or simply log out and back in again. The output should look similar
    to this:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想在退出 shell 并重新进入后设置保持设置，你可以将其添加到主目录中的 .bashrc 文件中。一种简单的方法是在 Bash shell 中输入命令
    `echo 'alias k=kubectl' >> ~/.bashrc` 到控制平面节点。然后输入 `source ~/.bashrc` 以立即实施此设置，或者简单地注销并重新登录。输出应类似于以下内容：
- en: '[PRE3]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: B.3 Setting kubectl autocomplete
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.3 设置 kubectl 自动完成
- en: Setting autocomplete is important for the exam because Kubernetes resources
    contain complex names that are prone to typos. Always use copy and paste when
    you can, and also use autocomplete when you are using `kubectl` to navigate namespaces
    and resource names. For example, typing `k -n c10` followed by pressing the Tab
    key will autocomplete the name of the namespace as `k -n c103832034`. Using autocomplete
    will save you time on the exam and also help prevent typos.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在考试中设置自动完成功能非常重要，因为 Kubernetes 资源包含复杂名称，容易出错。尽可能使用复制粘贴，并在使用 `kubectl` 导航命名空间和资源名称时使用自动完成功能。例如，输入
    `k -n c10` 然后按 Tab 键将自动完成命名空间名称为 `k -n c103832034`。使用自动完成功能可以在考试中节省时间，并有助于防止出错。
- en: 'Setting the autocomplete parameters in kind is a matter of running the following
    commands in this order:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在 kind 中设置自动完成参数的问题在于按照以下顺序运行以下命令：
- en: '[PRE4]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Run these one by one in the command line, inside of a shell to the control plane
    node (i.e., `docker exec -it kind-control-plane bash`).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在命令行中逐个运行这些命令，在控制平面节点（即，`docker exec -it kind-control-plane bash`）的 shell 中。
