- en: Appendix A. A “hello world” deep learning system
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录A. 一个“hello world”深度学习系统
- en: This book is about teaching design principles for building a deep learning system
    that fits your own situation. But you may be wondering what a deep learning system
    even looks like. Or how, why, and when people can use a system like this in practice.
    These are all great questions at this stage.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书是关于教授构建适合您自身情况深度学习系统设计原则的。但您可能想知道一个深度学习系统究竟是什么样子。或者人们如何在实践中使用这样的系统，为什么以及何时使用。这些问题在这个阶段都非常重要。
- en: We believe the best method for learning new ideas, skills, and approaches is
    by doing—by getting your hands on some examples and seeing what you can do with
    them. To help you, we built a mini deep learning system and a code lab for you
    to play with. Playing around in this “hello world” deep learning system should
    help you build the knowledge base for understanding the concepts and principles
    introduced in this book. To make this sample system easy to digest, we focus on
    the key components of a deep learning system, such as dataset management (DM)
    and model training and serving. The entire mini system can be set up easily on
    your local system with a bash script, and its components are discussed in detail
    in the later chapters.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们认为学习新想法、技能和方法的最佳方法是实践——通过接触一些示例并看看你能用它们做什么。为了帮助您，我们为您构建了一个迷你深度学习系统和代码实验室，让您可以尝试。在这个“hello
    world”深度学习系统中玩耍应该有助于您建立理解本书中介绍的概念和原则的知识基础。为了使这个示例系统易于消化，我们专注于深度学习系统的关键组件，如数据集管理（DM）和模型训练及部署。整个迷你系统可以通过bash脚本来轻松设置在您的本地系统上，其组件将在后续章节中详细讨论。
- en: In this appendix, we will first take a tour of our sample system and then run
    the lab exercise to let you experience the most common user activities in a deep
    learning system, including dataset ingestion, model training, and model serving.
    Although our sample system is extremely simplified, it covers all the basics of
    a deep learning system. By reading this appendix, you will not only gain a practical
    understanding of how a basic deep learning system is organized and how it functions,
    but you will also have a holistic view of the sample services that are discussed
    in the rest of the book.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个附录中，我们将首先参观我们的示例系统，然后运行实验室练习，让您体验深度学习系统中最常见的用户活动，包括数据集摄入、模型训练和模型部署。虽然我们的示例系统非常简化，但它涵盖了深度学习系统的所有基础知识。通过阅读这个附录，您不仅将获得对基本深度学习系统组织结构和功能运作的实用理解，还将对本书其余部分讨论的示例服务有一个全面的认识。
- en: A.1 Introducing the “hello world” deep learning system
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: A.1 介绍“hello world”深度学习系统
- en: 'The quickest way to understand a software system is from the user’s perspective.
    So in this introduction section, we will first look at the users of a deep learning
    system: the personas and their responsibilities. Then we will dive into system
    design, the major components, and the user workflows.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 理解软件系统的最快方式是从用户的角度出发。因此，在本介绍部分，我们将首先查看深度学习系统的用户：人员角色及其职责。然后我们将深入探讨系统设计、主要组件和用户工作流程。
- en: A.1.1 Personas
  id: totrans-6
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.1 人员角色
- en: 'To keep the complexity to a minimum, our sample mini deep learning system only
    has four *personas*, or *roles*: data engineer, data scientist/researcher, system
    developer, and deep learning application developer. We pick these four roles because
    they are the minimum personnel needed to keep a deep learning system functioning.
    The role definition and job description of each persona in this “hello world”
    system are listed in the following sections.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 为了将复杂性降到最低，我们的示例迷你深度学习系统只有四个*人员角色*或*角色*：数据工程师、数据科学家/研究员、系统开发人员和深度学习应用开发者。我们选择这四个角色，因为它们是维持深度学习系统运行所需的最少人员。这个“hello
    world”系统中每个人员角色的定义和职位描述将在以下章节中列出。
- en: Note The role responsibilities described here are oversimplified because we
    want to concentrate on the most fundamental workflows of a deep learning system.
    For more detailed definitions of the personas and roles involved in a deep learning
    system, please refer to section 1.1.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：这里描述的角色职责被简化了，因为我们想集中精力讨论深度学习系统最基本的工作流程。有关深度学习系统中涉及的人员角色和职责的更详细定义，请参阅第1.1节。
- en: A.1.2 Data engineers
  id: totrans-9
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.2 数据工程师
- en: Data engineers are responsible for collecting, processing, and storing the raw
    data for deep learning training. We have a DM service in this mini system to store
    datasets for model training. Data engineers will use this service to upload the
    raw training data. In our lab exercise, we prepared some intent classification
    datasets for you to experience this process.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 数据工程师负责收集、处理和存储深度学习训练的原始数据。在我们的迷你系统中，我们有一个DM服务来存储用于模型训练的数据集。数据工程师将使用此服务上传原始训练数据。在我们的实验室练习中，我们为您准备了一些意图分类数据集，让您体验这个过程。
- en: A.1.3 Data scientists/researchers
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.3 数据科学家/研究人员
- en: Data scientists or researchers develop training algorithms and produce models
    that meet business requirements. They are the *customers* of the model training
    infrastructure in a deep learning system.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学家或研究人员开发训练算法并生成满足业务需求模型。他们是深度学习系统中模型训练基础设施的*客户*。
- en: Our example system contains a training service to run model training code. In
    the lab, we prebuilt an intent classification training code for you to experience
    the model training execution.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的示例系统包含一个训练服务来运行模型训练代码。在实验室中，我们预先构建了一个意图分类训练代码，让您体验模型训练执行。
- en: A.1.4 System developer
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.4 系统开发者
- en: System developers build the entire deep learning system and maintain it to make
    sure all the machine learning activities are functioning well. Their activities
    include dataset uploading, model training, and model serving.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 系统开发者构建整个深度学习系统并维护它，以确保所有机器学习活动都能正常运行。他们的活动包括数据集上传、模型训练和模型服务。
- en: A.1.5 Deep learning application developers
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.5 深度学习应用开发者
- en: Deep learning application developers utilize deep learning models to build commercial
    products, such as chatbots, self-driving software, and facial recognition mobile
    apps. These applications are the most important customers of any deep learning
    system because they create the business impact (revenue) for the models produced
    by the system. In our lab, you will have the opportunity to imagine yourself as
    a chatbot customer by running a script to send requests to the prediction service
    and categorize your message.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 深度学习应用开发者利用深度学习模型构建商业产品，例如聊天机器人、自动驾驶软件和面部识别移动应用。这些应用是任何深度学习系统最重要的客户，因为它们为系统产生的模型创造了商业影响（收入）。在我们的实验室中，您将有机会通过运行脚本来向预测服务发送请求并分类您的消息，想象自己成为聊天机器人客户。
- en: A.1.6 Sample system overview
  id: totrans-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.6 示例系统概述
- en: 'Our mini deep learning system consists of four services and one storage system:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的小型深度学习系统由四个服务和一套存储系统组成：
- en: '*Data service*—Designed for storing and fetching dataset'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数据服务*—设计用于存储和检索数据集'
- en: '*Model training service*—Designed for running model training code'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型训练服务*—设计用于运行模型训练代码'
- en: '*Metadata store service*—Designed for storing model metadata, such as model
    name, model version, and model algorithm'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*元数据存储服务*—设计用于存储模型元数据，例如模型名称、模型版本和模型算法'
- en: '*Prediction service*—Designed to execute models to process customer’s prediction
    requests'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*预测服务*—设计用于执行模型以处理客户的预测请求'
- en: '*MinIO storage*—Designed to run on your local computer as an object storage
    similar to Amazon S3'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*MinIO存储*—设计用于在您的本地计算机上运行，类似于Amazon S3的对象存储'
- en: Almost all these services have their own chapters in this book, so we will be
    able to study them in more detail. For now, we just want to provide you with the
    high-level overview you’ll need to comprehend the user scenarios and lab exercises
    later in the book. Figure A.1 illustrates the major components of the sample system
    (the four services and the storage system) along with their interdependencies.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎所有这些服务在这本书中都有自己的章节，因此我们将能够更详细地研究它们。目前，我们只想为您提供您在书中稍后需要理解用户场景和实验室练习所需的高级概述。图A.1展示了示例系统的主要组件（四个服务和存储系统）及其相互依赖关系。
- en: '![](../Images/A-1.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/A-1.png)'
- en: Figure A.1 The design overview of the sample deep learning system
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.1 示例深度学习系统的设计概述
- en: 'Along with the four services and storage (in rectangular boxes), you’ll notice
    lots of directed arrows between these boxes. These arrows show the interdependencies
    of the services inside the sample system. Here are the explanations for these
    dependencies:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 除了四个服务和存储（在矩形框中）外，您还会注意到这些框之间有很多有向箭头。这些箭头显示了示例系统内部服务的相互依赖关系。以下是这些依赖关系的解释：
- en: The DM service saves the dataset to MinIO storage.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DM服务将数据集保存到MinIO存储。
- en: The model training service queries DM to prepare the training dataset and obtain
    the training data.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型训练服务查询DM以准备训练数据集并获取训练数据。
- en: The model training service downloads training data from MinIO.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型训练服务从MinIO下载训练数据。
- en: The model training service saves model files to MinIO.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型训练服务将模型文件保存到MinIO。
- en: The model training service saves model metadata to the metadata store service.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型训练服务将模型元数据保存到元数据存储服务。
- en: The prediction service queries the metadata store to determine which model to
    use.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预测服务查询元数据存储以确定使用哪个模型。
- en: The prediction service downloads model files from MinIO to serve the prediction
    request.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预测服务从MinIO下载模型文件以处理预测请求。
- en: A.1.7 User workflows
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.1.7 用户工作流程
- en: Now that we have introduced the personas and the main services, let’s look at
    the user workflows. Figure A.2 illustrates the user workflow for each persona.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经介绍了角色和主要服务，让我们来看看用户工作流程。图A.2说明了每个角色的用户工作流程。
- en: '![](../Images/A-2.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/A-2.png)'
- en: Figure A.2 Four different workflows are enabled in the system for DM, training,
    serving, and system maintenance.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.2 系统中启用了四个不同的工作流程，用于数据管理、训练、服务和系统维护。
- en: 'Figure A.2 shows each persona using the mini deep learning system to perform
    its own task by utilizing the services introduced in figure A.1\. Let’s review
    each of these workflows:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图A.2显示了每个角色通过利用图A.1中介绍的服务来执行自己的任务。让我们回顾一下这些工作流程：
- en: '*Scenario A*—Data engineers call the DM service to upload raw data; DM ingests
    the data and saves it to MinIO storage in a training dataset format.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*场景A*—数据工程师调用DM服务上传原始数据；DM摄取数据并将其保存到MinIO存储中，以训练数据集格式。'
- en: '*Scenario B*—Data scientists first write the training code and then submit
    a training request to the training service. The training service executes the
    training code and produces the model. It then saves model metadata to the metadata
    store and saves model files to MinIO storage.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*场景B*—数据科学家首先编写训练代码，然后将训练请求提交给训练服务。训练服务执行训练代码并生成模型。然后，它将模型元数据保存到元数据存储，并将模型文件保存到MinIO存储。'
- en: '*Scenario C*—Application developers build applications to call the prediction
    service to consume the model trained in scenario B.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*场景C*—应用开发者构建应用程序以调用预测服务来消费在场景B中训练的模型。'
- en: '*Scenario D*—System developers build and maintain this system.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*场景D*—系统开发者构建并维护此系统。'
- en: A.2 Lab demo
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: A.2 实验室演示
- en: Now it’s time for you to start learning by doing. In this lab exercise, you
    will engage in the user scenarios mentioned in section A.1.3 on your local computer.
    To make this exercise more vivid, we introduced some characters so you will not
    only know how to work with a deep learning system but also understand who handles
    each different job. The fictitious characters include Ivan, a data scientist;
    Feng, a data engineer; Tang, a system developer; and Johanna, an application developer.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是时候通过实践开始学习了。在这个实验室练习中，您将在本地计算机上参与A.1.3节中提到的用户场景。为了使这个练习更加生动，我们引入了一些角色，这样您不仅会知道如何与深度学习系统协同工作，而且还会了解谁负责每个不同的工作。虚构的角色包括Ivan，一位数据科学家；Feng，一位数据工程师；Tang，一位系统开发者；以及Johanna，一位应用开发者。
- en: A.2.1 Demo steps
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.2.1 演示步骤
- en: 'In this demo scenario, we will have Tang, Feng, Ivan, and Johanna work together
    to train an intent classification model and use the model to classify arbitrary
    text messages. This scenario simulates the four fundamental steps of a typical
    model development workflow: system setup, dataset building, model training, and
    model serving.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个演示场景中，我们将让Tang、Feng、Ivan和Johanna一起工作，以训练一个意图分类模型，并使用该模型对任意文本消息进行分类。这个场景模拟了典型模型开发工作流程的四个基本步骤：系统设置、数据集构建、模型训练和模型服务。
- en: To make the lab easy to run, we Dockerized all the microservices and built shell
    scripts to automate the lab setup and demo scenarios. By following the instructions
    in the README file ([https://github.com/orca3/MiniAutoML#lab](https://github.com/orca3/MiniAutoML#lab))
    at our GitHub repo ([https://github.com/orca3/MiniAutoML](https://github.com/orca3/MiniAutoML)),
    you can complete the lab by running four shell scripts.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使实验室易于运行，我们将所有微服务Docker化，并构建了shell脚本来自动化实验室设置和演示场景。按照我们GitHub仓库（[https://github.com/orca3/MiniAutoML](https://github.com/orca3/MiniAutoML)）中README文件（[https://github.com/orca3/MiniAutoML#lab](https://github.com/orca3/MiniAutoML#lab)）中的说明，您可以通过运行四个shell脚本来完成实验室。
- en: Note You can find the lab demo scripts in the scripts folder ([https://github.com/orca3/MiniAutoML/tree/main/scripts](https://github.com/orca3/MiniAutoML/tree/main/scripts))
    at our GitHub repo ([https://github.com/orca3/MiniAutoML](https://github.com/orca3/MiniAutoML)).
    The scripts folder contains the demo scripts for the entire book. The files starting
    with *lab-* are used in this demo—for example, the `lab-001-start-all.sh` ([http://mng.bz/zmv1](http://mng.bz/zmv1))
    can be set up on your local system. In the case of future updates, and to execute
    the lab scripts successfully, please always refer to the instructions in the GitHub
    repo.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 注意您可以在我们的GitHub仓库([https://github.com/orca3/MiniAutoML/tree/main/scripts](https://github.com/orca3/MiniAutoML/tree/main/scripts))的scripts文件夹中找到实验室演示脚本。该scripts文件夹包含整本书的演示脚本。以*lab-*开头的文件用于此演示——例如，`lab-001-start-all.sh`
    ([http://mng.bz/zmv1](http://mng.bz/zmv1))可以在您的本地系统上设置。在未来的更新中，以及为了成功执行实验室脚本，请始终参考GitHub仓库中的说明。
- en: '*Step 1 is the system setup.* Run `scripts/lab-001-start-all.sh` ([http://mng.bz/zmv1](http://mng.bz/zmv1)).'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '*步骤1是系统设置。* 运行`scripts/lab-001-start-all.sh` ([http://mng.bz/zmv1](http://mng.bz/zmv1))。'
- en: Tang (system developer) lights up the mini deep learning system by running the
    `scripts/lab-001-start-all.sh` script. The script will download the prebuilt Docker
    images of the demo services and execute them.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 唐恩（系统开发者）通过运行`scripts/lab-001-start-all.sh`脚本点亮了迷你深度学习系统。该脚本将下载预构建的演示服务Docker镜像并执行它们。
- en: 'When the script finishes, the mini deep learning system is up and running.
    You can use the following command to list all the local running Docker containers
    to verify that all the services are running:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 当脚本完成后，迷你深度学习系统启动并运行。您可以使用以下命令列出所有本地运行的Docker容器，以验证所有服务是否正在运行：
- en: '[PRE0]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: The Docker containers required to run the lab are provided in the following
    listing.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 运行实验室所需的Docker容器如下所示。
- en: Listing A.1 Verifying all system components are running
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 列表A.1 验证所有系统组件正在运行
- en: '[PRE1]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Once Tang verifies that all the microservices are running, the system is ready
    to use. He informs Ivan and Feng to start their work.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦唐恩验证所有微服务正在运行，系统就准备好使用。他通知伊万和冯开始他们的工作。
- en: note If you read the `lab-001-start-all.sh`, you will find that most of the
    services—such as data management and model training—in the system (except predictors)
    are packaged into one Docker image (`orca3/services`). This is not a recommended
    pattern for production use cases, but it fits our demo needs here since it uses
    less disk space and it’s simple to execute.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: note 如果您阅读了`lab-001-start-all.sh`，您会发现系统中的大多数服务（除预测器外）——如数据管理和模型训练——都被打包到一个Docker镜像（`orca3/services`）中。这不是推荐的生产用例模式，但在这里它符合我们的演示需求，因为它占用的磁盘空间更少，执行起来更简单。
- en: '*Step 2 is building a training dataset.* Run `scripts/lab-002-upload-data.sh`
    ([http://mng.bz/0yqJ](http://mng.bz/0yqJ)).'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '*步骤2是构建训练数据集。* 运行`scripts/lab-002-upload-data.sh` ([http://mng.bz/0yqJ](http://mng.bz/0yqJ))。'
- en: Feng (data engineer) first downloads raw data from the internet and applies
    some modifications for training (see `scripts/prepare_data.py` at [http://mng.bz/KlKX](http://mng.bz/KlKX)).
    Feng then uploads the processed data to the DM service. Once the dataset upload
    completes, DM returns a unique dataset ID for future reference.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 冯（数据工程师）首先从互联网下载原始数据，并对训练进行了一些修改（见[http://mng.bz/KlKX](http://mng.bz/KlKX)上的`scripts/prepare_data.py`）。冯然后将处理后的数据上传到DM服务。一旦数据集上传完成，DM将返回一个唯一的标识符供将来参考。
- en: We automated Feng’s work in the `scripts/lab-002-upload-data.sh` script. After
    executing this script, a dataset is created. You can see a JSON object being printed
    out by the DM service in your terminal. This JSON object presents the metadata
    of a dataset; see the following example.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在`scripts/lab-002-upload-data.sh`脚本中自动化了冯的工作。执行此脚本后，将创建一个数据集。您可以在终端中看到DM服务打印出的JSON对象。此JSON对象表示数据集的元数据；请参见以下示例。
- en: Listing A.2 A sample dataset metadata in DM service
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 列表A.2 DM服务中的示例数据集元数据
- en: '[PRE2]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: ❶ Dataset identifier
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 数据集标识符
- en: ❷ Dataset name
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 数据集名称
- en: ❸ Dataset type
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 数据集类型
- en: ❹ Dataset audit history
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 数据集审计历史
- en: Dataset metadata is discussed in detail in chapter 2\. For now, we can ignore
    most attributes of the metadata JSON object and only pay attention to the `dataset_id`
    attribute. *Dataset ID* is a unique identifier for a dataset; you need to pass
    this ID to the training service for model training in step 3\. Once the dataset
    is ready, Feng informs Ivan to start model training with `dataset_id="1"`.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集元数据在第二章中详细讨论。目前，我们可以忽略元数据JSON对象的大部分属性，只需关注 `dataset_id` 属性。*数据集ID* 是数据集的唯一标识符；您需要在第3步中传递此ID以进行模型训练。一旦数据集准备就绪，Feng会通知Ivan使用
    `dataset_id="1"` 开始模型训练。
- en: '*Step 3 is model training.* Run `scripts/lab-003-first-training.sh` ([http://mng.bz/vnra](http://mng.bz/vnra)).'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '*第3步是模型训练。* 运行 `scripts/lab-003-first-training.sh` ([http://mng.bz/vnra](http://mng.bz/vnra))。'
- en: Ivan (the data scientist) first builds the intent classification training code
    (`training-code/text-classification` at [https://github.com/orca3/MiniAutoML/tree/main/training-code/text-classification](https://github.com/orca3/MiniAutoML/tree/main/training-code/text-classification))
    and packages it into a Docker image ([http://mng.bz/WA5g](http://mng.bz/WA5g)).
    Next, Ivan submits a training request to the model training service to create
    a model training job. In the training request, he specifies which dataset (dataset
    ID) and training algorithm (Docker image name) to use in training.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: Ivan（数据科学家）首先构建了意图分类训练代码 (`training-code/text-classification` 在 [https://github.com/orca3/MiniAutoML/tree/main/training-code/text-classification](https://github.com/orca3/MiniAutoML/tree/main/training-code/text-classification))
    并将其打包成一个Docker镜像 ([http://mng.bz/WA5g](http://mng.bz/WA5g))。接下来，Ivan向模型训练服务提交训练请求以创建模型训练作业。在训练请求中，他指定了在训练中使用的哪个数据集（数据集ID）和训练算法（Docker镜像名称）。
- en: note In this lab, we use a hardcoded dataset ID `"1"`. To test other datasets,
    please feel free to set any other dataset ID into the training request.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: note 在本实验中，我们使用硬编码的数据集ID `"1"`。要测试其他数据集，请随意将任何其他数据集ID设置到训练请求中。
- en: Once the training service receives the training request, it will launch a Docker
    container to run the intent classification training code provided by Ivan. In
    our demo, the Docker image is `orca3/intent-classification` ([http://mng.bz/WA5g](http://mng.bz/WA5g)).
    See code listing A.3 for a sample gRPC training request. Please run the lab script
    (`scripts/lab-003-first-training.sh` at [http://mng.bz/916j](http://mng.bz/916j))
    to kick off a model training job, which sets up the dependencies and parameters.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦训练服务收到训练请求，它将启动一个Docker容器来运行Ivan提供的意图分类训练代码。在我们的演示中，Docker镜像为 `orca3/intent-classification`
    ([http://mng.bz/WA5g](http://mng.bz/WA5g))。请参阅代码列表A.3中的示例gRPC训练请求。请运行实验脚本 (`scripts/lab-003-first-training.sh`
    在 [http://mng.bz/916j](http://mng.bz/916j)) 以启动模型训练作业，该作业设置依赖项和参数。
- en: Listing A.3 Submitting a training job to a training service
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 列表A.3 向训练服务提交训练作业
- en: '[PRE3]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: ❶ Training the Docker image name
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 训练的Docker镜像名称
- en: ❷ The ID of the dataset to train
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 训练数据集的ID
- en: ❸ Dataset version
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 数据集版本
- en: ❹ Training hyperparameters
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 训练超参数
- en: Once the training job starts, the training service will keep monitoring the
    training execution status and return a job ID for tracking purposes. With the
    job ID, Ivan can fetch the latest training job status and training metadata by
    querying the `GetTrainingStatus` API of the training service and the `GetRunStatus`
    API of the metastore service. See the sample query requests as follows.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦训练作业开始，训练服务将不断监控训练执行状态，并为跟踪目的返回一个作业ID。有了作业ID，Ivan可以通过查询训练服务的 `GetTrainingStatus`
    API 和元数据存储服务的 `GetRunStatus` API 来获取最新的训练作业状态和训练元数据。以下是一些示例查询请求。
- en: Listing A.4 Querying the model training job status and model metadata
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 列表A.4 查询模型训练作业状态和模型元数据
- en: '[PRE4]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: ❶ Model ID, also the training job ID
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 模型ID，也是训练作业ID
- en: 'The training service can return training execution status in real time; see
    the sample response as follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 训练服务可以实时返回训练执行状态；以下是一个示例响应：
- en: '[PRE5]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: ❶ Training completes
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 训练完成
- en: 'Because the training Docker container reports real-time metrics, such as training
    accuracy, to the metadata store during training execution, the metadata store
    service can return real-time training metrics. See the sample model training metrics
    from the metadata store service as follows:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 因为训练Docker容器在训练执行期间向元数据存储报告实时指标，例如训练准确率，元数据存储服务可以返回实时训练指标。以下是从元数据存储服务获取的示例模型训练指标：
- en: '[PRE6]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: ❶ Training status
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 训练状态
- en: ❷ The last message from the training container
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 训练容器最后一条消息
- en: ❸ The training job ID, as well as the model ID
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 训练作业ID以及模型ID
- en: ❹ The dataset identifier
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 数据集标识符
- en: ❺ Training metric per epoch
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ❺ 每个epoch的训练指标
- en: After training is completed, Ivan informs Johanna that the model is ready to
    consume. In our lab, he passes the model ID (job ID = `"1"`) to Johanna so she
    knows which model to use.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 训练完成后，Ivan通知Johanna模型已经准备好使用。在我们的实验室中，他将模型ID（作业ID = `"1"`)传递给Johanna，以便她知道使用哪个模型。
- en: Note All the API requests described in code listings A.3 and A.4 are automated
    in `scripts/lab-003-first-training.sh`; you can execute them in one go. In chapters
    3 and 4, we discuss in detail how the training service works.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: Note 所有的API请求在代码列表A.3和A.4中都被`scripts/lab-003-first-training.sh`自动化；你可以一次性执行它们。在第3章和第4章中，我们详细讨论了训练服务的工作方式。
- en: '*Step 4 is model serving.* Run `scripts/lab-004-model-serving.sh` ([http://mng.bz/815K](http://mng.bz/815K)).'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '*第4步是模型服务*。运行`scripts/lab-004-model-serving.sh` ([http://mng.bz/815K](http://mng.bz/815K))。'
- en: Johanna (application developer) is building a chatbot, so she wants to consume
    the newly trained intent classification model to categorize customers’ questions.
    When Ivan tells Johanna that the model is ready to use, Johanna sends a prediction
    request to the prediction service to test the newly trained model.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: Johanna（应用开发者）正在构建一个聊天机器人，因此她希望使用新训练的意图分类模型来对客户的问题进行分类。当Ivan告诉Johanna模型已经准备好使用时，Johanna向预测服务发送了一个预测请求来测试新训练的模型。
- en: In the prediction request, Johanna specifies the model ID (`runId`) and document,
    where the document is the text message that is being categorized. And the sample
    prediction service will load the model requested in the prediction request automatically.
    You can see a sample gRPC prediction request in the following listing.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在预测请求中，Johanna指定了模型ID（`runId`)和文档，其中文档是被分类的文本消息。样本预测服务将自动加载预测请求中请求的模型。你可以在以下列表中看到一个样本gRPC预测请求。
- en: Listing A.5 A sample model prediction gRPC request
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 列表A.5 一个样本模型预测gRPC请求
- en: '[PRE7]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: ❶ Model ID, as well as the training job ID
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 模型ID以及训练作业ID
- en: ❷ Request body (text)
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 请求体（文本）
- en: 'After executing the query (code listing A.5) or `scripts/lab-004-model-serving.sh`
    in the terminal, you will see output—a predicted category (label) from the intent
    classification model for the given text—from the model serving service as follows:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在终端中执行查询（代码列表A.5）或`scripts/lab-004-model-serving.sh`后，你将看到输出——来自模型服务服务的预测类别（标签）——如下：
- en: '[PRE8]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: ❶ The predict category is “joy.”
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 预测类别是“喜悦”。
- en: note If you encounter any issues while trying to complete the lab, please check
    the latest instructions in the lab section ([https://github.com/orca3/MiniAutoML#lab](https://github.com/orca3/MiniAutoML#lab))
    of our GitHub repo’s README file. We aim to keep these instructions updated if
    the sample system is modified.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: note 如果你在尝试完成实验时遇到任何问题，请检查我们GitHub仓库的README文件中实验部分的最新说明（[https://github.com/orca3/MiniAutoML#lab](https://github.com/orca3/MiniAutoML#lab)）。我们旨在在样本系统修改时保持这些说明的更新。
- en: A.2.2 An exercise to do on your own
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: A.2.2 一个人做的练习
- en: Now that we walked you through a completed model development cycle, it’s homework
    time. Imagine after a successful chatbot release, Johanna’s chatbot service needs
    to support a new category, *optimism*. This new requirement means the current
    intent classification model needs to be retrained to recognize the optimism type
    of text messages.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经向您展示了完整的模型开发周期，现在是做作业的时间了。想象一下，在聊天机器人成功发布后，Johanna的聊天机器人服务需要支持一个新的类别，*乐观*。这个新需求意味着当前的意图分类模型需要重新训练以识别乐观类型的文本消息。
- en: Feng and Ivan need to work together to build a new intent classification model.
    Feng needs to collect more training data with the “optimism” label and add it
    to the current dataset. Although Ivan doesn’t need to change the training code,
    he does need to trigger a training job in the training service with the updated
    dataset to build a new model.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: Feng和Ivan需要一起工作来构建一个新的意图分类模型。Feng需要收集带有“乐观”标签的更多训练数据并将其添加到当前数据集中。尽管Ivan不需要更改训练代码，但他确实需要在训练服务中触发一个带有更新数据集的训练作业来构建一个新模型。
- en: By following the sample queries and scripts in section A.2.1, you should be
    able to complete the tasks for Feng and Ivan. If you want to check your results
    or get help completing these tasks, you can find our solution in the `scripts/lab-005-second-training.sh`
    file. We encourage you to experiment—or play—with this problem yourself before
    checking our solution.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: '通过遵循A.2.1节中的样本查询和脚本，你应该能够完成Feng和Ivan的任务。如果你想检查你的结果或获得帮助完成这些任务，你可以在`scripts/lab-005-second-training.sh`文件中找到我们的解决方案。我们鼓励你在检查我们的解决方案之前自己尝试或玩这个问题的实验。 '
