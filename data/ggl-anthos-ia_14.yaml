- en: 14 Marketplace
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 14 市场概览
- en: Antonio Gulli
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 安东尼奥·古利
- en: This chapter covers
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章节涵盖
- en: The public Google Marketplace
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公共 Google 市场
- en: The private Google Marketplace
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 私有 Google 市场
- en: Deploying a Marketplace solution
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署市场解决方案
- en: Real-world scenarios
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现实场景
- en: Google Cloud Marketplace is a one-stop solution to try, buy, configure, manage,
    and deploy software products. Frequently, multiple vendors offer the same package,
    providing an array of options for your specific use case and industry in terms
    of operative systems, VMs, containers, storage costs, execution environment, and
    SaaS services. Google Cloud offers new users an initial credit that can also be
    used in the Marketplace. As of January 2023, this credit is $300, but it might
    change in the future. In this chapter, we will discuss how you can use Google
    Cloud Marketplace to deploy packages automatically in different Kubernetes environments,
    including Anthos, GKE, and GKE on-prem. When it comes to simplifying the developer
    experience, Marketplaces add value by making it as easy as possible for users
    to install components, while making use of the maintainers’/providers’ opinionated,
    best practice configuration.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: Google Cloud Marketplace 是一个一站式解决方案，用于尝试、购买、配置、管理和部署软件产品。通常，多个供应商提供相同的包，为您的特定用例和行业提供了操作系统、虚拟机、容器、存储成本、执行环境和
    SaaS 服务等方面的多种选择。Google Cloud 为新用户提供了一笔初始信用额度，这笔额度也可以在市场中使用。截至 2023 年 1 月，这笔信用额度为
    300 美元，但未来可能会有所变化。在本章中，我们将讨论如何使用 Google Cloud Marketplace 在不同的 Kubernetes 环境中自动部署包，包括
    Anthos、GKE 和本地 GKE。当涉及到简化开发者体验时，市场通过尽可能简化用户安装组件的过程，同时利用维护者/提供者的最佳实践配置来增加价值。
- en: 14.1 The Google Marketplace
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 14.1 Google 市场
- en: The Google Cloud Platform (GCP) Marketplace website ([http://cloud.google.com/marketplace](http://cloud.google.com/marketplace))
    offers a single place for GCP customers to find free and fee-based applications,
    provided either by Google or third-party partners, who extend what is offered
    in the platform. Deployments can use either default configurations or be specialized
    for specific needs, such as increased memory, storage, or more computational power
    with larger vCPUs. Each package has specific instructions for getting assistance
    after installation. Note that the Marketplace team keeps each image updated to
    fix critical problems and bugs. However, it is your responsibility to update the
    solutions that are already deployed in your environments.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: Google Cloud Platform (GCP) 市场网站 ([http://cloud.google.com/marketplace](http://cloud.google.com/marketplace))
    为 GCP 客户提供了一个单一的地方，用于查找免费和付费应用程序，这些应用程序由 Google 或第三方合作伙伴提供，扩展了平台提供的内容。部署可以使用默认配置，也可以针对特定需求进行定制，例如增加内存、存储或使用更大的
    vCPU 提供更多的计算能力。每个包都有安装后获取帮助的具体说明。请注意，市场团队会持续更新每个镜像，以修复关键问题和错误。然而，更新您环境中已部署的解决方案是您的责任。
- en: 14.1.1 Public Marketplace
  id: totrans-10
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.1.1 公共市场
- en: Currently, more than two thousand solutions are available across GCP, including
    proper application packages and datasets. You can access the GCP Marketplace by
    clicking the Marketplace link in the Cloud console. To select a package, either
    search for a package name or browse using the left-hand pane of the Marketplace
    screen, as shown in figure 14.1\. The solutions from the Marketplace makes it
    easy to deploy new applications with a simple “point-and-click” operation, which
    is the same across multiple environments, either in public clouds or on-prem.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，在 GCP 上有超过两千种解决方案可供使用，包括合适的应用程序包和数据集。您可以通过点击云控制台中的市场链接来访问 GCP 市场。要选择一个包，您可以搜索包名称或使用市场屏幕左侧的面板进行浏览，如图
    14.1 所示。市场中的解决方案使得通过简单的“点击”操作部署新应用程序变得容易，这在多个环境中都是一样的，无论是在公共云还是在本地。
- en: '![14-01](../../OEBPS/Images/14-01.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![14-01](../../OEBPS/Images/14-01.png)'
- en: Figure 14.1 Accessing the Marketplace via the GCP console and listing packages
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.1 通过 GCP 控制台访问市场并列出包
- en: For the scope of this book, we are interested in applications running on Kubernetes.
    From the Google Cloud Marketplace website, choose Explore the Marketplace, and
    you will reach the Marketplace offerings ([http://mng.bz/41Nv](http://mng.bz/41Nv)).
    In the Type pane on the left, choose Kubernetes Apps. Currently, about 100 solutions
    are available for GKE in different areas such as networking, databases, analytics,
    machine learning, monitoring, storage, and more, as shown in figure 14.2.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本书的范围，我们关注在Kubernetes上运行的应用程序。从Google Cloud Marketplace网站，选择“探索市场”，您将到达市场提供的产品（[http://mng.bz/41Nv](http://mng.bz/41Nv)）。在左侧的类型面板中，选择Kubernetes应用。目前，大约有100种不同领域的解决方案可供GKE使用，包括网络、数据库、分析、机器学习、监控、存储等，如图14.2所示。
- en: '![14-02](../../OEBPS/Images/14-02.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![14-02](../../OEBPS/Images/14-02.png)'
- en: Figure 14.2 Solutions available for the Anthos GKE environment
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.2 Anthos GKE环境可用的解决方案
- en: 'Solutions are categorized according to the license model: either open source,
    paid, or “bring your own license” (BYOL). BYOL is a licensing model that allows
    enterprises to use their licenses flexibly, whether on-prem or in the cloud.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案根据许可模式进行分类：开源、付费或“自带许可证”（BYOL）。BYOL是一种许可模式，允许企业灵活地使用其许可证，无论是在本地还是在云端。
- en: As of March 2023, about 70 solutions have been tested against the GKE on-prem
    environment. We can view the solutions for on-prem by adding the appropriate filter
    deployment-env:gke-on-prem, as shown in figure 14.3, to the search options. As
    of March 2023, 93 solutions have been tested against Anthos environments.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 截至2023年3月，大约有70种解决方案已针对GKE on-prem环境进行了测试。我们可以通过向搜索选项添加适当的过滤器部署-env:gke-on-prem，如图14.3所示，来查看本地解决方案。截至2023年3月，已有93种解决方案针对Anthos环境进行了测试。
- en: '![14-03](../../OEBPS/Images/14-03.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![14-03](../../OEBPS/Images/14-03.png)'
- en: Figure 14.3 Solutions available for Anthos GKE-on-prem environment
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.3 Anthos GKE-on-prem环境可用的解决方案
- en: While browsing the solutions in the marketplace, you can identify third-party
    solutions that are compatible with Anthos by looking for the “Works with Anthos”
    logo attached to the listing. In figure 14.4, you can see solutions that have
    a small Anthos button. This button showcases the solutions that have been certified
    to work with Anthos. These listings conform to the requirements of the Anthos
    Ready program ([https://cloud.google.com/anthos/docs/resources/anthos-ready-partners](https://cloud.google.com/anthos/docs/resources/anthos-ready-partners)),
    which identifies partner solutions that adhere to Google Cloud’s interoperability
    requirements and have been validated to work with the Anthos platform to meet
    the infrastructure and application development needs of enterprise customers.
    To qualify, partner-provided solutions must complete, pass, and maintain integration
    requirements to earn the Works with Anthos badge.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在浏览市场中的解决方案时，您可以通过寻找列表中附带的“与Anthos兼容”标志来识别与Anthos兼容的第三方解决方案。在图14.4中，您可以看到带有小Anthos按钮的解决方案。此按钮展示了经过认证可与Anthos一起工作的解决方案。这些列表符合Anthos
    Ready计划的要求（[https://cloud.google.com/anthos/docs/resources/anthos-ready-partners](https://cloud.google.com/anthos/docs/resources/anthos-ready-partners)），该计划确定了遵守Google
    Cloud互操作性要求的合作伙伴解决方案，并经过验证可与Anthos平台一起工作，以满足企业客户的基础设施和应用开发需求。为了符合条件，合作伙伴提供的解决方案必须完成、通过并维护集成要求，以获得“与Anthos兼容”徽章。
- en: '![14-04](../../OEBPS/Images/14-04.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![14-04](../../OEBPS/Images/14-04.png)'
- en: Figure 14.4 Solutions available for the Anthos environment
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.4 Anthos环境可用的解决方案
- en: If you select one of the offerings that are certified for Anthos, you will see
    the “Works with Anthos” logo in the details screen for the selected offering,
    as shown in figure 14.5.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择了一个经过Anthos认证的提供产品，你将在所选提供产品的详细信息屏幕中看到“与Anthos兼容”的标志，如图14.5所示。
- en: '![14-05](../../OEBPS/Images/14-05.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![14-05](../../OEBPS/Images/14-05.png)'
- en: Figure 14.5 An example solution, certified “Works with Anthos”
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图14.5一个经过认证“与Anthos兼容”的示例解决方案
- en: The public Marketplace provides enterprises with a quick deployment for several
    applications provided by various vendors, including NetApp, Aqua, JFrog, and Citrix.
    But what if you want to add your own solution for your developers? Of course,
    you probably wouldn’t want this included in the public Marketplace, and Google
    accommodates this by offering a private Marketplace, which we will discuss in
    the next section.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 公共市场为各企业提供由NetApp、Aqua、JFrog和Citrix等不同供应商提供的多个应用程序的快速部署。但如果你想要为你的开发者添加自己的解决方案呢？当然，你可能不希望这个解决方案包含在公共市场中，而Google通过提供私有市场来满足这一需求，我们将在下一节中讨论。
- en: 14.1.2 Service Catalog
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.1.2 服务目录
- en: Service Catalog offers Marketplace capabilities to private enterprises to be
    used internally without exposing their internals to the rest of the world. Administrators
    can manage the visibility of applications and deployment rights at organization,
    folder, and project levels. The deployment manager can be used to define preset
    configurations, such as deploy regions, types of servers used for deployment,
    deployments rights, and other parameters, according to enterprise policy.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 服务目录为私有企业提供市场功能，以便内部使用，而不将其内部暴露给世界上的其他人。管理员可以在组织、文件夹和项目级别管理应用程序的可见性和部署权限。部署经理可以根据企业政策定义预设配置，例如部署区域、用于部署的服务器类型、部署权限和其他参数。
- en: '![14-06](../../OEBPS/Images/14-06.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![14-06](../../OEBPS/Images/14-06.png)'
- en: Figure 14.6 Accessing the Service Catalog
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.6 访问服务目录
- en: You can access the Service Catalog via the Cloud console Navigation menu under
    Tools (see figure 14.6). From there, you can create new private Marketplaces,
    add applications, and configure access rights. Each Service Catalog should be
    hosted by a GCP project, and you can add catalog IAM permissions at the folder
    and project level. Sharing a catalog with a GCP organization, folder, or project
    allows customers to share their solutions with their end users. The steps are
    very intuitive, and the interested reader can find more information online ([https://cloud.google.com/service-catalog](https://cloud.google.com/service-catalog)).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过云控制台导航菜单下的工具访问服务目录（见图 14.6）。从那里，您可以创建新的私有市场、添加应用程序和配置访问权限。每个服务目录应由一个 GCP
    项目托管，您可以在文件夹和项目级别添加目录 IAM 权限。与 GCP 组织、文件夹或项目共享目录允许客户与其最终用户共享他们的解决方案。步骤非常直观，感兴趣的读者可以在网上找到更多信息（[https://cloud.google.com/service-catalog](https://cloud.google.com/service-catalog)）。
- en: 14.1.3 Deploying on a GKE on-prem cluster
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.1.3 在 GKE on-prem 集群上部署
- en: 'If you intend to deploy solutions from the Marketplace to an Anthos GKE on-prem
    cluster, then you need to define one or more namespaces on the target clusters
    and annotate them with a Secret, which will allow you to deploy the chosen solutions.
    The following steps are required:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您打算将市场中的解决方案部署到 Anthos GKE 本地集群，那么您需要在目标集群上定义一个或多个命名空间，并使用 Secret 注解它们，这将允许您部署所选的解决方案。以下步骤是必需的：
- en: If your cluster runs Istio, any external connections to third-party services
    are blocked by default, so it’s important to configure Istio egress traffic to
    allow connection to the external OS package repository (see chapter 4).
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您的集群运行 Istio，则默认情况下会阻止对第三方服务的任何外部连接，因此配置 Istio 出站流量以允许连接到外部操作系统软件仓库非常重要（参见第
    4 章）。
- en: You need to allow the downloading of images from the Google Container Registry
    by creating a firewall or proxy rule that allows access to marketplace.gcr.io.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要通过创建允许访问 marketplace.gcr.io 的防火墙或代理规则来允许从 Google 容器注册库下载镜像。
- en: 'In your GKE on-prem cluster, you might need to create a Google Cloud service
    account. This can be done via a cloud shell like this:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的 GKE on-prem 集群中，您可能需要创建一个 Google Cloud 服务账户。这可以通过类似以下方式的云壳完成：
- en: '[PRE0]'
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Sign in to your Anthos GKE on-prem cluster using a token or credentials for
    a Kubernetes Service Account with a Kubernetes cluster-admin role. (Roles were
    discussed in chapter 3.) This would allow you to have superuser access to perform
    any action on any resource.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用令牌或具有 Kubernetes 集群管理员角色的 Kubernetes 服务账户凭据登录到您的 Anthos GKE 本地集群。（角色在第 3 章中讨论过。）这将允许您对任何资源执行任何操作的超用户访问权限。
- en: 'From the console, you can generate a new public/private key-pair downloaded
    to your machine by running the following command:'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从控制台，您可以通过运行以下命令生成一个新的公钥/私钥对并将其下载到您的机器上：
- en: '[PRE1]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'If you are deploying from the Cloud Marketplace for the first time, create
    an application-system namespace in your cluster by running the next command:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您是第一次从云市场部署，请通过运行以下命令在您的集群中创建一个应用-system 命名空间：
- en: '[PRE2]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Then, create the Kubernetes Secret that contains an imagePullSecret for application-system:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，创建包含应用-system 的 imagePullSecret 的 Kubernetes Secret：
- en: '[PRE3]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The next step is to apply imagePullSecret to the default service account in
    the application-system namespace:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是将 imagePullSecret 应用到应用-system 命名空间中的默认服务账户：
- en: '[PRE4]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Finally, for each namespace to which you want to deploy an application, you
    must create a new Secret and annotate the namespace with that Secret with the
    following command:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，对于您想要在其中部署应用程序的每个命名空间，您必须创建一个新的 Secret，并使用以下命令将命名空间注解为该 Secret：
- en: '[PRE5]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Once $NAMESPACE_NAME is defined as explained in the previous step, this namespace
    can be used to install on your on-prem cluster.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦按照上一步所述定义了 $NAMESPACE_NAME，此命名空间就可以用于在您的本地集群上安装。
- en: In other words, deploying on Anthos, whether on GCP or on-prem, is just a matter
    of defining the appropriate namespace on your target Kubernetes clusters and annotating
    the namespace with the Secret keys needed to pull images for your solutions.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，在 Anthos 上部署，无论是在 GCP 上还是在本地，只需在您的目标 Kubernetes 集群上定义适当的命名空间，并用用于拉取解决方案镜像的
    Secret 密钥注解该命名空间即可。
- en: In the next section, we describe how to install several predefined solutions
    belonging to different categories, including modernization tools, databases, monitoring
    and logging, CI/CD, productivity, and machine learning.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍如何安装属于不同类别的几个预定义解决方案，包括现代化工具、数据库、监控和日志、CI/CD、生产力和机器学习。
- en: 14.2 Real-world scenarios
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 14.2 实际场景
- en: In this section, we briefly describe how to deploy Marketplace solutions available
    for Anthos. Our examples are intentionally heterogeneous and belong to different
    categories. Note that after you launch deployments from Cloud Marketplace, you
    can use Google Cloud tools to view, modify, and monitor your deployment. For example,
    you can use Cloud Deployment Manager to add resources to a deployment or remove
    software deployments that you no longer need.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们简要介绍了如何在 Anthos 上部署可用的 Marketplace 解决方案。我们的示例故意具有异质性，并属于不同的类别。请注意，在您从
    Cloud Marketplace 启动部署后，您可以使用 Google Cloud 工具查看、修改和监控您的部署。例如，您可以使用 Cloud Deployment
    Manager 向部署添加资源或删除不再需要的软件部署。
- en: '14.2.1 Example 1: Elasticsearch'
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.2.1 示例 1：Elasticsearch
- en: Elasticsearch is an open source solution for searching and analyzing your data
    in real time. This solution can be deployed on-prem, but this example shows deployment
    on GKE. The solution (see figure 14.7) is available at [http://mng.bz/Q8OQ](http://mng.bz/Q8OQ).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: Elasticsearch 是一个开源解决方案，用于实时搜索和分析您的数据。此解决方案可以本地部署，但此示例展示了在 GKE 上的部署。解决方案（参见图
    14.7）可在 [http://mng.bz/Q8OQ](http://mng.bz/Q8OQ) 获取。
- en: '![14-07](../../OEBPS/Images/14-07.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![14-07](../../OEBPS/Images/14-07.png)'
- en: Figure 14.7 Deploying an Elasticsearch solution
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.7 部署 Elasticsearch 解决方案
- en: After selecting the solution, you can choose the cluster and the namespace where
    it should be deployed (see figure 14.8). In this case, we leave the default choices,
    which will install on a cluster in us-central-1 region with the instance name
    elasticsearch-1 and two replicas.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 选择解决方案后，您可以选择部署的集群和命名空间（参见图 14.8）。在这种情况下，我们保留默认选择，它将在 us-central-1 区域的集群上安装，实例名称为
    elasticsearch-1，并有两个副本。
- en: '![14-08](../../OEBPS/Images/14-08.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![14-08](../../OEBPS/Images/14-08.png)'
- en: Figure 14.8 Deploying an Elasticsearch solution
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.8 部署 Elasticsearch 解决方案
- en: Creating the clusters might take a few minutes (see figure 14.9), which is always
    a good reason to have a coffee break and let Marketplace do all the work.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 创建集群可能需要几分钟（参见图 14.9），这总是喝杯咖啡并让 Marketplace 做所有工作的好理由。
- en: '![14-09](../../OEBPS/Images/14-09.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![14-09](../../OEBPS/Images/14-09.png)'
- en: Figure 14.9 Creating a cluster for the new Elasticsearch solution
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.9 为新的 Elasticsearch 解决方案创建集群
- en: Once the cluster is created, Marketplace will start deploying the solution (see
    figure 14.10).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦集群创建完成，Marketplace 将开始部署解决方案（参见图 14.10）。
- en: '![14-10](../../OEBPS/Images/14-10.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![14-10](../../OEBPS/Images/14-10.png)'
- en: Figure 14.10 Deploying application components for the Elasticsearch solution
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.10 部署 Elasticsearch 解决方案的应用程序组件
- en: When the deployment is successfully executed, you can see the deployed solution
    on your chosen cluster, as shown in figure 14.11—easy, indeed. Marketplace saves
    you a lot of time and speeds up the administrative tasks needed to maintain your
    Anthos applications.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 当部署成功执行后，您可以在选择的集群中看到已部署的解决方案，如图 14.11 所示——确实很简单。Marketplace 节省了您大量时间，并加快了维护
    Anthos 应用程序所需的行政任务。
- en: '![14-11](../../OEBPS/Images/14-11.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![14-11](../../OEBPS/Images/14-11.png)'
- en: Figure 14.11 The Elasticsearch solution deployed
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.11 已部署的 Elasticsearch 解决方案
- en: Once Elasticsearch is deployed from the Marketplace, you can use Anthos to manage
    the cluster. In figure 4.12, you will see CPU, memory, and disk details.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦从 Marketplace 部署了 Elasticsearch，您可以使用 Anthos 来管理集群。在图 4.12 中，您将看到 CPU、内存和磁盘的详细信息。
- en: '![14-12](../../OEBPS/Images/14-12.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![14-12](../../OEBPS/Images/14-12.png)'
- en: Figure 14.12 CPU, memory, and disk monitoring for Elasticsearch deployed from
    Marketplace
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.12 从 Marketplace 部署的 Elasticsearch 的 CPU、内存和磁盘监控
- en: '14.2.2 Example 2: MariaDB'
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.2.2 示例 2：MariaDB
- en: Let’s now focus on how to deploy MariaDB, a popular open source database, which
    was forked from the more popular MySQL relational database management system after
    being acquired by Oracle in 2009\. The solution (see figure 14.13) is available
    at [https://console.cloud.google.com/marketplace/details/google/mariadb](https://console.cloud.google.com/marketplace/details/google/mariadb).
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们关注如何部署 MariaDB，这是一个流行的开源数据库，它在 2009 年被 Oracle 收购后，从更受欢迎的 MySQL 关系型数据库管理系统分支出来。该解决方案（见图
    14.13）可在 [https://console.cloud.google.com/marketplace/details/google/mariadb](https://console.cloud.google.com/marketplace/details/google/mariadb)
    获取。
- en: '![14-13](../../OEBPS/Images/14-13.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![14-13](../../OEBPS/Images/14-13.png)'
- en: Figure 14.13 Deploying a MariaDB solution
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.13 部署 MariaDB 解决方案
- en: In this case, we decide to change the default parameters and require a higher
    number of replicas—two (see figure 14.14).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们决定更改默认参数，并需要更多的副本数——两个（见图 14.14）。
- en: '![14-14](../../OEBPS/Images/14-14.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![14-14](../../OEBPS/Images/14-14.png)'
- en: Figure 14.14 Deploying a MariaDB solution with a higher number of replicas
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.14 使用更多副本数部署 MariaDB 解决方案
- en: The result of our deployment is straightforward (see figure 14.15). Once again,
    Marketplace allows us to save time while administering our Anthos clusters.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们部署的结果很简单（见图 14.15）。再次强调，Marketplace 允许我们在管理 Anthos 集群时节省时间。
- en: '![14-15](../../OEBPS/Images/14-15.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![14-15](../../OEBPS/Images/14-15.png)'
- en: Figure 14.15 MariaDB deployed solution
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.15 部署的 MariaDB 解决方案
- en: Once MariaDB is deployed from the Marketplace, you can use Anthos to manage
    the cluster. Figure 14.16 shows an example of inspecting the cluster and the running
    Pods.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦从 Marketplace 部署了 MariaDB，您就可以使用 Anthos 来管理集群。图 14.16 展示了检查集群和运行中的 Pods 的示例。
- en: '![14-16](../../OEBPS/Images/14-16.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![14-16](../../OEBPS/Images/14-16.png)'
- en: Figure 14.16 MariaDB inspecting the solution deployed from the Marketplace
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.16 检查从 Marketplace 部署的 MariaDB 解决方案
- en: 14.2.3 What we have done so far
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.2.3 我们到目前为止所做的工作
- en: So far, we have installed two applications on Anthos cluster on GKE. If we want
    to check their status, we can access our GKE under Applications, as shown in figure
    14.17.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们在 GKE 的 Anthos 集群上安装了两个应用程序。如果我们想检查它们的状态，我们可以通过应用程序访问我们的 GKE，如图 14.17
    所示。
- en: '![14-17](../../OEBPS/Images/14-17.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![14-17](../../OEBPS/Images/14-17.png)'
- en: Figure 14.17 Solutions deployed via Marketplace
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.17 通过 Marketplace 部署的解决方案
- en: '14.2.4 Example 3: Cassandra'
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.2.4 示例 3：Cassandra
- en: Cassandra is a NoSQL, highly scalable, high-performance distributed database
    with high availability. Deploying a Cassandra cluster is easy. You can access
    the solution at [https://console.cloud.google.com/marketplace/details/google/cassandra?q=anthos](https://console.cloud.google.com/marketplace/details/google/cassandra?q=anthos)
    (figure 14.18).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: Cassandra 是一个 NoSQL、高度可扩展、高性能的分布式数据库，具有高可用性。部署 Cassandra 集群非常简单。您可以通过 [https://console.cloud.google.com/marketplace/details/google/cassandra?q=anthos](https://console.cloud.google.com/marketplace/details/google/cassandra?q=anthos)
    (图 14.18) 访问该解决方案。
- en: '![14-18](../../OEBPS/Images/14-18.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![14-18](../../OEBPS/Images/14-18.png)'
- en: Figure 14.18 Deploying a Cassandra solution
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.18 部署 Cassandra 解决方案
- en: After installation, you can access and manage your deployed solutions. For instance,
    you might be interested in monitoring CPU, memory, and disk usage for a given
    period, as shown in figure 14.19.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，您可以访问和管理您的已部署解决方案。例如，您可能对监控特定时间段内的 CPU、内存和磁盘使用情况感兴趣，如图 14.19 所示。
- en: '![14-19](../../OEBPS/Images/14-19.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![14-19](../../OEBPS/Images/14-19.png)'
- en: Figure 14.19 Managing a Cassandra solution
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.19 管理Cassandra解决方案
- en: '14.2.5 Example 4: Prometheus and Grafana'
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 14.2.5 示例 4：Prometheus 和 Grafana
- en: Once you understand the mechanism, installing a new solution is a streamlined
    process. For instance, suppose we want to install a more complex set of applications
    that work together. A classic example is Prometheus and Grafana. Prometheus is
    an open source monitoring and alerting platform adopted by many companies as a
    monitoring tool, and Grafana provides several dashboards, which visualize the
    metrics collected by the Prometheus server. The solution can be accessed at [https://console.cloud.google.com/marketplace/details/google/prometheus?q=anthos](https://console.cloud.google.com/marketplace/details/google/prometheus?q=anthos)
    and is shown in figure 14.20.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您理解了机制，安装新的解决方案就是一个简化的过程。例如，假设我们想要安装一组更复杂的应用程序，这些应用程序可以协同工作。一个经典的例子是 Prometheus
    和 Grafana。Prometheus 是一个开源的监控和警报平台，许多公司将其作为监控工具采用，而 Grafana 提供了几个仪表板，这些仪表板可以可视化
    Prometheus 服务器收集的指标。该解决方案可通过 [https://console.cloud.google.com/marketplace/details/google/prometheus?q=anthos](https://console.cloud.google.com/marketplace/details/google/prometheus?q=anthos)
    访问，如图 14.20 所示。
- en: '![14-20](../../OEBPS/Images/14-20.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![14-20](../../OEBPS/Images/14-20.png)'
- en: Figure 14.20 Deploying a Prometheus and Grafana solution
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.20 部署 Prometheus 和 Grafana 解决方案
- en: Let’s use the default parameters, shown in figure 14.21, for deploying the solution.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用图 14.21 所示的默认参数来部署解决方案。
- en: '![14-21](../../OEBPS/Images/14-21.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![14-21](../../OEBPS/Images/14-21.png)'
- en: Figure 14.21 Using the default parameters for the Prometheus and Grafana solution
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.21 使用 Prometheus 和 Grafana 解决方案的默认参数
- en: Once deployed, we can see the solution available from the Application details,
    shown in figure 14.22.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 部署完成后，我们可以在应用程序详情中看到可用的解决方案，如图 14.22 所示。
- en: '![14-22](../../OEBPS/Images/14-22.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![14-22](../../OEBPS/Images/14-22.png)'
- en: Figure 14.22 Prometheus and Grafana deployed solution
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.22 Prometheus 和 Grafana 部署的解决方案
- en: Of course, you can use Anthos to manage the deployed solution, as illustrated
    in figure 14.23.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，你可以像图 14.23 所示的那样使用 Anthos 来管理已部署的解决方案。
- en: '![14-23](../../OEBPS/Images/14-23.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![14-23](../../OEBPS/Images/14-23.png)'
- en: Figure 14.23 Managing the Prometheus and Grafana solution
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14.23 管理Prometheus 和 Grafana 解决方案
- en: Once the solution is deployed, you can start recording real-time metrics in
    the Prometheus time-series database. Then you can use Grafana to create dashboards
    and monitor your system performance.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦解决方案部署完成，你就可以在 Prometheus 时间序列数据库中开始记录实时指标。然后你可以使用 Grafana 创建仪表板并监控你的系统性能。
- en: This example concludes the section. It might be worth noticing that Grafana
    can be deployed via the Marketplace separately and is supported in Anthos, so
    it can be compatible with managed Prometheus.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子结束了本节。值得注意的是，Grafana 可以通过市场单独部署，并且支持在 Anthos 中使用，因此它可以与托管 Prometheus 兼容。
- en: Summary
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Both the public and private Marketplaces can be used to deploy simple and complex
    workloads for developers.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公共和私有市场都可以用来为开发者部署简单和复杂的工作负载。
- en: The public Google Marketplace is a service provided by Google that contains
    several vendor solutions, including solutions specific for Kubernetes, both in
    GCP and on-prem.
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公共 Google 市场是 Google 提供的一项服务，其中包含多个供应商解决方案，包括针对 Kubernetes 的解决方案，无论是在 GCP 还是本地。
- en: The private Google Marketplace allows a company to offer private solutions for
    their internal developers, enabling companies to provide the same deployment simplicity
    that Google offers in the public Marketplace.
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 私有 Google 市场允许公司为其内部开发者提供私有解决方案，使公司能够提供与 Google 在公共市场中提供的相同部署简便性。
- en: Consuming Marketplace solutions on-prem requires additional setup steps that
    a GCP cluster does not require.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在本地消费市场解决方案需要额外的设置步骤，而 GCP 集群则不需要。
- en: We deployed a few Marketplace solutions to demonstrate how easy it is to deploy
    a workload in the real world, using a provided solution.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们部署了一些市场解决方案来展示在现实世界中部署工作负载是多么简单，使用的是提供的解决方案。
