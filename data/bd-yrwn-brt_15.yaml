- en: Appendix D. Mocking the CRICKIT library
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 D. 模拟 CRICKIT 库
- en: 'This appendix covers the topic of mocking the Adafruit Python CRICKIT library.
    Mocking is a common mechanism used when testing software. It lets us replace a
    piece of software with mock objects. In our case, there are a number of benefits
    to doing this:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录涵盖了模拟 Adafruit Python CRICKIT 库的主题。模拟是测试软件时常用的一种机制。它允许我们用模拟对象替换软件的一部分。在我们的情况下，这样做有许多好处：
- en: '*Running code without robot hardware*—The mock library in this appendix will
    let us run all the code in the book without any robot hardware. This is useful,
    as it provides a deeper look at the computer vision, web, joystick, and networking
    portions of the code that don’t need robotic hardware.'
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在不使用机器人硬件的情况下运行代码*——本附录中的模拟库将允许我们在没有任何机器人硬件的情况下运行本书中的所有代码。这很有用，因为它提供了对代码中不需要机器人硬件的计算机视觉、网络、操纵杆和网络部分的更深入的了解。'
- en: '*Executing the code without a Raspberry Pi*—The code is written to run on many
    different Linux systems. All the code was tested with Ubuntu 22.04, which can
    be run on any laptop or virtual machine under Windows or Mac.'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*在不使用树莓派的情况下执行代码*——代码被编写为在许多不同的 Linux 系统上运行。所有代码都在 Ubuntu 22.04 上进行了测试，它可以在任何装有
    Windows 或 Mac 的笔记本电脑或虚拟机上运行。'
- en: '*Better coding experience*—Running on a modern computer can often be a faster
    and more comfortable development experience than executing the code on slower
    machines such as the Raspberry Pi. For example, when doing a lot of work on the
    web front end of a robot application, the development cycle can be faster and
    more productive on a laptop.'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*更好的编码体验*——在现代计算机上运行代码通常比在较慢的机器（如树莓派）上执行代码要快得多，也更舒适。例如，当在机器人应用程序的 Web 前端进行大量工作时，在笔记本电脑上开发周期可以更快、更高效。'
- en: D.1 Installing the mock CRICKIT library
  id: totrans-5
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.1 安装模拟 CRICKIT 库
- en: The mock object library ([http://mng.bz/or0d](http://mng.bz/or0d)) that comes
    as part of the Python standard library will be used to mock the different functions
    of the CRICKIT library. The implementation will address mocking the specific functionality
    used by the code in this book and not the whole CRICKIT library. This appendix
    will mainly focus on using the `mock_crickit` library and will not cover the implementation
    details in great depth. Save the following script in a file called `adafruit_
    crickit.py`.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 将作为 Python 标准库一部分提供的模拟对象库将用于模拟 CRICKIT 库的不同功能。实现将解决模拟本书中使用的特定功能，而不是整个 CRICKIT
    库。本附录将主要关注使用 `mock_crickit` 库，而不会深入探讨实现细节。将以下脚本保存到名为 `adafruit_crickit.py` 的文件中。
- en: 'Listing D.1 `adafruit_crickit.py`: Mocking the CRICKIT library'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 D.1 `adafruit_crickit.py`：模拟 CRICKIT 库
- en: '[PRE0]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The library is written as a direct replacement for the `adafruit_crickit` library,
    which is why it has the same name. We can use it in place of the Adafruit library
    without changing our Python code. As we have done throughout the book, we can
    set the `ROBO_DEBUG` environment variable to have the mock library print out every
    mock call it receives. When the library is directly executed, it will perform
    the `demo` function that demonstrates all the different parts of the CRICKIT library
    that it mocks. The following session shows a sample run of the library:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 该库被编写为 `adafruit_crickit` 库的直接替代品，这就是为什么它有相同的名字。我们可以用它来替代 Adafruit 库，而无需更改我们的
    Python 代码。正如我们在整本书中所做的那样，我们可以设置 `ROBO_DEBUG` 环境变量，使模拟库打印出它接收到的每个模拟调用。当库直接执行时，它将执行
    `demo` 函数，该函数演示了它模拟的 CRICKIT 库的所有不同部分。以下会话显示了库的示例运行：
- en: '[PRE1]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We can also install the mock library into any Python virtual environment of
    our choosing. The code for the library and the installer can be found on GitHub
    ([https://github.com/marwano/robo](https://github.com/marwano/robo)). In the next
    session, we will install the `mock_crickit` library using the `pip install` command.
    Make sure to run the `pip install` command in the same directory as the setup
    script:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以将模拟库安装到我们选择的任何 Python 虚拟环境中。库的代码和安装程序可以在 GitHub 上找到（[https://github.com/marwano/robo](https://github.com/marwano/robo)）。在下一个会话中，我们将使用
    `pip install` 命令安装 `mock_crickit` 库。请确保在设置脚本所在的目录中运行 `pip install` 命令：
- en: '[PRE2]'
  id: totrans-12
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We can now run `pip list` to obtain a list of installed packages in our virtual
    environment. We can see that we have installed version `1.0` of the `mock-crickit`
    library:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以运行 `pip list` 来获取我们虚拟环境中安装的包列表。我们可以看到我们已经安装了 `mock-crickit` 库的 `1.0` 版本：
- en: '[PRE3]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We can verify the library is functioning correctly by calling the `demo` function
    with the following command:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过以下命令调用`demo`函数来验证库是否正常工作：
- en: '[PRE4]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The projects in the book can be executed with this library on a wide variety
    of hardware. The joystick hardware mentioned in appendix A can be used with any
    laptop or desktop computer running Linux. Furthermore, any standard webcam can
    be used in place of the Raspberry Pi Camera Module with no modification to the
    code in the book. This enables the computer vision functionality of face and QR
    code detection.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 书中的项目可以使用这个库在各种硬件上执行。附录A中提到的操纵杆硬件可以与任何运行Linux的笔记本电脑或台式计算机一起使用。此外，任何标准摄像头都可以替代书中的树莓派摄像头模块使用，无需对书中的代码进行任何修改。这使得计算机视觉功能能够实现人脸和二维码检测。
