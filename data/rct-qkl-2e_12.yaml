- en: '12 Project: Timer'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 12 项目：计时器
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Creating the necessary scaffolding for a timer component
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为计时器组件创建必要的脚手架
- en: Implementing a fixed-duration timer
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现固定时长计时器
- en: 'Homework: Adding advanced features to the timer'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 作业：为计时器添加高级功能
- en: Welcome to this next project, where we’re going to build a countdown timer.
    It’s just like the timer app on your phone, only you build this one yourself!
    We’ll also get a bit more ambitious on your behalf in this exercise, so, compared
    to chapter 11, there will be less so, and guidance from us and more development
    work to figure out on your own. But don’t worry, you have our full trust and confidence—we
    know you can do it!
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 欢迎来到这个下一个项目，我们将构建一个倒计时计时器。它就像你手机上的计时器应用一样，只是这个是你自己构建的！在这个练习中，我们也会代表你变得更加雄心勃勃，所以，与第11章相比，会有更少的指导，更多的开发工作需要你自己去探索。但别担心，我们对你充满信心和信任——我们知道你能做到！
- en: We’ll set up the foundations for the project for you, so you don’t have to mess
    too much with design or semantics. For that purpose, we’ve set up a scaffold for
    you in step 1, which contains the static HTML and semantics required for step
    2, but also all the images, icons, and styles that you need for the whole project.
    See figure 12.1 for the high-level overview of this project.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 我们会为你搭建项目的基础，这样你就不必在设计或语义上花费太多精力。为此，我们在第一步为你设置了一个脚手架，其中包含了步骤2所需的静态 HTML 和语义，还包含了整个项目所需的全部图像、图标和样式。见图12.1，这是该项目的概览。
- en: '![12-01](../Images/12-01.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![12-01](../Images/12-01.png)'
- en: Figure 12.1 When you’re completing the timer project, you’ll go through these
    five steps to end up with a fairly advanced timer.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.1 当你完成计时器项目时，你将通过以下五个步骤完成一个相当高级的计时器。
- en: In step 2, together we’ll convert the static output from step 1 to a working,
    albeit functionally limited, timer with a fixed duration, by adding statefulness.
    In step 3, we’ll add an initialization step so you can set the timer to an arbitrary
    number and also dismiss a running timer. This requires adding form and event handling.
    When we add the extra option of resetting the timer in step 4, we’ll also refactor
    how the state is being kept by moving to a reducer and a custom hook. Finally,
    in step 5, we’ll add the option of having multiple timers running independently
    of each other.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二步，我们将通过添加状态性将第一步的静态输出转换为具有固定时长的、尽管功能有限的计时器。在第三步，我们将添加一个初始化步骤，这样你可以将计时器设置为任意数字，也可以取消正在运行的计时器。这需要添加表单和事件处理。当我们添加在第四步重置计时器的额外选项时，我们还将通过转向
    reducer 和自定义钩子来重构状态保持方式。最后，在第五步，我们将添加多个计时器独立运行的功能。
- en: As mentioned, we’re getting more ambitious on your behalf in this project, so
    the last two steps are fairly complicated. You can see a more detailed overview
    of the process and the technologies involved in table 12.1.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们代表你在这个项目中变得更加雄心勃勃，所以最后两个步骤相当复杂。你可以在表12.1中看到过程的更详细概述以及涉及的技术。
- en: Table 12.1 The five steps of the timer project
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 表12.1 计时器项目的五个步骤
- en: '| Step | Feature | Additional React API used | Difficulty |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '| 步骤 | 功能 | 使用的额外 React API | 难度 |'
- en: '| Step 1: Scaffold | Create the basic component structure for a time display
    and buttons. | Chapters 1-4: Functional components using JSX | ★☆☆☆☆ |'
  id: totrans-13
  prefs: []
  type: TYPE_TB
  zh: '| 步骤 1：脚手架 | 创建时间显示和按钮的基本组件结构。 | 第一章至第四章：使用 JSX 的函数组件 | ★☆☆☆☆ |'
- en: '| Step 2: Play/Pause | Implement a stateful component that will count down
    when started until paused or done. | Chapter 5: StateChapter 6: Effect hook |
    ★★☆☆☆ |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| 步骤 2：播放/暂停 | 实现一个有状态的组件，在启动时倒计时，直到暂停或完成。 | 第五章：状态，第六章：Effect 钩子 | ★★☆☆☆ |'
- en: '| Step 3: Initialize | Initialize the timer at a custom time defined by the
    user through a form with inputs.Note: This is homework. You have to create this
    step *yourself*! | Chapter 8: Listening for eventsChapter 10: Handling user input
    in forms | ★★☆☆☆ |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| 步骤 3：初始化 | 通过表单输入初始化计时器，该表单由用户定义的自定义时间定义。注意：这是作业。你必须自己创建这个步骤！ | 第八章：监听事件，第十章：在表单中处理用户输入
    | ★★☆☆☆ |'
- en: '| Step 4: Reset | Convert the state logic to a reducer, and add more logic
    to handle resetting the timer as well.Note: This is homework. You have to create
    this step *yourself*! | Chapter 10: Reducer and custom hook | ★★★★☆ |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| 步骤 4：重置 | 将状态逻辑转换为 reducer，并添加更多逻辑来处理重置计时器。注意：这是作业。你必须自己创建这个步骤！ | 第十章：Reducer
    和自定义钩子 | ★★★★☆ |'
- en: '| Step 5: Multiple timers | Allow the user to define multiple timers that will
    run independently of each other.Note: This is homework. You have to create this
    step *yourself*! |  | ★★★★☆ |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| 步骤5：多个计时器 | 允许用户定义多个计时器，它们将独立运行。注意：这是作业。你必须自己创建这个步骤！ |  | ★★★★☆ |'
- en: As a further enticement before we get going, we’ll present some screenshots
    of the final product. Note that although the book is printed in grayscale, the
    actual timer comes with a pleasing purple gradient as background. The initial
    result of step 1 is displayed in figure 12.2, whereas the final multi-timer is
    displayed in figure 12.3.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始之前，我们将展示一些最终产品的截图。请注意，尽管本书以灰度印刷，但实际的计时器带有令人愉悦的紫色渐变作为背景。步骤1的初始结果显示在图12.2中，而最终的多个计时器显示在图12.3中。
- en: '![12-02](../Images/12-02.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![12-02](../Images/12-02.png)'
- en: Figure 12.2 Step 1 sets up the project structure and styles required to render
    a static timer like this one. The button doesn’t do anything at this point, and
    the time doesn’t tick down.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.2 第一步设置了渲染此类静态计时器所需的项目结构和样式。此时按钮没有任何作用，时间也不会倒计时。
- en: '![12-03](../Images/12-03.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![12-03](../Images/12-03.png)'
- en: Figure 12.3 After you’ve completed step 5, you’ll have created this monster
    of an application, where you can have as many independently running timers as
    you want. Just imagine how many differently sized eggs you can boil simultaneously!
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.3 完成步骤5后，您将创建这个庞大的应用程序，您可以拥有任意多个独立运行的计时器。只需想象一下，您可以同时煮多少不同大小的鸡蛋！
- en: Alright, let’s start the countdown!
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，让我们开始倒计时！
- en: Note The source code for the scaffolding and suggested solutions to all the
    sections in this chapter are available at [https://rq2e.com/ch12](https://rq2e.com/ch12).
    But as you learned in chapter 2, you can instantiate all the examples and solutions
    directly from the command line using a single command.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：本章中搭建框架和所有部分的建议解决方案的源代码可在[https://rq2e.com/ch12](https://rq2e.com/ch12)找到。但正如您在第二章中学到的，您可以使用单个命令直接从命令行实例化所有示例和解决方案。
- en: 12.1 Scaffolding for the timer
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.1 为计时器搭建框架
- en: 'To help you focus on implementing React code and not fiddling with HTML and
    CSS, we’ll provide all the required styles and semantics for you. We’ll also set
    it all up here in the scaffolding for the application. As in the previous project
    (and really any web development project), we’ll go through these steps to complete
    the project:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助您专注于实现React代码，而不是摆弄HTML和CSS，我们将为您提供所有必需的样式和语义。我们还将在这里设置所有这些内容，为应用程序搭建框架。正如在先前的项目中（以及任何Web开发项目），我们将按照以下步骤完成项目：
- en: Define the HTML output that will render the desired result.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义将渲染所需结果的HTML输出。
- en: Create a number of React components that will render JSX to achieve the desired
    HTML.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建多个React组件，将渲染JSX以实现所需的HTML。
- en: Place static images in the public folder that we can load at runtime.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在公共文件夹中放置静态图像，我们可以在运行时加载它们。
- en: Create a stylesheet.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个样式表。
- en: Implement the components that we need to get the necessary functionality.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 实现我们需要的组件以获得必要的功能。
- en: The last point is the interesting bit, and we’ll solve that in steps 2-5 in
    this project. Step 1 will complete the first four points in the preceding list.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一点是有趣的部分，我们将在本项目的步骤2-5中逐步解决。第一步将完成前面列表中的前四点。
- en: 12.1.1 HTML output
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.1 HTML输出
- en: For the HTML output for this project, we’ll go over one part at a time and detail
    how we’ll model it using HTML. We’ll then add some appropriate CSS classes to
    each node, which we can target in our stylesheet in the next part. When we have
    all the individual parts, we can start putting them together to form the whole
    project. The parts of this project are highlighted in the graphic in figure 12.4.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此项目的HTML输出，我们将逐部分进行讲解，并详细说明我们将如何使用HTML来建模。然后，我们将为每个节点添加一些适当的CSS类，我们可以在下一部分的目标样式中定位它们。当我们有了所有单独的部分，我们就可以开始将它们组合起来，形成一个完整的项目。图12.4中的图形突出了此项目的各个部分。
- en: '![12-04](../Images/12-04.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![12-04](../Images/12-04.png)'
- en: Figure 12.4 The seven parts that make up the complete timer application. Starting
    from the innermost, we have a number and unit, a button, a collection of two numbers
    with a colon between them, a complete timer, a form input, a form with multiple
    inputs and a button, and, finally, the whole list of timers.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.4 组成完整计时器应用程序的七个部分。从最内层开始，我们有一个数字和单位，一个按钮，两个数字的集合，它们之间用冒号分隔，一个完整的计时器，一个表单输入，一个包含多个输入和按钮的表单，最后是整个计时器列表。
- en: Let’s go over each of these parts and detail the associated HTML structure.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们逐一查看这些部分，并详细说明相关的 HTML 结构。
- en: Number and unit
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 数量和单位
- en: 'Each number in the time display has an associated unit below it. The number
    and unit text fields are combined in the list item. This list item will be used
    in the time display as a whole. Therefore, each individual number and unit is
    a list item with paragraphs inside:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 时间显示中的每个数字下面都有一个相关的单位。数字和单位文本字段在列表项中结合。这个列表项将用于整个时间显示。因此，每个单独的数字和单位都是一个列表项，其中包含段落：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Button
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 按钮
- en: 'A button is, of course, a button, but with an icon that matches the title:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 一个按钮当然是一个按钮，但带有与标题匹配的图标：
- en: '[PRE1]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Time parts
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 时间部分
- en: 'The time display is a list of parts, namely, a number and unit, then a colon,
    and then another number and unit:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 时间显示是一个部分列表，即一个数字和一个单位，然后是一个冒号，然后是另一个数字和一个单位：
- en: '[PRE2]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Timer
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器
- en: 'The timer is a section that consists of a list of time parts followed by one
    or more buttons:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器是一个由时间部分列表组成的部分，后面跟着一个或多个按钮：
- en: '[PRE3]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'While the timer is running, add a class timer-ticking to make the colon in
    the time display blink:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 当计时器正在运行时，添加类 timer-ticking 使时间显示中的冒号闪烁：
- en: '[PRE4]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'If the timer has reached 0 and should start blinking to indicate that the time
    has run out, it can be marked by adding the class timer-ringing:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 如果计时器达到 0 并应该开始闪烁以指示时间已用完，可以通过添加类 timer-ringing 来标记：
- en: '[PRE5]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Form input
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 表单输入
- en: 'The input is a number and unit, but instead of the two elements being two paragraphs,
    they are an input and a label. They still form a part, which is an element in
    a list:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 输入是一个数字和单位，但这两个元素不是两个段落，而是一个输入和一个标签。它们仍然是一个部分，这是一个列表中的元素：
- en: '[PRE6]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Form
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 表单
- en: 'The inputs make up the form along with a button. Because a button automatically
    serves as a Submit button when inside a form, we don’t need to do anything special
    to get the form to work:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 输入与按钮一起构成了表单。因为按钮在表单内部自动充当提交按钮，所以我们不需要做任何特殊的事情来使表单工作：
- en: '[PRE7]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Timers
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器
- en: 'The list of timers is just an element surrounding all the timers and potentially
    the form to add a new one at the end:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器列表只是围绕所有计时器以及可能添加新计时器的表单的一个元素：
- en: '[PRE8]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'If the timer list has a plus button at the end to start a new timer, it can
    be added as a button with classes timer and timer-add:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 如果计时器列表的末尾有一个加号按钮来启动一个新的计时器，它可以添加为具有类 timer 和 timer-add 的按钮：
- en: '[PRE9]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 12.1.2 Component hierarchy
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.2 组件层次结构
- en: The previous section lists some parts of the application that might very well
    translate directly to the React components that we need to render the application.
    However, for the scaffold, we’ll have far fewer components, and only once we start
    adding functionality in step 2 will we start splitting the components up into
    all the parts. For this scaffold, we’ll only have three components, as you can
    see in figure 12.5.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 上一节列出了应用程序的一些部分，这些部分可能非常直接地转换为我们需要渲染应用程序的 React 组件。然而，对于脚手架，我们将有更少的组件，并且只有在第二步开始添加功能时，我们才会开始将组件拆分成所有部分。对于这个脚手架，我们将只有三个组件，如图
    12.5 所示。
- en: '![12-05](../Images/12-05.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![12-05](../Images/12-05.png)'
- en: Figure 12.5 This might be our simplest component tree in a very long time. Note
    that we only display the React components here and not all the plain JSX nodes
    that we're also rendering.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12.5 这可能是我们很长时间以来最简单的组件树。注意，我们在这里只显示 React 组件，而不是我们也在渲染的所有纯 JSX 节点。
- en: Once we get to future steps, we’ll start adding more functionality and logic,
    which will inherently increase the complexity of the component tree.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们到达未来步骤，我们将开始添加更多功能和逻辑，这自然会增加组件树的复杂性。
- en: 12.1.3 Project structure
  id: totrans-70
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.3 项目结构
- en: For this project, we’ll need some icons. We need four different types of buttons
    to complete the whole project. You can see them all displayed in figure 12.6.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个项目，我们需要一些图标。我们需要四种不同类型的按钮来完成整个项目。你可以在图 12.6 中看到它们全部显示出来。
- en: '![12-06](../Images/12-06.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![12-06](../Images/12-06.png)'
- en: Figure 12.6 The four types of buttons we need include a play, pause, reset,
    and trash.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12.6 我们需要的四种按钮类型包括播放、暂停、重置和删除。
- en: 'Just like in chapter 11, we’ll place these icon files in the public folder
    inside a separate icons folder. Besides that, we’ll need the three components
    that we laid out in the previous section in the component tree, and then, of course,
    we need a stylesheet. This leads us to the following list of files in the scaffold:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 就像在第 11 章中一样，我们将这些图标文件放在 public 文件夹内的一个单独的 icons 文件夹中。除此之外，我们还需要在组件树中我们之前提到的三个组件，然后当然，我们需要一个样式表。这导致我们得到以下脚手架中的文件列表：
- en: '[PRE10]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: ❶ Icons that we’ve added for the buttons
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 我们为按钮添加的图标
- en: ❷ Default files that we haven't touched
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 我们未修改的默认文件
- en: ❸ A default file that we’ve updated to suit our needs
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 我们更新以适应我们需求的默认文件
- en: ❹ Three new files we’ve added to display the scaffold application
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 我们添加的三个新文件，用于显示脚手架应用程序
- en: 'Repository: rq12-scaffold'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 仓库：rq12-scaffold
- en: 'This example can be seen in repository rq12-scaffold. You can use that repository
    by creating a new app based on the associated template:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例可以在rq12-scaffold仓库中看到。您可以通过创建基于相关模板的新应用程序来使用该仓库：
- en: '[PRE11]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Alternatively, you can go to this website to browse the code, see the application
    in action directly in your browser, or download the source code as a zip file:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您也可以访问此网站浏览代码，直接在您的浏览器中查看应用程序的运行情况，或者下载源代码的zip文件：
- en: '[https://rq2e.com/rq12-scaffold](https://rq2e.com/rq12-scaffold)'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://rq2e.com/rq12-scaffold](https://rq2e.com/rq12-scaffold)'
- en: From there, you’re ready to go. Keep reading this section (12.1) for some extra
    details about the source in the scaffold, but if you like what you see, you can
    also skip ahead to section 12.2, where we start implementing the simplest version
    of the timer.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 从那里，您就可以开始了。继续阅读本节（12.1），了解脚手架中源代码的一些额外细节，但如果您喜欢您所看到的，您也可以跳到12.2节，在那里我们开始实现计时器的最简单版本。
- en: 12.1.4 Source code
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.4 源代码
- en: This section includes the source code for the base components included in the
    scaffolding. You don’t have to copy it from here, though, as these sources are
    ready to go in the previously mentioned template.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 本节包含在脚手架中包含的基本组件的源代码。尽管如此，您不必从这里复制它，因为这些源代码已经在之前提到的模板中准备好了。
- en: Stylesheet
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 样式表
- en: We aren’t listing the whole stylesheet because it’s just a lot of simple CSS
    rules, but there are a few things we want to highlight. First, we’re loading a
    font from the Google Fonts API, named Fira Sans, which has some nice numbers that
    we want to use for the actual clock display. This font also supports a feature
    called *tabular numbers*. We want our numbers to be displayed in a fixed-width
    format; that is, we don’t want the numbers to change width when the clock ticks
    down from 10 to 09\. But in many fonts, the 1 and the 0 don’t have the same width,
    and this would cause our numbers to jump a bit unless we put each number in a
    separate box.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 我们没有列出整个样式表，因为它只是大量的简单CSS规则，但我们想强调一些事情。首先，我们在样式表中加载了一个来自Google Fonts API的字体，名为Fira
    Sans，它有一些我们想用于实际时钟显示的漂亮数字。此字体还支持一个名为*表格数字*的功能。我们希望我们的数字以固定宽度格式显示；也就是说，我们不希望数字在时钟从10滴答到09时改变宽度。但在许多字体中，1和0的宽度并不相同，这会导致我们的数字跳一下，除非我们将每个数字放入一个单独的框中。
- en: 'Some font families have a feature in which you can request your numbers to
    be displayed as fixed-width characters so that they all take the same number of
    pixels in width at the same font size. We load the font and trigger this tabular
    variant for numbers in CSS by using this declaration:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 一些字体家族具有一个功能，您可以请求将数字显示为固定宽度字符，这样它们在相同字体大小下都占据相同数量的像素宽度。我们通过使用此声明在CSS中加载字体并触发数字的表格变体：
- en: '[PRE12]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: ❶ Instructs these classes to use the loaded font
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 指示这些类使用加载的字体
- en: ❷ Triggers the font to use the font variant "tabular-nums" to ensure the use
    of fixed-width numbers
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 触发字体使用字体变体"tabular-nums"，以确保使用固定宽度数字
- en: Not all fonts support this font variant, so if you want to use a different font
    for your numbers, check that it supports this for the most visually pleasing result.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有字体都支持此字体变体，因此如果您想为数字使用不同的字体，请检查它是否支持此功能以获得最视觉上令人愉悦的结果。
- en: Secondly, if you look through the stylesheet, you might note that we do most
    of the layouts in the stylesheet using Flexbox. It’s just a very handy tool for
    aligning elements in an application like this.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，如果您查看样式表，您可能会注意到我们大多数布局都是在样式表中使用Flexbox完成的。对于像这样的应用程序，这是一个非常方便的工具来对齐元素。
- en: Main application
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 主应用程序
- en: The main application component is the starting point for the application. It
    remains completely identical to this first version (listing 12.1) throughout the
    exercise, as it contains only a headline and the TimerManager component. All the
    logic of the timers will go inside there, so there will be no global state in
    this application.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 主应用程序组件是应用程序的起点。在整个练习过程中，它始终保持与第一个版本（列表12.1）完全相同，因为它只包含一个标题和TimerManager组件。所有的计时器逻辑都将放在那里，所以这个应用程序将没有全局状态。
- en: Note that we also load the CSS stylesheet in this root component. We only need
    to load it once, so it makes sense to load it in the root. You can see the file
    src/App.js in the following listing.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们还在根组件中加载了 CSS 样式表。我们只需要加载一次，所以将其加载在根组件中是有意义的。您可以在下面的列表中看到文件 src/App.js。
- en: Listing 12.1 src/App.js in the scaffolding
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12.1 框架中的 src/App.js
- en: '[PRE13]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: ❶ Imports the stylesheet so we can use the styles from the start
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 导入样式表，以便我们可以从开始使用这些样式
- en: ❷ Loads the timer manager component
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 加载计时器管理器组件
- en: ❸ Renders it where needed
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 在需要的地方渲染它
- en: The timer manager
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器管理器
- en: The timer manager is the container that will hold one or more timers as well
    as contain the logic for initializing or adding new timers. This component won’t
    be in charge of actually managing the individual timers (e.g., ticking time ahead),
    but rather will manage the different timers and the starting times.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器管理器是包含一个或多个计时器以及初始化或添加新计时器逻辑的容器。该组件不会负责实际管理单个计时器（例如，向前推进时间），而是管理不同的计时器和起始时间。
- en: In the scaffold, the timer manager contains a single timer instance with no
    properties. This file, src/TimerManager.js, is displayed next.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在框架中，计时器管理器包含一个没有任何属性的单一计时器实例。此文件，src/TimerManager.js，将在下面显示。
- en: Listing 12.2 src/TimerManager.js in the scaffolding
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12.2 框架中的 src/TimerManager.js
- en: '[PRE14]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: ❶ The timer manager imports the timer component to display an instance of it.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 计时器管理器导入计时器组件以显示其实例。
- en: ❷ Renders the instance without any properties or other logic
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 渲染实例而不带任何属性或其他逻辑
- en: The individual timer
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 单个计时器
- en: The timer component is where most of the future work will take place. In this
    initial scaffold, it’s a purely static component with a fixed JSX response that
    displays 05 minutes and 00 seconds and a Play button. None of it’s functional
    for now, though.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器组件将是未来大部分工作的地方。在这个初始框架中，它是一个纯静态组件，具有固定的 JSX 响应，显示 05 分钟和 00 秒以及一个播放按钮。但目前它没有任何功能。
- en: Note that this contains some duplicated JSX that can be optimized later by turning
    it into individual components, including the number and unit display. The button
    is also ripe for *componentization*, as it will be used in multiple places later.
    This file, src/Timer.js, is shown in the next listing.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这包含了一些可以稍后通过将其转换为单独的组件进行优化的重复 JSX，包括数字和单位显示。按钮也适合进行*组件化*，因为它将在以后的多处使用。此文件，src/Timer.js，将在下面的列表中显示。
- en: Listing 12.3 src/Timer.js in the scaffolding
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12.3 框架中的 src/Timer.js
- en: '[PRE15]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: ❶ We’ve hardcoded a remaining time of 05 minutes and 00 seconds for now.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 目前我们硬编码了剩余时间为 05 分钟和 00 秒。
- en: 12.1.5 Running the application
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.5 运行应用程序
- en: If we spin this application up in the browser, we see what we displayed in the
    beginning in figure 12.2, repeated here in 12.7\. This application doesn’t do
    anything, but it looks pretty nice, no?
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在浏览器中启动此应用程序，我们将看到图 12.2 中显示的内容，这里重复显示在 12.7 中。这个应用程序什么也没做，但看起来很漂亮，不是吗？
- en: '![12-07](../Images/12-07.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![12-07](../Images/12-07.png)'
- en: Figure 12.7 The scaffold for the timer doesn’t do anything—yet.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12.7 计时器的框架目前什么也不做——还没有。
- en: 12.2 Adding a simple play/pause timer
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.2 添加简单的播放/暂停计时器
- en: The previous step resulted in a nice but very boring application because it
    didn’t do anything. We’re going to change that now. First, we’ll make this simplest
    of countdown timers work by making the play button play the countdown. You can
    also pause the countdown, if the explosion looms close—or the egg is almost done
    cooking.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 上一步的结果是一个很好但非常无聊的应用程序，因为它什么也没做。我们现在将改变这一点。首先，我们将通过使播放按钮播放倒计时来使这个最简单的倒计时计时器工作。如果您觉得爆炸即将来临——或者鸡蛋快煮好了，您也可以暂停倒计时。
- en: 12.2.1 The goal of this exercise
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.1 本练习的目标
- en: 'The goal of this exercise is to create the required functionality to make a
    working countdown. To achieve this goal, we recommend going about it in these
    steps, but they’re definitely not the only or even necessarily best way to do
    it. It’s just our way:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 本练习的目标是创建所需的功能以制作一个工作倒计时。为了实现这一目标，我们建议按照以下步骤进行，但它们绝对不是唯一或甚至可能是最佳的方式。这只是我们的方法：
- en: Identify parts of the timer to componentize to make the timer simpler to work
    with.
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别计时器中可以组件化的部分，以使计时器更容易处理。
- en: Create state in the timer component to record the progression of the countdown
    as well as the Boolean state of whether the countdown is running or not.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在计时器组件中创建状态以记录倒计时进度以及倒计时是否正在运行的布尔状态。
- en: Add an effect to the timer to decrease the remaining time every second.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为计时器添加一个效果，每秒减少剩余时间。
- en: Display a play button that starts the countdown if the timer is paused, and
    a pause button that pauses it if the timer is running.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果计时器处于暂停状态，则显示一个开始倒计时的播放按钮，如果计时器正在运行，则显示一个暂停按钮。
- en: Precision
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 精度
- en: Note that timing precision is *not* a goal of this exercise. We’re fine with
    doing the countdown in a setInterval, even though the precision of setInterval
    is notoriously untrustworthy. This will result in a countdown that’s probably
    a few hundredths up to a tenth of a second off on every tick of the countdown.
    When a full 5 minutes have passed on the countdown in the app, this offset could
    account for about half a minute extra in “real time.”
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，计时精度不是这个练习的目标。我们甚至可以接受使用setInterval进行倒计时，尽管setInterval的精度声名狼藉地不可靠。这将导致倒计时在每个滴答声上可能偏离几百分之一到十分之一秒。当应用程序中的倒计时满5分钟时，这个偏差可能导致“真实时间”中额外半分钟。
- en: If you’re using this timer for anything requiring actual precision, this isn’t
    the way to do it. But precision timing isn’t the goal of this exercise, so we’ll
    use this approach for the entire project.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用这个计时器进行需要实际精度的任何事情，这不是正确的方法。但精度计时不是这个练习的目标，所以我们将在整个项目中使用这种方法。
- en: Feel free to improve the precision of the actual countdown by the end, if you
    feel so inclined. Look into performance.now() for precision timing (down to the
    microsecond, if the OS supports it).
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你愿意，请自由地提高实际倒计时的精度。查看performance.now()进行精确计时（如果操作系统支持，可达到微秒级别）。
- en: 12.2.2 Component hierarchy
  id: totrans-133
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.2 组件层次结构
- en: 'As mentioned, the first goal of this exercise is to componentize the timer
    parts into relevant atoms that can be combined into a whole as appropriate. For
    this purpose, we’ll refer back to the initial list of HTML parts and split the
    component along the lines divided there. Thus:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，这个练习的第一个目标是将计时器部分组件化成相关的原子，以便可以适当地组合成一个整体。为此，我们将参考初始HTML组件列表，并按照那里的划分拆分组件。因此：
- en: Timer—A timer consists of a time display and one or more buttons.
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计时器——计时器由一个时间显示和一个或多个按钮组成。
- en: TimeDisplay—A time display is a list of a number and unit, followed by a colon,
    followed by a number and unit.
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间显示——时间显示是一个数字和单位的列表，后面跟着一个冒号，然后是一个数字和一个单位。
- en: Number—A number and unit is just that, with the proper class names to elicit
    the desired styling.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数字——数字和单位就是那样，有适当的类名来引发所需的样式。
- en: Button—A button has a label for accessibility and an icon for visual recognition.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按钮——按钮有一个用于无障碍的标签和一个用于视觉识别的图标。
- en: These four components now make up a timer and are connected as you see in figure
    12.8\. You can also see that we’ll pass in the starting time to the timer directly
    from the timer manager.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这四个组件现在构成了一个计时器，并且按照你在图12.8中看到的方式连接。你还可以看到，我们将直接从计时器管理器传递起始时间给计时器。
- en: '![12-08](../Images/12-08.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![12-08](../Images/12-08.png)'
- en: 'Figure 12.8 The component tree for our single timer application consists of
    a few instances of three new components: time display, number, and button.'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.8 我们的单个计时器应用程序的组件树由三个新组件的几个实例组成：时间显示、数字和按钮。
- en: The timer will only have a single button, but the button icon, label, and click
    handler will vary depending on whether the timer is currently running or not.
    In addition, note that the time display will only get a single time as input,
    which is the remaining seconds to display. The time display component then has
    to split that into minutes and seconds to pass to the two number components.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器将只有一个按钮，但按钮图标、标签和点击处理程序将根据计时器当前是否正在运行而有所不同。此外，请注意，时间显示将只接收一个时间作为输入，即要显示的剩余秒数。然后时间显示组件必须将其拆分为分钟和秒，传递给两个数字组件。
- en: 12.2.3 Updated project structure
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.3 更新后的项目结构
- en: 'In this step of the project, we’re adding some new components as well as updating
    others. This leads to the following updated file structure after completing this
    step:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个项目步骤中，我们添加了一些新组件，并更新了其他组件。完成此步骤后，文件结构将更新如下：
- en: '[PRE16]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: ❶ Unchanged files
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 未更改的文件
- en: ❷ New files
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 新文件
- en: ❸ Updated files
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 更新后的文件
- en: We recommend that you try to implement this step yourself, and you can do so
    either by starting from your own implementation of the scaffolding in step 1 of
    this project or from our implementation in the rq12-scaffold repository. Once
    completed, feel free to compare your solution to ours.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们建议你尝试自己实现这一步，你可以从本项目步骤1中自己的脚手架实现开始，或者从rq12-scaffold仓库中的我们的实现开始。一旦完成，请随意比较你的解决方案与我们的。
- en: 'Repository: rq12-playpause'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 仓库：rq12-playpause
- en: 'This example can be seen in repository rq12-playpause. You can use that repository
    by creating a new app based on the associated template:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例可在rq12-playpause存储库中看到。您可以通过创建一个基于相关模板的新应用程序来使用该存储库：
- en: '[PRE17]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Alternatively, you can go to this website to browse the code, see the application
    in action directly in your browser, or download the source code as a zip file:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您也可以访问此网站来浏览代码，在您的浏览器中直接查看应用程序的运行情况，或下载源代码的zip文件：
- en: '[https://rq2e.com/rq12-playpause](https://rq2e.com/rq12-playpause)'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://rq2e.com/rq12-playpause](https://rq2e.com/rq12-playpause)'
- en: 12.2.4 Source code
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.4 源代码
- en: In this section, we’ll provide the full source code for all the updated and
    new files added in this step along with some implementation details that will
    be relevant for understanding our choices.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将提供所有在此步骤中添加的更新和新文件的完整源代码，以及一些与理解我们的选择相关的实现细节。
- en: The timer manager
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器管理器
- en: The timer manager still doesn’t really do anything. The only thing changed here
    is that we explicitly set the default time for the timer. Feel free to change
    that to something else to test it out. See the full contents of src/TimerManager.js
    next.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器管理器实际上并没有真正做任何事情。这里唯一改变的是，我们明确设置了计时器的默认时间。您可以随意更改它以进行测试。请参阅src/TimerManager.js的完整内容。
- en: Listing 12.4 src/TimerManager.js in the simple timer
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.4 简单计时器中的src/TimerManager.js
- en: '[PRE18]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: ❶ Adds a property with the default start time
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 添加一个具有默认开始时间的属性
- en: A generic button component
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 一个通用的按钮组件
- en: We need a new button component. It’s very simple and renders a button element
    with an appropriate title and an icon inside. If we pass extra properties to the
    button component, we forward them to the button element. See the following listing
    for the full contents of src/Button.js.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要一个新按钮组件。它非常简单，并渲染一个带有适当标题和图标的按钮元素。如果我们向按钮组件传递额外的属性，我们将它们转发到按钮元素。请参阅以下列表以获取src/Button.js的完整内容。
- en: Listing 12.5 src/Button.js in the simple timer
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.5 简单计时器中的src/Button.js
- en: '[PRE19]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: ❶ We need to pass an icon and a label, but we can also pass any other button
    properties to this component.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 我们需要传递一个图标和一个标签，但我们也可以传递给此组件的任何其他按钮属性。
- en: ❷ All the extra properties will be added to the button element. This is where
    things like onClick should be added.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 所有额外的属性都将添加到按钮元素中。这是添加如onClick之类的位置。
- en: The number and unit display
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 数字和单位显示
- en: The number and unit display just displays properties. The number has to be formatted
    to always be two digits, though, so we convert it to a string and add leading
    zeros if required, as shown in the following listing.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 数字和单位显示仅显示属性。但是，数字必须格式化为总是两位数，因此我们将其转换为字符串，并在需要时添加前导零，如下列所示。
- en: Listing 12.6 src/Number.js in the simple timer
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.6 简单计时器中的src/Number.js
- en: '[PRE20]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: ❶ We display the number here, but we make sure it’s always two characters long
    by converting it to a string and padding it with leading zeros. This causes a
    number like 7 to be displayed as 07.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 我们在这里显示数字，但我们确保它总是两位数长，通过将其转换为字符串并用前导零填充。这使得像7这样的数字显示为07。
- en: ❷ The label is displayed as is—we later use CSS to make it uppercase for visual
    appeal.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 标签按原样显示——我们稍后使用CSS将其转换为大写以提高视觉效果。
- en: The time display component
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 时间显示组件
- en: This component takes in the time to display, splits it into minutes and seconds
    (using division, flooring, and modulo), and then passes those values on to two
    number component instances. You can see the source for src/TimeDisplay.js next.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 此组件接收要显示的时间，将其拆分为分钟和秒（使用除法、取整和取模），然后将这些值传递给两个数字组件实例。您可以在src/TimeDisplay.js中查看源代码。
- en: Listing 12.7 src/TimeDisplay.js in the simple timer
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.7 简单计时器中的src/TimeDisplay.js
- en: '[PRE21]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: ❶ The number of minutes remaining is the time remaining divided by 60 rounded
    down.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 剩余分钟数是剩余时间除以60后取整的结果。
- en: ❷ The number of seconds remaining is the remainder after division by 60.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 剩余秒数是除以60后的余数。
- en: The timer component
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 计时器组件
- en: This is where it all comes together. We’ve illustrated the flow of logic in
    the timer component in a state diagram in figure 12.9.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是一切汇聚的地方。我们在图12.9中用状态图展示了计时器组件中逻辑流程。
- en: '![12-09](../Images/12-09.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![12-09](../Images/12-09.png)'
- en: Figure 12.9 The state chart for the simple timer component—time is either running
    or not, which determines what is displayed and which effects are running.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.9 简单计时器组件的状态图——时间要么在运行，要么不在，这决定了显示什么以及哪些效果正在运行。
- en: Remember that the timer now takes a single property, startTime, which determines
    what the timer will start at. From that, we can initialize the local state with
    the remaining seconds that we can tick down, as well as a separate state that
    contains a Boolean about whether the timer is even ticking at all.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，计时器现在接受一个单一的属性，startTime，它决定了计时器将从哪里开始。从那里，我们可以初始化本地状态，包括我们可以滴下的剩余秒数，以及一个包含计时器是否真正在滴答的布尔值的单独状态。
- en: Then, we do different things depending on whether time is running or not. If
    running, we run an effect hook decrementing (until it reaches zero, then we reset
    everything). We also display a pause button if running.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们根据时间是否在运行执行不同的操作。如果在运行，我们运行一个效果钩子来递减（直到它达到零，然后重置一切）。如果正在运行，我们还会显示一个暂停按钮。
- en: If time isn’t running, we don’t run any effect hook (or we do, because we have
    to, but we don’t do anything inside the hook), and we display a play button. The
    full file, src/Timer.js, is displayed in the following listing.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 如果时间没有在运行，我们不会运行任何效果钩子（或者我们也会运行，因为我们必须运行，但我们不会在钩子内部做任何事情），并且我们显示一个播放按钮。完整的文件，src/Timer.js，将在下面的列表中显示。
- en: Listing 12.8 src/Timer.js in the simple timer
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.8 简单计时器的src/Timer.js
- en: '[PRE22]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: ❶ To have a timer, we need two stateful values. First, we need to know how many
    seconds are remaining.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 要有一个计时器，我们需要两个状态值。首先，我们需要知道还剩下多少秒。
- en: ❷ Second, we need to know whether the timer is currently running or not.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 第二，我们需要知道计时器当前是否正在运行。
- en: ❸ We implement the eternal progress of time toward the eventual heat death of
    the universe as an effect hook. The hook only does something if the timer is actually
    running, though.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 我们将宇宙最终热寂的永恒进步实现为一个效果钩子。尽管如此，钩子只有在计时器实际上在运行时才会做任何事情。
- en: ❹ If the timer is running, we schedule an interval to be run every second that
    will decrement the remaining seconds or stop the timer if it reaches 0 (and then
    reset the timer).
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 如果计时器正在运行，我们安排一个每秒运行一次的间隔，该间隔将递减剩余秒数，或者如果达到0则停止计时器（然后重置计时器）。
- en: ❺ Always clean up after yourself.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: ❺ 总是清理你的工作。
- en: ❻ This hook depends on whether the timer is running or not as well as the start
    time (as we need it to reset the timer upon completion).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: ❻ 这个钩子取决于计时器是否在运行以及开始时间（因为我们需要它在完成时重置计时器）。
- en: ❼ Adds a conditional class to the timer section to display the ticking colon
    when running
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: ❼ 为计时器部分添加一个条件类，以在运行时显示滴答的冒号
- en: ❽ Passes the remaining time to the time display component
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: ❽ 将剩余时间传递给时间显示组件
- en: ❾ Displays a different button depending on whether the time is running or not
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: ❾ 根据时间是否在运行显示不同的按钮
- en: ❿ If running, we display a pause button that pauses the timer. If not running,
    we do the opposite.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: ❿ 如果正在运行，我们显示一个暂停按钮来暂停计时器。如果不运行，我们做相反的操作。
- en: 12.2.5 Running the application
  id: totrans-199
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.5 运行应用程序
- en: If you spin this application up in the browser, you’ll see the web app in figure
    12.10.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在这个浏览器中启动这个应用，你将看到图12.10所示的web应用。
- en: '![12-10](../Images/12-10.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![12-10](../Images/12-10.png)'
- en: Figure 12.10 The timer can be running or paused. While running, the colon flashes
    as time ticks down. The button changes appearance and behavior depending on the
    play state.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.10 计时器可以是正在运行或暂停的状态。在运行时，冒号会随着时间流逝而闪烁。按钮的外观和行为会根据播放状态而改变。
- en: '12.3 Homework: Initializing the timer to a custom time'
  id: totrans-203
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.3 家庭作业：将计时器初始化为自定义时间
- en: 'The goal for this step is to initialize the timer at a custom time defined
    by the user through a form with inputs. Here are a few hints to complete this
    objective:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 这个步骤的目标是通过用户通过表单输入定义的自定义时间初始化计时器。以下是一些完成这个目标的提示：
- en: Create a new component to handle adding a new timer. See the stylesheet for
    some classes that will help you out in styling this form and its inputs.
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新的组件来处理添加新计时器。查看样式表，其中有一些类可以帮助你为这个表单及其输入进行样式设计。
- en: Decide between making the new timer form controlled or not. Both are valid options
    for this component.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 决定是否使新的计时器表单成为受控的。这两个选项对于这个组件都是有效的。
- en: Remember that adding a button to a form will make it a Submit button, even if
    it doesn’t have a click handler.
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记住，将按钮添加到表单中会使它成为一个提交按钮，即使它没有点击处理程序。
- en: Make the timer manager stateful, and remember whether you have a timer set or
    not and what the starting time of that timer is.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使计时器管理器具有状态性，并记住你是否设置了计时器以及那个计时器的起始时间。
- en: Add a Trash button (with the trash icon) to the timer component.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个垃圾桶按钮（带有垃圾桶图标）添加到计时器组件中。
- en: The timer component wants a new property, that is, a callback to invoke when
    the timer has either run out or been discarded. This callback should reset the
    timer manager so you can use the new timer form again.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计时器组件需要一个新属性，即当计时器运行完毕或被丢弃时调用的回调。此回调应重置计时器管理器，以便您可以再次使用新的计时器表单。
- en: We, of course, want you to work from your existing application that you developed
    in the previous step, but if you want to start from our solution to that step,
    you can do so by checking out the rq12-playpause repository. Once completed, feel
    free to compare your solution to ours.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们希望您从上一步中开发的现有应用程序开始工作，但如果您想从我们的解决方案开始，可以通过检出rq12-playpause仓库来实现。完成后，您可以自由地比较您的解决方案与我们的。
- en: 'Repository: rq12-initialize'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 仓库：rq12-initialize
- en: 'This example can be seen in repository rq12-initialize. You can use that repository
    by creating a new app based on the associated template:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例可在rq12-initialize仓库中看到。您可以通过创建基于相关模板的新应用程序来使用该仓库：
- en: '[PRE23]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Alternatively, you can go to this website to browse the code, see the application
    in action directly in your browser, or download the source code as a zip file:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您可以去这个网站浏览代码，直接在浏览器中查看应用程序的运行情况，或下载源代码的zip文件：
- en: '[https://rq2e.com/rq12-initialize](https://rq2e.com/rq12-initialize)'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://rq2e.com/rq12-initialize](https://rq2e.com/rq12-initialize)'
- en: '12.4 Homework: Resetting timers'
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.4 家庭作业：重置计时器
- en: 'The goal for this step is to convert the state logic to a reducer and add more
    logic to handle resetting the timer as well. Here are a few hints to complete
    this objective:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 本步骤的目标是将状态逻辑转换为reducer，并添加更多逻辑来处理重置计时器。以下是一些完成此目标的提示：
- en: Convert the state in the timer to a reducer.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将计时器中的状态转换为reducer。
- en: Add a new Reset button to the timer, and allow a timer to be restarted by invoking
    the proper action on the reducer. Think carefully about what should happen to
    both values in the reducer on reset.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在计时器中添加一个新的重置按钮，并允许通过在reducer上调用适当的操作来重新启动计时器。仔细思考在重置时reducer中的两个值应该发生什么。
- en: Finally, you might want to change what happens when a timer completes. So rather
    than just deleting it, you could leave it in place until actively deleted.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，您可能想改变计时器完成时发生的事情。所以，而不是仅仅删除它，您可以选择将其保留在原位，直到主动删除。
- en: We, of course, want you to work from your existing application that you developed
    in the previous step, but if you want to start from our solution, you can do so
    by checking out the rq12-initialize repository. Once completed, feel free to compare
    your solution to ours.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们希望您从上一步中开发的现有应用程序开始工作，但如果您想从我们的解决方案开始，可以通过检出rq12-initialize仓库来实现。完成后，您可以自由地比较您的解决方案与我们的。
- en: 'Repository: rq12-reset'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 仓库：rq12-reset
- en: 'This example can be seen in repository rq12-reset. You can use that repository
    by creating a new app based on the associated template:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例可在rq12-reset仓库中看到。您可以通过创建基于相关模板的新应用程序来使用该仓库：
- en: '[PRE24]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'Alternatively, you can go to this website to browse the code, see the application
    in action directly in your browser, or download the source code as a zip file:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您可以去这个网站浏览代码，直接在浏览器中查看应用程序的运行情况，或下载源代码的zip文件：
- en: '[https://rq2e.com/rq12-reset](https://rq2e.com/rq12-reset)'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://rq2e.com/rq12-reset](https://rq2e.com/rq12-reset)'
- en: '12.5 Homework: Multiple timers'
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.5 家庭作业：多个计时器
- en: 'The goal for this step is to allow the user to define multiple timers that
    will run independently of each other. Here are a few hints to complete this objective:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 本步骤的目标是允许用户定义多个计时器，它们将相互独立运行。以下是一些完成此目标的提示：
- en: Update the state kept in the timer manager to allow multiple managers to be
    running at the same time (with different starting times).
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新计时器管理器中保持的状态，以允许同时运行多个管理器（具有不同的起始时间）。
- en: Make sure to still support deleting timers at any point.
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保仍然支持在任何时候删除计时器。
- en: Allow a timer to display completion by flashing (there’s a class in the stylesheet
    for that), so that the user can either reset or discard the timer at this point.
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 允许计时器通过闪烁（样式表中有一个相应的类）来显示完成，这样用户就可以在这个时候重置或丢弃计时器。
- en: In the timer manager, allow the user to press a button to add a new timer, but
    don’t display the new timer form until the Add button is pressed. When a new timer
    is added, reset to the Add button again.
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在计时器管理器中，允许用户按下按钮添加新的计时器，但在按下添加按钮之前不要显示新的计时器表单。当添加新的计时器时，再次重置到添加按钮。
- en: We, of course, want you to work from your existing application that you developed
    in the previous step, but if you want to start from our solution to that step,
    you can do so by checking out the rq12-reset repository. Once completed, feel
    free to compare your solution to ours.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们希望您从之前步骤中开发的现有应用开始工作，但如果您想从我们的解决方案开始，可以通过检出rq12-reset仓库来实现。一旦完成，您可以自由地比较您的解决方案与我们的。
- en: 'Repository: rq12-multiple'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 仓库：rq12-multiple
- en: 'This example can be seen in repository rq12-multiple. You can use that repository
    by creating a new app based on the associated template:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子可以在rq12-multiple仓库中看到。您可以通过创建一个基于相关模板的新应用来使用该仓库：
- en: '[PRE25]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'Alternatively, you can go to this website to browse the code, see the application
    in action directly in your browser, or download the source code as a zip file:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，您可以访问此网站浏览代码，直接在浏览器中查看应用的实际运行情况，或下载源代码的zip文件：
- en: '[https://rq2e.com/rq12-multiple](https://rq2e.com/rq12-multiple)'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: '[rq12-multiple](https://rq2e.com/rq12-multiple)'
- en: Summary
  id: totrans-240
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: In this project, we take on a more complex application that has some real-world
    usage possibilities.
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在这个项目中，我们承担了一个更复杂的应用，它具有一些实际应用的可能性。
- en: We once again go over the steps that you would be going through if taking on
    such a project in a professional setting—whether working alone or in a team.
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们再次回顾了在专业环境中承担此类项目时您将经历的步骤——无论是单独工作还是团队合作。
- en: Remember to study your designs and your subject matter up front, as this will
    often give you a good idea about how to structure your final application. In this
    project, we were able to deduce which components we needed directly from the design
    alone and keep that separation of logic throughout.
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请记住，在开始之前研究您的设计和主题，因为这通常会给您一个关于如何构建最终应用的良好想法。在这个项目中，我们能够仅从设计本身推断出我们需要的组件，并保持逻辑的分离。
- en: Also think about the internal state of components, and remember that you can
    have state in many different layers at the same time. In this project, we have
    state in three different layers that work independently of each other, though
    they have an interface between themselves as they interact.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 还要考虑组件的内部状态，并记住您可以在多个不同层同时拥有状态。在这个项目中，我们有三个不同层的状态，它们相互独立工作，尽管它们在交互时之间存在接口。
- en: The list of timers has just that—a list of timers. It knows what each timer
    is started at, but doesn’t actually know which ones are running, if they have
    expired, or if they’re just ticking away.
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计时器列表就是这样一个列表——计时器的列表。它知道每个计时器何时启动，但实际上并不知道哪些计时器正在运行，是否已过期，或者它们只是在滴答作响。
- en: The individual timer runs on its own until it’s deleted. When that happens,
    it invokes a callback provided from its parent without actually caring what happens
    afterward.
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单个计时器会独立运行，直到被删除。当发生这种情况时，它会调用其父级提供的回调，而实际上并不关心之后会发生什么。
- en: The form to add a new timer remembers the state of the form and calls a callback
    once submitted. It has no idea what happens after the form has been submitted.
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加新计时器的表单会记住表单的状态，并在提交后调用回调。它并不知道表单提交后会发生什么。
- en: If you’re building real-world applications, think about proper semantics (not
    everything should be a <div>), and pay attention to accessibility (add proper
    roles and labels to elements where applicable).
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果您正在构建实际应用，请考虑适当的语义（并非所有内容都应该是<div>），并注意可访问性（在适用元素上添加适当的角色和标签）。
