- en: 'Chapter 18\. Case Study: How to Weigh a Donkey'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第18章：案例研究：如何称量一只驴
- en: Donkeys play important roles in rural Kenya. People need them to transport crops,
    water, and people and to plow fields. When a donkey gets sick, the veterinarian
    needs to figure out how much the donkey weighs in order to prescribe the right
    amount of medicine. But many vets in rural Kenya don’t have access to a scale,
    so they need to guess the donkey’s weight. Too little medicine can allow an infection
    to reemerge; too much medicine can cause a harmful overdose. There are over 1.8
    million donkeys in Kenya, so it’s important to have a simple, accurate way to
    estimate the weight of a donkey.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 驴子在肯尼亚农村扮演着重要角色。人们需要它们来运输作物、水和人，以及耕种田地。当一只驴子生病时，兽医需要知道它的体重以便开对量的药物。但是在肯尼亚农村，许多兽医没有称重器，因此他们需要猜测驴子的体重。药物用量过少可能会导致感染再次发作；药物过多则可能导致有害的过量。肯尼亚有超过180万头驴子，因此估算驴子体重的方法简单而准确非常重要。
- en: In this case study, we follow the work of [Kate Milner and Jonathan Rougier](https://doi.org/10.1111/j.1740-9713.2014.00768.x)
    to create a model that veterinarians in the Kenyan countryside can use to make
    accurate estimates of a donkey’s weight. As usual, we walk through the steps of
    the data science lifecycle, but this time our work departs from the basics covered
    so far in this book. You can think of this case study as an opportunity to reflect
    on many of the core principles of working with data and to understand how they
    can be extended to address the context of the situation. We directly evaluate
    sources of measurement error, design a special loss function that reflects the
    concern about an overdose, build a model while keeping applicability top of mind,
    and evaluate model predictions using special criteria that are relative to the
    donkey’s size.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个案例研究中，我们追随[凯特·米尔纳和乔纳森·鲁吉尔](https://doi.org/10.1111/j.1740-9713.2014.00768.x)
    的工作，创建一个模型，供肯尼亚农村的兽医使用，以准确估计驴子的体重。像往常一样，我们遵循数据科学生命周期的步骤，但这次我们的工作偏离了这本书迄今为止涵盖的基础知识。您可以把这个案例研究看作是反思许多数据处理核心原则的机会，并理解如何扩展这些原则以应对具体情况。我们直接评估测量误差的来源，设计一个反映对过量用药关注的特殊损失函数，构建一个以适用性为重点的模型，并使用相对于驴子大小的特殊标准评估模型预测。
- en: We begin with the scope of the data.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从数据的范围开始。
- en: Donkey Study Question and Scope
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 驴子研究问题与范围
- en: 'Our motivating question is: how can a vet accurately estimate the weight of
    a donkey when they’re out in the countryside without a scale? Let’s think about
    the information that is more readily available to them. They can carry a tape
    measure and find the size of the donkey in other dimensions, like its height.
    They can observe the animal’s sex, assess its general condition, and inquire about
    the donkey’s age. So we can refine our question to: how can a vet accurately predict
    the weight of a donkey from easy-to-get measurements?'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的动力问题是：在没有称重器的情况下，兽医如何准确估算驴子的体重？让我们考虑一下他们更容易得到的信息。他们可以携带卷尺，并找出驴子在其他尺寸上的大小，比如它的高度。他们可以观察动物的性别，评估其一般状态，并询问驴子的年龄。因此，我们可以将我们的问题进一步细化为：兽医如何从易于获取的测量数据中准确预测驴子的体重？
- en: To address this more precise question, [The Donkey Sanctuary](https://oreil.ly/uUyZj)
    carried out a study at 17 mobile deworming sites in rural Kenya.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决这个更精确的问题，[驴避难所](https://oreil.ly/uUyZj) 在肯尼亚农村的17个移动驱虫点进行了研究。
- en: 'In terms of scope ([Chapter 2](ch02.html#ch-data-scope)), the target population
    is the donkey population in rural Kenya. The access frame is the set of all donkeys
    that were brought into the de-worming sites. The sample consists of all donkeys
    brought to these sites between July 23 and August 11, 2010, with a few caveats:
    if there were too many donkeys to measure at a site, the scientists selected a
    subset of donkeys to measure, and any pregnant or visibly diseased donkeys were
    excluded from the study.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在范围方面（[第2章](ch02.html#ch-data-scope)），目标人群是肯尼亚农村的驴群。访问框架是所有被带到驱虫点的驴子。样本包括2010年7月23日至8月11日被带到这些点的所有驴子，但有一些注意事项：如果在一个地点有太多的驴子需要测量，科学家们会选择一部分来测量，并且任何怀孕或明显生病的驴子都被排除在研究之外。
- en: To avoid accidentally weighing a donkey twice, each donkey was marked after
    weighing. To quantify the measurement error and assess repeatability of the weighing
    process, 31 donkeys were measured twice, without the staff knowing that a donkey
    was being reweighed.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 为了避免不小心对同一只驴进行两次称重，每只驴在称重后都会标记。为了量化测量误差并评估称重过程的重复性，我们对31只驴进行了两次测量，而工作人员并不知道这是一只已经被重新称重的驴。
- en: 'With this sampling process in mind, potential sources of bias for this data
    include:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到这一抽样过程，此数据的潜在偏差源包括：
- en: Coverage bias
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 覆盖偏差
- en: The 17 sites were located in the regions surrounding the Yatta district in eastern
    Kenya and the Naivasha district in the Rift Valley.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 这17个地点位于肯尼亚东部雅塔区和大裂谷内纳瓦沙区周围的地区。
- en: Selection bias
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 选择偏差
- en: Only donkeys brought to the sanctuary were enrolled in the study, and when there
    were too many donkeys at a site, a nonrandom sample was selected.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 只有被送往庇护所的驴才能参加这项研究，当一个地点有太多的驴时，会选择一个非随机样本。
- en: Measurement bias
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 测量偏差
- en: In addition to measurement error, the scale might have a bias. Ideally, the
    scale(s) would be calibrated before and after use at a site ([Chapter 12](ch12.html#ch-pa)).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 除了测量误差外，称可能存在偏差。理想情况下，在使用场地之前和之后，天平应该校准（[第12章](ch12.html#ch-pa)）。
- en: Despite these potential sources of bias, the access frame seems reasonable for
    accessing donkeys from rural areas in Kenya that have owners looking after the
    health of their animals.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管存在这些潜在的偏差源，但从肯尼亚农村地区拥有关心动物健康的主人那里获取驴的访问框架似乎是合理的。
- en: Our next step is to clean the data.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的下一步是清理数据。
- en: Wrangling and Transforming
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据整理和转换
- en: 'We begin by taking a peek at the contents of our datafile. To do this, we open
    the file and examine the first few rows ([Chapter 8](ch08.html#ch-files)):'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先看一下数据文件的内容。为此，我们打开文件并检查前几行（[第8章](ch08.html#ch-files)）：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Since the file is CSV-formatted, we can easily read it into a dataframe:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 由于文件是CSV格式的，我们可以轻松地将其读入数据框架：
- en: '[PRE2]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '|   | BCS | Age | Sex | Length | Girth | Height | Weight | WeightAlt |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '|   | BCS | 年龄 | 性别 | 长度 | 胸围 | 身高 | 体重 | WeightAlt |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **0** | 3.0 | <2 | stallion | 78 | 90 | 90 | 77 | NaN |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| **0** | 3.0 | <2 | 种马 | 78 | 90 | 90 | 77 | NaN |'
- en: '| **1** | 2.5 | <2 | stallion | 91 | 97 | 94 | 100 | NaN |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| **1** | 2.5 | <2 | 种马 | 91 | 97 | 94 | 100 | NaN |'
- en: '| **2** | 1.5 | <2 | stallion | 74 | 93 | 95 | 74 | NaN |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| **2** | 1.5 | <2 | 种马 | 74 | 93 | 95 | 74 | NaN |'
- en: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... |'
- en: '| **541** | 2.5 | 10-15 | stallion | 103 | 118 | 103 | 174 | NaN |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| **541** | 2.5 | 10-15 | 种马 | 103 | 118 | 103 | 174 | NaN |'
- en: '| **542** | 3.0 | 2-5 | stallion | 91 | 112 | 100 | 139 | NaN |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| **542** | 3.0 | 2-5 | 种马 | 91 | 112 | 100 | 139 | NaN |'
- en: '| **543** | 3.0 | 5-10 | stallion | 104 | 124 | 110 | 189 | NaN |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| **543** | 3.0 | 5-10 | 种马 | 104 | 124 | 110 | 189 | NaN |'
- en: '[PRE3]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Over five hundred donkeys participated in the survey, and eight measurements
    were made on each donkey. According to the documentation, the granularity is a
    single donkey ([Chapter 9](ch09.html#ch-wrangling)). [Table 18-1](#tbl-donkey-codebook)
    provides descriptions of the eight features.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 超过五百只驴参与了调查，每只驴进行了八次测量。根据文档，粒度是单个驴（[第9章](ch09.html#ch-wrangling)）。[表18-1](#tbl-donkey-codebook)提供了这八个特征的描述。
- en: Table 18-1\. Donkey study codebook
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 表18-1\. 驴研究代码手册
- en: '| Feature | Data type | Feature type | Description |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 特征 | 数据类型 | 特征类型 | 描述 |'
- en: '| --- | --- | --- | --- |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| BCS | float64 | Ordinal | Body condition score: from 1 (emaciated) to 3 (healthy)
    to 5 (obese) in increments of 0.5. |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| BCS | float64 | 有序 | 身体条件评分：从1（消瘦）到3（健康）到5（肥胖），每0.5单位增加。 |'
- en: '| Age | string | Ordinal | Age in years, under 2, 2–5, 5–10, 10–15, 15–20,
    and over 20 years |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 年龄 | string | 有序 | 年龄（年），小于2岁、2-5岁、5-10岁、10-15岁、15-20岁和20岁以上 |'
- en: '| Sex | string | Nominal | Sex categories: stallion, gelding, female |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 性别 | string | 名义 | 性别类别：种马、阉马、母驴 |'
- en: '| Length | int64 | Numeric | Body length (cm) from front leg elbow to back
    of pelvis |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 长度 | int64 | 数值 | 体长（厘米），从前腿肘到骨盆后部 |'
- en: '| Girth | int64 | Numeric | Body circumference (cm), measured just behind front
    legs |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| 胸围 | int64 | 数值 | 身体围长（厘米），在前腿后面测量 |'
- en: '| Height | int64 | Numeric | Body height (cm) up to point where neck connects
    to back |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 身高 | int64 | 数值 | 身体高度（厘米），到颈部连接背部的点 |'
- en: '| Weight | int64 | Numeric | Weight (kilogram) |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| 体重 | int64 | 数值 | 体重（千克） |'
- en: '| WeightAlt | float64 | Numeric | Second weight measurement taken on a subset
    of donkeys |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| WeightAlt | float64 | 数值 | 在一部分驴身上进行的第二次称重测量 |'
- en: '[Figure 18-1](#fig-donkeydiagram) is a stylized representation of a donkey
    as a cylinder with neck and legs appended. Height is measured from the ground
    to the base of the neck above the shoulders; girth is around the body, just behind
    the legs; and length is from the front elbow to the back of the pelvis.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '[图18-1](#fig-donkeydiagram)是将驴子理想化为带有颈部和附加的腿的圆柱体的图示。身高是从地面到肩膀上方的颈部底部的测量；胸围是围绕身体，就在后腿后面；长度是从前肘到骨盆后部。'
- en: '![](assets/leds_1801.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_1801.png)'
- en: Figure 18-1\. Diagram of a donkey’s girth, length, and height, characterized
    as measurements on a cylinder
  id: totrans-48
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图18-1。驴的胸围、长度和高度的图示，被描述为对圆柱体上的测量
- en: Our next step is to perform some quality checks on the data. In the previous
    section, we listed a few potential quality concerns based on scope. Next, we check
    the quality of the measurements and their distributions.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的下一步是对数据进行一些质量检查。在上一节中，我们基于范围列出了一些潜在的质量问题。接下来，我们检查测量和它们的分布的质量。
- en: 'Let’s start by comparing the two weight measurements made on the subset of
    donkeys to check on the consistency of the scale. We make a histogram of the difference
    between these two measurements for the 31 donkeys that were weighed twice:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先比较对一小部分驴子进行的两次体重测量，以检查秤的一致性。我们为这31只被称重两次的驴子制作了这两个测量值之间的差异的直方图：
- en: '[PRE4]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](assets/leds_18in01.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in01.png)'
- en: The measurements are all within 1 kg of each other, and the majority are exactly
    the same (to the nearest kilogram). This gives us confidence in the accuracy of
    the measurements.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这些测量值彼此之间都在1公斤以内，大部分都是完全相同的（四舍五入到最接近的公斤）。这让我们对测量的准确性有信心。
- en: 'Next, we look for unusual values in the body condition score:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们寻找体况评分中的异常值：
- en: '[PRE5]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[PRE6]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'From this output, we see that there’s only one emaciated (BCS = 1) and one
    obese (BCS = 4.5) donkey. Let’s look at the complete records for these two donkeys:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个输出中，我们看到只有一个消瘦的（BCS = 1）和一个肥胖的（BCS = 4.5）驴子。让我们看看这两只驴子的完整记录：
- en: '[PRE7]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '|   | BCS | Age | Sex | Length | Girth | Height | Weight | WeightAlt |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '|   | BCS | 年龄 | 性别 | 长度 | 胸围 | 身高 | 体重 | 体重备用 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **291** | 4.5 | 10-15 | female | 107 | 130 | 106 | 227 | NaN |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| **291** | 4.5 | 10-15 | 女性 | 107 | 130 | 106 | 227 | NaN |'
- en: '| **445** | 1.0 | >20 | female | 97 | 109 | 102 | 115 | NaN |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| **445** | 1.0 | >20 | 女性 | 97 | 109 | 102 | 115 | NaN |'
- en: Since these BCS values are extreme, we want to be cautious about including these
    two donkeys in our analysis. We have only one donkey in each of these extreme
    categories, so our model might well not extend to donkeys with a BCS of 1 or 4.5\.
    We remove these two records from the dataframe and note that our analysis may
    not extend to emaciated or obese donkeys. In general, we exercise caution in dropping
    records from a dataframe. Later, we may also decide to remove the five donkeys
    with a score of 1.5 if they appear anomalous in our analysis, but for now, we
    keep them in our dataframe. In general, we need a good reason to exclude data,
    and we should document these actions since they can impact our findings. Removing
    data can lead to over fitting, if we drop any record that disagrees with the model.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这些BCS值非常极端，我们要谨慎考虑将这两只驴子纳入我们的分析范围。在这两个极端类别中，我们每个类别只有一只驴子，因此我们的模型可能无法延伸到BCS为1或4.5的驴子。我们将这两条记录从数据框中删除，并注意到我们的分析可能不适用于消瘦或肥胖的驴子。总的来说，我们在删除数据框中的记录时要小心。稍后，如果这五只BCS为1.5的驴子在我们的分析中看起来不正常，我们也可能决定将它们删除，但目前，我们将它们保留在我们的数据框中。一般来说，我们需要一个充分的理由来排除数据，并且我们应该记录这些操作，因为它们可能会影响我们的发现。如果我们删除与模型不符的任何记录，可能会导致过度拟合。
- en: 'We remove these two outliers next:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来删除这两个异常值：
- en: '[PRE8]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now, we examine the distribution of values for weight to see if there are any
    issues with quality:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们检查体重值的分布，以查看是否存在任何质量问题：
- en: '[PRE9]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](assets/leds_18in02.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in02.png)'
- en: 'It appears there is one very light donkey weighing less than 30 kg. Next, we
    check the relationship between weight and height to assess the quality of the
    data for analysis:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 看起来有一只非常轻的驴子，体重不到30公斤。接下来，我们检查体重和身高之间的关系，以评估用于分析的数据质量。
- en: '[PRE10]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](assets/leds_18in03.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in03.png)'
- en: 'The small donkey is far from the main concentration of donkeys and would overly
    influence our models. For this reason, we exclude it. Again, we keep in mind that
    we may also want to exclude the one or two heavy donkeys if they appear to overly
    influence our future model fitting:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 小驴离主要驴群较远，会对我们的模型产生过大影响，因此我们将其排除。同样，我们要注意，如果有一两匹重驴对我们未来的模型拟合产生过大影响，我们也可能要将它们排除：
- en: '[PRE11]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[PRE12]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: In summary, based on our cleaning and quality checks, we removed three anomalous
    observations from the dataframe. Now we’re nearly ready to begin our exploratory
    analysis. Before we proceed, we set aside some of our data as a test set.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 总之，根据我们的清理和质量检查，我们从数据框中删除了三个异常观测。现在我们几乎可以开始我们的探索性分析了。在继续之前，我们将一些数据设置为测试集。
- en: We talked about why it’s important to separate out a test set from the train
    set in [Chapter 16](ch16.html#ch-risk). A best practice is to separate out a test
    set early in the analysis, before we explore the data in detail, because in EDA,
    we begin to make decisions about what kinds of models to fit and what variables
    to use in the model. It’s important that our test set isn’t involved in these
    decisions so that it imitates how our model would perform with entirely new data.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 我们讨论了在[第16章](ch16.html#ch-risk)中将测试集与训练集分开的重要性。最佳实践是在分析早期就将测试集分开，这样我们在详细探索数据之前就开始做出关于适合哪种模型以及在模型中使用哪些变量的决定。很重要的一点是，我们的测试集不参与这些决策，以便模拟我们的模型在全新数据上的表现。
- en: 'We divide our data into an 80/20 split, where we use 80% of the data to explore
    and build a model. Then we evaluate the model with the 20% that has been set aside.
    We use a simple random sample to split the dataframe into the test and train sets.
    To begin, we randomly shuffle the indices of the dataframe:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将数据分成80/20的比例，其中80%用于探索和建模。然后，我们用设置的20%来评估模型。我们使用简单随机抽样将数据框分为测试集和训练集。首先，我们随机打乱数据框的索引：
- en: '[PRE13]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Next, we assign the first 80% of the dataframe to the train set and the remaining
    20% to the test set:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将数据框的前80%分配给训练集，剩余的20%分配给测试集：
- en: '[PRE14]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Now we’re ready to explore the training data and look for useful relationships
    and distributions that inform our modeling.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们准备探索训练数据，寻找有用的关系和分布，为我们的建模提供信息。
- en: Exploring
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索中
- en: 'Let’s look at the features in our dataframe for shapes and relationships that
    will help us make transformations and models ([Chapter 10](ch10.html#ch-eda)).
    We start by looking at how the categorical features of age, sex, and body condition
    relate to weight:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 我们查看数据框中的形状和关系特征，以便进行转换和模型制作（[第10章](ch10.html#ch-eda)）。我们首先看看年龄、性别和体况这些分类特征如何与体重相关联：
- en: '[PRE15]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](assets/leds_18in04.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in04.png)'
- en: '[PRE16]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![](assets/leds_18in05.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in05.png)'
- en: Notice that we plotted the points as well as the boxes for the body condition
    score because we saw earlier that there are only a handful of observations with
    a score of 1.5, so we don’t want to read too much into a box plot with only a
    few data points ([Chapter 11](ch11.html#ch-viz)). It appears that the median weight
    increases with the body condition score, but not in a simple linear fashion. On
    the other hand, weight distributions for the three sex categories appear roughly
    the same. As for age, once a donkey reaches five years, the distribution of weight
    doesn’t seem to change much. But donkeys under age 2 and donkeys from 2 to 5 years
    of age have lower weights in general.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们绘制了身体状况评分的点和箱线图，因为我们之前看到评分为1.5的观测值只有少数几个，所以我们不希望过多解读仅有少量数据点的箱线图（[第11章](ch11.html#ch-viz)）。看起来，体重中位数随着体况评分增加而增加，但增长并非简单线性。另一方面，三种性别类别的体重分布看起来大致相同。至于年龄，一旦一匹驴达到五岁，其体重分布似乎不会有太大变化。但两岁以下的驴和两至五岁的驴的体重普遍较低。
- en: 'Next, let’s examine the quantitative variables. We plot all pairs of quantitative
    variables in the scatterplot matrix:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们检查定量变量。我们在散点图矩阵中绘制所有定量变量的成对关系：
- en: '![](assets/leds_18in06.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in06.png)'
- en: 'The height, length, and girth of donkeys all appear linearly associated with
    weight and with each other. This is not too surprising; given one of the donkey’s
    dimensions, we should have a good guess about the other dimensions. Girth appears
    most highly correlated with weight, and this is confirmed by the correlation coefficient
    matrix:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 骡子的身高、长度和腰围都与体重以及彼此之间线性相关。这并不太令人惊讶；只要知道骡子的一个维度，我们就可以大致猜测其他维度。腰围与体重的相关性最高，这在相关系数矩阵中得到了验证：
- en: '[PRE17]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '|   | Weight | Length | Girth | Height |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '|   | 权重 | 长度 | 腰围 | 身高 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '| **Weight** | 1.00 | 0.78 | 0.90 | 0.71 |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
  zh: '| **体重** | 1.00 | 0.78 | 0.90 | 0.71 |'
- en: '| **Length** | 0.78 | 1.00 | 0.66 | 0.58 |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '| **长度** | 0.78 | 1.00 | 0.66 | 0.58 |'
- en: '| **Girth** | 0.90 | 0.66 | 1.00 | 0.70 |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '| **腰围** | 0.90 | 0.66 | 1.00 | 0.70 |'
- en: '| **Height** | 0.71 | 0.58 | 0.70 | 1.00 |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '| **身高** | 0.71 | 0.58 | 0.70 | 1.00 |'
- en: Our explorations uncovered several aspects of the data that may be relevant
    for modeling. We found that the donkey’s girth, length, and height all have linear
    associations with weight and with each other, and girth has the strongest linear
    relationship with weight. We also observed that the body condition score has a
    positive association with weight; the sex of the donkey does not appear related
    to weight; and neither does age for those donkeys over 5 years. In the next section,
    we use these findings to build our model.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的探索揭示了数据的几个可能与建模相关的方面。我们发现骡子的腰围、长度和身高都与体重以及彼此之间线性相关，腰围与体重的线性关系最强。我们还观察到，体况评分与体重呈正相关；骡子的性别似乎与体重无关；对于5岁以上的骡子，年龄也与体重无关。在下一节中，我们将利用这些发现来构建我们的模型。
- en: Modeling a Donkey’s Weight
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模拟骡子的体重
- en: We want to build a simple model for predicting the weight of a donkey. The model
    should be easy for a vet to implement in the field with only a hand calculator.
    The model should also be easy to interpret.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想建立一个简单的模型来预测骡子的体重。这个模型应该易于兽医在现场仅使用手算器时实现。模型也应该易于解释。
- en: We also want the model to depend on the vet’s situation—for example, whether
    they’re prescribing an antibiotic or an anesthetic. For brevity, we only consider
    the case of prescribing an anesthetic. Our first step is to choose a loss function
    that reflects this situation.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还希望模型能够依赖于兽医的情况——例如，他们是否正在开具抗生素或麻醉药。为了简洁起见，我们只考虑开具麻醉药的情况。我们第一步是选择一个反映这种情况的损失函数。
- en: A Loss Function for Prescribing Anesthetics
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 麻醉药开具的损失函数
- en: 'An overdose of an anesthetic can be much worse than an underdose. It’s not
    hard for a vet to see when a donkey has too little anesthetic (it’ll complain),
    and the vet can give the donkey a bit more. On the other hand, too much anesthetic
    can have serious consequences and can even be fatal. Because of this, we want
    an asymmetric loss function: it should have a bigger loss for an overestimate
    of weight compared to an underestimate. This is in contrast to the other loss
    functions that we have used so far in this book, which have all been symmetric.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 麻醉药的过量可能比不足更糟。兽医很容易看出骡子麻醉药不足（它会抱怨），并且兽医可以给骡子再多点。但另一方面，麻醉药过多可能会有严重后果，甚至可能致命。因此，我们需要一个非对称的损失函数：对于体重的过高估计，它的损失应该大于对低估的损失。这与我们到目前为止在本书中使用的其他所有损失函数不同，它们都是对称的。
- en: 'We’ve created a loss function `anes_loss(x)` with this in mind:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 为了这个目的，我们创建了一个损失函数 `anes_loss(x)`：
- en: '[PRE18]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The relative error is <math><mn>100</mn> <mo stretchy="false">(</mo> <mi>y</mi>
    <mo>−</mo> <mrow><mover><mi>y</mi> <mo stretchy="false">^</mo></mover></mrow>
    <mo stretchy="false">)</mo> <mrow><mo>/</mo></mrow> <mrow><mover><mi>y</mi> <mo
    stretchy="false">^</mo></mover></mrow></math> , where <math><mi>y</mi></math>
    is the true value and <math><mrow><mover><mi>y</mi> <mo stretchy="false">^</mo></mover></mrow></math>
    is the prediction. We can demonstrate the asymmetry of the loss function with
    a plot:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 相对误差为 <math><mn>100</mn> <mo stretchy="false">(</mo> <mi>y</mi> <mo>−</mo> <mrow><mover><mi>y</mi>
    <mo stretchy="false">^</mo></mover></mrow> <mo stretchy="false">)</mo> <mrow><mo>/</mo></mrow>
    <mrow><mover><mi>y</mi> <mo stretchy="false">^</mo></mover></mrow></math> ，其中
    <math><mi>y</mi></math> 为真实值，<math><mrow><mover><mi>y</mi> <mo stretchy="false">^</mo></mrow></math>
    为预测值。我们可以通过一个图示来展示损失函数的非对称性：
- en: '![](assets/leds_18in07.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in07.png)'
- en: Note that a value of –10 on the x-axis reflects an overestimate of 10%.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，x轴上值为-10反映了10%的过高估计。
- en: Next, let’s fit a simple linear model using this loss function.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们使用这个损失函数拟合一个简单   接下来，让我们使用这个损失函数拟合一个简单的线性模型。
- en: Fitting a Simple Linear Model
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 拟合一个简单的线性模型
- en: 'We saw that girth has the highest correlation with weight among the donkeys
    in our train set. So we fit a model of the form:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 我们发现，腰围在我们的训练集中与体重的相关性最高。所以我们拟合了一个形式为的模型：
- en: <math display="block"><msub><mi>θ</mi> <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi>
    <mn>1</mn></msub> <mtext>Girth</mtext></math>
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><msub><mi>θ</mi> <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi>
    <mn>1</mn></msub> <mtext>Girth</mtext></math>
- en: 'To find the best fit <math><msub><mi>θ</mi> <mn>0</mn></msub></math> and <math><msub><mi>θ</mi>
    <mn>1</mn></msub></math> to the data, we first create a design matrix that has
    girth and an intercept term. We also create the <math><mi>y</mi></math> vector
    of observed donkey weights:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 要找到数据的最佳拟合<math><msub><mi>θ</mi> <mn>0</mn></msub></math>和<math><msub><mi>θ</mi>
    <mn>1</mn></msub></math>，我们首先创建一个具有腰围和截距项的设计矩阵。我们还创建了观察到的驴子体重的<math><mi>y</mi></math>向量：
- en: '[PRE19]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '|   | intr | Girth |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '|   | intr | Girth |'
- en: '| --- | --- | --- |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **230** | 1 | 116 |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| **230** | 1 | 116 |'
- en: '| **74** | 1 | 117 |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| **74** | 1 | 117 |'
- en: '| **354** | 1 | 123 |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| **354** | 1 | 123 |'
- en: '| **...** | ... | ... |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... |'
- en: '| **157** | 1 | 123 |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| **157** | 1 | 123 |'
- en: '| **41** | 1 | 103 |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| **41** | 1 | 103 |'
- en: '| **381** | 1 | 106 |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| **381** | 1 | 106 |'
- en: '[PRE20]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Now we want to find the <math><msub><mi>θ</mi> <mn>0</mn></msub></math> and
    <math><msub><mi>θ</mi> <mn>1</mn></msub></math> that minimize the average anesthetic
    loss over the data. To do this, we could use calculus as we did in [Chapter 15](ch15.html#ch-linear),
    but here we’ll instead use the `minimize` method from the `scipy` package, which
    performs a numerical optimization (see [Chapter 20](ch20.html#ch-gd)):'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们想要找到最小化数据上平均麻醉损失的<math><msub><mi>θ</mi> <mn>0</mn></msub></math>和<math><msub><mi>θ</mi>
    <mn>1</mn></msub></math>。为此，我们可以像在[第15章](ch15.html#ch-linear)中一样使用微积分，但在这里我们将使用`scipy`包中的`minimize`方法，该方法执行数值优化（见[第20章](ch20.html#ch-gd)）：
- en: '[PRE21]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '[PRE22]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Let’s see how this simple model does. We can use the model to predict the donkey
    weights on our train set, then find the errors in the predictions. The residual
    plot that follows shows the model error as a percentage of the predicted value.
    It’s more important for the prediction errors to be small relative to the size
    of the donkey, since a 10 kg error is much worse for a 100 kg donkey than a 200
    kg one. Thus, we find the relative error of each prediction:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这个简单模型的效果如何。我们可以使用模型来预测训练集上的驴子体重，然后找到预测中的误差。接下来的残差图显示了模型误差占预测值的百分比。相对于驴子的大小来说，预测误差较小更为重要，因为对于100公斤的驴子来说，10公斤的误差比对于200公斤的驴子来说要糟糕得多。因此，我们计算每个预测的相对误差：
- en: '[PRE23]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Let’s examine a scatterplot of the relative errors:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来检查一下相对误差的散点图：
- en: '[PRE24]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '![](assets/leds_18in08.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in08.png)'
- en: With the simplest model, some of the predictions are off by 20% to 30%. Let’s
    see if a slightly more complicated model improves the predictions.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 使用最简单的模型，一些预测偏差达到了20%至30%。让我们看看稍微复杂一点的模型是否改善了预测。
- en: Fitting a Multiple Linear Model
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 拟合多元线性模型
- en: 'Let’s consider additional models that incorporate the other numeric variables.
    We have three numeric variables that measure the donkey’s girth, length, and height,
    and there are seven total ways to combine these variables in a model:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑进一步的模型，将其他数字变量纳入考虑。我们有三个数字变量来衡量驴子的腰围、长度和高度，有七种组合这些变量的模型：
- en: '[PRE25]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'For each of these variable combinations, we can fit a model with our special
    loss function. Then we can look at how well each model does on the train set:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这些变量组合中的每一个，我们可以使用我们的特殊损失函数来拟合一个模型。然后我们可以查看每个模型在训练集上的表现：
- en: '[PRE26]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '|   | model | mean_training_error |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '|   | model | mean_training_error |'
- en: '| --- | --- | --- |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **0** | [Girth] | 94.36 |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| **0** | [Girth] | 94.36 |'
- en: '| **1** | [Length] | 200.55 |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| **1** | [Length] | 200.55 |'
- en: '| **2** | [Height] | 268.88 |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| **2** | [Height] | 268.88 |'
- en: '| **3** | [Girth, Length] | 65.65 |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| **3** | [Girth, Length] | 65.65 |'
- en: '| **4** | [Girth, Height] | 86.18 |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| **4** | [Girth, Height] | 86.18 |'
- en: '| **5** | [Length, Height] | 151.15 |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| **5** | [Length, Height] | 151.15 |'
- en: '| **6** | [Girth, Length, Height] | 63.44 |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| **6** | [Girth, Length, Height] | 63.44 |'
- en: As we stated earlier, the girth of the donkey is the single best predictor for
    weight. However, the combination of girth and length has an average loss that
    is quite a bit smaller than girth alone, and this particular two-variable model
    is nearly as good as the model that includes all three. Since we want a simple
    model, we select the two-variable model over the three-variable one.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前所述，驴子的腰围是体重的最佳单一预测因子。然而，腰围和长度的组合的平均损失要比仅有腰围的损失要小得多，而且这个特定的双变量模型几乎和包含所有三个变量的模型一样好。由于我们想要一个简单的模型，我们选择了双变量模型而不是三变量模型。
- en: Next, we use feature engineering to incorporate categorical variables into the
    model, which improves our model.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用特征工程将分类变量纳入模型中，这将改善我们的模型。
- en: Bringing Qualitative Features into the Model
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将定性特征纳入模型
- en: In our exploratory analysis, we found that the box plots of weight for a donkey’s
    body condition and age could contain useful information in predicting weight.
    Since these are categorical features, we can transform them into 0-1 variables
    with one-hot encoding, as explained in [Chapter 15](ch15.html#ch-linear).
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的探索性分析中，我们发现驴体条件和年龄的箱线图可能包含有助于预测体重的信息。由于这些是分类特征，我们可以将它们转换为0-1变量，采用独热编码，如[第15章](ch15.html#ch-linear)所述。
- en: 'One-hot encoding lets us adjust the intercept term in the model for each combination
    of categories. Our current model includes the numeric variables girth and length:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 独热编码允许我们调整模型中每个类别组合的截距项。我们当前的模型包括数值变量周长和长度：
- en: <math display="block"><msub><mi>θ</mi> <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi>
    <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo> <msub><mi>θ</mi> <mn>2</mn></msub>
    <mtext>Length</mtext></math>
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><msub><mi>θ</mi> <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi>
    <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo> <msub><mi>θ</mi> <mn>2</mn></msub>
    <mtext>Length</mtext></math>
- en: 'If we cleaned up the age feature to consist of three categories—`Age<2`, `Age2-5`,
    and `Age>5`—a one-hot encoding of age creates three 0-1 features, one for each
    category. Including the one-hot-encoded feature in the model gives:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们将年龄特征清理为三个类别——`年龄<2`、`年龄2-5`和`年龄>5`——年龄的独热编码将创建三个0-1特征，每个类别一个。将独热编码特征包括在模型中得到：
- en: <math display="block"><mtable columnalign="right" columnspacing="0em" displaystyle="true"
    rowspacing="3pt"><mtr><mtd><mtable columnalign="right left" columnspacing="0em"
    displaystyle="true" rowspacing="3pt"><mtr><mtd><msub><mi>θ</mi> <mn>0</mn></msub></mtd>
    <mtd><mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth </mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length </mtext></mtd></mtr> <mtr><mtd><mo>+</mo>
    <msub><mi>θ</mi> <mn>3</mn></msub> <mtext>Age<2 </mtext> <mo>+</mo> <msub><mi>θ</mi>
    <mn>4</mn></msub> <mtext>Age2-5 </mtext></mtd></mtr></mtable></mtd></mtr></mtable></math>
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mtable columnalign="right" columnspacing="0em" displaystyle="true"
    rowspacing="3pt"><mtr><mtd><mtable columnalign="right left" columnspacing="0em"
    displaystyle="true" rowspacing="3pt"><mtr><mtd><msub><mi>θ</mi> <mn>0</mn></msub></mtd>
    <mtd><mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth </mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length </mtext></mtd></mtr> <mtr><mtd><mo>+</mo>
    <msub><mi>θ</mi> <mn>3</mn></msub> <mtext>Age<2 </mtext> <mo>+</mo> <msub><mi>θ</mi>
    <mn>4</mn></msub> <mtext>Age2-5 </mtext></mtd></mtr></mtable></mtd></mtr></mtable></math>
- en: In this model, `Age<2` is 1 for a donkey younger than 2 and 0 otherwise. Similarly,
    `Age2-5` is 1 for a donkey between 2 and 5 years old and 0 otherwise.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个模型中，`年龄<2`表示小于2岁的驴为1，否则为0。类似地，`年龄2-5`表示2至5岁的驴为1，否则为0。
- en: 'We can think of this model as fitting three linear models that are identical
    except for the size of the constant, since the model is equivalent to:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将这个模型看作适合三个相同的线性模型，唯一不同的是常数的大小，因为该模型等同于：
- en: <math display="block"><mtable columnalign="right" columnspacing="0em" displaystyle="true"
    rowspacing="3pt"><mtr><mtd><mtable columnalign="right left" columnspacing="0em"
    displaystyle="true" rowspacing="3pt"><mtr><mtd><mo stretchy="false">(</mo> <msub><mi>θ</mi>
    <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi> <mn>3</mn></msub> <mo stretchy="false">)</mo>
    <mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length</mtext></mtd> <mtd><mtext>for
    a donkey under 2</mtext></mtd></mtr> <mtr><mtd><mo stretchy="false">(</mo> <msub><mi>θ</mi>
    <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi> <mn>4</mn></msub> <mo stretchy="false">)</mo>
    <mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length</mtext></mtd> <mtd><mtext>for
    a donkey between 2 and 4</mtext></mtd></mtr> <mtr><mtd><msub><mi>θ</mi> <mn>0</mn></msub>
    <mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length</mtext></mtd> <mtd>          <mtext>for
    a donkey over 5</mtext></mtd></mtr></mtable></mtd></mtr></mtable></math>
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mtable columnalign="right" columnspacing="0em" displaystyle="true"
    rowspacing="3pt"><mtr><mtd><mtable columnalign="right left" columnspacing="0em"
    displaystyle="true" rowspacing="3pt"><mtr><mtd><mo stretchy="false">(</mo> <msub><mi>θ</mi>
    <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi> <mn>3</mn></msub> <mo stretchy="false">)</mo>
    <mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length</mtext></mtd> <mtd><mtext>for
    a donkey under 2</mtext></mtd></mtr> <mtr><mtd><mo stretchy="false">(</mo> <msub><mi>θ</mi>
    <mn>0</mn></msub> <mo>+</mo> <msub><mi>θ</mi> <mn>4</mn></msub> <mo stretchy="false">)</mo>
    <mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length</mtext></mtd> <mtd><mtext>for
    a donkey between 2 and 4</mtext></mtd></mtr> <mtr><mtd><msub><mi>θ</mi> <mn>0</mn></msub>
    <mo>+</mo> <msub><mi>θ</mi> <mn>1</mn></msub> <mtext>Girth</mtext> <mo>+</mo>
    <msub><mi>θ</mi> <mn>2</mn></msub> <mtext>Length</mtext></mtd> <mtd>          <mtext>for
    a donkey over 5</mtext></mtd></mtr></mtable></mtd></mtr></mtable></math>
- en: 'Now let’s apply a one-hot encoding to all three of our categorical variables
    (body condition, age, and sex):'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们对我们的三个分类变量（体质、年龄和性别）都应用独热编码：
- en: '[PRE27]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '|   | intr | Length | Girth | BCS_1.5 | ... | Age_<2 | Age_>20 | Sex_gelding
    | Sex_stallion |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '|   | intr | 长度 | 周长 | BCS_1.5 | ... | 年龄_<2 | 年龄_>20 | 性别_阉割 | 性别_种马 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| **230** | 1 | 101 | 116 | 0 | ... | 0 | 0 | 0 | 1 |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| **230** | 1 | 101 | 116 | 0 | ... | 0 | 0 | 0 | 1 |'
- en: '| **74** | 1 | 92 | 117 | 0 | ... | 0 | 0 | 0 | 1 |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| **74** | 1 | 92 | 117 | 0 | ... | 0 | 0 | 0 | 1 |'
- en: '| **354** | 1 | 103 | 123 | 0 | ... | 0 | 1 | 0 | 0 |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| **354** | 1 | 103 | 123 | 0 | ... | 0 | 1 | 0 | 0 |'
- en: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... | ... |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| **...** | ... | ... | ... | ... | ... | ... | ... | ... | ... |'
- en: '| **157** | 1 | 93 | 123 | 0 | ... | 0 | 0 | 0 | 1 |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| **157** | 1 | 93 | 123 | 0 | ... | 0 | 0 | 0 | 1 |'
- en: '| **41** | 1 | 89 | 103 | 0 | ... | 1 | 0 | 0 | 0 |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| **41** | 1 | 89 | 103 | 0 | ... | 1 | 0 | 0 | 0 |'
- en: '| **381** | 1 | 86 | 106 | 0 | ... | 0 | 0 | 0 | 0 |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| **381** | 1 | 86 | 106 | 0 | ... | 0 | 0 | 0 | 0 |'
- en: '[PRE28]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: We dropped one dummy variable for each categorical feature. Since `BCS`, `Age`,
    and `Sex` have six, six, and three categories, respectively, we have added 12
    dummy variables to the design matrix for a total of 15 columns, including the
    intercept term, girth, and length.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个分类特征，我们删除了一个虚拟变量。由于`BCS`、`Age`和`Sex`分别有六、六和三个类别，因此我们为设计矩阵添加了12个虚拟变量，总计15列，包括截距项、周长和长度。
- en: 'Let’s see which categorical variables, if any, improve on our two-variable
    model. To do this, we can fit the model that includes the dummies from all three
    categorical features, along with girth and length:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看哪些分类变量，如果有的话，能够改进我们的双变量模型。为此，我们可以拟合包括所有三个分类特征的模型，以及周长和长度的模型：
- en: '[PRE29]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '[PRE30]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'According to average loss, this model does better than the previous model with
    only `Girth` and `Length`. But let’s try to make this model simpler while keeping
    its accuracy. To do this, we look at the coefficients for each of the dummy variables
    to see how close they are to 0 and to one another. In other words, we want to
    see how much the intercept might change if we include the coefficients in the
    model. A plot of the coefficients will make this comparison easy:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 根据平均损失，这个模型比只包括`周长`和`长度`的先前模型表现更好。但是让我们试着简化这个模型，同时保持其准确性。为此，我们查看每个虚拟变量的系数，看看它们是否接近0，以及彼此之间的情况。换句话说，我们想看到如果将系数包括在模型中会如何改变截距。系数的图表可以轻松地进行比较：
- en: '![](assets/leds_18in09.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in09.png)'
- en: The coefficients confirm what we saw in the box plots. The coefficients for
    the sex of the donkey are close to zero, meaning that knowing the sex doesn’t
    really change the weight prediction. We also see that combining the age categories
    for donkeys over 5 years will simplify the model without losing much. Lastly,
    since there are so few donkeys with a body condition score of 1.5 and its coefficient
    is close to that of a BCS of 2, we are inclined to combine these two categories.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 系数证实了我们在箱线图中看到的情况。驴子性别的系数接近零，这意味着知道性别并不真正改变体重预测。我们还看到，将超过5岁的驴子的年龄类别合并起来将简化模型而不会损失太多。最后，由于体况评分为1.5的驴子数量很少，其系数接近2的体况评分，我们倾向于将这两个类别合并。
- en: 'We update the design matrix in view of these findings:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于这些发现，我们更新设计矩阵：
- en: '[PRE31]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'And then we fit the simpler model:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们拟合更简单的模型：
- en: '[PRE32]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[PRE33]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The average error is close enough to that of the more complex model for us
    to settle on this simpler one. Let’s display the coefficients and summarize the
    model:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 平均误差与更复杂的模型接近，因此我们决定采用这个更简单的模型。让我们显示系数并总结模型：
- en: '|   | var | theta_hat |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '|   | var | theta_hat |'
- en: '| --- | --- | --- |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| **0** | intr | -175.25 |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| **0** | intr | -175.25 |'
- en: '| **1** | Length | 1.01 |'
  id: totrans-188
  prefs: []
  type: TYPE_TB
  zh: '| **1** | 长度 | 1.01 |'
- en: '| **2** | Girth | 1.97 |'
  id: totrans-189
  prefs: []
  type: TYPE_TB
  zh: '| **2** | 腹围 | 1.97 |'
- en: '| **3** | BCS_2.0 | -6.33 |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| **3** | BCS_2.0 | -6.33 |'
- en: '| **4** | BCS_2.5 | -5.11 |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| **4** | BCS_2.5 | -5.11 |'
- en: '| **5** | BCS_3.5 | 7.36 |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| **5** | BCS_3.5 | 7.36 |'
- en: '| **6** | BCS_4.0 | 20.05 |'
  id: totrans-193
  prefs: []
  type: TYPE_TB
  zh: '| **6** | BCS_4.0 | 20.05 |'
- en: '| **7** | Age_2-5 | -3.47 |'
  id: totrans-194
  prefs: []
  type: TYPE_TB
  zh: '| **7** | 年龄_2-5 | -3.47 |'
- en: '| **8** | Age_<2 | -6.49 |'
  id: totrans-195
  prefs: []
  type: TYPE_TB
  zh: '| **8** | 年龄_<2 | -6.49 |'
- en: 'Our model is roughly:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的模型大致是：
- en: <math display="block"><mtext>Weight</mtext> <mo>≈</mo> <mo>−</mo> <mn>175</mn>
    <mo>+</mo> <mtext>Length</mtext> <mo>+</mo> <mn>2</mn> <mtext>Girth</mtext></math>
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mtext>Weight</mtext> <mo>≈</mo> <mo>−</mo> <mn>175</mn>
    <mo>+</mo> <mtext>Length</mtext> <mo>+</mo> <mn>2</mn> <mtext>Girth</mtext></math>
- en: 'After this initial approximation, we use the categorical features to make some
    adjustments:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个初步的近似之后，我们使用分类特征进行一些调整：
- en: BCS 2 or less? Subtract 6.5 kg.
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: BCS 2或更低？减去6.5公斤。
- en: BCS 2.5? Subtract 5.1 kg.
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: BCS 2.5？减去5.1公斤。
- en: BCS 3.5? Add 7.4 kg.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: BCS 3.5？增加7.4公斤。
- en: BCS 4? Add 20 kg.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: BCS 4？增加20公斤。
- en: Age under 2 years? Subtract 6.5 kg.
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 年龄小于2岁？减去6.5公斤。
- en: Age between 2 and 5 years? Subtract 3.5 kg.
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 年龄在2到5岁之间？减去3.5公斤。
- en: This model seems quite simple to implement because after our initial estimate
    based on the length and girth of the donkey, we add or subtract a few numbers
    based on answers to a few yes/no questions. Let’s see how well the model does
    in predicting the weights of the donkeys in the test set.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 这个模型似乎相当简单易行，因为在我们根据驴子的长度和腹围进行初始估计之后，我们根据几个是/否问题的答案添加或减少一些数字。让我们看看这个模型在预测测试集中驴子的体重方面表现如何。
- en: Model Assessment
  id: totrans-206
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 模型评估
- en: 'Remember that we put aside 20% of our data before exploring and modeling with
    the remaining 80%. We are now ready to apply what we have learned from the training
    set to the test set. That is, we take our fitted model and use it to predict the
    weights of the donkeys in the test set. To do this, we need to prepare the test
    set. Our model uses the girth and length of the donkey, as well as dummy variables
    for the donkey’s age and body condition score. We apply all of our transformations
    on the train set to our test set:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，在探索和建模剩余的80%数据之前，我们将20%的数据搁置。现在，我们已经准备好将我们从训练集中学到的应用到测试集中。也就是说，我们拿出我们拟合的模型，并用它来预测测试集中驴子的体重。为此，我们需要准备测试集。我们的模型使用驴子的腹围和长度，以及驴子年龄和体况评分的虚拟变量。我们将我们在训练集上的所有转换应用到我们的测试集上：
- en: '[PRE34]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'We consolidate all of our manipulations of the design matrix to create the
    final version that we settled on in our modeling with the train set. Now we are
    ready to use the <math><mi>θ</mi></math> s that we fitted with the train set to
    make weight predictions for those donkeys in the test set:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将我们对设计矩阵的所有操作汇总到我们在训练集建模中确定的最终版本中。现在我们准备使用我们在训练集上拟合的<math><mi>θ</mi></math>来为测试集中的那些驴子进行体重预测：
- en: '[PRE35]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Then we can plot the relative prediction errors:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们可以绘制相对预测误差：
- en: '![](assets/leds_18in10.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in10.png)'
- en: Remember that positive relative error means underestimating weight, which is
    not as critical as overestimating weight. From this residual plot, we see that
    nearly all of the test set weights are within 10% of the predictions, and only
    one error that exceeds 10% errs on the side of overestimation. This makes sense
    given that our loss function penalized overestimation more.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，正的相对误差意味着低估重量，这并不像高估重量那样严重。从这个残差图中，我们看到几乎所有的测试集重量都在预测的10%之内，只有一个超过10%的误差是在高估的一侧。鉴于我们的损失函数更严厉地惩罚了高估，这是合理的。
- en: 'An alternative scatterplot that shows the actual and predicted values along
    with lines marking 10% error gives a different view:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种散点图显示了实际值和预测值，同时标出了10%误差线，提供了不同的视角：
- en: '![](assets/leds_18in11.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/leds_18in11.png)'
- en: The 10% lines lie farther from the prediction line for larger weights.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 对于较大重量的预测线，10%的误差线距离预测线更远。
- en: We’ve accomplished our goal! We have a model that uses easy-to-get measurements,
    is simple enough to explain on an instruction sheet, and makes predictions within
    10% of the actual donkey weight. Next, we summarize this case study and reflect
    on our model.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经实现了我们的目标！我们有一个使用易于获取的测量数据的模型，简单到可以在说明书上解释，并且可以在实际驴重量的预测中保持在10%范围内。接下来，我们总结这个案例研究并反思我们的模型。
- en: Summary
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: 'In this case study, we demonstrated the different purposes of modeling: description,
    inference, and prediction. For description, we sought a simple, understandable
    model. We handcrafted this model, beginning with our findings from the exploratory
    phase of the analysis. Every action we took to include a feature in the model,
    collapse categories, or transform a feature amounts to a decision we made while
    investigating the data.'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个案例研究中，我们展示了建模的不同目的：描述、推理和预测。对于描述，我们寻求一个简单易懂的模型。我们手工制作了这个模型，从分析探索阶段的发现开始。我们每采取一项行动来包含一个特征在模型中，折叠类别或转换特征，都是我们在调查数据时做出的决策。
- en: 'In modeling a natural phenomenon such as the weight of a donkey, we would ideally
    make use of physical and statistical models. In this case, the physical model
    is the representation of a donkey by a cylinder. An inquisitive reader might have
    pointed out that we could have used this representation directly to estimate the
    weight of a donkey (cylinder) from its length and girth (since girth is <math><mn>2</mn>
    <mi>π</mi> <mi>r</mi></math> ):'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在对象模拟自然现象如驴的重量时，我们理想地会使用物理模型和统计模型。在这种情况下，物理模型是用圆柱体表示驴的形象。一个好奇的读者可能会指出，我们可以直接使用这个表示来估算驴（圆柱体）的重量，通过其长度和围长（因为围长是
    <math><mn>2</mn> <mi>π</mi> <mi>r</mi></math> ）：
- en: <math display="block"><mi>w</mi> <mi>e</mi> <mi>i</mi> <mi>g</mi> <mi>h</mi>
    <mi>t</mi> <mo>∝</mo> <mi>g</mi> <mi>i</mi> <mi>r</mi> <mi>t</mi> <msup><mi>h</mi>
    <mn>2</mn></msup> <mo>×</mo> <mi>l</mi> <mi>e</mi> <mi>n</mi> <mi>g</mi> <mi>t</mi>
    <mi>h</mi></math>
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mi>w</mi> <mi>e</mi> <mi>i</mi> <mi>g</mi> <mi>h</mi>
    <mi>t</mi> <mo>∝</mo> <mi>g</mi> <mi>i</mi> <mi>r</mi> <mi>t</mi> <msup><mi>h</mi>
    <mn>2</mn></msup> <mo>×</mo> <mi>l</mi> <mi>e</mi> <mi>n</mi> <mi>g</mi> <mi>t</mi>
    <mi>h</mi></math>
- en: 'This physical model suggests that the log-transformed weight is approximately
    linear in girth and length:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 这个物理模型表明，对数转换的重量大致上是围长和长度的线性函数：
- en: <math display="block"><mi>log</mi> <mo>⁡</mo> <mo stretchy="false">(</mo> <mi>w</mi>
    <mi>e</mi> <mi>i</mi> <mi>g</mi> <mi>h</mi> <mi>t</mi> <mo stretchy="false">)</mo>
    <mo>∝</mo> <mn>2</mn> <mi>log</mi> <mo>⁡</mo> <mo stretchy="false">(</mo> <mi>g</mi>
    <mi>i</mi> <mi>r</mi> <mi>t</mi> <mi>h</mi> <mo stretchy="false">)</mo> <mo>+</mo>
    <mi>log</mi> <mo>⁡</mo> <mo stretchy="false">(</mo> <mi>l</mi> <mi>e</mi> <mi>n</mi>
    <mi>g</mi> <mi>t</mi> <mi>h</mi> <mo stretchy="false">)</mo></math>
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mi>log</mi> <mo>⁡</mo> <mo stretchy="false">(</mo> <mi>w</mi>
    <mi>e</mi> <mi>i</mi> <mi>g</mi> <mi>h</mi> <mi>t</mi> <mo stretchy="false">)</mo>
    <mo>∝</mo> <mn>2</mn> <mi>log</mi> <mo>⁡</mo> <mo stretchy="false">(</mo> <mi>g</mi>
    <mi>i</mi> <mi>r</mi> <mi>t</mi> <mi>h</mi> <mo stretchy="false">)</mo> <mo>+</mo>
    <mi>log</mi> <mo>⁡</mo> <mo stretchy="false">(</mo> <mi>l</mi> <mi>e</mi> <mi>n</mi>
    <mi>g</mi> <mi>t</mi> <mi>h</mi> <mo stretchy="false">)</mo></math>
- en: Given this physical model, you might wonder why we did not use logarithmic or
    square transformations in fitting our model. We leave you to investigate such
    a model in greater detail. But generally, if the range of values measured is small,
    then the log function is roughly linear. To keep our model simple, we chose not
    to make these transformations given the strength of the statistical model seen
    by the high correlation between girth and weight.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 鉴于这个物理模型，您可能会想知道为什么我们没有在拟合模型时使用对数或平方变换。我们留给您去更详细地探讨这样的模型。但总的来说，如果测量值的范围较小，那么对数函数大致上是线性的。为了保持我们的模型简单，鉴于围长和重量之间的高相关性，我们选择不进行这些转换。
- en: We did a lot of *data dredging* in this modeling exercise. We examined all possible
    models built from linear combinations of the numeric features, and we examined
    coefficients of dummy variables to decide whether to collapse categories. When
    we create models using an iterative approach like this, it is extremely important
    that we set aside data to assess the model. Evaluating the model on new data reassures
    us that the model we chose works well. The data that we set aside did not enter
    into any decision making when building the model, so it gives us a good sense
    of how well the model works for making predictions.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个建模过程中，我们进行了大量的*数据挖掘*。我们检查了所有可能的模型，这些模型由数值特征的线性组合构建，并检查了虚拟变量的系数，以决定是否合并类别。当我们使用这种迭代方法创建模型时，非常重要的是我们留出数据来评估模型。在新数据上评估模型可以让我们放心地知道我们选择的模型效果如何。我们留出的数据在建模时没有参与任何决策，因此它能很好地帮助我们了解模型在预测上的表现。
- en: We should keep the data scope and its potential biases described earlier in
    mind. Our model has done well on the test set, but the test and train sets come
    from the same data collection process. We expect our model to work well in practice
    as long as the scope remains the same for new data.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该记住之前描述的数据范围及其潜在偏见。我们的模型在测试集上表现良好，但测试集和训练集来自同一数据收集过程。只要新数据的范围保持不变，我们期望我们的模型在实践中表现良好。
- en: Finally, this case study shows how fitting models is often a balance between
    simplicity and complexity and between physical and statistical models. A physical
    model can be a good starting point in modeling, and a statistical model can inform
    a physical model. As data scientists, we needed to make judgment calls at each
    step in the analysis. Modeling is both an art and a science.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，这个案例研究展示了模型拟合通常是在简单与复杂之间、物理与统计模型之间取得平衡的过程。物理模型可以作为建模的良好起点，而统计模型则可以为物理模型提供信息。作为数据科学家，我们需要在分析的每一步都做出判断。建模既是艺术又是科学。
- en: This case study and several chapters preceding it have focused on fitting linear
    models. Next, we consider a different kind of modeling for the situation when
    the response variable we are explaining or predicting is qualitative, not quantitative.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 本案例研究及其前面几章集中讨论了拟合线性模型的问题。接下来，我们考虑一种不同类型的建模方法，用于解释或预测的响应变量是定性而非定量的情况。
