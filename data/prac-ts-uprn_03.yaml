- en: Chapter 3\. Exploratory Data Analysis for Time Series
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第三章。时间序列的探索性数据分析
- en: We will break down our discussion of exploratory data analysis for time series
    into two distinct sections. First, we discuss the application of commonly used
    data methods on time series. In particular, we discuss how histograms, plotting,
    and group-by operations can be applied to time series data.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将把我们对时间序列探索性数据分析的讨论分解为两个不同的部分。首先，我们讨论如何在时间序列上应用常用的数据方法。特别是，我们讨论如何将直方图、绘图和分组操作应用于时间序列数据。
- en: Second, we highlight fundamentally temporal methods for time series analysis—that
    is, methods developed specifically for time series data and that make sense only
    in the context of data points that have a temporal relationship with one another
    (rather than a cross-sectional one).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，我们强调用于时间序列分析的基本时间方法——即专门针对时间序列数据开发的方法，只在具有时间关系的数据点之间的上下文中才有意义（而不是横截面的）。
- en: Familiar Methods
  id: totrans-3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 熟悉的方法
- en: We begin by thinking about how to apply commonly used data exploration techniques
    to time series data sets. The process is the same as what you have performed on
    non-time-series data to start with.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先考虑如何将常用的数据探索技术应用于时间序列数据集。这个过程与您在非时间序列数据上执行的过程相同。
- en: 'You will want to know the columns that are available, their value ranges, and
    what logical units of measurement work best. You will want to address the same
    exploratory questions you would ask about any new data set, such as:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要了解可用的列、它们的值范围以及哪些逻辑单位的测量效果最佳。您需要解答与任何新数据集相关的探索性问题，比如：
- en: Are any of the columns strongly correlated with one another?
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列之间是否存在强相关性？
- en: What is the overall mean of an interesting variable? What is its variance?
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您感兴趣的变量的整体平均值是多少？它的方差是多少？
- en: 'To answer these, you can use familiar techniques such as plotting, taking summary
    statistics, applying histograms, and using targeted scatter plots. You’ll also
    want to answer explicitly time-oriented questions such as:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 要回答这些问题，您可以使用熟悉的技术，如绘图、汇总统计、应用直方图和使用有针对性的散点图。您还需要明确回答与时间相关的问题，比如：
- en: What is the range of values you see, and do they vary by time period or some
    other logical unit of analysis?
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您看到的值的范围是多少，它们是否按时间段或其他逻辑单位变化？
- en: Does the data look consistent and uniformly measured, or does it suggest changes
    in either measurement or behavior over time?
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据看起来是否一致且均匀测量，或者是否暗示随时间的变化或行为变化？
- en: To address these, you will want the previously mentioned methods—histograms,
    scatter plots, and summary statistics—to take into account the temporal axis.
    To implement this behavior, we will incorporate time into our statistics, as an
    axis in our graphs or as a group in group-by operations, such as those applied
    to histograms or scatter plots.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 要解决这些问题，您需要之前提到的方法——直方图、散点图和汇总统计——以考虑时间轴。为了实现这种行为，我们将时间纳入到我们的统计中，作为图表中的轴或作为直方图或散点图中的分组操作中的一组。
- en: In the rest of this section, we will look at examples of exploratory data analysis
    with a few different kinds of time series data to explore how we can use traditional
    nontemporal methods directly or with time-specific modifications. To demonstrate
    these exploratory methods, we will use European stock markets data, a time series
    data set available in base R.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节的其余部分，我们将通过几种不同类型的时间序列数据的探索性数据分析示例来探讨如何直接使用传统的非时间序列方法或带有时间特定修改的方法。为了演示这些探索方法，我们将使用
    R 语言中提供的欧洲股票市场数据，这是一个时间序列数据集。
- en: Plotting
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 绘图
- en: 'Let’s explore a typical time series provided by R, the `EuStockMarkets` data
    set. To get a sense of it, we can look at the head of the data set:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们探索 R 提供的典型时间序列，`EuStockMarkets` 数据集。为了对其有所了解，我们可以查看数据集的开头：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This is a built-in data set in base R, and it contains the daily closing prices
    of four major European stock indexes from 1991 to 1998\. The data set only includes
    business days.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 R 语言中的内置数据集，包含了1991年至1998年期间四个主要欧洲股票指数的每日收盘价格。数据集仅包括工作日。
- en: This data set is better prepared than the ones we have looked at so far because
    it’s already nicely formatted and sampled for us. We don’t need to worry about
    missing values, time zones, or incorrect measurements, so we can jump right into
    exploratory data analysis.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这个数据集比我们迄今为止看过的更好准备，因为它已经很好地格式化并对我们进行了取样。我们不需要担心缺失值、时区或不正确的测量，因此我们可以直接进行探索性数据分析。
- en: Our first steps for looking at this data will be very similar to a non-time-based
    time series, although we have a simpler option with temporal data than we would
    with cross-sectional data. We can plot each value individually, and such a plot
    makes sense. Contrast this with cross-sectional data, where a plot of any individual
    feature against its index in the data set will only reveal, if anything, the order
    in which data was entered in a data table or returned from a SQL server (in other
    words, an arbitrary order), but nothing about the underlying situation. However,
    in the case of time series, plotting is quite informative, as you can see in [Figure 3-1](#fig-0301).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我们查看这些数据的第一步将与非基于时间的时间序列非常相似，尽管我们在时间数据中有一个比在横截面数据中更简单的选项。我们可以单独绘制每个值，这样的绘图是有意义的。与横截面数据相对比，那里任何个体特征与数据集中的索引的绘图将只显示数据输入或从SQL服务器返回的顺序（换句话说，是任意顺序），但没有显示底层情况。然而，在时间序列的情况下，绘图非常具有信息性，就像您在[图3-1](#fig-0301)中看到的那样。
- en: '[PRE1]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](assets/ptsa_0301.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0301.png)'
- en: Figure 3-1\. A simple plot of the time series data.
  id: totrans-21
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-1\. 时间序列数据的简单绘图。
- en: 'Notice that the image is automatically segmented into different time series
    with a simple `plot()` command. In fact, as shown here, we are using an R `mts`
    object (we would be using a `ts` object if there were only one time series, but
    we have several in parallel):'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，图像会通过简单的`plot()`命令自动分割成不同的时间序列。事实上，正如这里展示的，我们正在使用一个R中的`mts`对象（如果只有一个时间序列，我们将使用一个`ts`对象）：
- en: '[PRE2]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'A number of popular packages make heavy use of `ts` objects and derivative
    classes. These objects come with nice automatic calls to appropriate plotting
    functions, as we see in the previous example where a simple call to `plot()` created
    a nicely labeled, multipanel plot. `ts` objects also have a few convenience functions:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 许多流行的包大量使用`ts`对象和其衍生类。这些对象配备了适当绘图函数的自动调用，正如我们在前面的例子中看到的，一个简单的`plot()`调用创建了一个标记齐全的多面板图。`ts`对象还有一些便利函数：
- en: '`frequency` for finding out the yearly frequency of the data:'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`frequency`用于查找数据的年度频率：'
- en: '[PRE3]'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '`start` and `end` to find the first and last time represented in the series:'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`start`和`end`用于找出系列中表示的第一个和最后一个时间：'
- en: '[PRE4]'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '`window` to take a temporal section of the data:'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`window`用于获取数据的时间段：'
- en: '[PRE5]'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: There are pluses and minuses to the `ts` class. As mentioned earlier, `ts` and
    its derivative classes are used in many time series packages. Also, automatic
    setup of plotting parameters can be helpful. However, indexing can sometimes be
    tricky, and the process of accessing subsections of data with `window` can feel
    cumbersome over time. In this book, you will see several ways of containing and
    accessing time series data, and it will be up to you to choose the most convenient
    for your use cases.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: '`ts`类有其优缺点。如前所述，`ts`及其衍生类在许多时间序列包中被广泛使用。此外，自动设置绘图参数可能会有所帮助。然而，索引有时可能会比较棘手，并且使用`window`访问数据的子段随着时间推移可能会感到不便。在本书中，您将看到多种包含和访问时间序列数据的方法，您可以根据自己的使用情况选择最方便的方式。'
- en: Histograms
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 直方图
- en: 'Let’s continue our comparison of exploratory data analysis in time series and
    non-time-series data. We’d like to, for example, take a histogram of the data,
    just as with most exploratory data analysis. We add a wrinkle by also taking a
    histogram of the differenced data because we want to use our time axis (see [Figure 3-2](#fig-0302)):'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们继续比较时间序列和非时间序列数据的探索性数据分析。例如，我们想要对数据进行直方图分析，就像大多数探索性数据分析一样。我们通过对差分数据进行直方图分析，引入了一个新的问题，因为我们想要使用我们的时间轴（参见[图3-2](#fig-0302)）：
- en: '[PRE6]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](assets/ptsa_0302.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0302.png)'
- en: Figure 3-2\. The histogram of the untransformed data (top) is extremely wide
    and does not show a normal distribution. This is to be expected given that the
    underlying data has a trend. We difference the data to remove the trend, and this
    transforms the data to a more normally shaped distribution (bottom).
  id: totrans-36
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-2\. 未转换数据的直方图（顶部）极其宽阔，不显示正态分布。考虑到底层数据存在趋势，这是可以预料的。我们对数据进行差分以消除趋势，这将使数据转变为更接近正态分布的形式（底部）。
- en: In a time series context, a `hist()` of the difference of the data is often
    more interesting than a `hist()` of the untransformed data. After all, in a time
    series context, often (and particularly in finance) what is most interesting is
    how a value changes from one measurement to the next rather than the value’s actual
    measurement. This is particularly true for plotting, because taking the histogram
    of data with a trend in it does not produce a very informative visualization.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在时间序列的背景下，数据差的`hist()`通常比未转换数据的`hist()`更有趣。毕竟，在时间序列的背景下，通常（特别是在金融领域）最有趣的是一个值如何从一次测量到下一次测量的变化，而不是这个值的实际测量。这在绘图中尤为明显，因为对具有趋势的数据进行直方图统计不会产生非常信息丰富的可视化效果。
- en: Notice the new information we get from the histogram of the differenced series.
    While the original plots of the stocks in the previous section painted a very
    rosy economic picture with stocks inexorably rising, this histogram shows us the
    day-to-day experience of someone following the stocks. The histogram of the difference
    tells us that the value of the time series has gone both up (positive difference
    values) and down (negative difference values) about the same amount over time.
    The stock indexes did not go up and down exactly the same amount over time, because
    we know the stock indexes do have an increasing trend. However, we can see from
    this histogram that just a slight bias in favor of positive over negative differences
    is what accounts for that trend.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 注意我们从差分系列的直方图中获得的新信息。虽然前一节中股票的原始图表描绘了股票不断上涨的非常乐观的经济图景，但这个直方图向我们展示了跟随股票的日常体验。差分的直方图告诉我们，时间序列的值随时间既上升（正差分值），又下降（负差分值），而且大致相同。股票指数并没有随时间完全同样的上升和下降，因为我们知道股票指数确实有一个增长趋势。然而，从这个直方图中我们可以看到，稍微偏向正差分而不是负差分正是导致这种趋势的原因。
- en: 'This is a good first example of why we need to pay attention to temporal scale
    when sampling, summarizing, and asking questions of data. Whether performance
    looks great (long-term plot) or just so-so (histogram of difference plots) will
    depend on what our temporal scale is: do we care about the day-to-day, or do we
    have a longer-term horizon? If we work in an organization that trades stock to
    make an annual profit, we need to think about the short-term experience we will
    have every time we report to our bosses a “diff” that leans toward negative values.
    However, if we are a large institutional investor—perhaps a university or a hospital—we
    may be able to afford to take the long view, which expects an upward climb. This
    latter scenario has its own challenges: how do we take long enough to maximize
    our profit but not so long that the party is over? These are the questions that
    keep the financial industry humming along with time series research and predictions.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 这是为什么我们在抽样、总结和问数据问题时需要关注时间尺度的一个很好的例子。无论是表现看起来很好（长期图）还是一般般（差分图的直方图），都取决于我们的时间尺度：我们关心日常吗，还是我们有更长期的视角？如果我们在一个以年度盈利为目标的机构工作，我们需要考虑每次向上司报告倾向于负值的“差分”的短期经历。然而，如果我们是一个大型机构投资者——也许是大学或医院——我们可能负担得起采取长期视角，预期上升。后一种情况也有其挑战：我们如何花足够长的时间来最大化利润，但不至于失去机会？这些问题使得金融行业与时间序列研究和预测息息相关。
- en: Scatter Plots
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 散点图
- en: The traditional method of using scatter plots is just as useful for time series
    data as it is for other kinds of data. We can use scatter plots to determine both
    how two stocks are linked at a specific time and how their price shifts are related
    over time.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 使用散点图的传统方法对时间序列数据与其他类型的数据同样有用。我们可以使用散点图来确定两只股票在特定时间点的联系以及它们的价格变动如何随时间相关。
- en: 'In this example, we plot both cases (see [Figure 3-3](#fig-0303)):'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们绘制了两种情况（见[图3-3](#fig-0303)）：
- en: The values of two different stocks over time
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 两只不同股票随时间变化的值
- en: The values of the daily changes in these two stocks over time (via differencing)
    with R’s `diff()` function
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这两只股票每日变化的值随时间变化（通过R的`diff()`函数进行差分）
- en: '[PRE7]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](assets/ptsa_0303.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0303.png)'
- en: Figure 3-3\. Simple scatter plots of two stock indexes suggest strong correlations.
    However, there are reasons to view these plots with suspicion.
  id: totrans-47
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-3\. 两个股票指数的简单散点图显示了强烈的相关性。然而，我们有理由对这些图表持怀疑态度。
- en: As we’ve already seen, the actual values are less informative than the differences
    between adjacent time points, so we have plotted the diffs in a second scatter
    plot. These look like very strong correlations, but the relationships are not
    as strong as they appear. (To delve deeper, skip ahead to [“Spurious Correlations”](#spurious-correlations).)
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们已经看到的，实际值比相邻时间点之间的差异信息更少，因此我们在第二个散点图中绘制了这些差异。这些看起来像是非常强的相关性，但实际关系并不像它们看起来那么强。（要深入了解，请跳到 “伪相关性” 一节。）
- en: 'The apparent correlations in [Figure 3-3](#fig-0303) are interesting, but even
    if they are true correlations (and there is reason to doubt they are), these are
    not correlations we can monetize as stock traders. By the time we know whether
    a stock is going up or down, the stocks it is correlated with will have also gone
    up or down, since we are taking correlations of values at identical time points.
    What we need to do is find out whether the change in one stock earlier in time
    can predict the change in another stock later in time. To do this, we shift one
    of the differences of the stocks back by 1 before looking at the scatter plot.
    Read the following code carefully; notice that we are still differencing, but
    now we are also applying a lag to one of the differenced time series (see [Figure 3-4](#fig-0304)):'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图 [3-3](#fig-0303) 中的明显相关性很有趣，但即使它们是真实的相关性（但有理由怀疑它们是否是），这些也不是我们作为股票交易员可以货币化的相关性。当我们知道一只股票是涨还是跌时，与之相关的股票也已经涨或跌，因为我们是在相同时间点的值之间进行相关性分析。我们需要做的是找出一只股票之前的变化是否能预测另一只股票之后的变化。为此，在查看散点图之前，我们将一个股票的差异向后移动1步。仔细阅读以下代码；请注意，我们仍在进行差异化处理，但现在我们还在一个差分时间序列上应用了滞后（参见 图 [3-4](#fig-0304)）：
- en: '[PRE8]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Tip
  id: totrans-51
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: The lines in these code examples are easy to read because each section is aligned.
    It can be tempting to write long lines of unreadable code, particularly in a functional
    programming language such as R or Python, but you should avoid this whenever possible!
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 这些代码示例中的代码行易于阅读，因为每个部分都是对齐的。在编写长行的难以阅读的代码时，特别是在像R或Python这样的函数式编程语言中，这可能是诱人的，但尽量避免！
- en: '![](assets/ptsa_0304.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0304.png)'
- en: Figure 3-4\. The correlation between the stocks disappears as soon as we put
    in a time lag, indicating that SMI does not appear to predict DAX.
  id: totrans-54
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-4。在引入时间滞后后，股票之间的相关性消失了，这表明 SMI 似乎不能预测 DAX。
- en: 'This result tells us a number of important things:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这个结果告诉我们一些重要的事情：
- en: With time series data, while we may use the same exploratory techniques as with
    non-time-series data, mindless application won’t work. We need to think about
    how to exploit the same techniques but with reshaped data.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于时间序列数据，虽然我们可能会使用与非时间序列数据相同的探索技术，但盲目应用是行不通的。我们需要考虑如何利用相同的技术，但应用在重塑后的数据上。
- en: Oftentimes it’s the relationship between data at different points or the change
    over time that is most informative about how your data behaves.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 往往是不同时间点数据之间的关系或随时间变化的变化最能说明你的数据行为方式。
- en: The plot in [Figure 3-4](#fig-0304) shows why it can be difficult to be a stock
    trader. If you are a passive investor and wait it out, you might benefit from
    the long-term rising trend. However, if you are trying to make predictions about
    the future, you can see that it’s not easy!
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图 [3-4](#fig-0304) 显示了为什么成为股票交易员可能会很困难。如果你是一名被动投资者并且耐心等待，你可能会从长期上升的趋势中受益。然而，如果你试图预测未来，你会发现这并不容易！
- en: Warning
  id: totrans-59
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: R’s `lag()` function may not move data in the temporal direction you expect.
    The `lag()` function is a forward time shift. This is important to remember, as
    you wouldn’t want to move data in the wrong temporal direction given a specific
    use case, and both forward and backward shifts in time are reasonable for different
    use cases.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: R 的 `lag()` 函数可能不会按照你预期的时间方向移动数据。 `lag()` 函数是向前的时间移动。记住这一点很重要，因为在特定用例中，你不会希望将数据移动到错误的时间方向，不同的用例可能需要前向和后向的时间移动。
- en: Time Series–Specific Exploratory Methods
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时间序列特定的探索方法
- en: Several methods of analyzing time series data focus on relations of values at
    different times in the same series, and you likely won’t have seen these before
    if you haven’t worked with time series data. In the rest of this chapter, we walk
    through a few concepts and related techniques used to classify time series.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 分析时间序列数据的几种方法侧重于同一系列不同时间点的值之间的关系，如果你之前没有处理过时间序列数据，你可能以前没见过这些。在本章的其余部分，我们将介绍一些用于分类时间序列的概念和相关技术。
- en: 'The concepts we will explore are:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将探讨的概念包括：
- en: Stationarity
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 稳定性
- en: What it means for a time series to be stationary and a statistical test for
    stationarity
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列平稳的含义及其统计检验
- en: Self-correlation
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 自相关
- en: What it means to say that a time series correlates with itself and what such
    a correlation indicates about the underlying dynamics of the time series
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 说一个时间序列与自身相关意味着什么，以及这样的相关性对时间序列底层动态的指示
- en: Spurious correlations
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 虚假相关性
- en: What it means for a correlation to be spurious and when you should expect to
    run into spurious correlations
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 一个相关性是虚假的意味着什么，以及你应该预期何时会遇到虚假相关性
- en: 'The methods we will learn to apply are:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将学习应用的方法包括：
- en: Rolling and expanding window functions
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 滚动和扩展窗口函数
- en: Self-correlation functions
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自相关函数
- en: The autocorrelation function
  id: totrans-73
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自相关函数
- en: The partial autocorrelation function
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 偏自相关函数
- en: We will cover the concepts and their resulting methods in order from stationarity
    to self-correlations to spurious correlations. Before we dive into the specifics,
    let’s discuss the logic behind this particular ordering.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将按照从稳定性到自相关再到虚假相关性的顺序涵盖这些概念及其相应的方法。在我们深入具体内容之前，让我们讨论一下这种特定顺序背后的逻辑。
- en: The first question you will likely ask about a time series is whether it appears
    to reflect a system that is “stable” or one that is constantly changing. The level
    of stability, or *stationarity*, is important to assess because we need to know
    how much we should expect the system’s long-term past behavior to reflect its
    long-term future behavior. Once we have assessed the “stability” (this word is
    not used in a technical sense here) of a time series, we try to determine whether
    there are internal dynamics in that series (seasonal changes, for example). That
    is, we are looking for *self-correlations*, answering the fundamental question
    of how tightly past data, distant or recent, predicts future data. Finally, when
    we think we have found certain behavioral dynamics within the system, we need
    to make sure we are not identifying relationships based on dynamics that do not
    in any way imply the causal relationships we wish to discover; hence, we must
    look for *spurious correlations*.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会首先询问关于时间序列的一个问题，即它是否表现出反映一个“稳定”的系统还是一个不断变化的系统。稳定性的水平，或*平稳性*，是评估重要的，因为我们需要知道系统的长期过去行为如何反映其长期未来行为。一旦我们评估了时间序列的“稳定性”（这里并非以技术意义使用此词），我们试图确定是否存在该序列的内部动态（例如季节性变化）。也就是说，我们在寻找*自相关*，回答如何预测未来数据的基本问题，无论是远距离还是近距离的过去数据。最后，当我们认为已经找到了系统内部的某些行为动态时，我们需要确保我们不是基于根本不暗示我们希望发现的因果关系的动态来识别关系；因此，我们必须寻找*虚假相关性*。
- en: Understanding Stationarity
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解稳定性
- en: Many traditional statistical time series models rely on a time series being
    stationary. Generally speaking, a stationary time series is one that has fairly
    stable statistical properties over time, particularly with respect to mean and
    variance. This seems relatively straightforward.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 许多传统的统计时间序列模型依赖于时间序列的平稳性。一般来说，一个平稳的时间序列是指其统计性质随时间变化相对稳定，特别是在均值和方差方面。这看起来相对直观。
- en: Nonetheless, stationarity can be a slippery concept, particularly when applied
    to real time series data. It is both too intuitive and too easy to fool yourself
    into relying on your natural intuition. We will walk through the concept both
    intuitively and with a somewhat formal definition before discussing a common test
    for stationarity and practical details for how to apply the concept.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，稳定性可能是一个棘手的概念，特别是在应用于实时序列数据时。这既太直觉了，也太容易让你依赖自己的直觉。在讨论稳定性的一般测试和如何应用这一概念的实际细节之前，我们将直观地和带有一定正式定义地讨论这个概念。
- en: Intuition
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 直觉
- en: A stationary time series is one in which a time series measurement reflects
    a system in a steady state. Sometimes it is difficult to assert what exactly this
    means, and it can be easier to rule things out as *not* being stationary rather
    than saying something *is* stationary. An easy example of data that is not stationary
    is the airline passengers data set we examined in [Chapter 2](ch02.html#finding_and_wrangling_time_series_data),
    which is plotted in [Figure 3-5](#fig-0305) (as a reminder, it is available in
    R as `AirPassengers` and also widely available for download on the internet).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 静止时间序列是指时间序列测量反映系统处于稳定状态。有时很难确定这究竟意味着什么，可以更容易地排除*不*是静止的东西，而不是说某些东西*是*静止的。一个明显的非静止数据的例子是我们在[第2章](ch02.html#finding_and_wrangling_time_series_data)中检查的航空乘客数据集，如[图3-5](#fig-0305)中所示（提醒一下，在R中可以作为`AirPassengers`使用，并且广泛可供下载）。
- en: There are several traits that show this process is not stationary. First, the
    mean value is increasing over time, rather than remaining steady. Second, the
    distance between peak and trough on a yearly basis is growing, so the variance
    of the process is increasing over time. Third, the process displays strong seasonal
    behavior, the antithesis of stationarity.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个特征显示这个过程并不是静止的。首先，均值随时间增长而不是保持稳定。其次，每年的高峰和低谷之间的距离增大，因此过程的方差随时间增加。第三，该过程显示出强烈的季节性行为，与静止相反。
- en: '![](assets/ptsa_0305.png)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0305.png)'
- en: Figure 3-5\. The airline passengers data set offers a clear example of a time
    series that is not stationary. As time passes, both the mean and the variance
    of the data are changing. We also see evidence of seasonality, which intrinsically
    reflects a nonstationary process.
  id: totrans-84
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-5\. 航空乘客数据集是一个明显的非静止时间序列的典型示例。随着时间的推移，数据的均值和方差都在变化。我们还看到了季节性的证据，这本质上反映了一个非静止的过程。
- en: Stationary definition and the Augmented Dickey–Fuller test
  id: totrans-85
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 静止性定义和增广迪基-富勒检验
- en: 'A simple definition of a stationary process is the following: a process is
    stationary if for all possible lags, *k*, the distribution of *y[t]*, *y[t+1]*,...,
    *y[t+k]*, does not depend on t.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 一个静止过程的简单定义如下：如果对于所有可能的滞后*k*，*y[t]*，*y[t+1]*，...，*y[t+k]*的分布不依赖于*t*，则过程是静止的。
- en: Statistical tests for stationarity often come down to the question of whether
    there is a unit root—that is, whether 1 is a solution of the process’s characteristic
    equation.^([1](ch03.html#idm45576047241848)) A linear time series is nonstationary
    if there is a unit root, although lack of a unit root does not prove stationarity.
    Addressing stationarity as a general question remains tricky, and determining
    whether a process has a unit root remains a current area of research.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 针对静止性的统计检验通常归结为一个问题：过程的特征方程是否存在单位根——即1是否是过程特征方程的解。[^1] 如果存在单位根，则线性时间序列是非静止的，尽管缺乏单位根并不证明静止性。解决静止性作为一个一般性问题仍然棘手，确定一个过程是否具有单位根仍然是当前的研究领域。
- en: 'Nonetheless, a simple intuition for what a unit root is can be gleaned from
    the example of a random walk:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管如此，从随机游走的例子中可以得出单位根的简单直觉：
- en: <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>y</mi> <mi>t</mi></msub>
    <mo>=</mo> <mi>ϕ</mi> <mo>×</mo> <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub>
    <mo>+</mo> <msub><mi>e</mi> <mi>t</mi></msub></mrow></math>
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>y</mi> <mi>t</mi></msub>
    <mo>=</mo> <mi>ϕ</mi> <mo>×</mo> <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub>
    <mo>+</mo> <msub><mi>e</mi> <mi>t</mi></msub></mrow></math>
- en: In this process, the value of a time series at a given time is a function of
    its value at the immediately preceding time and some random error. If *ϕ* is equal
    to 1, the series has a unit root, will “run away,” and will not be stationary.
    Interesting to note is that the series not being stationary does not mean it has
    to have a trend. A random walk is a good example of a nonstationary time series
    that does not have an underlying trend.^([2](ch03.html#idm45576047229944))
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个过程中，给定时间点上的时间序列值是其前一个时间点值和一些随机误差的函数。如果*ϕ*等于1，该序列具有单位根，将“逃跑”，并且不会是静止的。有趣的是，序列不是静止的并不意味着它必须具有趋势。随机游走是一个非静止时间序列的良好示例，没有潜在趋势。[^2]
- en: Tests for determining whether a process is stationary are called *hypothesis
    tests*. The Augmented Dickey–Fuller (ADF) test is the most commonly used metric
    to assess a time series for stationarity problems. This test posits a null hypothesis
    that a unit root is present in a time series. Depending on the results of the
    test, this null hypothesis can be rejected for a specified significance level,
    meaning the presence of a unit root test can be rejected at a given significance
    level.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 用于确定过程是否平稳的检验被称为*假设检验*。增广迪基-富勒（ADF）检验是评估时间序列平稳性问题最常用的指标。该检验提出一个空假设，即时间序列中存在单位根。根据检验结果，可以在指定的显著性水平上拒绝该空假设，这意味着在给定显著性水平下可以拒绝单位根的存在。
- en: Note that tests for stationarity focus on whether the mean of a series is changing.
    The variance is handled by transformations rather than formally tested. The test
    of whether a series is stationary is thus a test of whether a series is integrated.
    An integrated series of order *d* is a series that must be differenced *d* times
    to become stationary.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，平稳性检验侧重于系列的均值是否变化。方差通过变换而非正式检验来处理。因此，系列是否平稳的测试实际上是对系列是否集成的测试。阶数为*d*的集成系列是一种必须差分*d*次才能变得平稳的系列。
- en: 'The framing of the Dickey–Fuller test is as follows:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 迪基-富勒检验的框架如下：
- en: <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Δ</mi> <msub><mi>y</mi>
    <mi>t</mi></msub> <mo>=</mo> <msub><mi>y</mi> <mi>t</mi></msub> <mtext>–</mtext>
    <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub> <mo>=</mo>
    <mrow><mo>(</mo> <mi>ϕ</mi> <mtext>–</mtext> <mn>1</mn> <mo>)</mo></mrow> <mo>×</mo>
    <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub> <mo>+</mo>
    <msub><mi>ϵ</mi> <mi>t</mi></msub></mrow></math>
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mi>Δ</mi> <msub><mi>y</mi>
    <mi>t</mi></msub> <mo>=</mo> <msub><mi>y</mi> <mi>t</mi></msub> <mtext>–</mtext>
    <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub> <mo>=</mo>
    <mrow><mo>(</mo> <mi>ϕ</mi> <mtext>–</mtext> <mn>1</mn> <mo>)</mo></mrow> <mo>×</mo>
    <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub> <mo>+</mo>
    <msub><mi>ϵ</mi> <mi>t</mi></msub></mrow></math>
- en: 'Then the test of whether *ϕ* = 1 is a simple *t*-test of whether the parameter
    on the lagged *y[t–1]* is equal to 0\. The difference that the ADF test makes
    is to account for more lags, so that the underlying model takes higher-order dynamics
    into account, which can be written as a series of differenced lags:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，测试*ϕ* = 1是否一个简单的*t*检验，检验滞后*y[t–1]*上的参数是否等于0。ADF检验的不同之处在于考虑更多的滞后，使得底层模型考虑更高阶的动态效应，可以写成一系列差分滞后：
- en: <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>Y</mi> <mi>t</mi></msub>
    <mtext>–</mtext> <msub><mi>ϕ</mi> <mn>1</mn></msub> <mo>×</mo> <msub><mi>y</mi>
    <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub> <mtext>–</mtext> <msub><mi>ϕ</mi>
    <mn>2</mn></msub> <mo>×</mo> <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>2</mn></mrow></msub>
    <mo>.</mo> <mo>.</mo> <mo>.</mo> <mo>=</mo> <msub><mi>ϵ</mi> <mi>t</mi></msub></mrow></math>
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><msub><mi>Y</mi> <mi>t</mi></msub>
    <mtext>–</mtext> <msub><mi>ϕ</mi> <mn>1</mn></msub> <mo>×</mo> <msub><mi>y</mi>
    <mrow><mi>t</mi><mo>-</mo><mn>1</mn></mrow></msub> <mtext>–</mtext> <msub><mi>ϕ</mi>
    <mn>2</mn></msub> <mo>×</mo> <msub><mi>y</mi> <mrow><mi>t</mi><mo>-</mo><mn>2</mn></mrow></msub>
    <mo>.</mo> <mo>.</mo> <mo>.</mo> <mo>=</mo> <msub><mi>ϵ</mi> <mi>t</mi></msub></mrow></math>
- en: This requires somewhat more algebra to write as a series of differenced lags,
    and the expected distribution against which to test the null hypothesis is somewhat
    different compared to the original Dickey–Fuller test. The ADF test is the most
    widely presented test for stationarity in the time series literature.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 这需要更多的代数来写成一系列差分滞后，并且用于测试空假设的期望分布与原始迪基-富勒检验有所不同。ADF检验是时间序列文献中最广泛展示的平稳性检验。
- en: 'Unfortunately, these tests are far from a panacea to your stationarity problems
    for a number of reasons:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，由于多种原因，这些检验远非你解决平稳性问题的灵丹妙药：
- en: These tests have low power in distinguishing *near* unit roots from unit roots.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些检验在区分*接近*单位根和单位根方面的能力较低。
- en: With low sample size, false positives for unit roots are fairly common.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 样本量较小时，单位根的假阳性相当普遍。
- en: Most tests do not test for or against all kinds of problems that can lead to
    a nonstationary time series. For example, some times will look specifically to
    testing whether the mean or the variance (but not both) is stationary. Other tests
    will look more generally at the overall distribution. It is important to understand
    the limits of the test applied when using it and to ensure that the limits are
    consistent with your beliefs about your data.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大多数检验不会针对所有可能导致非平稳时间序列的问题进行测试。例如，有些测试专门测试系列的均值或方差（但不是两者都）。其他测试则更广泛地检查整体分布。在使用时，理解所应用测试的限制并确保这些限制与您对数据的信念一致至关重要。
- en: 'Setting an Alternate Null Hypothesis: KPSS Test'
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设定替代空假设：KPSS检验
- en: While the ADF test posits a null hypothesis of a unit root, the Kwiatkowski-Phillips-Schmidt-Shin
    (KPSS) test posits a null hypothesis of a stationary process. Unlike the ADF,
    the KPSS is not available in base R, but is still widely implemented. There are
    some nuances as to what these tests are for and how to use them properly; these
    are beyond the scope of this text but [widely discussed online](https://perma.cc/D3F2-TATY).
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然ADF检验假设存在单位根的空假设，但Kwiatkowski-Phillips-Schmidt-Shin（KPSS）检验假设一个平稳过程的空假设。与ADF不同，KPSS不在基础R中可用，但仍然广泛实施。关于这些检验的用途和正确使用方式存在一些细微差别；这些内容超出本文范围，但在[网络上广泛讨论](https://perma.cc/D3F2-TATY)。
- en: In practice
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在实践中
- en: Stationarity matters in practice for a number of reasons. First, a large number
    of models assume a stationary process, such as traditional models with known strengths
    and statistical models. We will cover these classes of models in [Chapter 6](ch06.html#statistical_model_for_time_series).
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在实践中，平稳性对多种原因至关重要。首先，大量模型假设一个平稳过程，如具有已知强度和统计模型的传统模型。我们将在[第6章](ch06.html#statistical_model_for_time_series)中涵盖这些模型类。
- en: A broader point is that a model of a time series that is not stationary will
    vary in its accuracy as the metrics of the time series vary. That is, if you are
    seeking a model to help you estimate the mean of a time series with a nonstationary
    mean and variance, the bias and error in your model will vary over time, at which
    point the value of your model becomes questionable.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 更广义的一点是，非平稳时间序列模型在时间序列的度量指标变化时精度也会变化。也就是说，如果你正在寻找一个模型来帮助你估计一个具有非平稳均值和方差的时间序列的均值，那么你的模型中的偏差和误差将随时间变化，此时你的模型的价值变得值得怀疑。
- en: It is often the case that a time series can be made stationary enough with a
    few simple transformations. A log transformation and a square root transformation
    are two popular options, particularly in the case of changing variance over time.
    Likewise, removing a trend is most commonly done by differencing. Sometimes a
    series must be differenced more than once. However, if you find yourself differencing
    too much (more than two or three times) it is unlikely that you can fix your stationarity
    problem with differencing.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，一个时间序列可以通过几个简单的变换使其足够平稳。对数变换和平方根变换是两种流行的选择，特别是在时间上变化方差的情况下。同样地，通过差分来去除趋势是最常见的做法。有时候一个序列必须进行多次差分。然而，如果你发现自己进行了过多的差分（超过两三次），那么用差分来解决你的平稳性问题是不太可能的。
- en: Log or sqrt?
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对数还是平方根？
- en: While a square root tends to be less computationally complex than a logarithm,
    you should explore both options. Think about the range of your data and how you
    want to compress large values rather than prematurely optimizing (that is, unduly
    pessimizing) your code and analysis.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然平方根通常比对数计算复杂性低，但你应该探索两种选择。考虑你的数据范围以及你希望如何压缩大值，而不是过早优化（即过度悲观化）你的代码和分析。
- en: Stationarity is not the only assumption forecasting models make. Another common
    but distinct assumption is the normality of the distribution of the input variables
    or predicted variable. In such cases, other transformations may be necessary.
    A common one is the Box Cox transformation, which is implemented in the R `forecast`
    package and in `scipy.stats` in Python. The transformation makes non-normally
    distributed data (skewed data) more normal. However, just because you can transform
    your data doesn’t mean you should. Think carefully about the meaning of the distances
    between data points in your original data set before transforming them, and make
    sure, regardless of your task, that transformations preserve the most important
    information.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 平稳性不是预测模型所做的唯一假设。另一个常见但不同的假设是输入变量或预测变量的正态分布。在这种情况下，可能需要其他变换。一个常见的变换是Box Cox变换，在R的`forecast`包和Python的`scipy.stats`中实现。该变换使非正态分布的数据（偏斜数据）更接近正态分布。然而，仅仅因为你可以对数据进行变换并不意味着你应该这样做。在转换之前，请仔细考虑原始数据集中数据点之间距离的含义，并确保无论任务如何，变换都能保留最重要的信息。
- en: Applying Window Functions
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 应用窗口函数
- en: Let’s review the most important time series exploratory graphs, which you are
    likely to use for most initial time series analysis.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回顾一下最重要的时间序列探索图表，这些图表可能在大多数初始时间序列分析中使用。
- en: Rolling windows
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 滚动窗口
- en: A common function distinct to time series is a window function, which is any
    sort of function where you aggregate data either to compress it (as we saw in
    the case of downsampling in the previous chapter) or to smooth it (also discussed
    in [Chapter 2](ch02.html#finding_and_wrangling_time_series_data)). In addition
    to the applications already discussed, smoothed data and window-aggregated data
    make for informative exploratory visualizations.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 一个特定于时间序列的常见函数是窗口函数，它是任何一种在聚合数据时压缩数据（正如我们在上一章中看到的下采样的情况）或平滑数据（也在[第2章](ch02.html#finding_and_wrangling_time_series_data)中讨论过）的函数。除了已经讨论过的应用外，平滑数据和窗口聚合数据可用于信息丰富的探索性可视化。
- en: 'We can calculate a moving average and other calculations that involve some
    linear function of a series of points with base R’s `filter()` function, as follows:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用基于R的`filter()`函数计算移动平均线和其他涉及一系列点的线性函数的计算，如下所示：
- en: '[PRE9]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This code produces the graph in [Figure 3-6](#fig-0306).
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码生成了图表[图3-6](#fig-0306)。
- en: '![](assets/ptsa_0306.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0306.png)'
- en: Figure 3-6\. Two exploratory curves produced via a rolling mean smoothing. We
    might use these to look for a trend in particularly noisy data or to decide what
    sorts of deviations from linear behavior are interesting to investigate versus
    which are likely just noise.
  id: totrans-119
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-6\. 通过滚动均值平滑生成的两条探索曲线。我们可以使用这些曲线来寻找特别嘈杂数据中的趋势，或者决定哪些线性行为偏离是有趣的研究对象，而哪些可能只是噪音。
- en: 'If we are looking for functions that are not linear combinations of all points
    in the window, we can’t use `filter()` because it relies on a linear transformation
    of the data. However, we can use `zoo`. The `rollapply()` function from the `zoo`
    package is quite handy (see [Figure 3-7](#fig-0307)):'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在寻找不是窗口中所有点的线性组合的函数，则无法使用`filter()`，因为它依赖于数据的线性变换。但是，我们可以使用`zoo`。`zoo`包中的`rollapply()`函数非常方便（见[图
    3-7](#fig-0307)）：
- en: '[PRE10]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](assets/ptsa_0307.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0307.png)'
- en: Figure 3-7\. A rolling window minimum aligned either to the left (long dashes)
    or to the right (short dashes). The left alignment sees events in the future,
    whereas the right sees only events in the past. This is important to note for
    avoiding lookahead. However, sometimes a left alignment can be useful to ask exploratory
    questions such as “if I knew this in advance, would it even be useful?” Sometimes
    even a lookahead is not informative, which means that a particular variable is
    not informative. When knowing the future of a measure is not helpful, it’s likely
    not a useful measure at any time in a time series context.
  id: totrans-123
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-7\. 滚动窗口最小值，左对齐（长划线）或右对齐（短划线）。左对齐可以看到未来的事件，而右对齐只能看到过去的事件。这一点很重要，避免了预先看看。然而，有时左对齐可以用来提出探索性问题，比如“如果我事先知道这个，那么它会有用吗？”有时即使预先看也不具信息性，这意味着特定变量不具信息性。当了解一个度量的未来对于帮助无济于事时，在时间序列的任何时间中，这个度量可能都不是有用的度量。
- en: Warning
  id: totrans-124
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: Use `zoo` objects in `zoo` functions. If you pass numeric vectors directly to
    `rollapply()`, the `align` argument will not take effect. You can confirm this
    by deleting the `zoo()` wrapper around `x` in the preceding code. You will see
    that the two curves are identical and, in fact, this is a silent failure, which
    is particularly dangerous in time series analysis because it can introduce an
    unintended lookahead. This is an example of why you need to sanity-check often,
    even with your exploratory data analysis. Unfortunately, silent failure is not
    unusual in many popular R packages and in other scripting languages, so stay alert!
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在`zoo`函数中使用`zoo`对象。如果直接将数值向量传递给`rollapply()`，则`align`参数将不会生效。您可以通过删除前面代码中对`x`的`zoo()`包装来确认这一点。您会发现这两条曲线是相同的，实际上这是一个悄无声息的失败，在时间序列分析中尤为危险，因为它可能引入意外的预看。这正是为什么您需要经常进行理性检查的例子，即使在探索性数据分析中也是如此。不幸的是，悄无声息的失败在许多流行的R包和其他脚本语言中并不罕见，因此保持警惕！
- en: It is also possible to “roll your own” for this kind of function, which can
    be a good idea to limit dependencies. In such cases, I’d strongly recommend starting
    with the [source code](https://perma.cc/5LTP-Q45T) from an existing widely used
    package, such as `zoo`. This is because, even for a univariate time series, there
    are a surprising number of corner cases to think about, such as how to treat `NA`s,
    and how to treat the beginning and ending of a series where you will have fewer
    points than the specified size of the window.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 也有可能“自己动手”实现这种功能，这样做可以限制依赖。在这种情况下，我强烈建议从现有广泛使用的包（例如`zoo`）的[源代码](https://perma.cc/5LTP-Q45T)开始。因为即使对于单变量时间序列，也有许多意外情况需要考虑，比如如何处理`NA`以及如何处理系列的开始和结束，这些地方点数可能少于窗口指定的大小。
- en: Expanding windows
  id: totrans-127
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 扩展窗口
- en: Expanding windows are less commonly used in time series analysis than rolling
    windows because their proper application is more limited. Expanding windows make
    sense only in cases where you are estimating a summary statistic that you believe
    is a stable process rather than evolving over time or oscillating significantly.
    An expanding window starts with a given minimum size, but as you progress into
    the time series, it grows to include every point up to a given time rather than
    only a finite and constant size.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展窗口在时间序列分析中使用较少，与滚动窗口相比，因其适用范围更为有限。扩展窗口仅在你估计一个稳定过程而非随时间演变或振荡显著的总结统计量时才有意义。扩展窗口从给定的最小尺寸开始，但随着时间序列的进行，窗口会逐渐扩展，包括直到特定时间的每个数据点，而不是保持一个有限且恒定的大小。
- en: An expanding window offers greater certainty in your estimate of test statistics
    over time, allowing you to benefit from being “deeper” into a particular time
    series. However, it works only if you hypothesize that your underlying system
    is stationary. It can help you maintain “online” summary statistics as you would
    have estimated them in real time as you gathered more information.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展窗口在随时间推移中提供了对测试统计量更大的确定性，使您能够从深入到特定时间序列中受益。但是，它仅在您假设您的基础系统是静止的情况下才有效。它可以帮助您保持“在线”摘要统计，就像在收集更多信息时实时估计它们一样。
- en: 'If you look into base R, you will realize that many functions already exist
    as implementations of an expanding window, such as `cummax` and `cummin`. You
    can also easily repurpose `cumsum` to create a cumulative mean. In the following
    plot, we show both an expanding window `max` and an expanding window `mean` (see
    [Figure 3-8](#fig-0308)):'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您查看基础R，您会意识到许多函数已存在作为扩展窗口的实现，例如`cummax`和`cummin`。您还可以轻松重新使用`cumsum`来创建累积均值。在下图中，我们展示了扩展窗口`max`和扩展窗口`mean`（参见[图 3-8](#fig-0308)）：
- en: '[PRE11]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](assets/ptsa_0308.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0308.png)'
- en: Figure 3-8\. An expanding window “max” (long dashes) and an expanding window
    “mean” (short dashes). Use of an expanding window means that the max always reflects
    the global max up until that time, making it a monotonic function. Thanks to the
    long “memory” of the expanding window, the expanding window mean is lower than
    the rolling mean ([Figure 3-7](#fig-0307)) because the underlying trend is less
    prominent in the expanding mean. Whether this is good, bad, or neutral depends
    on our assumptions and knowledge of the underlying system.
  id: totrans-133
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-8\. 扩展窗口“max”（长划线）和扩展窗口“mean”（短划线）。使用扩展窗口意味着最大值始终反映到那时的全局最大值，使其成为单调函数。由于扩展窗口的长“记忆”，扩展窗口均值比滚动均值低（参见[图 3-7](#fig-0307)），因为扩展均值中的基础趋势不那么显著。这是好是坏还是中立，取决于我们的假设和对基础系统的知识。
- en: 'If you need a custom function with a rolling window, you can use `rollapply()`
    as we did for a rolling window. In this case, you need to specify a sequence of
    window sizes rather than a single scalar. Running the following code will produce
    an identical plot to the one in [Figure 3-8](#fig-0308), but this time it was
    created with `rollapply()` rather than built-in R functions:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要带有滚动窗口的自定义函数，您可以使用`rollapply()`，就像我们为滚动窗口所做的那样。在这种情况下，您需要指定一系列窗口大小而不是单个标量。运行以下代码将生成与[图 3-8](#fig-0308)相同的图，但这次是使用`rollapply()`而不是内置R函数创建的：
- en: '[PRE12]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Custom rolling functions
  id: totrans-136
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 自定义滚动函数
- en: We only care about the option to apply a custom rolling function if we can actually
    imagine doing so. In practice, this is something you are likely to see when analyzing
    time series domains that have known underlying fundamental laws of behavior or
    useful heuristics that are necessary for proper analysis.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只关心是否有可能应用自定义滚动函数。在实践中，这是您在分析已知具有已知基本行为规律或必要用于正确分析的有用启发式的时间序列领域时可能看到的内容。
- en: For example, we may be looking at windows that include a particular feature
    that is informative given domain knowledge. We might want to know when we are
    in a *monotonic* regime (say, blood sugar is increasing) versus an up-and-down
    regime that suggests instrumental noise rather than a trend. We could write a
    custom function for this scenario and apply it with either a moving or expanding
    window.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，我们可能正在查看包含特定特征的窗口，这在领域知识的基础上具有信息意义。我们可能希望知道我们处于*单调*（比如，血糖上升）还是上下波动的情况，这表明是仪器噪声而不是趋势。我们可以为这种情况编写自定义函数，并使用移动或扩展窗口应用它。
- en: Understanding and Identifying Self-Correlation
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解和识别自相关
- en: At its most fundamental, self-correlation of a time series is the idea that
    a value in a time series at one given point in time may have a correlation to
    the value at another point in time. Note that “self-correlation” is being used
    here informally to describe a general idea rather than a technical one.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在其最基本的层面上，时间序列的自相关是指时间序列中的一个值在某一时间点可能与另一个时间点的值相关。请注意，“自相关”在此处是非正式使用，用于描述一个概念而非技术性描述。
- en: As an example of self correlation, if you take a yearly time series of daily
    temperature data, you may find that comparing May 15th of every year to August
    15th of every year will give you some correlation, such that hotter May 15ths
    tend to correlate with hotter August 15ths (or tend to correlate with cooler August
    15ths). You may feel you have learned a potentially interesting fact about the
    temperature system, indicating that there is a certain amount of long-term predictability.
    On the other hand, you may find the correlation closer to zero, in which case
    you will also have found something interesting, namely that knowing the temperature
    on May 15th does not alone give you any information about the likely range of
    temperatures on August 15th. That is self-correlation in an anecdotal nutshell.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 举个自相关的例子，如果您拿年度时间序列的每日温度数据来说，您可能会发现，将每年的5月15日与每年的8月15日进行比较，会得到一些相关性，例如较热的5月15日倾向于与较热的8月15日相关联（或者倾向于与较冷的8月15日相关联）。这可能让您觉得已经学到了关于温度系统的潜在有趣事实，表明存在一定的长期可预测性。另一方面，您可能会发现相关性接近于零，这种情况下，您也会发现一些有趣的事实，即仅仅知道5月15日的温度并不能为您提供关于8月15日温度范围的任何信息。这就是自相关在轶事中的要点。
- en: From this simple example, we are going to expand into autocorrelation, which
    generalizes self-correlation by not anchoring to a specific point in time. In
    particular, autocorrelation asks the more general question of whether there is
    a correlation between any two points in a specific time series with a specific
    fixed distance between them. We’ll look at this in more detail next, as well as
    final elaboration of partial autocorrelation.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个简单的例子出发，我们将扩展到自相关，它通过不锚定到特定时间点来推广自相关。特别是，自相关提出了更一般的问题，即在特定时间序列中，任意两个点之间是否存在固定距离的相关性。接下来我们将更详细地讨论这一点，以及对偏自相关的最终阐述。
- en: The autocorrelation function
  id: totrans-143
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 自相关函数
- en: 'We begin with [Wikipedia’s](https://perma.cc/U8JY-QD7U) excellent definition
    of autocorrelation:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从[Wikipedia](https://perma.cc/U8JY-QD7U)对自相关的优秀定义开始：
- en: Autocorrelation, also known as serial correlation, is the correlation of a signal
    with a delayed copy of itself as a function of the delay. Informally, it is the
    similarity between observations as a function of the time lag between them.
  id: totrans-145
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 自相关，也称为串行相关，是信号与延迟副本之间的相关性，其延迟作为延迟函数。非正式地说，它是观察之间的相似性，作为它们之间时间滞后的函数。
- en: Let’s translate that into plainer English. Autocorrelation gives you an idea
    of how data points at different points in time are linearly related to one another
    as a function of their time difference.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用更简单的英语来解释一下。自相关告诉您不同时间点的数据点如何作为它们时间差的函数而线性相关。
- en: 'The *autocorrelation function* (ACF) can be intuitively understood with plotting.
    We can plot it easily in R (see [Figure 3-9](#fig-0309)):'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '*自相关函数*（ACF）可以通过绘图直观理解。我们可以在R中轻松绘制它（参见[图 3-9](#fig-0309)）：'
- en: '[PRE13]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![](assets/ptsa_0309.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0309.png)'
- en: Figure 3-9\. Plot of a sine function and its ACF.
  id: totrans-150
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-9\. 正弦函数及其自相关函数的绘图。
- en: From the ACF, we see that points that have a lag between them of 0 have a correlation
    of 1 (this is true for every time series), whereas points separated by 1 lag have
    a correlation of 0.5\. Points separated by 2 lags have a correlation of –0.5,
    and so on.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 从ACF中，我们可以看到，时间滞后为0的点之间的相关性为1（对于每个时间序列都是如此），而滞后1的点之间的相关性为0.5。滞后2的点之间的相关性为–0.5，依此类推。
- en: 'Calculating the ACF is straightforward. We can do it ourselves using `data.table`’s
    `shift()` function:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 计算ACF非常简单。我们可以使用`data.table`的`shift()`函数自己做到这一点：
- en: '[PRE14]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Our calculations approximately match the graphical results in [Figure 3-9](#fig-0309).^([3](ch03.html#idm45576045555496))
    While it is straightforward to calculate the ACF with custom code, it’s usually
    better to use a prerolled version, such as R’s `acf` function. There are several
    advantages to doing so:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的计算与[图 3-9](#fig-0309)中的图形结果大致匹配。虽然可以使用自定义代码直接计算ACF，但通常最好使用预先定义的版本，例如R的`acf`函数。这样做有几个优点：
- en: Automatic plotting with helpful labels
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动绘图与有用的标签
- en: A sensible (usually but not always) max number of lags for which to calculate
    ACF, as well as the option to override this max
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通常但并非总是合理的最大滞后数，以及可以覆盖此最大值的选项
- en: A graceful way to handle multivariate time series
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理多变量时间序列的一个优雅方法
- en: 'There are a few important facts about the ACF, mathematically speaking:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 就数学角度而言，关于ACF有几个重要事实：
- en: The ACF of a periodic function has the same periodicity as the original process.
    You can see this in the preceding sine example plots.
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 周期函数的ACF具有与原始过程相同的周期性。 您可以在前述正弦示例图中看到这一点。
- en: The autocorrelation of the sum of periodic functions is the sum of the autocorrelations
    of each function separately. You can easily formulate an example of this with
    some simple code.
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 周期函数的总和的自相关是每个函数单独自相关的总和。 您可以使用一些简单的代码轻松地制定一个示例。
- en: All time series have an autocorrelation of 1 at lag 0.
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有时间序列在滞后0处的自相关系数为1。
- en: The autocorrelation of a sample of white noise will have a value of approximately
    0 at all lags other than 0.
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 白噪声样本的自相关在除了0之外的所有滞后处大约为0。
- en: The ACF is symmetric with respect to negative and positive lags, so only positive
    lags need to be considered explicitly. You can try plotting a manually calculated
    ACF to prove this.
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ACF关于负滞后和正滞后对称，因此只需明确考虑正滞后。您可以尝试绘制手动计算的ACF来证明这一点。
- en: A statistical rule for determining a significant nonzero ACF estimate is given
    by a “critical region” with bounds at +/–1.96 × sqrt(*n*). This rule relies on
    a sufficiently large sample size and a finite variance for the process.
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定显著非零ACF估计的统计规则由“临界区域”给出，其边界为+/–1.96 × sqrt(*n*)。 此规则依赖于足够大的样本量和过程的有限方差。
- en: The partial autocorrelation function
  id: totrans-165
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**偏自相关函数**'
- en: The partial autocorrelation function (PACF) can be trickier to understand than
    the ACF. The partial autocorrelation of a time series for a given lag is the partial
    correlation of the time series with itself at that lag given all the information
    between the two points in time.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 偏自相关函数（PACF）比ACF更难理解。给定滞后的时间序列的偏自相关是在两个时间点之间的所有信息下，时间序列与其自身在该滞后处的偏相关。
- en: It’s easy to nod your head here and think that sounds reasonable. But what exactly
    does it mean to account for the information between two points in time? It means
    you need to compute a number of conditional correlations and subtract these out
    of the total correlation. Computing the PACF is not straightforward, and there
    are a variety of methods for estimating it. We will not discuss these here, but
    you can find discussions in the related R and Python documentation.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里点头表示认同听起来很合理。但是，准确来说，什么是在两个时间点之间考虑信息？这意味着您需要计算多个条件相关并从总相关中减去这些。计算PACF并非易事，并且有多种估计方法。我们这里不讨论这些，但您可以在相关的R和Python文档中找到讨论。
- en: 'The PACF is easier to understand graphically than conceptually. Its utility
    is also much more obvious in a graph than in a discussion (see [Figure 3-10](#fig-0310)):'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: PACF在图形上比概念上更容易理解。 它在图表中的实用性也比讨论中更为明显（见[图3-10](#fig-0310)）：
- en: '[PRE15]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](assets/ptsa_0310.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0310.png)'
- en: Figure 3-10\. Plot and PACF of a seasonal, noiseless process.
  id: totrans-171
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-10。 季节性无噪声过程的绘图和PACF。
- en: For the case of a sine series, the PACF provides a striking contrast to the
    ACF. The PACF shows which data points are informative and which are harmonics
    of shorter time periods.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 对于正弦级数的情况，PACF与ACF形成鲜明对比。 PACF显示哪些数据点是信息丰富的，哪些是较短时间周期的谐波。
- en: For a seasonal and noiseless process, such as the sine function, with period
    T, the same ACF value will be seen at T, 2T, 3T, and so on up to infinity. An
    ACF fails to weed out these redundant correlations. The PACF, on the other hand,
    reveals which correlations are “true” informative correlations for specific lags
    rather than redundancies. This is invaluable for knowing when we have collected
    enough information to get a sufficiently long window at a proper temporal scale
    for our data.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 对于季节性且无噪声的过程，如正弦函数，以周期T为周期，将在T、2T、3T等处看到相同的ACF值，直到无限大。 ACF未能消除这些冗余相关性。 另一方面，PACF显示了哪些相关性是特定滞后的“真实”信息相关性，而不是冗余性。
    这对于知道我们何时收集了足够的信息以获得足够长的窗口在数据的适当时间尺度上是非常宝贵的。
- en: The critical region for the PACF is the same as for the ACF. The critical region
    has bounds at <math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>±</mo>
    <mn>1</mn> <mo>.</mo> <mn>96</mn> <msqrt><mi>n</mi></msqrt></mrow></math> . Any
    lags with calculated PACF values falling inside the critical region are effectively
    zero.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: PACF的临界区域与ACF相同。 临界区域在<math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>±</mo>
    <mn>1</mn> <mo>.</mo> <mn>96</mn> <msqrt><mi>n</mi></msqrt></mrow></math>处有界。
    任何计算的PACF值落在临界区域内的滞后实际上为零。
- en: We have so far looked only at examples of perfectly noiseless single-frequency
    processes. Now we look at a slightly more complicated example. We’ll consider
    the sum of two sine curves under no noise, low noise, and high noise conditions.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们只看了完全无噪声的单频过程示例。现在我们看一个稍微复杂的例子。我们将考虑无噪声、低噪声和高噪声条件下两个正弦曲线的求和。
- en: 'First, let’s look at the plots with no noise, each individually (see [Figure 3-11](#fig-0311)):'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们查看无噪声的情况下各自的图表（见[图 3-11](#fig-0311)）：
- en: '[PRE16]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Tip
  id: totrans-178
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: The ACF of stationary data should drop to zero quickly. For nonstationary data
    the value at lag 1 is positive and large.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 静止数据的自相关函数（ACF）应快速下降至零。对于非静止数据，滞后1的值为正且较大。
- en: '![](assets/ptsa_0311.png)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0311.png)'
- en: Figure 3-11\. Plots of two sine functions, their ACF, and their PACF.
  id: totrans-181
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-11\. 两个正弦函数、它们的自相关函数（ACF）和偏自相关函数（PACF）的图表。
- en: 'We combine the two series by summing and create the same plots for the summed
    series (see [Figure 3-12](#fig-0312)):'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过求和来结合这两个系列，并为求和系列创建相同的图表（见[图 3-12](#fig-0312)）：
- en: '[PRE17]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: As we can see, our ACF plot is consistent with the aforementioned property;
    the ACF of the sum of two periodic series is the sum of the individual ACFs. You
    can see this most clearly by noticing the positive → negative → positive → negative
    sections of the ACF correlating to the more slowly oscillating ACF. Within these
    waves, you can see the faster fluctuation of the higher-frequency ACF.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所见，我们的ACF图与前述特性一致；两个周期系列的求和的ACF是各自ACF的和。您可以通过注意到ACF的正→负→正→负部分来清楚地看到这一点，这些部分与更慢振荡的ACF相关。在这些波浪中，您可以看到更高频ACF的快速波动。
- en: '![](assets/ptsa_0312.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0312.png)'
- en: Figure 3-12\. Plot, ACF, and PACF for the sum of the two sine series.
  id: totrans-186
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-12\. 两个正弦系列的求和的图表、自相关函数（ACF）和偏自相关函数（PACF）。
- en: The PACF is not a straightforward sum of the PACF functions of the individual
    components. A PACF is simple enough to understand once it is calculated, but it’s
    not so easy to generate or predict. This PACF indicates that partial autocorrelation
    is more substantial in the summed series than in either of the original series.
    That is, the correlation between points separated by a certain lag, when accounting
    for the values of the points between them, is more informative in the summed series
    than in the original series. This is related to the two different periods of the
    series, which result in any given point being less determined by the values of
    neighboring points since the location within the cycle of the two periods is less
    fixed now as the oscillations continue at different frequencies.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: PACF不是各个分量的PACF函数的简单求和。一旦计算出来，PACF就足够简单理解，但生成或预测起来并不容易。该PACF表明，与原始系列中的任一点相比，分离由某个滞后分隔的点的相关性，考虑它们之间点的值时，在求和系列中更具信息性。这与系列的两个不同周期有关，这导致给定点不太由相邻点的值确定，因为现在两个周期的振荡在不同频率下继续。
- en: 'Let’s look at the same situation, but with more noise (see [Figure 3-13](#fig-0313)):'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看相同情况，但带有更多噪音（见[图 3-13](#fig-0313)）：
- en: '[PRE18]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![](assets/ptsa_0313.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0313.png)'
- en: Figure 3-13\. Plot, ACF, and PACF of two noisy sine processes and their sum.
  id: totrans-191
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-13\. 两个带有噪声的正弦过程及其求和的图表、自相关函数（ACF）和偏自相关函数（PACF）。
- en: Finally we add more noise to the time series so that the initial data itself
    does not even look particularly sine-like. (We omit the code example because it
    is the same as the previous example, simply with a larger `sd` parameter for `rnorm`.)
    We can see that this adds further interpretation difficulties, particularly to
    the PACF. The only difference between the plots in [Figure 3-14](#fig-0314) and
    the previous ones is a larger `sd` value for the `noise` variables.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们给时间序列添加更多噪声，使得初始数据本身甚至不看起来特别像正弦波。 （我们省略了代码示例，因为它与前一个示例相同，只是`rnorm`的`sd`参数更大。）我们可以看到，这增加了进一步的解释困难，特别是对PACF。[图 3-14](#fig-0314)中的图与之前的图唯一的区别是噪声变量的`sd`值更大。
- en: '![](assets/ptsa_0314.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0314.png)'
- en: Figure 3-14\. Plot, ACF, and PACF of very noisy sum of two sine processes.
  id: totrans-194
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-14\. 两个正弦过程非常嘈杂的求和的图表、自相关函数（ACF）和偏自相关函数（PACF）。
- en: 'Let’s conclude with a look at the ACF and PACF of a real-world data set. Below,
    we examine the `AirPassengers` data. Given what we have seen so far, think about
    why the ACF has so many “critical” values (answer: it has a trend) and why the
    PACF has a critical value for a large lag (answer: the yearly seasonal cycle,
    which is identifiable even with a trend in the data).'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们以一个真实数据集的ACF和PACF来总结。在下面，我们检查`AirPassengers`数据。根据我们到目前为止看到的内容，思考一下为什么ACF有这么多“关键”值（答案：它有趋势），以及为什么PACF对于一个大滞后有关键值（答案：年度季节循环，即使数据中有趋势也是可以识别的）。
- en: '![](assets/ptsa_0316.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![图示](assets/ptsa_0316.png)'
- en: Figure 3-16\. Plot of the ACF and PACF of the AirPassengers data. The lags here
    are not unit numbers because the lags are expressed as fractions of a year. This
    is because the AirPassengers data set comes in the form of a ts object, which
    has a built-in frequency that can be used for plotting (and other purposes).
  id: totrans-197
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-16\. 对AirPassengers数据的自相关函数（ACF）和偏自相关函数（PACF）绘图。这里的滞后值不是单位数字，因为滞后以年的分数形式表示。这是因为AirPassengers数据集采用了一个ts对象的形式，该对象具有内置频率用于绘图（及其他目的）。
- en: Spurious Correlations
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 伪相关性
- en: Those new to time series analysis will often begin with standard exploratory
    data practices, such as plotting two variables against each other and calculating
    their correlation. The new analyst will be very excited early on in the data exploration
    process when they notice what appears to be a very strong correlation and helpful
    relationship. They will continue looking and find other surprisingly high correlations;
    what an amazing system! They will wish they had started working with time series
    data sooner in their career. They will think to themselves, “All I do is win.”
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 那些刚接触时间序列分析的人通常会从标准的探索性数据实践开始，例如将两个变量绘图并计算它们的相关性。新的分析师在数据探索过程的早期会非常兴奋，当他们注意到一个看似非常强的相关性和有益的关系时。他们会继续寻找其他令人惊讶的高相关性；多么令人惊叹的系统！他们会希望自己早些在职业生涯中开始处理时间序列数据。他们会对自己想：“我只是赢了。”
- en: Then the analyst will do a little reading on time series analysis (best-case
    scenario), or present their findings to someone else and realize that it doesn’t
    all make sense (not the best-case scenario). A skeptic will point out to the analyst
    that the correlations are too high. It can seem like any two values are related.
    More problems will emerge as the analyst reruns their analysis with other sets
    of variables and finds that they too have surprisingly high correlations. At some
    point it will become clear that there can’t possibly be so many truly high correlations.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 然后分析师将会稍微阅读一下时间序列分析（最佳情况），或者将他们的发现展示给其他人，并意识到并不是所有事情都说得通（并非最佳情况）。一个怀疑论者会指出，相关性太高了。似乎任何两个值都有关联。当分析师使用其他变量集重新运行分析时，会出现更多问题，并发现它们也有令人惊讶的高相关性。在某个时候，会清楚地意识到不可能有这么多真正的高相关性。
- en: This trajectory is very much like the early history of econometrics. In the
    19th century, when economists first began thinking of the idea of a business cycle,
    some of them went looking for external drivers of the cycle, such as sun spots
    (an 11-year cycle) or various meteorological cycles (such as a posited 4-year
    precipitation cycle). They invariably got very positive and strongly correlated
    results, even when they had no causal hypothesis to explain these results.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 这一轨迹与计量经济学早期历史非常相似。19世纪，当经济学家首次开始思考商业周期的概念时，其中一些人寻找了周期的外部驱动因素，比如太阳黑子（一个11年周期）或各种气象周期（比如假设的4年降水周期）。他们总是得到非常积极且强相关的结果，即使他们没有因果假设来解释这些结果。
- en: Many economists and statisticians remained skeptical, and rightly so. Udny Yule
    investigated the problem formally with a paper titled [“Why Do We Sometimes Get
    Nonsense Correlations?”](https://www.jstor.org/stable/2341482), and an area of
    research was born and continues to give trouble and pleasure to academics. Spurious
    correlations remain an important problem to guard against, and they are hotly
    debated in litigation situations where one side asserts a relationship and the
    other side tries to discredit it. Similarly, one attempt to discredit climate
    change data relies on an argument that the correlation between increasing carbon
    emissions and warming global temperatures is a spurious correlation due to the
    trends in the two data sets (I do not find this argument convincing).
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 许多经济学家和统计学家对此持怀疑态度，这是正当的。乌德尼·尤尔（Udny Yule）通过一篇题为[“为什么有时我们会得到无意义的相关性？”](https://www.jstor.org/stable/2341482)的论文正式调查了这个问题，从而开创了一个研究领域，并继续为学术界带来麻烦和乐趣。虚假相关性仍然是一个需要警惕的重要问题，在诉讼情境中尤为热议，其中一方断言存在关联，而另一方试图驳斥。类似地，一种质疑气候变化数据的尝试依赖于一个论点，即增加的碳排放和全球变暖之间的相关性是由两个数据集的趋势造成的虚假相关性（我认为这一论点并不令人信服）。
- en: 'Economists have learned over time that data with an underlying trend is likely
    to produce spurious correlations. Here’s a simple way to think about this: there
    is more information in a trending time series than in a stationary time series,
    so there are more opportunities for data points to move together.'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 经济学家经过时间的学习已经了解到，具有基础趋势的数据可能会产生虚假相关性。以下是一个简单的思考方式：趋势时间序列中包含的信息比静止时间序列中的信息更多，因此数据点之间有更多的机会同时变动。
- en: 'In addition to trends, some other common features of time series can introduce
    spurious correlations:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 除了趋势之外，时间序列的一些其他常见特征也可能引入虚假相关性：
- en: Seasonality—for example, think of a spurious correlation between hot dog consumption
    and death by drowning (summer).
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 季节性——例如，考虑热狗消费与溺水死亡之间的虚假相关性（夏季）。
- en: Level or slope shifts in data from regime changes over time (producing a dumbbell-like
    distribution with meaningless high correlation).
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据由于时间的制度变化而产生的水平或斜率变化（产生类似哑铃形的分布，其中高相关性毫无意义）。
- en: Cumulatively summed quantities (this is a trick used in certain industries to
    make models or correlations look better than they are).
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 累积求和数量（这是某些行业用来使模型或相关性看起来比实际更好的技巧）。
- en: There is a well-known blog (and now book) full of wonderful examples of spurious
    correlations, and I share one in [Figure 3-17](#fig-0317). Whenever you are tempted
    to think you have found a special and very strong relationship, make sure to check
    your data for obvious causes of trouble such as trends.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 有一个众所周知的博客（现在也有一本书），充满了关于虚假相关性的精彩例子，我在[图3-17](#fig-0317)中分享了其中一个。每当您试图认为您发现了一个特别强的关系时，请务必检查数据是否存在明显的问题原因，比如趋势。
- en: '![](assets/ptsa_0317.png)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0317.png)'
- en: Figure 3-17\. Some spurious correlations can look surprisingly convincing. This
    plot was taken from [Tyler Vigen’s website](https://perma.cc/6UYH-FPBX) of spurious
    correlations.
  id: totrans-210
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图3-17。一些虚假相关性看起来出奇地令人信服。此图摘自[Tyler Vigen的网站](https://perma.cc/6UYH-FPBX)，展示了虚假相关性。
- en: Some Useful Visualizations
  id: totrans-211
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 一些有用的可视化
- en: Graphs are fundamental to a thorough exploratory analysis of time series. You
    will certainly want to visualize data with respect to the temporal axis—preferably
    in a way that answers the general questions you have about the data set, such
    as the behavior of a particular variable or the overall temporal distribution
    of the data points.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 图表对于时间序列的彻底探索性分析至关重要。您肯定希望通过时间轴来可视化数据，最好以一种能够回答数据集中您关心的一般问题的方式，比如特定变量的行为或数据点的整体时间分布。
- en: Earlier in this chapter, we looked at some plotting techniques familiar to any
    data analyst, such as a plot of values against time or a scatter plot of different
    columns’ values over time. In this final section on exploratory data analysis,
    we discuss several visualizations that are particularly helpful for offering novel
    insights about time series behavior.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 本章早些时候，我们探讨了一些对任何数据分析师都很熟悉的绘图技术，例如根据时间绘制值的图表或随时间散点绘制不同列的值的图表。在探索性数据分析的最后一节中，我们讨论了几种特别有助于提供关于时间序列行为的新见解的可视化方法。
- en: 'We will look at visualizations of varying degrees of complexity:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将看一些复杂程度不同的可视化：
- en: A one-dimensional visualization to understand the overall temporal distribution
    of individuals with a found time series we assembled in [Chapter 2](ch02.html#finding_and_wrangling_time_series_data)
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一维可视化，以理解我们在[第二章](ch02.html#finding_and_wrangling_time_series_data)中组装的时间序列的整体时间分布
- en: A two-dimensional histogram to understand the typical trajectory of a value
    over time in the case of many parallel measurements (say many years measured or
    many time series of the same phenomenon measured)
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个二维直方图，用于理解在许多并行测量（例如测量许多年或同一现象的许多时间序列）的情况下，值随时间的典型轨迹。
- en: A three-dimensional visualization where time can take up as many as two of the
    dimensions or as few as none of the dimensions, but still be implicitly present
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 三维可视化中，时间可以占据多达两个维度或一个维度，但仍然可以隐含地存在
- en: 1D Visualizations
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 一维可视化
- en: 'In the cases of many units of measurement (many users, members, etc.) we consider
    multiple time series in parallel. It can be interesting to stack these visually,
    emphasizing individual units of analysis and their respective time frames. We
    ignore the values measured and rather take the existence of data over a given
    range as the information of interest. The time span itself becomes the unit of
    analysis. Here we use R’s `timevis` package, but there are many other options
    available. We look at a small subset of the `donations` data we prepared in [Chapter 2](ch02.html#finding_and_wrangling_time_series_data)
    (see [Figure 3-18](#fig-0318)):'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多单位测量的情况下（许多用户、成员等），我们并行考虑多个时间序列。在视觉上堆叠这些序列可能会很有趣，强调个体分析单位及其各自的时间框架。我们忽略测量的值，而是将数据存在的时间范围视为感兴趣的信息。时间跨度本身成为分析单位。在这里，我们使用了R语言的`timevis`包，但还有许多其他选择。我们查看了我们在[第二章](ch02.html#finding_and_wrangling_time_series_data)中准备的`donations`数据的一个小子集（参见[图 3-18](#fig-0318)）：
- en: '[PRE19]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '![](assets/ptsa_0318.png)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0318.png)'
- en: Figure 3-18\. A Gantt chart of a random sample of data can offer some idea of
    the distribution of the range of “active” time periods for the users/donors.
  id: totrans-222
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-18\. 一个随机样本的甘特图可以提供一些关于用户/捐赠者“活跃”时间段分布的想法。
- en: The chart in [Figure 3-18](#fig-0318) helps us see that we probably have “busy”
    periods globally across the member population. We also glean some sense of the
    distribution of active donation spans in a member’s “lifetime” in our organization.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 3-18](#fig-0318)中的图表帮助我们看到，全球会员群体可能有“繁忙”的时期。我们还从中获得了一些关于会员组织中个体捐赠时间跨度分布的感觉。'
- en: Gantt charts have been used for over a century, most often for project management
    tasks. They came about independently in many different industries, and the idea
    is intuitive as soon as you see one. Despite the project management origins, Gantt
    charts can be useful in time series analysis where there are many independent
    actors, rather than a single process being measured. The plot in [Figure 3-18](#fig-0318)
    quickly answered questions I had about the relative overlap among the entire user
    base with respect to their donation history, a distribution I found difficult
    to understand when merely reading through the tabular data.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 甘特图已经被使用了一个多世纪，最常见的是用于项目管理任务。它们在许多不同的行业中独立产生，一旦看到它们，这个概念就显而易见。尽管起源于项目管理，甘特图在时间序列分析中也很有用，其中有许多独立的参与者，而不是单一的过程被测量。[图 3-18](#fig-0318)中的图形迅速回答了我关于整个用户群体在捐赠历史上的重叠程度的问题，这是我在仅仅阅读表格数据时发现很难理解的分布。
- en: 2D Visualizations
  id: totrans-225
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 二维可视化
- en: Now we’ll use the `AirPassengers` data to see the seasonality and the trend,
    but we shouldn’t think of time as linear. In particular, time happens on more
    than one axis. There is, of course, the axis of time going forward from day to
    day and year to year, but we can also consider laying time out along the axis
    of hour of the day or day of the week, and so on. In this way, we can more easily
    think about seasonality, such as certain behaviors happening at a certain time
    of the day or month of the year. We think in particular about how to understand
    our data in a seasonal fashion rather than just according to linear, chronological
    time visualizations.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将使用`AirPassengers`数据来查看季节性和趋势，但我们不应将时间视为线性。特别是，时间可以在多个轴上发生。当然，有从一天到另一天和一年到另一年的时间轴，但我们也可以考虑将时间布置在一天中的小时轴或一周中的日期轴上等等。通过这种方式，我们可以更容易地思考季节性，例如某些行为发生在一天的特定时间或一年中的特定月份。我们特别关注如何以季节方式理解我们的数据，而不仅仅是根据线性、时间顺序的可视化。
- en: 'We extract the data from the `AirPassengers` `ts` object and put it into appropriate
    matrix form:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从`AirPassengers`的`ts`对象中提取数据，并将其放入适当的矩阵形式中：
- en: '[PRE20]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Notice we had to transpose the data so that it will line up as presented by
    the `ts` object.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们必须对数据进行转置，以使其与`ts`对象呈现的方式一致。
- en: Column Major Versus Row Major
  id: totrans-230
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 列优先与行优先
- en: R is [column major](https://perma.cc/L4BH-DKB8) by default, which is unusual
    and different from Python’s `NumPy` (row major) and also different from most SQL
    databases. It’s good to be aware of what behaviors are default and available in
    a given language, not just for display purposes but to think about how to manage
    and access memory effectively later on.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: R默认是[column major](https://perma.cc/L4BH-DKB8)，这与Python的`NumPy`（row major）以及大多数SQL数据库不同。了解给定语言中默认和可用的行为是有益的，这不仅仅是为了展示目的，还要考虑如何有效地管理和访问内存。
- en: 'We plot each year on a set of axes that reflect the progression of the months
    across the year (see [Figure 3-19](#fig-0319)):'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在反映一年中月份进展的一组轴上绘制每年的曲线（见[图 3-19](#fig-0319)）：
- en: '[PRE21]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![](assets/ptsa_0319.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0319.png)'
- en: Figure 3-19\. Per-year month-by-month counts.^([4](ch03.html#idm45576044554168))
  id: totrans-235
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-19\. 按年份和月份计算的每月计数。^([4](ch03.html#idm45576044554168))
- en: 'We can produce the same plot more easily with the `forecast` package (see [Figure 3-20](#fig-0320)):'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`forecast`包可以更轻松地生成相同的图表（见[图 3-20](#fig-0320)）：
- en: '[PRE22]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The x-axis is month of the year for all years. Every year, the number of airline
    passengers peaks in July or August (months 7 and 8). We also see a local peak
    in March (month 3) most years. This graph can thus show us more details regarding
    the seasonality behavior.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: x轴是每年的月份。每年，航空公司乘客数量在七月或八月（第7和8月）达到峰值。大多数年份，三月（第3月）也有局部高峰。因此，该图可以显示更多关于季节性行为的细节。
- en: '![](assets/ptsa_0320.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0320.png)'
- en: Figure 3-20\. We produce a similar seasonal plot more easily with the seasonplot()
    function.
  id: totrans-240
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-20\. 使用seasonplot()函数更轻松地生成类似的季节性图表。
- en: The different years’ curves rarely cross. There was such robust growth that
    it was rarely the case that different years had the same number of passengers
    in the same month. There are a few exceptions, but not during the peak months.
    From these observations alone, we can already produce advice for an air travel
    company looking to make decisions about how to plan for growth.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 不同年份的曲线很少交叉。增长非常强劲，几乎不可能在同一月份不同年份有相同数量的乘客。有一些例外情况，但在高峰月份并不多见。仅凭这些观察，我们就可以为航空公司提供建议，帮助其做出关于如何规划增长的决策。
- en: 'An alternate plot of per-month curves against years is less standard but also
    helpful (see [Figure 3-21](#fig-0321)):'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 更少标准但同样有用的按年份排列的每月曲线的备选图（见[图 3-21](#fig-0321)）：
- en: '[PRE23]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![](assets/ptsa_0321.png)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0321.png)'
- en: Figure 3-21\. Per-month curves of year-to-year time series.^([5](ch03.html#idm45576044167112))
  id: totrans-245
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-21\. 按年份计算的每月曲线的时间序列。^([5](ch03.html#idm45576044167112))
- en: 'Through the years, the growth trend is accelerating; that is, the rate of increase
    is itself increasing. Also, two months are growing faster than the others, namely
    July and August. We can get a similar visualization and similar insights with
    an easy visualization function supplied by the `forecast` package (see [Figure 3-22](#fig-0322)):'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，增长趋势正在加速，即增长率本身在增加。此外，七月和八月两个月增长速度比其他月份快。使用`forecast`包提供的简易可视化函数，我们可以获得类似的可视化和洞察（见[图 3-22](#fig-0322)）：
- en: '[PRE24]'
  id: totrans-247
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'There are two general observations we can make from these plots:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从这些图表中得出两个一般性观察：
- en: Time series have more than one useful set of temporal axes against which to
    plot. We used both an axis of month of the year (January through December) and
    an axis of years of the data set (the first year up through the last/twelfth year).
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间序列有多个有用的时间轴可以绘制。我们使用了一年中每个月份（一月到十二月）的轴和数据集年份（第一年至最后/第十二年）的轴。
- en: We can glean a lot of useful information and predictive details from visualizations
    that stack time series data rather than linearly plotting.
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以从堆叠时间序列数据的可视化中获取大量有用的信息和预测细节。
- en: '![](assets/ptsa_0322.png)'
  id: totrans-251
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0322.png)'
- en: Figure 3-22\. By using the monthplot() function, we can see how performance
    per month changes as the years pass.
  id: totrans-252
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-22\. 通过使用monthplot()函数，我们可以看到每月性能随着年份的变化如何变化。
- en: 'We next consider a proper two-dimensional histogram. In a time series context,
    we can think of a two-dimensional histogram as having one axis for time (or a
    proxy for time) and another axis for a unit of interest. The “stacked” plots we
    just did are well on their way to being two-dimensional histograms, but some changes
    would be helpful:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来我们考虑一个适当的二维直方图。在时间序列的背景下，我们可以将二维直方图看作一个轴表示时间（或时间的代理）和另一个轴表示兴趣单位。我们刚刚做的“堆叠”图已经在成为二维直方图的路上，但需要一些改变：
- en: We need to bin data both on the time axis and on the number of passengers.
  id: totrans-254
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要在时间轴和乘客数量上对数据进行分箱。
- en: We need more data. A 2D histogram doesn’t make sense until the stacked curves
    run into one another; they can’t properly be seen alone. Otherwise, the 2D histogram
    fails to convey any additional information.
  id: totrans-255
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们需要更多数据。在堆叠曲线相互交错之前，二维直方图没有意义；它们不能单独被正确地看到。否则，二维直方图无法传达任何额外的信息。
- en: 'We generate the 2D histogram on this small data set for illustration and then
    move on to a more meaningful example. We build our own 2D histogram function from
    scratch, like so:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这个小数据集上生成了二维直方图作为示例，然后转向更有意义的示例。我们从头开始构建我们自己的二维直方图函数，如下所示：
- en: '[PRE25]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'We make a histogram with heat map coloring, as follows:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 我们制作了一个带有热力图着色的直方图，如下所示：
- en: '[PRE26]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: However, the resulting image ([Figure 3-23](#fig-0323)) is not very satisfying.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，得到的图像（[图 3-23](#fig-0323)）并不是很令人满意。
- en: '![](assets/ptsa_0323.png)'
  id: totrans-261
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0323.png)'
- en: Figure 3-23\. Heat map constructed from our homemade 2D histogram of the AirPassengers
    data.
  id: totrans-262
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-23\. 我们自制的 AirPassengers 数据的二维直方图热力图。
- en: This plot is not useful because there is not enough data. We only have 12 curves,
    and we’ve divided them across 5 buckets. However, an even more important issue
    is that we don’t have stationary data. The use of a histogram assumes a stationary
    data set. In this case there is a trend, so although we’d like to see seasonality,
    the trend will necessarily get in the way.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 这个图表是无用的，因为数据不足。我们只有12条曲线，并将它们分成5个桶。然而，更重要的问题是我们没有稳态数据。直方图的使用假设数据集是稳态的。在这种情况下，存在趋势，因此尽管我们想看到季节性，但趋势必然会妨碍。
- en: 'Now we look at a data set that features a larger number of samples and is not
    polluted by a trend. This is a subset of the FiftyWords data set taken from the
    [UCR Time Series Classification Archive](https://perma.cc/Y982-9FPS). This data
    set includes a representation of 50 different words as recorded by a univariate
    time series, each time series being of equal length. The subset of the data used
    to plot [Figure 3-24](#fig-0324) is from the data set I used in a segment on time
    series classification in a general tutorial on the subject. You can [download
    that subset](https://oreil.ly/M6T-u), although for the purposes of this exercise
    you can use either one:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们来看一个样本数更多且没有趋势污染的数据集。这是来自 [UCR 时间序列分类存档](https://perma.cc/Y982-9FPS) 的 FiftyWords
    数据集的子集。该数据集包括 50 个不同单词的表示，每个时间序列的长度相同。用于绘制 [图 3-24](#fig-0324) 的数据子集是我在有关时间序列分类的一般教程中使用的数据集的一个片段。你可以
    [下载该子集](https://oreil.ly/M6T-u)，但是对于这个练习的目的，你可以使用任何一个：
- en: '[PRE27]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '![](assets/ptsa_0324.png)'
  id: totrans-266
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0324.png)'
- en: Figure 3-24\. Two-dimensional histogram of an audio metric for a single word.
    The left plot has a linear count scale, while the right plot has a log count scale.
  id: totrans-267
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-24\. 单词音频度量的二维直方图。左图使用线性计数尺度，而右图使用对数计数尺度。
- en: The plot on the right of [Figure 3-24](#fig-0324) looks better because the counts
    are colored according to a log transformation of the count rather than the count
    directly.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '[Figure 3-24](#fig-0324) 的右图看起来更好，因为计数根据对数变换进行了着色，而不是直接计数。'
- en: This is an application of the same idea as taking the log of a time series to
    decrease variance and to reduce the importance of, and distance between, outliers.
    Using a log transformation improves our visualization by not wasting a large portion
    of the range on the relatively sparse high-count values.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 这是与将时间序列取对数以减少方差和减少离群值的距离的相同想法的应用。使用对数变换通过不浪费相对稀疏的高计数值的大部分范围来改进我们的可视化。
- en: 'Our homemade option won’t be as visually appealing as many precanned options,
    so we should take a look at these to see what is different. To take advantage
    of the precanned solutions, we need to reshape our data because these options
    expect pairs of x-y values to be turned into a 2D histogram. Unlike our homegrown
    solution, the precanned options for 2D histograms are not designed specifically
    for time series data. They nonetheless offer excellent visualization solutions
    (see [Figure 3-25](#fig-0325)):'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 我们自制的选项不会像许多预制选项那样视觉上吸引人，所以我们应该看看它们有何不同。为了利用这些预制解决方案，我们需要重新调整数据，因为这些选项期望将 x-y
    值对转换为二维直方图。与我们的自制解决方案不同，用于二维直方图的预制选项并非专门为时间序列数据设计。尽管如此，它们仍提供了出色的可视化解决方案（见图 [Figure 3-25](#fig-0325)）：
- en: '[PRE28]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![](assets/ptsa_0325.png)'
  id: totrans-272
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0325.png)'
- en: Figure 3-25\. An alternative 2D histogram visualization of the same data.
  id: totrans-273
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-25\. 同一数据的替代二维直方图可视化。
- en: 3D Visualizations
  id: totrans-274
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3D 可视化
- en: 3D visualizations do not come with base R, but there are many packages available
    for them. Here I present some fast plots made with `plotly`, which I chose because
    it produces plots that can be easily rotated in RStudio and exported to web interfaces.
    Also, downloading and installing `plotly` tends to be straightforward, which is
    not true of all visualization packages.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 3D 可视化并不随 base R 附带，但有许多可用的包。这里我展示了一些用 `plotly` 制作的快速图，我选择它是因为它生成的图可以在 RStudio
    中轻松旋转并导出到 Web 界面。而且，下载和安装 `plotly` 通常很简单，这在所有可视化包中并非如此。
- en: 'Let’s consider the `AirPassengers` data. We plot it in three dimensions, using
    two dimensions for time (month and year) and one dimension for data values:'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们考虑`AirPassengers`数据。我们将其绘制在三维空间中，使用两个维度表示时间（月份和年份），一个维度表示数据值：
- en: '[PRE29]'
  id: totrans-277
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: This 3D visualization helps us get a sense of the overall shape of the data.
    We have seen much of this before, but expanding to a three-dimensional scatter
    plot proves to be notably better than a two-dimensional histogram, perhaps because
    of the paucity of the data (see Figures [3-26](#fig-0326) and [3-27](#fig-0327)).
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 这种三维可视化帮助我们感受数据的整体形状。我们之前见过很多类似的内容，但扩展到三维散点图明显比二维直方图更好，也许是因为数据的稀缺性（参见图 [3-26](#fig-0326)
    和 [3-27](#fig-0327)）。
- en: '![](assets/ptsa_0326.png)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0326.png)'
- en: Figure 3-26\. A 3D scatterplot of the AirPassenger data. This perspective highlights
    the seasonality.^([6](ch03.html#idm45576043162200))
  id: totrans-280
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-26\. AirPassenger 数据的三维散点图。这个视角突出了季节性。^([6](ch03.html#idm45576043162200))
- en: '![](assets/ptsa_0327.png)'
  id: totrans-281
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0327.png)'
- en: Figure 3-27\. Another perspective on the same data more clearly illustrates
    the increasing trend from one year to the next. I highly recommend running the
    code on your own computer, where you can rotate it yourself.^([7](ch03.html#idm45576043158648))
  id: totrans-282
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-27\. 同一数据的另一视角更清晰地说明了从一年到下一年的增长趋势。我强烈建议在您自己的计算机上运行这段代码，您可以自行旋转它。^([7](ch03.html#idm45576043158648))
- en: 'We do not necessarily need to expend two axes on time. Instead, we might use
    two axes for location and one for time. We can visualize a two-dimensional random
    walk as follows, with a lightly modified example of some `plotly` demonstration
    code (see Figures [3-28](#fig-0328) and [3-29](#fig-0329)):'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 我们并不一定需要在时间上耗费两个轴。相反，我们可能会用两个轴表示位置，一个轴表示时间。我们可以如下方式可视化二维随机漫步，稍微修改了 `plotly`
    的演示代码（见图 [3-28](#fig-0328) 和 [3-29](#fig-0329)）：
- en: '[PRE30]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: The interactive nature of the plot is key. Different perspectives can be misleading
    or illuminating in ways we can’t know until we are able to rotate the data.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 图的交互性质是关键。不同的视角可能会误导或启示我们，这些效果在我们能够旋转数据之前是无法预知的。
- en: '![](assets/ptsa_0328.png)'
  id: totrans-286
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0328.png)'
- en: Figure 3-28\. One perspective on a two-dimensional random walk over time.
  id: totrans-287
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-28\. 关于二维随机漫步随时间变化的一个视角。
- en: '![](assets/ptsa_0329.png)'
  id: totrans-288
  prefs: []
  type: TYPE_IMG
  zh: '![](assets/ptsa_0329.png)'
- en: Figure 3-29\. This perspective of the same random walk is much more revealing.
    Again, I encourage you to try this code out for yourself!
  id: totrans-289
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-29\. 同一个随机漫步的这一视角更加具有启发性。再次鼓励您自己尝试这段代码！
- en: A good exercise would be to generate noisy seasonal motion data in two dimensions
    and visualize this in the same way we have visualized the random walk here. There
    should be a substantial difference in what you see in that plot compared to the
    random walk data. Packages like `plotly` can help you experiment quickly and with
    comprehensive visual feedback.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 一个很好的练习是生成两维中嘈杂的季节性运动数据，并以我们在这里可视化随机漫步数据的方式进行可视化。在您看到的图中，与随机漫步数据相比应该有显著的差异。像
    `plotly` 这样的包可以帮助您快速实验，并提供全面的视觉反馈。
- en: More Resources
  id: totrans-291
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 更多资源：
- en: 'On spurious correlations:'
  id: totrans-292
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于虚假相关：
- en: Ai Deng, [“A Primer on Spurious Statistical Significance in Time Series Regressions,”](https://perma.cc/9CQR-RWHC)
    *Economics Committee Newsletter* 14, no. 1 (2015), https://perma.cc/9CQR-RWHC.
  id: totrans-293
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Ai Deng, [“时间序列回归中虚假统计显著性的初步介绍,”](https://perma.cc/9CQR-RWHC) *《经济委员会通讯》* 14,
    第 1期 (2015), https://perma.cc/9CQR-RWHC。
- en: This industry write-up of what spurious correlations are and how they appear
    in data is useful for developing some practical insights into when and where to
    look for this problem in your own data sets. The material is written at a very
    approachable level.
  id: totrans-294
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这篇关于虚假相关的行业介绍解释了数据中的虚假相关是如何出现的，对于在自己的数据集中找到和解决这个问题有很大帮助。这些材料写作水平非常容易理解。
- en: 'Tyler Vigen, [*Spurious Correlations*](https://perma.cc/YY6R-SKWA) (New York:
    Hachette, 2015), https://perma.cc/YY6R-SKWA.'
  id: totrans-295
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Tyler Vigen, [*《虚假相关》*](https://perma.cc/YY6R-SKWA) (纽约: 哈赤特出版社, 2015), https://perma.cc/YY6R-SKWA。'
- en: This collection of ridiculous time series correlations is essential reading
    for any time series analyst or thinking person.
  id: totrans-296
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这本记录荒谬时间序列相关性的集合对于任何时间序列分析师或思考的人都是必读。
- en: 'Antonio Noriega and Daniel Ventosa-Santaulària, [“Spurious Regression Under
    Broken-Trend Stationarity,”](https://perma.cc/V993-SF4F) *Journal of Time Series
    Analysis* 27, no. 5 (2006): 671–84, https://perma.cc/V993-SF4F.'
  id: totrans-297
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Antonio Noriega 和 Daniel Ventosa-Santaulària, [“在破碎趋势稳定性下的虚假回归,”](https://perma.cc/V993-SF4F)
    *《时间序列分析杂志》* 27, 第 5期 (2006): 671–84, https://perma.cc/V993-SF4F。'
- en: The authors develop both theory and simulation data to show that shifts in the
    level or trend of independently and randomly generated data sets influence the
    presence of spurious correlations.
  id: totrans-298
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 作者们通过理论和模拟数据展示，独立和随机生成的数据集水平或趋势变化如何影响虚假相关的存在。
- en: 'C.W.J. Granger and P. Newbold, [“Spurious Regressions in Econometrics,”](https://perma.cc/M8TE-AL6U)
    *Journal of Econometrics* 2, no. 2 (1974): 111–20, https://perma.cc/M8TE-AL6U.'
  id: totrans-299
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'C.W.J. Granger 和 P. Newbold, [“计量经济学中的虚假回归,”](https://perma.cc/M8TE-AL6U) *《经济计量学杂志》*
    2, 第 2期 (1974): 111–20, https://perma.cc/M8TE-AL6U。'
- en: This econometrics article led to a Nobel Prize for identifying the difficulties
    inherent in dealing with spurious correlations and arguing for a more robust approach
    to identifying related time series.
  id: totrans-300
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这篇计量经济学文章因揭示处理虚假相关困难而获得了诺贝尔奖，并主张对相关时间序列的更强健方法。
- en: 'On exploratory data analysis:'
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于探索性数据分析：
- en: 'David R. Brillinger and Mark A. Finney, [“An Exploratory Data Analysis of the
    Temperature Fluctuations in a Spreading Fire,”](https://perma.cc/QB3D-APKM) *Environmetrics*
    25, no. 6 (2014): 443–53, https://perma.cc/QB3D-APKM.'
  id: totrans-302
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'David R. Brillinger 和 Mark A. Finney, [“一个关于蔓延火灾中温度波动的探索性数据分析,”](https://perma.cc/QB3D-APKM)
    *《环境计量学》* 25, 第 6期 (2014): 443–53, https://perma.cc/QB3D-APKM。'
- en: This is a very thorough example of how some real-world laboratory data with
    a geotemporal grid was analyzed by academic and government researchers.
  id: totrans-303
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这是一篇非常详尽的示例，展示了学术界和政府研究人员如何分析具有地理时间网格的真实世界实验室数据。
- en: 'Robert H. Shumway and David S. Stoffer, [“Time Series Regression and Exploratory
    Data Analysis,”](https://perma.cc/UC5B-TPVS) in *Time Series Analysis and Its
    Applications with R Examples* (New York: Springer, 2011), https://perma.cc/UC5B-TPVS.'
  id: totrans-304
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Robert H. Shumway 和 David S. Stoffer, [“时间序列回归与探索性数据分析,”](https://perma.cc/UC5B-TPVS)
    收录于 *《带有 R 示例的时间序列分析及其应用》* (纽约: 斯普林格, 2011), https://perma.cc/UC5B-TPVS。'
- en: This is a chapter on exploratory data analysis from the authors’ canonical treatise
    on time series analysis for graduate students.
  id: totrans-305
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这是作者针对研究生的时间序列分析的经典著作中关于探索性数据分析的章节。
- en: 'More visualizations:'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更多可视化：
- en: Christian Tominski and Wolfgang Aigner, [“The TimeViz Browser,”](https://perma.cc/94ND-6ZA5)
    https://perma.cc/94ND-6ZA5.
  id: totrans-307
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Christian Tominski 和 Wolfgang Aigner, [“TimeViz 浏览器,”](https://perma.cc/94ND-6ZA5)
    https://perma.cc/94ND-6ZA5。
- en: This stunning catalog shows examples of, and source code for, many interesting
    time series visualizations from both academic research papers and industry use
    cases.
  id: totrans-308
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这个惊人的目录展示了学术研究论文和行业使用案例中许多有趣的时间序列可视化的示例和源代码。
- en: Oscar Perpiñán Lamigueiro, [“GitHub Repository for Displaying Time Series, Spatial,
    and Space-time Data with R,”](https://perma.cc/R69Y-5JPL) https://perma.cc/R69Y-5JPL.
  id: totrans-309
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Oscar Perpiñán Lamigueiro, [“GitHub 仓库，用于展示 R 中的时间序列、空间和时空数据,”](https://perma.cc/R69Y-5JPL)
    https://perma.cc/R69Y-5JPL。
- en: This includes source code for a variety of R-based time series visualizations,
    including geospatial time series data.
  id: totrans-310
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这本书包括了基于 R 的各种时间序列可视化的源代码，包括地理空间时间序列数据。
- en: Myles Harrison, [“5 Ways to Do 2D Histograms in R,”](https://perma.cc/ZCX9-FQQY)
    R-bloggers, September 1, 2014, https://perma.cc/ZCX9-FQQY.
  id: totrans-311
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Myles Harrison，《“R语言中进行二维直方图的5种方法”》，R-bloggers，2014年9月1日，https://perma.cc/ZCX9-FQQY。
- en: This is a practical guide to a variety of options offered by R packages to construct
    2D histograms and give them meaningful coloring and binning. In addition to a
    basic overview, a [related segment](https://edav.info/tidyquant.html) also provides
    a walkthrough of the `tidyquant` package for visualizing stock market data, an
    important source of time series.
  id: totrans-312
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这是一本实用指南，介绍了R包提供的各种选项来构建二维直方图，并赋予它们有意义的颜色和分箱。除了基本概述外，[相关段落](https://edav.info/tidyquant.html)还提供了关于`tidyquant`包的详细说明，用于可视化股市数据，这是时间序列的重要来源。
- en: 'On assorted trends:'
  id: totrans-313
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各种趋势上：
- en: Halbert White and Clive W.J. Granger, [“Considerations of Trends in Time Series,”](https://perma.cc/WF2H-TVTL)
    *Journal of Time Series Econometrics* 3, no. 1 (2011), https://perma.cc/WF2H-TVTL.
  id: totrans-314
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Halbert White 和 Clive W.J. Granger，《“时间序列趋势的考量”》，《时间序列计量经济学杂志》3卷1期（2011年），https://perma.cc/WF2H-TVTL。
- en: This recent academic article points out that while trends are ubiquitous in
    data, even traditional statistics does not have a definitive set of definitions
    for describing different kinds of trends in data. In an approachable style, the
    authors offer statistical insights into different ways that nonstationary data
    may have an underlying trend and guidance on how to improve statistical methods
    for data.
  id: totrans-315
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这篇最新的学术文章指出，尽管趋势在数据中无处不在，甚至传统统计学对于描述数据中不同种类趋势的定义也并没有明确定义。作者以一种易于理解的方式，提供了关于非平稳数据可能具有潜在趋势的统计洞见，并指导如何改进数据的统计方法。
- en: ^([1](ch03.html#idm45576047241848-marker)) If this doesn’t ring a bell, don’t
    worry about it. You can read more in [“More Resources”](#more-resources-03), should
    you wish to pursue the topic.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: ^([1](ch03.html#idm45576047241848-marker)) 如果这对你没有印象，别担心。如果你希望深入了解，可以在[“更多资源”](#more-resources-03)中阅读更多内容。
- en: ^([2](ch03.html#idm45576047229944-marker)) A given sample time series process
    produced by a random walk can appear to have a trend, and this inspires much debate,
    particularly in analyses of stock-price time series.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: ^([2](ch03.html#idm45576047229944-marker)) 由随机漫步生成的给定样本时间序列过程可能看起来有趋势，这在分析股票价格时间序列时特别引起了许多争论。
- en: ^([3](ch03.html#idm45576045555496-marker)) Sample correlations calculated with
    R’s `cor()` function versus with R’s `acf()` function will not match exactly because
    they use different divisors. For more information, see [StackExchange](https://perma.cc/M7V6-HN5Y).
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: ^([3](ch03.html#idm45576045555496-marker)) 使用R的`cor()`函数计算的样本相关性与使用R的`acf()`函数计算的样本自相关性可能不完全匹配，因为它们使用不同的除数。欲了解更多信息，请参阅[StackExchange](https://perma.cc/M7V6-HN5Y)。
- en: ^([4](ch03.html#idm45576044554168-marker)) Visit the [GitHub repository](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)
    to view the original figure, or plot it yourself for a more detailed look.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: ^([4](ch03.html#idm45576044554168-marker)) 访问[GitHub仓库](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)查看原始图表，或自行绘制以获取更详细的查看。
- en: ^([5](ch03.html#idm45576044167112-marker)) Visit the [GitHub repository](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)
    to view the original figure, or plot it yourself for a more detailed look.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: ^([5](ch03.html#idm45576044167112-marker)) 访问[GitHub仓库](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)查看原始图表，或自行绘制以获取更详细的查看。
- en: ^([6](ch03.html#idm45576043162200-marker)) Visit the [GitHub repository](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)
    to view the original figure, or plot it yourself for a more detailed look.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: ^([6](ch03.html#idm45576043162200-marker)) 访问[GitHub仓库](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)查看原始图表，或自行绘制以获取更详细的查看。
- en: ^([7](ch03.html#idm45576043158648-marker)) Visit the [GitHub repository](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)
    to view the original figure, or plot it yourself for a more detailed look.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: ^([7](ch03.html#idm45576043158648-marker)) 访问[GitHub仓库](https://github.com/PracticalTimeSeriesAnalysis/BookRepo)查看原始图表，或自行绘制以获取更详细的查看。
