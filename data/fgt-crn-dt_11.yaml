- en: 8 Forecasting churn
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 8 预测流失
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Predicting the probability of customer churn with logistic regression
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用逻辑回归预测客户流失的概率
- en: Understanding the relative influence of different behaviors on churn
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解不同行为对流失的相对影响
- en: Checking the calibration of your forecasts
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查你预测的校准情况
- en: Using churn forecasts to estimate customer lifetime and lifetime value
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用客户流失预测来估算客户生命周期和生命周期价值
- en: 'At this point, you know all the steps necessary to analyze churn and to design
    great customer metrics. Those metrics will allow businesspeople to make targeted
    interventions that should reduce the churn on their product. And those things
    are the most important for most products, so that’s why the techniques beginning
    in this chapter (part 3 of the book) can be considered to be special or extra
    tactics: you can use them if you need to, but they are not always necessary. The
    most important thing in fighting churn is that the business should make data-driven
    decisions when segmenting customers and making targeted interventions.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你已经知道了分析流失和设计优秀客户指标所需的所有步骤。这些指标将允许商业人士进行有针对性的干预，以减少他们产品的流失。对于大多数产品来说，这些事情是最重要的，这就是为什么从本章（本书的第三部分）开始的技术可以被认为是特殊或额外策略：如果你需要，你可以使用它们，但它们并不总是必要的。在对抗流失的最重要的事情是，在细分客户和进行有针对性的干预时，业务应该基于数据驱动决策。
- en: This chapter is devoted to the topic of forecasting how likely customers are
    to churn, given the combination of all their behaviors. So far, I have showed
    you only how to evaluate customer health, one behavior at a time, by looking at
    churn rates in metric cohorts. But how do you integrate these multiple views of
    the customer? What if a customer is in a top cohort with a low churn risk for
    one behavior but in one of the bottom cohorts with a much higher churn risk for
    another behavior? Given the usual correlations between customer behaviors, what
    I’ve described is an edge case, but it still would be good to know how to handle
    it.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本章致力于预测客户流失的可能性，这是基于所有行为的组合。到目前为止，我已向你展示了如何通过查看队列图中的流失率来一次评估一个客户行为，以评估客户健康。但如何整合这些多个客户视角？如果一个客户在一个行为低流失风险的高队列中，但在另一个行为高流失风险的低队列中，该怎么办？考虑到客户行为之间的通常相关性，我所描述的是一个边缘情况，但了解如何处理它仍然是有益的。
- en: A related question that would be good to know the answer to is which behavior
    makes the most difference for customer health and churn. The relative importance
    of different behaviors can be an important piece of information in deciding which
    churn-reducing interventions or product modifications to pursue. So far, you know
    only how to look at this information qualitatively by comparing the relationships
    in cohort plots. That approach can work for a few metrics (or groups of metrics),
    but if you have a lot of metrics, you need a more systematic approach. This chapter
    teaches you how to use the statistical model known as logistic regression to answer
    these questions.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 一个值得了解答案的相关问题是哪种行为对客户健康和流失影响最大。不同行为的相对重要性在决定追求哪些减少流失的干预措施或产品修改时可能是一个重要的信息点。到目前为止，你只知道如何通过比较队列图中的关系来定性分析这些信息。这种方法适用于少数指标（或指标组），但如果你有很多指标，你需要一个更系统的方法。本章将教你如何使用被称为逻辑回归的统计模型来回答这些问题。
- en: DEFINITION Logistic regression is a statistical model that forecasts the probability
    of an event occurring, given multiple factors that can influence the outcome.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 定义 逻辑回归是一个统计模型，它根据可能影响结果的多因素预测事件发生的概率。
- en: 'Logistic regression is frequently used to evaluate medical data to discover
    the cause of disease. It is appropriate for churn because you are discovering
    the causes of good and bad customer health. Because logistic regression is the
    only regression model covered in this book, I sometimes use the term regression
    for short. This chapter is designed as follows:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归经常用于评估医疗数据以发现疾病的原因。它适用于流失，因为你正在发现良好和不良客户健康的原因。因为逻辑回归是本书中唯一涵盖的回归模型，所以我有时会简称为回归。本章的设计如下：
- en: The first section (section 8.1) shows you the concepts behind logistic regression.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一部分（第8.1节）展示了逻辑回归背后的概念。
- en: Section 8.2 reviews all the data-preparation steps that you have used throughout
    the book to make sure you are ready to run the logistic regression algorithm.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第8.2节回顾了你在整本书中使用的所有数据准备步骤，以确保你准备好运行逻辑回归算法。
- en: Section 8.3 shows you how to run the regression algorithm and interpret the
    results.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第8.3节向您展示如何运行回归算法并解释结果。
- en: Section 8.4 teaches you how to make forecasts using the model you created.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第8.4节教您如何使用您创建的模型进行预测。
- en: Section 8.5 explains some pitfalls and problems you may encounter along the
    way.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第8.5节解释了您在过程中可能遇到的一些陷阱和问题。
- en: The final section (section 8.6) is devoted to customer lifetime estimation and
    measuring customer lifetime value, which are derived from churn probability forecasts.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后一个部分（第8.6节）致力于客户生命周期估计和衡量客户生命周期价值，这些都是从客户流失概率预测中得出的。
- en: 8.1 Forecasting churn with a model
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.1 使用模型进行客户流失预测
- en: I start with a summary of the theory of logistic regression for readers who
    are not familiar with it. The explanations are for the specific case of predicting
    churn and retention.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 对于不熟悉逻辑回归理论的读者，我将从逻辑回归理论概述开始。这些解释是针对预测流失和保留的具体案例。
- en: 8.1.1 Probability forecasts with a model
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.1.1 使用模型进行概率预测
- en: 'When I talk about a customer churn- or retention-probability forecast, I am
    talking about an estimate that is made individually for each customer, like a
    metric. But unlike a metric, a churn-probability forecast is not a measurement
    of something that happened: it’s an estimate of the probability that something
    will happen in the future, namely, churn.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 当我提到客户流失或保留概率预测时，我指的是为每个客户单独做出的估计，就像一个指标。但与指标不同，流失概率预测不是对已经发生的事情的测量：它是对未来可能发生的事情的概率估计，即流失。
- en: DEFINITION A churn probability forecast for a customer is a prediction that
    if you have a cohort of customers with that same forecast, you expect the percentage
    given by the probability to churn. A churn probability forecast never tells you
    whether a single customer definitively will or won’t churn.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 定义 对于客户的流失概率预测是指，如果您有一个具有相同预测的客户群体，您期望根据概率给出的百分比流失。流失概率预测永远不会告诉您单个客户是否一定会流失或不会流失。
- en: Given that the forecast is specific to an individual customer, like a metric,
    it is a bit counterintuitive that the definition of the forecast probability is
    not about whether the individual customer will be retained or will churn. Understand
    that for an individual customer, things can always go either way. Although I won’t
    mention this fact most of the time, a time horizon is implied in the forecast.
    To be precise, the forecast is the probability a customer will churn during the
    lead time before their next renewal (defined in chapter 4). This timing is implied
    because that is how the historical dataset was designed, and that dataset will
    be used to determine the forecast.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 由于预测是针对特定客户的，就像一个指标一样，预测概率的定义并不是关于单个客户是否会保留或流失，这有点反直觉。理解对于单个客户来说，事情总是可能向两个方向发展。尽管我大多数时候不会提到这个事实，但预测中隐含了一个时间范围。更准确地说，预测是客户在下次续订前（在第4章中定义）的领先时间内流失的概率。这种时间范围是隐含的，因为历史数据集就是这样设计的，而这个数据集将被用来确定预测。
- en: 'A forecast is a statement about how a group of similar customers would behave.
    Even if a customer is forecast to have a 99% chance to churn, it doesn’t mean
    that they will definitely churn. It means that in a group of 100 such customers,
    you expect 99 to churn during the lead time before their next renewal. The point
    is that if you are looking at an individual customer, that customer may turn out
    to be the one who stays. (If you forecast a 99% chance of churn, there may be
    problems with your data; see section 8.5.) The same applies for retention: if
    you forecast a retention probability, and you have a hypothetical cohort of customers
    with a 90% retention probability, you expect 90% of the cohort to be retained.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 预测是对一组相似客户行为的陈述。即使预测一个客户有99%的流失概率，这并不意味着他们一定会流失。这意味着在100个这样的客户群体中，您预计有99个在下次续订前的领先时间内会流失。重点是，如果您关注的是单个客户，这个客户可能最终会留下来。（如果您预测99%的流失概率，您的数据可能存在问题；参见第8.5节。）同样的情况也适用于保留：如果您预测保留概率，并且您有一个假设的客户群体，其保留概率为90%，您预计该群体中有90%的客户会保留。
- en: I’m going to teach you everything in terms of forecasting retention probabilities
    because that context is easier to understand. Churn probabilities will be found
    from 100% minus the retention probability. I’ll point out why forecasting retention
    is easier in section 8.1.2.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我将用预测保留概率的术语来教您所有内容，因为这种背景更容易理解。客户流失概率将从100%减去保留概率得出。我将在第8.1.2节中指出为什么预测保留率更容易。
- en: 'You’re going to learn to make forecasts with a mathematical forecasting model:
    logistic regression. A model in this context means something that works like the
    real thing, but I want to caution you against thinking that the model is real.
    The model assumes that customer engagement and retention work a certain way, but
    it does so because the assumptions work for the purpose of forecasting, not because
    the world is that way. Suspend your disbelief. Remember that the model is a construct
    that closely matches reality, but not every part of it is real, and not every
    part needs to be perfect for the model as a whole to be useful.'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 你将学习如何使用数学预测模型进行预测：逻辑回归。在这个背景下，模型意味着像真实事物一样工作，但我想要警告你不要认为模型是真实的。模型假设客户参与度和留存率以某种方式工作，但它这样做是因为这些假设适用于预测的目的，而不是因为世界就是那样的。不要怀疑。记住，模型是一个与现实紧密匹配的构造，但它的每一部分并不都是真实的，而且不是每一部分都需要完美，整个模型才有用。
- en: 8.1.2 Engagement and retention probability
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.1.2 参与度和留存率概率
- en: The first concept of logistic regression in forecasting retention is that increasing
    customer engagement leads to increasing chance of retention. By engagement, I
    mean a subjective state that cannot be measured. Different people have different
    ideas, but following is my working definition of engagement.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归在预测留存率中的第一个概念是，增加客户参与度会导致留存概率的增加。我所说的参与度是一种无法衡量的主观状态。不同的人有不同的想法，但以下是我对参与度的操作定义。
- en: DEFINITION Engagement is a state of involvement and commitment.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 定义：参与度是一种参与和承诺的状态。
- en: For this discussion, involvement means use of the product, and commitment means
    likelihood of renewal. It makes sense that more engagement should lead to a higher
    chance of retention. For now, don’t worry that engagement itself is a subjective
    state.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在这次讨论中，参与度意味着产品的使用，承诺意味着续订的可能性。更多的参与度应该导致更高的留存率是有道理的。现在，不要担心参与度本身是一个主观状态。
- en: 'A key feature of the model for forecasting churn and retention is that the
    relationship between engagement and retention is subject to diminishing returns
    on the effect of the engagement. Even the most engaged customer has a chance of
    churning. A consequence (or requirement) is that the more engaged a customer is,
    the less difference additional engagement makes in further increasing retention
    probability. The converse should also be true: the less engaged a customer is,
    the less likely they are to be retained. But even the least-engaged customers
    still have a chance of being retained. Also, the less engaged a customer is, the
    less difference further decreases in engagement make in the probability of retention.
    Figure 8.1 illustrates this concept.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 预测流失和留存的关键特征是，参与度和留存率之间的关系受到参与度效应递减的影响。即使是最活跃的客户也有可能流失。一个后果（或要求）是，客户越活跃，额外的参与度对进一步增加留存概率的影响就越小。相反也应该是真的：客户越不活跃，他们被留存的概率就越低。但即使是最不活跃的客户仍然有被留存的可能。此外，客户越不活跃，进一步减少参与度对留存概率的影响就越小。图8.1说明了这个概念。
- en: The diminishing relationship between engagement and retention at both the high
    and low ends makes an S curve like the one shown in figure 8.1\. The rate of change
    of the probability must peak in the middle ranges of engagement and flatten at
    the extremes.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在参与度和留存率的高端和低端之间的递减关系形成了一个类似于图8.1所示的S曲线。参与度中间范围的概率变化率必须达到峰值，而在极端情况下则趋于平坦。
- en: '![](../Images/8-01.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![图8.1](../Images/8-01.png)'
- en: Figure 8.1 Mapping engagement to retention with an S curve
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.1 使用S曲线映射参与度到留存率
- en: 8.1.3 Engagement and customer behavior
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.1.3 参与度和客户行为
- en: 'In my explanation of the relationship between engagement and retention, I spoke
    of a customer’s engagement as though it were measurable, like any other behavioral
    metric. That definition is a good one for a model because the way I framed it,
    engagement is the underlying driver of retention and churn. But engagement still
    is not measurable. Logistic regression solves the problem this way: you believe
    that engagement exists, even if you cannot measure it, so you assume that engagement
    can be estimated from behavioral measurements and churn observations.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在我解释参与度和留存率之间的关系时，我把客户的参与度比作其他任何行为指标一样，是可以衡量的。这个定义对于模型来说很好，因为按照我的框架，参与度是留存和流失的潜在驱动因素。但参与度仍然不可衡量。逻辑回归就是这样解决这个问题的：你相信参与度存在，即使你不能衡量它，所以你假设参与度可以从行为测量和流失观察中估计出来。
- en: TAKEAWAY Customer engagement cannot be measured directly, but you can estimate
    it from customer metrics for the purpose of predicting churn probability by matching
    the observed churn with the S curve.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 客户参与度无法直接测量，但你可以通过匹配观察到的流失与S曲线来预测流失概率，从客户指标中估算它。
- en: If that explanation seems like circular reasoning, you have to accept that it
    is a model; you’ll see in a moment that it works. The process of estimating churn
    and retention probabilities has intermediate steps for estimating engagement for
    each customer. The model assumes that engagement measurement takes a form like
    a metric score. Engagement estimates will be numbers, mostly in the range of -4
    to 4, and the average engagement of your customers will be set at zero. As in
    a metric score, a positive number means above-average engagement, and a negative
    number means below-average engagement. This definition is arbitrary, given that
    you can’t measure engagement, but it is convenient for making forecasts.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这个解释看起来像是循环推理，你必须接受它是一个模型；你很快就会看到它是有效的。估算客户流失和保留概率的过程包括估算每个客户参与度的中间步骤。模型假设参与度测量采取类似于指标得分的形式。参与度估算将是数字，大多数在-4到4的范围内，并且客户的平均参与度将被设定为零。就像指标得分一样，正数表示高于平均的参与度，而负数表示低于平均的参与度。这个定义是任意的，因为你无法测量参与度，但它对于做出预测是方便的。
- en: Figure 8.2 illustrates the model for estimating engagement from behavior and
    turning it into a retention-probability estimate. The key concept is that each
    behavioral metric score is multiplied by an engagement strength, which I call
    a weight, that captures how much the behavior contributes to engagement. The weight
    can also be negative, indicating that the behavior is associated with disengagement
    and an increase in churn rather than retention. Overall engagement is the sum
    of the contribution of each behavior.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.2说明了从行为估算参与度并将其转换为保留概率估算的模型。关键概念是每个行为指标得分乘以一个参与度强度，我称之为权重，它捕捉了行为对参与度的贡献程度。权重也可以是负数，表示该行为与脱钩和增加的流失而不是保留相关。整体参与度是每个行为的贡献之和。
- en: TAKEAWAY Customer engagement is estimated from a model in which engagement weights
    are multiplied by the scores for each metric and then added together.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 客户参与度是通过一个模型估算的，该模型将参与度权重乘以每个指标的得分，然后将它们加在一起。
- en: 'The forecasting model in figure 8.2 consists of the following steps:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.2中的预测模型包括以下步骤：
- en: Begin with scores for all your metrics.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从所有指标的得分开始。
- en: Assume that each metric has a weight that represents how strongly the values
    of the metric score contribute to engagement.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设每个指标都有一个权重，表示指标得分值对参与度的贡献强度。
- en: The engagement contribution of each metric score is the engagement weight for
    that metric multiplied by the score value.
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个指标得分的参与度贡献是该指标参与度权重乘以得分值。
- en: The total engagement estimate is the sum of all the contributions from each
    metric.
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总参与度估算是从每个指标的所有贡献中求和。
- en: After calculating the total engagement, get the retention probability by applying
    the S curve to the engagement estimate.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在计算出总参与度后，通过应用S曲线到参与度估算来获取保留概率。
- en: '![](../Images/8-02.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-02.png)'
- en: Figure 8.2 Estimating engagement and churn probability from metrics
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.2 从指标估算参与度和流失概率
- en: The weights are also referred to as coefficients because a coefficient is a
    number that multiplies another number. The Python packages use the term coefficient,
    but I prefer weight because it is a more functional description (keeping with
    the goal of communicating with businesspeople in plain English).
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 这些权重也被称为系数，因为系数是一个乘以另一个数的数字。Python 包使用术语系数，但我更喜欢权重，因为它是一个更功能性的描述（与与商人用普通英语交流的目标保持一致）。
- en: This approach of estimating engagement from behavior sidesteps the problem that
    engagement can’t be measured by assuming engagement follows a simple model. But
    a new problem is that you don’t know what the engagement weight of your various
    metrics ought to be. I suggest that you replace one thing you can’t measure—the
    level of engagement of a customer—with another thing that you can’t measure—the
    engagement weights of behaviors.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 这种从行为估算参与度的方法绕过了参与度无法测量的问题，假设参与度遵循一个简单的模型。但新的问题是，你不知道你的各种指标的参与度权重应该是多少。我建议你用一个你无法测量的东西来替换另一个你无法测量的东西——行为的参与度权重。
- en: If this approach seems like cheating, I want to remind you (again) that this
    scenario isn’t real; it’s a model that’s going to work as though it’s real. The
    problem of finding the engagement weights is solved by the logistic regression
    algorithm itself (see section 8.3). But before you learn how to run the algorithm
    and find the weights, you need to learn more about matching the prediction model
    to the details of your data. Section 8.1.4 shows how the regression model exactly
    fits the churn rate of your customers.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这种方法看起来像是作弊，我想再次提醒你（再次）这种情况并不是真实的；这是一个将要像真实情况一样工作的模型。寻找参与度权重的问题是由逻辑回归算法本身解决的（见第8.3节）。但在你学习如何运行算法并找到权重之前，你需要更多地了解如何将预测模型与你的数据细节相匹配。第8.1.4节展示了回归模型如何精确地匹配客户的流失率。
- en: 8.1.4 An offset matches observed churn rates to the S curve
  id: totrans-51
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.1.4 偏移量匹配观察到的流失率到S曲线
- en: One important detail to understand about the model is how the S curve can match
    products with a particular churn rate. First, recall that the average on each
    metric score is 0 because that’s how the metric scores were defined. As a result,
    a perfectly average user has zero engagement in the model. Because engagement
    comes from multiplying weights by scores, and all the scores are 0, the engagement
    must also be zero. Figure 8.3 illustrates this concept.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 关于模型的一个重要细节是了解S曲线如何匹配具有特定流失率的产品。首先，回忆一下，每个指标的平均值是0，因为这就是指标得分是如何定义的。因此，一个完全平均的用户在模型中具有零参与度。因为参与度是通过将权重乘以得分得到的，而所有得分都是0，所以参与度也必须是零。图8.3说明了这个概念。
- en: As shown in the figure, a default version of an S curve would match 0 engagement
    with 50% retention probability (and 50% churn probability) because it is defined
    symmetrically. But that result would be correct only if the average user of a
    product really had a 50% retention probability. There has to be a way to adjust
    the model so that an average user has a realistic probability forecast for retention
    and churn.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 如图中所示，S曲线的默认版本将与0参与度匹配50%的保留概率（以及50%的流失概率），因为它是对称定义的。但这个结果只有在产品的平均用户真的有50%的保留概率时才是正确的。必须有一种方法来调整模型，以便平均用户有一个现实的保留和流失概率预测。
- en: The solution to this problem comes from another feature of the model. The S
    relationship between engagement and retention probability can include an offset
    so that an average user maps to an average probability of retention. The offset
    means that the S curve is shifted to the left or right relative to the default.
    The offset is also referred to as an intercept because the offset determines where
    the S curve intersects the zero engagement line. (Intercept means the value at
    an intersection. The Python packages use the term intercept, but I use offset
    because it describes what the quantity does, not only what it is.)
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这个问题的解决方案来自模型的一个另一个特性。参与度和保留概率之间的S关系可以包括一个偏移量，以便平均用户映射到平均保留概率。偏移量意味着S曲线相对于默认值向左或向右移动。偏移量也被称为截距，因为偏移量决定了S曲线与零参与度线的交点。（截距意味着交点的值。Python包使用截距这个术语，但我使用偏移量，因为它描述了这个数量做什么，而不仅仅是它是什么。）
- en: In figure 8.3, it is assumed that the retention probability is around 90%. In
    that case, the S curve must be offset by around 2 so that a user with 0 (average)
    engagement ends up with a retention probability forecast around 90%.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在图8.3中，假设保留概率约为90%。在这种情况下，S曲线必须偏移约2，以便具有0（平均）参与度的用户最终具有约90%的保留概率预测。
- en: TAKEAWAY The logistic regression model includes an offset that allows a standard
    S curve to match any average retention probability.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 逻辑回归模型包含一个偏移量，允许标准的S曲线匹配任何平均保留概率。
- en: '![](../Images/8-03.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8-03.png)'
- en: Figure 8.3 An offset matches the S curve to the average retention probability
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.3 偏移量匹配S曲线到平均保留概率
- en: Once again, you may be wondering how to come up with the correct value for this
    new variable. This problem is also taken care of by the logistic regression algorithm.
    Together, the engagement weights and the S-curve offset are the main outputs of
    the algorithm, and that’s all you need to make a realistic churn- and retention-probability
    forecast for your customers.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 再次提醒，你可能想知道如何得出这个新变量的正确值。这个问题也由逻辑回归算法解决。因此，参与度权重和S曲线偏移量是算法的主要输出，这就是你为客户做出现实的流失和保留概率预测所需的所有内容。
- en: 8.1.5 The logistic regression probability calculation
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.1.5 逻辑回归概率计算
- en: Now that I’ve explained all the concepts, I will show you the set of equations
    that define the mathematical model. Like the rest of the math in this book, this
    math is designed to help the mathematically inclined in their understanding. If
    that’s not you, don’t worry. If you have understood the concepts explained up
    to now, you’ll be ready to do your forecasting whether or not you study the equations
    in this section.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我已经解释了所有概念，我将向你展示定义数学模型的方程组。像这本书中的其他数学一样，这个数学是为了帮助有数学倾向的人理解而设计的。如果你不是这样的人，不要担心。如果你已经理解了到目前为止解释的概念，无论你是否研究本节中的方程，你都将准备好进行预测。
- en: 'These equations use vectors, in the sense of a list of numbers, to represent
    the metrics and the engagement weights. A bar above the variable indicates that
    it is a vector, so I will use ![](../Images/macron_m.png) to stand for the vector
    of all the metric scores for one account and ![](../Images/macron_w.png) to represent
    the vector of all the engagement weights. In that case, the engagement (*E*) of
    an account is given by equation 8.1:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这些方程使用向量（即数字列表）来表示指标和参与度权重。变量上方的横线表示它是一个向量，因此我将使用 ![图片](../Images/macron_m.png)
    来表示一个账户所有指标分数的向量，以及 ![图片](../Images/macron_w.png) 来表示所有参与度权重的向量。在这种情况下，账户的参与度
    (*E*) 由方程式 8.1 给出：
- en: '| ![](../Images/8-03_E01.png)  | Equation 8.1 |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| ![图片](../Images/8-03_E01.png)  | 方程式 8.1 |'
- en: The dot (·) indicates the dot product operation, which is the element-by-element
    multiplication of the two vectors followed by the summing of the results of those
    multiplications. The dot product is the procedure that I described when explaining
    how the metric scores are combined with the engagement weights to get the total
    engagement for an account. Given the engagement, the rest of the model for the
    retention probability, P, is
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 点（·）表示点积运算，它是两个向量元素逐个相乘后的结果求和。点积是我在解释如何将指标分数与参与度权重结合以获得账户的总参与度时描述的过程。给定参与度，保留概率
    P 的模型其余部分为
- en: '| ![](../Images/8-03_E02.png)  | Equation 8.2 |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| ![图片](../Images/8-03_E02.png)  | 方程式 8.2 |'
- en: 'where *E* is the engagement, off is the offset, and *S*(...) is the S-curve
    function. The S-curve function referenced in equation 8.2 is given by equation
    8.3:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *E* 代表参与度，off 代表偏移量，*S*(...) 代表 S 曲线函数。方程式 8.2 中引用的 S 曲线函数由方程式 8.3 给出：
- en: '| ![](../Images/8-03_E03.png)  | Equation 8.3 |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| ![图片](../Images/8-03_E03.png)  | 方程式 8.3 |'
- en: 'Note that the little *e* in equation 8.3 stands for the number known as the
    base of the natural logarithm, or *e* ≈ 2.72\. But you don’t need to learn what
    the natural logarithm is to understand equation 8.3\. To understand it, first
    remember the following facts about exponentiation (or taking a number to a power):'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，方程式 8.3 中的小 *e* 代表自然对数的底数，即 *e* ≈ 2.72。但你不需要学习自然对数是什么就能理解方程式 8.3。要理解它，首先记住以下关于指数化（或取数的幂）的事实：
- en: For any positive number greater than 1.0, if you exponentiate it with a positive
    value, it gets bigger. (The only thing you need to know about *e* is that it is
    a positive number greater than 1.0.)
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于任何大于 1.0 的正数，如果你用正数来指数化它，它会变得更大。（关于 *e* 你需要知道的是，它是一个大于 1.0 的正数。）
- en: 'If you exponentiate such a number with a negative value, it gets smaller because
    exponentiation with a negative value is 1 divided by the number exponentiated
    with a positive power: *x*^(*−y*) = 1.0/*x*^(*y*).'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你用负数来指数化这样一个数，它会变得更小，因为用负数指数化等于用正数指数化的数的倒数：*x*^(*−y*) = 1.0/*x*^(*y*).
- en: 'In equation 8.3, *x* represents the engagement plus the offset, and *x* has
    a negative sign on the variable for the exponentiation of e. The negative sign
    reverses the usual effect of exponentiation so that when *x* gets bigger, the
    *e* term gets smaller, and when *x* is negative, the *e* term gets bigger. As
    a result:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在方程式 8.3 中，*x* 代表参与度加上偏移量，*x* 在 e 的指数化变量上有负号。负号反转了指数化的通常效果，使得当 *x* 变大时，*e* 项变小，而当
    *x* 为负时，*e* 项变大。因此：
- en: When *x* (engagement) is positive and the *e* term is small, the denominator
    gets close to 1 and the fraction also goes toward 1, which corresponds to retention
    going to 100% when engagement is high.
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当 *x*（参与度）为正且 *e* 项较小时，分母接近 1，分数也趋向于 1，这对应于当参与度高时保留率达到 100%。
- en: When *x* (engagement) is negative and the *e* term is large, the denominator
    gets large and the fraction goes toward 0, which corresponds to retention going
    to 0% when engagement is low.
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当*x*（参与度）为负且*e*项较大时，分母会变得很大，分数趋向于0，这对应于参与度低时保留率趋向于0%。
- en: Understanding equation 8.3 doesn’t have anything to do with using *e* and natural
    logarithms. There is a reason why equation 8.3 uses the base of the natural logarithm
    and not some other number, and that reason has to do with technical details in
    the logistic regression algorithm, not because it is necessary to produce the
    S curve.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 理解方程8.3与使用*e*和自然对数无关。方程8.3使用自然对数的底而不是其他数字的原因，与逻辑回归算法中的技术细节有关，而不是因为它有必要产生S曲线。
- en: This section completes the explanation of the model for churn-probability forecasting
    going from metric scores to forecasting retention probabilities. The next thing
    you need to know is how to come up with the engagement weights for the metrics
    and the offset to use in the S curve. That task is handled by the logistic regression
    algorithm when you run it on your data.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 本节完成了从指标分数到预测保留概率的模型解释，从指标分数到预测保留概率。接下来你需要知道的是如何为指标制定参与度权重以及用于S曲线的偏移量。当你对你的数据运行逻辑回归算法时，这项任务由逻辑回归算法处理。
- en: 8.2 Reviewing data preparation
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.2 数据准备回顾
- en: Before I show you the details of running the logistic regression algorithm,
    let’s review all the steps that you took to produce the data. This review will
    ensure that your data is ready for what comes next, and having these steps fresh
    in your mind will help you when it comes time to make your probability forecasts.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在我向你展示运行逻辑回归算法的细节之前，让我们回顾一下你为生成数据所采取的所有步骤。这次回顾将确保你的数据为接下来的步骤做好准备，并且这些步骤在你的脑海中保持清晰将有助于你在进行概率预测时。
- en: 'The first step in preparation is exporting a slightly modified version of the
    dataset. In chapter 7, you experimented with a few versions of the metric for
    the rare event unfriend_per_month. To avoid confusion, you will now export a version
    of the dataset that has only the final scaled version of the unfriend_per_month
    metric. In a case study of a real company, you will also experiment with different
    metric versions and then choose a subset for your dataset. This final dataset
    also omits the account_tenure measurement. In a real service, you should include
    account_tenure in your analysis, but it is not meaningful for the simulation.
    Because you have already seen the dataset export several times (in listings 4.5,
    4.6, and 7.2), I do not present this SQL in the book. The code is in the chapter
    8 listings folder, if you want to take a look. To match the results presented
    in this chapter, you should extract the new version of the dataset with the following
    command line for the Python wrapper program:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 准备的第一步是导出数据集的一个略微修改的版本。在第7章中，你尝试了几种针对罕见事件每月取消好友数的指标版本。为了避免混淆，你现在将导出一个只包含每月取消好友数最终缩放版本的指标数据集版本。在一个真实公司的案例研究中，你也会尝试不同的指标版本，然后为你的数据集选择一个子集。这个最终的数据集还省略了账户期限的测量。在真实服务中，你应该在分析中包含账户期限，但在模拟中它没有意义。因为你已经多次看到数据集的导出（在第4.5、4.6和7.2的列表中），所以我不会在书中展示这个SQL。代码在第8章的列表文件夹中，如果你想查看的话。为了匹配本章中展示的结果，你应该使用以下命令行提取数据集的新版本，用于Python包装程序：
- en: '[PRE0]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Figure 8.4 shows a summary of all the functions used to prepare the data after
    it is exported from the database. The steps are as follows:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.4显示了从数据库导出后的数据准备所使用的所有函数的总结。步骤如下：
- en: Calculate a set of summary statistics about the data. Those summary statistics
    are saved in a table (listing 5.2).
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算关于数据的一组汇总统计。这些汇总统计保存在一个表中（列表5.2）。
- en: Use the summary statistics to convert the metrics from their natural scale to
    scores. This step saves the second version of the dataset and another table of
    the mean and standard deviations used to create the scores, as well as the metrics
    transformed for skew and fat tails (listing 7.5).
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用汇总统计将指标从它们的自然尺度转换为分数。这一步保存了数据集的第二版本，以及用于创建分数的均值和标准差表，以及用于偏斜和厚尾的转换指标（列表7.5）。
- en: Find correlated metrics that are combined in groups, and save a loading matrix
    that explains the groupings. This matrix is used to implement the averaging of
    scores (listing 6.4).
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到组合在一起的关联指标，并保存一个解释分组的加载矩阵。这个矩阵用于实现分数的平均（列表6.4）。
- en: Use the loading matrix to create the third and final version of a dataset in
    which correlated metric scores are averaged (listing 6.3; I taught this before
    listing 6.4 so that you would understand what the loading matrix was before you
    set out to create one).
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用加载矩阵创建第三个也是最终的版本的数据集，其中相关的指标分数被平均（列表6.3；我在列表6.4之前讲解了这一点，以便你在创建加载矩阵之前理解它）。
- en: '![](../Images/8-04.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8-04.png)'
- en: Figure 8.4 Data preparation steps for churn analysis and forecasting
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.4展示了流失率分析和预测的数据准备步骤
- en: 'Listing 8.1 shows all the steps in the data preparation, and you can use listing
    8.1 to prepare your own data if you have not taken all these steps already. Chapter
    7 did not explicitly tell you to rerun your statistics, scores, or grouping. If
    you were following the instructions as they were given, this listing is for you.
    Running listing 8.1 creates several items in your output directory: two additional
    versions of the dataset, and three tables of statistics and derived parameters
    used in the process.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.1显示了数据准备的所有步骤，如果你还没有完成所有这些步骤，你可以使用列表8.1来准备自己的数据。第七章没有明确告诉你重新运行你的统计数据、分数或分组。如果你按照给出的指示执行，这个列表就是为你准备的。运行列表8.1会在你的输出目录中创建几个项目：数据集的两个额外版本，以及三个在过程中使用的统计数据和导出参数的表格。
- en: Listing 8.1 Data preparation listings combined
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.1 数据准备列表合并
- en: '[PRE1]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: ① Finds the average, skew, and percentiles of the distribution
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: ① 找出分布的平均值、偏度和分位数
- en: ② Converts the data from metrics to scores
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: ② 将数据从指标转换为分数
- en: ③ Finds what metrics are correlated, and decides which to group
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 找出哪些指标是相关的，并决定哪些要分组
- en: ④ Creates a dataset with grouped metrics averaged together
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 创建一个将分组指标平均在一起的数据集
- en: 'If you have not performed all these steps, run listing 8.1 with the Python
    wrapper program and these arguments:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你还没有执行所有这些步骤，请使用Python包装程序和以下参数运行列表8.1：
- en: '[PRE2]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: When you learned about advanced metrics in chapter 7, the focus was on the motivation
    and code for the new metrics and testing the relationships to churn. I never demonstrated
    the final result for correlations and metric groups with all the chapter 7 metrics
    using the techniques of chapter 6\. Figure 8.5 shows the result you should have
    for the loading matrix, which summarizes the grouping.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在第七章学习高级指标时，重点是新的指标动机和代码以及测试与流失率的关系。我从未使用第七章的技术展示过所有第七章指标的相关性和指标组的最终结果。图8.5显示了加载矩阵的结果，它总结了分组。
- en: '![](../Images/8-05.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8-05.png)'
- en: Figure 8.5 Result of running the metric grouping algorithm (listing 6.4) on
    the simulation dataset with the additional metrics created in chapter 7
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.5展示了在第七章创建的附加指标上运行指标分组算法（列表6.4）的模拟数据集的结果
- en: 'If you run the metric grouping algorithm on the dataset from chapter 7 with
    the default parameters, you should find two multimetric groups, with several metrics
    remaining independent. The first metric group consists of three metrics representing
    the most common behaviors: posting, liking, and viewing ads. The second group
    averages the metrics for messaging, including replies. The metrics that were not
    correlated enough to go into groups were the metric for unfriending, the advanced
    metrics for adviews_per_post, days_since_new_friend, and the percentage change
    in the rate of new friend events.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用默认参数在第七章的数据集上运行指标分组算法，你应该找到两个多指标组，其中一些指标保持独立。第一个指标组包括三个代表最常见行为的指标：发帖、点赞和查看广告。第二个组平均了包括回复在内的消息指标。那些相关性不足以进入组别的指标是取消好友关系的指标、广告点击数/帖子的高级指标、新朋友天数和新增朋友事件率的变化百分比。
- en: If running your code returned something that looks like figure 8.5, you are
    ready to run the examples of logistic regression in section 8.3.1\. If you have
    something else, the most likely explanation is that you did not create all the
    new metrics in chapter 7\. To make sure that you have all the metrics, you can
    use the following two sets of arguments to run the Python wrapper program and
    generate them now.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行你的代码返回的结果看起来像图8.5，那么你就可以运行第8.3.1节中的逻辑回归示例了。如果你得到的是其他结果，最可能的原因是你没有在第七章中创建所有新的指标。为了确保你拥有所有指标，你可以使用以下两组参数来运行Python包装程序并立即生成它们。
- en: 'The first run of the wrapper program creates the days_since_new_friend, newfriend_pcnt_chng,
    tenure-scaled version of unfriend_per_month, and metric for the total number of
    likes and dislikes (labeled as the number of opinions):'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 包装程序的第一次运行创建了days_since_new_friend（自新朋友以来天数）、newfriend_pcnt_chng（新朋友百分比变化）、tenure-scaled
    version of unfriend_per_month（按任期缩放的每月取消关注版本）以及表示总点赞和踩数（标记为意见数）的指标：
- en: '[PRE3]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The second command runs all the versions of the ratio metric to create the
    adview _per_post, reply_per_message, like_per_post, unfriend_per_newfriend, and
    dislike_ pcnt metrics:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 第二条命令运行所有版本的比率指标以创建adview_per_post（每篇帖子的广告查看次数）、reply_per_message（每条消息的回复次数）、like_per_post（每篇帖子的点赞次数）、unfriend_per_newfriend（每新增朋友取消关注次数）和dislike_pcnt（踩数百分比）指标：
- en: '[PRE4]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: After creating all the metrics, you should be able to run listing 8.1 and get
    the loading matrix shown in figure 8.5.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 创建所有指标后，你应该能够运行列表8.1并获取图8.5中所示的加载矩阵。
- en: 8.3 Fitting a churn model
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.3 拟合流失模型
- en: Now that your data is ready and you know how a regression forecasting model
    works, it’s time to run the algorithm that gives you the weights and the offset
    to match your data. Finding the weights and offset that match the data is called
    fitting the model.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您的数据已准备就绪，您也知道了回归预测模型的工作原理，现在是时候运行算法以获得匹配您数据的权重和偏移量。找到匹配数据的权重和偏移量被称为拟合模型。
- en: DEFINITION Fitting a statistical model means finding the values for the key
    parameters that make the model match the sample data as closely as possible. Fitting
    a model is also sometimes called training a model.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 定义：拟合统计模型意味着找到关键参数的值，使模型尽可能接近样本数据。拟合模型有时也被称为训练模型。
- en: I’ll show you how to read the results and then how to create them.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 我将向你展示如何读取结果，然后如何创建它们。
- en: 8.3.1 Results of logistic regression
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.1 逻辑回归结果
- en: 'Figure 8.6 shows the weights and offset resulting from fitting logistic regression
    on the simulated churn dataset. (This result will be in a file after you run listing
    8.2.) Each row in the file shows the result for one metric or group of metrics.
    The result consists of the following two numbers:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6显示了在模拟流失数据集上拟合逻辑回归得到的权重和偏移量。（此结果将在您运行列表8.2后生成。）文件中的每一行都显示了一个指标或一组指标的测量结果。结果由以下两个数字组成：
- en: The engagement weight
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 参与度权重
- en: A measurement of the impact of the metric on the retention (churn) probability,
    which I call the retention impact
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对指标对保留（流失）概率的影响的测量，我称之为保留影响
- en: 'The engagement weights are small numbers, typically less than 1, as I suggested
    earlier. That makes sense, because the multiplication of the engagement weights
    and the metric scores is going to add up to the total engagement, which has a
    scale similar to a score. A positive weight indicates that the metric (or group)
    is associated with increasing engagement, and a negative weight indicates that
    the metric is associated with reduced retention (increased churn). For this reason,
    setting up the model to predict retention makes it easier to interpret: a positive
    number to represent something good is more intuitive than a negative number, and
    if you had set up the model to predict churn, all the things that increase engagement
    would have had negative weights.'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 参与度权重是小的数字，通常小于1，正如我之前所建议的。这很有道理，因为参与度权重和指标得分的乘积将加起来等于总参与度，其规模类似于得分。正权重表示指标（或组）与增加的参与度相关联，而负权重表示指标与减少的保留率（增加的流失率）相关联。因此，设置模型以预测保留率使其更容易理解：表示好事的正数比负数更直观，如果你设置了模型以预测流失，所有增加参与度的东西都将有负权重。
- en: TAKEAWAY Forecasting retention probabilities is easier to interpret than forecasting
    churn probabilities because that way, positive weights in the numeric sense associate
    with positive outcomes in the sense of engagement.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 启示：预测保留概率比预测流失概率更容易理解，因为这样，数值意义上的正权重与参与度意义上的积极结果相关联。
- en: The measurement of a metric’s impact on churn is shown as a percentage change
    in the retention probability. I will show you the details of the calculation in
    a moment, but first, I will explain what it means.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 指标对流失的影响测量显示为保留概率的百分比变化。我将在稍后展示计算的细节，但首先，我将解释它的含义。
- en: DEFINITION The retention impact of a metric or group of metrics is the difference
    that it makes to the retention probability for a customer to be one standard deviation
    above the average in this metric, assuming that all the other metrics are exactly
    average.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义**：一个指标或一组指标的保留影响是指它使客户在这个指标上比平均值高出一个标准差时，保留概率的差异，假设所有其他指标都是平均的。'
- en: If the retention impact for a metric is 2%, a customer who is one standard deviation
    above average on that metric and average in all the other metrics has a forecast
    retention probability 2% higher than the average retention probability. That probability
    is 2% less than the average churn probability, so you can describe it either way,
    as long as you keep track of the direction of the impact. The churn impact is
    not a standard metric taught in statistics classes, but I have found it useful
    in explaining logistic regression models to businesspeople.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一个指标的保留影响是2%，那么在一个指标上比平均值高出一个标准差且在其他所有指标上平均的客户，其预测保留概率比平均保留概率高2%。这个概率比平均流失概率低2%，所以你可以用任何一种方式描述它，只要你能跟踪影响的方向。流失影响不是统计学课程中教授的标准指标，但我发现它在向商业人士解释逻辑回归模型时很有用。
- en: TAKEAWAY The impact of a metric on retention and churn probability is important
    for communicating regression results to businesspeople.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点**：一个指标对保留和流失概率的影响对于向商业人士传达回归结果非常重要。'
- en: 'Remember two other things when you interpret churn and retention impacts:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 当你解释流失和保留影响时，请记住两件事：
- en: If a metric is below average rather than above average, it has approximately
    an equal and opposite effect on churn rate.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果一个指标低于平均值而不是高于平均值，它对流失率的影响大约是相等且相反的。
- en: 'The cumulative effect of multiple metrics that are above (or below) average
    has a diminishing effect on churn rate due to the way that the S curve shapes
    the probability forecast. The same goes for a metric that is more than one standard
    deviation above average: a metric two standard deviations above average will have
    less than two times the churn impact shown in the result.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于S曲线塑造概率预测的方式，多个高于（或低于）平均值的指标累积效应对流失率有递减的影响。对于高于平均值的指标，如果它比平均值高出超过一个标准差，那么这个指标在平均流失率上的影响将小于结果显示的两倍。
- en: 'The result for the offset is an extra row at the bottom of figure 8.6: the
    number in the weight column for the offset is not a weight but the amount of the
    offset.'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 偏移量的结果是在图8.6底部增加了一行：偏移量列中的数字不是权重，而是偏移量的数量。
- en: '![](../Images/8-06.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8-06.png)'
- en: Figure 8.6 Output of logistic regression for the simulated dataset
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6 模拟数据集的逻辑回归输出
- en: I previously suggested that the offset would be about 2 for around a 90% retention
    rate. In figure 8.6, you see an offset of 3.7 for the simulation retention rate,
    which is around 95.4%. The number in the retain_impact column for the offset is
    the retention probability forecast for a perfectly average customer. Recall that
    a perfectly average customers has zero on all the metric scores, so in equation
    8.2, for the probability (Pretain = S(E + off )), the only term is the offset.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 我之前建议，为了达到大约90%的保留率，偏移量大约为2。在图8.6中，你看到模拟保留率的偏移量为3.7，这大约是95.4%。在偏移量列中的数字是完美平均客户的保留概率预测。回想一下，一个完美平均客户在所有指标得分上都是零，所以在方程8.2中，对于概率（Pretain
    = S(E + off)），唯一的项就是偏移量。
- en: Note that the forecast probability for the perfectly average customer is 2.4%
    (100% − 97.6%, the retention rate in figure 8.6), but the churn rate in the simulation
    is around 4.6% (see chapter 5, figure 5.12). You probably would expect a perfectly
    average customer to have a churn probability equal to the overall or average churn
    rate, but this is not quite the case.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，对于完美平均客户，预测概率为2.4%（100% - 97.6%，图8.6中的保留率），但在模拟中，流失率约为4.6%（参见第5章，图5.12）。你可能预期一个完美平均客户的流失概率将与整体或平均流失率相等，但情况并非如此。
- en: NOTE The forecast churn probability for a perfectly average customer normally
    is close to the overall churn rate but not equal to it.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**：对于完美平均客户的预测流失概率通常接近整体流失率，但不等于它。'
- en: 'Here is how the churn impact is calculated. If a customer is perfectly average,
    they have zero in all scores, and the probability of retention becomes equal to
    equation 8.4:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 这是计算流失影响的方法。如果一个客户是完美平均的，他们在所有得分上都是零，保留的概率将等于方程8.4：
- en: '| ![](../Images/8-06_E04.png)  | Equation 8.4 |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/8-06_E04.png)  | 方程8.4 |'
- en: 'On the other hand, if a customer is perfectly average in all respects except
    for being one standard deviation above average on a single metric or group, the
    multiplication of the weights by the scores reduces to exactly the weight for
    the one score on which they are one standard deviation above average. In that
    case, if the variable w stands for the value of the one weight in the engagement
    equation, equation 8.4 leads to equation 8.5:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，如果一个客户在所有方面都完全平均，除了在单个指标或组上比平均水平高一个标准偏差，那么权重与分数的乘积将正好等于他们在比平均水平高一个标准偏差的那个分数上的权重。在这种情况下，如果变量w代表参与方程中一个权重的值，方程8.4将导致方程8.5：
- en: '| ![](../Images/8-06_E05.png)  | Equation 8.5 |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/8-06_E05.png)  | 方程8.5 |'
- en: The churn impact is calculated as the difference between equation 8.4 and 8.5
    for each engagement weight.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 活跃度影响是通过计算每个参与权重方程8.4和8.5之间的差异来计算的。
- en: 8.3.2 Logistic regression code
  id: totrans-134
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.2 逻辑回归代码
- en: 'Listing 8.2 provides the code for logistic regression analysis. This listing
    is a lot more than simply fitting the regression, which is only two lines. The
    rest of the code prepares the data, does some analysis of the result, and saves
    everything. The listing is divided into seven functions, described here in the
    order in which they are called:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.2提供了逻辑回归分析的代码。这个列表远不止拟合回归，这只有两行。其余的代码准备数据，对结果进行一些分析，并保存一切。列表分为七个函数，按它们被调用的顺序描述如下：
- en: '`logistic_regression_analysis` (the main function) —After calling a helper
    function to create the data, the function creates the `sklearn` `LogisticRegression`
    object and calls the `fit` method to run the model fitting. Then it calls more
    helper functions to analyze and save the results.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`logistic_regression_analysis`（主函数）—在调用辅助函数创建数据后，该函数创建`sklearn`的`LogisticRegression`对象，并调用`fit`方法来运行模型拟合。然后它调用更多的辅助函数来分析和保存结果。'
- en: '`prepare_data`—The function loads the saved dataset of grouped scores and separates
    the columns indicating churn. The churn indicator is reversed so that it indicates
    retention. Using the grouped scores is an option controlled by a default argument
    because (in chapter 9) it is used to load other files.'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`prepare_data`—该函数加载保存的分组分数数据集，并分离表示活跃度的列。活跃度指示器被反转，以便表示保留。使用分组分数是一个由默认参数控制的选项，因为（在第九章中）它用于加载其他文件。'
- en: '`save_regression_summary`—The function makes a `DataFrame` where one column
    is the regression model weights and offset, and the other column is the one standard
    deviation impact. Note that this method (and the following two) have an optional
    extension argument that is used to save additional versions in chapter 9; this
    is the table of data illustrated in figure 8.6\. It calls `calculate_impacts`
    to get the churn impact numbers and then takes the weights from the `LogisticRegression`
    object; these values are stored in a field called `coef_`. (`coef` is short for
    coefficient, which is a generic term for a number that multiplies another number.)
    These results are combined with the names of metrics and groups in a `DataFrame`
    and then saved.'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`save_regression_summary`—该函数创建一个`DataFrame`，其中一列是回归模型权重和偏移量，另一列是标准偏差影响。请注意，此方法（以及接下来的两个方法）有一个可选的扩展参数，用于在第九章中保存额外的版本；这是图8.6所示的数据表。它调用`calculate_impacts`来获取活跃度影响数值，然后从`LogisticRegression`对象中获取权重；这些值存储在一个名为`coef_`的字段中。（`coef`是系数的简称，它是一个乘以另一个数的通用术语。）然后将这些结果与度量指标和组的名称结合在一个`DataFrame`中，然后保存。'
- en: '`calculate_impacts`—This function calculates the impact of a one standard deviation
    score on the retention probability, using the equations described earlier. It
    calls the `s_curve` function on the offset, which is the variable `intercept_`
    of the regression object, to get the baseline retention probability. It also calls
    the `s_curve` function on the difference between the offset and the weights, which
    is stored in the variable `coef_` of the regression object. The result of the
    function is both the vector of retention impacts and the baseline retention probability.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`calculate_impacts`—此函数使用前面描述的方程计算一个标准偏差分数对保留概率的影响。它调用偏移量的`s_curve`函数，偏移量是回归对象的变量`intercept_`，以获取基线保留概率。它还调用偏移量和权重之间的差异的`s_curve`函数，该差异存储在回归对象的变量`coef_`中。该函数的结果是保留影响的向量以及基线保留概率。'
- en: '`s_curve`—This function implements equation 8.2.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`s_curve`—此函数实现了方程8.2。'
- en: '`save_regression_model`—This function saves the regression object to a pickle
    file so that it can be reloaded and used to forecast later.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`save_regression_model`—此函数将回归对象保存到pickle文件中，以便可以重新加载并用于以后的预测。'
- en: '`save_dataset_predictions`—This function calculates what the churn and retention
    probabilities would have been on the observations in the dataset used to create
    the model. It calls the `predict_proba` function on the regression object with
    the dataset as the parameter. The results are saved in a .csv file, which is explained
    further in section 8.3.5.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`save_dataset_predictions`—此函数计算在创建模型所使用的数据集中的观测值上的流失和保留概率。它使用数据集作为参数在回归对象上调用`predict_proba`函数。结果保存在一个.csv文件中，在第8.3.5节中进一步解释。'
- en: 'You should run listing 8.2, using the Python wrapper program in the usual way
    with these arguments:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该以常规方式使用Python包装程序运行列表8.2，并使用这些参数：
- en: '[PRE5]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The program prints a few lines of output telling you where it saved the three
    results, which are
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 程序会打印几行输出，告诉你它保存了三个结果的位置，它们是
- en: The file containing the weights and one standard deviation impact
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含权重和一个标准差影响的文件
- en: The file containing the pickle of the model
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含模型pickle的文件
- en: The file containing the historical churn and retention probabilities
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包含历史流失和保留概率的文件
- en: You should open the summary file, churnsim_logreg_summary.csv, and confirm that
    it is similar to figure 8.5\. It won’t be exactly the same because the data is
    randomly simulated. I talk more about the results in the historical probability
    file in section 8.3.5 and how to use the pickle file in section 8.4.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该打开汇总文件，churnsim_logreg_summary.csv，并确认它与图8.5相似。由于数据是随机模拟的，所以不会完全相同。我在第8.3.5节中更多地讨论了结果，以及如何在第8.4节中使用pickle文件。
- en: Listing 8.2 Logistic regression analysis
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.2逻辑回归分析
- en: '[PRE6]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: ① Calls the helper function prepare_data
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: ① 调用辅助函数`prepare_data`
- en: ② Creates the object for the right kind of regression
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: ② 创建适合回归类型的对象
- en: ③ Fits the model coefficients based on the churn data
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 根据流失数据拟合模型系数
- en: ④ Calls save_regression _summary to save a summary of the result
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 调用`save_regression_summary`以保存结果的摘要
- en: ⑤ Calls save_regression_model to save the regression object
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 调用`save_regression_model`以保存回归对象
- en: ⑥ Calls save_dataset_predictions to make predictions
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 调用`save_dataset_predictions`以进行预测
- en: ⑦ Puts data into the form needed for the regression
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 将数据放入回归所需的形式
- en: ⑧ Loads the dataset, setting the index
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 加载数据集，设置索引
- en: ⑨ Separates the outcome and converts it to True for retention
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 分离结果并将其转换为True以保留
- en: ⑩ Separates the metrics
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ 分离指标
- en: ⑪ The impact of being one standard deviation above average
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: ⑪ 平均值以上一个标准差的冲击影响
- en: ⑫ The churn of a perfectly average customer
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: ⑫ 完美平均客户的流失率
- en: ⑬ For every coefficient, calculates the impact
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: ⑬ 对于每个系数，计算其影响
- en: ⑭ Impact is probability difference for one standard deviation above average.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: ⑭ 影响是平均值以上一个标准差的概率差异。
- en: ⑮ Reuses the metrics in each group in the summary
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: ⑮ 在摘要中的每个组中重用指标
- en: ⑯ Creates a DataFrame combining the results
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: ⑯ 创建一个结合结果的DataFrame
- en: ⑰ Saves the object by pickling it
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: ⑰ 通过pickle保存对象
- en: ⑱ predict_proba predicts both churn and retention
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: ⑱ `predict_proba`预测流失和保留
- en: ⑲ Makes a new DataFrame and saves the predictions
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: ⑲ 创建新的DataFrame并保存预测
- en: The `LogisticRegression` object in listing 8.2 takes a few parameters. `fit_intercept
    =True` tells the logistic regression that you are going to include an offset in
    the model. It’s optional because there are other uses of logistic regression in
    which you would not include an offset. The other parameters, `solver='liblinear'`
    and `penalty='l1'`, control what method is used to find the weights and the offset.
    You can use different methods to fit the model, but this book focuses on the application
    of logistic regression to fighting churn (and I won’t go into details). These
    parameters correspond to the method known as ridge regression (also known as Tikhonov
    regularization), and it is easy to find additional explanations of this in statistics
    textbooks or online.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.2中的`LogisticRegression`对象需要几个参数。`fit_intercept=True`告诉逻辑回归你将在模型中包含一个偏置。这是可选的，因为逻辑回归还有其他用途，你不会包含偏置。其他参数`solver='liblinear'`和`penalty='l1'`控制了用于找到权重和偏置的方法。你可以使用不同的方法来拟合模型，但本书侧重于逻辑回归在对抗流失（
    churn）中的应用（我不会深入细节）。这些参数对应于称为岭回归（也称为Tikhonov正则化）的方法，你可以在统计学教科书或网上找到更多关于它的解释。
- en: DEFINITION Ridge regression is a modern method of fitting regression parameters
    that performs well when many metrics can have correlation.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** 岭回归是一种现代的回归参数拟合方法，当许多指标可以相互关联时表现良好。'
- en: The fact that ridge regression works well when a large number of metrics can
    be somewhat correlated makes it suitable for the typical data used for customer
    churn. You learn more about ridge regression and the parameters for the `LogisticRegression`
    object in chapter 9\. But first, let’s talk about how to explain the regression
    results to your business colleagues.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 当有大量指标可以相互关联时，岭回归表现良好，这使得它适用于典型的客户流失数据。你可以在第9章中了解更多关于岭回归和`LogisticRegression`对象参数的信息。但首先，让我们谈谈如何向你的商业同事解释回归结果。
- en: 8.3.3 Explaining logistic regression results
  id: totrans-174
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.3 解释逻辑回归结果
- en: The regression result shows you which metric or group of related metrics has
    the biggest impact on churn and retention. This finding is an important one to
    share with your business colleagues because it is an objective estimate of what
    behaviors or aspects of the product cause the most engagement (and disengagement)
    with your customers. The results for both the weight estimate and the retention
    probability impact show the relative importance; both tell the same story about
    what has the biggest impact. This result is illustrated in figure 8.7, which shows
    the weights and impact on retention ordered from most positive for retention to
    most negative for retention.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 回归结果展示了哪些指标或相关指标组对客户流失和留存影响最大。这一发现对于与你的商业同事分享非常重要，因为它是对导致客户（以及不参与）与你的产品互动最多的行为或产品方面的客观估计。权重估计和留存概率影响的结果显示了相对重要性；两者讲述的是同一个关于影响最大的故事。这一结果在图8.7中得到了说明，该图显示了从对留存最有利到对留存最不利的权重和留存影响排序。
- en: In figure 8.7, you can sort by either weight or retention impact, and the order
    is the same, which makes sense if you consider the shape of the S curve. More
    engagement always leads to higher retention probability, so the bigger the impact
    on engagement (which is what the weight represents), the more impact on retention
    probability.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在图8.7中，你可以按权重或留存影响排序，排序顺序相同，如果你考虑S曲线的形状，这是有意义的。更多的参与度总是导致更高的留存概率，因此对参与度的影响（即权重所代表的）越大，对留存概率的影响就越大。
- en: '![](../Images/8-07.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-07.png)'
- en: Figure 8.7 Comparison of regression coefficients and retention probability impact
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.7 回归系数与留存概率影响比较
- en: It’s important to understand the weights from the regression, but I don’t recommend
    talking about them with businesspeople. To explain the impact of the different
    behaviors on retention to your business colleagues, I recommend that you use only
    the impact on retention probability. The engagement and weights used by the regression
    are abstract concepts but don’t exist, and this can be confusing. The benefit
    of using the impact on retention probability is that the probability of retention
    is a concrete business metric that people already understand from the retention
    rate.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 理解回归中的权重很重要，但我不建议与商业人士谈论它们。为了向你的商业同事解释不同行为对留存的影响，我建议你只使用留存概率的影响。回归使用的参与度和权重是抽象概念，并不存在，这可能会造成困惑。使用留存概率影响的优点是，留存概率是一个具体的业务指标，人们已经从留存率中理解了这一点。
- en: 'Before you explain the impact of the metrics on retention and churn, you need
    to make sure that the businesspeople understand the following concepts:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在解释指标对留存和流失的影响之前，你需要确保商业人士理解以下概念：
- en: 'What a probability is and what your product’s churn and retention rates are.
    In this area particularly, make sure that people understand the following:'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 概率是什么以及你的产品的客户流失率和留存率是多少。在这个领域，特别是要确保人们理解以下内容：
- en: The churn rate is equivalent to a probability.
  id: totrans-182
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户流失率等同于一个概率。
- en: The churn and retention probabilities add up to 100%.
  id: totrans-183
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户流失率和留存概率的总和为100%。
- en: What a standard deviation is, in a general sense. Most people have heard of
    standard deviation but don’t have a concrete working knowledge of it. They need
    to understand that someone who is one standard deviation above average is noticeably
    above average but not extremely so. They also need to understand that you can
    talk about being below average in standard deviations too.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准差在一般意义上的含义。大多数人听说过标准差，但并没有具体的实际知识。他们需要理解，一个人如果比平均水平高一个标准差，就会明显高于平均水平，但并不极端。他们还需要理解，你也可以用标准差来谈论低于平均水平。
- en: 'Figure 8.8 demonstrates a good way to present this result to businesspeople:
    a bar chart. Putting the retention impact in a bar chart makes seeing the relative
    importance easy. I also recommend sorting the metrics and groups by importance
    from most positive to most negative. Label the metric groups with descriptive
    names.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.8展示了向商业人士展示这一结果的好方法：柱状图。将保留影响放入柱状图中，可以轻松地看到相对重要性。我还建议按重要性从高到低对指标和组进行排序。用描述性名称标注指标组。
- en: '![](../Images/8-08.png)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-08.png)'
- en: Figure 8.8 Bar chart explaining the impact of behaviors on churn probability
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.8 柱状图解释行为对客户流失概率的影响
- en: The reason I like to show a bar chart to businesspeople to explain retention
    probability is that a metric or behavior that is good for engagement is shown
    as a positive number, whereas a metric or behavior that is bad for engagement
    is shown as a negative number. At the same time, it’s convenient to talk in terms
    of the impact on the churn probability for individual customers. If you find that
    being one standard deviation above average in social feeds use leads to a 2% increase
    in retention probability, you’re more likely to say that it decreases a customer’s
    churn probability from 10% to 8%, rather than increasing the retention probability
    from 90% to 92%. The impact is more tangible in terms of the churn probability,
    which is a smaller number.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 我喜欢向商业人士展示柱状图来解释保留概率的原因是，对参与度有利的指标或行为显示为正数，而对参与度不利的指标或行为显示为负数。同时，用客户流失概率来谈论也很方便。如果你发现社交信息使用中高于平均水平一个标准差会导致保留概率增加2%，你更有可能说这降低了客户的流失概率从10%到8%，而不是将保留概率从90%提高到92%。在客户流失概率这个更小的数字上，影响更具体。
- en: 'After you have shown the businesspeople the bar chart demonstrating the impact
    of being above average in behavior, you should make sure to explain the following
    additional facts to them:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 在向商业人士展示了展示行为高于平均水平影响的柱状图后，你应该确保向他们解释以下额外的事实：
- en: Being below average has approximately the equal and opposite effect as being
    above average. It’s not exactly equal and opposite, but the relative impact of
    the different metrics will be the same.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 低于平均水平的效果与高于平均水平的效果大致相等且相反。这并不完全相等且相反，但不同指标相对影响将相同。
- en: If a customer is multiple standard deviations above average, there are diminishing
    returns, meaning that each additional standard deviation above average has less
    impact on the churn or retention probability.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果客户的标准差高于平均水平多个倍数，那么回报递减，这意味着每个额外的标准差高于平均水平对客户流失或保留概率的影响将更小。
- en: 'The same diminishing returns goes for being above average in multiple respects:
    the combined churn probability reduction will be lower than the sum of the quoted
    retention probability impacts.'
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在多个方面高于平均水平时，同样的回报递减也适用：综合流失概率降低将低于引用的保留概率影响的总和。
- en: Usually, these points cover most of the questions people have and should give
    them a good idea of how impactful the different behaviors are for retention and
    churn.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，这些点涵盖了人们的大部分疑问，并且应该给他们一个关于不同行为对保留和流失影响程度的好印象。
- en: 8.3.4 Logistic regression case study
  id: totrans-194
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.4 逻辑回归案例研究
- en: Figure 8.9 shows an example result from the logistic regression case study for
    Broadly, an SaaS product that helps businesses manage their online presence. About
    80 metrics were analyzed in the case study. The two largest groups contain about
    20 metrics each, and both groups received strong positive weights in the regression.
    Five smaller groups and nine metrics remained separate in the grouping, and some
    of those metrics appeared in earlier case studies in the book, including account_tenure,
    billing_ period, and detractor_rate.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.9展示了Broadly这个SaaS产品（帮助企业管理其在线存在）的逻辑回归案例研究的一个示例结果。案例研究中分析了大约80个指标。两个最大的组各包含约20个指标，两组在回归中都获得了强烈的正权重。五个较小的组和九个指标在分组中保持独立，其中一些指标在本书的早期案例研究中出现过，包括account_tenure（账户期限）、billing_period（账单周期）和detractor_rate（负面评价率）。
- en: As you can see in figure 8.9, a real case study can have a lot more metrics
    than a simulation. Although grouping correlated metrics may seem to be unnecessary
    in the simulation, in a real case study, it is important to group the correlated
    metrics; otherwise, the result would have too many metrics to make sense. In section
    8.4, you’ll see another way in which grouping is essential for understanding churn
    with a large number of metrics.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 如图8.9所示，一个真实的案例研究可能包含比模拟更多的指标。尽管在模拟中分组相关指标似乎是不必要的，但在真实的案例研究中，分组相关指标是很重要的；否则，结果将包含太多指标而难以理解。在第8.4节中，你将看到分组对于理解具有大量指标的流失的另一种必要性。
- en: TAKEAWAY Grouping correlated metrics helps reduce information overload when
    there are many metrics in regression analysis.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 在回归分析中有许多指标时，分组相关指标有助于减少信息过载。
- en: Another feature of the weights in the Broadly case study is that several metrics
    and groups have weights that are small, such as 0.01 or 0.03\. By comparison,
    the strongest engagement weights in the table are around 0.6, so those small weights
    are 1/20th or less of the strong metrics, which is insignificant for engagement.
    These small weights correspond to metrics where the cohort analysis would have
    shown no significant relationship to churn as well. You’re not going to use those
    kinds of metrics for segmenting your customers or making any interventions to
    reduce churn. If the small weights were removed, the result in figure 8.9 would
    be more manageable but still as meaningful. In chapter 9, you learn how to remove
    the small and insignificant weights from the regression by using a technique that
    also maximizes the accuracy of the model.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: Broadly案例研究中权重的另一个特点是，一些指标和组的权重很小，例如0.01或0.03。相比之下，表中最强的参与权重约为0.6，因此这些小权重是强大指标的1/20或更少，对参与度来说微不足道。这些小权重对应的是在群体分析中不会显示出与流失有显著关系的指标。你不会使用这类指标来细分客户或采取任何减少流失的措施。如果移除这些小权重，图8.9中的结果将更容易管理，但仍具有意义。在第9章中，你将学习如何通过使用一种同时最大化模型准确性的技术来从回归中移除小而无关的权重。
- en: '![](../Images/8-09.png)'
  id: totrans-199
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-09.png)'
- en: Figure 8.9 Example results from logistic regression for Broadly
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.9 逻辑回归对Broadly的示例结果
- en: TAKEAWAY It’s normal for many of your metrics to show relatively small engagement
    weights, and they correspond to customer metrics that are not significant for
    churn and retention.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 许多指标显示相对较小的参与权重是正常的，它们对应的是对客户流失和留存不重要的指标。
- en: If your data produces a table that looks like figure 8.9, you should definitely
    remove the low-weight metrics before you make a bar chart. Chapter 9 shows you
    the best way.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的数据生成一个类似于图8.9的表格，在制作条形图之前，你绝对应该移除低权重的指标。第9章将展示最佳方法。
- en: 8.3.5 Calibration and historical churn probabilities
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.5 校准和历史流失概率
- en: One other output from listing 8.2 is the regression analysis, which is the result
    of applying the churn probability forecast model to the dataset. This isn’t forecasting
    because there’s no point in making a forecast for something that has already happened;
    the customers represented by the dataset have already either churned or been retained.
    I will refer to these outputs for the dataset as being churn probabilities rather
    than forecasts. In any event, it’s instructive to look at this output so that
    you know what to expect when you forecast active customers.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.2的另一个输出是回归分析，这是将流失概率预测模型应用于数据集的结果。这不是预测，因为对已经发生的事情进行预测没有意义；数据集中的客户已经流失或保留。我将把这些输出称为数据集的流失概率而不是预测。无论如何，查看这个输出是有教育意义的，这样你就可以知道在预测活跃客户时可以期待什么。
- en: Figure 8.10 shows a small sample, which is like the dataset in that each row
    is for one account and one observation date. But instead of having metrics for
    the rest of the columns, the figure has one column for churn probability and one
    column for retention probability. Also, because the dataset is made up of historical
    observations, a single account can appear more than once on different dates until
    it churns.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.10显示了一个小样本，它类似于数据集，其中每一行代表一个账户和一个观测日期。但与拥有其他列的指标不同，该图有一列用于流失概率，另一列用于保留概率。此外，由于数据集由历史观测值组成，单个账户可以在不同日期上出现多次，直到它流失。
- en: '![](../Images/8-10.png)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![图8.10](../Images/8-10.png)'
- en: Figure 8.10 Historical churn probability estimates for the simulated dataset.
    The average is calculated in a spreadsheet or analysis program (not saved with
    the dataset).
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.10显示了模拟数据集的历史流失概率估计。平均值是在电子表格或分析程序中计算的（未与数据集一起保存）。
- en: These historical probabilities are also useful for checking the model. One important
    check of a forecasting model is that the forecasts it produces should correspond
    closely to the real observed churn rate from your product. This check is called
    model calibration.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 这些历史概率对于检查模型也是很有用的。预测模型的一个重要检查是它产生的预测应该与你的产品实际观察到的流失率紧密对应。这个检查被称为模型校准。
- en: DEFINITION Calibration refers to the degree of correspondence between the estimated
    probabilities of churn and retention produced by the model and the actual churn
    experienced by the customers.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: '**校准**的定义是指模型产生的估计流失和保留概率与客户实际流失程度之间的一致程度。'
- en: 'In section 8.6.2, you’ll see how to use churn-probability forecast to estimate
    customer lifetime value, which can be an important metric in deciding on interventions.
    As the name implies, customer lifetime value measures how much a customer is worth
    to you over their lifetime. The customer lifetime value estimates will be accurate
    only if the model is well calibrated. The same goes for any reasoning about the
    impacts of behaviors on churn: if the model isn’t calibrated, the retention impacts
    aren’t as useful.'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 在8.6.2节中，你将了解如何使用流失概率预测来估计客户终身价值，这在决定干预措施时可能是一个重要的指标。正如其名所示，客户终身价值衡量的是客户在其一生中对你的价值。只有当模型校准良好时，客户终身价值估计才会准确。对于任何关于行为对流失影响的分析也是如此：如果模型没有校准，保留的影响就不会那么有用。
- en: 'The most important check of calibration is that the average churn rate predicted
    by the model should match the churn rate in the data. Figure 8.11 repeats the
    churn-rate measurement for the simulated dataset, which was produced from listing
    5.2 by running the dataset summary function with the following arguments:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 校准最重要的检查是模型预测的平均流失率应该与数据中的流失率相匹配。图8.11重复了对模拟数据集的流失率测量，该数据集是通过运行数据集摘要函数并使用以下参数从列表5.2生成的：
- en: '[PRE7]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Comparing the average historical probability from figure 8.10 with the churn
    rate in figure 8.11, you can see that these figures are close, within 1/100 of
    a percentage. You should make a similar comparison with your own simulated dataset
    and with any dataset you work on for a real case study. For datasets with a reasonable
    number of observations of both churn and retention and without extreme outliers
    or missing values in the metrics, you should find that the dataset churn rate
    and the average predicted forecast are always close.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 将图8.10中的平均历史概率与图8.11中的流失率进行比较，你可以看到这些数字非常接近，在1/100的百分比范围内。你应该用你自己的模拟数据集以及你为实际案例研究工作的任何数据集进行类似的比较。对于既有流失又有保留的合理数量观测值且在指标中没有极端异常值或缺失值的数据集，你应该发现数据集的流失率和平均预测值总是非常接近。
- en: '![](../Images/8-11.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-11.png)'
- en: Figure 8.11 Historical churn probability estimates for the simulated dataset
    produced by using listing 5.2
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.11 使用列表5.2生成的模拟数据集的历史客户流失概率估计
- en: 'In figure 8.6, you saw that the churn probability of the average customer was
    2.4% (from 100% minus the retention rate, shown to be 97.6% in the figure), not
    4.6%; the average customer did not have a churn probability equal to the average
    churn rate. That’s fine. For calibration, you need the average predicted churn
    probability to match the true churn rate, but the average customer doesn’t have
    to match the average churn rate. In fact, the presence of outlier churn probabilities
    usually guarantees that the average customer will not have an average churn probability:
    the average customer usually has a churn probability that is a bit lower than
    the churn rate, as in the social network simulation.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 在图8.6中，您可以看到平均客户的流失概率为2.4%（从100%减去保留率，如图中所示为97.6%），而不是4.6%；平均客户的流失概率并不等于平均流失率。这是正常的。对于校准，您需要平均预测流失概率与实际流失率相匹配，但平均客户不必与平均流失率相匹配。事实上，异常流失概率的存在通常保证了平均客户不会有一个平均流失概率：平均客户的流失概率通常略低于流失率，就像社交网络模拟中那样。
- en: There are also more advanced ways to measure calibration. As you divided the
    customers into deciles when making churn cohort plots, for example, you can test
    calibration in deciles. With that approach, you would order the customers by the
    predicted cohort average forecast, divide them into 10 cohorts, and then check
    how the true churn rate in each cohort compares with the cohort average forecast.
    The result would tell you whether your prediction model is well calibrated to
    forecast probabilities for customers who are likely or unlikely to churn (customers
    far from the average). I don’t recommend that you do that kind of calibration
    check routinely, but this technique is a good one to be aware of.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还有更高级的方法来衡量校准。例如，当您在制作流失客户群图表时将客户分为十分位，您可以在十分位中测试校准。采用这种方法，您将按预测的客户群平均预测值对客户进行排序，将他们分为10个客户群，然后检查每个客户群的真实流失率与客户群平均预测值相比如何。结果将告诉您您的预测模型是否很好地校准，以预测可能或不可能流失的客户（远离平均值的客户）。我不建议您定期进行这种校准检查，但这项技术是您应该了解的一个好方法。
- en: You may want to check calibration with that level of detail if you are planning
    expensive interventions specifically for high- or low-churn-probability customers.
    Then it’s particularly important to know whether your model was accurate in estimating
    the churn probability for those customers. As you see in chapter 9, a model can
    still identify the most and least at-risk customers when the calibration is not
    perfect.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您计划针对高或低流失概率的客户进行昂贵干预，您可能希望检查该级别的校准。那么，了解您的模型在估计这些客户的流失概率方面是否准确尤为重要。正如您在第9章中看到的，即使校准不完美，模型仍然可以识别出最和最不具风险的客户。
- en: 'One last thing to note: calibration is only one measure of how well your model
    matches the data. Other important measures of the quality of your model are introduced
    in chapter 9.'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 最后要注意的一点是：校准只是衡量您的模型与数据匹配程度的一个指标。第9章中介绍了衡量模型质量的其他重要指标。
- en: 8.4 Forecasting churn probabilities
  id: totrans-220
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.4 预测客户流失概率
- en: Forecasting means making a prediction about something that hasn’t happened yet.
    In the context of churn, forecasting means taking all of your customers who are
    currently active and predicting their probability of churning before their next
    renewal. This section also covers how to prepare data for segmenting with grouped
    metrics, a topic that was not covered in chapter 6.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 预测意味着对尚未发生的事情进行预测。在客户流失的背景下，预测意味着收集所有当前活跃的客户，并预测他们在下一次续订之前流失的概率。本节还涵盖了如何为使用分组指标进行细分准备数据，这是第6章中没有涉及的内容。
- en: 8.4.1 Preparing the current customer dataset for forecasting
  id: totrans-222
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.4.1 为预测准备当前客户数据集
- en: The first step in forecasting for your current customers is creating a dataset
    of those customers who are active at the present time, including the most recent
    measurement of all their metrics. You saw how to do this in chapter 4 when you
    learned how to extract such a dataset for segmenting the active customers. Then,
    in chapter 7, you updated the dataset to include more metrics, so you need to
    update the code to extract the current dataset, as you updated the code to extract
    the historical dataset at the beginning of this chapter.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 预测当前客户的第一步是创建一个数据集，包括那些当前活跃的客户的最新所有指标。你在第 4 章学习如何提取这样的数据集以细分活跃客户时看到了如何做这件事。然后，在第
    7 章中，你更新了数据集以包含更多指标，因此你需要更新代码来提取当前数据集，就像你更新代码在章节开头提取历史数据集一样。
- en: Listing 8.3 provides the code to extract the dataset with all the metrics created
    in chapter 7\. This listing is almost like listing 4.6 but has more metrics. The
    short common table expression at the beginning of the query selects the most recent
    available date; then the main `SELECT` statement uses the flattening aggregation
    trick that you learned in chapter 4 (section 4.6).
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 8.3 提供了提取第 7 章中创建的所有指标的代码。这个列表几乎与列表 4.6 相同，但包含更多指标。查询开头简短公用表表达式选择最新的可用日期；然后主
    `SELECT` 语句使用你在第 4 章中（4.6 节）学到的扁平化聚合技巧。
- en: 'There is one new element in listing 8.3: the `SELECT` is limited to accounts
    with more than 14 days of tenure. The CTE `account_tenures` selects all accounts
    with at least 14 days’ tenure, and an inner join in the main `SELECT` limits the
    dataset to those customers. This constraint makes sure that customers have been
    observed for at least a few weeks before their metrics are used. Otherwise, most
    new customers will have low metrics due to the short observation period.'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 8.3 中有一个新元素：`SELECT` 限制在服务期限超过 14 天的账户。CTE `account_tenures` 选择至少有 14 天服务期限的所有账户，主
    `SELECT` 中的内部连接将数据集限制在这些客户。这个约束确保在他们的指标被使用之前，客户至少被观察了几周。否则，大多数新客户由于观察期短，指标会较低。
- en: In chapter 7, you learned that customers with short tenure can get more accurate
    first-month metric forecasts through scaling. You used that technique to make
    more accurate estimates of the rare metric unfriend_per_month. For your own case
    studies, I recommended that you use this pattern for all metrics, and in that
    case, you would match the two-week minimum for observations. (I did not ask you
    to recalculate all those metrics to save time.)
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 在第 7 章中，你了解到服务期限较短的客户可以通过缩放获得更准确的第一月指标预测。你使用这项技术来更准确地估计罕见的指标 unfriend_per_month。对于你自己的案例研究，我建议你为所有指标使用这种模式，在这种情况下，你会匹配两周的最小观察期。（我没有要求你重新计算所有这些指标以节省时间。）
- en: Listing 8.3 Revised current dataset
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 8.3 修订后的当前数据集
- en: '[PRE8]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: ① This CTE selects the most recent date.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: ① 这个 CTE 选择最新的日期。
- en: ② Selects the basic metrics with the flattening aggregation
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: ② 使用扁平化聚合选择基本指标
- en: ③ This is the scaled metric from listing 7.7.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 这是来自列表 7.7 的缩放指标。
- en: ④ This is the ratio metric from listing 7.1.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 这是来自列表 7.1 的比率指标。
- en: ⑤ This is the percentage metric from listing 7.1, version 2.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 这是来自列表 7.1 的版本 2 的百分比指标。
- en: ⑥ This is the percentage change metric from listing 7.4.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 这是来自列表 7.4 的百分比变化指标。
- en: ⑦ This is the days_since_event metric from listing 7.6.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 这是来自列表 7.6 的 days_since_event 指标。
- en: ⑧ Selects the metrics for the most recent date
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 选择最新日期的指标
- en: ⑨ JOIN on subscription to ensure only active accounts.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 通过订阅进行 JOIN 以确保只有活跃账户。
- en: ⑩ The GROUP BY aggregation completes the flattening.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ GROUP BY 聚合操作完成了数据的扁平化。
- en: 'You should run listing 8.3, using the Python wrapper program and these arguments:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该运行列表 8.3，使用 Python 包装程序和以下参数：
- en: '[PRE9]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Running listing 8.3 saves a dataset of current customers and their metrics in
    a file. This chapter doesn’t contain an example of the output because, by now,
    you know what a dataset looks like.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 运行列表 8.3 将当前客户及其指标保存到一个文件中。本章没有包含输出示例，因为到现在为止，你已经知道数据集的样子了。
- en: 'In section 8.1, you reviewed all the steps to prepare a dataset before using
    it in the regression (in particular, see figure 8.4). Those steps were as follows:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 在 8.1 节中，你回顾了在使用回归之前准备数据集的所有步骤（特别是参见图 8.4）。这些步骤如下：
- en: Calculate statistics on the dataset.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 计算数据集的统计数据。
- en: Convert metrics to scores using the statistics.
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用统计数据将指标转换为分数。
- en: Save a score parameter table summarizing the parameters used to make the scores.
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存一个参数表，总结用于制作分数的参数。
- en: Find groups using the correlation matrix, and create a loading matrix.
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用相关矩阵找到组，并创建加载矩阵。
- en: Calculate average scores for all the groups, using the loading matrix.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用加载矩阵计算所有组的平均评分。
- en: 'But there is a key difference when repeating the process for the current customer
    dataset: you don’t want to calculate new statistics to convert the metrics into
    scores. Neither do you want to create a new loading matrix to group the correlated
    metrics. For the current dataset, you want to repeat the process using the same
    statistics and loading matrix that you derived from the historical customer dataset
    when you analyzed it in chapters 5 and 6\. You have to reuse the same parameters
    and loading matrix for the current customers to ensure that every column in the
    current customer dataset that you put in the regression has the same meaning that
    the same column had in the historical dataset.'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，当重复当前客户数据集的过程时，有一个关键的区别：你不想计算新的统计数据将指标转换为评分。你也不想创建一个新的加载矩阵来分组相关的指标。对于当前数据集，你想要重复使用你在第5章和第6章分析历史客户数据集时从中得出的相同统计数据和加载矩阵的过程。你必须为当前客户重用相同的参数和加载矩阵，以确保你放入回归中的当前客户数据集中的每一列都与你放在历史数据集中的相同列具有相同的意义。
- en: 'Consider what would happen if you calculated a new loading matrix on the current
    customer dataset and found a different number of groups. That could happen if
    the current dataset metrics had correlations different from the historical dataset
    metrics. You would have no way to map the current customers’ grouped metrics to
    those that the regression expected from fitting on the historical dataset. Even
    the mean and standard deviation used for scoring should be those calculated on
    the historical data. Because the mean and standard deviation used for the scaling
    were not derived from the current customer data, for the current customer scores,
    the mean may not be exactly zero, and the standard deviation may not be exactly
    one. But this result is correct as long as those differences reflect the true
    difference between the current customers and the historical customers. The scoring
    process for the current customer dataset involves the following four steps:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑一下，如果你在当前客户数据集上计算一个新的加载矩阵，并发现不同的组数会发生什么。这可能发生在当前数据集的度量指标与历史数据集的度量指标相关性不同的情况下。你将无法将当前客户的分组度量指标映射到回归从历史数据集拟合所期望的指标。即使是用于评分的平均值和标准差也应该是在历史数据上计算得出的。因为用于缩放的均值和标准差并非来自当前客户数据，对于当前客户的评分，均值可能不是正好为零，标准差可能不是正好为一。但只要这些差异反映了当前客户与历史客户之间的真实差异，这个结果就是正确的。当前客户数据集的评分过程涉及以下四个步骤：
- en: Reload the score parameters saved from the historical customer dataset.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新加载从历史客户数据集中保存的评分参数。
- en: Convert the current customer metrics to scores, using the historical dataset
    statistics.
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用历史数据集的统计数据将当前客户指标转换为评分。
- en: Reload the loading matrix created from the historical dataset.
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新加载从历史数据集创建的加载矩阵。
- en: Calculate average group scores for the current customers, using the reloaded
    loading matrix.
  id: totrans-253
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用重新加载的加载矩阵为当前客户计算平均组评分。
- en: 'Now you can see a second reason why the listing that made the scores saved
    all those details in a table: the same information will be needed again if you
    are going to make churn and retention probability forecasts.'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以看到为什么保存评分的列表将所有这些细节都保存在表格中的第二个原因：如果你打算进行客户流失和保留概率预测，你将需要再次使用相同的信息。
- en: TAKEAWAY When you prepare the current customer dataset for forecasting, you
    need to reuse the scoring parameters and loading matrix that you created when
    you originally analyzed the historical dataset.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点**：当你为预测准备当前客户数据集时，你需要重用你在最初分析历史数据集时创建的评分参数和加载矩阵。'
- en: 'Listing 8.4 gives the code to score the current customer dataset. (Again, this
    chapter does not show an example of the output.) Because listing 8.4 has to reload
    so much data created by the earlier listings, it contains a function to reload
    an individual dataset by name and listing number. After loading the current customer
    dataset and the old score parameters and loading matrix, listing 8.4 performs
    the following main steps:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 列表8.4给出了评分当前客户数据集的代码。（同样，本章没有展示输出示例。）由于列表8.4必须重新加载由早期列表创建的大量数据，它包含一个按名称和列表编号重新加载单个数据集的功能。在加载当前客户数据集以及旧的评分参数和加载矩阵后，列表8.4执行以下主要步骤：
- en: Validates the inputs by making sure that the metric columns named in the dataset,
    score parameters, and loading matrix match. These inputs could become out of sync
    if you are iterating on creating different versions of a dataset and calculating
    statistics and different versions of the grouping.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过确保数据集、得分参数和加载矩阵中命名的度量列匹配来验证输入。如果您在创建数据集的不同版本、计算统计数据和不同版本的分组时迭代，这些输入可能会不同步。
- en: Transforms the skewed and fat-tailed columns on columns indicated in the score
    parameter table, using the transforms from listing 7.5.
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用列表 7.5 中的转换，在得分参数表中指示的列上转换偏斜和厚尾列。
- en: Subtracts the mean from the metrics and divides by the standard deviation, using
    the mean and standard deviation from the score parameter table. This task is done
    in the new helper function `score_current_data`.
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用得分参数表中的平均值和标准差从度量中减去平均值并除以标准差。此任务在新的辅助函数 `score_current_data` 中完成。
- en: Multiplies the scaled data by the loading matrix to calculate averages for the
    metric groups. This step happens in the new helper function `group_current_data`.
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将缩放后的数据乘以加载矩阵以计算度量组的平均值。此步骤发生在新的辅助函数 `group_current_data` 中。
- en: Saves the results.
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存结果。
- en: A final helper function call prepares a version of the dataset for segmenting,
    which is described after the listing.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个辅助函数调用准备了一个用于细分的数据集版本，这将在列表之后进行描述。
- en: Listing 8.4 Rescoring the current dataset
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 8.4 重新评分当前数据集
- en: '[PRE10]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: ① Imports the transform functions defined in listing 7.5
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: ① 导入列表 7.5 中定义的转换函数
- en: ② Reloads the loading matrix using reload_churn_data
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: ② 使用 reload_churn_data 重新加载加载矩阵
- en: ③ Reloads the parameters saved during scoring
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 重新加载评分期间保存的参数
- en: ④ Loads the current customer data created with listing 8.3
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 加载使用列表 8.3 创建的当前客户数据
- en: ⑤ Checks for consistency between data and scoring parameters
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 检查数据与评分参数之间的一致性
- en: ⑥ Checks for consistency between data and loading matrix
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 检查数据与加载矩阵之间的一致性
- en: ⑦ Transforms any columns that were determined to be skewed
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 转换任何被确定为偏斜的列
- en: ⑧ Transforms any columns that were determined to be fat tailed
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 转换任何被确定为厚尾的列
- en: ⑨ Makes sure the dataset columns match the score param column
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 确保数据集列与得分参数列匹配
- en: ⑩ Subtracts the mean and divides by the standard deviation
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ 从平均值中减去并除以标准差
- en: ⑪ Ensures the dataset columns match the loading matrix order
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: ⑪ 确保数据集列与加载矩阵顺序匹配
- en: ⑫ Applies the loading matrix to calculate average group scores
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: ⑫ 应用加载矩阵以计算平均组得分
- en: ⑬ Converts the result to a DataFrame
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 将结果转换为 DataFrame
- en: ⑭ Saves the result
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: ⑭ 保存结果
- en: ⑮ Determines columns for grouped metrics
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: ⑮ 确定分组度量列
- en: ⑯ Determines columns for metrics that are not grouped
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: ⑯ 确定未分组的度量列
- en: ⑰ Makes a version of the dataset for segmenting
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: ⑰ 为细分创建数据集版本
- en: ⑱ Wraps the steps to verify and load previously saved data
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: ⑱ 包装验证和加载先前保存数据的步骤
- en: ⑲ Ensures that the file exists, and prints a message if it doesn’t
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: ⑲ 确保文件存在，如果不存在则打印消息
- en: ⑳ Customer data files have two columns for the index.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: ⑳ 客户数据文件有两个索引列。
- en: 'You should run listing 8.4 in the usual way, using the Python wrapper program,
    so that you can be ready to calculate the current customer forecast for your own
    data. Here are the arguments:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 您应按常规方式运行列表 8.4，使用 Python 包装程序，以便您可以为计算您自己的当前客户预测做好准备。以下是参数：
- en: '[PRE11]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 8.4.2 Preparing the current customer data for segmenting
  id: totrans-287
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.4.2 为细分准备当前客户数据
- en: 'One subject that was not covered when you learned about grouping metrics was
    how to create a dataset of current customers with metrics grouped into average
    scores. That’s what you need to do if the businesspeople in your organization
    are going to plan interventions based on averages of metric scores. If you read
    section 8.4.1, you can see the reason why I waited to explain it until now: the
    process is not completely straightforward. Now that you have reprocessed the current
    dataset for forecasting, you can reuse the work you did there (which is why the
    technique is included in the last section of listing 8.4). But I don’t recommend
    that you use your forecasting dataset for segmenting. Rather, I recommend the
    following hybrid version of the dataset:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 在你学习关于分组度量标准时，没有涵盖的一个主题是如何创建一个将度量标准分组到平均分数中的当前客户数据集。如果你的组织中的商业人士要根据度量分数的平均值来制定干预措施，这就是你需要做的事情。如果你阅读了8.4.1节，你可以看到我为什么等到现在才解释它的原因：这个过程并不完全直接。现在你已经重新处理了当前数据集以进行预测，你可以重用你在那里所做的（这就是为什么这项技术被包括在列表8.4的最后部分）。但我不建议你使用你的预测数据集进行细分。相反，我建议以下混合版本的数据集：
- en: Use scores for all metric groups.
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用分数来衡量所有度量组。
- en: Use regular (natural scale) metrics for any metrics that were not grouped.
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用常规（自然尺度）度量标准来衡量那些未被分组的任何度量标准。
- en: The advantage of this approach is that it’s much easier for businesspeople to
    use. Groups are useful for reducing the number of metrics, and if you explained
    scores and metric groups by following my advice in chapter 6 (section 6.4), the
    businesspeople should be ready to interpret and use the metric scores and groups.
    It’s usually not easy to segment with a metric when it is not on its natural scale,
    however, so if you don’t have to convert a metric to a score for segmenting, it’s
    probably better not to.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法的优点是它对商业人士来说更容易使用。分组有助于减少度量标准的数量，如果你按照第6章（6.4节）中的建议解释了分数和度量组，那么商业人士应该准备好解释和使用度量分数和组。然而，当度量标准不在其自然尺度上时，通常很难进行细分，所以如果你不需要将度量标准转换为分数进行细分，可能更好不要这么做。
- en: Given the current dataset of metrics, the scores, and the loading matrix, the
    helper function in listing 8.4, `save_segment_data`, takes the columns for the
    groups and then adds the original unscaled metrics. The function is a few lines
    of Pandas manipulation, but it can make life much easier for your business colleagues
    who are trying to reduce churn.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 给定当前的度量标准数据集、分数和加载矩阵，列表8.4中的辅助函数`save_segment_data`获取组列，然后添加原始未缩放的度量标准。这个函数只有几行Pandas操作，但它可以大大简化试图减少客户流失的商业同事的工作。
- en: You may be thinking that for the simulated dataset that has fewer than 10 events
    and not many more metrics, the idea of using grouped metrics for segmenting doesn’t
    make much sense. Regular metrics are easier to understand, and grouping removes
    only a few metrics. For the simulated dataset, you’re probably right. But if you
    work on a product or service with dozens (or hundreds) of events and metrics,
    your business colleagues may really need to use the average scores to cut down
    on information overload from so many metrics.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会想，对于事件少于10个且度量标准不多于10个的模拟数据集，使用分组度量标准进行细分的想法并没有太多意义。常规度量标准更容易理解，分组只移除少量度量标准。对于模拟数据集，你可能是对的。但是，如果你在拥有数十（或数百）个事件和度量标准的产品或服务上工作，你的商业同事可能真的需要使用平均分数来减少来自这么多度量标准的信息过载。
- en: 8.4.3 Forecasting with a saved model
  id: totrans-294
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.4.3 使用保存的模型进行预测
- en: In this section, you’ll learn the code to make forecasts on the current customers.
    Figure 8.12 shows an example of what this output will look like. It’s similar
    to the forecast outputs for the historical customer dataset, except now, you have
    only one observation date and a single observation for every customer.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你将学习如何对当前客户进行预测。图8.12显示了这种输出将看起来像什么示例。它与历史客户数据集的预测输出类似，但现在，你只有一个观察日期，每个客户只有一个观察值。
- en: '![](../Images/8-12.png)'
  id: totrans-296
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-12.png)'
- en: Figure 8.12 Output of forecasting on the current customer dataset (listing 8.5)
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.12 当前客户数据集（列表8.5）的预测输出
- en: A second output of listing 8.5 is a visual display of the distribution of churn
    forecasts in a plot known as a histogram (figure 8.13). A histogram helps you
    visualize a distribution by dividing the distribution into ranges and showing
    the number of observations in each range with the height of a bar on the plot.
    Unlike in the cohort plots, the ranges used to divide the customer observations
    in a histogram are fixed, and the number of customers within each range varies.
    Instead of showing you the average churn rate for groups of fixed size, a histogram
    shows you the size of the group that has a particular (forecast) churn rate.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 第8.5节的第二个输出是流失预测分布的可视化显示，这种显示在图表中称为直方图（图8.13）。直方图通过将分布划分为范围并显示每个范围内观察值的数量（通过图表上条形的高度表示）来帮助可视化分布。与群体图不同，直方图中用于划分客户观察值的范围是固定的，并且每个范围内的客户数量不同。直方图不是显示固定大小群体的平均流失率，而是显示具有特定（预测）流失率的群体的大小。
- en: In figure 8.13, you can see that the range of churn forecasts with the most
    customers is between 0% and 5%. Most customers have a churn probability that is
    less than 20%, but a small number have higher churn probabilities (between 20%
    and 50%). You learned the term for the tail of a distribution when you saw fat-tailed
    distributions in chapter 7\. The narrow strip of customers with higher churn probabilities
    in figure 8.13 is referred to as the tail of the churn probability distribution.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 在图8.13中，你可以看到客户流失预测的范围在0%到5%之间，流失预测的客户最多。大多数客户的流失概率小于20%，但有一小部分客户的流失概率较高（在20%到50%之间）。你在第7章看到肥尾分布时学习了分布尾部的术语。图8.13中具有较高流失概率的客户狭窄条带被称为流失概率分布的尾部。
- en: '![](../Images/8-13.png)'
  id: totrans-300
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8-13.png)'
- en: Figure 8.13 Distribution of a simulation forecast and churn probabilities
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.13 模拟预测和客户流失概率的分布
- en: 'Listing 8.5 gives the code to make the forecast. These are the main steps:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 第8.5节提供了进行预测的代码。以下是主要步骤：
- en: Load the pickle of the logistic regression object that was saved by listing
    8.2.
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载由第8.2节保存的逻辑回归对象的pickle。
- en: Load the dataset of grouped scores for the current customers that was saved
    by listing 8.4.
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载由第8.4节保存的当前客户分组分数数据集。
- en: Call the `predict_proba` function on the logistic regression object, passing
    in the customer dataset as a NumPy `ndarray`. The result is a two-column `ndarray`
    of predictions for churn and retention probability.
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在逻辑回归对象上调用 `predict_proba` 函数，传入客户数据集作为NumPy `ndarray`。结果是关于客户流失和保留概率的两个列的 `ndarray`
    预测。
- en: Save the forecasts in a file like the one shown in figure 8.12.
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将预测保存到类似于图8.12所示的文件中。
- en: Create and save a churn probability histogram like the one shown in figure 8.13\.
    The histogram is created in a separate function. The histogram function calls
    the matplotlib.pyplot package function `hist` and then adds appropriate annotation
    before saving the result as an image. The counts from the histogram are also saved
    in a file.
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建并保存一个类似于图8.13所示的客户流失概率直方图。直方图是在一个单独的函数中创建的。直方图函数调用 `matplotlib.pyplot` 包的
    `hist` 函数，然后在保存结果为图像之前添加适当的注释。直方图的计数也保存在一个文件中。
- en: The listing for forecasting is similar to the listing for fitting the regression
    model, in the sense that the algorithmic tasks take a single function call to
    the package object. But much of the work is preparing the data and analyzing and
    saving the results.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 预测的列表与拟合回归模型的列表类似，从算法任务的角度来看，它们通过单个函数调用到包对象。但大部分工作是在准备数据和分析并保存结果。
- en: Listing 8.5 Forecasting on the current customer dataset
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 第8.5节：当前客户数据集上的预测
- en: '[PRE12]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: ① Reuses the data loading function from listing 8.4
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: ① 重新使用第8.4节中的数据加载函数。
- en: ② Reloads the model saved as an object using pickle
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: ② 使用pickle重新加载保存的对象模型。
- en: ③ Reloads current customer group scores created with listing 8.4
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 重新加载使用第8.4节创建的当前客户组分数。
- en: ④ predict_proba uses the model to make the predictions.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: ④ `predict_proba` 使用模型进行预测。
- en: ⑤ Saves the predictions in a new DataFrame
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 将预测保存到新的DataFrame中。
- en: ⑥ Calls the helper function forecast_histogram
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 调用辅助函数 `forecast_histogram`。
- en: ⑦ Creates a histogram plot, and returns the resulting data
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 创建直方图图，并返回结果数据。
- en: ⑧ Provides annotation on the plot
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 在图上提供注释。
- en: ⑨ Saves the histogram results in a file for closer inspection
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 将直方图结果保存到文件中以便更仔细地检查。
- en: 'You should run listing 8.5 on your own simulated dataset and confirm that you
    get results like those shown in figures 8.12 and 8.13\. Assuming that you have
    created the current customer grouped metric scores (using listing 8.4), you can
    create the forecast from listing 8.5 by using this command:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该在模拟数据集上运行列表 8.5，并确认你得到的结果与图 8.12 和图 8.13 中所示的结果相似。假设你已经创建了当前客户分组度量分数（使用列表
    8.4），你可以通过以下命令从列表 8.5 创建预测：
- en: '[PRE13]'
  id: totrans-321
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 8.4.4 Forecasting case studies
  id: totrans-322
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.4.4 预测案例研究
- en: 'Figure 8.14 shows some example histograms of predicted churn probabilities
    from the case studies you have seen throughout the book. These histograms have
    basic features in common with the result in figure 8.13 from simulation: a small
    peak representing a range with most of the churn probabilities and a tail made
    up of customers with higher churn probabilities.'
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.14 展示了从你在整本书中看到的案例研究中预测的流失概率的一些示例直方图。这些直方图与图 8.13 中模拟结果的基本特征相似：一个代表大多数流失概率范围的较小峰值，以及由具有更高流失概率的客户组成的尾部。
- en: '![](../Images/8-14.png)'
  id: totrans-324
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-14.png)'
- en: Figure 8.14 Case study distributions of forecast churn probabilities
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.14 预测流失概率的案例研究分布
- en: 'In figure 8.14, the three case studies show three fairly common variations
    on how the tail of a churn probability distribution can appear:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 在图 8.14 中，三个案例研究展示了流失概率分布尾部出现的三种相当常见的变异形式：
- en: A fat tail in the churn probability distribution is when the number of customers
    with higher churn probabilities is large enough to show up clearly in the histogram.
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在客户流失概率分布中，如果具有较高流失概率的客户数量足够多，以至于在直方图中可以清晰地显示出来，我们称之为“厚尾”。
- en: A spiked tail in the churn probability distribution is when there are certain
    ranges of churn probabilities in the tail with abnormally high numbers of customers.
    Sometimes, these numbers are related to identifiable behaviors such as lacking
    a particular behavior or having monthly versus annual billing.
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当尾部存在某些流失概率范围，且客户数量异常高时，我们称之为“尖锐尾部”。
- en: A multipeak distribution is another way to describe this type of distribution,
    although you usually describe the churn probability distribution as multipeak
    only when two or more peaks in the histogram shape have similar height. No case
    study example of this type was available.
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多峰分布是描述此类分布的另一种方式，尽管你通常只在直方图形状中有两个或更多高度相似的峰值时，才将流失概率分布描述为多峰。没有此类案例研究的示例可用。
- en: A thin tail is when most of the customers are packed in a narrow probability
    range, but there is a small number of customers with much higher churn probability.
    In a thin tail, the number is so small that these customers are not visible in
    the histogram; that’s when you look at the saved .csv file to see exactly how
    many such customers there are.
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果大多数客户都集中在狭窄的概率范围内，但有一小部分客户的流失概率显著更高，我们称之为“薄尾”。在薄尾的情况下，这些客户数量如此之少，以至于在直方图中不可见；这时你需要查看保存的
    .csv 文件，以确切了解这类客户的具体数量。
- en: In fact, the churn probability distributions resulting from real case studies
    are usually less smooth and regular looking than the distribution resulting from
    the simulation (shown in figure 8.13).
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 实际案例研究产生的流失概率分布通常比模拟结果（如图 8.13 所示）看起来更不光滑、更不规律。
- en: 8.4.5 Forecast calibration and forecast drift
  id: totrans-332
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.4.5 预测校准和预测漂移
- en: When you first fit the regression model, I showed you how to check the calibration
    by comparing the average churn probability prediction to the churn rate in the
    historical dataset. You should also check the calibration of the forecasts made
    for your current customer dataset. But in this case, you can’t compare the average
    with the churn rate in the current customer data because no customers in the current
    customer dataset have churned yet (of course). Instead, you can compare the average
    forecast on the current customer dataset with the churn rate in the historical
    dataset, or with a churn measurement made on recent customers, by using the methods
    you learned in chapter 2.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 当你第一次拟合回归模型时，我向你展示了如何通过比较平均流失概率预测与历史数据集中的流失率来检查校准。你也应该检查为当前客户数据集做出的预测的校准。但在这种情况下，你不能将平均值与当前客户数据集中的流失率进行比较，因为当前客户数据集中还没有客户流失（当然）。相反，你可以通过使用你在第
    2 章中学到的方法，将当前客户数据集中的平均预测与历史数据集中的流失率或对最近客户进行的流失测量进行比较。
- en: TAKEAWAY Check the forecast calibration by comparing the average forecast churn
    with the historical dataset churn probability or a recent churn rate measurement
    (keeping in mind possible seasonality in the timing of a recent measurement).
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: '**总结**：通过比较平均预测流失率与历史数据集流失概率或最近的流失率测量值（考虑到最近测量时间可能存在的季节性）来检查预测校准。'
- en: The top of figure 8.15 shows an example of such a comparison for the simulated
    dataset. In this case, it shows that the average churn probability forecast on
    the current dataset is about three-tenths of a percent less than the average churn
    forecast and churn rate in the historical dataset (4.3% compared with 4.6%). That
    difference may not seem like much, but it is noticeable, especially considering
    that the historical average and forecast are so close.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.15的顶部显示了这种比较的一个示例，针对模拟数据集。在这种情况下，它显示当前数据集上的平均流失概率预测比历史数据集中的平均流失预测和流失率低约三十分之一个百分点（4.3%与4.6%相比）。这种差异可能看起来不多，但它是明显的，尤其是考虑到历史平均值和预测如此接近。
- en: When you find that the current forecasts are noticeably different from the historical
    numbers, you should investigate a little further to make sure that you understand
    what caused the difference. What could cause this kind of difference? The churn
    probability model is based on customer metrics, so if the current forecasts are
    different from the historical forecast, the current metrics must be different
    in some way from the historical metrics.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 当你发现当前的预测与历史数据有显著差异时，你应该进一步调查以确保你理解造成差异的原因。什么可能导致这种差异？流失概率模型基于客户指标，因此如果当前的预测与历史预测不同，当前的指标必须在某些方面与历史指标不同。
- en: TAKEAWAY If the current customer churn probability forecast doesn’t match the
    historical churn probability forecast, it must be because of differences between
    current and historical metrics.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: '**总结**：如果当前客户流失概率预测与历史流失概率预测不匹配，那一定是因为当前和历史上的指标之间存在差异。'
- en: When you find this type of difference, you can investigate it by comparing the
    current metrics with the historical metrics. The easiest way is to use the dataset
    summary statistics that you already know how to create. The bottom of figure 8.15
    illustrates a comparison of the summary statistics from the historical dataset
    with the summary statistics from the current dataset. This comparison was made
    in a simple spreadsheet. You can do the same thing or write a short script of
    your own. To create the summary statistics in the current dataset, you can run
    an extra version of the summary statistics listing with the arguments `—chapter`
    `5` `—listing` `2` `—version` `4` in the Python wrapper program.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 当你发现这种类型的差异时，你可以通过比较当前指标与历史指标来调查它。最简单的方法是使用你已知的如何创建的数据集汇总统计信息。图8.15的底部说明了从历史数据集汇总统计信息与当前数据集汇总统计信息的比较。这种比较是在一个简单的电子表格中进行的。你可以做同样的事情或者编写自己的简短脚本。要创建当前数据集中的汇总统计信息，你可以在Python包装程序中运行带有参数`—chapter`
    `5` `—listing` `2` `—version` `4`的额外汇总统计信息列表版本。
- en: The comparison of metrics in figure 8.15 shows that the average values of the
    customer metrics in the current dataset are a little higher than the average values
    of customer metrics in the historical dataset (by around 5% in most cases). The
    metric for percent change in new friends shows a big change because it is estimated
    as zero in a new account, due to the requirement to have history for calculating
    the change. The current sample has more tenants with the required history, leading
    to the difference in the average. Because most of the customer metrics have a
    positive impact, higher metrics in the current dataset explain lower churn probability
    forecast for the current dataset.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.15中的指标比较显示，当前数据集中的客户指标平均值略高于历史数据集中客户指标的平均值（在大多数情况下约为5%）。新朋友百分比变化指标显示很大的变化，因为它在新账户中估计为零，这是由于计算变化需要历史记录的要求。当前样本有更多具有所需历史记录的租户，导致平均值的差异。由于大多数客户指标都有积极影响，当前数据集中的指标较高解释了当前数据集较低的流失概率预测。
- en: In the case of the simulated dataset, the difference between the average metric
    in the current and historical datasets is correct but not meaningful. In the simulation,
    the service came into existence a short time ago, so the average tenure of the
    customers is increasing. At the same time, most of the metrics are not corrected
    for recent sign-ups, and as a result, new customers (on average) have slightly
    lower metrics. From those considerations, it is fair to say that the average churn
    forecast on the current dataset is reasonable, and the difference with the historical
    forecasts is not something to be concerned about.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 在模拟数据集的情况下，当前数据集和历史数据集之间平均指标的差异是正确的，但没有意义。在模拟中，该服务最近才出现，因此客户的平均服务期限正在增加。同时，大多数指标没有对最近注册的用户进行调整，因此新客户（平均而言）的指标略低。从这些考虑因素来看，可以说当前数据集上的平均流失预测是合理的，与历史预测的差异不值得担心。
- en: For analysis of churn on a real product, if you find that the metrics for current
    customers are significantly different from historical dataset customers, you should
    do some additional quality assurance to make sure that the results are correct.
    If you have legitimate metric differences between the current dataset and historical
    dataset, it is reasonable to conclude that the churn rates for your current customers
    may be different from the churn rates you saw in the past. On the other hand,
    if the behavior of your current customers is substantially different from the
    historical customers due to material changes in the product or your market environment,
    you should be skeptical of the reliability of the churn forecasts. You may have
    to wait until you can form a new historical dataset under the current conditions
    to forecast churn probabilities reliably.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 对于真实产品的流失分析，如果您发现当前客户的指标与历史数据集客户显著不同，您应该进行一些额外的质量保证，以确保结果正确。如果您在当前数据集和历史数据集之间存在合法的指标差异，可以合理地得出结论，您的当前客户流失率可能与您过去看到的流失率不同。另一方面，如果由于产品或市场环境发生重大变化，您的当前客户的行为与历史客户的行为有显著不同，您应该对流失预测的可靠性持怀疑态度。您可能必须等到在当前条件下可以形成新的历史数据集，才能可靠地预测流失概率。
- en: Another issue is that outliers in the current dataset can cause some churn probabilities
    to be different from the historical dataset, altering the average. You can assess
    differences in extreme outliers in the metrics by comparing the maximum and higher
    percentiles in the summary statistics (not shown in figure 8.15). This area is
    another one in which you have to use your judgment in evaluating the differences.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个问题是在当前数据集中存在异常值可能会导致某些流失概率与历史数据集不同，从而改变平均值。您可以通过比较总结统计中的最大值和更高百分位数来评估指标极端异常值之间的差异（如图8.15所示，未展示）。这个区域是另一个您在评估差异时必须运用自己判断的地方。
- en: '![](../Images/8-15.png)'
  id: totrans-343
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-15.png)'
- en: Figure 8.15 Calibration and forecast drift
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.15 校准和预测漂移
- en: 8.5 Pitfalls of churn forecasting
  id: totrans-345
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.5 流失预测的陷阱
- en: You now know how to fit a churn probability model and how to forecast for active
    customers under normal circumstances. This section covers a few pitfalls you should
    be aware of, because they can prevent you from getting the best possible results
    in some circumstances.
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在知道如何拟合流失概率模型，以及如何在正常情况下预测活跃客户的流失。本节涵盖了一些您应该注意的陷阱，因为它们可能会在某些情况下阻止您获得最佳结果。
- en: 8.5.1 Correlated metrics
  id: totrans-347
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.5.1 相关指标
- en: 'You have learned about grouping correlated metrics and that you should do this
    grouping as part of metric cohort churn analysis before you use customer datasets
    for forecasting. So far, I have taught you that grouping correlated metrics is
    desirable because it makes your results easier to understand. But using a regression
    model adds a new imperative for using grouping: the regression algorithm is designed
    under the assumption that the metrics you use in it are not highly correlated.
    Because regression is not intended for high correlation between metrics, the result
    might not be sensible if they are.'
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经了解了关于分组相关指标的知识，以及在使用客户数据集进行预测之前，您应该将这种分组作为指标群体流失分析的一部分。到目前为止，我已向您说明分组相关指标是可取的，因为它使您的结果更容易理解。但是，使用回归模型为使用分组添加了一个新的必要性：回归算法是在假设您在其中使用的指标不是高度相关的条件下设计的。因为回归不适用于指标之间的高度相关性，如果它们是高度相关的，结果可能就不合理。
- en: TAKEAWAY Regression is designed for uncorrelated or moderately correlated metrics.
    Do not use highly correlated metrics in a regression.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点**：回归分析是为不相关或中等相关的指标设计的。不要在回归分析中使用高度相关的指标。'
- en: One reason not to use highly correlated metrics in regression is that it makes
    the engagement weights harder to interpret. Highly correlated metrics make the
    engagement weights harder to interpret because when you think about the churn
    probability impact of a correlated metric, you have to remember that it is typically
    paired with impacts from the other correlated metrics. Suppose that two metrics
    have a correlation of 0.75\. In that case, if a customer is one standard deviation
    above average on one metric, they are expected to be well above average on the
    other. You need to think about these relationships when you reason about the impact
    of different behaviors on retention. This fact remains true, even when metrics
    are weakly or moderately correlated; the impact is smaller, so ignoring it isn’t
    as problematic.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 在回归分析中不使用高度相关的指标的一个原因是，这会使参与度权重更难以解释。高度相关的指标使得参与度权重更难以解释，因为当你考虑一个相关指标的客户流失概率影响时，你必须记住它通常与其他相关指标的影响一起出现。假设两个指标的相关性为0.75。在这种情况下，如果一个客户在一个指标上的标准差高于平均水平，那么他们预期在另一个指标上的表现也会非常好。当你推理不同行为对保留率的影响时，你需要考虑这些关系。即使指标之间只有弱相关性或中等相关性，这一事实仍然成立；影响较小，因此忽略它并不成问题。
- en: If you learned about regression in the past, you may remember a condition called
    collinearity. Collinearity is related to correlation; it is a condition of perfect
    correlation between two metrics or between the sum of some group of metrics in
    the data. (Summing is in the sense of metrics such as totals, but collinearity
    refers to the condition when the addition of some metrics could result in correlated
    pairs, not that you make the metric sums.) Collinearity is a serious problem with
    some regression algorithms and can cause them to fail. But newer regression algorithms,
    like the ridge regression you used in listing 8.2, generally do not suffer from
    that kind of failure, even when the data includes correlated or collinear metrics.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你以前学过回归分析，你可能记得一个叫做共线性的条件。共线性与相关性相关；它是两个指标之间或数据中某些指标组的总和之间的完全相关条件。（求和是在指标如总数的情况下，但共线性指的是某些指标相加可能导致相关对的条件，而不是你使指标总和。）共线性是一些回归算法的严重问题，可能导致它们失败。但较新的回归算法，如你在列表8.2中使用的岭回归，通常不会出现那种失败，即使数据包括相关或共线性的指标。
- en: A more subtle problem occurs in the regression if you use highly correlated
    metrics. Sometimes, if you use multiple highly correlated metrics and do not average
    them into groups, you may find that the weights produced by the regression have
    nonsensical relationships to engagement and churn. Some of the metrics are assigned
    weights that are good for retention, and some are assigned weights that are bad
    for retention, but clearly, all should have a similar influence.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你在回归分析中使用高度相关的指标，会出现一个更微妙的问题。有时，如果你使用多个高度相关的指标并且没有将它们平均到组中，你可能会发现回归产生的权重与参与度和流失率之间的关系毫无意义。一些指标被分配了有利于保留率的权重，而一些指标被分配了不利于保留率的权重，但显然，所有指标都应该有类似的影响力。
- en: 'Figure 8.16 is an example from a real case study of Klipfolio, an SaaS tool
    for creating and sharing dashboards of company metrics. The case study had four
    versions of metrics that measured dashboard views in slightly different ways:
    dashboard views per day, dashboard views per month calculated with a fixed period,
    dashboard views per month calculated with account-tenure-scaled metric periods,
    and dashboard views per user per month. These four metrics are highly correlated.'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.16是一个来自Klipfolio真实案例研究的例子，Klipfolio是一个用于创建和共享公司指标仪表板的SaaS工具。该案例研究有四个版本的指标，以略微不同的方式衡量仪表板查看次数：每天仪表板查看次数、使用固定周期计算的每月仪表板查看次数、使用账户期限缩放指标周期的每月仪表板查看次数，以及每月每个用户的仪表板查看次数。这四个指标高度相关。
- en: '![](../Images/8-16.png)'
  id: totrans-354
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-16.png)'
- en: Figure 8.16 Misleading regression weights from correlated metrics
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.16 来自相关指标的误导性回归权重
- en: 'All four metrics showed strong relationships to retention in cohort analysis
    in the same way. Normally, such metrics should be grouped into an average score,
    but if that grouping is not done and the four metrics are put into regression
    as independent metrics, a strange result occurs: two of the metrics receive positive
    weights, indicating that the behavior increases engagement, and two of the metrics
    receive negative weights, suggesting that the behaviors reduce engagement. These
    weights are not meaningful, however.'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 所有四个度量在同期分析中都与保留显示出强烈的关系。通常，这些度量应该被分组到一个平均分数中，但如果这种分组没有完成，并且四个度量作为独立度量放入回归中，就会出现一个奇怪的结果：其中两个度量获得正值，表明行为增加了参与度，而另外两个度量获得负值，表明行为减少了参与度。然而，这些权重没有意义。
- en: Strangely, such models generally forecast as well as, and sometimes better than,
    the models when all the engagement weights are meaningful. The opposing weights
    result from the correlations and imbalance between the engagement strength of
    the correlated metrics that are the real patterns in the data. But it is usually
    not a good idea to create this kind of model. You learn about accuracy comparison
    and machine learning models that are not interpretable in chapter 9.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 奇怪的是，这种模型通常与所有参与度权重都有意义的模型一样好，有时甚至更好。相反的权重是由于相关度量的参与强度之间的相关性和不平衡造成的，这些相关度量是数据中的真实模式。但通常创建这种类型的模型并不是一个好主意。你将在第9章中了解准确度比较和不可解释的机器学习模型。
- en: This situation happens if you use a high correlation threshold in the metric
    grouping algorithm from chapter 6\. The motivation typically is to keep correlated
    metrics separate to try to determine the relative importance of churn and retention
    by seeing which regression weight is the largest. It is ironic that an analysis
    like this can result in nonsensical weights that prevent you from seeing a meaningful
    relationship. The solution is to use the methods described in chapter 6 and 7
    to group the correlated metrics into averages and then investigate whether the
    relationships between the metrics are significant by forming a ratio of the two
    metrics and checking the ratio’s relationship with churn and retention. If the
    ratio is not correlated with either part of the original pair, it can be tested
    in regression.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 这种情况发生在你使用第6章中提到的度量分组算法的高相关阈值时。通常的动机是保持相关度量分开，试图通过观察哪个回归权重最大来确定流失和保留的相对重要性。讽刺的是，这种分析可能导致无意义的权重，从而阻碍你看到有意义的关系。解决方案是使用第6章和第7章中描述的方法，将相关度量分组为平均值，然后通过形成两个度量的比率并检查比率与流失和保留的关系来调查度量之间的关系是否显著。如果比率与原始对中的任何一部分都不相关，它可以在回归中进行测试。
- en: 8.5.2 Outliers
  id: totrans-359
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.5.2 异常值
- en: 'Another pitfall that can prevent you from getting the best results in churn
    forecasting occurs when you have extreme outliers in your data. In chapter 3,
    when you were learning to create metrics, I showed you some techniques for detecting
    and removing records that contain incorrect or inappropriate data. Now you’re
    going to learn about something a little different: how to deal with data when
    it is a correct measurement but so extreme that it causes problems in some aspect
    of churn forecasting. This situation is not too common if you are converting all
    your metrics to scores by using the transforms for skewed and fat-tailed data.
    Those transforms reduce problems with outliers because the transformed scores
    have less extreme values than the original distribution. Also, extreme outliers
    are incredibly common if you do not use those transforms, which is why I recommended
    using them as a standard practice. Still, I’m going to alert you to two potential
    problems so that you’ll know the signs and what to do about them.'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可能阻止你在流失预测中获得最佳结果的陷阱发生在你的数据中存在极端异常值时。在第3章中，当你学习创建度量时，我向你展示了一些检测和删除包含错误或不适当数据的记录的技术。现在你将要了解一些不同的事情：如何处理数据在它是正确的测量但极端到在某些方面导致流失预测问题的情况。如果你使用用于偏斜和厚尾数据的转换将所有度量转换为分数，这种情况就不太常见。这些转换减少了异常值的问题，因为转换后的分数比原始分布的极端值要少。此外，如果你不使用这些转换，极端异常值会非常常见，这就是为什么我建议将其作为标准做法。尽管如此，我还是要提醒你两个潜在的问题，这样你就会知道迹象以及如何处理它们。
- en: Outliers can cause problems with fitting the model and forecasting after the
    model has been fit. Many statistics and data science classes emphasize the problem
    that outliers cause with fitting the model. But for most churn use cases, I have
    seen more problems with outliers when forecasting. Outliers can cause severe problems
    in fitting a model when few observations are used in the regression. If you have
    fewer than 100 observations in a regression, and there are extreme outliers, your
    results can be severely affected by the outliers. But most churn scenarios have
    thousands of data points. If you have tens of thousands of observations, a few
    outliers usually have little impact on the regression.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 异常值可能会在模型拟合和模型拟合后的预测中引起问题。许多统计学和数据科学课程强调异常值对模型拟合造成的问题。但在大多数流失预测用例中，我在预测时看到更多与异常值相关的问题。当回归中使用的观测值较少时，异常值会导致模型拟合出现严重问题。如果你在回归中少于100个观测值，并且存在极端异常值，你的结果可能会受到异常值的影响。但大多数流失场景都有数千个数据点。如果你有数万个观测值，几个异常值通常对回归的影响很小。
- en: In any event, you are likely to notice the presence of extreme outliers in your
    forecasting, and you will probably see them when you have forecast churn or retention
    probabilities that are close to 0% or close to 100%. Figure 8.17 illustrates what
    I’m talking about.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 在任何情况下，你可能会注意到预测中存在极端异常值，当你预测接近0%或接近100%的流失或保留概率时，你可能会看到它们。图8.17说明了我在说什么。
- en: '![](../Images/8-17.png)'
  id: totrans-363
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-17.png)'
- en: Figure 8.17 Churn probabilities resulting from outliers
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.17 异常值导致的流失概率
- en: I mentioned previously that it is rare to have accounts with churn probability
    close to 100%, so if any account receives a churn probability forecast that is
    above 99% (or even 100%), that result is probably due to some extreme outlier
    on one or more of the metrics. The same goes for accounts that are forecast to
    have a churn probability that’s exactly 0%. Churn probabilities that are exactly
    0% or 100% don’t make sense because in the real world, there is always a chance
    that a customer will churn or be retained.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 我之前提到，账户的流失概率接近100%的情况很少见，所以如果一个账户的流失概率预测值高于99%（甚至100%），那么这个结果很可能是由于一个或多个指标上的极端异常值造成的。对于预测流失概率恰好为0%的账户也是如此。流失概率恰好为0%或100%是没有意义的，因为在现实世界中，总有可能客户会流失或保留。
- en: If you know that these extreme probabilities are probably not accurate, the
    simplest thing to do is ignore them. Remember that an account shown with 100%
    churn probability is not that likely to churn, but it’s probably still significantly
    at risk, which is good to know. The problem I usually have with extreme forecasts
    is that they can be distracting to businesspeople. Businesspeople can become obsessed
    with knowing why some accounts have such high or low churn probabilities, and
    it may cause them to doubt the otherwise reasonable predictions of the model.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你知道这些极端概率可能并不准确，最简单的方法就是忽略它们。记住，显示100%流失概率的账户不太可能流失，但它可能仍然处于相当大的风险之中，这是值得了解的。我通常遇到的问题是极端预测可能会分散商家的注意力。商家可能会着迷于知道为什么某些账户的流失概率如此之高或如此之低，这可能会使他们怀疑模型的其他合理预测。
- en: TAKEAWAY Forecasts for extreme outliers can cause confusion and doubt for businesspeople
    when you present the model results to them.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点**：在向商家展示模型结果时，极端异常值的预测可能会引起他们的困惑和怀疑。'
- en: The problem with extreme outliers when they are real customers in your current
    dataset is that you cannot remove them as you would when you are constructing
    the historical dataset. Often, the context for making churn probability forecasts
    on the current customers is segmentation or some other analysis in which you need
    forecasts for all customers who are currently active. Often, the extreme outliers
    are high- or low-risk customers; the modeling can exaggerate the true level of
    risk. The solution that keeps the customers and allows you to make more reasonable
    forecasts for them is called outlier clipping.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 当极端异常值是当前数据集中的真实客户时，问题在于你不能像构建历史数据集时那样移除它们。通常，对当前客户进行流失概率预测的背景是细分或其他分析，其中你需要为所有当前活跃的客户进行预测。通常，极端异常值是高风险或低风险客户；建模可能会夸大真实的风险水平。保持客户并允许你对他们的预测更加合理的解决方案被称为异常值裁剪。
- en: DEFINITION Outlier clipping means reducing the value of extreme outliers so
    that they are still near the high (or low) end of possible values but not quite
    as extreme.
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** 异常值裁剪是指降低极端异常值，使它们仍然接近可能值的高（或低）端，但并不那么极端。'
- en: Outlier clipping is different from the related concept of outlier removal in
    that the outliers are kept in the data at a reduced level. Figure 8.18 illustrates
    the most common approach to outlier clipping. Outlier clipping modifies the observations
    of a metric that are above the 99th percentile by setting them equal to the 99th
    percentile value. By definition, this transformation affects only 1% of the observations
    for each metric you apply it to. The values that formerly were above the 99th
    percentile are still high in comparison with most of the distribution but not
    quite as high as they were before. Usually, outlier trimming is for high metric
    values, but the same approach can be used for low metric values. Extremely low
    metric values are unusual in count metrics, in which the minimum is usually zero,
    but they can occur in ratios or percentage change metrics.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 异常值裁剪与相关概念异常值移除不同，因为在数据中异常值被保持在较低的水平。图 8.18 展示了异常值裁剪最常见的方法。异常值裁剪通过将高于 99th 百分位数的指标观测值设置为
    99th 百分位数值来修改这些观测值。根据定义，这种转换只影响你应用的每个指标观测值的 1%。原本高于 99th 百分位数的值与分布中的大多数值相比仍然很高，但并不像之前那么极端。通常，异常值修剪用于高指标值，但同样的方法也可以用于低指标值。在计数指标中，极端低的指标值是不常见的，因为最小值通常是零，但它们可以出现在比率或百分比变化指标中。
- en: '![](../Images/8-18.png)'
  id: totrans-371
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/8-18.png)'
- en: Figure 8.18 Outlier clipping
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.18 异常值裁剪
- en: Listing 8.6 shows an example of code you can use to perform outlier clipping
    on a dataset. In listing 8.6, clipping is performed as part of the process of
    transforming the current customer dataset into group scores, so listing 8.6 is
    a variant of listing 8.4\. The clipping thresholds used are the 1st and 99th percentiles
    of all the metrics, which are in the saved dataset summary statistics. Clipping
    occurs after the data is loaded and before the metrics are converted to scores.
    Otherwise, listing 8.6 is the same as listing 8.4.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 8.6 展示了一个示例代码，你可以使用它对数据集进行异常值裁剪。在列表 8.6 中，裁剪作为将当前客户数据集转换为组分数的一部分过程进行，因此列表
    8.6 是列表 8.4 的一个变体。使用的裁剪阈值是所有指标的 1st 和 99th 百分位数，这些百分位数在保存的数据集摘要统计中。裁剪发生在数据加载之后和指标转换为分数之前。否则，列表
    8.6 与列表 8.4 相同。
- en: Note that listing 8.6 clips all the variables, but it’s not hard to create a
    similar function that clips only a select group of variables that you specify
    in a parameter. In general, it is better to clip data only when necessary when
    outliers are extreme enough to cause unreasonable forecasts. That said, in some
    real datasets with many events and metrics, it can be difficult to identify precisely
    which extreme metrics are causing the unreasonable forecasts. In that case, the
    quick solution is to proceed as shown in listing 8.6 and clip everything.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，列表 8.6 裁剪了所有变量，但创建一个只裁剪你在参数中指定的选定组变量的类似函数并不困难。一般来说，只有当异常值足够极端以至于会导致不合理的预测时，才需要裁剪数据。话虽如此，在一些具有许多事件和指标的实时数据集中，很难精确地识别出哪些极端指标导致了不合理的预测。在这种情况下，快速解决方案是按照列表
    8.6 所示进行，并对所有数据进行裁剪。
- en: Listing 8.6 Clipping scores in Python
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 8.6 Python 中的裁剪分数
- en: '[PRE14]'
  id: totrans-376
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: ① Reuses the fat-tails and skew transform functions
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: ① 重新使用胖尾和偏斜变换函数
- en: ② Reuses the helper function for loading churn data
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: ② 重新使用加载客户流失数据的辅助函数
- en: ③ Clips values in the data above those in the hi_vals parameter
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 裁剪数据中高于 hi_vals 参数值的值
- en: ④ Sets values above the threshold to the threshold
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 将高于阈值的值设置为阈值
- en: ⑤ Clips values in the data below those in the lo_vals parameter
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 裁剪数据中低于 lo_vals 参数值的值
- en: ⑥ Sets values below the threshold to the threshold
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 将低于阈值的值设置为阈值
- en: ⑦ This function is similar to that in listing 8.4.
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 此函数与列表 8.4 中的函数类似。
- en: ⑧ Reloads saved data, loading matrix, parameters, and stats
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 重新加载保存的数据、加载矩阵、参数和统计信息
- en: ⑨ Don’t use the churn measurement in the summary stats!
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 不要在摘要统计中使用客户流失度量！
- en: ⑩ Clips values above the 99th percentile
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ 裁剪高于 99th 百分位数的值
- en: ⑪ Clips values below the 1st percentile
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: ⑪ 裁剪低于 1st 百分位数的值
- en: ⑫ The rest of this listing is the same as listing 8.4.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: ⑫ 此列表的其余部分与列表 8.4 相同。
- en: If you need to use clipping because you had some extreme forecasts, you may
    also want to check whether the outliers have made a significant difference in
    fitting the regression itself. To do so, you should use the clipping functions
    in listing 8.6 in the function that creates the scores for the historical dataset.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要使用截断法因为您有一些极端的预测，您可能还想检查异常值是否对回归本身有显著影响。为此，您应该在创建历史数据集得分的函数中使用列表8.6中的截断函数。
- en: 8.6 Customer lifetime value
  id: totrans-390
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.6 客户终身价值
- en: 'Now that you know how to forecast churn probabilities, I will introduce you
    to one great application of churn forecasting: estimating customer lifetime value
    (CLV). Estimates of *CLV* let you know how much a customer is worth to you over
    their entire lifetime. This information is crucial for evaluating the return on
    investment of your acquisition and retention efforts. It may surprise you, but
    the key to estimating *CLV* is the churn rate. Customer churn probability forecasts
    (like the ones you have learned how to make) allow you to tailor *CLV* estimates
    individually to each customer.'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您已经了解了如何预测客户流失概率，我将向您介绍一个客户流失预测的绝佳应用：估计客户终身价值（CLV）。*CLV*的估计让您知道客户在其整个生命周期内对您有多大的价值。这些信息对于评估您的获取和保留努力的回报至关重要。可能会让您感到惊讶，但估计*CLV*的关键是客户流失率。客户流失概率预测（如您已学会如何制作的预测）允许您根据每个客户单独调整*CLV*的估计。
- en: 8.6.1 The meaning(s) of CLV
  id: totrans-392
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.6.1 客户终身价值（CLV）的含义
- en: The first thing to understand is that *CLV* is a forecast about expected customer
    values, not only the sum of past payments from particular customers.
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 首先要理解的是，*CLV*是对预期客户价值的预测，而不仅仅是特定客户过去付款的总和。
- en: DEFINITION *Customer lifetime value* is the amount you expect a customer to
    be worth to your business, including the revenue and costs you foresee, over the
    customer’s entire lifetime. This forecast includes future payments.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: '**客户终身价值**是指您预期客户在整个生命周期内对您的业务的价值，包括您预见的收入和成本。此预测包括未来的付款。'
- en: CLV needs to include both the revenue that a customer is expected to bring in
    and the cost of acquiring and keeping them as a customer, as illustrated in figure
    8.19.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: CLV需要包括客户预期带来的收入以及获取和保持客户作为客户的成本，如图8.19所示。
- en: '![](../Images/8-19.png)'
  id: totrans-396
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8-19.png)'
- en: Figure 8.19 Components of CLV
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.19 CLV的组成部分
- en: DEFINITIONS *Customer acquisition cost* (CAC) is the total amount spent on marketing
    and sales per customer acquired. CAC usually depends on the channel or campaign
    through which the customer was acquired. Cost of goods sold (COGS) is the total
    amount spent to maintain the service for existing customers, including things
    like cloud computing costs and the cost of providing customer support. *COGS*
    can depend on the type of customer.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: '**客户获取成本**（CAC）是指获取每位客户所花费的市场营销和销售总金额。CAC通常取决于客户是通过哪个渠道或活动获取的。销售成本（COGS）是指维护现有客户服务的总支出，包括云计算成本和提供客户支持的成本。*COGS*可能取决于客户类型。'
- en: NOTE In this section, it is assumed that you know the CAC and *COGS* for your
    customers. The focus in this section is on the recurring part of CLV, which depends
    on the churn rate.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意**：在本节中，假设您已了解您客户的CAC和*COGS*。本节的重点是CLV的持续部分，它取决于客户流失率。'
- en: The revenue from the customer is recurring over their lifetime, which you were
    previously introduced to as monthly recurring revenue (MRR). For now, I will refer
    to the revenue generically as recurring revenue (RR) without respect to the time
    period, which could be monthly or annually. Recurring revenue can include subscription
    payments and also any revenue generated by ads, in-app purchases, or use charges.
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: 客户在其生命周期内的收入是持续的，您之前将其称为月度持续收入（MRR）。现在，我将泛指收入为持续收入（RR），不考虑时间段，可能是每月或每年。持续收入可以包括订阅付款以及由广告、应用内购买或使用费产生的任何收入。
- en: 'The name customer lifetime value implies that it combines all the costs and
    recurring revenue over the customer’s expected lifetime. You can write *CLV* as
    shown in equation 8.6:'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 客户终身价值这个名字意味着它结合了客户预期生命周期内的所有成本和持续收入。您可以将*CLV*写成方程8.6所示的形式：
- en: '| *![](../Images/8-19_E06.png)*  | Equation 8.6 |'
  id: totrans-402
  prefs: []
  type: TYPE_TB
  zh: '| *![](../Images/8-19_E06.png)*  | 方程8.6 |'
- en: In the equations in this section, the *Σ* symbol stands for summation of all
    of the terms indicated by the subscript beneath it, so *Σ*[*lifetime*] means all
    the revenue and costs over the entire customer lifetime, summed together.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中的方程中，*Σ* 符号代表其下标所指示的所有项的总和，因此 *Σ*[*lifetime*] 表示整个客户生命周期内的所有收入和成本的总和。
- en: That’s CLV. Next, I need to teach you about a second lifetime value related
    to *CLV* that ignores acquisition costs and the first period’s revenue and costs.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是 CLV。接下来，我需要教你们关于与 *CLV* 相关的第二个生命周期价值，它忽略了获取成本和第一期的收入和成本。
- en: DEFINITION *Future lifetime value* (FLV) is the sum of the recurring payments
    and maintenance costs, at any time after the first period.
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: '**定义** *未来生命周期价值*（FLV）是指在第一期之后的任何时间点，重复付款和维护成本的总和。'
- en: You want to use *FLV* (without acquisition costs and the first period revenue
    and cost) when you are evaluating customers who have already signed up and are
    trying to decide how much it is worth to retain them. If you are trying to decide
    how much a customer is worth after they have signed up, the acquisition cost is
    irrelevant (a sunk cost in financial terminology). Similarly, the payment from
    the sign-up was never at risk for churn, so you ignore the first period payment
    (and costs). Instead, you care only about the expected future recurring revenue
    and costs after sign-up, as shown in equation 8.7
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 当你们在评估已经注册并试图决定保留他们的价值时，想使用 *FLV*（不包含获取成本和第一期的收入和成本）。如果你们试图决定客户注册后的价值，获取成本是不相关的（在财务术语中是沉没成本）。同样，注册的付款从未面临流失风险，因此你们忽略第一期的付款（和成本）。相反，你们只关心注册后的预期未来重复收入和成本，如方程
    8.7 所示
- en: '| *![](../Images/8-19_E07.png)*  | Equation 8.7 |'
  id: totrans-407
  prefs: []
  type: TYPE_TB
  zh: '| *![](../Images/8-19_E07.png)*  | 方程 8.7 |'
- en: where the sum *Σ*[*future*] ... means all the payments expected in the future.
    For the payment and cost sequence shown in figure 8.19, the future payments are
    those after the sign-up period. But this valuation stays the same throughout the
    customer lifetime, without regard to past periods of recurring revenue and costs.
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，求和符号 *Σ*[*future*] ... 表示未来预期的所有付款。对于图 8.19 中显示的付款和成本序列，未来的付款是指在注册期之后的付款。但这个估值在整个客户生命周期内保持不变，不考虑过去周期内的重复收入和成本。
- en: TAKEAWAY At any point in a customer’s lifetime, *FLV* is based only on expected
    future payments, and all costs and revenue in the past are seen as a sunk costs
    or benefits.
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: '**总结**：在任何客户生命周期的点上，*FLV* 仅基于预期的未来付款，过去所有的成本和收入被视为沉没成本或收益。'
- en: FLV is especially relevant to churn; you’re going to use it to evaluate return
    on investment on churn interventions. Also note that the difference between *CLV*
    and *FLV* is only the acquisition cost and one period of recurring revenue (RR
    in the equations) and one period of costs (COGS in the equations). The difference
    between the two lifetime value calculations is not an estimate or a forecast,
    because those are known quantities in the sense that you can calculate them from
    the data in your accounting system. By contrast, *FLV* is a forecast or an estimate
    of the future because the future lifetime of the customer is not known with certainty.
    For this reason, when you are talking about CLV, the emphasis is often on FLV.
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: FLV 特别适用于客户流失；你们将用它来评估流失干预措施的投资回报。此外，请注意，*CLV* 和 *FLV* 之间的差异仅是获取成本和一期的重复收入（方程中的
    RR）以及一期的成本（方程中的 COGS）。这两个生命周期价值计算之间的差异不是一个估计或预测，因为这些是已知量，因为你可以从你的会计系统中的数据计算出它们。相比之下，*FLV*
    是对未来的一种预测或估计，因为客户的未来生命周期并不确定。因此，当你们谈论 CLV 时，重点通常在 FLV 上。
- en: TAKEAWAY FLV emphasizes the future view of *CLV* for retention, which ignores
    acquisition and past revenue and costs.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: '**总结**：FLV 强调了 *CLV* 的未来视角，用于保留，忽略了获取和过去的收入和成本。'
- en: 'Because *FLV* is the hard part to estimate and is closely related to churn
    and retention, *FLV* is going to be the focus for the rest of the chapter. As
    I’ve mentioned, you can always get *CLV* from *FLV* by subtracting CAC and one
    period of *COGS* and then adding RR (equation 8.8):'
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 *FLV* 是难以估计的部分，并且与流失和保留密切相关，因此 *FLV* 将成为本章的焦点。正如我提到的，你们可以通过减去 CAC 和一期的 *COGS*
    然后加上 RR（方程 8.8）从 *FLV* 中得到 *CLV*：
- en: '| *![](../Images/8-19_E08.png)*  | Equation 8.8 |'
  id: totrans-413
  prefs: []
  type: TYPE_TB
  zh: '| *![](../Images/8-19_E08.png)*  | 方程 8.8 |'
- en: 'One last thing to note about the definition is that *COGS* is usually summarized
    by the margin defined in equation 8.9:'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 关于定义的一个需要注意的最后一点是，*COGS* 通常由方程 8.9 中定义的边际来概括：
- en: '| ![](../Images/8-19_E09.png)  | Equation 8.9 |'
  id: totrans-415
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/8-19_E09.png)  | 方程式8.9 |'
- en: 'Most companies summarize their costs with a margin, and it is assumed that
    you know the margin for your customers. With that definition, you can rewrite
    the *FLV* formula by combining equations 8.8 and 8.9 to get equation 8.10:'
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数公司用利润率来总结他们的成本，并且假设您知道客户的利润率。根据这个定义，您可以通过结合方程式8.8和8.9来重写*未来终身价值（FLV）*公式，得到方程式8.10：
- en: '| *![](../Images/8-19_E10.png)*  | Equation 8.10 |'
  id: totrans-417
  prefs: []
  type: TYPE_TB
  zh: '| *![](../Images/8-19_E10.png)*  | 方程式8.10 |'
- en: NOTE If you don’t know the margin for your customers, don’t worry, because all
    the rest of the instruction on *CLV* and *FLV* applies, and you can 8.6.2 always
    add the margin when you know it.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 注意事项：如果您不知道客户的利润率，不要担心，因为关于*客户终身价值（CLV）*和*未来终身价值（FLV）*的所有其他说明都适用，并且当您知道利润率时，您始终可以在8.6.2处添加利润率。
- en: 8.6.2 From churn to expected customer lifetime
  id: totrans-419
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.6.2 从流失到预期客户终身价值
- en: 'To calculate the expected sum of a customer’s RR to use in the *FLV* formula
    (equation 8.11), you need to estimate the expected future lifetime of a customer.
    You might expect that estimating a customer’s expected lifetime would be complicated,
    and you would have to do something like go back to the database and measure the
    average account tenures at the time of churn. But estimating customer lifetime
    is simple as long as you know a customer’s churn probability. I’ll tell you the
    answer first and then persuade you that it’s right. If you know that a customer
    has a certain churn probability, the expected future lifetime of the customer
    is given in equation 8.11:'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 要计算用于*未来终身价值（FLV）*公式（方程式8.11）中使用的客户的预期RR总和，您需要估计客户的预期未来终身价值。您可能会认为估计客户的预期终身价值会很复杂，您可能需要像回到数据库一样测量流失时的平均账户期限。但只要您知道客户的流失概率，估计客户终身价值就很简单。我会先告诉你答案，然后再说服你这是正确的。如果您知道客户有一定的流失概率，客户的预期未来终身价值由方程式8.11给出：
- en: '| ![](../Images/8-19_E11.png)  | Equation 8.11 |'
  id: totrans-421
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/8-19_E11.png)  | 方程式8.11 |'
- en: 'Note that in equation 8.11, the units for the lifetime are the same as the
    time period for measuring churn: months or years (typically).'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，在方程式8.11中，终身价值的单位与测量流失率的时间周期相同：月份或年份（通常是）。
- en: TAKEAWAY In plain English, equation 8.11 says that if the churn probability
    is a monthly period forecast, the expected lifetime of a customer is 1 divided
    by the churn probability in months. If the churn probability is an annual period
    forecast, the expected lifetime of a customer is 1 divided by the churn probability
    in years.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 摘要：用简单的话说，方程式8.11表明，如果流失概率是按月预测的，客户的预期终身价值是流失概率的倒数。如果流失概率是按年预测的，客户的预期终身价值是年流失概率的倒数。
- en: If the churn probability is 5% per month, the expected customer lifetime is
    1.0/0.05 = 20 months. If the churn probability is 30% per year, the expected customer
    lifetime is 1.0/0.30 = 3.33 years.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 如果流失概率是每月5%，预期客户终身价值是1.0/0.05 = 20个月。如果流失概率是每年30%，预期客户终身价值是1.0/0.30 = 3.33年。
- en: 'That sounds simple, and it is, as long as you have the churn probabilities
    for your customers. Here is why equation 8.11 makes sense:'
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 这听起来很简单，确实如此，只要您知道客户的流失概率。以下是方程式8.11为什么有道理的原因：
- en: What would the churn rate be if every customer had a lifetime of 20 months?
    If every customer churns once every 20 months, the churn rate would be 1/20, or
    5% per month.
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果每个客户的终身价值是20个月，流失率会是多少？如果每个客户每20个月流失一次，流失率将是1/20，即每月5%。
- en: What would the churn rate be if every customer had a lifetime of three years?
    If every customer churns once every three years, the churn rate would be one-third,
    or 33% per year.
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果每个客户的终身价值都是三年，流失率会是多少？如果每个客户每三年流失一次，流失率将是三分之一，即每年33%。
- en: Those examples show that (in an average sense) the churn rate is 1 divided by
    the lifetime, and equation 8.11 is turning that relationship around. In reality,
    not every customer has the same lifetime, even if they have exactly the same churn
    probability. Many factors external to the service and missing information prevent
    you from estimating churn probability perfectly. But for every customer, expected
    lifetime in the sense of an estimate or a forecast is 1 divided by churn probability.
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 这些例子表明（从平均意义上讲），客户流失率是终身价值的倒数，而方程式8.11则是将这种关系颠倒过来。实际上，即使客户的流失概率完全相同，也不是每个客户都有相同的终身价值。许多外部因素和缺失信息阻止您完美地估计流失概率。但对于每个客户来说，预期终身价值在估计或预测的意义上是流失概率的倒数。
- en: If you want to read more details about why the expected lifetime is 1 divided
    by the churn rate, you should read about exponential decay models, which are where
    the approximations are derived from.
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想了解更多关于为什么预期生命周期是流失率的倒数的原因，您应该了解指数衰减模型，这是近似值推导的地方。
- en: NOTE If you don’t make individual customer churn probability forecasts, you
    can use the average churn rate in equation 8.11 and estimate the average customer
    lifetime.
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: '**注意** 如果您没有对个别客户的流失概率进行预测，可以使用方程8.11中的平均流失率来估计平均客户生命周期。'
- en: 8.6.3 *CLV* formulas
  id: totrans-431
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.6.3 *CLV* 公式
- en: 'The next step isn’t exactly *FLV* or *CLV* but an intermediate step: the expected
    total profit over the customer’s lifetime, not including CAC. Combine the expected
    lifetime (equation 8.11) with the margin equation for profit (equation 8.10) to
    get equation 8.12:'
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个步骤并不是确切的*FLV*或*CLV*，而是一个中间步骤：客户生命周期的预期总利润，不包括CAC。将预期生命周期（方程8.11）与利润的利润率方程（方程8.10）结合起来，得到方程8.12：
- en: '| ![](../Images/8-19_E12.png)  | Equation 8.12 |'
  id: totrans-433
  prefs: []
  type: TYPE_TB
  zh: '| ![方程8.12](../Images/8-19_E12.png) | 方程8.12'
- en: The expected lifetime profit (excluding acquisition) is the margin multiplied
    by RR divided by the churn rate. Note that mRR here is the margin (m) multiplying
    recurring revenue (RR), not MRR for monthly recurring revenue. (This notation
    is unfortunate but standard.) Note that the expected lifetime from the churn probability
    can be a number that is uneven, and usually, it will be. If the churn rate is
    12% per month, the expected lifetime is 1/.12 = 8.3 months. But you multiply that
    lifetime by the per-period profit to get the expected lifetime profit. This result
    is okay because an estimate is an average. In the example of an expected 8.3-month
    lifetime, no customer will pay for 8.3 periods, but some may pay for 8, and some
    pay for 9, so the average is 8.3.
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: 预期生命周期利润（不包括获取成本）是利润率乘以RR除以流失率。注意，这里的mRR是利润率（m）乘以持续收入（RR），而不是MRR（每月持续收入）。（这种表示方法虽然不幸，但却是标准的。）注意，从流失概率中得到的预期生命周期可能是一个不均匀的数字，通常情况下是这样的。如果月流失率是12%，预期生命周期是1/.12
    = 8.3个月。但是，您需要将这个生命周期乘以每期的利润来得到预期生命周期利润。这个结果是合理的，因为估计是一个平均值。在预期生命周期为8.3个月的例子中，没有客户会支付8.3期，但有些人可能支付8期，有些人支付9期，所以平均是8.3。
- en: 'Also note that *FLV* doesn’t depend on the account tenure or how long that
    customer has been a customer. It doesn’t matter whether a customer completed their
    first period after they were acquired or their hundredth: the expected future
    lifetime profit depends only on churn probability. (It may be true that the churn
    probability forecast depends on account tenure, so there can be a second-order,
    indirect effect.) As a result, *FLV* is forward-looking in that account tenure
    matters only to the extent that it affects the churn probability forecast, which
    is also forward-looking.'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 还要注意，*FLV*不依赖于账户时长或客户成为客户的时间长短。无论客户在获取后是否完成了第一个周期，还是第100个周期，都无关紧要：预期的未来生命周期利润只取决于流失概率。（可能流失概率的预测依赖于账户时长，因此可能存在二级的间接影响。）因此，*FLV*是前瞻性的，因为账户时长只有在影响流失概率预测时才重要，而流失概率预测也是前瞻性的。
- en: TAKEAWAY *FLV* does not depend directly on the length of time a customer has
    been a customer. It is a forward-looking estimate. Only expected future revenue
    matters when evaluating how much it is worth to save a customer.
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点** *FLV* 并不直接依赖于客户成为客户的时长。它是一个前瞻性估计。在评估保留客户的价值时，只有预期的未来收入才是重要的。'
- en: 'In any event, equation 8.12 is not *FLV* yet because it is the profit from
    the recurring payments over the entire lifetime. But *FLV* is supposed to ignore
    the payments in the first payment period (because those payments form part of
    the certain cost and payment from each customer). The answer is to subtract one
    period’s worth of RR (and COGS) to get equation 8.13:'
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，方程8.12还不是*FLV*，因为它是在整个生命周期内的持续支付利润。但*FLV*应该忽略第一个支付周期的支付（因为那些支付构成了每个客户确定成本和支付的一部分）。答案是减去一期的RR（和COGS）以得到方程8.13：
- en: '| ![](../Images/8-19_E13.png)  | Equation 8.13 |'
  id: totrans-438
  prefs: []
  type: TYPE_TB
  zh: '| ![方程8.13](../Images/8-19_E13.png) | 方程8.13'
- en: 'On the other hand, to get the *CLV* from equation 8.12, you need to subtract
    the acquisition cost, which leads to equation 8.14:'
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，要从方程8.12中得到*CLV*，需要减去获取成本，从而导致方程8.14：
- en: '| ![](../Images/8-19_E14.png)  | Equation 8.14 |'
  id: totrans-440
  prefs: []
  type: TYPE_TB
  zh: '| ![方程8.14](../Images/8-19_E14.png) | 方程8.14'
- en: WARNING Many people use equation 8.12 alone for *CLV* because it is an easy
    simplification. But equation 8.12 alone is not the correct formula for either
    *CLV* or FLV! Equation 8.12 is an overestimate in both cases because both equations
    8.13 and 8.14 subtract from it. Because it is an overestimate, equation 8.12 is
    sometimes used for reporting *CLV* to outside investors but not for evaluating
    the return on investment of acquisition or retention of customers.
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：许多人单独使用方程8.12来计算*CLV*，因为它是一个简单的简化。但方程8.12单独并不是*CLV*或*FLV*的正确公式！由于方程8.13和8.14都从它中减去，所以方程8.12在这两种情况下都是高估。因为它是一个高估，所以方程8.12有时用于向外部投资者报告*CLV*，但不用于评估客户获取或保留的投资回报。
- en: You should be aware of an additional form of *FLV* necessary only for companies
    with low churn. If churn is less than 20% per year, customers are expected to
    have lifetimes longer than five years. If customers are expected to stay that
    long, it’s not reasonable to assume that their *FLV* is the full amount suggested
    by their expected lifetime. With such a long lifetime, there are more risks to
    the customer’s making all those payments than churn alone. A recession might occur,
    or a new competitor may change the market, or any number of things could happen
    over five or more years.
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该意识到对于低流失率的公司，还需要一种额外的*FLV*形式。如果年流失率低于20%，预计客户的寿命将超过五年。如果预计客户会停留这么长时间，那么假设他们的*FLV*是他们预期寿命所建议的全部金额是不合理的。在如此长的寿命期间，客户做出所有这些支付的风险比单纯的流失还要多。可能会发生经济衰退，或者新的竞争对手可能会改变市场，或者五年或更长时间内可能发生任何其他事情。
- en: 'The way to handle this uncertainty is to add a cash-flow discount factor like
    the kind that is used in evaluating capital investment projects. Explaining the
    formula is beyond the scope of the book, but it looks like equation 8.15:'
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 处理这种不确定性的方法是添加一个类似于用于评估资本投资项目的现金流量折现因子。解释公式超出了本书的范围，但它看起来像方程8.15：
- en: '| ![](../Images/8-19_E15.png)  | Equation 8.15 |'
  id: totrans-444
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/8-19_E15.png)  | 方程8.15 |'
- en: The formula in equation 8.15 uses the retention rate instead of the churn rate,
    and the discount variable in the denominator is the discount rate that your company
    uses to evaluate long-term investments. (If your company does not have such a
    discount rate, you probably don’t need to use this formula.) For details on this
    long-customer-lifetime version of *FLV* and CLV, I recommend “Customers as Assets,”
    by Sunil Gupta and Donald Lehman, in the Journal of Interactive Marketing. The
    article is available for download at [www0.gsb.columbia.edu/mygsb/faculty/research/pubfiles/721/gupta_
    customers.pdf](http://www0.gsb.columbia.edu/mygsb/faculty/research/pubfiles/721/gupta_customers.pdf).
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 方程8.15中的公式使用保留率而不是流失率，分母中的折现变量是公司用于评估长期投资的折现率。（如果您的公司没有这样的折现率，您可能不需要使用这个公式。）关于这种长客户寿命版本的*FLV*和*CLV*的详细信息，我推荐Sunil
    Gupta和Donald Lehman在《互动营销杂志》上发表的“Customers as Assets”。文章可在[www0.gsb.columbia.edu/mygsb/faculty/research/pubfiles/721/gupta_
    customers.pdf](http://www0.gsb.columbia.edu/mygsb/faculty/research/pubfiles/721/gupta_customers.pdf)下载。
- en: Summary
  id: totrans-446
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Forecasting churn probabilities is done with a model known as logistic regression.
  id: totrans-447
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 流失概率的预测是通过一种称为逻辑回归的模型完成的。
- en: Logistic regression models retention as an S-shaped function of engagement.
  id: totrans-448
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 逻辑回归模型将保留率视为参与度的S型函数。
- en: For the purpose of forecasting, engagement is modeled as the multiplication
    of a set of engagement weights by the scores for each metric.
  id: totrans-449
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了预测的目的，参与度被建模为一系列参与度权重与每个指标得分的乘积。
- en: The logistic regression algorithm determines the engagement weights that best
    fit the data.
  id: totrans-450
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 逻辑回归算法确定最适合数据的参与度权重。
- en: A churn forecasting model is calibrated if the probabilities of churn that it
    predicts are in agreement with the churn rates observed on real customers.
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果它预测的流失概率与观察到的实际客户流失率一致，则流失预测模型是校准的。
- en: You check the calibration of forecasts by comparing the average forecast with
    the churn rate in the dataset used to create the model.
  id: totrans-452
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你通过比较平均预测与用于创建模型的数据库中的流失率来检查预测的校准。
- en: To make forecasts on currently active customers, you must transform the current
    customer dataset in the same way that the historical customer dataset was transformed
    before fitting the model.
  id: totrans-453
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要对当前活跃的客户进行预测，你必须以与在拟合模型之前对历史客户数据集进行转换相同的方式进行当前客户数据集的转换。
- en: The expected lifetime for any customer is 1 divided by their predicted churn
    probability with the same units as the churn probability (months or years).
  id: totrans-454
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何客户的预期寿命等于其预测的流失概率的倒数，单位与流失概率相同（月份或年份）。
- en: The expected lifetime can be used to estimate customer lifetime value (CLV).
  id: totrans-455
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预期寿命可以用来估算客户终身价值（CLV）。
