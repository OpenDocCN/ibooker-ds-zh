- en: Chapter 9\. Data visualization to the end user
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 9 章\. 数据可视化到最终用户
- en: '*This chapter covers*'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '*本章涵盖*'
- en: Considering options for data visualization for your end users
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑为您的最终用户选择数据可视化方案
- en: Setting up a basic Crossfilter MapReduce application
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置基本的 Crossfilter MapReduce 应用程序
- en: Creating a dashboard with dc.js
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 dc.js 创建仪表板
- en: Working with dashboard development tools
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用仪表板开发工具进行工作
- en: '|  |'
  id: totrans-6
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: Application focused chapter
  id: totrans-7
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 专注于应用的章节
- en: You’ll notice quickly this chapter is certainly different from [chapters 3](kindle_split_011.xhtml#ch03)
    to [8](kindle_split_016.xhtml#ch08) in that the focus here lies on step 6 of the
    data science process. More specifically, what we want to do here is create a small
    data science application. Therefore, we won’t follow the data science process
    steps here. The data used in the case study is only partly real but functions
    as data flowing from either the data preparation or data modeling stage. Enjoy
    the ride.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 您会很快注意到，本章与第 3 章 [chapters 3](kindle_split_011.xhtml#ch03) 到第 8 章 [8](kindle_split_016.xhtml#ch08)
    的内容确实不同，因为这里的重点在于数据科学流程的第 6 步。更具体地说，我们在这里想要做的是创建一个小型数据科学应用。因此，我们不会遵循数据科学流程的步骤。案例研究中使用的数据只有部分是真实的，但它在数据准备或数据建模阶段充当数据流。享受这次旅程吧。
- en: '|  |'
  id: totrans-9
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: 'Often, data scientists must deliver their new insights to the end user. The
    results can be communicated in several ways:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，数据科学家必须将他们的新见解传达给最终用户。结果可以通过多种方式传达：
- en: '***A one-time presentation*** —Research questions are one-shot deals because
    the business decision derived from them will bind the organization to a certain
    course for many years to come. Take, for example, company investment decisions:
    *Do we distribute our goods from two distribution centers or only one? Where do
    they need to be located for optimal efficiency?* When the decision is made, the
    exercise may not be repeated until you’ve retired. In this case, the results are
    delivered as a report with a presentation as the icing on the cake.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***一次性演示*** —研究问题是单次交易，因为由此产生的商业决策将使组织在未来许多年里绑定在某个特定的道路上。以公司投资决策为例：*我们是将商品从两个分销中心分发还是只从一个分发？它们需要位于何处才能实现最佳效率？*
    决策一旦做出，可能直到你退休都不会重复。在这种情况下，结果将以报告的形式交付，演示文稿作为甜点。'
- en: '***A new viewport on your data*** —The most obvious example here is customer
    segmentation. Sure, the segments themselves will be communicated via reports and
    presentations, but in essence they form tools, not the end result itself. When
    a clear and relevant customer segmentation is discovered, it can be fed back to
    the database as a new dimension on the data from which it was derived. From then
    on, people can make their own reports, such as how many products were sold to
    each segment of customers.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***数据的新视角*** —这里最明显的例子是客户细分。当然，细分本身将通过报告和演示文稿进行传达，但本质上它们形成的是工具，而不是最终结果本身。当发现一个清晰且相关的客户细分时，它可以作为从其派生出来的数据的新维度反馈到数据库中。从那时起，人们可以自己制作报告，例如，向每个客户细分销售了多少产品。'
- en: '***A real-time dashboard*** —Sometimes your task as a data scientist doesn’t
    end when you’ve discovered the new information you were looking for. You can send
    your information back to the database and be done with it. But when other people
    start making reports on this newly discovered gold nugget, they might interpret
    it incorrectly and make reports that don’t make sense. As the data scientist who
    discovered this new information, you must set the example: make the first refreshable
    report so others, mainly reporters and IT, can understand it and follow in your
    footsteps. Making the first dashboard is also a way to shorten the delivery time
    of your insights to the end user who wants to use it on an everyday basis. This
    way, at least they already have something to work with until the reporting department
    finds the time to create a permanent report on the company’s reporting software.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***实时仪表板*** —有时作为数据科学家的工作并不在你发现你寻找的新信息后结束。你可以将你的信息发送回数据库并完成它。但是，当其他人开始对这个新发现的金块进行报告时，他们可能会错误地解释它并制作出没有意义的报告。作为发现这个新信息的科学家，你必须树立榜样：制作第一个可刷新的报告，这样其他人，主要是记者和
    IT 人员，就可以理解它并跟随你的脚步。制作第一个仪表板也是缩短最终用户（他们希望每天使用它）获得洞察力的交付时间的一种方式。这样，至少他们已经有一些东西可以工作了，直到报告部门找到时间在公司报告软件上创建一个永久性的报告。'
- en: 'You might have noticed that a few important factors are at play:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经注意到有几个重要因素在起作用：
- en: What *kind of decision* are you supporting? Is it a strategic or an operational
    one? Strategic decisions often only require you to analyze and report once, whereas
    operational decisions require the report to be refreshed regularly.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您支持的是哪种类型的决策？是战略性的还是操作性的？战略决策通常只需要您分析并报告一次，而操作决策则需要定期刷新报告。
- en: '***How big is your organization?*** In smaller ones you’ll be in charge of
    the entire cycle: from data gathering to reporting. In bigger ones a team of reporters
    might be available to make the dashboards for you. But even in this last situation,
    delivering a prototype dashboard can be beneficial because it presents an example
    and often shortens delivery time.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***您的组织有多大？*** 在较小的组织中，您将负责整个周期：从数据收集到报告。在较大的组织中，可能有一个报告团队为您制作仪表板。但即使在最后一种情况下，交付一个原型仪表板也可能是有益的，因为它提供了一个示例，并且通常可以缩短交付时间。'
- en: Although the entire book is dedicated to generating insights, in this last chapter
    we’ll focus on delivering an operational dashboard. Creating a presentation to
    promote your findings or presenting strategic insights is out of the scope of
    this book.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然整本书都是致力于生成洞察力，但在最后一章中，我们将专注于交付一个操作仪表板。创建一个展示您发现或展示战略洞察力的演示文稿超出了本书的范围。
- en: 9.1\. Data visualization options
  id: totrans-18
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.1. 数据可视化选项
- en: You have several options for delivering a dashboard to your end users. Here
    we’ll focus on a single option, and by the end of this chapter you’ll be able
    to create a dashboard yourself.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您有几种方式将仪表板交付给最终用户。在这里，我们将专注于一种方式，到本章结束时，您将能够自己创建仪表板。
- en: 'This chapter’s case is that of a hospital pharmacy with a stock of a few thousand
    medicines. The government came out with a new norm to all pharmacies: all medicines
    should be checked for their sensitivity to light and be stored in new, special
    containers. One thing the government didn’t supply to the pharmacies was an actual
    list of light-sensitive medicines. This is no problem for you as a data scientist
    because every medicine has a patient information leaflet that contains this information.
    You distill the information with the clever use of text mining and assign a “light
    sensitive” or “not light sensitive” tag to each medicine. This information is
    then uploaded to the central database. In addition, the pharmacy needs to know
    how many containers would be necessary. For this they give you access to the pharmacy
    stock data. When you draw a sample with only the variables you require, the data
    set looks like [figure 9.1](#ch09fig01) when opened in Excel.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的案例是一个拥有几千种药品的医院药房。政府对所有药房出台了一项新规定：所有药品都应检查其对光线的敏感性，并存储在新、特殊的容器中。政府没有提供给药房的实际上是光敏药品的清单。作为数据科学家，这对您来说不是问题，因为每种药品都有包含此信息的患者信息手册。您通过巧妙地使用文本挖掘来提炼信息，并为每种药品分配一个“光敏”或“非光敏”标签。然后，将此信息上传到中央数据库。此外，药房还需要知道需要多少个容器。为此，他们为您提供药房库存数据的访问权限。当您只抽取所需的变量时，数据集在Excel中打开时看起来像[图9.1](#ch09fig01)。
- en: 'Figure 9.1\. Pharmacy medicines data set opened in Excel: the first 10 lines
    of stock data are enhanced with a lightsensitivity variable'
  id: totrans-21
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.1. 在Excel中打开的药房药品数据集：前10行库存数据增加了光敏性变量
- en: '![](Images/09fig01.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/09fig01.jpg)'
- en: As you can see, the information is time-series data for an entire year of stock
    movement, so every medicine thus has 365 entries in the data set. Although the
    case study is an existing one and the medicines in the data set are real, the
    values of the other variables presented here were randomly generated, as the original
    data is classified. Also, the data set is limited to 29 medicines, a little more
    than 10,000 lines of data. Even though people do create reports using crossfilter.js
    (a Javascript MapReduce library) and dc.js (a Javascript dashboarding library)
    with more than a million lines of data, for the example’s sake you’ll use a fraction
    of this amount. Also, it’s not recommended to load your entire database into the
    user’s browser; the browser will freeze while loading, and if it’s too much data,
    the browser will even crash. Normally data is precalculated on the server and
    parts of it are requested using, for example, a REST service.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，这些信息是一整年股票走势的时间序列数据，因此每种药物在数据集中都有365条记录。尽管这个案例研究是现成的，数据集中的药物也是真实的，但这里展示的其他变量的值是随机生成的，因为原始数据是分类的。此外，数据集仅限于29种药物，大约有10,000多行数据。尽管人们确实会使用crossfilter.js（一个JavaScript
    MapReduce库）和dc.js（一个JavaScript仪表板库）来创建包含超过一百万行数据的报告，但为了示例，您将使用其中的一小部分。此外，不建议将整个数据库加载到用户的浏览器中；在加载过程中，浏览器会冻结，如果数据量过大，浏览器甚至可能崩溃。通常数据是在服务器上预先计算的，并通过例如REST服务请求其部分。
- en: To turn this data into an actual dashboard you have many options and you can
    find a short overview of the tools later in this chapter.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 要将此数据转换为实际的仪表板，您有许多选择，您可以在本章后面的部分找到这些工具的简要概述。
- en: Among all the options, for this book we decided to go with dc.js, which is a
    crossbreed between the JavaScript MapReduce library Crossfilter and the data visualization
    library d3.js. Crossfilter was developed by Square Register, a company that handles
    payment transactions; it’s comparable to PayPal but its focus is on mobile. Square
    developed Crossfilter to allow their customers extremely speedy slice and dice
    on their payment history. Crossfilter is not the only JavaScript library capable
    of Map-Reduce processing, but it most certainly does the job, is open source,
    is free to use, and is maintained by an established company (Square). Example
    alternatives to Crossfilter are Map.js, Meguro, and Underscore.js. JavaScript
    might not be known as a data crunching language, but these libraries do give web
    browsers that extra bit of punch in case data does need to be handled in the browser.
    We won’t go into how JavaScript can be used for massive calculations within collaborative
    distributed frameworks, but an army of dwarfs can topple a giant. If this topic
    interests you, you can read more about it at [https://www.igvita.com/2009/03/03/collaborative-map-reduce-in-the-browser/](https://www.igvita.com/2009/03/03/collaborative-map-reduce-in-the-browser/)
    and at [http://dyn.com/blog/browsers-vs-servers-using-javascript-for-number-crunching-theories/](http://dyn.com/blog/browsers-vs-servers-using-javascript-for-number-crunching-theories/).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有选项中，对于这本书，我们决定选择dc.js，它是JavaScript MapReduce库Crossfilter和数据可视化库d3.js的混合体。Crossfilter是由Square
    Register公司开发的，该公司处理支付交易；它类似于PayPal，但其重点是移动端。Square开发了Crossfilter，以便他们的客户能够极其快速地对他们的支付历史进行切片和切块。Crossfilter不是唯一能够进行Map-Reduce处理的JavaScript库，但它确实能够完成这项工作，是开源的，免费使用，并由一家知名公司（Square）维护。Crossfilter的替代方案示例包括Map.js、Meguro和Underscore.js。JavaScript可能不是以数据处理语言而闻名，但这些库确实为浏览器提供了额外的处理能力，以防数据需要在浏览器中处理。我们不会深入探讨JavaScript如何在协作分布式框架中进行大规模计算，但一群矮人可以推翻一个巨人。如果您对这个主题感兴趣，您可以在[https://www.igvita.com/2009/03/03/collaborative-map-reduce-in-the-browser/](https://www.igvita.com/2009/03/03/collaborative-map-reduce-in-the-browser/)和[http://dyn.com/blog/browsers-vs-servers-using-javascript-for-number-crunching-theories/](http://dyn.com/blog/browsers-vs-servers-using-javascript-for-number-crunching-theories/)上了解更多信息。
- en: d3.js can safely be called the most versatile JavaScript data visualization
    library available at the time of writing; it was developed by Mike Bostock as
    a successor to his Protovis library. Many JavaScript libraries are built on top
    of d3.js.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: d3.js可以安全地称为在撰写本文时最通用的JavaScript数据可视化库；它是由Mike Bostock开发的，作为他Protovis库的继任者。许多JavaScript库都是建立在d3.js之上的。
- en: 'NVD3, C3.js, xCharts, and Dimple offer roughly the same thing: an abstraction
    layer on top of d3.js, which makes it easier to draw simple graphs. They mainly
    differ in the type of graphs they support and their default design. Feel free
    to visit their websites and find out for yourself:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: NVD3、C3.js、xCharts 和 Dimple 提供了大致相同的东西：在 d3.js 之上的抽象层，这使得绘制简单的图表更加容易。它们主要区别在于它们支持的图表类型和默认设计。请随意访问它们的网站，并亲自了解：
- en: '*NVD3*—[http://nvd3.org/](http://nvd3.org/)'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*NVD3*—[http://nvd3.org/](http://nvd3.org/)'
- en: '*C3.j*s—[http://c3js.org/](http://c3js.org/)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*C3.js*—[http://c3js.org/](http://c3js.org/)'
- en: '*xCharts*—[http://tenxer.github.io/xcharts/](http://tenxer.github.io/xcharts/)'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*xCharts*—[http://tenxer.github.io/xcharts/](http://tenxer.github.io/xcharts/)'
- en: '*Dimple*—[http://dimplejs.org/](http://dimplejs.org/)'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Dimple*—[http://dimplejs.org/](http://dimplejs.org/)'
- en: Many options exist. So why dc.js?
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 选项很多。那么为什么选择 dc.js？
- en: 'The main reason: compared to what it delivers, an interactive dashboard where
    clicking one graph will create filtered views on related graphs, dc.js is surprisingly
    easy to set up. It’s so easy that you’ll have a working example by the end of
    this chapter. As a data scientist, you already put in enough time on your actual
    analysis; easy-to-implement dashboards are a welcome gift.'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 主要原因：与它所提供的功能相比，一个交互式仪表板，点击一个图表就会在相关图表上创建过滤视图，dc.js 的设置非常简单。简单到本章结束时你将有一个可工作的示例。作为一名数据科学家，你已经投入了足够的时间在你的实际分析上；易于实现的仪表板是一个受欢迎的礼物。
- en: To get an idea of what you’re about to create, you can go to the following website,
    [http://dc-js.github.io/dc.js/](http://dc-js.github.io/dc.js/), and scroll down
    to the NASDAQ example, shown in [figure 9.2](#ch09fig02).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 为了了解你即将创建的内容，你可以访问以下网站，[http://dc-js.github.io/dc.js/](http://dc-js.github.io/dc.js/)，并滚动到
    NASDAQ 示例，如图 [9.2](#ch09fig02) 所示。
- en: Figure 9.2\. A dc.js interactive example on its official website
  id: totrans-35
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.2\. dc.js 在其官方网站上的交互式示例
- en: '![](Images/09fig02_alt.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig02_alt.jpg)'
- en: Click around the dashboard and see the graphs react and interact when you select
    and deselect data points. Don’t spend too long though; it’s time to create this
    yourself.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在仪表板上点击，当你选择和取消选择数据点时，你会看到图表如何做出反应和交互。但不要花太多时间；现在是时候自己创建它了。
- en: 'As stated before, dc.js has two big prerequisites: d3.js and crossfilter.js.
    d3.js has a steep learning curve and there are several books on the topic worth
    reading if you’re interested in full customization of your visualizations. But
    to work with dc.js, no knowledge of it is required, so we won’t go into it in
    this book. Crossfilter.js is another matter; you’ll need to have a little grasp
    of this MapReduce library to get dc.js up and running on your data. But because
    the concept of MapReduce itself isn’t new, this will go smoothly.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，dc.js 有两个主要前提：d3.js 和 crossfilter.js。d3.js 有一个陡峭的学习曲线，如果你对完全自定义你的可视化感兴趣，有几本书值得阅读。但为了使用
    dc.js，你不需要了解它，所以我们不会在本书中涉及它。crossfilter.js 是另一回事；你需要对这种 MapReduce 库有一定的了解，才能在你的数据上运行
    dc.js。但由于 MapReduce 的概念本身并不新颖，这个过程将会顺利。
- en: 9.2\. Crossfilter, the JavaScript MapReduce library
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.2\. Crossfilter，JavaScript MapReduce 库
- en: 'JavaScript isn’t the greatest language for data crunching. But that didn’t
    stop people, like the folks at Square, from developing MapReduce libraries for
    it. If you’re dealing with data, every bit of speed gain helps. You don’t want
    to send enormous loads of data over the internet or even your internal network
    though, for these reasons:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: JavaScript 并非数据处理的最佳语言。但这并没有阻止人们，例如 Square 的人，为其开发 MapReduce 库。如果你在处理数据，任何速度的提升都是有益的。然而，你并不希望发送大量数据通过互联网或甚至你的内部网络，原因如下：
- en: Sending a bulk of data will tax the *network* to the point where it will bother
    other users.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发送大量数据会*网络*到极限，以至于会打扰其他用户。
- en: The *browser* is on the receiving end, and while loading in the data it will
    temporarily *freeze*. For small amounts of data this is unnoticeable, but when
    you start looking at 100,000 lines, it can become a visible lag. When you go over
    1,000,000 lines, depending on the width of your data, your browser could give
    up on you.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*浏览器*是接收方，在加载数据时它将暂时*冻结*。对于少量数据来说这是不可察觉的，但当你开始查看 100,000 行数据时，它可能成为明显的延迟。当你超过
    1,000,000 行数据时，根据你数据的宽度，你的浏览器可能会放弃你。'
- en: 'Conclusion: it’s a balance exercise. For the data you do send, there is a Crossfilter
    to handle it for you once it arrives in the browser. In our case study, the pharmacist
    requested the central server for stock data of 2015 for 29 medicines she was particularly
    interested in. We already took a look at the data, so let’s dive into the application
    itself.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 结论：这是一个平衡练习。对于您发送的数据，一旦它到达浏览器，Crossfilter将为您处理它。在我们的案例研究中，药剂师请求了2015年29种她特别感兴趣的药品的库存数据。我们已经查看过这些数据，所以让我们深入了解应用程序本身。
- en: 9.2.1\. Setting up everything
  id: totrans-44
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 9.2.1\. 设置一切
- en: 'It’s time to build the actual application, and the ingredients of our small
    dc.js application are as follows:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是时候构建实际的应用程序了，我们的小dc.js应用程序的成分如下：
- en: '***JQuery*** —To handle the interactivity'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***JQuery*** —用于处理交互性'
- en: '***Crossfilter.js*** —A MapReduce library and prerequisite to dc.js'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***Crossfilter.js*** —一个MapReduce库，也是dc.js的先决条件'
- en: '***d3.js*** —A popular data visualization library and prerequisite to dc.js'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***d3.js*** —一个流行的数据可视化库，也是dc.js的先决条件'
- en: '***dc.js*** —The visualization library you will use to create your interactive
    dashboard'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***dc.js*** —您将使用的可视化库来创建您的交互式仪表板'
- en: '***Bootstrap*** —A widely used layout library you’ll use to make it all look
    better'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***Bootstrap*** —一个广泛使用的布局库，您将使用它使一切看起来更好'
- en: 'You’ll write only three files:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 您只需编写三个文件：
- en: '***index.html*** —The HTML page that contains your application'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***index.html*** —包含您的应用程序的HTML页面'
- en: '***application.js*** —To hold all the JavaScript code you’ll write'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***application.js*** —用于存放您将要编写的所有JavaScript代码'
- en: '***application.css*** —For your own CSS'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***application.css*** —用于您自己的CSS'
- en: In addition, you’ll need to run our code on an HTTP server. You could go through
    the effort of setting up a LAMP (Linux, Apache, MySQL, PHP), WAMP (Windows, Apache,
    MySQL, PHP), or XAMPP (Cross Environment, Apache, MySQL, PHP, Perl) server. But
    for the sake of simplicity we won’t set up any of those servers here. Instead
    you can do it with a single Python command. Use your command-line tool (Linux
    shell or Windows CMD) and move to the folder containing your index.html (once
    it’s there). You should have Python installed for other chapters of this book
    so the following command should launch a Python HTTP server on your localhost.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您还需要在HTTP服务器上运行我们的代码。您可以费心设置LAMP（Linux, Apache, MySQL, PHP）、WAMP（Windows,
    Apache, MySQL, PHP）或XAMPP（Cross Environment, Apache, MySQL, PHP, Perl）服务器。但为了简单起见，我们在这里不会设置任何这些服务器。相反，您可以使用单个Python命令来完成它。使用您的命令行工具（Linux
    shell或Windows CMD）并移动到包含您的index.html的文件夹（一旦它在那里）。您应该已经安装了Python，以便阅读本书的其他章节，因此以下命令应该在您的本地主机上启动一个Python
    HTTP服务器。
- en: '[PRE0]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: For Python 3.4
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Python 3.4
- en: '[PRE1]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: As you can see in [figure 9.3](#ch09fig03), an HTTP server is started on localhost
    port 8000\. In your browser this translates to “localhost:8000”; putting “0.0.0.0:8000”
    won’t work.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您在[图9.3](#ch09fig03)中看到的，一个HTTP服务器在本地主机端口8000上启动。在您的浏览器中，这表示为“localhost:8000”；使用“0.0.0.0:8000”将不起作用。
- en: Figure 9.3\. Starting up a simple Python HTTP server
  id: totrans-60
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.3\. 启动一个简单的Python HTTP服务器
- en: '![](Images/09fig03_alt.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig03_alt.jpg)'
- en: Make sure to have all the required files available in the same folder as your
    index.html. You can download them from the Manning website or from their creators’
    websites.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 确保所有必需的文件都位于与您的index.html相同的文件夹中。您可以从Manning网站或它们的创建者网站上下载它们。
- en: '*dc.css and dc.min.js*—[https://dc-js.github.io/dc.js/](https://dc-js.github.io/dc.js/)'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*dc.css and dc.min.js*—[https://dc-js.github.io/dc.js/](https://dc-js.github.io/dc.js/)'
- en: '*d3.v3.min.js*—[http://d3js.org/](http://d3js.org/)'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*d3.v3.min.js*—[http://d3js.org/](http://d3js.org/)'
- en: '*crossfilter.min.js*—[http://square.github.io/crossfilter/](http://square.github.io/crossfilter/)'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*crossfilter.min.js*—[http://square.github.io/crossfilter/](http://square.github.io/crossfilter/)'
- en: Now we know how to run the code we’re about to create, so let’s look at the
    index.html page, shown in the following listing.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们知道了如何运行我们即将创建的代码，让我们看看以下列表中的index.html页面。
- en: Listing 9.1\. An initial version of index.html
  id: totrans-67
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表9.1\. index.html的初始版本
- en: '![](Images/ch09ex01-0.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/ch09ex01-0.jpg)'
- en: '![](Images/ch09ex01-1.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/ch09ex01-1.jpg)'
- en: 'No surprises here. The header contains all the CSS libraries you’ll use, so
    we’ll load our JavaScript at the end of the HTML body. Using a JQuery onload handler,
    your application will be loaded when the rest of the page is ready. You start
    off with two table placeholders: one to show what your input data looks like,
    `<div id="input-table"></div>`, and the other one will be used with Crossfilter
    to show a filtered table, `<div id="filteredtable"></div>`. Several Bootstrap
    CSS classes were used, such as “*well*”, “*container*”, the Bootstrap grid system
    with “*row*” and “*col-xx-xx*”, and so on. They make the whole thing look nicer
    but they aren’t mandatory. More information on the Bootstrap CSS classes can be
    found on their website at [http://getbootstrap.com/css/](http://getbootstrap.com/css/).'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 没有任何惊喜。这里包含了你将使用的所有CSS库，因此我们将JavaScript加载在HTML体部的末尾。使用JQuery的onload处理程序，当页面其余部分准备就绪时，你的应用程序将被加载。你开始时有两个表格占位符：一个用于显示你的输入数据的样子，`<div
    id="input-table"></div>`，另一个将用于与Crossfilter一起显示一个过滤后的表格，`<div id="filteredtable"></div>`。使用了几个Bootstrap
    CSS类，例如“*well*”，“*container*”，Bootstrap网格系统中的“*row*”和“*col-xx-xx*”，等等。它们使整个界面看起来更美观，但它们不是必需的。有关Bootstrap
    CSS类的更多信息，可以在他们的网站上找到：[http://getbootstrap.com/css/](http://getbootstrap.com/css/).
- en: Now that you have your HTML set up, it’s time to show your data onscreen. For
    this, turn your attention to the application.js file you created. First, we wrap
    the entire code “to be” in a JQuery onload handler.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经设置了HTML，是时候在屏幕上显示你的数据了。为此，将注意力转向你创建的应用程序.js文件。首先，我们将整个“待执行”代码包裹在一个JQuery
    onload处理程序中。
- en: '[PRE2]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Now we’re certain our application will be loaded only when all else is ready.
    This is important because we’ll use JQuery selectors to manipulate the HTML. It’s
    time to load in data.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们确定只有当所有其他内容都准备就绪时，我们的应用程序才会被加载。这很重要，因为我们将使用JQuery选择器来操作HTML。现在是加载数据的时候了。
- en: '[PRE3]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You don’t have a REST service ready and waiting for you, so for the example
    you’ll draw the data from a .csv file. This file is available for download on
    Manning’s website. d3.js offers an easy function for that. After loading in the
    data you hand it over to your main application function in the d3.csv callback
    function.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你没有准备好一个等待你的REST服务，所以在这个例子中，你将从.csv文件中抽取数据。这个文件可以在Manning的网站上下载。d3.js提供了一个简单的函数来完成这个任务。在加载数据后，你将其在d3.csv回调函数中传递给你的主应用程序函数。
- en: Apart from the main function you have a `CreateTable` function, which you will
    use to...you guessed it...create your tables, as shown in the following listing.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 除了主函数外，你还有一个`CreateTable`函数，你将使用它来...你猜对了...创建你的表格，如下面的列表所示。
- en: Listing 9.2\. The `CreateTable` function
  id: totrans-77
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表9.2\. `CreateTable`函数
- en: '[PRE4]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '`CreateTable()` requires three arguments:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '`CreateTable()`需要三个参数：'
- en: '**`data`** —The data it needs to put into a table.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`data`** —需要放入表格中的数据。'
- en: '**`variablesInTable`** —What variables it needs to show.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`variablesInTable`** —需要显示的变量。'
- en: '**`Title`** —The title of the table. It’s always nice to know what you’re looking
    at.'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`Title`** —表格的标题。知道你在看什么总是件好事。'
- en: '`CreateTable()` uses a predefined variable, `tableTemplate`, that contains
    our overall table layout. `CreateTable()` can then add rows of data to this template.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '`CreateTable()`使用一个预定义的变量`tableTemplate`，它包含我们的整体表格布局。然后`CreateTable()`可以向这个模板添加数据行。'
- en: Now that you have your utilities, let’s get to the `main` function of the application,
    as shown in the following listing.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你有了你的工具，让我们来看看应用程序的`main`函数，如下面的列表所示。
- en: Listing 9.3\. JavaScript `main` function
  id: totrans-85
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表9.3\. JavaScript `main`函数
- en: '![](Images/261fig01_alt.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/261fig01_alt.jpg)'
- en: You start off by showing your data on the screen, but preferably not all of
    it; only the first five entries will do, as shown in [figure 9.4](#ch09fig04).
    You have a date variable in your data and you want to make sure Crossfilter will
    recognize it as such later on, so you first parse it and create a new variable
    called `Day`. You show the original, `Date`, to appear in the table for now, but
    later on you’ll use `Day` for all your calculations.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 你开始时在屏幕上显示你的数据，但最好是不要显示全部；只显示前五条记录就足够了，如图9.4所示。你的数据中有一个日期变量，你想要确保Crossfilter稍后能将其识别为日期类型，因此你首先解析它并创建一个新的变量名为`Day`。你暂时在表格中显示原始的`Date`，但稍后你将使用`Day`进行所有计算。
- en: 'Figure 9.4\. Input medicine table shown in browser: first five lines'
  id: totrans-88
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.4\. 浏览器中显示的输入药物表格：前五行
- en: '![](Images/09fig04_alt.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/09fig04_alt.jpg)'
- en: 'This is what you end up with: the same thing you saw in Excel before. Now that
    you know the basics are working, you’ll introduce Crossfilter into the equation.'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是你最终得到的结果：与你在Excel中看到的一模一样。现在你知道基础知识正在工作，你将引入Crossfilter到等式中。
- en: 9.2.2\. Unleashing Crossfilter to filter the medicine data set
  id: totrans-91
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 9.2.2。释放Crossfilter以过滤药物数据集
- en: Now let’s go into Crossfilter to use filtering and MapReduce. Henceforth you
    can put all the upcoming code after the code of [section 9.2.1](#ch09lev2sec1)
    within the `main()` function. The first thing you’ll need to do is declare a Crossfilter
    instance and initiate it with your data.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们进入Crossfilter使用过滤和MapReduce。从现在起，你可以在[9.2.1节](#ch09lev2sec1)的代码之后放置所有即将到来的代码，在`main()`函数内。你需要做的第一件事是声明一个Crossfilter实例，并用你的数据初始化它。
- en: '[PRE5]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'From here you can get to work. On this instance you can register dimensions,
    which are the columns of your table. Currently Crossfilter is limited to 32 dimensions.
    If you’re handling data wider than 32 dimensions, you should consider narrowing
    it down before sending it to the browser. Let’s create our first dimension, the
    medicine name dimension:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里你可以开始工作。在这个实例中，你可以注册维度，这些维度是你的表格的列。目前Crossfilter限制为32个维度。如果你处理的数据超过32个维度，你应该在发送到浏览器之前将其缩小。让我们创建我们的第一个维度，药物名称维度：
- en: '[PRE6]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Your first dimension is the name of the medicines, and you can already use this
    to filter your data set and show the filtered data using our `CreateTable()` function.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 你的第一个维度是药物名称，你现在已经可以使用它来过滤你的数据集，并使用我们的`CreateTable()`函数显示过滤后的数据。
- en: '[PRE7]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You show only the top five observations ([figure 9.5](#ch09fig05)); you have
    365 because you have the results from a single medicine for an entire year.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 你只显示了前五个观察值（[图9.5](#ch09fig05)）；你有365个，因为你有一个药物一整年的结果。
- en: Figure 9.5\. Data filtered on medicine name Grazax 75 000 SQ-T
  id: totrans-99
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.5。按药物名称Grazax 75 000 SQ-T过滤的数据
- en: '![](Images/09fig05_alt.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig05_alt.jpg)'
- en: 'This table doesn’t look sorted but it is. The `top()` function sorted it on
    medicine name. Because you only have a single medicine selected it doesn’t matter.
    Sorting on date is easy enough using your new `Day` variable. Let’s register another
    dimension, the date dimension:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这个表格看起来没有排序，但实际上是排序过的。`top()`函数按药物名称排序了它。因为你只选择了一种药物，所以这无关紧要。使用你新的`Day`变量按日期排序很容易。让我们注册另一个维度，日期维度：
- en: '[PRE8]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Now we can sort on date instead of medicine name:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以按日期而不是药物名称排序：
- en: '[PRE9]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The result is a bit more appealing, as shown in [figure 9.6](#ch09fig06).
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如图9.6所示，更加吸引人。
- en: Figure 9.6\. Data filtered on medicine name Grazax 75 000 SQ-T and sorted by
    day
  id: totrans-106
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.6。按药物名称Grazax 75 000 SQ-T过滤并按天排序的数据
- en: '![](Images/09fig06_alt.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig06_alt.jpg)'
- en: 'This table gives you a window view of your data but it doesn’t summarize it
    for you yet. This is where the Crossfilter MapReduce capabilities come in. Let’s
    say you would like to know how many observations you have per medicine. Logic
    dictates that you should end up with the same number for every medicine: 365,
    or 1 observation per day in 2015.'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 这个表格为你提供了数据的窗口视图，但它还没有为你总结。这就是Crossfilter MapReduce功能发挥作用的地方。假设你想知道每种药物有多少观察值。逻辑上，你应该为每种药物得到相同的数字：365，或者2015年每天一个观察值。
- en: '[PRE10]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Crossfilter comes with two MapReduce functions: `reduceCount()` and `reduceSum()`.
    If you want to do anything apart from counting and summing, you need to write
    reduce functions for it. The `countPerMed` variable now contains the data grouped
    by the medicine dimension and a line count for each medicine in the form of a
    key and a value. To create the table you need to address the variable `key` instead
    of `medName` and `value` for the count ([figure 9.7](#ch09fig07)).'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Crossfilter提供了两个MapReduce函数：`reduceCount()`和`reduceSum()`。如果你想做的不仅仅是计数和求和，你需要为它编写reduce函数。`countPerMed`变量现在包含按药物维度分组的数据，以及每个药物的行计数，形式为键和值。为了创建表格，你需要处理变量`key`而不是`medName`，以及`value`作为计数（[图9.7](#ch09fig07)）。
- en: Figure 9.7\. MapReduced table with the medicine as the group and a count of
    data lines as the value
  id: totrans-111
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图9.7。以药物为组并按数据行计数作为值的MapReduced表格
- en: '![](Images/09fig07_alt.jpg)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig07_alt.jpg)'
- en: By specifying `.top(Infinity)` you ask to show all 29 medicines onscreen, but
    for the sake of saving paper [figure 9.7](#ch09fig07) shows only the first five
    results. Okay, you can rest easy; the data contains 365 lines per medicine. Notice
    how Crossfilter ignored the filter on “Grazax”. If a dimension is used for grouping,
    the filter doesn’t apply to it. Only filters on other dimensions can narrow down
    the results.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 通过指定 `.top(Infinity)`，你要求在屏幕上显示所有 29 种药物，但为了节省纸张，[图 9.7](#ch09fig07) 只显示了前五个结果。好吧，你可以放心了；每种药物的数据包含
    365 行。注意 Crossfilter 忽略了“Grazax”上的过滤器。如果一个维度用于分组，则过滤器不适用于它。只有其他维度的过滤器才能缩小结果。
- en: 'What about more interesting calculations that don’t come bundled with Crossfilter,
    such as an average, for instance? You can still do that but you’d need to write
    three functions and feed them to a `.reduce()` method. Let’s say you want to know
    the average stock per medicine. As previously mentioned, almost all of the MapReduce
    logic needs to be written by you. An average is nothing more than the division
    of sum by count, so you will require both; how do you go about this? Apart from
    the `reduceCount()` and `reduceSum()` functions, Crossfilter has the more general
    `reduce()` function. This function takes three arguments:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，关于那些没有与 Crossfilter 一起打包的更有趣的计算呢？例如，计算平均值？你仍然可以这样做，但你需要编写三个函数并将它们传递给 `.reduce()`
    方法。假设你想知道每类药物的平均股票。如前所述，几乎所有的 MapReduce 逻辑都需要你自己编写。平均值不过是总和除以计数，所以你需要两者；你如何处理这个问题？除了
    `reduceCount()` 和 `reduceSum()` 函数之外，Crossfilter 还有一个更通用的 `reduce()` 函数。这个函数接受三个参数：
- en: '***The `reduceAdd()` function*** —A function that describes what happens when
    an extra observation is added.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***`reduceAdd()` 函数*** —一个描述当添加额外观察时会发生什么的函数。'
- en: '***The `reduceRemove()` function*** —A function that describes what needs to
    happen when an observation disappears (for instance, because a filter is applied).'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***`reduceRemove()` 函数*** —一个描述当观察消失时（例如，因为应用了过滤器）需要发生什么的函数。'
- en: '***The `reduceInit()` function*** —This one sets the initial values for everything
    that’s calculated. For a sum and count the most logical starting point is 0.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***`reduceInit()` 函数*** —这个函数用于设置所有计算初始值。对于总和和计数，最合理的起始点是 0。'
- en: 'Let’s look at the individual reduce functions you’ll require before trying
    to call the Crossfilter .`reduce()` method, which takes these three components
    as arguments. A custom reduce function requires three components: an initiation,
    an add function, and a remove function. The initial reduce function will set starting
    values of the `p` object:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在尝试调用 Crossfilter 的 `.reduce()` 方法之前，让我们看看你需要使用的单个 reduce 函数。`.reduce()` 方法接受这三个组件作为参数。一个自定义的
    reduce 函数需要三个组件：一个初始化函数、一个添加函数和一个移除函数。初始 reduce 函数将设置 `p` 对象的起始值：
- en: '[PRE11]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'As you can see, the reduce functions themselves take two arguments. These are
    automatically fed to them by the Crossfilter `.reduce()` method:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，reduce 函数本身接受两个参数。这些参数由 Crossfilter 的 `.reduce()` 方法自动传入：
- en: '`p` is an object that contains the combination situation so far; it persists
    over all observations. This variable keeps track of the sum and count for you
    and thus represents your goal, your end result.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`p` 是一个包含迄今为止组合情况的对象；它在所有观察中持续存在。这个变量为你跟踪总和和计数，因此代表你的目标，你的最终结果。'
- en: '`v` represents a record of the input data and has all its variables available
    to you. Contrary to `p`, it doesn’t persist but is replaced by a new line of data
    every time the function is called. The `reduceInit()` is called only once, but
    `reduceAdd()` is called every time a record is added and `reduceRemove()` every
    time a line of data is removed.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`v` 代表输入数据的记录，并提供了所有可用的变量。与 `p` 不同，它不会持续存在，每次函数被调用时都会被新的数据行替换。`reduceInit()`
    只调用一次，但 `reduceAdd()` 每次添加记录时调用一次，`reduceRemove()` 每次删除一行数据时调用一次。'
- en: 'The `reduceInit()` function, here called `reduceInitAvg()` because you’re going
    to calculate an average, basically initializes the `p` object by defining its
    components (`count`, `sum`, and `average`) and setting their initial values. Let’s
    look at `reduce-AddAvg()`:'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`reduceInit()` 函数，在这里称为 `reduceInitAvg()`，因为你将计算平均值，基本上通过定义其组件（`count`、`sum`
    和 `average`）并设置它们的初始值来初始化 `p` 对象。让我们看看 `reduce-AddAvg()`：'
- en: '[PRE12]'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '`reduceAddAvg()` takes the same `p` and `v` arguments but now you actually
    use `v`; you don’t need your data to set the initial values of `p` in this case,
    although you can if you want to. Your `Stock` is summed up for every record you
    add, and then the average is calculated based on the accumulated sum and record
    count:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '`reduceAddAvg()` 使用相同的 `p` 和 `v` 参数，但现在你实际上使用了 `v`；在这种情况下，你不需要你的数据来设置 `p` 的初始值，尽管你可以这样做。你的
    `Stock` 对每条添加的记录进行求和，然后根据累积总和和记录计数计算平均值：'
- en: '[PRE13]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'The `reduceRemoveAvg()` function looks similar but does the opposite: when
    a record is removed, the count and sum are lowered. The average always calculates
    the same way, so there’s no need to change that formula.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '`reduceRemoveAvg()` 函数看起来相似，但做的是相反的事情：当一条记录被移除时，计数和总和会降低。平均值总是以相同的方式计算，所以没有必要改变那个公式。'
- en: 'The moment of truth: you apply this homebrewed MapReduce function to the data
    set:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 真相时刻：你将这个自制的 MapReduce 函数应用到数据集上：
- en: '![](Images/266fig01_alt.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/266fig01_alt.jpg)'
- en: Notice how the name of your output variable has changed from `value` to `value
    .stockAvg`. Because you defined the `reduce` functions yourself, you can output
    many variables if you want to. Therefore, `value` has changed into an object containing
    all the variables you calculated; `stockSum` and `count` are also in there.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 注意你的输出变量名从 `value` 变成了 `value .stockAvg`。因为你自己定义了 `reduce` 函数，所以如果你想输出多个变量，可以做到。因此，`value`
    变成了一个包含你计算的所有变量的对象；`stockSum` 和 `count` 也在其中。
- en: The results speak for themselves, as shown in [figure 9.8](#ch09fig08). It seems
    we’ve borrowed Cimalgex from other hospitals, going into an average negative stock.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 结果不言自明，如图 9.8 所示。看起来我们借鉴了其他医院的 Cimalgex，进入了一个平均负库存。
- en: Figure 9.8\. MapReduced table with average stock per medicine
  id: totrans-132
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.8\. 每种药品的平均库存的 MapReduced 表格
- en: '![](Images/09fig08_alt.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig08_alt.jpg)'
- en: This is all the Crossfilter you need to know to work with dc.js, so let’s move
    on and bring out those interactive graphs.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是你需要了解的所有 Crossfilter 知识，以便与 dc.js 一起工作，所以让我们继续前进，展示那些交互式图表。
- en: 9.3\. Creating an interactive dashboard with dc.js
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3\. 使用 dc.js 创建交互式仪表板
- en: 'Now that you know the basics of Crossfilter, it’s time to take the final step:
    building the dashboard. Let’s kick off by making a spot for your graphs in the
    `index.html` page. The new body looks like the following listing. You’ll notice
    it looks similar to our initial setup apart from the added graph placeholder `<div>`
    tags and the reset button `<button>` tag.'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经了解了 Crossfilter 的基础知识，是时候采取最后一步：构建仪表板。让我们从在 `index.html` 页面上为你的图表留出空间开始。新的主体看起来如下所示。你会注意到它看起来与我们的初始设置相似，除了添加了图表占位符
    `<div>` 标签和重置按钮 `<button>` 标签。
- en: Listing 9.4\. A revised index.html with space for graphs generated by dc.js
  id: totrans-137
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.4\. 带有 dc.js 生成的图表空间的修订版 index.html
- en: '![](Images/ch09ex04-0.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/ch09ex04-0.jpg)'
- en: '![](Images/ch09ex04-1.jpg)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/ch09ex04-1.jpg)'
- en: We’ve got Bootstrap formatting going on, but the most important elements are
    the three `<div>` tags with IDs and the button. What you want to build is a representation
    of the total stock over time, `<div id="StockOverTime"></div>`, with the possibility
    of filtering on medicines, `<div id="StockPerMedicine"></div>`, and whether they’re
    light-sensitive or not, `<div id="LightSensitiveStock"></div>`. You also want
    a button to reset all the filters, `<button class="btn btn-success">Reset Filters</button>`.
    This reset button element isn’t required, but is useful.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在进行 Bootstrap 格式化，但最重要的元素是带有 ID 的三个 `<div>` 标签和按钮。你想要构建的是总库存随时间变化的表示，`<div
    id="StockOverTime"></div>`，有过滤药品的可能性，`<div id="StockPerMedicine"></div>`，以及它们是否对光敏感，`<div
    id="LightSensitiveStock"></div>`。你还需要一个重置所有过滤器的按钮，`<button class="btn btn-success">重置过滤器</button>`。这个重置按钮元素不是必需的，但很有用。
- en: 'Now turn your attention back to application.js. In here you can add all the
    upcoming code in your `main()` function as before. There is, however, one exception
    to the rule: `dc.renderAll();` is dc’s command to draw the graphs. You need to
    place this render command only once, at the bottom of your `main()` function.
    The first graph you need is the “total stock over time,” as shown in the following
    listing. You already have the time dimension declared, so all you need is to sum
    your stock by the time dimension.'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，将你的注意力转回 application.js。在这里，你可以在 `main()` 函数中添加所有即将到来的代码，就像之前一样。然而，有一个例外：`dc.renderAll();`
    是 dc 绘制图表的命令。你需要将此渲染命令只放置一次，在 `main()` 函数的底部。你需要的第一张图是“总库存随时间变化”，如下所示。你已经有时间维度声明了，所以你只需要按时间维度对库存求和。
- en: Listing 9.5\. Code to generate “total stock over time” graph
  id: totrans-142
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.5\. 生成“随时间推移的总库存”图表的代码
- en: '![](Images/268fig01_alt.jpg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/268fig01_alt.jpg)'
- en: Look at all that’s happening here. First you need to calculate the range of
    your x-axis so dc.js will know where to start and end the line chart. Then the
    line chart is initialized and configured. The least self-explanatory methods here
    are `.group()` and `.dimension()`. `.group()` takes the time dimension and represents
    the x-axis. `.dimension()` is its counterpart, representing the y-axis and taking
    your summated data as input. [Figure 9.9](#ch09fig09) looks like a boring line
    chart, but looks can be deceiving.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 看看这里发生了什么。首先你需要计算 x 轴的范围，这样 dc.js 就会知道线图的起始和结束位置。然后初始化并配置线图。这里最不具说明性的方法是 `.group()`
    和 `.dimension()`。`.group()` 接收时间维度并代表 x 轴。`.dimension()` 是它的对应物，代表 y 轴并接收你的汇总数据作为输入。[图
    9.9](#ch09fig09) 看起来像一条无聊的线图，但外表可能具有欺骗性。
- en: 'Figure 9.9\. dc.js graph: sum of medicine stock over the year 2015'
  id: totrans-145
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.9\. dc.js 图表：2015 年药品库存总和
- en: '![](Images/09fig09_alt.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig09_alt.jpg)'
- en: Things change drastically once you introduce a second element, so let’s create
    a row chart that represents the average stock per medicine, as shown in the next
    listing.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦引入第二个元素，情况就会发生巨大变化，因此让我们创建一个行图，表示每种药品的平均库存，如下面的列表所示。
- en: Listing 9.6\. Code to generate “average stock per medicine” graph
  id: totrans-148
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.6\. 生成“每种药品的平均库存”图表的代码
- en: '![](Images/269fig01_alt.jpg)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/269fig01_alt.jpg)'
- en: 'This should be familiar because it’s a graph representation of the table you
    created earlier. One big point of interest: because you used a custom-defined
    `reduce()` function this time, dc.js doesn’t know what data to represent. With
    the `.valueAccessor()` method you can specify `p.value.stockAvg` as the value
    of your choice. The dc.js row chart’s label’s font color is gray; this makes your
    row chart somewhat hard to read. You can remedy this by overwriting its CSS in
    your application.css file:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该很熟悉，因为它是你之前创建的表的图表表示。一个值得注意的大点：因为你这次使用了自定义定义的 `reduce()` 函数，dc.js 就不知道要表示什么数据。你可以使用
    `.valueAccessor()` 方法指定 `p.value.stockAvg` 作为你选择的价值。dc.js 行图的标签字体颜色是灰色；这使得你的行图有些难以阅读。你可以在应用程序的
    `application.css` 文件中覆盖它的 CSS 来解决这个问题：
- en: '[PRE14]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: One simple line can make the difference between a clear and an obscure graph
    ([figure 9.10](#ch09fig10)).
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 一条简单的线就能区分清晰和模糊的图表（[图 9.10](#ch09fig10)）。
- en: Figure 9.10\. dc.js line chart and row chart interaction
  id: totrans-153
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.10\. dc.js 线图和行图交互
- en: '![](Images/09fig10_alt.jpg)'
  id: totrans-154
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig10_alt.jpg)'
- en: Now when you select an area on the line chart, the row chart is automatically
    adapted to represent the data for the correct time period. Inversely, you can
    select one or multiple medicines on the row chart, causing the line chart to adjust
    accordingly. Finally, let’s add the light-sensitivity dimension so the pharmacist
    can distinguish between stock for light-sensitive medicines and non-light-sensitive
    ones, as shown in the following listing.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 现在当你选择折线图上的一个区域时，行图会自动调整以表示正确时间段的数据。反之，你可以在行图上选择一个或多个药品，这将导致折线图相应地调整。最后，让我们添加光敏度维度，以便药剂师可以区分光敏药品和非光敏药品的库存，如下面的列表所示。
- en: Listing 9.7\. Adding the light-sensitivity dimension
  id: totrans-156
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.7\. 添加光敏度维度
- en: '[PRE15]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: We hadn’t introduced the light dimension yet, so you need to register it onto
    your Crossfilter instance first. You can also add a reset button, which causes
    all filters to reset, as shown in the following listing.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还没有介绍光维度，所以你首先需要将其注册到你的 Crossfilter 实例中。你还可以添加一个重置按钮，这将重置所有过滤器，如下面的列表所示。
- en: Listing 9.8\. The dashboard reset filters button
  id: totrans-159
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 9.8\. 仪表板重置过滤器按钮
- en: '![](Images/271fig01_alt.jpg)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/271fig01_alt.jpg)'
- en: The `.filterAll()` method removes all filters on a specific dimension; `dc.redraw-All()`
    then manually triggers all dc charts to redraw.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`.filterAll()` 方法移除特定维度上的所有过滤器；然后 `dc.redraw-All()` 手动触发所有 dc 图表的重绘。'
- en: The final result is an interactive dashboard ([figure 9.11](#ch09fig11)), ready
    to be used by our pharmacist to gain insight into her stock’s behavior.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 最终结果是交互式仪表板（[图 9.11](#ch09fig11)），准备好供我们的药剂师使用，以深入了解其库存的行为。
- en: Figure 9.11\. dc.js fully interactive dashboard on medicines and their stock
    within the hospital pharmacy
  id: totrans-163
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 9.11\. 医院药房内药品及其库存的 dc.js 完全交互式仪表板
- en: '![](Images/09fig11_alt.jpg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/09fig11_alt.jpg)'
- en: 9.4\. Dashboard development tools
  id: totrans-165
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4\. 仪表板开发工具
- en: We already have our glorious dashboard, but we want to end this chapter with
    a short (and far from exhaustive) overview of the alternative software choices
    when it comes to presenting your numbers in an appealing way.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经有了我们辉煌的仪表板，但我们在本章结束时想要简要（而且远非详尽）地概述一下，在以吸引人的方式展示你的数据时，可供选择的替代软件。
- en: You can go with proven and true software packages of renowned developers such
    as Tableau, MicroStrategy, Qlik, SAP, IBM, SAS, Microsoft, Spotfire, and so on.
    These companies all offer dashboard tools worth investigating. If you’re working
    in a big company, chances are good you have at least one of those paid tools at
    your disposal. Developers can also offer free public versions with limited functionality.
    Definitely check out Tableau if you haven’t already at [http://www.tableausoftware.com/public/download](http://www.tableausoftware.com/public/download).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以选择知名开发者如Tableau、MicroStrategy、Qlik、SAP、IBM、SAS、Microsoft、Spotfire等提供的经过验证的软件包。这些公司都提供值得调查的仪表板工具。如果你在大公司工作，很可能你至少拥有这些付费工具之一。开发者也可以提供带有有限功能的免费公共版本。如果你还没有的话，请务必查看[http://www.tableausoftware.com/public/download](http://www.tableausoftware.com/public/download)上的Tableau。
- en: Other companies will at least give you a trial version. In the end you have
    to pay for the full version of any of these packages, and it might be worth it,
    especially for a bigger company that can afford it.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 其他公司至少会提供试用版。最终，你必须为这些软件包的完整版本付费，这可能值得，尤其是对于能够承担得起的大公司来说。
- en: 'This book’s main focus is on free tools, however. When looking at free data
    visualization tools, you quickly end up in the HTML world, which proliferates
    with free JavaScript libraries to plot any data you want. The landscape is enormous:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，本书的主要重点是免费工具。在查看免费数据可视化工具时，你很快就会进入HTML世界，那里充满了免费JavaScript库，可以绘制你想要的任何数据。这个领域非常庞大：
- en: '***HighCharts*** —One of the most mature browser-based graphing libraries.
    The free license applies only to noncommercial pursuits. If you want to use it
    in a commercial context, prices range anywhere from $90 to $4000\. See [http://shop.highsoft.com/highcharts.html](http://shop.highsoft.com/highcharts.html).'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***HighCharts*** —最成熟的基于浏览器的图形库之一。免费许可证仅适用于非商业用途。如果你想在商业环境中使用它，价格从90美元到4000美元不等。请参阅[http://shop.highsoft.com/highcharts.html](http://shop.highsoft.com/highcharts.html)。'
- en: '***Chartkick*** —A JavaScript charting library for Ruby on Rails fans. See
    [http://ankane.github.io/chartkick/](http://ankane.github.io/chartkick/).'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***Chartkick*** —一个针对Ruby on Rails爱好者的JavaScript图表库。请参阅[http://ankane.github.io/chartkick/](http://ankane.github.io/chartkick/)。'
- en: '***Google Charts*** —The free charting library of Google. As with many Google
    products, it is free to use, even commercially, and offers a wide range of graphs.
    See [https://developers.google.com/chart/](https://developers.google.com/chart/).'
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***Google Charts*** —Google的免费图表库。与许多Google产品一样，它免费使用，甚至可以用于商业目的，并提供广泛的图表类型。请参阅[https://developers.google.com/chart/](https://developers.google.com/chart/)。'
- en: '***d3.js*** —This is an odd one out because it isn’t a graphing library but
    a data visualization library. The difference might sound subtle but the implications
    are not. Whereas libraries such as HighCharts and Google Charts are meant to draw
    certain predefined charts, d3.js doesn’t lay down such restrictions. d3.js is
    currently the most versatile JavaScript data visualization library available.
    You need only a quick peek at the interactive examples on the official website
    to understand the difference from a regular graph-building library. See [http://d3js.org/](http://d3js.org/).'
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***d3.js*** —这是一个与众不同的例子，因为它不是一个图形库，而是一个数据可视化库。这种差异可能听起来很微妙，但其影响却不容忽视。与HighCharts和Google
    Charts等库不同，它们旨在绘制某些预定义的图表，而d3.js没有这样的限制。d3.js目前是可用的最灵活的JavaScript数据可视化库。你只需快速浏览一下官方网站上的交互式示例，就能理解它与常规图形库之间的差异。请参阅[http://d3js.org/](http://d3js.org/)。'
- en: Of course, others are available that we haven’t mentioned.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，还有其他我们没有提到的工具。
- en: You can also get visualization libraries that only come with a trial period
    and no free community edition, such as Wijmo, Kendo, and FusionCharts. They are
    worth looking into because they also provide support and guarantee regular updates.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以获得只提供试用版而没有免费社区版的可视化库，例如Wijmo、Kendo和FusionCharts。它们值得一看，因为它们也提供支持和保证定期更新。
- en: 'You have options. But why or when would you even consider building your own
    interface with HTML5 instead of using alternatives such as SAP’s BusinessObjects,
    SAS JMP, Tableau, Clickview, or one of the many others? Here are a few reasons:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 你有选择。但为什么或何时你会考虑用HTML5而不是使用SAP的BusinessObjects、SAS JMP、Tableau、Clickview或其他许多替代品来构建自己的界面呢？以下是一些原因：
- en: '***No budget*** —When you work in a startup or other small company, the licensing
    costs accompanying this kind of software can be high.'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***没有预算*** — 当你在初创公司或其他小型公司工作时，这类软件的许可费用可能会很高。'
- en: '***High accessibility*** —The data science application is meant to release
    results to any kind of user, especially people who might only have a browser at
    their disposal—your own customers, for instance. Data visualization in HTML5 runs
    fluently on mobile.'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***高度可访问性*** — 数据科学应用旨在向任何类型的用户发布结果，特别是那些可能只有浏览器可用的人——比如你的客户。HTML5在移动设备上的数据可视化运行流畅。'
- en: '***Big pools of talent out there*** —Although there aren’t that many Tableau
    developers, scads of people have web-development skills. When planning a project,
    it’s important to take into account whether you can staff it.'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***外面有大量的人才*** — 虽然Tableau开发者并不多，但很多人有网页开发技能。在规划项目时，考虑你是否能够配备人员是很重要的。'
- en: '***Quick release*** —Going through the entire IT cycle might take too long
    at your company, and you want people to enjoy your analysis quickly. Once your
    interface is available and being used, IT can take all the time they want to industrialize
    the product.'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***快速发布*** — 在你的公司中，整个IT周期可能需要太长时间，你希望人们能够快速享受你的分析。一旦你的界面可用并被使用，IT就可以花他们想要的时间来工业化产品。'
- en: '***Prototyping*** —The better you can show IT its purpose and what it should
    be capable of, the easier it is for them to build or buy a sustainable application
    that does what you want it to do.'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***原型设计*** — 你能更好地向IT展示其目的和它应该具备的能力，那么他们就越容易构建或购买一个可持续的应用程序，使其能够完成你想要它完成的任务。'
- en: '***Customizability*** —Although the established software packages are great
    at what they do, an application can never be as customized as when you create
    it yourself.'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***可定制性*** — 虽然现有的软件包在其领域内做得很好，但应用程序永远无法像你自己创建时那样定制。'
- en: And why wouldn’t you do this?
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 那为什么不这样做呢？
- en: '***Company policy*** —This is the biggest one: it’s not allowed. Large companies
    have IT backup teams that allow only a certain number of tools to be used so they
    can keep their supporting role under control.'
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***公司政策*** — 这是最重要的一点：不允许。大型公司有IT支持团队，只允许使用一定数量的工具，以便他们能够控制其支持角色。'
- en: '***You have an experienced team of reporters at your disposal*** —You’d be
    doing their job, and they might come after you with pitchforks.'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***你有一支经验丰富的报告团队可供使用*** — 你会做他们的工作，他们可能会拿着长柄叉子来找你。'
- en: '***Your tool does allow enough customization to suit your taste*** —Several
    of the bigger platforms are browser interfaces with JavaScript running under the
    hood. Tableau, BusinessObjects Webi, SAS Visual Analytics, and so on all have
    HTML interfaces; their tolerance to customization might grow over time.'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***你的工具允许足够的定制以适应你的口味*** — 一些较大的平台是浏览器界面，底层运行JavaScript。Tableau、BusinessObjects
    Webi、SAS Visual Analytics等所有都有HTML界面；它们的定制容忍度可能会随着时间的推移而增长。'
- en: The front end of any application can win the hearts of the crowd. All the hard
    work you put into data preparation and the fancy analytics you applied is only
    worth as much as you can convey to those who use it. Now you’re on the right track
    to achieve this. On this positive note we’ll conclude this chapter.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 任何应用程序的前端都能赢得大众的心。你投入的所有数据准备工作和应用的复杂分析，只有当你能够传达给使用它的人时才有价值。现在你正走在实现这一目标的正确道路上。在这个积极的基调中，我们将结束本章。
- en: 9.5\. Summary
  id: totrans-188
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.5. 摘要
- en: This chapter focused on the last part of the data science process, and our goal
    was to build a data science application where the end user is provided with an
    interactive dashboard. After going through all the steps of the data science process,
    we’re presented with clean, often compacted or information dense, data. This way
    we can query less data and get the insights we want.
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章重点介绍了数据科学流程的最后部分，我们的目标是构建一个数据科学应用，其中最终用户可以获得一个交互式仪表板。经过数据科学流程的所有步骤后，我们得到了干净、通常紧凑或信息密集的数据。这样我们就可以查询更少的数据，并获得我们想要的分析结果。
- en: In our example, the pharmacy stock data is considered thoroughly cleaned and
    prepared and this should always be the case by the time the information reaches
    the end user.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在我们的例子中，药房库存数据被认为是彻底清洗和准备好的，并且信息到达最终用户时应该始终如此。
- en: JavaScript-based dashboards are perfect for quickly granting access to your
    data science results because they only require the user to have a web browser.
    Alternatives exist, such as Qlik ([chapter 5](kindle_split_013.xhtml#ch05)).
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于JavaScript的仪表板非常适合快速提供数据科学结果，因为它们只需要用户拥有一个网络浏览器。存在其他替代方案，例如Qlik（[第5章](kindle_split_013.xhtml#ch05)）。
- en: Crossfilter is a MapReduce library, one of many JavaScript MapReduce libraries,
    but it has proven its stability and is being developed and used by Square, a company
    that does monetary transactions. Applying MapReduce is effective, even on a single
    node and in a browser; it increases the calculation speed.
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Crossfilter是一个MapReduce库，是众多JavaScript MapReduce库之一，但它已经证明了其稳定性，并且正在由Square公司（一家从事货币交易的公司）开发和使用。即使在单个节点和浏览器中应用MapReduce也是有效的；它提高了计算速度。
- en: dc.js is a chart library build on top of d3.js and Crossfilter that allows for
    quick browser dashboard building.
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: dc.js是一个基于d3.js和Crossfilter构建的图表库，它允许快速构建浏览器仪表板。
- en: 'We explored the data set of a hospital pharmacy and built an interactive dashboard
    for pharmacists. The strength of a dashboard is its *self-service* nature: they
    don’t always need a reporter or data scientist to bring them the insights they
    crave.'
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们探索了医院药房的数据集，并为药剂师构建了一个交互式仪表板。仪表板的优势在于其*自助*特性：他们并不总是需要报告员或数据科学家来提供他们渴望的洞察。
- en: Data visualization alternatives are available, and it’s worth taking the time
    to find the one that suits your needs best.
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据可视化替代方案是可用的，花时间找到最适合你需求的方案是值得的。
- en: 'There are multiple reasons why you’d create your own custom reports instead
    of opting for the (often more expensive) company tools out there:'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你会创建自己的定制报告而不是选择（通常更昂贵）的公司工具，原因有很多：
- en: '***No budget*** —Startups can’t always afford every tool'
  id: totrans-197
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***没有预算*** —初创公司并不总是能负担得起每个工具'
- en: '***High accessibility*** —Everyone has a browser'
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***高度可访问性*** —每个人都有浏览器'
- en: '***Available talent*** —(Comparatively) easy access to JavaScript developers'
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***可用的人才*** —（相对）容易获得JavaScript开发者'
- en: '***Quick release*** —IT cycles can take a while'
  id: totrans-200
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***快速发布*** —IT周期可能需要一段时间'
- en: '***Prototyping*** —A prototype application can provide and leave time for IT
    to build the production version'
  id: totrans-201
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***原型设计*** —原型应用程序可以提供时间，让IT部门构建生产版本'
- en: '***Customizability*** —Sometimes you just want it exactly as your dreams picture
    it.'
  id: totrans-202
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***可定制性*** —有时你只想让它完全符合你的梦想。'
- en: 'Of course there are reasons against developing your own application:'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当然，也有反对开发自己的应用程序的理由：
- en: '***Company policy*** —Application proliferation isn’t a good thing and the
    company might want to prevent this by restricting local development.'
  id: totrans-204
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***公司政策*** —应用程序的扩散并不是好事，公司可能希望通过限制本地开发来防止这种情况。'
- en: '***Mature reporting team*** —If you have a good reporting department, why would
    you still bother?'
  id: totrans-205
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***成熟的报告团队*** —如果你有一个优秀的报告部门，你为什么还要费心呢？'
- en: '***Customization is satisfactory*** —Not everyone wants the shiny stuff; basic
    can be enough.'
  id: totrans-206
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***定制令人满意*** —并不是每个人都想要那些闪亮的东西；基本功能就足够了。'
- en: Congratulations! You’ve made it to the end of this book and the true beginning
    of your career as a data scientist. We hope you had ample fun reading and working
    your way through the examples and case studies. Now that you have basic insight
    into the world of data science, it’s up to you to choose a path. The story continues,
    and we all wish you great success in your quest of becoming the greatest data
    scientist who has ever lived! May we meet again someday. ;)
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你已经走完了这本书的结尾，也是你作为数据科学家职业生涯的真正开始。我们希望你在阅读和通过示例和案例研究的过程中玩得开心。现在你已经对数据科学的世界有了基本的了解，选择一条道路就取决于你了。故事还在继续，我们都祝愿你在成为有史以来最伟大的数据科学家的追求中取得巨大成功！愿我们有一天能再次相见。
    ;)
