- en: Part 4
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第四部分
- en: Bringing it all together
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 将所有内容整合在一起
- en: This part of the book pulls together everything covered in the previous chapters—styling,
    navigation, animations, and some of the cross-platform components—into a single
    app. We’ll start by looking at the final design and walking through a basic overview
    of what the app will do.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本书这一部分将前几章中涵盖的所有内容——样式、导航、动画以及一些跨平台组件——整合到一个应用程序中。我们将首先查看最终设计，并简要概述应用程序将执行的操作。
- en: You’ll create a new React Native application and install the React Navigation
    library, dive deep into styling both the components as well as the navigation
    UI, work with data from external network resources by using the Fetch API, and
    ultimately build out an application that allows users to view information about
    their favorite *Star Wars* characters.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 你将创建一个新的React Native应用程序并安装React Navigation库，深入探讨组件以及导航UI的样式，通过使用Fetch API处理外部网络资源的数据，并最终构建一个允许用户查看他们最喜欢的*星球大战*角色信息的应用程序。
- en: '12'
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '12'
- en: Building a Star Wars app using cross-platform components
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 使用跨平台组件构建星球大战应用
- en: '**This chapter covers**'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '**本章涵盖**'
- en: The basics of fetching data using the Fetch API
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Fetch API获取数据的基本方法
- en: Using a `Modal` component to show and hide views
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`Modal`组件显示和隐藏视图
- en: Creating a list using the `FlatList` component
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`FlatList`组件创建列表
- en: Using the `ActivityIndicator` to show loading state
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`ActivityIndicator`显示加载状态
- en: Using React Navigation in a real-world project to handle navigation
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在实际项目中使用React Navigation处理导航
- en: 'React Native ships with many components that are ready to use in your apps.
    Some of these components work cross-platform: that is, they work regardless of
    whether you’re running an app on iOS or Android. Other components are platform-specific:
    for example, `ActionSheetIOS` only runs on iOS, and `ToolbarAndroid` only runs
    on the Android platform (cross-platform components were covered in Chapters 10
    and 11).'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: React Native附带了许多可在应用程序中使用的组件。其中一些组件是跨平台的：也就是说，无论你在iOS还是Android上运行应用程序，它们都能工作。其他组件是平台特定的：例如，`ActionSheetIOS`仅在iOS上运行，而`ToolbarAndroid`仅在Android平台上运行（跨平台组件在第10章和第11章中已介绍）。
- en: 'This chapter covers some of the most-used cross-platform components and how
    to implement each one as you build a demo application. For this purpose, you’ll
    implement the following cross-platform components and APIs by building a cross-platform
    *Star Wars* information app:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了构建演示应用程序时使用的一些最常用的跨平台组件及其实现方法。为此，你将通过构建一个跨平台的*星球大战*信息应用来实现以下跨平台组件和API：
- en: Fetch API
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Fetch API
- en: '`Modal`'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Modal`'
- en: '`ActivityIndicator`'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ActivityIndicator`'
- en: '`FlatList`'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`FlatList`'
- en: '`Picker`'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Picker`'
- en: '`React-Navigation`'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`React-Navigation`'
- en: 'This app will access SWAPI, the Star Wars API ([https://swapi.co)](https://swapi.co)),
    and return information about *Star Wars* characters, starships, home planets,
    and more, as shown in [figure 12.1](#figure12.1). When a user clicks People, the
    app fetches the movie’s main cast from [https://swapi.co/api/people](https://swapi.co/api/people)
    and displays their information. In the process, the app uses several React Native
    cross-platform components. In this chapter, you’ll learn how to use these components
    as you do the following:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 此应用将访问SWAPI，即《星球大战》API（[https://swapi.co](https://swapi.co)），并返回有关*星球大战*角色、飞船、家园星球等信息，如图12.1所示。当用户点击“人物”时，应用从[https://swapi.co/api/people](https://swapi.co/api/people)获取电影的主要演员阵容并显示其信息。在这个过程中，应用使用了几个React
    Native跨平台组件。在本章中，你将学习如何在以下操作中使用这些组件：
- en: Set up a new React Native application and install dependencies
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置一个新的React Native应用程序并安装依赖项
- en: Import the `People` component and create the `Container` component
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导入`People`组件并创建`Container`组件
- en: Create the `Navigation` component and register routes
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建`Navigation`组件并注册路由
- en: Create the main class for the view
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建视图的主要类
- en: Create the `People` component
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建`People`组件
- en: Use the cross-platform components `FlatList`, `Modal`, and `Picker` to create
    the state and set up a fetch call to retrieve data
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用跨平台组件`FlatList`、`Modal`和`Picker`创建状态并设置获取数据的fetch调用
- en: '![c12_01.tif](Images/c12_01.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![c12_01.tif](Images/c12_01.png)'
- en: '[Figure 12.1](#figureanchor12.1) The completed *Star Wars* app that you’ll
    build with React Native cross-platform components. You’ll focus on the first link:
    People.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '[图12.1](#figureanchor12.1) 你将使用React Native跨平台组件构建的完成的*星球大战*应用程序。你将关注第一个链接：人物。'
- en: 12.1 Creating the app and installing dependencies
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.1 创建应用程序并安装依赖项
- en: 'The first thing you need to do is set up a new React Native application and
    install any dependencies required to build this app. Go to the command line, and
    create a React Native app by typing in the following:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要做的第一件事是设置一个新的 React Native 应用程序并安装构建此应用程序所需的任何依赖项。转到命令行，并输入以下内容创建一个 React
    Native 应用程序：
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Next, change into the newly created StarWarsApp directory:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，切换到新创建的 StarWarsApp 目录：
- en: '[PRE1]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The only thing you’ll need to install for this app is react-navigation, so
    install it using either npm or yarn:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要为这个应用程序安装的唯一东西是 react-navigation，所以你可以使用 npm 或 yarn 安装它：
- en: 'Using npm: `npm i react-navigation`'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 npm：`npm i react-navigation`
- en: 'Using yarn: `yarn add react-navigation`'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 yarn：`yarn add react-navigation`
- en: Now that the project is created, open App.js and create the components needed
    for the screen shown in [figure 12.2](#figure12.2). At the top of the file, import
    the components shown next.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 现在项目已创建，打开 App.js 并创建 [图 12.2](#figure12.2) 中显示的屏幕所需的组件。在文件顶部，导入以下组件。
- en: Listing 12.1 Importing the initial components
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12.1 导入初始组件
- en: '[PRE2]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: In this listing you import the required React Native components, as well as
    `createStackNavigator` from `react-navigation`. `FlatList` is a component that
    will allow you to render performant lists in an app using any array of data. `createStackNavigator`
    is a navigator from `react-navigation` that provides an easy way to navigate between
    scenes; each scene is pushed on top of a route stack. All the animations are configured
    for you and give the default iOS and Android feel and transitions.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个列表中，你导入了所需的 React Native 组件，以及来自 `react-navigation` 的 `createStackNavigator`。`FlatList`
    是一个组件，它允许你使用任何数据数组在应用程序中渲染性能列表。`createStackNavigator` 是来自 `react-navigation` 的一个导航器，它提供了一个在场景之间导航的简单方法；每个场景都推送到路由堆栈的顶部。所有动画都已为你配置好，并提供了默认的
    iOS 和 Android 感觉和过渡效果。
- en: 12.1.1 Importing the People component and creating the Container component
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.1 导入 People 组件并创建 Container 组件
- en: '![c12_02.tif](Images/c12_02.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![c12_02.tif](Images/c12_02.png)'
- en: '[Figure 12.2](#figureanchor12.2) The initial view of the app'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 12.2](#figureanchor12.2) 应用程序的初始视图'
- en: 'Next, you need to import the two views you’ll use in this app. Take another
    look at the first screen in [figure 12.2](#figure12.2). As you can see, there
    are links for People, Films, and so on. When the user clicks People, the app should
    navigate to a component that lists the people (main characters) in the *Star Wars*
    films. To do this, you’ll create a `People` component in section 12.2—you’ll import
    the component now and create it later. Below the last `import` in [listing 12.1](#listing12.1),
    import the yet-to-be-created `People` component:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你需要导入你将在应用程序中使用的两个视图。再次查看 [图 12.2](#figure12.2) 中的第一个屏幕。正如你所见，有 People、Films
    等链接。当用户点击 People 时，应用程序应该导航到一个列出 *星球大战* 电影中人物（主要角色）的组件。为此，你将在 12.2 节中创建一个 `People`
    组件——你现在将导入该组件，稍后创建它。在 [列表 12.1](#listing12.1) 的最后一个 `import` 下方，导入尚未创建的 `People`
    组件：
- en: '[PRE3]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Because the design uses a black color background and you don’t want to repeat
    styling code across components, let’s create a `Container` component that you’ll
    use as a wrapper for your views. This `Container` component will be strictly used
    for styling. In the root of the app, create a new file called Container.js, and
    enter the following code.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 由于设计使用黑色背景，并且你不想在组件之间重复样式代码，让我们创建一个 `Container` 组件，你将使用它作为视图的包装器。这个 `Container`
    组件将仅用于样式。在应用程序的根目录下创建一个名为 Container.js 的新文件，并输入以下代码。
- en: Listing 12.2 Creating a reusable `Container` component
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 12.2 创建可重用的 `Container` 组件
- en: '[PRE4]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Import the `Container` into the App.js file, below the last `import` of the
    `People` component:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 将 `Container` 导入到 App.js 文件中，在 `People` 组件的最后一个 `import` 下方：
- en: '[PRE5]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Below the `Container` import, create an array of data that you’ll use for the
    links. The items in the array will be passed to the `FlatList` component to create
    the list of links. This array should contain objects, and each object should contain
    a `title` key. You need the `title` key to display the name of the link:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `Container` 导入下方，创建一个数组，你将使用它来创建链接。数组中的项将被传递给 `FlatList` 组件以创建链接列表。此数组应包含对象，并且每个对象都应该包含一个
    `title` 键。你需要 `title` 键来显示链接的名称：
- en: '[PRE6]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 12.1.2 Creating the navigation component and registering routes
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.2 创建导航组件并注册路由
- en: At the bottom of the App.js file, you’ll next create the main navigation component
    and pass it to the `AppRegistry`. You’re using `createStackNavigator` as the navigation
    component, and you need to register the routes you’ll use in the application.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `App.js` 文件的底部，您接下来将创建主导航组件并将其传递给 `AppRegistry`。您正在使用 `createStackNavigator`
    作为导航组件，并且需要注册您将在应用程序中使用的路由。
- en: 'Initialize `createStackNavigator` and pass the navigator to the `AppRegistry`
    method, replacing the default `StarWars` component with the navigation component
    as shown in the following listing. `createStackNavigator` provides a way for the
    app to transition between screens: each new screen is placed on top of a stack
    and is a cross-platform component.'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 初始化 `createStackNavigator` 并将导航器传递给 `AppRegistry` 方法，用导航组件替换默认的 `StarWars` 组件，如下所示。`createStackNavigator`
    为应用提供在屏幕之间切换的方式：每个新的屏幕都放置在堆栈的顶部，并且是一个跨平台组件。
- en: Listing 12.3 Using `createStackNavigator`
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 清单 12.3 使用 `createStackNavigator`
- en: '[PRE7]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 12.1.3 Creating the main class for the initial view
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.3 创建初始视图的主类
- en: In App.js, below the links array you created in section 12.1.1, add the main
    class for the view ([listing 12.4](#listing12.4)). This class returns a list that
    will render all the movie characters who come back from the API. You’ll also set
    the header title using the `navigationOptions` static property and set the logo
    in the header. You’ll render this list using `FlatList` from React Native. It’s
    a built-in interface for rendering simple lists in a React Native app.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `App.js` 文件中，在您在 12.1.1 节中创建的链接数组下方，添加视图的主类（[清单 12.4](#listing12.4)）。这个类返回一个列表，将渲染从
    API 返回的所有电影角色。您还将使用 `navigationOptions` 静态属性设置标题，并在头部设置标志。您将使用 React Native 的
    `FlatList` 渲染这个列表。它是用于在 React Native 应用中渲染简单列表的内置界面。
- en: Listing 12.4 Creating the main `StarWars` component
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 清单 12.4 创建主 `StarWars` 组件
- en: '[PRE8]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![c12_03.png](Images/c12_03.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![c12_03.png](Images/c12_03.png)'
- en: '[Figure 12.3](#figureanchor12.3) Components and title for the `StarWars` component'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '[图 12.3](#figureanchor12.3) `StarWars` 组件的组件和标题'
- en: Because you’re using `createStackNavigator` from `react-navigation`, you can
    pass in configuration for each route. In this route, you want to change the default
    header configuration and styling. To do so, you create a static `navigationOptions`
    object, and in it you pass in a `headerTitle` component containing a title and
    a `headerStyle` object containing some specific styling. The `headerTitle` is
    the text you’ll use as the logo, and `headerStyle` sets the background color to
    black and gives a set height to fit the text.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 因为您正在使用来自 `react-navigation` 的 `createStackNavigator`，您可以传递每个路由的配置。在这个路由中，您想要更改默认的头部配置和样式。为此，您创建一个静态的
    `navigationOptions` 对象，并在其中传递一个包含标题的 `headerTitle` 组件和一个包含一些特定样式的 `headerStyle`
    对象。`headerTitle` 是您将用作标志的文本，而 `headerStyle` 将背景颜色设置为黑色，并设置一个固定高度以适应文本。
- en: The `navigate` method takes a link as an argument. Any component rendered by
    `StackNavigation` receives the navigation object as a prop. You use this prop
    to destructure the `navigate` method and then navigate to the link passed in.
    The link, in this case the `title` property in the links array, correlates with
    the keys passed in to `createStackNavigator`.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '`navigate` 方法接收一个链接作为参数。由 `StackNavigation` 渲染的任何组件都接收导航对象作为属性。您使用此属性解构 `navigate`
    方法，然后导航到传入的链接。在这种情况下，链接是链接数组中的 `title` 属性，与传递给 `createStackNavigator` 的键相关联。'
- en: '`FlatList` takes a `renderItem` method that loops through the array of data
    passed in as the `data` property and returns an object with an `item` and an `index`
    for each item in the array. The `item` is the actual item with all its properties,
    and the `index` is the index of the item. You destructure these as arguments,
    pass `item` as an argument to `navigate` to display the title, and use `index`
    to apply a `borderTop` style if it’s the first array item.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '`FlatList` 接收一个 `renderItem` 方法，该方法遍历作为 `data` 属性传入的数据数组，并为数组中的每个项目返回一个包含 `item`
    和 `index` 的对象。`item` 是具有所有属性的真正项目，而 `index` 是项目的索引。您将这些作为参数解构，将 `item` 作为参数传递给
    `navigate` 以显示标题，并使用 `index` 在它是第一个数组项时应用 `borderTop` 样式。'
- en: '`render()` returns the `Container`, and in it you wrap the `FlatList` passing
    in links as the data and the `renderItem` method you created earlier. You also
    pass in a `keyExtractor` method. If there’s no item labeled `key` in the array,
    you have to tell the `FlatList` which item to use as its key; otherwise it will
    throw an error. [Figure 12.3](#figure12.3) shows the initial application view
    with its components. The final code for App.js is at [www.manning.com/books/react-native-in-action](http://www.manning.com/books/react-native-in-action)
    and on GitHub at [https://github.com/dabit3/react-native-in-action/blob/chapter12/StarWars/App.js](https://github.com/dabit3/react-native-in-action/blob/chapter12/StarWars/App.js).'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '`render()`返回`Container`，在其中你包装`FlatList`，传入作为数据链接和之前创建的`renderItem`方法。你还传入一个`keyExtractor`方法。如果数组中没有标记为`key`的项目，你必须告诉`FlatList`使用哪个项目作为其键；否则它将抛出错误。[图12.3](#figure12.3)显示了应用程序的初始视图及其组件。App.js的最终代码在[www.manning.com/books/react-native-in-action](http://www.manning.com/books/react-native-in-action)和GitHub上[https://github.com/dabit3/react-native-in-action/blob/chapter12/StarWars/App.js](https://github.com/dabit3/react-native-in-action/blob/chapter12/StarWars/App.js)。'
- en: 12.2 Creating the People component using FlatList, Modal, and Picker
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.2 使用FlatList、Modal和Picker创建People组件
- en: Next you’ll create a `People` component to fetch and display information about
    the *Star Wars* cast that you get from the Star Wars API ([figure 12.4](#figure12.4)).
    As part of this component, you’ll use the React Native cross-platform components
    `Modal` and `Picker`. `Modal` lets you display an element on top of whatever view
    you’re currently working in. `Picker` displays a scrollable list of options or
    values; this component provides a convenient means of capturing input from a user
    and making their selection available to the rest of the application.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你将创建一个`People`组件来获取并显示从星球大战API ([图12.4](#figure12.4)) 获取的*星球大战*演员信息。作为此组件的一部分，你将使用React
    Native跨平台组件`Modal`和`Picker`。`Modal`允许你在当前正在工作的视图之上显示一个元素。`Picker`显示一个可滚动的选项或值列表；此组件提供了一个方便的方法来捕获用户的输入并使他们的选择对应用程序的其余部分可用。
- en: '![c12_04.tif](Images/c12_04.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![c12_04.tif](Images/c12_04.png)'
- en: '[Figure 12.4](#figureanchor12.4) This component will display the `Loading`
    (left) and `Loaded` (middle) state of the People.js screen. It will also allow
    you to view each character’s home world information (right).'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '[图12.4](#figureanchor12.4) 此组件将显示People.js屏幕的`Loading`（左侧）和`Loaded`（中间）状态。它还将允许你查看每个角色的家乡信息（右侧）。'
- en: 'When the `People` component loads, it will start with an empty data array,
    a `loading` state of `true`, and with a few other pieces of state:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 当`People`组件加载时，它将从一个空的数据数组开始，一个`loading`状态为`true`，以及一些其他的状态：
- en: '[PRE9]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: When the component mounts, you’ll fetch the data you need from the Star Wars
    API at [https://swapi.co/api/people](https://swapi.co/api/people); and when this
    data returns, you’ll populate the data array with the returned data, and set the
    `loading` Boolean to `false`.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 当组件挂载时，你将从星球大战API [https://swapi.co/api/people](https://swapi.co/api/people)
    获取所需的数据；当这些数据返回时，你将使用返回的数据填充数据数组，并将`loading`布尔值设置为`false`。
- en: You’ll use the `modalVisble` Boolean to show and hide the `Modal` component
    that will fetch information about the character’s home world. You’ll use `pickerVisible`
    to show and hide a `Picker` component that will let you choose the gender of the
    person you want to view, and will pass the result to a filter that will filter
    the results accordingly.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你将使用`modalVisible`布尔值来显示和隐藏用于获取角色家乡信息的`Modal`组件。你将使用`pickerVisible`来显示和隐藏一个`Picker`组件，该组件将允许你选择你想要查看的人的性别，并将结果传递给一个过滤器，以便相应地过滤结果。
- en: Creating a new file, People.js, and begin coding.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的文件，People.js，并开始编码。
- en: Listing 12.5 People.js imports
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.5 People.js导入
- en: '[PRE10]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: The Lodash utility library provides many convenience functions. You’ll need
    to install it via npm or yarn prior to importing it here.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: Lodash实用库提供了许多便利函数。在导入之前，你需要通过npm或yarn安装它。
- en: The next step is to create the main class for the component and set up the `navigationOptions`
    to give the header a title as well as some styling. Under the last import in People.js,
    create the following `People` class.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是创建组件的主要类并设置`navigationOptions`以给标题添加标题以及一些样式。在People.js中的最后一个导入下面，创建以下`People`类。
- en: Listing 12.6 Creating the `People` class and setting up the page title
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 列表12.6 创建`People`类并设置页面标题
- en: '[PRE11]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The static `navigationOptions` property is created here, as in the App.js file,
    but instead of passing in a component as the `headerTitle`, you pass in the string
    “People”. You also add some styling.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里创建了静态的 `navigationOptions` 属性，就像在 App.js 文件中一样，但不是传递一个组件作为 `headerTitle`，而是传递字符串“People”。你还在其中添加了一些样式。
- en: 12.2.1 Creating the state and setting up a fetch call to retrieve data
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.1 创建状态并设置一个用于检索数据的 `fetch` 调用
- en: Now you’ll create the state and set up a `fetch` call on `componentDidMount`.
    Fetch is a cross-platform API for fetching network resources that’s supplanting
    `XMLHttpRequest`. Fetch isn’t yet 100% compatible with all internet browsers,
    but React Native provides a polyfill (an API that mimics the behavior of the original
    API, in this case Fetch). The Fetch API is an easy-to-use-out-of-the-box way to
    work with network requests, including ``GET, `POST`, `PUT`, and `DELETE`. `fetch`
    returns a promise, which makes it easy to work with asynchronously.``
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你将创建状态并在 `componentDidMount` 中设置一个 `fetch` 调用。Fetch 是一个跨平台的 API，用于获取网络资源，它正在取代
    `XMLHttpRequest`。Fetch 还未与所有互联网浏览器完全兼容，但 React Native 提供了一个 polyfill（一个模拟原始 API
    行为的 API，在这种情况下是 Fetch）。Fetch API 是一种易于使用的现成方式来处理网络请求，包括 `GET`、`POST`、`PUT` 和 `DELETE`。`fetch`
    返回一个承诺，这使得异步处理变得容易。``
- en: '[PRE12]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
