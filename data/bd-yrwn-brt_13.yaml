- en: Appendix B. Configuring the Raspberry Pi
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 B. 配置 Raspberry Pi
- en: This appendix covers the installation and configuration of the main pieces of
    software on the Raspberry Pi. First, the Raspberry Pi OS Linux distribution will
    be installed on the computer. Then, Python will be configured so as to have a
    dedicated virtual environment where Python libraries can be installed. The Adafruit
    CRICKIT library will be installed next, which will then be used to run Python
    code to interact with the CRICKIT hardware.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录涵盖了 Raspberry Pi 上主要软件的安装和配置。首先，将在计算机上安装 Raspberry Pi OS Linux 发行版。然后，将配置
    Python，以便有一个专用的虚拟环境，可以在其中安装 Python 库。接下来将安装 Adafruit CRICKIT 库，然后使用它来运行 Python
    代码以与 CRICKIT 硬件交互。
- en: B.1 Setting up the Raspberry Pi
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.1 设置 Raspberry Pi
- en: 'The Raspberry Pi official documentation ([https://raspberrypi.com/documentation/](https://raspberrypi.com/documentation/))
    page is an excellent source when working with the Raspberry Pi. The following
    sections of the documentation are good to look at for the projects in the book:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: Raspberry Pi 官方文档（[https://raspberrypi.com/documentation/](https://raspberrypi.com/documentation/））页面是使用
    Raspberry Pi 时的优秀资源。对于书中的项目，以下文档部分值得查看：
- en: 'Getting started: This page has detailed information on installing the operating
    system and using Raspberry Pi Imager.'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 入门：此页面提供了有关安装操作系统和使用 Raspberry Pi Imager 的详细信息。
- en: 'Configuration: Details on using the `raspi-config` tool can be found here.'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置：有关使用 `raspi-config` 工具的详细信息，请在此处查看。
- en: 'Remote access: It covers connecting to your Pi with SSH, transferring files,
    and using the VNC software to remotely access the desktop.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程访问：它涵盖了使用 SSH 连接到您的 Pi、传输文件以及使用 VNC 软件远程访问桌面。
- en: 'To install the Raspberry Pi OS, do the following:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装 Raspberry Pi OS，请执行以下操作：
- en: Visit [http://mng.bz/JdN0](http://mng.bz/JdN0).
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 访问 [http://mng.bz/JdN0](http://mng.bz/JdN0)。
- en: Click on Raspberry Pi OS link and download the “Raspberry Pi OS with desktop”
    image. This will download the latest release. For reference, the code in the book
    was tested with the 2022-04-04 32-bit release of Raspberry Pi OS. The desktop
    image comes with a desktop environment, which will be useful when we create graphical
    applications for the robot projects.
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 Raspberry Pi OS 链接并下载“带有桌面的 Raspberry Pi OS”镜像。这将下载最新版本。为了参考，书中的代码是在 2022-04-04
    32 位 Raspberry Pi OS 版本上测试的。桌面镜像包含桌面环境，这对于我们为机器人项目创建图形应用程序将很有用。
- en: Click on the “Raspberry Pi Imager” link and follow the instructions for downloading
    and installing the Imager software.
  id: totrans-10
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“Raspberry Pi Imager”链接，按照说明下载和安装 Imager 软件。
- en: The Raspberry Pi 4 can be installed and booted from either a microSD card or
    a USB flash drive. USB flash drives offer better performance and are the recommended
    option.
  id: totrans-11
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Raspberry Pi 4 可以从 microSD 卡或 USB 闪存驱动器安装和启动。USB 闪存驱动器提供更好的性能，是推荐选项。
- en: Use the Imager software to prepare the installation media with the downloaded
    image (microSD card/USB flash drive).
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Imager 软件准备安装介质，使用下载的镜像（microSD 卡/USB 闪存驱动器）。
- en: Once the Raspberry Pi has booted with the installer, click Next at the welcome
    screen.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦 Raspberry Pi 使用安装程序启动，请在欢迎屏幕上点击“下一步”。
- en: Set the value for country, and then set the username as `robo`, and continue
    with the configuration steps.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置国家值，然后设置用户名为 `robo`，并继续配置步骤。
- en: After reboot, we will use the Raspberry Pi configuration tool to configure the
    Pi further.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新启动后，我们将使用 Raspberry Pi 配置工具进一步配置 Pi。
- en: Use the tool to set the hostname to `robopi`. Figure B.1 shows the screen used
    to change the hostname on the Raspberry Pi.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用此工具将主机名设置为 `robopi`。图 B.1 显示了用于更改 Raspberry Pi 上主机名的屏幕。
- en: '![](../Images/APPB_F01_Alsabbagh.png)'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图片](../Images/APPB_F01_Alsabbagh.png)'
- en: 'Figure B.1 Change hostname: use the Raspberry Pi configuration tool to change
    the hostname.'
  id: totrans-18
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 B.1 更改主机名：使用 Raspberry Pi 配置工具更改主机名。
- en: Next, use the configuration tool to enable the SSH, VNC, and I2C interfaces.
    Figure B.2 shows what the interfaces screen will look like once we have enabled
    these interfaces.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，使用配置工具启用 SSH、VNC 和 I2C 接口。图 B.2 显示了启用这些接口后接口屏幕将呈现的样子。
- en: '![](../Images/APPB_F02_Alsabbagh.png)'
  id: totrans-20
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![图片](../Images/APPB_F02_Alsabbagh.png)'
- en: 'Figure B.2 Enabling interfaces: This screen can be used to enable different
    interfaces.'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 图 B.2 启用接口：此屏幕可用于启用不同的接口。
- en: Now reboot the Pi for the changes to take effect.
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，重新启动 Pi 以使更改生效。
- en: Connect the Raspberry Pi to the network either by connecting a network cable
    to the Ethernet port or joining a Wi-fi network.
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过将网络电缆连接到以太网端口或加入 Wi-fi 网络，将 Raspberry Pi 连接到网络。
- en: Get the IP address of the machine by running `hostname -I` in the terminal.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在终端中运行 `hostname -I` 命令来获取机器的 IP 地址。
- en: From another computer on the network, test that you can SSH to the Raspberry
    Pi using its IP address as the user `robo`. You can now use SSH to run commands
    and execute Python scripts on the Pi from any computer on your network.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从网络上的另一台计算机，测试您是否可以使用用户 `robo` 通过 IP 地址 SSH 到 Raspberry Pi。现在您可以使用 SSH 从网络上的任何计算机运行命令和执行
    Python 脚本。
- en: You can also connect to the Raspberry Pi using its hostname `robopi`. To do
    this, you will need to add a line to your client machine’s hosts file with the
    `robopi` hostname and its associated IP address. The How-To Geek website provides
    an excellent guide on how to edit the hosts file on Windows, Mac, and Linux ([http://mng.bz/5owz](http://mng.bz/5owz)).
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您也可以通过其主机名 `robopi` 连接到 Raspberry Pi。为此，您需要在客户端机器的 hosts 文件中添加一行，包含 `robopi`
    主机名及其关联的 IP 地址。How-To Geek 网站提供了一个关于如何在 Windows、Mac 和 Linux 上编辑 hosts 文件的优秀指南（[http://mng.bz/5owz](http://mng.bz/5owz)）。
- en: The `sftp` command or the FileZilla application are both popular choices to
    transfer files to and from the Pi over the network. If your computer is running
    Linux, then `sshfs` is an excellent way to mount and work with remote files on
    the Pi as if they were local files.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`sftp` 命令或 FileZilla 应用程序都是将文件在网络中传输到 Pi 的流行选择。如果您的计算机正在运行 Linux，那么 `sshfs`
    是将远程文件挂载并作为本地文件在 Pi 上工作的绝佳方式。'
- en: Now that we have the main configuration steps completed for the Raspberry Pi,
    we can move on to configuring the Adafruit CRICKIT HAT.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经完成了 Raspberry Pi 的主要配置步骤，我们可以继续配置 Adafruit CRICKIT HAT。
- en: B.2 Setting up the Adafruit CRICKIT HAT
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.2 设置 Adafruit CRICKIT HAT
- en: 'Follow these steps to complete the hardware and software configuration of the
    Adafruit CRICKIT HAT:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤完成 Adafruit CRICKIT HAT 的硬件和软件配置：
- en: There is a very comprehensive guide on the Adafruit website for setting up the
    CRICKIT HAT and troubleshooting any issues. We will refer to specific sections
    in the next steps ([http://mng.bz/wj5q](http://mng.bz/wj5q)).
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Adafruit 网站上有一份非常全面的指南，用于设置 CRICKIT HAT 和解决任何问题。在下一步中，我们将参考具体部分（[http://mng.bz/wj5q](http://mng.bz/wj5q)）。
- en: Before using the CRICKIT HAT for the first time, it is best to update its firmware.
    In the Adafruit learning guide, follow the steps in the “Update Your CRICKIT”
    section.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一次使用 CRICKIT HAT 之前，最好更新其固件。在 Adafruit 学习指南中，按照“更新您的 CRICKIT”部分中的步骤操作。
- en: Switch off the Raspberry Pi. To attach the CRICKIT HAT to the Raspberry Pi,
    first connect the header standoff that comes with the CRICKIT to the Raspberry
    Pi GPIO connector. Then connect the CRICKIT HAT.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关闭 Raspberry Pi。要将 CRICKIT HAT 连接到 Raspberry Pi，首先将随 CRICKIT 一起提供的头对齐支架连接到 Raspberry
    Pi 的 GPIO 连接器。然后连接 CRICKIT HAT。
- en: Connect the power cable into the CRICKIT DC jack, and switch on the CRICKIT
    power switch. Check whether the CRICKIT LED is green, which indicates there is
    a healthy power supply.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将电源线插入 CRICKIT DC 插座，并打开 CRICKIT 电源开关。检查 CRICKIT LED 是否为绿色，这表示有健康的电源供应。
- en: Power on the Raspberry Pi, and open a terminal or open an SSH connection to
    it.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 Raspberry Pi，并打开一个终端或打开到它的 SSH 连接。
- en: 'Run the `i2cdetect` command, and check that the i2c address `0x49` appears
    in the output. The address will appear as the text `49` as shown:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行 `i2cdetect` 命令，并检查 i2c 地址 `0x49` 是否出现在输出中。地址将显示为文本 `49`，如下所示：
- en: '[PRE0]'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Run the following commands to update the software packages:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令以更新软件包：
- en: '[PRE1]'
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Run the following command to reboot the machine:'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令以重启机器：
- en: '[PRE2]'
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'After rebooting, reconnect to the machine, and run the following lines to create
    a Python virtual environment and install the Adafruit CRICKIT library in that
    virtual environment:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重启后，重新连接到机器，并运行以下行以创建 Python 虚拟环境并在其中安装 Adafruit CRICKIT 库：
- en: '[PRE3]'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Run the next line to add the `activate` Bash alias that can be used to activate
    the Python virtual environment whenever needed. After running the command, open
    a new terminal for the new alias to take effect:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行下一行以添加 `activate` Bash 别名，该别名可以在需要时激活 Python 虚拟环境。运行命令后，打开一个新的终端以使新别名生效：
- en: '[PRE4]'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The next command will start a Python read–evaluate–print loop (REPL) session
    in the virtual environment:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一行命令将在虚拟环境中启动一个 Python 读取-评估-打印循环（REPL）会话：
- en: '[PRE5]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Run the following Python code in the REPL, and confirm that the on-board Neopixel
    turns red to configure the Adafruit CRICKIT HAT:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 REPL 中运行以下 Python 代码，并确认板载 Neopixel 变红以配置 Adafruit CRICKIT HAT：
- en: '[PRE6]'
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: B.3 Activating the Python virtual environment
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: B.3 激活 Python 虚拟环境
- en: We have now completed the setup and created a Python virtual environment. These
    virtual environments are a great way to keep our set of installed Python packages
    and environment separate from the system Python environment used by the operating
    system. In this way, we can recreate our robot’s Python environment anytime we
    want without impacting the system installation. We can also install whatever packages
    and versions of them we want without worrying about breaking the Python packages
    the operating system is using. For more details on Python virtual environments,
    check the official documentation ([https://docs.python.org/3/library/venv.html](https://docs.python.org/3/library/venv.html)),
    which is a great resource on the topic.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经完成了设置并创建了一个 Python 虚拟环境。这些虚拟环境是保持我们已安装的 Python 包和环境与操作系统使用的系统 Python 环境分离的绝佳方式。这样，我们可以在任何时候重新创建机器人的
    Python 环境，而不会影响系统安装。我们还可以安装我们想要的任何包及其版本，而不用担心会破坏操作系统正在使用的 Python 包。有关 Python 虚拟环境的更多详细信息，请参阅官方文档（[https://docs.python.org/3/library/venv.html](https://docs.python.org/3/library/venv.html)），这是一个关于该主题的极好资源。
- en: There are some common operations with virtual environments that we will cover
    in this section. When you open a terminal or SSH to the Pi, you will get a prompt
    that looks like
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将介绍一些与虚拟环境相关的常见操作。当你打开终端或通过 SSH 连接到 Pi 时，你会得到一个看起来像的提示符
- en: '[PRE7]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'At this point, we have not activated our virtual environment. We can ask the
    terminal the location of the Python interpreter it would use with the following
    command:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们还没有激活我们的虚拟环境。我们可以使用以下命令询问终端它将使用哪个 Python 解释器：
- en: '[PRE8]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'The output shows the location of the Python interpreter used by the operating
    system. Now run the `activate` command to activate our virtual environment:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 输出显示了操作系统使用的 Python 解释器的位置。现在运行 `activate` 命令以激活我们的虚拟环境：
- en: '[PRE9]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'We can see that the text `(pyenv)` appears at the start of the prompt to indicate
    that we are in our Python virtual environment created in the previous section
    and called `pyenv`. We can now check the location of the Python interpreter again
    with the `which` command:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，提示符开头出现了 `(pyenv)` 文本，这表明我们处于上一节创建的名为 `pyenv` 的 Python 虚拟环境中。现在我们可以使用
    `which` 命令再次检查 Python 解释器的位置：
- en: '[PRE10]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'We can see whether it is using the Python interpreter in the virtual environment
    we have created for our robot projects. Now, we can open a REPL session in our
    virtual environment with the following command:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以查看它是否正在使用为我们的机器人项目创建的虚拟环境中的 Python 解释器。现在，我们可以使用以下命令在我们的虚拟环境中打开一个 REPL 会话：
- en: '[PRE11]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Press Ctrl+D to exit the REPL session. Now, when we execute Python scripts,
    they will run in our virtual environment and will be able to use the Python packages
    that we have installed.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 按下 Ctrl+D 退出 REPL 会话。现在，当我们执行 Python 脚本时，它们将在我们的虚拟环境中运行，并且能够使用我们已安装的 Python
    包。
