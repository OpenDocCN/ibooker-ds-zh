- en: 2 Measuring churn
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2 测量流失
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Identifying churned accounts and calculating the churn rate
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别流失账户和计算流失率
- en: Calculating the net retention rate and churn rates based on monthly recurring
    revenue
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据月度经常性收入计算净留存率和流失率
- en: Converting churn rates between monthly and annual measurements
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在月度和年度测量之间转换流失率
- en: You have already learned that the churn rate is a measurement of the proportion
    of customers who quit every month or year. If you don’t measure churn correctly,
    it’s that much harder to do anything about it. This chapter teaches you multiple
    definitions of churn that are suitable for different business scenarios and how
    to calculate them efficiently from a subscription database. Recalling the overall
    book scenario introduced in chapter 1, this chapter focuses on the process highlighted
    in figure 2.1.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经了解到，流失率是衡量每月或每年退出客户的比例的度量。如果你没有正确测量流失，那么采取任何措施都会更加困难。本章教你多个适合不同业务场景的流失定义，以及如何从订阅数据库中高效地计算它们。回顾第1章中引入的整体书籍场景，本章重点介绍图2.1中突出的过程。
- en: '![](../Images/2-01.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-01.png)'
- en: Figure 2.1 The subjects of this chapter in the process of fighting churn with
    data
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.1 本章主题在利用数据对抗流失的过程中
- en: 'Calculating the churn rate really is not rocket science, but you do need to
    know some intermediate SQL and a couple of algebraic equations. There are a few
    things that make calculating churn rates nontrivial. Part of the challenge is
    complexity, and another is logistical. The complexity in calculating churn is
    that an account can have multiple subscriptions over its lifetime, including the
    following:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 计算流失率实际上并不是火箭科学，但你确实需要了解一些中级SQL和几个代数方程。有几个因素使得计算流失率变得非同寻常。部分挑战在于复杂性，另一个挑战则是后勤。计算流失率的复杂性在于一个账户在其生命周期内可能有多个订阅，包括以下内容：
- en: Accounts can churn and sign up again any number of times. This is true for all
    subscription products and services.
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 账户可以多次流失并再次注册。这对于所有订阅产品和服务都是正确的。
- en: For many subscription services, accounts can hold multiple subscriptions for
    different products simultaneously. This is especially common for B2B products
    and services.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于许多订阅服务，账户可以同时持有多个不同产品的订阅。这在B2B产品和服务中尤为常见。
- en: Normally, there isn’t a field or flag on a subscription or account saying, “This
    is a churn.” Rather, churn is a dynamic state for each account that must be determined
    at a given point in time. For that matter, if there is a field or flag on an account
    or subscription that says it’s a churn, you are probably the person who has to
    calculate it, because you’re the data person—right?
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，订阅或账户上没有字段或标志表明“这是流失”。相反，流失是每个账户在特定时间点的动态状态，必须在此时刻确定。就此而言，如果账户或订阅上有字段或标志表明它是流失，那么你很可能是需要计算它的人，因为你就是数据人员——对吗？
- en: 'There is also a logistical challenge in calculating churn: first, the data
    is sensitive. For any subscription product or service, the subscription database
    is one of its most valuable assets. The subscription database usually contains
    personally identifiable information (PII) for the subscribers and sensitive financial
    information for the company. This is not data you want to extract and leave lying
    around in unsecure locations. The second pitfall is one that comes with success:
    if your product or service is successful, this data is big. For both of these
    reasons, taking the data out of the database for processing is not a good idea.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在计算流失率时也存在后勤挑战：首先，数据是敏感的。对于任何订阅产品或服务，订阅数据库是其最有价值的资产之一。订阅数据库通常包含订阅者的个人可识别信息（PII）和公司的敏感财务信息。这不是你希望提取并留存在不安全位置的数据。第二个陷阱是随着成功而来的：如果你的产品或服务成功，这些数据量会很大。出于这两个原因，从数据库中提取数据进行处理并不是一个好主意。
- en: 'The problem then is that dynamic logic is necessary to calculate churn, but
    you’re better off doing what needs to be done in the database without extracting
    the data. For that reason, I will show you how to calculate churn using multipart
    SQL statements that return the result as the output of a `SELECT` statement (to
    be fair, I call these SQL programs). This is a best practice that recurs throughout
    the book: do as much of the work as possible in the database or data warehouse,
    and extract reduced data only when necessary. This may seem foreign or even frustrating
    if you are used to doing this sort of logic and calculation in a procedural language
    like Python. Although it is possible to do these tasks in Python, that approach
    doesn’t scale nearly as well as the in-database approach taught in this book.
    Once you get used to processing data in the database with multipart SQL programs,
    you will wonder how you ever got by without it!'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 那么问题就是，计算客户流失需要动态逻辑，但你最好在数据库中完成需要做的事情，而不是提取数据。因此，我将向你展示如何使用多部分SQL语句来计算客户流失，并将结果作为SELECT语句的输出（公平地说，我称这些SQL程序）。这是本书中反复出现的一个最佳实践：尽可能在数据库或数据仓库中完成工作，仅在必要时提取减少的数据。如果你习惯于在Python这样的过程语言中进行这种逻辑和计算，这可能会显得有些陌生，甚至令人沮丧。虽然可以在Python中完成这些任务，但这种方法与本书中教授的数据库方法相比，可扩展性差得多。一旦你习惯了使用多部分SQL程序在数据库中处理数据，你可能会
    wonder how you ever got by without it!
- en: 'Here’s how this chapter is organized:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的组织结构如下：
- en: Section 2.1 shows you the concept of churn in a diagram and a few equations
    before you do any coding.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.1节在你开始编码之前，通过图表和几个方程式展示了客户流失的概念。
- en: Section 2.2 shows you what a typical subscription database looks like; you will
    use that sample database structure in churn calculations.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.2节展示了典型的订阅数据库的外观；你将在客户流失计算中使用该示例数据库结构。
- en: Section 2.3 begins the churn calculations with net retention, which is a common
    metric related to churn. (There is a related net churn measurement—but as I will
    explain, people don’t use it much.) Net retention comes first because it is straightforward
    conceptually, the easiest to calculate, and sufficient for simple subscription
    scenarios.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.3节从净保留率开始进行客户流失计算，这是一个与客户流失相关的常见指标。（还有一个相关的净流失率测量，但正如我将解释的，人们很少使用它。）净保留率首先出现，因为它在概念上很简单，计算起来最容易，并且对于简单的订阅场景来说足够了。
- en: Section 2.4 teaches you the standard churn rate calculation, which is more generally
    applicable but a little more complicated than net retention.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.4节教你标准客户流失率的计算方法，它更普遍适用，但比净保留率稍微复杂一些。
- en: Section 2.5 considers the case of churn calculations when there are not subscriptions
    but customers have repeated use of a product or service. These techniques are
    suitable for advertising or in-app purchase products.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.5节考虑了在没有订阅但客户对产品或服务有重复使用的情况下的客户流失计算。这些技术适用于广告或应用内购买产品。
- en: Section 2.6 covers revenue churn measurement, known as monthly recurring revenue
    (MRR) churn; it is suitable for complex subscription services.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.6节涵盖了收入流失率的测量，称为月度经常性收入（MRR）流失率；它适用于复杂的订阅服务。
- en: Section 2.7 explains how to convert a one-year churn rate into a monthly churn
    rate and vice versa.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第2.7节解释了如何将一年的客户流失率转换为月度流失率，反之亦然。
- en: Code for fighting churn with data
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 用于数据驱动的客户流失应对代码
- en: 'All of the source code for this book is available on the book’s website ([www.manning
    .com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data))
    and in the book’s GitHub repository ([https:// github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)).
    Listings from the book are in the folder /listings. See the repository README
    page for detailed setup instructions. In summary, you need to perform the following
    steps to run the code listings in this book:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的所有源代码都可在本书的网站上找到（[www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data)）和本书的GitHub仓库中（[https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)）。本书的列表在文件夹/listings中。请参阅仓库的README页面以获取详细的设置说明。总之，你需要执行以下步骤来运行本书中的代码列表：
- en: Install Python and Postgres. I also recommend installing the free GUI tools
    to work with them. If you are already an expert with these tools, then use your
    favorites; but if not, follow the setup instructions in the README precisely.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装Python和Postgres。我还推荐安装免费的GUI工具来与之一起使用。如果你已经是这些工具的专家，那么使用你喜欢的工具；如果不是，请严格按照README中的设置说明操作。
- en: Create a database schema with `fight-churn/data-generation/churndb.py`.
  id: totrans-25
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `fight-churn/data-generation/churndb.py` 创建数据库模式。
- en: Generate simulation data and save it into the Postgres schema with `fight-churn/data-generation/churnsim.py`.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `fight-churn/data-generation/churnsim.py` 生成模拟数据并将其保存到Postgres模式中。
- en: The simulation typically runs for around 10 minutes, generating approximately
    15,000 customers for an imaginary social network over 6 months. The simulation
    creates all of their subscriptions and events such as making friends, making posts,
    viewing ads, and liking and disliking posts. More details about the simulation
    are provided throughout the book.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 模拟通常运行大约10分钟，在6个月内为虚构社交网络生成约15,000名客户。模拟创建了他们所有的订阅和事件，例如交朋友、发布帖子、查看广告以及点赞和不喜欢帖子。关于模拟的更多细节将在本书中提供。
- en: 'After creating the database and generating data, there is a Python wrapper
    program, `run_churn_listing.py`, that you can use to run all the listings in the
    book. This is helpful for the SQL listings in chapters 2-4 because the script
    takes care of details like variables and connecting to the database; the wrapper
    program is also used for the Python functions beginning in chapter 5\. Command-line
    parameters control what listing is run. For example, to run listing 2.1, you use
    this program:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建数据库并生成数据后，有一个名为 `run_churn_listing.py` 的 Python 包装程序，您可以使用它来运行本书中的所有列表。这对于第2-4章中的SQL列表很有帮助，因为脚本会处理变量和连接到数据库等细节；包装程序也用于第5章开始的Python函数。命令行参数控制运行哪个列表。例如，要运行列表2.1，您使用此程序：
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Alternatively, if you want to run the listings with another method, all the
    listings are organized by chapter in folders under fight-churn/listings/. For
    example, listing 2.1 is in the file fight-churn/listings/chap2/listing_2_1_net_retention.sql.
    The SQL listings are all stored as templates containing bind variables beginning
    with `%`; they do not contain specific parameters like dates or event names. You
    will need to substitute the values for these variables before you run the queries.
    The wrapper script `run_churn_listing.py` takes care of this for you.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，如果您想用另一种方法运行列表，所有列表都按章节组织在 fight-churn/listings/ 下的文件夹中。例如，列表2.1位于文件 fight-churn/listings/chap2/listing_2_1_net_retention.sql
    中。SQL列表都存储为包含以 `%` 开头的绑定变量的模板；它们不包含特定参数，如日期或事件名称。在运行查询之前，您需要替换这些变量的值。包装脚本 `run_churn_listing.py`
    会为您处理这些。
- en: 'Bind variables are used in the SQL listings so that they can be easily reconfigured
    to run on datasets other than the provided simulation. If you want to use your
    own data instead of the simulation, first do the following (after you install
    Python and Postgres as explained in the README):'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在 SQL 列表中使用绑定变量，以便它们可以轻松重新配置以在除提供的模拟以外的数据集上运行。如果您想使用自己的数据而不是模拟，首先执行以下操作（在按照README中解释的说明安装Python和Postgres之后）：
- en: Create a schema with `fight-churn/data-generation/churndb.py`. Set the schema
    name by editing that executable and setting the variable `schema_name` near the
    top of the file.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `fight-churn/data-generation/churndb.py` 创建一个模式。通过编辑该可执行文件并设置文件顶部附近的变量 `schema_name`
    来设置模式名称。
- en: Load your subscriptions, events, and schema event tables. (Details of how to
    do this are beyond the scope of this book, but a variety of free tools make it
    pretty easy to load data into Postgres databases.)
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载您的订阅、事件和模式事件表。（如何操作的细节超出了本书的范围，但各种免费工具使将数据加载到Postgres数据库变得相当容易。）
- en: The listing wrapper program works from parameters stored in a JSON file, fight-churn/listings/conf/churnsim_listings.json.
    To run the listings with different parameters, you must make your own version
    of that JSON file. For each chapter and listing, there are parameter blocks, with
    parameters stored as key-value pairs. You can set these to the appropriate values
    for your own dataset.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列表包装程序从存储在 JSON 文件 fight-churn/listings/conf/churnsim_listings.json 中的参数运行。要使用不同的参数运行列表，您必须创建该
    JSON 文件的自己的版本。对于每个章节和列表，都有参数块，参数以键值对的形式存储。您可以将这些设置为适合您自己的数据集的适当值。
- en: Run the listings with the wrapper program and the additional parameter `—schema`
    `<your_schema>`.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用包装程序和额外的参数 `—schema` `<your_schema>` 运行列表。
- en: More details for installation and use are in the README.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 关于安装和使用的更多详细信息请参阅README。
- en: 2.1 Definition of the churn rate
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.1 损耗率的定义
- en: 'Figure 2.2 illustrates the idea of churn: the two circles represents the subscriber
    pool at different points in time. The area of each circle represents either the
    number of subscribers or the total amount they pay; the latter is used when subscribers
    pay different amounts. But whether churn is based on the number of subscribers
    or the amount of revenue, the concept is the same. The churn is the downward-facing
    crescent at the top: the part of the start circle that does not overlap the bottom
    (end) circle, which is those subscribers who are no longer with the service. To
    complete the picture, the overlap between the two circles is the retained subscribers,
    and the upward-facing crescent at the bottom of the end circle (that doesn’t overlap
    the top circle) represents newly acquired subscribers. Note that, in general,
    the size of the two circles is not exactly the same.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.2 阐述了客户流失的概念：两个圆代表不同时间点的订阅者池。每个圆的面积代表订阅者的数量或他们支付的总金额；后者在订阅者支付不同金额时使用。但无论客户流失是基于订阅者数量还是收入金额，概念是相同的。客户流失是顶部的向下新月形：起始圆中不与底部（结束）圆重叠的部分，即那些不再使用服务的订阅者。为了完整地描述，两个圆之间的重叠部分是保留的订阅者，而结束圆底部向上新月形（不与顶部圆重叠）代表新获得的订阅者。请注意，通常两个圆的大小并不完全相同。
- en: '![](../Images/2-02.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-02.png)'
- en: Figure 2.2 Churn Venn diagram showing a growing subscription service where acquisition
    is larger than churn
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.2 客户流失维恩图，显示一个增长中的订阅服务，其中获取量大于流失量
- en: 2.1.1 Calculating the churn rate and retention rate
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.1.1 计算客户流失率和客户保留率
- en: Next I show you how to turn the qualitative picture in figure 2.2 into a formula.
    The churn rate is defined as the proportion of the start subscribers (start circle)
    who leave the service (top crescent). In an equation, this is
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我将向您展示如何将图 2.2 中的定性图像转换为公式。客户流失率定义为起始订阅者（起始圆）离开服务（顶部新月形）的比例。在方程中，这表示为
- en: '| ![](../Images/2-02_E01.png) | Equation 2.1 |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| ![图片](../Images/2-02_E01.png) | 公式 2.1 |'
- en: 'where #StartCustomers means the area of the start circle, and #ChurnedCustomers
    means the area of the churn crescent. Figure 2.3 shows a simple example.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '其中 #StartCustomers 表示起始圆的面积，而 #ChurnedCustomers 表示流失新月形的面积。图 2.3 展示了一个简单的示例。'
- en: '![](../Images/2-03.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-03.png)'
- en: Figure 2.3 A simplified example of a churn rate calculation
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.3 客户流失率计算简化示例
- en: The product has only five customers in January, and all customers have a monthly
    renewal on the same day of the month as when they started. During January, one
    customer does not renew and two new customers sign up, so in February, there are
    six customers.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 该产品在 1 月份只有五名客户，所有客户都在每月的同一日进行续订。在 1 月份，一名客户没有续订，两名新客户注册，因此 2 月份有六名客户。
- en: 'Equation 2.2 shows the churn rate calculation measured over the month of January:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 公式 2.2 显示了 1 月份的客户流失率计算：
- en: '| ![](../Images/2-03_E02.png) | Equation 2.2 |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| ![图片](../Images/2-03_E02.png) | 公式 2.2 |'
- en: 'Note that the churn rate does not use the total subscribers at the end or the
    subscribers acquired. Look at figure 2.2 to understand why: the churn rate is
    the portion of the start circle that is not covered by the end circle, but the
    size of the end circle depends on both the retention and the number of new subscriber
    acquisitions. The acquisition of new subscribers is an incredibly important subject,
    but it is a separate matter from the churns because it results from a different
    set of processes, so it is not covered in this book. So, the churn rate is based
    only on churn in relation to the subscribers at the start. If the churn were instead
    divided by the area of the end subscriber pool, it would be incoherent because
    that would mix parts of two pools and confuse the contributions of acquisition
    and retention with the size of the subscriber pool.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，客户流失率不使用最终的总订阅者数或新获得的订阅者数。查看图 2.2 以了解原因：客户流失率是起始圆中未被结束圆覆盖的部分，但结束圆的大小取决于保留和新订阅者获取的数量。新订阅者的获取是一个极其重要的主题，但它是一个独立的问题，因为它来自不同的过程集合，所以它不包含在本书中。因此，客户流失率仅基于与起始订阅者的流失相关。如果客户流失率是按最终订阅者池的面积来划分的，那么它将是不连贯的，因为这会混合两个池的部分，并混淆获取和保留对订阅者池大小的贡献。
- en: 'The retention rate is defined in equation 2.3:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 客户保留率在公式 2.3 中定义：
- en: '| ![](../Images/2-03_E03.png) | Equation 2.3 |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| ![图片](../Images/2-03_E03.png) | 公式 2.3 |'
- en: Using the example in figure 2.3, the retention rate is
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 使用图 2.3 中的示例，客户保留率为
- en: '| ![](../Images/2-03_E04.png) | Equation 2.4 |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/2-03_E04.png) | 方程式2.4 |'
- en: 2.1.2 The relationship between churn rate and retention rate
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.1.2 流失率和保留率之间的关系
- en: 'Here is an important fact about churn rate and retention rate: they are related
    in a very precise way and are two sides of the same coin. Look at the parts of
    the start circle in figure 2.2\. The entire start circle is either the churn portion
    or the retention portion, represented by this equation:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个关于流失率和保留率的重要事实：它们以非常精确的方式相互关联，是同一枚硬币的两面。看看图2.2中起始圆的部分。整个起始圆要么是流失部分，要么是保留部分，由这个方程式表示：
- en: '| ![](../Images/2-03_E05.png) | Equation 2.5 |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/2-03_E05.png) | 方程式2.5 |'
- en: Now come a few algebra manipulations. If you divide both sides of equation 2.5
    by the start subscribers, you get
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 现在进行一些代数操作。如果你将方程式2.5的两边除以起始订阅者，你会得到
- en: '| ![](../Images/2-03_E06.png) | Equation 2.6 |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/2-03_E06.png) | 方程式2.6 |'
- en: 'Next, substitute into equation 2.6 the definitions from equations 2.1 and 2.3
    for the churn and retention rates, and remember that any number divided by itself
    is 1, or 100%. This equation shows the relationship:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，将方程式2.6中的流失率和保留率的定义替换为方程式2.1和2.3，并记住任何数除以自身等于1，或100%。这个方程式显示了以下关系：
- en: '![](../Images/2-03_E06b.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2-03_E06b.png)'
- en: 'Finally, those terms can be rearranged to show the conclusion:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，这些术语可以被重新排列以得出结论：
- en: '| ![](../Images/2-03_E07.png)  | Equation 2.7 |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/2-03_E07.png)  | 方程式2.7 |'
- en: Equation 2.7 can also be understood by looking at figure 2.2\. Churn and retention
    together make up the start circle, so the sum of the two proportions must add
    up to the whole circle, or 100%.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 方程式2.7也可以通过查看图2.2来理解。流失和保留共同构成了起始圆，因此这两个比例的总和必须等于整个圆，即100%。
- en: TAKEAWAY Retention rate can be easily calculated from the churn rate and vice
    versa. Which measurement you look at is a matter of preference.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 摘要：保留率可以从流失率中轻松计算出来，反之亦然。你查看哪个测量值是个人偏好的问题。
- en: Most organizations use the churn rate for internal discussions around reducing
    churn. The retention rate is usually used to report to outsiders (for example,
    investors) when the emphasis is meant to be positive (“the glass is half full”).
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数组织使用流失率进行减少流失的内部讨论。保留率通常用于向外界（例如，投资者）报告，当重点是要积极（“杯子是半满的”）时。
- en: 2.2 Subscription databases
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.2 订阅数据库
- en: As I described in chapter 1, subscription products or services usually have
    a database that tracks when subscriptions begin and end, and the examples in this
    book generally assume a subscription database is in use. If your business does
    not have a subscription database because it is a free or ad-supported product,
    section 2.5 shows how to calculate churn rates without subscriptions, but I advise
    that you read this section and the ones that follow because they build the necessary
    concepts and techniques.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我在第一章中描述的，订阅产品或服务通常有一个数据库来跟踪订阅的开始和结束时间，本书中的例子通常假设正在使用订阅数据库。如果你的业务没有订阅数据库，因为它是一个免费或广告支持的产品，第2.5节展示了如何在没有订阅的情况下计算流失率，但我建议你阅读这一节以及随后的章节，因为它们构建了必要的概念和技术。
- en: Table 2.1 shows the key elements of a typical subscription database table.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 表2.1显示了典型订阅数据库表的关键元素。
- en: Table 2.1 A typical subscription data table
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 表2.1 一个典型的订阅数据表
- en: '| Column | Data type | Required? |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '| 列 | 数据类型 | 是否必需 |'
- en: '| `subscription_id` | `integer` or `char` | Yes |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| `subscription_id` | `integer` or `char` | Yes |'
- en: '| `account_id` | `integer` or `char` | Yes |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| `account_id` | `integer` or `char` | Yes |'
- en: '| `product_id` | `integer` or `char` | Yes |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| `product_id` | `integer` or `char` | Yes |'
- en: '| `start_date` | `date` | Yes |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| `start_date` | `date` | Yes |'
- en: '| `end_date` | `date` | No |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| `end_date` | `date` | No |'
- en: '| `mrr` | `double precision` | Maybe |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '| `mrr` | `double precision` | Maybe |'
- en: 'In practice, there are usually more fields than this, but for purposes of illustration,
    this subscription data model consists of some core fields you might expect to
    find in a production environment:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，通常有更多的字段，但为了说明目的，这个订阅数据模型包含了一些你可能在生产环境中期望找到的核心字段：
- en: Subscription ID —A unique identifier for each subscription.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订阅ID——每个订阅的唯一标识符。
- en: Account ID —An identifier for the account holder or user. These are unique at
    the account level but are not assumed to be unique in the subscription table.
    In general, accounts can hold multiple subscriptions.
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 账户ID——账户持有者或用户的标识符。这些在账户级别上是唯一的，但在订阅表中并不假定是唯一的。通常，账户可以持有多个订阅。
- en: Product ID —An identifier for the unique product that is subscribed to. This
    data model uses one product per subscription, but as mentioned, accounts can hold
    multiple products. If a subscription service offers only a single product, there
    might not be a product field; but it is fair to consider this a required field
    because single-product services that plan to grow normally come up with new offerings.
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产品 ID —— 订阅的唯一产品的标识符。此数据模型使用每个订阅一个产品，但如前所述，账户可以持有多个产品。如果订阅服务只提供单一产品，可能没有产品字段；但公平地说，这应该被视为一个必填字段，因为计划增长的单一产品服务通常会推出新的产品。
- en: Start date —Every subscription must start on some date. These are simple dates
    without times.
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开始日期 —— 每个订阅都必须在某个日期开始。这些是简单的日期，没有时间。
- en: End date —Subscriptions may or may not have end dates. If there is no end date,
    the subscription is assumed to last until explicitly canceled.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结束日期 —— 订阅可能有或没有结束日期。如果没有结束日期，则假定订阅将持续到明确取消。
- en: Monthly recurring revenue (MRR) —Paid subscriptions have an associated amount
    of recurring monthly revenue.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每月周期性收入（MRR）——付费订阅关联着一定数量的周期性每月收入。
- en: In summary, a subscription is a product sold to a customer, which begins on
    a specific start date and for a specified recurring cost. As discussed, there
    may be an end date, or there may not.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，订阅是一种向客户销售的产品，它从特定的开始日期开始，并按指定周期性费用进行。正如所讨论的，可能会有一个结束日期，也可能没有。
- en: NOTE Subscriptions with end dates are usually referred to as termed subscriptions,
    and the time between the start and the end dates is called the term. Subscriptions
    that last forever (until canceled) are usually called evergreen subscriptions.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：带有结束日期的订阅通常被称为期限订阅，从开始日期到结束日期之间的时间称为期限。持续无限期（直到取消）的订阅通常被称为常青订阅。
- en: Note that the database table(s) that contains this information might not be
    called `Subscriptions`. If you work at a B2B company that uses a customer relationship
    management (CRM) system to track deals, your company might store this information
    as `Opportunities`; alternatively, if your company uses a subscription business
    management (SBM) product designed to track multiproduct subscription offerings,
    the table might be called `Product` `Rate` `Plan`. But as long as all the required
    data elements are available, you have what you need to calculate churn. Note also
    that for any company that sells paid subscription services, MRR can be considered
    a required field, although it can be zero if there is a discount or a free trial
    (for example, a freemium subscription at the basic level).
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，包含此信息的数据库表可能不被称为“订阅”。如果你在一家使用客户关系管理（CRM）系统跟踪交易的B2B公司工作，你的公司可能将此信息存储为“机会”；或者，如果你的公司使用旨在跟踪多产品订阅提供的订阅业务管理（SBM）产品，该表可能被称为“产品”`“费率”`“计划”。但只要所有必需的数据元素都可用，你就有了计算流失所需的一切。注意，对于任何销售付费订阅服务的公司，MRR可以被视为一个必填字段，尽管如果存在折扣或免费试用（例如，基本级别的免费增值订阅），它可能为零。
- en: Messy subscription databases
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 杂乱的订阅数据库
- en: 'One theme you will see repeatedly throughout this book is that algorithms are
    designed to handle irregularities in the subscriptions saved in the database,
    also called messy or unclean subscription data. Messy subscription data can come
    in many forms: duplicates for the same account, entries for accounts that are
    not real, inconsistency in what are supposedly consistent subscription terms (like
    the duration and price), unexpected gaps between subscriptions, and end dates
    that come before start dates, to name a few.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在这本书的整个过程中，你将反复看到一个主题，那就是算法被设计来处理数据库中保存的订阅的不规则性，也称为杂乱或未清理的订阅数据。杂乱的订阅数据可以有多种形式：同一账户的重复项、不属于真实账户的条目、在所谓的连续订阅条款（如时长和价格）中的不一致性、订阅之间的意外间隔，以及结束日期在开始日期之前的情况，仅举几例。
- en: If you are still a student or have never worked in a corporate environment,
    then this might surprise and even annoy you, because some of the algorithms I
    use are more complicated than you may expect or think necessary. But I can assure
    you that these complications are necessary most of the time.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你仍然是一名学生或者从未在商业环境中工作过，那么这可能会让你感到惊讶，甚至恼怒，因为一些我使用的算法可能比你预期的或认为必要的要复杂。但我可以向你保证，这些复杂性在大多数情况下是必要的。
- en: In the real world, clean subscription databases are rare; messy subscription
    databases are the norm. One problem you might not appreciate yet is that it takes
    only a small amount of messy data to throw off some algorithms, and the blast
    radius can be larger than just the accounts with the bad data.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实世界中，干净的订阅数据库很少见；杂乱的订阅数据库是常态。你可能还没有意识到的一个问题是，只需要一小部分杂乱数据就足以使某些算法出错，其影响范围可能远不止是数据有问题的账户。
- en: (continued)
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: （继续）
- en: 'If you work with clean data, be patient with the techniques designed to help
    the rest of us who have to deal with messy data, and feel free to simplify the
    algorithms to suit an easier situation. And if you work with messy subscription
    data, take comfort: you are in good company. The techniques in this book should
    see you through to understanding subscriber engagement and reducing churn. (But
    don’t expect me to clean up your data for you! I’m a data scientist, not a magician
    . . .)'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你处理的是干净的数据，请对帮助处理杂乱数据的其他人的技术有耐心，并且可以自由地简化算法以适应更简单的情况。如果你处理的是杂乱的订阅数据，请放心：你并不孤单。本书中的技术应该能帮助你理解订阅者参与度和降低流失率。（但不要期望我为你清理数据！我是一个数据科学家，不是魔术师……）
- en: '2.3 Basic churn calculation: Net retention'
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3 基本流失计算：网络保留
- en: I begin with net retention because it is the easiest churn measure to calculate,
    although I will also show you that it is not always the most useful. Figure 2.2
    shows the retention rate when the circles represent revenue. Like all churn and
    retention measurements, net retention is measured over a specific period (usually
    a year). The net retention rate (NRR) is the proportion of recurring revenue that
    your company still receives at the end of the period from the subscribers who
    were present at the start.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我从网络保留开始，因为它是最容易计算的流失指标，尽管我也会向你展示它并不总是最有用的。图 2.2 展示了当圆圈代表收入时的保留率。像所有流失和保留度量一样，网络保留是在特定时期内（通常是一年）测量的。网络保留率（NRR）是指公司在期末从最初存在的订阅者那里仍然收到的重复性收入的比率。
- en: NOTE If your subscription product is free (has no paid recurring revenue), you
    should still read this section. The net retention calculation can be used to calculate
    regular (account-based) churn, and it’s a simpler formula than the more general
    churn formula presented in section 2.4.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：如果你的订阅产品是免费的（没有付费的重复性收入），你仍然应该阅读这一节。网络保留计算可以用来计算常规（基于账户）的流失，并且它比第 2.4 节中提出的更通用的流失公式更简单。
- en: Like all churn measures, net retention ignores new revenue acquired from signups
    during the time period. On the other hand, an important fact about net retention
    is that it includes changes in revenue from subscribers who are retained if this
    occurs. This can occur for any product or service with multiple product plans,
    temporary discounts, or pricing plan changes (most paid subscriptions). I will
    ignore these details and focus on teaching the calculation of net retention and
    churn; you will learn about these different cases in the following sections.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 像所有流失度量一样，网络保留忽略了在时间期间通过注册获得的新收入。另一方面，关于网络保留的一个重要事实是，如果发生这种情况，它包括保留的订阅者的收入变化。这可以发生在任何具有多个产品计划、临时折扣或定价计划变化（大多数付费订阅）的产品或服务中。我将忽略这些细节，专注于教授网络保留和流失的计算；你将在接下来的章节中了解这些不同的情况。
- en: 2.3.1 Net retention calculation
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3.1 网络保留计算
- en: 'Net retention is defined in equation 2.8:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 网络保留在方程 2.8 中定义：
- en: '| ![](../Images/2-03_E08.png) | Equation 2.8 |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| ![方程 2.8](../Images/2-03_E08.png) | 方程 2.8 |'
- en: 'That’s a slightly different definition of retention than the one in equation
    2.2\. Figure 2.4 extends the example in figure 2.3 to include two different plan
    types with different MRRs: a Standard plan for $9.99 a month and a Premier plan
    for $29.99 a month. In the figure, one customer on the Premier plan churns, two
    new customers sign up, and one customer changes from Standard to Premier. This
    example shows important differences from the count-based churn calculation in
    figure 2.3:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这是对保留率的定义与方程 2.2 中的定义略有不同。图 2.4 将图 2.3 中的例子扩展到包括两种不同计划类型和不同的 MRR：每月 9.99 美元的标准计划和每月
    29.99 美元的豪华计划。在图中，一位豪华计划的客户流失，两位新客户注册，一位客户从标准计划转为豪华计划。这个例子显示了与图 2.3 中基于计数的流失计算的重要差异：
- en: Because the churn calculation is based on MRR, customers who pay more have a
    bigger impact on the rate when they churn.
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因为流失计算是基于 MRR 的，所以当客户流失时，付费更多的客户对比率的影响更大。
- en: Changes in MRR for customers who don’t churn also impact the rate.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于没有流失的客户，MRR 的变化也会影响这个比率。
- en: '![](../Images/2-04.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![图片2-04](../Images/2-04.png)'
- en: Figure 2.4 A simplified example of a net retention calculation
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.4 净保留率计算的简化示例
- en: 'Look at the example in figure 2.4 and equation 2.8: the numerator for the net
    retention rate is the MRR of all the remaining customers, including the customer
    who switched to the Premier plan, or $79.96\. The MRR of all the customers at
    the start is $89.95, so the net retention is given by'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 参考图2.4和方程式2.8的示例：净保留率的分子是所有剩余客户的MRR，包括切换到高级计划的客户，或$79.96。起始时所有客户的MRR是$89.95，因此净保留率由以下公式给出
- en: '| ![](../Images/2-04_E09.png) | Equation 2.9 |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| ![图片2-04_E09](../Images/2-04_E09.png) | 方程式2.9 |'
- en: 'There is also a churn measure related to net retention, defined as 100% minus
    the net retention rate. Equation 2.10 shows the definition of net churn from net
    retention:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还有一个与净保留率相关的流失度量，定义为100%减去净保留率。方程式2.10显示了从净保留率定义净流失：
- en: '| ![](../Images/2-04_E10.png) | Equation 2.10 |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| ![图片2-04_E10](../Images/2-04_E10.png) | 方程式2.10 |'
- en: Net retention is the only churn-related measurement that is more commonly quoted
    as a retention rate and not a churn rate. This is due in part to the scenarios
    that arise in multiprice subscriptions, particularly the possibility of negative
    net churn (net retention, on the other hand, is always positive). In the next
    section, you will learn how to calculate the net retention rate with SQL, as well
    as more details about the use of PostgreSQL in this book.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 净保留率是唯一更常以保留率而不是流失率引用的与流失相关的度量。这在一定程度上是由于多价格订阅中出现的场景，特别是出现负净流失的可能性（另一方面，净保留率始终为正）。在下一节中，你将学习如何使用SQL计算净保留率，以及本书中关于PostgreSQL使用的更多细节。
- en: 2.3.2 SQL net retention calculation
  id: totrans-111
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3.2 SQL净保留率计算
- en: As this is the first SQL program in the book, I am going to briefly introduce
    common table expressions (CTEs). This SQL program and all the others in the book
    use CTEs, which are a relatively new extension to ANSI SQL. CTEs allow the definition
    of intermediate, temporary tables in a query, in the order they appear. Compared
    to other syntaxes for temporary tables, CTEs are clean and concise. Temporary
    tables in a database are the results of `SELECT` statements that are persisted
    in the database and can be used in further `SELECT`s that are part of the same
    overall SQL statement or program. The temporary result, however, is not persisted
    outside of the current execution.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 作为本书中的第一个SQL程序，我将简要介绍常见的表表达式（CTEs）。本书中的这个SQL程序以及所有其他程序都使用CTEs，这是ANSI SQL的一个相对较新的扩展。CTEs允许在查询中定义中间的、临时的表，按照它们出现的顺序。与其他临时表的语法相比，CTEs更加简洁。数据库中的临时表是`SELECT`语句的结果，这些结果被保存在数据库中，可以在同一整体SQL语句或程序中的进一步`SELECT`中使用。然而，临时结果不会在当前执行之外持久化。
- en: 'I use CTEs to teach these techniques because they allow a clear, step-by-step
    presentation of the program logic. (I refer to these as SQL programs and not the
    common term, SQL statements, which implies a shorter and simpler logic.) The following
    is a high-level overview of listing 2.1, which presents our first SQL program,
    described in relation to the churn diagram in figure 2.2:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用CTEs来教授这些技术，因为它们允许清晰、逐步展示程序逻辑。 (我将其称为SQL程序，而不是常用术语SQL语句，后者暗示逻辑更短、更简单。)以下是对列表2.1的高层次概述，该列表展示了我们的第一个SQL程序，与图2.2中的流失图相关：
- en: Set the start and end times for the measurement.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置测量的起始和结束时间。
- en: Identify the subscribers and total revenue at the start (top circle in figure
    2.2).
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定起始时的订阅者和总收入（如图2.2中的顶部圆圈）。
- en: Identify the subscribers and total revenue at the end (bottom circle in figure
    2.2).
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定结束时的订阅者和总收入（如图2.2中的底部圆圈）。
- en: Identify the retained subscribers and their revenue (intersection of the two
    circles in figure 2.2).
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定保留的订阅者和他们的收入（如图2.2中两个圆圈的交集）。
- en: Divide the retained subscriber revenue by the start subscriber revenue (equation
    2.2).
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将保留的订阅者收入除以起始订阅者收入（方程式2.2）。
- en: Another note about this program (which goes for all the others) is that, in
    general, I look at the hardest or most complex use case you might encounter. This
    also means it might be overpowered for some scenarios, but I would prefer to let
    some users simplify the program at their own discretion rather than omit guidance
    that will be helpful to many others. In particular, the program assumes that subscribers
    can hold multiple subscription products with different recurring revenue. If your
    subscription has only a single product and price and/or no paid recurring revenue,
    you can use the same SQL but replace sums of MRRs with the count of accounts.
    If your service has only termed subscriptions, you can remove the cases for null
    end dates. (As described in section 2.2, a termed subscription has a defined end
    date at the time the subscription is created.) The SQL for the program is shown
    in listing 2.1.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 关于此程序（以及其他所有程序）的另一点是，通常我会查看你可能遇到的难度最大或最复杂的使用案例。这也意味着它可能对于某些场景来说功能过于强大，但我更愿意让一些用户根据自己的判断简化程序，而不是省略对许多其他人有帮助的指导。特别是，该程序假设订阅者可以持有多个具有不同持续收入的订阅产品。如果你的订阅只有一个产品和一个价格以及/或没有付费的持续收入，你可以使用相同的SQL，但将MRR的总和替换为账户数量的计数。如果你的服务只有定期订阅，你可以删除关于空结束日期的情况。（如第2.2节所述，定期订阅在订阅创建时有一个定义的结束日期。）该程序的SQL在列出2.1中显示。
- en: NOTE The date variables in listing 2.1 are set with a configuration parameter,
    so in the book’s downloadable code, they appear as bind variables starting with
    `%`. The listing shows the SQL after the variables are bound. The same is true
    for all SQL listings in the book.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：列出2.1中的日期变量使用配置参数设置，因此在书籍的可下载代码中，它们以以`%`开头的绑定变量形式出现。列出显示了变量绑定后的SQL。对于书籍中的所有SQL列表也是如此。
- en: Listing 2.1 Net retention SQL program
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 列出2.1：净保留SQL程序
- en: '[PRE1]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: ① Sets the period for which the program will calculate churn
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: ① 设置程序计算流失的周期。
- en: ② CTE containing all the account IDs active at the start and their total MRR
    on the start date
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: ② 包含所有在开始日期活跃的账户ID及其在开始日期的总MRR的CTE。
- en: ③ Uses the aggregate sum so that when there are multiple subscriptions, the
    SELECT returns the total
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 使用聚合求和，以便当存在多个订阅时，SELECT返回总数。
- en: '④ Criteria for being active on a given date: The start date is on or before
    the date, and the end date is after the date or null.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 在指定日期活跃的准则：开始日期在或早于该日期，结束日期在或晚于该日期或为空。
- en: ⑤ Uses the aggregate GROUP BY function, so the SELECT sums the total MRR for
    each account
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 使用聚合的GROUP BY函数，因此SELECT对每个账户的总MRR进行求和。
- en: ⑥ CTE containing all the account IDs active at the end and their total MRR on
    the end date
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 包含所有在结束日期活跃的账户ID及其在结束日期的总MRR的CTE。
- en: '⑦ Criteria for being active on a given date: The start date is on or before
    the date, and the end date is after the date or null.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 在指定日期活跃的准则：开始日期在或早于该日期，结束日期在或晚于该日期或为空。
- en: ⑧ CTE containing all the accounts that did not churn (were retained)
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 包含所有未流失（保留）的账户的CTE。
- en: ⑨ Uses the aggregate sum so that when there are multiple subscriptions, the
    SELECT returns the total
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 使用聚合求和，以便当存在多个订阅时，SELECT返回总数。
- en: ⑩ The inner join results in this containing accounts that were active at both
    the beginning and the end, meaning they were retained.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ 内连接的结果是包含在开始和结束日期都活跃的账户，这意味着它们被保留了。
- en: ⑪ Sums the total MRR of all accounts active on the start
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: ⑪ 求和所有在开始日期活跃的账户的总MRR。
- en: ⑫ Sums the total MRR of all accounts that were retained
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: ⑫ 求和所有保留的账户的总MRR。
- en: '⑬ Net retention formula: MRR of retained accounts divided by MRR at the start'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: ⑬ 净保留公式：保留账户的MRR除以开始时的MRR。
- en: '⑭ Net MRR churn formula: 1.0 minus net retention'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: ⑭ 净MRR流失公式：1.0减去净保留率。
- en: ⑮ Includes the components of the result to show how the MRR was produced
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: ⑮ 包含结果组成部分，以显示MRR是如何产生的。
- en: 'The following list describes each CTE in the program and the final `SELECT`
    statement and what role each CTE plays in the calculation, numbered according
    to the calculation strategy steps outlined before listing 2.1:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表描述了程序中的每个CTE以及最终的`SELECT`语句，以及每个CTE在计算中扮演的角色，编号根据在列出2.1之前概述的计算策略步骤：
- en: '`date_range`—A table with one row that holds the start and end dates for the
    calculation.'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`date_range`—一个包含计算开始和结束日期的单行表。'
- en: '`start_accounts`—A table with one row for each account active at the start.
    This table is created by selecting from the subscription table based on the condition
    that the account is active at the start of the churn measurement, meaning it holds
    a subscription (where the subscription start date is before the churn measurement
    start date, and the subscription end date is after the churn start date, or there
    is no subscription end date).'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`start_accounts`—一个表，其中每行对应于在开始时活跃的每个账户。此表是通过根据账户在流失测量开始时活跃的条件从订阅表中选择的，这意味着它持有订阅（其中订阅开始日期在流失测量开始日期之前，订阅结束日期在流失开始日期之后，或者没有订阅结束日期）。'
- en: '`end_accounts`—A table with one row for each account active at the end of the
    churn measurement. The condition for being considered active is the same as for
    the start accounts, using the churn measurement end date for the criteria.'
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`end_accounts`—一个表，其中每行对应于在流失测量结束时活跃的每个账户。被认为是活跃的条件与起始账户相同，使用流失测量结束日期作为标准。'
- en: '`retained_accounts`—A table with one row for each account that is active at
    both the start and the end. This table is created by a standard join on account
    IDs between the `start_accounts` table and the `end_accounts` table.'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`retained_accounts`—一个表，其中每行对应于在开始和结束时都活跃的每个账户。此表是通过在`start_accounts`表和`end_accounts`表之间基于账户ID进行标准连接创建的。'
- en: '`start_mrr`—A one-row table that sums the total MRR at the start of the churn
    measurement, for clarity.'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`start_mrr`—一个包含起始流失测量时总MRR的单一行表，以清晰起见。'
- en: '`retained_mrr`—A one-row table that sums the total MRR of all of the retained
    accounts, for clarity.'
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`retained_mrr`—一个包含所有保留账户总MRR的单一行表，以清晰起见。'
- en: Final `SELECT` statement —Takes the results from the `start_mrr` and `retained_mrr`
    tables and calculates the final results by plugging the values into equations
    2.2 and 2.3.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终`SELECT`语句——从`start_mrr`和`retained_mrr`表中获取结果，并通过将值插入方程2.2和2.3来计算最终结果。
- en: That is how net retention and net churn (described by equations 2.5 and 2.6)
    can be calculated from a typical subscription database in SQL.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是如何从典型的订阅数据库中通过SQL计算净保留率和净流失率（由方程2.5和2.6描述）的方法。
- en: 'This SQL program was tested on the simulated dataset produced by the code on
    the book’s website ([www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data))
    and in the book’s GitHub repository ([https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn))
    and generated the result shown in figure 2.5\. You should run listing 2.1 by following
    the README instructions. If you don’t have data from your own product or service,
    you can run the code on a simulated dataset; instructions are in the README at
    the root of the repository. If you have generated the simulated data, then run
    listing 2.1 by executing the wrapper program `run_churn_listing.py` with parameters
    like so:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 此SQL程序在本书网站上的代码生成的模拟数据集（[www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data)）和GitHub仓库（[https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)）中进行了测试，并生成了图2.5所示的结果。你应该按照README中的说明运行列表2.1。如果你没有自己产品或服务的数据，你可以在模拟数据集上运行代码；说明在仓库根目录的README中。如果你已经生成了模拟数据，那么可以通过执行包装程序`run_churn_listing.py`并使用如下参数来运行列表2.1：
- en: '[PRE2]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The wrapper program prints the SQL it is running, and the final result looks
    similar to figure 2.5\. This figure and all the SQL outputs in this chapter show
    the result in a tabular format as it would appear if the query were run in a SQL
    tool. If you run listing 2.1 using the Python framework provided on GitHub, the
    result is printed as a line of text. Also note that your results will differ slightly
    because the underlying data is randomly simulated.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 包装程序会打印出它正在运行的SQL语句，最终结果看起来与图2.5相似。此图以及本章中所有SQL输出均以表格格式显示，就像在SQL工具中运行查询时会出现的结果一样。如果你使用GitHub上提供的Python框架运行列表2.1，结果将以一行文本的形式打印出来。此外，请注意，你的结果可能会有所不同，因为底层数据是随机模拟的。
- en: '![](../Images/2-05.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-05.png)'
- en: Figure 2.5 Result of running listing 2.1 on the simulated dataset
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.5 在模拟数据集上运行列表2.1的结果
- en: Use of PostgreSQL (aka Postgres) in this book
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中对PostgreSQL（又称Postgres）的使用
- en: This book presents all the examples using code that was tested and run on PostgreSQL
    11\. I chose PostgreSQL 11 because it is the latest version of PostgreSQL at the
    time of writing this book, and it is a popular open source database that has modern
    features that make it easy to demonstrate the concepts being taught. If you are
    working at a company with another database, it shouldn’t be too hard to convert
    the SQL in this book into a version that works for you. The main issue may be
    the CTEs, which will have to be converted to temporary tables or subqueries. If
    you are a student or just learning these techniques and can choose your database,
    I strongly recommend that you use PostgreSQL to simplify using the book code as
    you are learning.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 本书展示了所有使用经过测试和运行在 PostgreSQL 11 上的代码的示例。我选择 PostgreSQL 11 是因为它在撰写本书时是 PostgreSQL
    的最新版本，它是一个具有现代功能且易于展示所教授概念的流行开源数据库。如果你在一家使用其他数据库的公司工作，将本书中的 SQL 转换为你使用的版本不应该太难。主要问题可能是
    CTEs，它们将不得不转换为临时表或子查询。如果你是学生或刚开始学习这些技术并且可以自己选择数据库，我强烈建议你使用 PostgreSQL 来简化你在学习过程中使用本书代码的方式。
- en: PostgreSQL, of course, does not have the capability of a big data warehouse;
    and while common table expressions are easy to read, they can be computationally
    expensive. So this arrangement is suitable for use only on services and products
    with relatively small numbers of customers. The company case studies in this book
    all had tens of thousands to around 100,000 customers, and PostgreSQL was easily
    adequate. Depending on the hardware you use and the amount of effort you put into
    performance tuning, PostgreSQL should scale up well to an analysis of millions
    of customers. If you have 10 million customers or more, you will probably end
    up using a data warehouse product architected specifically for big data. Fortunately,
    most modern data warehouses (like Redshift and Presto) support SQL with common
    table expressions, so the techniques in this book should translate directly. Nevertheless,
    if you are learning techniques like those in this book for the first time, I strongly
    recommend you do your learning on a PostgreSQL database that fits on your laptop.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，PostgreSQL 没有大数据仓库的能力；虽然公共表表达式易于阅读，但它们可能在计算上很昂贵。因此，这种安排仅适用于具有相对较少客户的服务和产品。本书中的公司案例研究都有数万到大约
    10 万客户，PostgreSQL 容易满足需求。根据你使用的硬件和你投入的性能调优工作量，PostgreSQL 应该能够很好地扩展到数百万客户的分析。如果你有
    1000 万或更多的客户，你可能会最终使用专门为大数据架构的数据仓库产品。幸运的是，大多数现代数据仓库（如 Redshift 和 Presto）都支持带有公共表表达式的
    SQL，因此本书中的技术可以直接转换。尽管如此，如果你是第一次学习本书中的技术，我强烈建议你在笔记本电脑上适合的 PostgreSQL 数据库上进行学习。
- en: 2.3.3 Interpreting net retention
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3.3 解释净留存率
- en: 'The following scenarios can occur and affect how you interpret net retention:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 以下场景可能会发生并影响你对净留存率的解释：
- en: All subscriptions pay the same, including free.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有订阅（包括免费订阅）支付相同。
- en: 'Multiple subscription prices with two cases:'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多种订阅价格，有两种情况：
- en: Standard case —Churns and down sells outweigh upsells.
  id: totrans-159
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准情况——流失和降价销售超过提升销售。
- en: Negative churn case —Upsells outweigh churns and down sells.
  id: totrans-160
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 负增长率案例——提升销售超过流失和降价销售。
- en: 'If all subscribers pay exactly the same and no subscribers ever change the
    amount they pay, the MRR churn and retention calculated in this section are exactly
    the same as the subscriber count-based churn and retention described in section
    2.1\. Look at the circles in figure 2.2: if everyone pays exactly the same, then
    the area of a circle based on the MRR of subscribers is exactly proportional to
    the area of a circle based on the number of subscribers, and this proportionality
    is the same at both the start and the end. It’s the same thing if the service
    is free and the MRR is zero: the net retention and derived churn are the same
    as calculating the subscriber-count-based churn, although in this case, you would
    have to modify the SQL in listing 2.1 to use a count aggregation instead of the
    sum of MRR.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 如果所有订阅者支付完全相同，并且没有任何订阅者改变他们支付的金额，本节中计算的 MRR 流失和留存率与第 2.1 节中描述的基于订阅者数量的流失和留存率完全相同。看看图
    2.2 中的圆圈：如果每个人都支付完全相同，那么基于订阅者 MRR 的圆面积与基于订阅者数量的圆面积完全成比例，这种比例在开始和结束时都是相同的。如果服务是免费的且
    MRR 为零，情况也是一样的：净留存率和派生流失与基于订阅者数量的流失计算相同，尽管在这种情况下，你将不得不修改列表 2.1 中的 SQL 以使用计数聚合而不是
    MRR 的总和。
- en: On the other hand, when the amount subscribers pay varies, then net retention
    and churn based on revenue are not the same as the retention and churn (based
    on subscriber count). That’s because, over time, the amount that individual subscribers
    pay can change, so if the circles in figure 2.2 represent revenue, there are four
    ways for the size of the circle to change. This more complex scenario is illustrated
    in figure 2.6, which illustrates MRR retention and churn with upsells and down
    sells. The four ways the subscriber revenue can change are
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，当订阅者支付金额变化时，净留存率和基于收入的客户流失率与基于订阅者计数的留存率和客户流失率不同。这是因为随着时间的推移，个别订阅者支付的金额可能会变化，因此如果图2.2中的圆圈代表收入，圆圈的大小有四种变化方式。这种更复杂的场景在图2.6中得到了说明，该图展示了包含升级销售和降级销售的MRR留存率和客户流失。订阅者收入可能变化的四种方式是
- en: Subscriber acquisitions
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订阅者获取
- en: Subscriber churns
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订阅者流失
- en: Upsells (retained subscribers change to a higher recurring revenue)
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 升级销售（保留的订阅者转为更高重复收入）
- en: Down sells (retained subscribers change to a lower recurring revenue)
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 降级销售（保留的订阅者转为更低重复收入）
- en: '![](../Images/2-06.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-06.png)'
- en: Figure 2.6 Revenue retention and churn with upsell and down sell
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.6 升级销售和降级销售下的收入留存率和客户流失
- en: Net retention and net churn based on revenue are different from the (standard)
    churn based on the subscriber count. The impacts of upsells in retained subscribers
    can effectively offset churn, and down sells among the retained subscribers can
    effectively increase churn.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 基于收入的净留存率和净客户流失率与基于订阅者计数的（标准）客户流失率不同。保留订阅者中的升级销售的影响可以有效地抵消客户流失，而保留订阅者中的降级销售可以有效地增加客户流失。
- en: TAKEAWAY Net retention is known as net because it combines the effects of churns,
    upsells, and down sells.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点** 净留存率之所以被称为“净”，是因为它结合了客户流失、升级销售和降级销售的影响。'
- en: This netting property of net retention makes it somewhat less useful for fighting
    churn than the other definitions of churn. This is because including down sells
    and upsells are not the same, and conflating them confuses the issue. It is logical
    to include down sells in the churn calculation because that is the part of revenue
    that was present at the start but was lost from customer disengagement. The upsell
    revenue comes from a “different pie”—the end revenue circle in figure 2.6—so the
    net retention measure is no longer a ratio between parts of a whole. Also, the
    expiration of discounts is a contracted change in price and not related to customer
    satisfaction.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 净留存率的这种净化特性使其在对抗客户流失方面不如其他客户流失定义那样有用。这是因为包括降级销售和升级销售并不相同，将它们混淆会混淆问题。将降级销售纳入客户流失计算是合理的，因为那是最初存在的收入部分，但由于客户流失而丢失。升级销售的收入来自“不同的蛋糕”——如图2.6所示的最终收入循环——因此，净留存率衡量标准不再是整体部分之间的比率。此外，折扣的到期是合同价格的变化，与客户满意度无关。
- en: WARNING Upsells and the expiration of discounts reduce the apparent churn rate
    in net retention, which makes it a less specific measurement of churn and less
    useful for fighting churn. The standard (count-based) churn and the MRR churn
    described in the following sections are more specific measures of churn and are
    preferred.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '**警告** 升级销售和折扣到期会降低净留存率中的明显客户流失率，这使得它成为客户流失的更不具体测量，对抗客户流失的作用也较小。下文所述的标准（基于计数）客户流失和MRR客户流失是更具体的客户流失测量方法，更受欢迎。'
- en: Net retention is not the most useful measure for fighting churn, but it is nevertheless
    remarkable because of the following fact about churn-reporting practice.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 净留存率并不是对抗客户流失的最有用指标，但它仍然引人注目，因为以下关于客户流失报告实践的事实。
- en: TIP Net retention is the preferred measure of churn to report to outside investors
    in subscription companies.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '**提示** 净留存率是向订阅公司外部投资者报告客户流失的首选指标。'
- en: 'Why the preference for net retention in reporting? There are two reasons: a
    benign reason is that as an operational metric, net retention summarizes churn,
    upsell, and down sell into one convenient number that is, arguably, the most important
    to outside investors. A slightly more contrived reason is that whenever upsells
    are higher than down sells, the net churn (derived from 100% minus net retention)
    is less than the standard (count-based) churn that ignores revenue changes. As
    I just explained, the net revenue changes (upsells and discount expiration minus
    down sells) effectively hide the true underlying churn rate. For many companies,
    reporting net retention rather than one of the more specific churn measurements
    is a matter of better investor relations and a slight obfuscation of the business
    fundamentals. In extreme cases, the increase in the revenue pool from upsells
    can be greater than the combined negative effect of down sells and churns reducing
    the revenue pool. This is a rare but highly desirable scenario known as negative
    churn.'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么在报告中偏好净保留率？有两个原因：一个善良的原因是，作为一个运营指标，净保留率将流失、升级和降级总结成一个方便的数字，这个数字可以说是对外部投资者最重要的。一个稍微有些牵强的原因是，当升级高于降级时，净流失率（从100%减去净保留率得到）小于忽略收入变化的（基于计数）标准流失率。正如我刚才解释的，净收入变化（升级和折扣到期减去降级）实际上隐藏了真正的潜在流失率。对于许多公司来说，报告净保留率而不是更具体的流失率测量是一种更好的投资者关系和轻微的业务基础模糊的做法。在极端情况下，来自升级的收入池的增加可能大于降级和流失减少收入池的综合负面效应。这是一个罕见但高度理想的场景，被称为负流失。
- en: DEFINITION Negative churn —When the increase in revenue from upsells is greater
    than the combined negative effect of down sells and churns.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 定义 负流失——当升级带来的收入增加大于降级和流失的综合负面效应时。
- en: This means the revenue of the retained subscribers is greater than the revenue
    of the subscribers at the start, even after allowing for churn and down sells.
    As a result, net retention is greater than 100%. If net churn is calculated according
    to equation 2.6 in section 2.1.2, the result is a negative number. Note that this
    is not truly a negative value for the standard churn rate—the standard churn rate
    can only be a positive number (or possibly zero, for services with no subscriber
    cancellations). As described earlier, this is not the most useful churn measurement
    for fighting churn with data because it obscures how much churn is really going
    on, but it is very impressive to report to investors!
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着保留的订阅者的收入大于起始订阅者的收入，即使在考虑到流失和降级之后。因此，净保留率大于100%。如果根据第2.1.2节中的方程2.6计算净流失率，结果将是负数。请注意，这并不是标准流失率的真正负值——标准流失率只能是一个正数（或者可能是零，对于没有订阅者取消服务的服务）。如前所述，这不是与数据对抗流失的最有用流失率测量，因为它掩盖了实际流失的真正程度，但向投资者报告时却非常令人印象深刻！
- en: 2.4 Standard account-based churn
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.4 标准账户流失
- en: The standard account-based churn rate has the simplest meaning because it is
    unaffected by upsells, down sells, and expiration of discounts. It always simply
    refers to the proportion of customers who completely cancel the service.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 标准的基于账户的流失率具有最简单的含义，因为它不受升级、降级和折扣到期的影响。它总是简单地指完全取消服务的客户比例。
- en: DEFINITION Standard churn —Churn measurement based on the customer count. Also
    known simply as the churn rate.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 定义 标准流失——基于客户数量的流失率测量。也简称为流失率。
- en: The standard churn rate is often called the account churn rate because it refers
    to the complete churn of an account holder who may hold multiple subscriptions.
    So for the standard churn rate, an account holder who cancels one subscription
    but keeps another subscription is not considered a churn. (This would be considered
    a down sell, which I will revisit in the next section.) In the B2B space, the
    standard churn rate is also referred to as logo churn because each account holder
    is a company (a logo).
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 标准流失率通常被称为账户流失率，因为它指的是可能持有多个订阅的账户持有者的完全流失。因此，对于标准流失率来说，一个取消了一个订阅但保留了另一个订阅的账户持有者不被视为流失。（这将被视为降级，我将在下一节中重新讨论。）在B2B领域，标准流失率也被称为标志流失率，因为每个账户持有者都是一个公司（一个标志）。
- en: In this section, I demonstrate how to calculate the churn rate directly rather
    than calculating it from retention. Direct calculation requires the SQL feature
    known as an outer join. It is true that the churn rate could be calculated from
    account retention using an inner join like the one used for net retention, but
    being able to identify churned accounts with an outer join is a skill you will
    need later. Because outer joins are not a basic SQL feature, I will review outer
    joins in section 2.4.2, after I outline the query in section 2.4.1.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我将展示如何直接计算流失率，而不是从留存率计算。直接计算需要使用称为外连接的SQL功能。确实，流失率可以通过使用类似于用于净留存的内连接来从账户留存率计算，但能够使用外连接识别流失账户是一项你以后需要的技能。因为外连接不是基本的SQL功能，所以我将在2.4.2节中回顾外连接，在那之前，我将在2.4.1节中概述查询。
- en: 2.4.1 Standard churn rate definition
  id: totrans-183
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.1 标准流失率定义
- en: 'Before considering the details, let’s first review the steps to calculate the
    standard churn rate based on figure 2.2 and equation 2.1:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在考虑细节之前，让我们首先根据图2.2和公式2.1回顾计算标准流失率的步骤：
- en: Set the start and end times for the measurement.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置测量的起始和结束时间。
- en: Identify and count the subscribers at the start (top circle in figure 2.2).
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别并计数起始时的订阅者（如图2.2中的顶部圆圈）。
- en: Identify the subscribers at the end (bottom circle in figure 2.2).
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别结束时的订阅者（如图2.2中的底部圆圈）。
- en: Identify and count the churned subscribers (upper downward-facing crescent in
    figure 2.2).
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别并计数流失的订阅者（如图2.2中的向上向下凸起的月亮形状）。
- en: Divide the number of churns by the number of accounts at the start (equation
    2.1).
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将流失数量除以起始账户数量（公式2.1）。
- en: 2.4.2 Outer joins for churn calculation
  id: totrans-190
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.2 用于流失计算的外连接
- en: The churned accounts are selected from the start and end accounts using an outer
    join. I will review outer joins briefly for readers who are not familiar with
    them.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 从起始和结束账户中通过外连接选择了流失账户。我将简要回顾外连接，以便让不熟悉它们的读者了解。
- en: An inner join is the more common type of join, like the join on `account_id`
    to create the `retained_accounts` CTE in listing 2.1\. It returns all matching
    rows (according to the join field) and returns the desired fields from both tables
    for the matches. An outer join is different because instead of returning only
    the matches, it returns all the rows in one table. The join returns matching rows
    from a second table, but it fills fields from the second table with nulls for
    rows from the first table where there is no matching row in the second table.
    This is known as a left outer join because all the rows from the first table are
    always selected, which is on the left side of the `join` statement. (There is
    also a right outer join that behaves in the opposite way as far as which table
    keeps all its rows, and even a full outer join that returns all rows from both
    tables. But left outer joins suffice for churn.)
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 内连接是更常见的连接类型，例如在`account_id`上连接以创建列表2.1中的`retained_accounts` CTE。它返回所有匹配的行（根据连接字段），并为匹配返回两个表中的所需字段。外连接不同，因为它不仅返回匹配的行，还返回一个表中的所有行。连接返回来自第二个表的匹配行，但对于第一个表中没有匹配行的行，它使用null填充第二个表的字段。这被称为左外连接，因为总是选择第一个表中的所有行，这在`join`语句的左侧。（还有一个右外连接，它在保持所有行的表方面与左外连接相反，甚至还有一个全外连接，它返回两个表的所有行。但对于流失来说，左外连接就足够了。）
- en: An outer join is used to find churned accounts because the point is to find
    the accounts present at the start that are not present at the end. If you do an
    inner join, it matches those present at both the start and the end, and those
    are precisely the ones to remove. A left outer join returns all the accounts present
    at the start, not just the ones that churned, and that’s why the CTE to select
    churned accounts also needs a `WHERE` clause. It selects only those accounts from
    the join where the `account _id` from the end accounts is null, meaning it chooses
    only those rows from the join that were in the `start_accounts` CTE for which
    the matching `account_id` is not in the `end_account` CTE.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 使用外连接来查找流失账户，因为目的是找到起始时存在但结束时不再存在的账户。如果你进行内连接，它会匹配起始和结束时都存在的账户，而这些正是需要移除的账户。左外连接返回起始时存在的所有账户，而不仅仅是流失的账户，这就是为什么选择流失账户的CTE也需要一个`WHERE`子句。它只选择来自连接的、`end_accounts`中的`account_id`为null的账户，这意味着它只选择那些在`start_accounts`
    CTE中匹配的`account_id`不在`end_account` CTE中的行。
- en: TAKEAWAY Outer joins can be used to find rows that do not match a join criterion,
    which makes them useful for identifying churns.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 外连接可以用来查找不满足连接条件的行，这使得它们在识别客户流失时非常有用。
- en: 'Look again at the churn diagram in figure 2.2: it also provides an illustration
    of the logic of inner and outer joins (this is shown in figure 2.7). The retained
    accounts are the intersection of the start and end accounts, which are selected
    by an inner join. The churned accounts, the left outer join, are found from the
    starting accounts by removing all records that have a match at the end with the
    `WHERE` clause, selecting where the end `account_id` `IS` `NULL`. (It follows
    that the acquired accounts would be the right outer join with a `WHERE` clause
    selecting for a null start `account_id`, but this is not needed for the techniques
    in this book.)'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 再次查看图 2.2 中的客户流失图：它还提供了内部和外部连接逻辑的说明（这显示在图 2.7 中）。保留账户是开始和结束账户的交集，通过内部连接选择。流失账户，左外部连接，通过从起始账户中移除所有在末尾与
    `WHERE` 子句匹配的记录来找到，选择 `WHERE` 子句中 `end account_id` 为 `NULL` 的记录。（因此，获得的账户将是右外部连接，`WHERE`
    子句选择为空起始 `account_id`，但本书中的技术不需要这样做。）
- en: '![](../Images/2-07.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2-07.png)'
- en: Figure 2.7 Customer calculations showing inner and outer joins
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.7 显示内部和外部连接的客户计算
- en: 2.4.3 Standard churn calculation with SQL
  id: totrans-198
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.3 使用 SQL 进行标准客户流失率计算
- en: The SQL for the standard churn calculation is shown in listing 2.2\. It is identical
    to the net retention query from listing 2.1 for the first three CTEs, in which
    it creates temporary tables containing the accounts for the start and end of the
    measurement. But after finding the accounts, it creates a table of churned accounts
    rather than a table of retained accounts.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 标准客户流失率计算的 SQL 代码如列表 2.2 所示。对于前三个 CTE，它与列表 2.1 中的净保留查询相同，它创建了包含测量开始和结束账户的临时表。但找到账户后，它创建了一个流失账户的表，而不是保留账户的表。
- en: Listing 2.2 Standard (account-based) churn SQL program
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 2.2 标准（基于账户）客户流失 SQL 程序
- en: '[PRE3]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: ① Sets the period for which the SQL will calculate churn
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: ① 设置 SQL 计算客户流失率的周期
- en: ② CTE containing all the account IDs active at the start
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: ② 包含开始时所有活跃账户 ID 的 CTE
- en: ③ Uses a distinct query because you cannot assume every account has just one
    subscription
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 使用唯一查询，因为不能假设每个账户只有一个订阅
- en: '④ Criteria for being active on a given date: the start date is on or before
    the date, and the end date is after the date or null.'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 在给定日期上活跃的准则：开始日期在或早于该日期，结束日期在日期之后或为 NULL。
- en: ⑤ CTE containing all the account IDs active at the end
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 包含结束时所有活跃账户 ID 的 CTE
- en: '⑥ CTE containing all the account IDs for accounts that churned: those that
    were active at the start but not active at the end'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 包含所有流失账户账户 ID 的 CTE：那些在开始时活跃但在结束时不再活跃的账户
- en: ⑦ The outer join includes all the records at the start, because it is a left
    outer join.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 外连接包括开始时的所有记录，因为它是一个左外部连接。
- en: ⑧ The join looks for records that match by account ID and fills them with NULLs
    for the end accounts where there is no match.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 连接操作查找与账户 ID 匹配的记录，对于没有匹配的末尾账户，用 NULL 填充。
- en: ⑨ Removes records where there was no churn because they have a non-null e.account_id.
    Only accounts that were in the start_accounts CTE but not in the end_accounts
    CTE remain.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 移除没有流失的记录，因为这些记录的 e.account_id 不是 NULL。只有那些在 start_accounts CTE 中但不在 end_accounts
    CTE 中的账户保留。
- en: ⑩ Counts the number of accounts that were active at the start
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ 计算开始时活跃的账户数量
- en: ⑪ Counts the number of churned accounts
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: ⑪ 计算流失账户的数量
- en: '⑫ Churn rate formula: number churned/number at start'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: ⑫ 流失率公式：流失数量/起始数量
- en: '⑬ Retention rate formula : 1 − *c*hurn rate'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: ⑬ 保留率公式：1 − *c*hurn rate
- en: ⑭ Prints the components of the calculation to show how the churn rate was produced
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: ⑭ 打印计算组件以显示如何产生流失率
- en: 'The following describes each CTE in the program and the final `SELECT` statement
    and what role each CTE plays in the calculation in relation to the steps described
    in section 2.4.1:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 以下描述程序中的每个 CTE 以及最终的 `SELECT` 语句，以及每个 CTE 在与 2.4.1 节中描述的步骤相关的计算中所起的作用：
- en: '`date_range`—A table with one row that holds the start and end dates for the
    calculation. This is step 1.'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`date_range`—一个包含计算开始和结束日期的行的表。这是步骤 1。'
- en: '`start_accounts`—A table with one row for each account active at the start.
    This table is created by selecting from the subscription table based on the condition
    that the account is active at the start of the churn measurement. This is step
    2.'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`start_accounts`—一个包含在开始时活跃的每个账户的行。这个表是通过根据账户在流失测量开始时活跃的条件从订阅表中选择的创建的。这是步骤
    2。'
- en: '`end_accounts`—A table with one row for each account active at the end of the
    churn measurement. The condition for being considered active is the same as for
    the start accounts, using the churn measurement end date for the criteria. This
    is step 3.'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`end_accounts`—一个包含流失测量结束时每个活跃账户的行。被认为是活跃的条件与开始账户相同，使用流失测量结束日期作为标准。这是步骤 3。'
- en: '`churned_accounts`—A table with one row for each account that is active at
    the start but not active at the end. This table is created by the outer join on
    account IDs between the `start_accounts` table and the `end_accounts` table, and
    the `WHERE` clause that removes accounts where the end `account_id` is not null.
    This is step 4.'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`churned_accounts`—一个包含在开始时活跃但在结束时不再活跃的每个账户的行。这个表是通过在 `start_accounts` 表和 `end_accounts`
    表之间基于账户 ID 的外连接创建的，并使用 `WHERE` 子句删除了结束 `account_id` 不为 null 的账户。这是步骤 4。'
- en: '`start_count`—A table with one row that sums the total number of accounts at
    the start of the churn measurement, for clarity.'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`start_count`—一个包含一行，汇总了流失测量开始时总账户数的表，以清晰起见。'
- en: '`churn_count`—A table with one row that sums the total number of accounts that
    churned during the measurement period, for clarity.'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`churn_count`—一个包含在测量期间流失的总账户数的行，以清晰起见。'
- en: Final `SELECT` statement —Takes the results from the `start_count` and `churn_`
    `count` tables and calculates the final results by plugging the values into equations
    2.1 and 2.2\. This is step 5, the final step in the program.
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终 `SELECT` 语句 —从 `start_count` 和 `churn_count` 表中获取结果，通过将值代入方程 2.1 和 2.2 来计算最终结果。这是步骤
    5，程序中的最后一步。
- en: 'Now you know how the churn rate and retention rate described by equations 2.1
    and 2.2 can be calculated from a typical subscription database in SQL. Listing
    2.2 was tested on the simulated dataset produced by the code on the book’s website
    ([www .manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data))
    and in the GitHub repository ([https:// github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn))
    and generated the result shown in figure 2.7\. You should run listing 2.2 by following
    the instructions in the README. After setting up your environment (detailed in
    the README), run the listing with this command:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经知道了如何从典型的订阅数据库中通过 SQL 计算由方程 2.1 和 2.2 描述的流失率和留存率。列表 2.2 在书籍网站上的代码生成的模拟数据集（[www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data)）和
    GitHub 仓库（[https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)）上进行了测试，并生成了图
    2.7 所示的结果。你应该按照 README 中的说明运行列表 2.2。在设置好环境（详情见 README）后，使用以下命令运行列表：
- en: '[PRE4]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In comparison to figure 2.5, which shows the result for net retention calculated
    with listing 2.1, the result in figure 2.8 shows the same churn rate, but instead
    of revenue, it was calculated from accounts. This is to be expected because the
    simulation uses the same MRR for every customer.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 与图 2.5 相比，图 2.5 显示了使用列表 2.1 计算的净留存结果，图 2.8 显示了相同的流失率，但计算的不是收入，而是从账户中计算得出的。这是预期的，因为模拟为每个客户使用相同的
    MRR。
- en: '![](../Images/2-08.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2-08.png)'
- en: Figure 2.8 Result of running listing 2.2 on the simulated dataset
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.8 运行列表 2.2 在模拟数据集上的结果
- en: 2.4.4 When to use the standard churn rate
  id: totrans-229
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.4 何时使用标准流失率
- en: The standard churn rate is used as the main operational metric when all subscribers
    pay similar amounts or the subscription is free. If all subscribers pay exactly
    the same (meaning no discounts or any variation, or the product is free), standard
    churn can be calculated with either a net retention query or the standard churn
    rate query. But if there is a modest amount of pricing variation, or if there
    are temporary discounts, then you should use the standard churn calculation method
    given in this section.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 当所有订阅者支付相似金额或订阅免费时，标准流失率用作主要运营指标。如果所有订阅者支付完全相同（意味着没有折扣或任何变化，或产品是免费的），则可以使用净留存查询或标准流失率查询来计算标准流失率。但如果存在适度的定价变化，或者有临时折扣，那么你应该使用本节中给出的标准流失计算方法。
- en: As you will see later, the standard churn rate also has a special role in churn
    analysis. Because churn analysis uses a model designed to predict customer (subscription
    holder) churn, a correctly calibrated predictive churn model should reproduce
    the standard account churn rate. However, for subscriptions with a significant
    amount of variation in the amount customers pay or those with extensive use of
    discounts, the standard churn rate is not the best churn rate; for those scenarios,
    you should use MRR churn, which is taught in section 2.6.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 如您稍后所见，标准客户流失率在客户流失分析中也扮演着特殊角色。因为客户流失分析使用的是旨在预测客户（订阅持有者）流失的模型，一个正确校准的预测客户流失模型应该能够重现标准账户客户流失率。然而，对于客户支付金额有显著差异的订阅或广泛使用折扣的订阅，标准客户流失率并不是最佳客户流失率；对于这些场景，你应该使用MRR客户流失率，这在第2.6节中介绍。
- en: TAKEAWAY If there is a moderate amount of pricing variety, including discounts,
    then you should use the standard churn calculation method. For this purpose, moderate
    pricing variety means most customers pay close to the same price, but there may
    be some customers on older plans, discounts, or currency conversion effects.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '**总结**：如果存在适度的定价差异，包括折扣，那么你应该使用标准的客户流失计算方法。为此，适度的定价差异意味着大多数客户支付的价格接近相同，但可能会有一些客户处于较旧的计划、折扣或货币转换效应。'
- en: 2.5 Activity (event-based) churn for nonsubscription products
  id: totrans-233
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.5 非订阅产品的基于事件的活动客户流失
- en: 'In chapter 1, I told you that fighting churn is not just for subscription services;
    it is for any product or service with repeat customers. Now you will learn the
    main technique specifically for nonsubscription scenarios: calculating churn based
    on customer activity.'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 在第一章中，我告诉你们，对抗客户流失不仅仅是针对订阅服务；它适用于任何有重复客户的任何产品或服务。现在，你们将学习专门针对非订阅场景的主要技术：基于客户活动计算客户流失。
- en: The concept of event-based or activity churn is the same as with standard subscription
    churn, but you need an informal definition of what defines a customer as active
    versus churned. To use these techniques, you need only a data warehouse of events,
    which are time-stamped facts about customer use of the product. I will say more
    about event data in chapter 3, but for the sake of simplicity, a data model with
    an event timestamp is assumed for the examples in this section.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 基于事件的活动客户流失的概念与标准订阅客户流失相同，但你需要一个非正式的定义来区分客户是活跃的还是流失的。为了使用这些技术，你只需要一个事件数据仓库，这些事件是关于客户产品使用的时间戳事实。我将在第3章中更多关于事件数据的讨论，但为了简单起见，本节中的示例假设了一个具有事件时间戳的数据模型。
- en: 2.5.1 Defining an active account and churn from events
  id: totrans-236
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.5.1 定义基于事件的活跃账户和客户流失
- en: The most common definition of an active customer for nonsubscription products
    is simply a customer who has used the product within a recent time window, typically,
    one or two months. The concept is illustrated in figure 2.9\. User activity tends
    to be clustered, so it is natural to think of an active period as a sequence of
    events without a large gap between any two successive events. If the maximum time
    limit is exceeded, that is considered a churn. Such a time limit should be set
    long enough that most customers who exceed the limit don’t come back, at least
    for a while.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 对于非订阅产品，最常见活跃客户的定义是客户在最近的时间窗口内使用了产品，通常是一到两个月。这一概念在图2.9中得到了说明。用户活动往往趋于集中，因此将活跃期视为一系列事件，任意两个连续事件之间没有大的间隔是自然的。如果超过了最大时间限制，则被视为客户流失。这样的时间限制应该足够长，以至于大多数超过限制的客户至少在一段时间内不会回来。
- en: '![](../Images/2-09.png)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-09.png)'
- en: Figure 2.9 Event recency defines active periods and churn.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.9 事件发生频率定义了活跃期和客户流失。
- en: 'Other criteria for an active customer based on events can be things like these:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 基于事件的活跃客户的其他标准可能包括以下内容：
- en: A customer is considered active only if they have certain specific events.
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只有当客户发生某些特定事件时，才认为他们是活跃的。
- en: A customer is considered active only if they have a minimum number of events.
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只有当客户拥有一定数量的事件时，才认为他们是活跃的。
- en: A customer is considered active only if they have specific metrics calculated
    on events within the recent time period. Examples of specific metrics to make
    a customer active (and churn when they fail the test) would be a minimum (or any)
    spend on retail purchases or a minimum amount of revenue generated from ads.
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 只有当客户在最近的时间段内计算了特定的事件指标时，才认为他们是活跃的。使客户活跃（并在测试失败时流失）的特定指标示例包括零售购买的最小（或任何）支出或从广告中产生的最小收入。
- en: These different choices don’t change the SQL program that much.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 这些不同的选择并没有在很大程度上改变SQL程序。
- en: 2.5.2 Activity churn calculations with SQL
  id: totrans-245
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.5.2 使用SQL进行活动型流失计算
- en: The SQL program for calculating churn from events is shown in listing 2.3\.
    It is almost identical to listing 2.2, except it makes no use of the subscription
    table. Instead, the CTEs for the accounts at the start of the measurement and
    end of the measurement are based on a table of events (a table named `event`).
    As described previously, the criterion for an account to be considered active
    is simply having some recent event. As in listing 2.2, the parameters controlling
    the date range are in a CTE.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 计算事件引起的流失的SQL程序在列表2.3中展示。它与列表2.2几乎相同，只是没有使用订阅表。相反，测量开始时和结束时账户的CTE基于一个事件表（一个名为`event`的表）。如前所述，一个账户被认为是活跃的简单标准是它有一些最近的事件。与列表2.2一样，控制日期范围的参数在一个CTE中。
- en: 'Because products without subscriptions are usually used for a shorter length
    of time, listing 2.3 demonstrates churn over a one-month period (monthly churn).
    Another difference in this case is that there is another parameter controlling
    the recency threshold. Other than those changes, the main logic of the program
    is the same as listing 2.2, so here I just summarize it:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 因为没有订阅的产品通常使用时间较短，列表2.3展示了为期一个月的流失（月度流失）。在这种情况下，另一个不同之处在于还有一个参数控制最近度的阈值。除了这些变化之外，程序的主要逻辑与列表2.2相同，所以这里我只是总结一下：
- en: Find accounts active at the start of the churn measurement. Accounts that are
    active at the start are those that had an event within a window of time ending
    at the (nominal) start time for the churn measurement.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到在流失测量开始时活跃的账户。在开始时活跃的账户是在一段时间内有事件，这个时间窗口的结束时间是流失测量的（名义）开始时间。
- en: Find accounts active at the end of the churn measurement. These are accounts
    that had an event within a window of time, which ends at the end for the churn
    measurement.
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到在流失测量结束时活跃的账户。这些账户在一段时间内有事件，这个时间窗口的结束时间是流失测量的结束。
- en: Outer join the two sets of accounts to find those accounts that were active
    at the start and no longer active at the end. These are the churned accounts.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 外连接这两组账户以找到那些在开始时活跃但在结束时不再活跃的账户。这些是流失账户。
- en: Divide the number of churned accounts by the number of accounts active at the
    start to calculate the churn rate.
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将流失账户的数量除以开始时活跃的账户数量来计算流失率。
- en: 'Listing 2.3 was tested on the simulated dataset produced by the code on the
    book’s website ([www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data))
    and in the GitHub repository ([https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn))
    and generated the result shown in figure 2.10\. After setting up your environment,
    run the listing with this command:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 列表2.3在书籍网站上的代码生成的模拟数据集（[www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data)）和GitHub仓库（[https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)）上进行了测试，并生成了图2.10所示的结果。在设置好环境后，使用以下命令运行列表：
- en: '[PRE5]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/2-10.png)'
  id: totrans-254
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2-10.png)'
- en: Figure 2.10 Result of running listing 2.3 on the simulated dataset
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.10 运行列表2.3在模拟数据集上的结果
- en: In comparison to figure 2.7, which shows the result for the standard churn calculated
    with listing 2.2, this result shows a similar churn rate but not exactly the same.
    That’s to be expected because these are the same customers churning, but listing
    2.3 uses slightly different criteria for determining when the churn takes place.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 与图2.7相比，图2.7展示了使用列表2.2计算的标准流失的结果，这个结果显示了类似的流失率，但并不完全相同。这是可以预料的，因为这些是相同的客户流失，但列表2.3使用稍微不同的标准来确定流失发生的时间。
- en: Listing 2.3 Activity (event-based) churn SQL program
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 列表2.3 活动型（基于事件）流失SQL程序
- en: '[PRE6]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: ① Sets the time period for which the SQL calculates churn
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: ① 设置SQL计算流失的时间段
- en: ② Uses a timestamp for the dates because events use timestamps
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: ② 使用时间戳作为日期，因为事件使用时间戳
- en: ③ This CTE is similar to the same CTE in listing 2.2.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 此CTE与列表2.2中的相同CTE相似。
- en: ④ Picks accounts with events within the time limit of the start date
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 选择在开始日期时间限制内有事件的账户
- en: ⑤ This CTE is identical to the same CTE in listing 2.2.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 此CTE与列表2.2中的相同CTE相同。
- en: ⑥ This CTE is similar to the same CTE in listing 2.2.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 此CTE与列表2.2中的相同CTE相似。
- en: ⑦ Picks accounts with events within the time limit of the end date
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 选择在截止日期时间限制内的有事件的账户
- en: ⑧ The rest of the code is identical to listing 2.2.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 代码的其余部分与列表2.2相同。
- en: One important difference between churn based on subscriptions and churn based
    on activity is that activity-based churn requires a wait time for every customer
    to know whether they have churned. On a subscription, you know a churn is a churn
    the day after the subscription ends without a replacement; but for users on a
    system without a subscription, you never know if an event is the last event defining
    a churn until some time later. That said, in chapter 4, you will see that the
    same logic can also apply with subscriptions if you allow short gaps between subscriptions
    (typically a few days) without counting a churn.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 基于订阅的流失和基于活动的流失之间的重要区别之一是，基于活动的流失需要等待每个客户知道他们是否已经流失。在订阅中，你知道订阅结束后没有替代品的第二天就是一个流失；但对于没有订阅的系统用户，你永远不知道一个事件是否是定义流失的最后一个事件，直到一段时间之后。话虽如此，在第四章中，你将看到，如果你允许订阅之间有很短的间隔（通常是几天），不计算流失，同样的逻辑也可以应用于订阅。
- en: TAKEAWAY You can calculate the churn rate on nonsubscription products based
    on the recency of activity.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: TAKEAWAY 你可以根据活动的最近日期来计算非订阅产品的流失率。
- en: '2.6 Advanced churn: Monthly recurring revenue (MRR) churn'
  id: totrans-269
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.6 高级流失：月度经常性收入（MRR）流失
- en: 'In the previous sections, you learned that the standard churn rate can have
    a problem with multiprice subscription products. The standard churn rate ignores
    down sells, which should be considered part of churn, while net retention includes
    down sells but also includes upsells, which should not be considered churn. There
    is another churn measure made for this situation: MRR churn. This is the most
    complex calculation for churn, but it is the most accurate when there are multiple
    subscription products and prices.'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，你了解到标准流失率在多价格订阅产品中可能存在问题。标准流失率忽略了降级销售，而降级销售应该是流失的一部分，而净保留包括降级销售，但也包括不应被视为流失的升级销售。为此，还有一种为这种情况设计的流失度量：MRR流失。这是流失计算中最复杂的计算，但在存在多个订阅产品和价格时，它是最准确的。
- en: 'TIP Use MRR churn if you have customers who pay a wide range of prices: that
    is, your most valued customers pay twice your least valuable rate or more. In
    enterprise B2B software, the most valuable customers may pay more like 100 times
    the least valuable, and MRR churn is an absolute necessity in such scenarios.'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: TIP 如果你有支付广泛价格范围的客户：也就是说，你最有价值的客户支付的是最低价值客户的两倍或更多，请使用MRR流失。在企业B2B软件中，最有价值的客户可能支付的是最低价值客户的100倍左右，在这种情况下，MRR流失是绝对必要的。
- en: 2.6.1 MRR churn definition and calculation
  id: totrans-272
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.6.1 MRR流失的定义和计算
- en: MRR churn is once again a ratio of losses to the starting state, but now the
    numerator of the churn rate is the total losses from both churn and down sells,
    while the denominator is the revenue of the customers at the start. Referring
    to figure 2.6, which illustrates churn calculations with upsells and down sells,
    the MRR churn includes outright loss of MRR from complete churns (the top downward-facing
    crescent in figure 2.6) as well as losses due to down sells (the second downward-facing
    crescent in figure 2.6) as the numerator. It includes the retained MRR as the
    denominator but not the upsell MRR. For this reason, it is the most accurate measure
    of churn for multiprice subscription products.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: MRR流失再次是损失与起始状态之比，但现在流失率的分子是来自流失和降级销售的总体损失，而分母是客户起始时的收入。参考图2.6，它说明了包含升级和降级销售的流失计算，MRR流失包括完全流失导致的MRR直接损失（图2.6中的顶部向下凸起的月牙形）以及由于降级销售导致的损失（图2.6中的第二个向下凸起的月牙形）作为分子。它包括保留的MRR作为分母，但不包括升级销售的MRR。因此，它是多价格订阅产品流失的最准确度量。
- en: In an equation, MRR churn is defined as shown in equation 2.11, and MRR retention
    is shown in equation 2.12.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个方程中，MRR流失被定义为方程2.11所示，而MRR保留则显示在方程2.12中。
- en: '| ![](../Images/2-10_E11.png) | Equation 2.11 |'
  id: totrans-275
  prefs: []
  type: TYPE_TB
  zh: '| ![方程2.11的图片](../Images/2-10_E11.png) | 方程2.11 |'
- en: '| ![](../Images/2-10_E12.png) | Equation 2.12 |'
  id: totrans-276
  prefs: []
  type: TYPE_TB
  zh: '| ![方程2.12的图片](../Images/2-10_E12.png) | 方程2.12 |'
- en: In the equations, MRRchurned_accounts means the total MRR of all accounts that
    churned, and MRRdownsell means the total reduction in MRR of all accounts that
    were down sold.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 在方程中，MRRchurned_accounts表示所有流失账户的总MRR，而MRRdownsell表示所有降级销售账户的MRR总减少。
- en: 'Figure 2.11 shows an example of an MRR churn calculation by extending the example
    from figure 2.4 in section 2.3.1\. In the figure, one customer on the Premier
    plan churns, two new customers sign up, and two customers change their plans.
    One customer upgrades from Standard to Premier, and one downgrades from Premier
    to Standard. The example shows an important difference between MRR churn and net
    retention: down sells enter into MRR churn, but upsells do not.'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.11展示了通过扩展2.3.1节中图2.4的示例来进行的 MRR churn 计算的一个例子。在图中，一位在 Premier 计划上的客户流失，两位新客户注册，两位客户更改了他们的计划。一位客户从
    Standard 升级到 Premier，一位从 Premier 降级到 Standard。这个例子显示了 MRR churn 和净保留之间的重要区别：降价进入
    MRR churn，但升价不进入。
- en: 'Using equation 2.11 and filling in the values from the example shown in figure
    2.11 gives equation 2.13:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 使用方程式2.11并填写图2.11中示例的值，可以得到方程式2.13：
- en: '| ![](../Images/2-10_E13.png)  | Equation 2.13 |'
  id: totrans-280
  prefs: []
  type: TYPE_TB
  zh: '| ![图2-10_E13](../Images/2-10_E13.png) | 方程式2.13 |'
- en: '![](../Images/2-11.png)'
  id: totrans-281
  prefs: []
  type: TYPE_IMG
  zh: '![图2-11](../Images/2-11.png)'
- en: Figure 2.11 MRR churn calculation dataset
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.11 MRR churn 计算数据集
- en: 2.6.2 MRR churn calculation with SQL
  id: totrans-283
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.6.2 使用 SQL 进行 MRR churn 计算
- en: 'The SQL for MRR churn calculation is shown in listing 2.4\. It includes elements
    from both the net retention SQL and the standard churn SQL calculations. First,
    I outline the steps in the calculation and how they relate to the MRR churn equation
    (equation 2.7) and the down sell/upsell revenue diagram (figure 2.6). After that,
    I go through how these are implemented in the SQL program’s CTEs. The steps in
    the calculation are as follows:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: MRR churn 计算的 SQL 代码显示在列表2.4中。它包括来自净保留 SQL 和标准 churn SQL 计算的元素。首先，我概述了计算步骤以及它们与
    MRR churn 方程式（方程式2.7）和降价/升价收入图（图2.6）的关系。之后，我解释了这些步骤如何在 SQL 程序的 CTEs 中实现。计算步骤如下：
- en: Set the start and end times for the measurement.
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置测量的起始和结束时间。
- en: Identify the subscribers and the total revenue at the start (the top circle
    in figure 2.6).
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定起始时的订阅者和总收入（图2.6中的顶部圆圈）。
- en: Identify the subscribers at the end (the bottom circle in figure 2.6).
  id: totrans-287
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定结束时的订阅者（图2.6中的底部圆圈）。
- en: Identify the churned subscribers and their revenue (the top downward-facing
    crescent in figure 2.6).
  id: totrans-288
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定流失的订阅者和他们的收入（图2.6中的顶部向下凸起的月牙形）。
- en: Identify the subscribers who were down sells and the amount of the down sell
    (the second downward-facing crescent in figure 2.6).
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确定降价订阅者和降价金额（图2.6中的第二个向下凸起的月牙形）。
- en: Divide the total of churned revenue and down sell subscriber revenue by the
    start subscriber revenue (equation 2.11).
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将流失收入和降价订阅者收入的总额除以起始订阅者收入（方程式2.11）。
- en: 'Those steps are implemented in the SQL program (listing 2.4) as the following
    CTEs:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 这些步骤在 SQL 程序（列表2.4）中作为以下 CTEs 实现：
- en: '`date_range`—A table with one row that holds the start and end dates for the
    calculation. This is step 1.'
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`date_range`—一个包含计算起始和结束日期的行表。这是步骤1。'
- en: '`start_accounts`—A table with one row for each account active at the start.
    This table is created by selecting from the subscription table based on the condition
    that the account is active at the start of the churn measurement. This is step
    2.'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`start_accounts`—一个包含在 churn 测量开始时每个活跃账户的行表。此表通过从订阅表中选择基于账户在 churn 测量开始时活跃的条件创建。这是步骤2。'
- en: '`end_accounts`—A table with one row for each account active at the end of the
    churn measurement. The condition for being considered active is the same as for
    the start accounts, using the churn measurement end date for the criteria. This
    is step 3.'
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`end_accounts`—一个包含在 churn 测量结束时每个活跃账户的行表。被视为活跃的条件与起始账户相同，使用 churn 测量结束日期作为标准。这是步骤3。'
- en: '`churned_accounts`—A table with one row for each account that is active at
    the start but not active at the end. This table is created by the outer join on
    account IDs between the `start_accounts` table and the `end_accounts` table, and
    the `WHERE` clause that removes accounts where the end `account_id` is not null.
    This is step 4.'
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`churned_accounts`—一个包含在起始时活跃但在结束时不再活跃的每个账户的行表。此表通过在 `start_accounts` 表和 `end_accounts`
    表之间进行外连接，并使用 `WHERE` 子句删除结束 `account_id` 不为 null 的账户创建。这是步骤4。'
- en: '`downsell_accounts`—A table with one row for each account that is active at
    both the start and the end but that has a lower MRR at the end than at the start.
    This is created by a join on account IDs between the `start_accounts` table and
    the `end_accounts` table and a `WHERE` clause that selects only those records
    where the end MRR is less than the start MRR. This is step 5.'
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`downsell_accounts`—一个表，其中每行对应一个在开始和结束时都活跃但最终 MRR 低于开始的账户。这是通过在 `start_accounts`
    表和 `end_accounts` 表之间进行 ID 连接以及一个 `WHERE` 子句来创建的，该子句仅选择那些最终 MRR 低于开始 MRR 的记录。这是第
    5 步。'
- en: '`start_mrr`—A one-row table that sums the total MRR at the start of the churn
    measurement.'
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`start_mrr`—一个包含挂账测量开始时总 MRR 的单行表。'
- en: '`churn_mrr`—A one-row table that sums the total MRR of the churned accounts.'
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`churn_mrr`—一个包含挂账账户总 MRR 的单行表。'
- en: '`downsell_mrr`—A one-row table that sums the total MRR of all the retained
    accounts.'
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`downsell_mrr`—一个包含所有保留账户总 MRR 的单行表。'
- en: Final `SELECT` statement —Takes the results from the one-row result tables `start
    _mrr`, `churn_mrr`, and `downsell_mrr` and calculates the final results by plugging
    the values into equation 2.7\. This is step 6, the final step in the program.
  id: totrans-300
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最终 `SELECT` 语句 — 从单行结果表 `start_mrr`、`churn_mrr` 和 `downsell_mrr` 中获取结果，通过将值插入方程
    2.7 中来计算最终结果。这是第 6 步，程序中的最后一步。
- en: Listing 2.4 MRR churn SQL program
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 2.4 MRR 挂账 SQL 程序
- en: '[PRE7]'
  id: totrans-302
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: ① Sets the time period for which the SQL calculates churn
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: ① 设置 SQL 计算挂账的时间段
- en: ② CTE containing active accounts and their MRR at the start
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: ② 包含活跃账户及其开始时 MRR 的 CTE
- en: ③ Uses the aggregate sum in the case of multiple subscriptions
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 在存在多个订阅的情况下使用汇总总和
- en: ④ The criteria for being active on a given date
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 在给定日期上活跃的准则
- en: ⑤ Aggregates GROUP BY for the sum
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 对总和进行 GROUP BY 聚合
- en: ⑥ CTE containing active accounts and their MRR at the end
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 包含活跃账户及其最终 MRR 的 CTE
- en: ⑦ Uses the aggregate sum in case of multiple subscriptions
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: ⑦ 在存在多个订阅的情况下使用汇总总和
- en: ⑧ Aggregates GROUP BY for the sum
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: ⑧ 对总和进行 GROUP BY 聚合
- en: ⑨ CTE containing all IDs for accounts that churned
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: ⑨ 包含所有挂账账户 ID 的 CTE
- en: ⑩ Sums the total MRR in the case there are multiple subscriptions
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: ⑩ 在存在多个订阅的情况下汇总总 MRR
- en: ⑪ The join matches records by account ID and fills in nulls on no match.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: ⑪ 通过账户 ID 匹配记录，并在不匹配时填充 null。
- en: ⑫ Removes records where there is a non-null e.account_id
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: ⑫ 移除存在非空 e.account_id 的记录
- en: ⑬ CTE containing all the accounts that down sold
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: ⑬ 包含所有降级账户的 CTE
- en: ⑭ The down sell amount is positive by definition.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: ⑭ 根据定义，降级金额是正数。
- en: ⑮ The inner join selects accounts active at both the start and end.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: ⑮ 内连接选择开始和结束时都活跃的账户。
- en: ⑯ The WHERE condition selects accounts paying less at the end.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: ⑯ WHERE 条件选择最终支付更少的账户。
- en: ⑰ Sums the total MRR of all the accounts active at the start
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: ⑰ 汇总所有在开始时活跃的账户的总 MRR
- en: ⑱ Sums the total MRR of all the churned accounts
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: ⑱ 汇总所有挂账账户的总 MRR
- en: ⑲ CTE containing the total reduction in MRR from down sell
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: ⑲ 包含降级导致的 MRR 总减少的 CTE
- en: ⑳ Coalesce fills with zeros in case there are no down sells.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: ⑳ 如果没有降级，则 Coalesce 用零填充。
- en: ㉑ MRR churn formula
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: ㉑ MRR 挂账公式
- en: ㉒ Prints the components of the calculation
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: ㉒ 打印计算组件
- en: 'Listing 2.4 was tested on the simulated dataset produced by the code on the
    book’s website ([www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data))
    and in the book’s GitHub repository ([https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn))
    and generated the result shown in figure 2.12\. You should run listing 2.4 by
    following the README instructions on GitHub. After setting up your environment
    (detailed in the README), run the listing with this command:'
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 2.4 在书籍网站上代码生成的模拟数据集（[www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data)）以及书籍的
    GitHub 仓库（[https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)）上进行了测试，并生成了图
    2.12 所示的结果。您应按照 GitHub 上的 README 指示运行列表 2.4。在设置好环境（详情见 README）后，使用以下命令运行列表：
- en: '[PRE8]'
  id: totrans-326
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: In comparison to figure 2.7, which shows the result for the standard churn rate
    calculated with listing 2.2, this result shows the same churn rate. This is to
    be expected because the simulation uses the exact same MRR for every customer,
    so the simulation has no down sells or reason for this to differ from the standard
    calculation. That said, the simulation code can be extended to include the variable
    MRR, and that would make this exercise more interesting. I encourage you to do
    so as an exercise.
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 与图2.7所示的标准流失率计算结果相比，这个结果显示了相同的流失率。这是可以预料的，因为模拟为每位客户使用了完全相同的MRR，所以模拟没有降价销售或导致其与标准计算不同的原因。尽管如此，模拟代码可以被扩展以包括可变的MRR，这将使这个练习更有趣。我鼓励你作为练习这样做。
- en: '![](../Images/2-12.png)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/2-12.png)'
- en: Figure 2.12 Result of running listing 2.4 on the simulated dataset
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.12 在模拟数据集上运行列表2.4的结果
- en: 2.6.3 MRR churn vs. account churn vs. net (retention) churn
  id: totrans-330
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.6.3 MRR流失率 vs. 账户流失率 vs. 净（留存）流失率
- en: 'At this point, you have learned about three different churn formulas:'
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，你已经了解了三种不同的流失率公式：
- en: Net churn, calculated from net retention
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从净留存率计算得出的净流失率
- en: Standard (account-based) churn
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准的（基于账户的）流失率
- en: MRR churn
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MRR流失率
- en: 'You have also learned where each is usually appropriate:'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 你也已经了解了每种通常适用于哪种情况：
- en: Net retention and churn —For reporting as an operational metric to investors.
    Net-retention-based churn is equivalent to standard churn when all subscribers
    pay the same (or all subscribers pay nothing).
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 净留存率和流失率——作为向投资者报告的操作指标。基于净留存的流失率在所有订阅者支付相同（或所有订阅者不支付）时等同于标准流失率。
- en: Standard churn —For fighting churn when subscribers pay more or less the same,
    but there can be some variety in pricing and discounting that would complicate
    the interpretation of net retention.
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准流失率——用于应对订阅者支付金额大致相同，但价格和折扣可能存在一些差异，这可能会使净留存率的解释复杂化。
- en: MRR churn —For fighting churn when there is a large variety in the amounts different
    subscribers pay.
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MRR流失率——用于应对不同订阅者支付金额差异较大的情况。
- en: One fairly common situation where it is not appropriate to use MRR churn is
    for subscriptions that have an annual plan with lower MRR than the monthly plan.
    Subscribers can lock in a low rate but commit to a whole year by paying up front.
    This is usually good for the subscription business because if done correctly,
    it leads to higher lifetime value for the subscriber, as will be explained in
    chapter 8\. However, it would be considered a down sell when a subscriber switches
    from the monthly plan to the annual plan, and such changes would have a negative
    impact on the reported churn rate. In such a situation, it is probably better
    to use the standard churn rate.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 有一种相当常见的情况不适用于使用MRR流失率，那就是对于具有低于月度计划的年度计划的订阅。订阅者可以锁定一个低利率，但通过预付全年来承诺整个年份。这通常对订阅业务是有益的，因为如果做得正确，它会导致订阅者的终身价值更高，这一点将在第8章中解释。然而，当订阅者从月度计划切换到年度计划时，这会被视为降价销售，此类变化会对报告的流失率产生负面影响。在这种情况下，可能最好使用标准流失率。
- en: 'MRR churn is most appropriate when there is a truly great difference between
    MRR of different types of accounts: in B2B software sales, big accounts can easily
    pay 10 times or more the amount of small accounts. For companies that do have
    such variety in their pricing, there is usually a consistent relationship between
    the three churn measures.'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 当不同类型的账户的MRR之间存在真正巨大的差异时，MRR流失率最为合适：在B2B软件销售中，大账户可以轻松支付比小账户多10倍或更多的金额。对于具有此类价格差异的公司，这三个流失率指标之间通常存在一致的关系。
- en: TAKEAWAY Standard churn > MRR churn > Net churn
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 总结：标准流失率 > MRR流失率 > 净流失率
- en: You might expect that MRR churn would normally be higher than the standard churn
    measure because MRR churn includes the impact of down sells, but standard churn
    does not. However, as I will discuss in later chapters, it is almost always the
    case that accounts that pay more churn less often than accounts that pay less
    for multiprice products. The subscribers paying the least almost always churn
    more. This can seem paradoxical if you do not work on such a product, according
    to the logic that paying more should make a customer more unhappy. However, in
    B2B products, higher prices go to larger company subscribers that use the product
    more (have more users), and larger companies are almost always more stable than
    smaller companies. Also, larger companies paying more tend to be more committed
    to using the product for a longer time because they have had a longer deliberative
    process before making the purchase and have more invested in the setup and operation
    of the subscription product. As a result, the standard churn rate that counts
    all subscribers equally is almost always higher than the MRR churn rate for a
    B2B product.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会预期MRR流失率通常会比标准流失率指标高，因为MRR流失率包括了降价销售的影响，而标准流失率则不包括。然而，正如我将在后面的章节中讨论的，几乎总是情况是，支付更多费用的账户比支付较少费用的多价格产品账户流失得更少。如果你不从事这样的产品，这可能会显得有些矛盾，因为按照付费更多的逻辑，应该会让客户更不满意。然而，在B2B产品中，更高的价格往往属于使用产品更多（有更多用户）的大型公司订阅者，而大型公司几乎总是比小型公司更稳定。此外，支付更多费用的公司往往更愿意长期使用产品，因为他们在购买前有更长的考虑过程，并且在订阅产品的设置和运营上投入更多。因此，计算所有订阅者平等的标准化流失率几乎总是高于B2B产品的MRR流失率。
- en: Net churn calculated from net retention is almost always the least of all the
    churn measures. This is because, in addition to reflecting the low churn rate
    of large company subscribers, it also counts upsells in retained accounts against
    the churn rate. As mentioned previously, it is even possible for the net churn
    calculated from net retention to be negative when upsells outweigh down sells
    and churns.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 从净留存率计算出的净流失率几乎总是所有流失率指标中最小的。这是因为，除了反映大型公司订阅者的低流失率外，它还将保留账户中的升级销售计入流失率。正如之前提到的，当升级销售超过降价销售和流失时，从净留存率计算出的净流失率甚至可能是负数。
- en: 2.7 Churn rate measurement conversion
  id: totrans-344
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.7 流失率测量转换
- en: So far, the calculations have assumed you want to calculate the churn rate over
    one month. As I mentioned, it is possible to calculate churn over any time period,
    and most B2B product subscriptions calculate churn as an annual number to better
    reflect the typical length of a subscription. That’s fine because the calculation
    is the same, and using the same code to calculate annual churn is as easy as changing
    the start and end to suitable dates one year apart. But what if a company wants
    to calculate an annual churn rate but has been in operation for less than a year
    or has less than a year’s data in the database for some other reason? This is
    not a problem because you can convert a churn rate from a shorter period (like
    a month) to a longer period (like a year). But the relationship between churn
    measured over one month and churn measured over one year is not completely straightforward.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，计算假设你想要计算一个月的流失率。正如我提到的，可以计算任何时间段的流失率，大多数B2B产品订阅将流失率计算为年度数字，以更好地反映订阅的典型长度。这很好，因为计算是相同的，使用相同的代码计算年度流失率就像改变一年中相隔一年的起始和结束日期一样简单。但假设一家公司想要计算年度流失率，但运营时间不到一年，或者由于其他原因在数据库中只有不到一年的数据？这不是问题，因为你可以将较短时间（如一个月）的流失率转换为较长时间（如一年）的流失率。但是，一个月内测量的流失率和一年内测量的流失率之间的关系并不完全直接。
- en: 'Spoiler: annual churn is not 12 times monthly churn. This section shows how
    churn measurements made over different time frames are related and how to convert
    a churn measurement made over a month into an annual churn rate and vice versa.'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 揭秘：年度流失率不是月度流失率的12倍。本节展示了不同时间框架下流失率测量之间的关系，以及如何将一个月内的流失率测量转换为年度流失率，反之亦然。
- en: 2.7.1 Survivor analysis (advanced)
  id: totrans-347
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.7.1 生存分析（高级）
- en: Note that this section contains a lot of equations. If you don’t like math,
    you can skip to the answer, which is shown at the start of the next section.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，本节包含很多方程式。如果你不喜欢数学，可以跳到下一节开始处显示的答案。
- en: The key to understanding the relationship between monthly and annual churn is
    to think about retained customers as survivors and look at how many survive over
    many months. The term survivor comes from population studies in biology, which
    is where this kind of analysis originates, but it is perfectly reasonable to think
    of retained customers as survivors in a process where churn is like death. This
    is illustrated in figure 2.13, which shows what happens to an initial pool of
    subscribers if there is a monthly churn rate and, equivalently, a monthly retention
    rate of one minus the churn rate, as explained earlier in this chapter. Figure
    2.13 shows both a simple concrete example (on the left) and the same process in
    terms of algebraic equations (on the right).
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 理解每月和年度流失率之间关系的关键是，将保留客户视为幸存者，并观察他们在多个月份中的存活情况。术语“幸存者”来自生物学中的种群研究，这正是这种分析起源的地方，但将保留客户视为在流失如死亡的过程中的幸存者是合理的。这如图2.13所示，展示了如果存在每月流失率，以及等价的每月保留率（为流失率的倒数），如图中所述，初始订阅者池会发生什么。图2.13展示了左侧的一个简单具体例子，以及右侧的相同过程用代数方程表示。
- en: 'Here is how a churn process evolves over a year, starting with 100 accounts
    and a 10% (0.1) churn rate, which is depicted on the left side of figure 2.13:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是如何在一年中演变流失过程，从100个账户和10%（0.1）的流失率开始，如图2.13的左侧所示：
- en: At the beginning of the first month, there are 100 subscribers. During the first
    month, 100 × 0.1 = 10 customers churn, leaving 90\. This is equivalent to 100
    times the retention rate of 0.9.
  id: totrans-351
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一个月初，有100个订阅者。在第一个月中，100 × 0.1 = 10个客户流失，剩下90个。这相当于100乘以保留率0.9。
- en: At the beginning of the second month, there are 90 subscribers, and during the
    second month, 90 × 0.1 = 9 customers churn, leaving 81\. This is equivalent to
    the original 100 multiplied by the retention rate squared because 81 = 100 × 0.81
    = 100 × 0.9² .
  id: totrans-352
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第二个月初，有90个订阅者，在第二个月中，90 × 0.1 = 9个客户流失，剩下81个。这相当于原始的100乘以保留率的平方，因为81 = 100
    × 0.81 = 100 × 0.9²。
- en: Note that because the churn rate is the percent of accounts that churn, if there
    are fewer accounts to begin with, then fewer will churn, although the rate of
    churn is the same.
  id: totrans-353
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，因为流失率是流失账户的百分比，如果一开始账户较少，那么流失的账户也会较少，尽管流失率是相同的。
- en: At the beginning of the third month, there are 81 subscribers, and during the
    third month, 81 × 0.1 » 8 customers churn, leaving 73\. This is equivalent to
    the original 100 multiplied by the retention rate cubed because 73 = 100 × 0.73
    » 100 × 0.9³ .
  id: totrans-354
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第三个月初，有81个订阅者，在第三个月中，81 × 0.1 ≈ 8个客户流失，剩下73个。这相当于原始的100乘以保留率的立方，因为73 = 100
    × 0.73 ≈ 100 × 0.9³。
- en: The pattern that continues in subsequent months is that after 12 months, there
    are 100 × 0.9^(12) = 28 customers remaining.
  id: totrans-355
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在随后的几个月中持续的模式是，12个月后，剩下100 × 0.9^(12) = 28个客户。
- en: '![](../Images/2-13.png)'
  id: totrans-356
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2-13.png)'
- en: Figure 2.13 Survival of accounts over a year of monthly churn
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.13 每月流失率下账户一年的存活情况
- en: 'In terms of equations (the right side of figure 2.13), this is the process
    month by month for the first few months and then showing this general pattern:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 从方程（图2.13的右侧）来看，这是前几个月每月的过程，然后展示这种一般模式：
- en: At the beginning of the first month, there are N subscribers, but during the
    first month, cN churn according to the definition of the churn rate. At the end
    of the month (1 − *c*)*N* or rN subscribers remain.
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第一个月初，有N个订阅者，但根据流失率的定义，在第一个月中，cN个客户流失。月底剩余的订阅者数为(1 − c)*N*或rN。
- en: At the beginning of the second month, there are rN = (1 − *c*)*N* accounts,
    and *c*(1 − *c*)*N* churn during the month. The number of accounts remaining after
    month two is (1 − *c*)*N*, the starting number, minus *c*(1 − *c*)*N*, the number
    that churn, or (1 − *c*)*N* − *c*(1 − *c*)*N*.
  id: totrans-360
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第二个月初，有rN = (1 − c)*N*个账户，在一个月中流失*c*(1 − c)*N*个。两个月后剩余的账户数为起始数(1 − c)*N*减去流失数*c*(1
    − c)*N*，即(1 − c)*N* − *c*(1 − c)*N*。
- en: It is not too hard to work out the algebra and show that from the definition
    of the retention rate
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 工作出代数并证明从保留率的定义来看，这并不太难。
- en: (1 − *c*)*N* − [*c*(1 − *c*)*N* = (1 − *c*)*N* × (1 − *c*) = (1 − *c*)² *N*
  id: totrans-362
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: (1 − c)*N* − [*c*(1 − c)*N* = (1 − c)*N* × (1 − c) = (1 − c)² *N*
- en: and
  id: totrans-363
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 和
- en: (1 − *c*)² *N* = *r*² *N*
  id: totrans-364
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: (1 − c)² *N* = r² *N*
- en: At the beginning of the third month, there are *r*² *N* = (1 − *c*)² *N*, and
    *c*(1 − *c*)² *N* churn during the month. The number of accounts remaining after
    month three is (1 − *c*)² *N*, the starting number, minus *c*(1 − *c*)² *N*, the
    number that churn, or (1 − *c*)² *N* − *c*(1 − *c*)² *N*.
  id: totrans-365
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在第三个月初，有 *r*² *N* = (1 − *c*)² *N* 的账户，并且在一个月内有 *c*(1 − *c*)² *N* 的账户流失。三个月后剩余的账户数是起始数
    (1 − *c*)² *N* 减去流失的账户数 *c*(1 − *c*)² *N*，或者 (1 − *c*)² *N* − *c*(1 − *c*)² *N*。
- en: It is not too hard to work out the algebra and show that from the definition
    of the retention rate
  id: totrans-366
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 计算代数并不困难，可以证明从保留率的定义
- en: (1 − *c*)² *N* − [*c*(1 − *c*)²]*N* = (1 − *c*)² *N* × (1 − *c*) = (1 − *c*)³
    *N*
  id: totrans-367
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: (1 − *c*)² *N* − [*c*(1 − *c*)²]*N* = (1 − *c*)² *N* × (1 − *c*) = (1 − *c*)³
    *N*
- en: and
  id: totrans-368
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 并且
- en: (1 − *c*)³ *N* = *r*³ *N*
  id: totrans-369
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: (1 − *c*)³ *N* = *r*³ *N*
- en: The pattern that continues in subsequent months is that after *x* months, there
    are
  id: totrans-370
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在随后的月份中持续的模式是，经过 *x* 个月后，有
- en: '*r*^(*x*) *N* = (1 − *c*)^(*x*) *N*'
  id: totrans-371
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '*r*^(*x*) *N* = (1 − *c*)^(*x*) *N*'
- en: This shows that the number of retained accounts over many months is equal to
    the retention rate to the power of the number of months multiplied by the number
    of accounts at the start.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明在多个月份中保留的账户数量等于保留率的次方乘以起始账户数量。
- en: 2.7.2 Churn rate conversions
  id: totrans-373
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.7.2 流失率转换
- en: The multimonth relationship for retention rates is the key to converting monthly
    churn rates to an annual measurement. In the previous section, I showed you that
    the number of retained customers after one year in which the month churn rate
    is c and the monthly retention rate is r = (1 − *c*) is
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 保留率的跨月关系是将月度流失率转换为年度测量的关键。在前一节中，我向你展示了在一个月流失率为 c，月度保留率为 r = (1 − *c*) 的情况下，一年后保留的客户数量是
- en: '*N*[*year*] = *r*^(12)*N*'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: '*N*[*year*] = *r*^(12)*N*'
- en: It follows that the one-year retention rate, which is denoted by *R*, is
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，一年的保留率，用 *R* 表示，是
- en: '| *R* = *r*^(12) | Equation 2.14 |'
  id: totrans-377
  prefs: []
  type: TYPE_TB
  zh: '| *R* = *r*^(12) | 方程式 2.14 |'
- en: Equation 2.14 shows how to convert from monthly retention rate r to an annual
    retention rate R. This follows directly from the definition because the number
    of customers retained after a year must be equal to the number at the start times
    the annual retention rate. Also, from the definition, you know that the annual
    churn rate, which I denote as C, must be equal to 100% minus the annual retention
    rate. It follows that the annual churn rate C must be equal to
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 方程式 2.14 展示了如何将月度保留率 r 转换为年度保留率 R。这直接来自定义，因为一年后保留的客户数量必须等于起始数量乘以年度保留率。同样，从定义中，你知道年度流失率，我用
    C 表示，必须等于 100% 减去年度保留率。因此，年度流失率 C 必须等于
- en: '| *C* = 100% − *R**C* = 100% − *r*^(12)*C* = 100% − (1 − *c*)^(12) | Equation
    2.15 |'
  id: totrans-379
  prefs: []
  type: TYPE_TB
  zh: '| *C* = 100% − *R**C* = 100% − *r*^(12)*C* = 100% − (1 − *c*)^(12) | 方程式 2.15
    |'
- en: In a few words, the annual churn rate is equal to one minus one minus the monthly
    churn rate to the twelfth power. That sounds complicated, but it’s pretty easy
    to understand in terms of the retention rate. The annual retention rate is the
    monthly retention rate to the twelfth power.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，年度流失率等于 1 减去 1 减去月度流失率的十二次方。这听起来很复杂，但用保留率来理解就很容易了。年度保留率是月度保留率的十二次方。
- en: TAKEAWAY To convert monthly churn rate to annual, use the fact that annual retention
    is monthly retention to the twelfth power, and retention is one minus churn.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: '**要点**：要将月度流失率转换为年度，使用年度保留率是月度保留率的十二次方的这一事实，以及保留率是 1 减去流失率。'
- en: 'Note that the annual retention rate is less than the monthly retention rate
    because taking a number less than one to any power reduces it further. This makes
    sense as more must churn in a year than in a month: the subscribers have 12 times
    longer to churn. The annual churn rate, on the other hand, must be greater than
    the monthly churn rate, again because there is more time to churn.'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，年度保留率低于月度保留率，因为将小于 1 的数提高到任何次方都会进一步减小它。这很合理，因为一年中流失的账户必须比一个月中多：订阅者有 12 倍更长的时间流失。另一方面，年度流失率必须大于月度流失率，因为有更多的时间流失。
- en: What about converting the annual measurement of the churn rate to monthly? I
    won’t go into all the details, but the same relationship holds in reverse. If
    you refer back to equation 2.14 and take the twelfth root of both sides, you get
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 那么如何将年度流失率的测量转换为月度呢？我不会深入所有细节，但反向关系是相同的。如果你参考方程式 2.14 并对等式的两边取十二次方根，你会得到
- en: '| ![](../Images/2-13_E16.png) | Equation 2.16 |'
  id: totrans-384
  prefs: []
  type: TYPE_TB
  zh: '| ![](../Images/2-13_E16.png) | 方程式 2.16 |'
- en: 'Equation 2.16 shows how to convert from an annual churn R to a monthly churn
    rate r. I use the notation that the twelfth root of a number is implemented by
    taking the number to the twelfth (1/12) power. If you are not familiar with root
    operations, recall that the square root of a number *x* is that number which when
    squared gives x. The twelfth root is defined similarly: the twelfth root of *x*
    is the number that when taken to the twelfth power gives x. Don’t worry. No one
    calculates twelfth roots and powers in their head, but it’s a piece of cake in
    any programming language. Taking the twelfth root is the same as raising a number
    to the one-twelfth (1/12) power, and this is how such roots are implemented in
    most programming languages.'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 公式2.16展示了如何将年度流失率R转换为月度流失率r。我使用符号表示一个数的十二次方根是通过将该数提高到十二次方（1/12）的幂来实现的。如果您不熟悉根运算，请回忆一下，一个数*x*的平方根是那个数，当它平方时给出x。十二次方根定义类似：一个数*x*的十二次方根是那个数，当它提高到十二次方时给出x。不用担心，没有人会在头脑中计算十二次方根和幂，但在任何编程语言中这都是小菜一碟。取十二次方根等同于将一个数提高到1/12的幂，这是大多数编程语言中实现此类根的方式。
- en: 'The equivalent monthly retention rate for an annual retention measurement is
    just the twelfth root of the annual measurement. Similarly, this equation calculates
    an equivalent monthly churn rate from an annual measurement:'
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: 对于年度留存率的测量，等效月度留存率只是年度测量的十二次方根。同样，此方程从年度测量计算等效月度流失率：
- en: '| ![](../Images/2-13_E17.png) | Equation 2.17 |'
  id: totrans-387
  prefs: []
  type: TYPE_TB
  zh: '| ![图2-13_E17](../Images/2-13_E17.png) | 公式2.17 |'
- en: Equation 2.17 shows how to convert from an annual churn rate C to a monthly
    churn rate c.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 公式2.17展示了如何将年度流失率C转换为月度流失率c。
- en: TAKEAWAY To convert annual churn rate to monthly, use the fact that monthly
    retention is the twelfth root of annual retention, and retention is one minus
    churn.
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: '**总结**：要将年度客户流失率转换为月度流失率，可以使用以下事实：月度留存率是年度留存率的十二次方根，而留存率是1减去流失率。'
- en: 2.7.3 Converting any churn measurement window in SQL
  id: totrans-390
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '**2.7.3**：在SQL中转换任何流失率测量窗口'
- en: 'You can easily convert any churn measurement window into an equivalent churn
    rate for any other measurement window. This is a good trick to use if you need
    to measure churn for a company with less than one year of data in the subscription
    database. You would calculate a churn rate with as much data as is available (whether
    it is 2, 6, or 10 months) and then convert the result into an annual churn rate.
    I won’t go into details, but for any churn measurement, c'' made over any time
    period of p days is the equivalent annual churn rate C:'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以轻松地将任何流失率测量窗口转换为任何其他测量窗口的等效流失率。如果您需要测量订阅数据库中数据少于一年的公司的流失率，这是一个很好的技巧。您可以使用可用的所有数据（无论是2个月、6个月还是10个月）来计算流失率，然后将结果转换为年度流失率。我不会深入细节，但对于任何流失率测量，c'在p天内超过任何时间段的等效年度流失率C：
- en: '| *C* = 100% − (1 − *c*'')^(365/p) | Equation 2.18 |'
  id: totrans-392
  prefs: []
  type: TYPE_TB
  zh: '| *C* = 100% − (1 − *c*'')^(365/p) | 公式2.18 |'
- en: 'In this case, the power to which the measured retention rate (1 − *c*'' ) is
    taken to is 365 divided by the length of the time period p. If p were 1 month,
    this would reduce to (approximately) 12\. Similarly, the monthly churn rate c
    can be calculated from a churn rate c'' made over any period of p days with equation
    2.19:'
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，所测量的留存率（1 − *c*'）被提高到的是365除以时间周期长度p。如果p是1个月，这将减少到（大约）12。同样，可以从任何p天的时间段的流失率c'中计算出月度流失率c，使用公式2.19：
- en: '| *c* = 100% − (1 − *c*'')^((365/12)[*p*]) | Equation 2.19 |'
  id: totrans-394
  prefs: []
  type: TYPE_TB
  zh: '| *c* = 100% − (1 − *c*'')^((365/12)[*p*]) | 公式2.19 |'
- en: Returning to the calculation of churn rates from a subscription database with
    SQL, it’s easy to calculate both monthly and annual churn rates from one measurement
    of churn made over any time period. Listing 2.5 shows the necessary SQL `SELECT`
    statement, assuming the same common table expression as the regular churn rate
    calculation in listing 2.2, except that the start and end dates in the `date_range`
    CTE can be any dates (any dates where the end date is after the start date, that
    is). This SQL implements equations 2.13 and 2.14 as part of the `SELECT` statement
    by calculating the time period p on the fly.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 回到从订阅数据库中计算流失率的计算，从任何时间段的流失率测量中很容易计算出月度和年度流失率。列表2.5显示了必要的SQL `SELECT` 语句，假设与列表2.2中常规流失率计算相同的公共表表达式，除了`date_range`
    CTE中的开始和结束日期可以是任何日期（即结束日期在开始日期之后）。此SQL通过动态计算时间周期p作为`SELECT`语句的一部分来实现公式2.13和2.14。
- en: Listing 2.5 Churn SQL `SELECT` statement for uneven time periods
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: '**列表2.5**：不均匀时间段的流失率SQL `SELECT` 语句'
- en: '[PRE9]'
  id: totrans-397
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: ① Number of subscribers at the start, as in listing 2.2
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: ① 如列表 2.2 所示的起始订阅者数量
- en: ② Number of subscribers that churned, as in listing 2.2
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: ② 如列表 2.2 所示的客户流失订阅者数量
- en: ③ Standard churn rate calculation (equation 2.1)
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
  zh: ③ 标准客户流失率计算（公式 2.1）
- en: ④ Displays the difference in days between the start and end dates
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: ④ 显示开始日期和结束日期之间的天数差异
- en: ⑤ Equation 2.13
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: ⑤ 公式 2.13
- en: ⑥ Equation 2.14
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: ⑥ 公式 2.14
- en: An example of the result of using the `SELECT` statement in listing 2.5 is shown
    in figure 2.14\. In this case, because the measurement period is between one month
    and one year, the equivalent annual churn rate is more than the measured churn
    rate, and the equivalent monthly churn rate is less than the measured churn rate.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 2.5 中使用 `SELECT` 语句的结果示例显示在图 2.14 中。在这种情况下，因为测量周期在一个月到一年之间，等效年度客户流失率高于测量的客户流失率，而等效月度客户流失率低于测量的客户流失率。
- en: 'Listing 2.5 was tested on the simulated dataset produced with the code on the
    book’s website ([www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data))
    and in the GitHub repository ([https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn))
    and generated the result shown in figure 2.14\. You should run listing 2.5 by
    using this listing wrapper script (the same command as early in the chapter),
    changing the listing parameter to `—listing` `5`:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 2.5 在书籍网站上提供的代码生成的模拟数据集上进行了测试（[www.manning.com/books/fighting-churn-with-data](http://www.manning.com/books/fighting-churn-with-data)）以及在
    GitHub 仓库（[https://github.com/carl24k/fight-churn](https://github.com/carl24k/fight-churn)）中，并生成了图
    2.14 中所示的结果。你应该通过使用这个列表包装脚本（与章节早期相同的命令），将列表参数更改为 `—listing` `5` 来运行列表 2.5：
- en: '[PRE10]'
  id: totrans-406
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: In comparison to figure 2.8, which shows the result for the standard churn rate
    calculated with listing 2.2, this result measures the churn rate over 92 days
    (a hypothetical example assuming there is 92 days’ worth of data available to
    calculate an annual churn rate). The result includes a monthly version of the
    churn rate and an annualized version of the churn rate. The monthly churn rate
    is similar but not exactly the same as the result in figure 2.8—this monthly churn
    rate is an average monthly rate over the entire 92 days.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 与图 2.8 相比，图 2.8 显示了使用列表 2.2 计算的标准客户流失率的结果，这个结果衡量了 92 天的客户流失率（这是一个假设的例子，假设有 92
    天的数据来计算年度客户流失率）。结果包括月度客户流失率和年度化客户流失率。月度客户流失率与图 2.8 中的结果相似，但并不完全相同——这个月度客户流失率是整个
    92 天的平均月度流失率。
- en: '![](../Images/2-14.png)'
  id: totrans-408
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2-14.png)'
- en: Figure 2.14 Result of running listing 2.5 on the simulated dataset
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.14 运行列表 2.5 在模拟数据集上的结果
- en: 2.7.4 Picking the churn measurement window
  id: totrans-410
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.7.4 选择客户流失率测量窗口
- en: Given that you have a choice, you might be wondering what time frame you should
    choose to measure churn. In general, you should measure the churn rate for a time
    frame that is close to the typical subscription renewal term (if there are subscriptions).
    Then you can use the methods in this section to scale the measurement if you need
    to report churn another way.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 既然你有选择，你可能想知道应该选择什么时间段来衡量客户流失率。一般来说，你应该选择一个接近典型订阅续订期限的时间段来衡量客户流失率（如果有订阅的话）。然后，如果你需要以其他方式报告客户流失，你可以使用本节中的方法来扩展测量。
- en: TAKEAWAY Churn on consumer subscriptions is usually measured as a monthly rate,
    and churn on business subscriptions is measured as an annual rate.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 吸收要点：消费者订阅的客户流失率通常按月度率衡量，而商业订阅的客户流失率按年度率衡量。
- en: Problems can arise if you measure churn in a time frame that is different from
    your typical subscriptions. The issues are a bit different if your subscriptions
    are mostly monthly or mostly annual.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你以与典型订阅不同的时间段来衡量客户流失率，可能会出现问题。如果你的订阅主要是按月或按年进行，问题会有所不同。
- en: First consider the case of annual subscriptions. If your subscriptions are mostly
    annual, and you measure churn over one month, you have to make sure the month
    you choose has approximately one-twelfth of your annual renewals. Otherwise, the
    churn measurement will be biased. For many businesses, most renewals come in a
    particular season; if this is the case, and you measure churn over any other time
    of year, you will see an artificially low churn rate. Conversely, if you measure
    churn over a month that happens to have a large number of the annual customers
    up for renewal, you can end up calculating an artificially high churn rate by
    seeing much of the year’s churns in a short time.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 首先考虑年度订阅的情况。如果你的订阅主要是年度的，并且你在一月内测量客户流失率，你必须确保你选择的月份大约有年度续订的十二分之一。否则，客户流失率的测量将会存在偏差。对于许多企业来说，大多数续订都集中在特定季节；如果情况如此，并且你在一年中的其他时间测量客户流失率，你将看到人为降低的客户流失率。相反，如果你在恰好有大量年度客户需要续订的月份测量客户流失率，你可能会通过在短时间内看到大部分年度的客户流失而计算出人为高的客户流失率。
- en: If your subscriptions are mostly monthly, and you measure churn over a year,
    then the churn calculation will miss accounts that start and churn in between
    the two dates. To see this, note that all the churn calculations in this chapter
    check the accounts on just two dates, and accounts that are active in between
    the two dates would be ignored. This results in an underestimate of the churn
    rate. This is a problem, in general, if you measure churn with a time period that
    is longer than the shortest subscriptions.
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的订阅主要是月度的，并且你在一年的时间里测量客户流失率，那么客户流失率的计算将错过在两个日期之间开始和流失的账户。为了说明这一点，请注意，本章中所有的客户流失率计算都只检查了两个日期的账户，而在两个日期之间活跃的账户将被忽略。这导致了对客户流失率的低估。一般来说，如果你使用的时间周期长于最短的订阅，这会成为一个问题。
- en: WARNING Measuring churn over a time window that is different from the typical
    subscription length (or typical customer active lifetime) can result in errors
    in the churn rate.
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：在不同于典型订阅长度的时间窗口内测量客户流失率可能会导致客户流失率计算错误。
- en: 2.7.5 Seasonality and churn rates
  id: totrans-417
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.7.5 季节性和客户流失率
- en: 'In the previous section, I warned you that calculating churn using a time frame
    that is different from the typical subscription length can cause problems. There
    is one other type of problem to beware of when calculating churn rates, and it
    applies mainly to monthly churn calculations: seasonality.'
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，我警告过你，使用不同于典型订阅长度的时间框架来计算客户流失率可能会引起问题。在计算客户流失率时，还有另一种类型的问题需要注意，这主要适用于月度客户流失率的计算：季节性。
- en: DEFINITION Seasonality —Variations that occur at particular times of the year.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 定义：季节性——在一年中的特定时间发生的变动。
- en: Many subscription businesses have seasonal variations in the churn rate, and
    if you are measuring churn with monthly time windows, you may find the churn rate
    moves up and down throughout the year due to seasonal effects. The challenge is
    that when you start trying to reduce churn, if you do not correct for seasonality,
    it can be hard to know if changes you see in the churn rate are due to your churn-fighting
    efforts or seasonal variation.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 许多订阅业务在客户流失率上有季节性变化，如果你使用月度时间窗口来测量客户流失率，你可能会发现由于季节性影响，客户流失率在一年中上下波动。挑战在于，当你开始尝试降低客户流失率时，如果你不纠正季节性影响，你可能很难知道你在客户流失率上看到的变化是由于你的客户流失率降低努力还是季节性变化。
- en: WARNING If you use monthly churn rates, seasonality can make it hard to assess
    the impact of churn-reduction efforts.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：如果你使用月度客户流失率，季节性可能会使评估客户流失率降低措施的影响变得困难。
- en: 'Seasonality is less of a problem for annual measurement because an annual churn
    measurement always includes every season of the year. If you make one annual churn
    measurement in January and another annual churn measurement in February, both
    churn measurements include every season: the difference between two annual churn
    measurements made a month apart reflects the difference between the churns in
    that month and the same month one year earlier, so the change in churn rate is
    already controlled for seasonality. (If many annual renewals occur in one season,
    then that season can be a time when the churn rate changes significantly; the
    rest of the year, changes in the churn rate are smaller because fewer renewals
    occur. But having a critical season in the business when contracts renew is not
    the same as seasonality.)'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 对于年度测量，季节性问题较少，因为年度流失率测量总是包括一年中的每个季节。如果你在1月份进行一次年度流失率测量，然后在2月份进行另一次年度流失率测量，两次年度流失率测量都包括每个季节：两个相隔一个月的年度流失率测量之间的差异反映了该月流失率与一年前同一月的流失率之间的差异，因此流失率的变动已经控制了季节性。（如果许多年度续订发生在某个季节，那么这个季节可能是流失率显著变化的时期；在其余年份，流失率的变动较小，因为续订次数较少。但业务中合同续订的关键季节并不等同于季节性。）
- en: What do you do if you use monthly churn rates? First, measure monthly churn
    rates over as many years as possible, and try to determine if there is a significant
    seasonal pattern. You will need at least two years of history to see if there
    are seasonal patterns; with just one year of data, you can’t tell if a pattern
    is seasonal or if it has some other cause.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用月度流失率，你会怎么做？首先，尽可能多地测量过去几年的月度流失率，并尝试确定是否存在显著的季节性模式。你需要至少两年的历史数据来查看是否存在季节性模式；仅有一年的数据，你无法判断一个模式是否为季节性的，或者它是否有其他原因。
- en: If you do have a seasonal pattern, then you have a couple of choices to correct
    for it. An ad hoc approach to dealing with seasonality is just to be aware of
    the seasonal trends and look for other changes in churn rate, resulting from churn-reduction
    efforts or changes in the business environment that are significantly bigger than
    the usual seasonal variation. If you are trained in statistics, you can do this
    rigorously by using appropriate techniques for time series analysis. Such advanced
    statistics is beyond the scope of this book, but see Analysis of Financial Time
    Series by Ruey S. Tsay (3rd ed., Wiley, 2010) if you are interested. There are
    a few ways to handle seasonality in churn rates that don’t require advanced statistics,
    but they involve a slightly more complicated churn calculation and at least two
    years of data. Going into a lot of detail on these is too much to put in this
    book, but I can give you a few ideas here.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你确实有季节性模式，那么你有几种选择来纠正它。处理季节性的临时方法是只是意识到季节性趋势，并寻找其他导致流失率变化的变化，这些变化来自减少流失的努力或商业环境的改变，这些变化比通常的季节性变化要大得多。如果你受过统计学训练，你可以通过使用时间序列分析的正确技术来严格地做到这一点。这种高级统计学超出了本书的范围，但如果你对《Ruey
    S. Tsay的金融时间序列分析》（第3版，Wiley，2010）感兴趣，可以参考。有一些处理流失率季节性的方法不需要高级统计学，但它们涉及稍微复杂一些的流失率计算，并且至少需要两年的数据。在这里详细讨论这些内容太多，但我可以给你一些想法。
- en: 'One way to calculate a churn rate that controls for seasonality is to make
    an annual churn calculation on month-to-month subscriptions but fix the problems
    using annual churn on monthly subscriptions. Recall that in the previous section,
    you learned that if you make an annual churn calculation on monthly subscriptions,
    you miss accounts that signed up and churned midyear. One solution is that instead
    of looking at all the accounts active on each date two years apart, you look at
    all the accounts that were active within a year prior of each date. The process
    is as follows:'
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 计算一个控制季节性的流失率的方法之一是在按月订阅上进行年度流失率计算，但使用按月订阅的年度流失率来解决问题。回想一下，在上一节中，你了解到如果你在按月订阅上进行年度流失率计算，你会错过年中注册并流失的账户。一个解决方案是，你不再查看两年间每个日期活跃的所有账户，而是查看每个日期前一年内活跃的所有账户。这个过程如下：
- en: Find all accounts active any time in year 1.
  id: totrans-426
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找出在第一年任何时间活跃的所有账户。
- en: Find all accounts active any time in year 2.
  id: totrans-427
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找出在第二年任何时间活跃的所有账户。
- en: Find churned accounts by comparing the two sets with an outer join.
  id: totrans-428
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过比较这两个集合使用外部连接来找出流失账户。
- en: Divide the lost accounts by the number in year 1.
  id: totrans-429
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将失去的账户数量除以第一年的账户数量。
- en: The churn calculated that way is an annual churn rate that does not miss midyear
    churns and includes all seasons. If you repeat the calculation one month (or one
    quarter) later, the change in the churn rate reflects the difference between churn
    in that month (or that quarter) and the same time one year earlier. It is controlled
    for seasonality.
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 这样计算的流失率是一个年度流失率，不会错过年中流失，并包括所有季节。如果你一个月（或一个季度）后重复计算，流失率的变化反映了该月（或该季度）的流失与一年前同一时间的流失之间的差异。它考虑了季节性。
- en: One downside of this approach is that it allows a new signup any time within
    a year, and the customer won’t be counted as a churn. If you have many accounts
    that churn and sign up again later, you should stick with the regular monthly
    churn calculation and handle seasonality differently.
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法的一个缺点是它允许在任何一年内的新注册，并且客户不会被计算为流失。如果你有很多账户流失后又重新注册，你应该坚持使用常规的月度流失率计算，并不同样处理季节性。
- en: Another relatively simple way to handle seasonality with monthly churn rates
    is to calculate monthly churn rates every calendar month and then make averages
    over quarters (or a year) for comparison purposes. Rather than comparing one month’s
    churn rate to the next, which can be influenced by seasonality, compare the average
    of 12 monthly churn rates from the last year to the average of 12 monthly churn
    rates from the previous year. Or compare the average churn rate from the last
    three months to the average churn rate from the same three months one year earlier.
    Then you can see if anything you have done to improve churn in the last year made
    a difference in the churn rate from the same quarter one year ago. Because you
    are comparing to the same quarter, you are controlling seasonality. You can take
    this approach with one month and compare one month to the same month one year
    earlier, which also controls seasonality. Also note that comparing one calendar
    month’s churn rate to the churn rate in the same period one year earlier requires
    only 13 months of data, so this is probably the best option for new companies.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种处理月度流失率季节性的相对简单方法是，每月计算月度流失率，然后为了比较目的对季度（或一年）进行平均。而不是比较一个月的流失率与下一个月，这可能会受到季节性的影响，而是比较去年12个月的月度流失率的平均值与上一年12个月的月度流失率的平均值。或者比较过去三个月的平均流失率与一年前同一三个月的平均流失率。这样你就可以看到你去年为改善流失率所做的一切是否对一年前同一季度的流失率产生了影响。因为你在比较同一季度，所以控制了季节性。你可以用这种方法来比较一个月，将一个月与一年前同一个月进行比较，这也控制了季节性。此外，请注意，将一个日历月的流失率与一年前同一期间的流失率进行比较，只需要13个月的数据，所以这可能是新公司最好的选择。
- en: Summary
  id: totrans-433
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Churn rates measure how many subscribers and/or how much revenue churns from
    a service over a period of time.
  id: totrans-434
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 流失率衡量在一定时间内有多少订阅者和/或多少收入从一项服务中流失。
- en: The churn rate and retention rate are interchangeable according to the relationship
    retention plus churn equals 100%.
  id: totrans-435
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 流失率和留存率根据留存加流失等于100%的关系可以互换。
- en: Different versions of the churn rates can be calculated on a subscription database
    using SQL.
  id: totrans-436
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以使用 SQL 在订阅数据库上计算不同版本的流失率。
- en: Outer joins are used to identify churned accounts in SQL.
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 外连接在 SQL 中用于识别流失的账户。
- en: The standard churn rate measures the number of account holders who cancel their
    subscriptions and is unaffected by upsells and down sells. The standard churn
    rate is most useful for subscription products where there are a few prices that
    are not far apart or possibly some discounts.
  id: totrans-438
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标准流失率衡量取消订阅的账户数量，不受促销和降价的影响。标准流失率对于价格相差不远或可能有折扣的订阅产品最有用。
- en: Net retention includes the impact of both upsells and down sells, which makes
    it less useful for fighting churn, but it is a popular reporting metric.
  id: totrans-439
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 净留存率包括促销和降级的双重影响，这使得它对于对抗流失不那么有用，但它是一个流行的报告指标。
- en: If all subscribers pay the same (or pay nothing), net retention equals the standard
    retention, and net churn equals standard churn.
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果所有订阅者支付相同（或什么都不支付），净留存率等于标准留存率，净流失率等于标准流失率。
- en: MRR churn includes the impact of down sells but not upsells and is the best
    metric for measuring churn when subscribers pay a wide variety of prices, as is
    typical for B2B products.
  id: totrans-441
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MRR 流失率包括降级的影响，但不包括升级，是衡量订阅者支付广泛价格时的流失率的最佳指标，这在 B2B 产品中很常见。
- en: For nonsubscription products, churn can be measured based on event data by defining
    customers as active whenever they have had an event within a recent time period.
    Churn is then calculated as the difference between the sets of accounts that are
    active on two different dates.
  id: totrans-442
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于非订阅产品，可以通过定义客户在最近时间段内发生事件时为活跃客户，基于事件数据来衡量挂失率。然后，挂失率计算为两个不同日期上活跃账户集合之间的差异。
- en: Churn measured over any time period can be converted into an equivalent churn
    rate for any other time period.
  id: totrans-443
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在任何时间段内测量的挂失率都可以转换为任何其他时间段的等效挂失率。
- en: Churn rates are converted from one time period to another by survivor analysis
    on retention rates, which are then converted back to churn rates.
  id: totrans-444
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 挂失率通过保留率的生存分析从一段时间转换为另一段时间，然后保留率再转换回挂失率。
- en: To convert a churn rate, the corresponding retention rate is taken to a power
    to increase the time period; a root of the retention rate is used to decrease
    the time period.
  id: totrans-445
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要转换挂失率，将相应的保留率提高到某个幂次以增加时间段；使用保留率的根来减少时间段。
- en: Churn is usually measured as a monthly rate for consumer products and an annual
    rate for business products.
  id: totrans-446
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 挂失率通常按月度比率衡量消费者产品，按年度比率衡量商业产品。
- en: Problems may arise if you measure churn on a time scale that is different from
    the typical subscription length.
  id: totrans-447
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你在与典型订阅长度不同的时间尺度上测量挂失率，可能会出现问题。
- en: For monthly churn rates, seasonality can be an issue when interpreting changes
    in the churn rate.
  id: totrans-448
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于月度挂失率，在解释挂失率的变化时，季节性可能成为一个问题。
