- en: Chapter 7\. Working with Geospatial Data
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第七章。处理地理空间数据
- en: When was the last time you looked—and we mean *really looked*—at a map? Have
    you ever stopped to admire and acknowledge the amount of data and information
    they house?
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 您上次真正地看过地图是什么时候？我们指的是*真正地*看过地图？您有没有停下来赞赏和认识到它们所包含的大量数据和信息？
- en: '*Maps* are one of the most powerful visualization types and perhaps the one
    we encounter earliest in life. Try to remember when you first understood how to
    read a map—it’s hard to recall, right? Many people understand maps at an almost
    instinctual level, which makes them useful tools for communicating data.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '*地图*是最强大的可视化类型之一，也许是我们在生活中最早接触到的类型之一。试着回想一下你第一次理解如何阅读地图的时候——很难回想起来，对吧？许多人几乎本能地理解地图，这使它们成为传达数据的有用工具。'
- en: It’s important to remember that geographic proximity and distribution are central
    to any map analysis. That is really the key distinguishing factor when you’re
    considering making a map. Just because you *can* map something doesn’t mean you
    *should*.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，地理邻近性和分布对任何地图分析至关重要。这实际上是在考虑制作地图时的关键区别因素。仅仅因为*能够*绘制某些内容，并不意味着*应该*这样做。
- en: Throughout this chapter, we will show you techniques for creating maps in Tableau.
    We’ll also help you see when it’s appropriate to create a map instead of something
    simpler, like the trusty bar chart.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中，我们将向您展示在Tableau中创建地图的技术。我们还将帮助您了解何时适合创建地图，而不是像可靠的条形图那样简单的东西。
- en: Choropleth (Filled) Maps
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分区（填充）地图
- en: One of Tableau’s key differentiators is its capability to map data. Mapping
    is one of the most robust data professions out there—in fact, there is even a
    specialized domain called geographic information systems (GIS). While this level
    of specialization has led to some amazing tools, it has also meant that, until
    recently, data mapping and business intelligence data visualization have mostly
    been done separately, and with different tools for creating maps than for dashboards
    and bar charts.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau的一个关键差异化因素是其映射数据的能力。映射是最强大的数据职业之一——事实上，甚至还有一个专门领域称为地理信息系统（GIS）。尽管这种专业化水平带来了一些令人惊叹的工具，但这也意味着，直到最近，数据映射和商业智能数据可视化大多是分开进行的，用于创建地图的工具与用于仪表板和条形图的工具也不同。
- en: Tableau distinguishes itself by allowing users to take common geographic data
    elements housed in datasets, like postal code, city, state/province, region, and
    country, and automatically attribute the correct latitude and longitude coordinates
    to them. It can also assign them the appropriate shape or geographic polygon (spatial
    object). This means that you don’t have to know the coordinates for Seattle, Washington;
    Tableau will provide them by using its built-in geographic database. Similarly,
    you don’t need to create the polygon object or a list of coordinates to construct
    the state of Washington; giving Tableau the state’s name is enough for it to recognize
    and plot the polygon. A *choropleth map* takes a numeric value and plots it as
    a color scale on a map.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau通过允许用户获取数据集中常见的地理数据元素（如邮政编码、城市、州/省、地区和国家）并自动将正确的纬度和经度坐标赋予它们来区别于其他软件。它还可以为它们分配适当的形状或地理多边形（空间对象）。这意味着您无需知道西雅图，华盛顿的坐标；Tableau将通过其内置的地理数据库提供它们。同样，您无需创建多边形对象或坐标列表来构建华盛顿州；只需向Tableau提供州的名称即可让其识别并绘制多边形。*分区地图*将数值值作为地图上的颜色比例尺进行绘制。
- en: 'Displaying Customer Penetration with Choropleth Maps: Office Essentials Case
    Study'
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用分区地图显示客户渗透：Office Essentials案例研究
- en: OE is assessing demographic data to better understand its core customers. The
    executives want to answer the seemingly simple question, “Where are our customers
    from?” How would you build a visualization to demonstrate this?
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: OE正在评估人口统计数据，以更好地了解其核心客户。高管们想要回答一个看似简单的问题，“我们的客户来自哪里？”您会如何建立可视化以展示这一点？
- en: To start, you will build a choropleth map. (In Tableau this is called a *filled
    map*; the terms are synonymous. You’ll shade each state in the United States according
    to the number of purchasing customers who live there ([Figure 7-1](#basic_choropleth_map_showing_number_of_c)).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您将建立一个分区地图。（在Tableau中，这被称为*填充地图*；这些术语是同义的。您将根据居住在各州的购买客户数量对美国各州进行着色（[图7-1](#basic_choropleth_map_showing_number_of_c)）。
- en: '![Basic choropleth map showing number of customers by US state](Images/TAST_0701.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![显示美国各州客户数量的基本分区地图](Images/TAST_0701.png)'
- en: Figure 7-1\. Basic choropleth map showing number of customers by US state
  id: totrans-12
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图7-1。显示美国各州客户数量的基本分区地图
- en: 'Strategy: Create a Simple Choropleth Map'
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建简单的分区地图
- en: 'Let’s get started building our map:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始构建我们的地图：
- en: Double-click the [State] field within your Data pane. Tableau will see that
    this is a geographic value and automatically create a map. This is one of the
    rare occasions when we recommend double-clicking a field and letting Tableau decide
    how it should be presented in the visualization.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击Data pane内的[State]字段。Tableau将看到这是一个地理值，并自动创建地图。这是我们建议双击字段并让Tableau决定如何在可视化中呈现的少数情况之一。
- en: 'Create a calculated field called `**[# of Customers]**`. This will be the Distinct
    Count of Customer Names:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[# of Customers]**`的计算字段。这将是客户名称的唯一计数：
- en: '[PRE0]'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Drag this newly created measure onto Color on the Marks card. Tableau automatically
    changes the mark type.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将此新创建的度量拖放到Marks卡片上的Color字段。Tableau会自动更改标记类型。
- en: Click into Label on the Marks card and turn on labels.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击Marks卡片上的Label并打开标签。
- en: Stop and inspect the chart. What insights can you immediately glean? California,
    Texas, and New York have the highest number of customers compared to the other
    states. Anything else? If we’re being honest, it’s hard to distinguish the states
    in the middle of the pack. Beyond the top few states, everything looks about the
    same.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 停下来检查图表。您能立即获得什么见解？与其他州相比，加利福尼亚州、德克萨斯州和纽约州拥有最多的客户。还有其他什么？老实说，很难区分中间排名的州。除了前几个州外，其他州看起来差不多。
- en: Do you have a nagging feeling that this map isn’t telling a complete or accurate
    data story? If so, we’re right there with you. If all the states had the same
    population, we could just compare the number of customers. But while it is true
    that the three states mentioned have the most customers, they also have the largest
    populations. So, although it is accurate to say that these states have the most
    customers, this statement neglects to provide the context we need to understand
    the level of customer penetration in each state.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 您是否有一种隐隐的感觉，这张地图并未完全或准确地反映数据故事？如果是这样，我们与您想法一致。虽然这三个州确实拥有最多的客户，但它们也有最大的人口。因此，虽然说这些州拥有最多的客户是准确的，但这种说法忽略了我们理解每个州客户渗透水平所需的背景。
- en: To improve this map, we recommend normalizing your data. *Normalizing* means
    adjusting the scale of a number so that it is no longer independent for each reading,
    but instead is consistent among all the readings.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 要改善此地图，我们建议对数据进行归一化处理。*归一化*意味着调整数字的比例，使其不再是每次读数都独立，而是在所有读数中保持一致。
- en: For this map, you need to normalize the number of customers against the population
    of each state. A more appropriate measure to communicate where our office supply
    store may have deeper customer penetration would be to use a *per capita* (per
    person) measurement. This relays our customer numbers as a percentage of each
    state’s population. It could also be phrased as “How many customers do we have
    per 1,000 state citizens?”
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这张地图，您需要将客户数量与每个州的人口进行归一化。用更合适的度量来表达我们的办公用品店可能具有更深的客户渗透度，将会使用*人均*（每人）的测量。这将把我们的客户数表示为每个州人口的百分比。也可以这样说：“我们每千名州公民拥有多少客户？”
- en: 'Strategy: Normalize a Choropleth Map'
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：归一化分区地图
- en: 'We’re now going to introduce a new dataset to normalize the data:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们要引入一个新的数据集来归一化数据：
- en: 'Enhance the data by including the population data of each state:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过包括每个州的人口数据来增强数据：
- en: Go to Data Source and add a new connection.
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到数据源并添加新的连接。
- en: Navigate to the file that contains the census population and estimates by US
    state.
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到包含美国各州人口普查和估计数据的文件。
- en: Using Tableau’s logical data modeling, create a relationship between the census
    data and the customer order data. This relationship will be based on selecting
    State = Geographic Area, as shown in [Figure 7-2](#creating_a_relationship_using_tableauapo).
    We will delve into more detail on data modeling in [Chapter 10](ch10.xhtml#advanced_data_modeling).
    For now, it is enough to know that Tableau is relating the two datasets together
    by the name of the state.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用Tableau的逻辑数据建模，在人口普查数据和客户订单数据之间创建一个关系。这个关系将基于选择 State = 地理区域，如图7-2所示。我们将在第10章详细探讨数据建模。现在，知道Tableau通过州名关联这两个数据集就足够了。
- en: '![Creating a relationship using Tableau’s logical data modeling](Images/TAST_0702.png)'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![使用 Tableau 的逻辑数据建模创建关系](Images/TAST_0702.png)'
- en: Figure 7-2\. Creating a relationship using Tableau’s logical data modeling
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-2\. 使用 Tableau 的逻辑数据建模创建关系
- en: 'Build a calculated field that is `**[% of Customers per State]**`. The numerator
    will be `**[# of Customers]**` and the denominator will be `**[SUM(Census)]**`.
    Set the default format of the field to Percentage, with four decimal places showing:'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个计算字段，即`**[% of Customers per State]**`。分子将是`**[# of Customers]**`，分母将是`**[SUM(Census)]**`。将字段的默认格式设置为百分比，显示四位小数：
- en: '[PRE1]'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: What do you think of the updated map in [Figure 7-3](#choropleth_map_after_normalization)?
    Does it change your understanding of the customer data?
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您认为在 [图 7-3](#choropleth_map_after_normalization) 中更新的地图如何？这是否改变了您对客户数据的理解？
- en: '![Choropleth map after normalization](Images/TAST_0703.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![正常化后的等值区域地图](Images/TAST_0703.png)'
- en: Figure 7-3\. Choropleth map after normalization
  id: totrans-36
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-3\. 正常化后的等值区域地图
- en: We think so. The first map made it look like California, Texas, and New York
    were the high performers. Now that we’ve normalized the data, though, it’s clear
    that our store has a strong presence in Washington and Delaware. Summative measures
    don’t tell the full story.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 我们认为是这样。第一张地图让人觉得加利福尼亚州、德克萨斯州和纽约州是表现出色的地区。现在我们已经对数据进行了标准化，很明显我们的商店在华盛顿州和特拉华州有很强的存在感。总结性措施并不能完全讲述全部故事。
- en: But we still think this map needs more clarity. The next item to tackle is the
    color gradient. As you saw in [Chapter 1](ch01.xhtml#categorical_analysis), color
    encoding isn’t the most precise method of distinguishing data points. Particularly
    with mapping, it is important that you take time to consider how to best display
    the data.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 但我们仍然认为这张地图需要更清晰。下一个要解决的问题是色彩渐变。正如您在 [第 1 章](ch01.xhtml#categorical_analysis)
    中看到的，颜色编码并不是区分数据点最精确的方法。特别是在制图中，重要的是您花时间考虑如何最好地显示数据。
- en: 'Fortunately, research on color perception has led to the development of color
    palettes that take into account accessibility issues like uniformity of perception,
    vibrancy, and colorblindness. We particularly recommend four gradient color palettes:
    Viridis, Magma, Plasma, and Inferno. All four started out in R and are easy to
    use in Tableau.'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，对颜色感知的研究导致了考虑可访问性问题的颜色调色板的开发，如感知的一致性、生动性和色盲。我们特别推荐四种渐变色调色板：Viridis、Magma、Plasma
    和 Inferno。所有这四种色调最初在 R 中开发，并且在 Tableau 中使用起来很容易。
- en: 'Strategy: Add a Custom Color Palette'
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：添加自定义颜色调色板
- en: 'You can code a few types of color palettes into your Tableau preferences. For
    this exercise, we will use an ordered-sequential palette, which means that each
    color is listed in order and will be available when using continuous fields on
    Color:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在 Tableau 的首选项中编码几种类型的颜色调色板。在本练习中，我们将使用有序顺序调色板，这意味着每种颜色都按顺序列出，并且在使用连续字段进行颜色设置时可用。
- en: Choose File → Repository Location to determine the default save location of
    Tableau files.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 文件 → 仓库位置 以确定 Tableau 文件的默认保存位置。
- en: Find the *preferences.tps* file and open it in a text editor.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找 *preferences.tps* 文件并在文本编辑器中打开它。
- en: Go to this [color palettes dashboard](https://oreil.ly/Cfj8k) on Tableau Public
    built by Jacob Olsufka and copy and paste in the color palette hex codes for Viridis.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到 Tableau Public 上由 Jacob Olsufka 构建的 [颜色调色板仪表板](https://oreil.ly/Cfj8k)，复制并粘贴
    Viridis 色调色板的十六进制代码。
- en: Save and close your Preferences file. Restart Tableau Desktop to activate the
    new palettes.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存并关闭您的 Preferences 文件。重新启动 Tableau Desktop 以激活新的调色板。
- en: Click Color on the Marks card.
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击 Marks 卡片上的 Color。
- en: Change the palette to Viridis.
  id: totrans-47
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将调色板更改为 Viridis。
- en: This minor enhancement to the visualization, shown in [Figure 7-4](#normalized_choropleth_map_with_viridis_c),
    improves viewers’ understanding dramatically. All the central states, once slightly
    different shades of blue, are easier to distinguish. You can now clearly see that
    Delaware has the highest customer penetration.
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这对可视化的轻微改进，在 [图 7-4](#normalized_choropleth_map_with_viridis_c) 中显示，显著提高了观众的理解。所有中央州，一度略有不同的蓝色调，现在更容易区分。现在您可以清楚地看到特拉华州在客户渗透率方面表现最好。
- en: '![Normalized choropleth map with Viridis color palette](Images/TAST_0704.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![使用 Viridis 色调色板的标准化区域地图](Images/TAST_0704.png)'
- en: Figure 7-4\. Normalized choropleth map with Viridis color palette
  id: totrans-50
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-4\. 使用 Viridis 色调色板的标准化区域地图
- en: You can further simplify this visualization by using another derivative measure
    on color. Let’s say your audience wants to know which states have the highest
    customer penetration. They want names of states for an answer; the numeric percentage
    is secondary. Using a percentile can make the picture even clearer.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过在颜色上使用另一个派生度量值进一步简化此可视化。假设您的观众想要知道哪些州的客户渗透率最高。他们希望得到州名作为答案；数值百分比则次要。使用百分位数可以使图像更加清晰。
- en: 'Strategy: Make a Decile Choropleth Map'
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建分位数区域图
- en: 'For this strategy, you will create a quantile map. The colors of the states
    in this map will indicate the percentile of value, between 0% and 100%. A *quantile*
    is any evenly distributed number of proportional pieces. The two most common quantiles
    are the *quartile* (numbers are separated into four even distributions: 0 to 25%,
    25 to 50%, 50% to 75%, and 75% to 100%) and *deciles* (data is evenly distributed
    into 10 portions). Here, you’ll make a decile map:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 对于此策略，您将创建一个分位数地图。此地图中各州的颜色将指示数值的百分位，介于0%到100%之间。*分位数*是均匀分布的一定数量的比例片段。最常见的两种分位数是*四分位数*（将数据分为四个均匀分布区间：0到25%、25到50%、50%到75%和75%到100%）和*分位数*（将数据均匀分布为十个部分）。在这里，您将制作一个分位数地图：
- en: Right-click the [% of Customers per State] measure on Color and choose Quick
    Table Calculation → Percentile ([Figure 7-5](#representing_data_in_percentiles)).
    Now data will be represented in percentiles, with a minimum at 0% and a maximum
    at 100%.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击[每州客户百分比]度量值上的颜色，选择快速表计算 → 百分位数（[图 7-5](#representing_data_in_percentiles)）。现在数据将以百分位数表示，最小值为0%，最大值为100%。
- en: '![Representing data in percentiles](Images/TAST_0705.png)'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![以百分位数表示数据](Images/TAST_0705.png)'
- en: Figure 7-5\. Representing data in percentiles
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-5\. 以百分位数表示数据
- en: Click Color → Edit Colors and select Stepped Color. Change the number of steps
    to 10.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击颜色 → 编辑颜色，并选择阶梯颜色。将步数更改为10。
- en: Fix the Start and End of the palette range at 0 and 1, respectively, by clicking
    Advanced, checking each box, and entering the value ([Figure 7-6](#setting_the_palette_range)).
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过点击高级选项，勾选每个框并输入值，将调色板范围的开始和结束固定在0和1之间（[图 7-6](#setting_the_palette_range)）。
- en: '![Setting the palette range](Images/TAST_0706.png)'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![设置调色板范围](Images/TAST_0706.png)'
- en: Figure 7-6\. Setting the palette range
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-6\. 设置调色板范围
- en: Change the label back to [% of Customers per State] by dragging the measure
    from the Data pane onto Label.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过从数据窗格将度量值拖动到标签上，将标签更改回[每州客户百分比]。
- en: 'The benefit of the color palette is clear: you can distinguish between the
    different colors effortlessly and mentally map the states to the different deciles
    ([Figure 7-7](#decile_choropleth_map_with_viridis_color)). This lets you tell
    your audience that the top 10% of states for customer penetration are Washington,
    Pennsylvania, New York, Delaware, and Rhode Island.'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 调色板的好处显而易见：您可以轻松区分不同的颜色，并在心理上将状态映射到不同的分位数（[图 7-7](#decile_choropleth_map_with_viridis_color)）。这让您可以告诉观众，客户渗透率前10%的州分别是华盛顿州、宾夕法尼亚州、纽约州、特拉华州和罗得岛州。
- en: '![Decile choropleth map with Viridis color palette](Images/TAST_0707.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![带Viridis色调的分位数区域图](Images/TAST_0707.png)'
- en: Figure 7-7\. Decile choropleth map with Viridis color palette
  id: totrans-64
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-7\. 带Viridis色调的分位数区域图
- en: We started with a basic metric (# of Customers) and advanced to percentiles.
    The drastic difference in readability underscores how important it is to think
    critically about the way you display data and communicate it to your audience.
    This simple evolution has gone a long way toward creating a compelling and insightful
    visualization.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从基本指标（客户数）开始，进一步到百分位数。可读性上的显著差异凸显了思考数据展示方式及向观众传达信息的重要性。这种简单的进步在创建引人入胜且有洞察力的可视化方面已经走了很长一段路。
- en: Symbol Maps
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 符号地图
- en: The second most common map type you’re likely to create in Tableau is a *symbol
    map*. It takes a discrete or continuous field and encodes it on a shape. The shape
    can have additional encoding on both size and color to distinguish it further.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在Tableau中您可能要创建的第二种最常见的地图类型是*符号地图*。它将一个离散或连续字段编码到形状上。该形状可以在大小和颜色上进行额外的编码，以进一步区分它。
- en: 'Using Symbol Maps to Show Profitability and Channel Distribution: OE Case Study'
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用符号地图展示盈利能力和渠道分布：OE案例研究
- en: 'Now OE wants to know which city is generating the most profit for the company.
    Using the same dataset, how would you construct a map that shows two measures
    at the same time: sales and profit ratio? Remember, this question is multifaceted:
    while profit ratio is the primary metric your audience is trying to understand,
    it needs context, like total sales. Which do you think a sales manager cares about
    more: a million-dollar city with a 10% profit ratio, or a $500 city with a 90%
    profit ratio?'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 现在OE想知道哪个城市为公司带来的利润最多。使用相同的数据集，您将如何构建一个显示两个度量的地图：销售和利润比率？请记住，这个问题是多方面的：虽然利润比率是您的观众试图理解的主要指标，但它需要上下文，比如总销售额。销售经理更关心哪个：一个有百万美元销售额但利润率为10%的城市，还是一个销售额为500美元但利润率为90%的城市？
- en: 'Strategy: Create a Symbol Map'
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建一个符号地图
- en: 'Starting with a new worksheet, you’ll first create a Tableau default Symbol
    Map and then enhance the formatting for your audience:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在新工作表中，您将首先创建一个Tableau默认的符号地图，然后优化格式以便于您的观众：
- en: Double-click [City] within the Data pane to automatically create a symbol map
    showing a circle for each city present in the dataset.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在数据窗格中双击[城市]，自动创建一个符号地图，显示数据集中每个城市的圆圈。
- en: Tip
  id: totrans-73
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 小贴士
- en: Depending on which version of the dataset you’re working with, you may want
    to first create a hierarchy with Country, Region, State, City, and Postal Code.
    When you create a hierarchy with geographic information, Tableau will automatically
    add the higher levels of the hierarchy to the view.
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 根据您正在使用的数据集版本，您可能需要首先创建一个包含国家、地区、州、城市和邮政编码的层次结构。当您创建带有地理信息的层次结构时，Tableau将自动将层次结构的更高级别添加到视图中。
- en: Drag [Sales] onto Size. Adjust the size of the marks to be the largest recommended
    by Tableau, as shown in [Figure 7-8](#adjusting_mark_size_to_show_sales).
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[销售]拖动到大小。调整标记的大小为Tableau建议的最大值，如[图7-8](#adjusting_mark_size_to_show_sales)所示。
- en: '![Adjusting mark size to show sales](Images/TAST_0708.png)'
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![调整标记大小以显示销售情况](Images/TAST_0708.png)'
- en: Figure 7-8\. Adjusting mark size to show sales
  id: totrans-77
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图7-8\. 调整标记大小以显示销售情况
- en: 'Now create a calculated field called `**[Profit Ratio]**`:'
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在创建一个名为`**[利润比率]**`的计算字段：
- en: '[PRE2]'
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Drag [Profit Ratio] to Color. Tableau automatically creates a diverging color
    palette centered at 0, recognizing that this measure has both positive and negative
    values.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[利润比率]拖动到颜色。Tableau自动创建一个以0为中心的发散颜色调色板，识别到这个度量既有正值也有负值。
- en: To visually distinguish overlapping marks, adjust the color opacity down slightly
    and add a border ([Figure 7-9](#adjusting_opacity_and_adding_a_border)).
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了在视觉上区分重叠的标记，略微调整颜色不透明度，并添加边框（参见[图7-9](#adjusting_opacity_and_adding_a_border)）。
- en: '![Adjusting opacity and adding a border](Images/TAST_0709.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![调整不透明度并添加边框](Images/TAST_0709.png)'
- en: Figure 7-9\. Adjusting opacity and adding a border
  id: totrans-83
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图7-9\. 调整不透明度并添加边框
- en: The classic symbol map, as shown in [Figure 7-10](#a_classic_symbol_map), will
    always have a place in data analysis. But what if we could go beyond the default
    thinking and use symbol maps to create something unique and different?
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 如[图7-10](#a_classic_symbol_map)所示，经典的符号地图在数据分析中始终有其位置。但如果我们超越默认思维，利用符号地图创建一些独特和不同的内容呢？
- en: '![A classic symbol map](Images/TAST_0710.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![经典的符号地图](Images/TAST_0710.png)'
- en: Figure 7-10\. A classic symbol map
  id: totrans-86
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图7-10\. 经典的符号地图
- en: Let’s say our office-supply executives ask you to provide an overview of sales
    distribution by product channel for each state. (The product channels are in our
    data segments.) To answer this question, you’ll need to show a measure separated
    out by dimensions. You could do this with a stacked bar chart, but instead let’s
    take a mapping approach.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们的办公用品执行官要求您为每个州的产品渠道的销售分布提供概述。（产品渠道在我们的数据段中。）为了回答这个问题，您需要展示一个度量按维度分离出来的情况。您可以通过堆积条形图来完成这项工作，但我们可以采用映射的方法。
- en: 'Strategy: Create a Map with Donut Charts'
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：创建带甜甜圈图的地图
- en: 'In this strategy, you’ll use a donut chart on top of a map to answer the team’s
    queries:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种策略中，您将在地图上方使用一个甜甜圈图来回答团队的疑问：
- en: Double-click [State] to construct a map.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击[州]构建一个地图。
- en: Change your mark type to Pie and drag [Sales] onto Angle.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标记类型更改为饼图，并将[销售]拖动到角度。
- en: Drag [Segment] onto Color and adjust the size of your marks to the largest recommended
    size.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[分段]拖动到颜色，并调整标记的大小为建议的最大大小。
- en: 'Create a dual axis to change the pie chart to a donut chart:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建双轴以将饼图变成甜甜圈图：
- en: Drag a copy of [Latitude] to the Rows shelf.
  id: totrans-94
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[纬度]拖动到行架上的副本。
- en: Right-click the field and select Dual Axis.
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击该字段，选择双轴。
- en: Click the copy of [Latitude] to access the Marks card; remove [Segment] from
    Color and change your mark color to white. Change the size of the mark to be smaller,
    so the segment-separated pie chart is still visible.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击复制[Latitude]以访问标记卡片；从颜色中删除[Segment]并将标记颜色更改为白色。将标记大小调整为较小，以便仍然可见分段的饼图。
- en: Drag [Sales] onto Label and format it to be single-decimal currency expressed
    in Thousands (K) units.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[销售额]拖放到标签上，并将其格式化为以千元（K）为单位的单个小数货币。
- en: 'Notice that the map in [Figure 7-11](#sales_by_segment_per_statecomma_using_a)
    provides two levels of information for more insight. First, it tackles the main
    analytical question: “What are our sales by segment per state?” Then it provides
    overview information: the total sales for each state. While your audience can
    see the visual proportion of the sales, adding the denominator (total sales per
    state) allows them to do mental math to process whether the visual distribution
    they are seeing is important information to retain.'
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意，[图 7-11](#sales_by_segment_per_statecomma_using_a) 中的地图提供了更深入的洞察力的两个信息层次。首先，它解决了主要的分析问题：“我们各州的销售额是多少？”然后，它提供了概述信息：每个州的总销售额。虽然您的观众可以看到销售额的视觉比例，但添加分母（每个州的总销售额）使他们能够进行心算，以确定他们所看到的视觉分布是否是需要记住的重要信息。
- en: '![Sales by segment per state, using a map with donut charts](Images/TAST_0711.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![使用带有甜甜圈图的地图显示按州的销售额](Images/TAST_0711.png)'
- en: Figure 7-11\. Sales by segment per state, using a map with donut charts
  id: totrans-100
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-11\. 使用带有甜甜圈图的地图显示按州的销售额
- en: Tile Maps (Cartograms)
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 平铺地图（卡托图）
- en: Maps are useful when there is an inherent need to understand geography along
    with data. But it’s also important to recognize that the size of geographic areas
    can bias an audience. Larger geographies will naturally dominate the space of
    any visualization. When color encoding is added, the audience’s eyes are naturally
    drawn to the large, colorful areas, and it’s easy for them to miss some of the
    nuances in the map.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 当需要理解地理位置与数据时，地图非常有用。但同样重要的是要认识到地理区域的大小可能会对观众产生偏见。较大的地理区域自然会主导任何可视化的空间。当添加颜色编码时，观众的眼睛自然会被大而丰富多彩的区域所吸引，这使得他们很容易忽略地图中的一些细微差别。
- en: To compensate, we can use a *cartogram*, or *tile map*. A tile map takes geographic
    areas, strips out their complicated real shapes, and replaces them with more uniform
    shapes. Most often this shape is a square, a hexagon, or another shape that will
    tessellate. In *tessellation*, a pattern uses shapes that fit together without
    any gaps or spaces between them. Cartograms can use other measures to construct
    shapes too; for example, a map of the world with the area of each shape represented
    by the total population.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 为了弥补这一点，我们可以使用*卡托图*或*平铺地图*。平铺地图将地理区域取出其复杂的实际形状，并用更均匀的形状替换。最常见的形状是正方形、六边形或其他可以镶嵌的形状。在*镶嵌*中，一种模式使用形状，这些形状可以在彼此之间没有任何间隙或空白的情况下相互贴合。卡托图还可以使用其他测量标准来构建形状；例如，世界地图上每个形状的面积表示总人口。
- en: 'Showing Education Level with a Tile Map: Aloft Educational Services Case Study'
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用平铺地图显示教育水平：旅舍教育服务案例研究
- en: In this next use case, Aloft Educational Services, an organization whose mission
    is to increase the educational attainment of adults in the US, is looking at education
    demographics in this country. They want to know what percentage of each state’s
    adult population has attained a bachelor’s degree and show the locations of the
    highest and lowest rates. How would you create a visualization to communicate
    this?
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个下一个用例中，旅舍教育服务公司，一个致力于提高美国成年人教育水平的组织，正在查看该国的教育人口统计数据。他们想知道每个州的成年人口中有多少百分比获得了学士学位，并展示最高和最低比率的位置。您将如何创建可视化来传达这一信息？
- en: 'Strategy: Build a Square Tile Map'
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：构建方形平铺地图
- en: 'You’ll connect to the US State Attainment dataset and then follow these steps
    to enrich the data and build a tile map:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 您将连接到美国州属达成数据集，然后按照以下步骤来丰富数据并构建平铺地图：
- en: 'Create a calculated field called `**[% College Attainment]**` from the dataset.
    Set the default number format to a percentage with one decimal point:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从数据集创建一个名为`**[% College Attainment]**`的计算字段。将默认数值格式设置为带有一位小数点的百分比：
- en: '[PRE3]'
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Enrich the dataset by adding a file that maps each state to a column or row
    (shown in [Figure 7-12](#mapping_states_to_columns_and_rows)). More-sophisticated
    shapes might map each state to an *x*,*y* coordinate, but we’ll keep it simple
    here.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过添加将每个州映射到列或行的文件来丰富数据集（如图 7-12](#mapping_states_to_columns_and_rows) 所示）。更复杂的形状可能会将每个州映射到*x*，*y*坐标，但我们在这里保持简单。
- en: '![Mapping states to columns and rows](Images/TAST_0712.png)'
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![将州映射到列和行](Images/TAST_0712.png)'
- en: Figure 7-12\. Mapping states to columns and rows
  id: totrans-112
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-12\. 将状态映射到列和行
- en: Drag [Row] to Rows and [Column] to Columns; change the mark type to Square.
    (Make sure they are both discrete dimensions.) Set the view sizing to Entire View.
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [行] 拖动到行和 [列] 拖动到列；将标记类型更改为方形。（确保它们都是离散维度。）设置视图大小为整个视图。
- en: Tip
  id: totrans-114
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: If [Row] and [Column] are continuous measures (green), you can drag them above
    the horizontal line in the Data pane to change each to a discrete dimension.
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果 [行] 和 [列] 是连续度量（绿色），则可以将它们拖动到数据窗格中的水平线上，以将每个变为离散维度。
- en: Drag [% College Attainment] to Color and to Label. Drag [Abbreviation] to Label.
    You may need to change your mark type back to Square. Change the color palette
    to a custom palette, as you did in the first section of this chapter. ([Figure 7-13](#educational_attainment_rates_shown_in_a)
    uses Color Brewer Greens.) Add a white border as well.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [% 学院成就] 拖动到颜色和标签中。将 [缩写] 拖动到标签中。您可能需要将标记类型更改回方形。与本章第一节相同，更改颜色板为自定义颜色板。([图 7-13](#educational_attainment_rates_shown_in_a)
    使用 Color Brewer Greens。) 还要添加白色边框。
- en: Right-click [Row] and [Column] and uncheck Show Header.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击 [行] 和 [列] 并取消选中“显示标题”。
- en: '![Educational attainment rates shown in a tile map (top), and the same data
    shown in a choropleth map (bottom)](Images/TAST_0713.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![瓷质图显示的教育成就率（上），以及区域色阶图显示的相同数据（下）](Images/TAST_0713.png)'
- en: Figure 7-13\. Educational attainment rates shown in a tile map (top), and the
    same data shown in a choropleth map (bottom)
  id: totrans-119
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-13\. 显示在瓷质图中的教育成就率（上），以及在区域色阶图中显示的相同数据（下）
- en: As you compare the tile map to the original, what changes about where the eye
    is drawn? While Colorado remains noticeable, in the tile map it is much easier
    to see the pockets of lower attainment in the Southeast, and higher attainment
    on the East Coast. Alaska no longer dominates the visualization because of its
    size, and smaller areas like Hawaii, the District of Columbia, and Puerto Rico
    all get equal space.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 当您比较瓷质图和原始图时，关注点的变化是什么？尽管科罗拉多州仍然显著，但在瓷质图中更容易看到东南部较低成就的区域以及东海岸较高成就的区域。由于其大小，阿拉斯加不再主导可视化，而像夏威夷、哥伦比亚特区和波多黎各等较小地区则都得到了同等的空间。
- en: Having seen the tile map you just made, your nonprofit stakeholders might well
    ask how they can tell if a particular state’s rate is above or below the national
    average. How can we make this display more insightful? By using something other
    than the direct measure on color.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 看到您刚刚制作的瓷质图后，您的非营利组织利益相关者可能会问如何判断特定州的比率是高于还是低于国家平均水平。如何使此显示更具洞察力？通过使用除颜色直接测量外的其他方式。
- en: 'Strategy: Compare Parts Against the Whole with a Tile Map'
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用瓷质图比较整体与部分
- en: 'Starting with our chart from the last strategy, we’ll add formatting, text,
    and color enhancements:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 从上一策略的图表开始，我们将添加格式、文本和颜色增强：
- en: Create a new calculated field called `**[Total US College Attainment]**`.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为 `**[总体美国学院成就]**` 的新计算字段。
- en: 'This will be an LOD expression that computes the percentage of college attainment
    for the entire dataset (encompassing all states):'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将是一个LOD表达式，计算整个数据集（包括所有州）的学院成就百分比：
- en: '[PRE4]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Using this new calculated field, create another calculated field called `**[Delta
    from US Overall]**`. This will be the percentage point difference in attainment
    between the state’s rate and that of the US overall:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用这个新的计算字段，创建另一个名为 `**[与美国总体差值]**` 的计算字段。这将是该州率与美国总体率之间的百分点差异：
- en: '[PRE5]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Here, you are re-aggregating the LOD expression to the maximum. LODs are naturally
    row-level. Since the other metric is aggregated, [Total US College Attainment]
    must also be aggregated. It is conventional to use Maximum, Minimum, or Average
    when aggregating LODs for calculated fields; mathematically, they will all return
    the same result.
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这里，您正在重新聚合LOD表达式至最大值。LOD通常是行级的。由于其他度量值是聚合的，因此[总体美国学院成就]也必须是聚合的。在计算字段的LOD聚合中，常规做法是使用最大、最小或平均值；在数学上，它们将返回相同的结果。
- en: Drag the new measure onto Color and Label.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新的度量值拖动到颜色和标签中。
- en: For advanced formatting, change the Default Number format for [Delta from US
    Overall] by using the symbols ▼▲▬, as shown in [Figure 7-14](#changing_the_default_number_format).
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于高级格式设置，请使用符号 ▼▲▬ 更改 [与美国总体差值] 的默认数值格式，如 [图 7-14](#changing_the_default_number_format)
    所示。
- en: '![Changing the default number format](Images/TAST_0714.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![更改默认数值格式](Images/TAST_0714.png)'
- en: Figure 7-14\. Changing the default number format
  id: totrans-133
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-14\. 更改默认数字格式
- en: In the final iteration of the visualization ([Figure 7-15](#tile_map_showing_how_each_stateapostroph)),
    the emphasis is now on comparing against the overall rate, and it tells a compelling
    story. Every southern state is below the average, as is a group of states in the
    Midwest.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在可视化的最终版本（[图 7-15](#tile_map_showing_how_each_stateapostroph)）中，重点是与整体率的比较，并讲述了一个引人入胜的故事。每个南方州和中西部的一组州都低于平均水平。
- en: '![Tile map showing how each state’s college attainment rate compares to the
    national average](Images/TAST_0715.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![显示每个州的大学完成率与全国平均水平相比较的图块地图](Images/TAST_0715.png)'
- en: Figure 7-15\. Tile map showing how each state’s college attainment rate compares
    to the national average
  id: totrans-136
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-15\. 显示每个州大学完成率与全国平均水平相比较的图块地图
- en: Built-in Features and Functions
  id: totrans-137
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 内置功能和功能
- en: You’ve now seen quite a few examples of how to make default and nondefault maps
    in Tableau. We’ve guided you through basic examples and provided valuable options
    for maximizing the data you’re presenting geographically. However, that’s only
    one part of geospatial analysis. In this section, we’ll show you some of Tableau’s
    built-in features and analytical computations.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在已经看到了如何在 Tableau 中制作默认和非默认地图的许多示例。我们为您提供了基本示例，并为最大化地理位置数据的呈现提供了宝贵的选项。然而，这只是地理空间分析的一部分。在本节中，我们将向您展示一些
    Tableau 内置功能和分析计算。
- en: 'Using Built-in Features and Functions with Marketing Data: SAGE Digital Marketing
    Case Study'
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用内置功能和功能处理营销数据：SAGE 数字营销案例研究
- en: In this example, Savvy Actionable Gains Executed (SAGE) is a digital marketing
    agency that provides its clients with leads through paid ads in search results.
    The agency’s client is a local landscaping company. To the client, the less they
    pay for a lead, the more profit they get from each converted customer—so the goal
    is to give them as many consistent leads as possible, at the lowest possible cost.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，Savvy Actionable Gains Executed（SAGE）是一家数字营销机构，通过搜索结果中的付费广告为客户提供线索。该机构的客户是一家当地的园艺公司。对于客户来说，他们支付的线索越少，他们从每位转换的客户那里获得的利润越多，因此目标是尽可能给他们提供尽可能多且成本最低的一致线索。
- en: The client has three physical locations and divides its customers into three
    service areas based on home address. How would you understand how well the ads
    in each service area are performing? The available data shows how much it costs
    to display a paid search advertisement and how many people in any given zip code
    clicked the ad.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 客户在三个物理位置上，根据家庭地址将客户分为三个服务区域。您如何了解每个服务区域中广告的表现如何？可用数据显示了显示付费搜索广告的成本及任何给定邮政编码中点击广告的人数。
- en: Tableau lets you build custom geographic areas, which it calls *custom polygons*.
    For the first strategy, you’ll set up your client’s three service areas by using
    the zip code data they’ve provided. As with most things in Tableau, there are
    multiple ways to do this. We will walk you through two methods.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: Tableau 允许您构建自定义地理区域，称为*自定义多边形*。对于第一种策略，您将使用他们提供的邮政编码数据设置客户的三个服务区域。与 Tableau
    中的大多数事物一样，有多种方法可以做到这一点。我们将向您展示两种方法。
- en: 'Strategy: Build Custom Polygons Using Groups'
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用组构建自定义多边形
- en: While your data provides zip codes, you don’t know exactly which zip code falls
    in the three service areas (shown in [Figure 7-16](#a_map_showing_the_approximate_locations)).
    You may have only a rough approximation of where those areas are.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然您的数据提供了邮政编码，但不知道确切地哪些邮政编码属于三个服务区域（如[图 7-16](#a_map_showing_the_approximate_locations)所示）。您可能只有这些区域大致位置的粗略估计。
- en: '![A map showing the approximate locations of your client’s service areas](Images/TAST_0716.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![显示客户服务区域大致位置的地图](Images/TAST_0716.png)'
- en: Figure 7-16\. A map showing the approximate locations of your client’s service
    areas
  id: totrans-146
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-16\. 显示客户服务区域大致位置的地图
- en: 'You can easily create groups in Tableau to generate your different areas:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Tableau 中，您可以轻松创建组，以生成不同的区域：
- en: Double-click [ZIP] to create a map showing available data by zip code in your
    dataset. Change your mark type to Map.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击[ZIP]以创建显示数据集中邮政编码可用数据的地图。将标记类型更改为地图。
- en: Modify the Map background by going to Map on the toolbar and selecting Map Layers
    at the top. Change the Style to Streets.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在工具栏上选择地图，并在顶部选择地图图层来修改地图背景。将样式更改为街道。
- en: Hover over the upper-left area of the map image to view the toolbar; hover over
    the bottom icon (a right arrow) to see various ways data can be selected. Click
    the lasso option on the far right ([Figure 7-17](#the_map_toolbar_automatically_displays_w)).
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在地图图像的左上角悬停以查看工具栏；在底部图标（右箭头）上悬停以查看可以选择数据的各种方式。点击最右边的套索选项（[图 7-17](#the_map_toolbar_automatically_displays_w)）。
- en: '![The map toolbar automatically displays when you hover in the upper-left corner
    of a worksheet](Images/TAST_0717.png)'
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![当您将鼠标悬停在工作表左上角时，地图工具栏会自动显示](Images/TAST_0717.png)'
- en: Figure 7-17\. The map toolbar automatically displays when you hover in the upper-left
    corner of a worksheet
  id: totrans-152
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-17\. 当你将鼠标悬停在工作表左上角时，地图工具栏会自动显示。
- en: With the lasso option chosen, select zip codes that are part of the North service
    area shown in [Figure 7-16](#a_map_showing_the_approximate_locations). If you
    miss one, you can hold down your Ctrl key afterward to manually select additional
    zip codes. The selection does not have to be precise.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择套索选项，选择属于北服务区的邮政编码，如[图 7-16](#a_map_showing_the_approximate_locations)所示。如果错过了某个邮政编码，之后可以按住
    Ctrl 键手动选择额外的邮政编码。选择不必精确。
- en: After you have selected the appropriate zip codes, click the group icon (paperclip)
    at the top toolbar; then click the word ZIP. Tableau will automatically construct
    a group consisting of the zip codes you selected. The new group is automatically
    placed on Color.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择适当的邮政编码后，单击顶部工具栏上的组图标（图钉），然后单击单词 ZIP。Tableau 将自动构建一个包含您选择的邮政编码的组。新组自动放置在颜色上。
- en: Repeat this process two more times, until you have three areas roughly resembling
    the service areas ([Figure 7-18](#each_zip_code_is_now_colored_by_service)). You
    can rename them by editing the Group you just created.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复此过程两次，直到您大致创建了三个与服务区域相似的区域（[图 7-18](#each_zip_code_is_now_colored_by_service)）。您可以通过编辑刚创建的组来重命名它们。
- en: '![Each zip code is now colored by service area](Images/TAST_0718.png)'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![现在每个邮政编码都按服务区域着色](Images/TAST_0718.png)'
- en: Figure 7-18\. Each zip code is now colored by service area
  id: totrans-157
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-18\. 现在每个邮政编码都按服务区域着色
- en: Remove [ZIP] from the Detail property. This is the most important step. You
    have now created a custom polygon. Using this information, you can see aggregate
    values for metrics by service area.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从详细属性中删除[ZIP]。这是最重要的一步。现在您已创建了自定义多边形。使用这些信息，您可以看到按服务区域聚合的度量值。
- en: 'Create a calculated field called `**[Cost per Click]**`. Add it to the label,
    along with the service area name:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[每次点击费用]**`的计算字段。将其添加到标签中，以及服务区域名称：
- en: '[PRE6]'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[Figure 7-19](#cost_per_click_to_the_client_by_service) shows the result.'
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[图 7-19](#cost_per_click_to_the_client_by_service) 显示了结果。'
- en: '![Cost per click to the client by service area, created using ad hoc groups](Images/TAST_0719.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![通过临时组创建的每个服务区域的客户点击费用](Images/TAST_0719.png)'
- en: Figure 7-19\. Cost per click to the client by service area, created using ad
    hoc groups
  id: totrans-163
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-19\. 通过临时组创建的每个服务区域的客户点击费用
- en: The capability to aggregate geographic data this way is extremely powerful.
    The original data did not provide what you needed to know—cost per click for each
    area—but aggregating it provides clarity on that key metric.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 以这种方式聚合地理数据的能力非常强大。原始数据没有提供所需的内容——每个区域的点击费用，但聚合数据提供了关键指标的清晰度。
- en: In this scenario, we used an ad hoc technique to construct the areas. If you
    have a territory, area, or region encoded or mapped to your data, you can use
    the underlying geography to compute the same result, instead of building ad hoc
    groups.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们使用了一种临时技术来构建这些区域。如果您的数据已编码或映射到领土、区域或区域，则可以使用底层地理数据来计算相同的结果，而无需构建临时组。
- en: 'Strategy: Build Custom Polygons Using Underlying Geographic Data'
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用底层地理数据构建自定义多边形
- en: 'In this strategy, you’ll create a map similar to the previous exercise, but
    this time using data fields that exist within the dataset:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个策略中，您将创建一个类似于之前练习的地图，但这次使用数据集中存在的数据字段：
- en: Right-click the field named [Service Area] and choose Geographic Role → Create
    from → ZIP.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击名为[Service Area]的字段，选择地理角色 → 从 → ZIP 创建。
- en: This feature aligns geographic data to the service areas (territories) in your
    dataset. As long as there is a one-way relationship between a zip code and a territory,
    your data will be combined into the new groupings.
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此功能将地理数据与数据集中的服务区域（领土）对齐。只要邮政编码和领土之间存在单向关系，您的数据就会合并到新的分组中。
- en: Notice that a new hierarchy appears, showing the relationship between service
    area and zip code ([Figure 7-20](#the_service_areasoliduszip_code_hierarch)).
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意到出现了一个新的层次结构，显示了服务区和邮政编码之间的关系（[图 7-20](#the_service_areasoliduszip_code_hierarch)）。
- en: '![The Service Area/ZIP code hierarchy](Images/TAST_0720.png)'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![服务区/邮政编码层次结构](Images/TAST_0720.png)'
- en: Figure 7-20\. The Service Area/ZIP code hierarchy
  id: totrans-172
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-20\. 服务区/邮政编码层次结构
- en: Double-click [Service Area]. Change your mark type to Filled Map.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击 [服务区]。更改标记类型为填充地图。
- en: Add [Cost per Click] to Label along with [Service Area]. Add [Service Area]
    to Color. You may have to change the colors to match the previous strategy.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [每次点击成本] 添加到标签中，连同 [服务区]。将 [服务区] 添加到颜色中。您可能需要更改颜色以匹配先前的策略。
- en: '[Figure 7-21](#cost_per_click_to_the_client_by_-id00020) shows the result.'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[图 7-21](#cost_per_click_to_the_client_by_-id00020) 展示了结果。'
- en: '![Cost per click to the client by service area, created using underlying geographic
    data](Images/TAST_0721.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![按服务区划分的每次点击成本，使用底层地理数据创建](Images/TAST_0721.png)'
- en: Figure 7-21\. Cost per click to the client by service area, created using underlying
    geographic data
  id: totrans-177
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-21\. 客户的每次点击成本按服务区划分，使用底层地理数据创建
- en: 'Strategy: Use the Distance Function to Show Zip Codes’ Distance from a Central
    Location'
  id: totrans-178
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用距离函数显示邮政编码相对于中心位置的距离
- en: Now your clients at the landscaping company want to know how far their business
    locations are from the people who view their ads. They want to test their theory
    that the closer an ad viewer is to a store (which we’ll name *Service Area Center*),
    the more likely they are to purchase services. You can use built-in spatial functions
    to answer this question.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你的园艺公司的客户想知道他们的营业地点与查看他们广告的人之间有多远。他们想要测试他们的理论，即广告观众距离商店越近（我们将其称为*服务区中心*），越有可能购买服务。您可以使用内置的空间函数来回答这个问题。
- en: 'To do this, we’ll explore Tableau’s four built-in functions related to geography:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，我们将探索 Tableau 的四个与地理相关的内置函数：
- en: '`DISTANCE()`'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '`DISTANCE()`'
- en: Uses geospatial fields (marked with a globe icon) as inputs to compute the distance
    between two objects.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 使用地理空间字段（带有地球图标）作为输入来计算两个对象之间的距离。
- en: '`MAKELINE()`'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: '`MAKELINE()`'
- en: Creates a line between two objects.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 创建两个对象之间的线。
- en: '`MAKEPOINT()`'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '`MAKEPOINT()`'
- en: When you provide coordinates (latitude and longitude or *x*,*y* coordinates),
    Tableau identifies the coordinate or GIS system they represent and issues a *spatial
    reference identifier* (*SRID*).
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 当您提供坐标（纬度和经度或 *x*,*y* 坐标）时，Tableau 会识别它们表示的坐标或 GIS 系统，并发布*空间参考标识符* (*SRID*)。
- en: '`BUFFER()`'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '`BUFFER()`'
- en: Takes a geospatial point object and computes a radius around it with a unit
    distance that you can specify.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 获取地理空间点对象并计算您可以指定的单位距离的半径。
- en: 'Follow these steps to find the distance from zip codes to the Service Area
    Center:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤查找从邮政编码到服务区中心的距离：
- en: 'Use the `MAKEPOINT()` function with latitude and longitude to create a point
    called `**[Zip Code Point]**`:'
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 `MAKEPOINT()` 函数与纬度和经度创建一个名为`**[邮政编码点]**`的点：
- en: '[PRE7]'
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Repeat this process, using the [Service Area Latitude] and [Service Area Longitude]
    to construct a field called `**[Service Area Point]**`:'
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复此过程，使用 [服务区纬度] 和 [服务区经度] 构建一个名为`**[服务区点]**`的字段：
- en: '[PRE8]'
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Using the two calculated fields, construct a final calculated field called
    `**[Distance from Service Area Center]**`. Within it, set the unit (the third
    parameter) to `**mi**`:'
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用这两个计算字段构建一个名为`**[距离服务区中心的距离]**`的最终计算字段。在其中，将单位（第三个参数）设置为`**mi**`：
- en: '[PRE9]'
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Right-click [Distance from Service Area Center] and set the default aggregation
    to Average. This lets you display the distance between a zip code and the Service
    Area Center, even if there are multiple rows of data for an individual zip code.
    You can also use this measurement to compute the distance at a higher level of
    aggregation, like [Service Area].
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击 [距离服务区中心的距离] 并将默认聚合设置为平均值。这允许您显示邮政编码与服务区中心之间的距离，即使对于单个邮政编码有多行数据。您还可以使用此测量在更高层次的聚合（如
    [服务区]）上计算距离。
- en: 'Construct a dot plot:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个点图：
- en: Drag [Service Area] onto the Rows shelf.
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [服务区] 拖放到行架上。
- en: Drag [Distance from Service Area Center] onto the Columns shelf. Change the
    mark type to a Circle.
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [距离服务区中心的距离] 拖放到列架上。将标记类型更改为圆形。
- en: Drag [ZIP] onto Detail on the Marks card.
  id: totrans-200
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [邮编] 拖放到标记卡的详细信息上。
- en: Drag [Conversions] onto Size. Adjust the color opacity to 60%.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 [转换] 拖放到大小上。将颜色不透明度调整为 60%。
- en: What conclusions can you draw from the visualization in [Figure 7-22](#the_distance_of_each_zip_code_within_a_s)?
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您能从[图 7-22](#the_distance_of_each_zip_code_within_a_s)的可视化中得出什么结论？
- en: '![The distance of each zip code within a service area from its central point,
    along with the number of conversions](Images/TAST_0722.png)'
  id: totrans-203
  prefs: []
  type: TYPE_IMG
  zh: '![每个服务区内每个邮政编码距离中心点的距离，以及转化数量](Images/TAST_0722.png)'
- en: Figure 7-22\. The distance of each zip code within a service area from its central
    point, along with the number of conversions
  id: totrans-204
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-22. 每个服务区内每个邮政编码距离中心点的距离，以及转化数量
- en: 'First, there are certainly some distinctions among each service area’s results:
    in the North, it seems that more conversions come from zip codes within 30 to
    35 miles. For South, that distance is a little bit tighter, with most coming in
    closer than 25 miles. And with Central, it’s apparent that there aren’t many zip
    codes near the center point.'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，每个服务区的结果之间肯定存在一些区别：在北部，看起来更多的转化来自距离30到35英里的邮政编码。对于南部来说，这个距离略微紧一些，大多数在25英里内。而对于中部来说，显然中心点附近几乎没有多少邮政编码。
- en: 'Thanks to your insights, your landscaping clients now know where most conversions
    in the North service area are coming from. They decide to adjust their strategy
    and target only customers who live within 25 miles of each center point. They
    ask you for an impact analysis: which zip codes will they retain and which will
    they drop? How many will they lose? You can do this by working with the `BUFFER()`
    function. This process creates a second map layer within your visualization, which
    is useful if you want to display different layers of geographic detail on one
    map.'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 多亏了您的洞察力，您的园艺客户现在知道北部服务区的大多数转化来自哪里。他们决定调整策略，并仅针对每个中心点周围25英里内的客户。他们要求您进行影响分析：他们将保留哪些邮政编码，哪些将被删除？他们会损失多少？您可以通过使用`BUFFER()`函数来完成此任务。此过程将在您的可视化中创建第二个地图图层，如果您希望在一个地图上显示不同地理细节的图层，这将非常有用。
- en: 'Strategy: Use the Buffer Function to Map a Trade Area Using Radial Distance'
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用缓冲功能以径向距离映射交易区域
- en: 'Using the same dataset from the previous strategy, you’ll construct a new map
    layer with a circle of a specified radius:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 使用与前一策略相同的数据集，您将构建一个新的地图图层，其半径已指定：
- en: 'Create a calculated field called `**[Service Area Trade Area]**`:'
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Service Area Trade Area]**`的计算字段：
- en: '[PRE10]'
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Double-click this new calculated field to plot the areas on a map. Add [Service
    Area] to Color and Label. Change the opacity of the mark to 20% and add a black
    border.
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击此新计算字段以在地图上绘制区域。将[服务区]添加到颜色和标签。将标记的不透明度更改为20%，并添加黑色边框。
- en: Drag [ZIP] to the map in the upper-left corner; this should generate a drop
    zone for adding another Maps Layer.
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[ZIP]拖放到左上角的地图上；这将生成用于添加另一个地图图层的投放区域。
- en: On the secondary Marks card just created, add [Service Area] to Detail. Reduce
    the opacity of the points to 60% and set both the Border and Halo to None.
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在刚创建的次要标记卡上，添加[服务区]到详细信息。将点的不透明度降低到60%，并将边框和光晕都设置为无。
- en: Now your clients can clearly see which zip codes they will be targeting in their
    revised paid search efforts, and which ones will be left out ([Figure 7-23](#map_showing_trade_areas_constructed_in_a)).
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 现在您的客户可以清楚地看到他们在修订的付费搜索工作中将要针对的哪些邮政编码，以及哪些邮政编码将被排除在外（[图 7-23](#map_showing_trade_areas_constructed_in_a)）。
- en: '![Map showing trade areas constructed in a 25-mile radius around the center
    of each service area, plotted with the zip codes currently being targeted with
    marketing efforts](Images/TAST_0723.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![显示围绕每个服务区中心构建的25英里半径内的交易区域地图，标有当前正在进行营销努力的邮政编码](Images/TAST_0723.png)'
- en: Figure 7-23\. Map showing trade areas constructed in a 25-mile radius around
    the center of each service area, plotted with the zip codes currently being targeted
    with marketing efforts
  id: totrans-216
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 7-23. 显示围绕每个服务区中心构建的25英里半径内的交易区域地图，标有当前正在进行营销努力的邮政编码
- en: 'In our final visualization, you’ll create a map that explains the whole story
    to your client: which zip codes are part of each service area, how far each one
    is from the center, which ones fall into the trade areas targeted by the revised
    ad strategy, and how many conversions are associated with each zip code. You will
    do this by constructing lines from the Service Area Center to each zip code.'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的最终可视化中，您将创建一张地图，向客户解释整个故事：哪些邮政编码属于每个服务区，每个邮政编码距离中心有多远，哪些落入了修订广告策略所针对的贸易区域，并且每个邮政编码关联的转化数量。您可以通过从服务区中心到每个邮政编码构建线条来完成这个任务。
- en: 'Strategy: Create Paths Between a Starting Point and Destinations with MakePoint
    and MakeLine'
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 策略：使用MakePoint和MakeLine创建起点到目的地之间的路径
- en: 'In this last strategy of the chapter, you’ll pull everything together and use
    the remaining two spatial functions introduced earlier:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的最后一种策略中，您将把所有内容整合起来，并使用先前介绍的剩余两个空间函数：
- en: 'Create a calculated field called `**[Line from Zip to SA Center]**`:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[Line from Zip to SA Center]**`的计算字段：
- en: '[PRE11]'
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Drag and drop this field on top of the [Zip Code Point] field already on your
    Zip Code layer Marks card. *The dots should change to lines*.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将此字段拖放到已经在您的Zip Code层标记卡上的[Zip Code Point]字段上方。*点应该会变成线*。
- en: Tip
  id: totrans-223
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: When you drag and drop a field on top of another field within a visualization,
    the original field is immediately replaced with the field you drop.
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当您在可视化中将一个字段拖放到另一个字段上方时，原始字段会立即被您拖放的字段替换。
- en: 'Create a calculated field called `**[In Service Area]**` that identifies whether
    the distance between the zip code and the Service Area Center is less than or
    equal to 25 miles:'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个名为`**[In Service Area]**`的计算字段，用于标识邮政编码与服务区中心之间的距离是否小于或等于25英里：
- en: '[PRE12]'
  id: totrans-226
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Drag this new field onto the [Zip Code] Marks card.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将这个新字段拖放到[Zip Code]标记卡上。
- en: a. Click the icon to the left of the field, changing it from Detail to Color.
    You should now have two different colors for each zip code within a Service Area,
    one darker and one lighter. If necessary, adjust the colors using the Tableau
    20 palette.
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: a. 点击字段左侧的图标，将其从详细信息更改为颜色。现在，在服务区内的每个邮政编码应该有两种不同的颜色，一种深一种浅。如有必要，使用Tableau 20调色板调整颜色。
- en: Tip
  id: totrans-229
  prefs:
  - PREF_IND
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: The color legend can represent multiple dimensions, but only if you manually
    assign each one to the Color property on the Marks card. If you drag and drop
    a field onto Color, it will automatically replace the one that was previously
    there and instead set it as Detail.
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 色彩图例可以代表多个维度，但只有在将每个维度手动分配到Marks卡的颜色属性上时才行。如果您将字段拖放到颜色上，它将自动替换先前的字段，并将其设置为详细信息。
- en: Finally, on the [Line from Zip to SA Center] Marks card, drag [Conversions]
    onto Size. This will size each line by the number of conversions associated with
    the zip code.
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，在[Line from Zip to SA Center]标记卡上，将[Conversions]拖放到Size上。这将根据与邮政编码相关联的转化数量调整每条线的大小。
- en: This visualization in [Figure 7-24](#the_new_trade_areas_along_with_the_zip_c)
    helps your client see the whole picture.
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这个在[Figure 7-24](#the_new_trade_areas_along_with_the_zip_c)中的可视化帮助您的客户看到整体画面。
- en: '![The new trade areas along with the zip codes and conversions inside and outside
    each trade area](Images/TAST_0724.png)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
  zh: '![新的贸易区域以及每个贸易区域内外的邮政编码和转化](Images/TAST_0724.png)'
- en: Figure 7-24\. The new trade areas along with the zip codes and conversions inside
    and outside each trade area
  id: totrans-234
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图7-24。新的贸易区域以及每个贸易区域内外的邮政编码和转化
- en: It also suggests that, while the revised targeting strategy works well for the
    North and South territories, it isn’t as successful in the Central service area.
    You might suggest that your clients move Central’s center or separate the service
    area into two smaller sections.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 它还表明，虽然修订后的定位策略对北部和南部领土效果很好，但在中央服务区却并不成功。您可能建议您的客户移动中央区的中心或将服务区分成两个较小的部分。
- en: Conclusion
  id: totrans-236
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: You’ve now seen several ways to work with maps and geographic data in Tableau,
    starting with a basic choropleth map that showed the penetration of OE by each
    state. You also learned how to normalize your data to provide a more accurate
    numerical result to your audience.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 您已经看到了在Tableau中处理地图和地理数据的几种方式，从显示每个州OE的渗透率的基本等值地图开始。您还学会了如何对数据进行归一化，以向观众提供更准确的数值结果。
- en: Additionally, you’ve seen the importance of color encoding when working with
    maps. A color palette like Viridis has intentionally significant differences in
    intensity and hue, which helps your audience distinguish between numerical values
    represented as color.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在处理地图时，您已经看到了颜色编码的重要性。像Viridis这样的调色板故意在强度和色调上有显著差异，这有助于观众区分表示为颜色的数值。
- en: You also created a cartogram by way of a tile map, in which the geographic area
    of each state was stripped from the map and replaced by a uniform square. This
    allowed for easier comprehension of the data values and added equity for smaller
    states.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 您还通过瓷砖地图创建了一个等面积地图，其中每个州的地理区域被从地图中剥离，并替换为统一的正方形。这使得数据值更易于理解，并增加了对较小州的平等性。
- en: You’ve also worked with spatial functions to perform additional analysis on
    your geographic data—which doesn’t always have to be a map. First you used built-in
    features to construct completely new spatial polygons, and then you constructed
    polygons based on other geographic data points available in your data. You also
    explored the built-in geographic functions, learning how to make new points, construct
    service areas, and measure the distance between two points.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 你还使用空间函数对地理数据进行了额外分析，这不一定总是地图。首先，你使用内置功能构建了全新的空间多边形，然后基于数据中其他地理数据点构建了多边形。你还探索了内置的地理函数，学会了如何创建新的点、构建服务区域，并测量两点之间的距离。
- en: In the next chapter, you’ll focus on advanced mathematical concepts. You’ll
    learn the ins and outs of working with advanced mathematical functions and concepts,
    as well as best practices indicating when and where to do more-advanced mathematical
    transformations on your data.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，你将专注于高级数学概念。你将学习如何处理高级数学函数和概念的方方面面，以及最佳实践，指示何时以及在何处对数据进行更高级的数学转换。
