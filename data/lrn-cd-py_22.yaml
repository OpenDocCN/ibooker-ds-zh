- en: Lesson 18\. Repeating tasks while conditions hold
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第18课。在条件保持时重复任务
- en: After reading [lesson 18](#ch18), you’ll be able to
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读第18课[第18课](#ch18)后，你将能够
- en: Understand the syntax of another way to write a loop in a program
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解另一种在程序中编写循环的语法
- en: Repeat actions while a certain condition is true
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在某个条件为真时重复动作
- en: Exit out of loops early
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提前退出循环
- en: Skip statements in a loop
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在循环中跳过语句
- en: 'In the previous lessons, you assumed that you knew the number of times you
    wanted to repeat a block of code. But suppose, for example, that you’re playing
    a game with your friend. Your friend is trying to guess a number that you have
    in mind. Do you know in advance how many times your friend will guess? Not really.
    You want to keep asking them to try again until they get it right. In this game,
    you don’t know how many times you want to repeat the task. Because you don’t know,
    you can’t use a `for` loop. Python has another type of loop that’s useful in these
    kinds of situations: a `while` loop.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的课程中，你假设你知道想要重复代码块次数。但假设，例如，你正在和你朋友玩游戏。你的朋友试图猜你心里想的数字。你事先知道你的朋友会猜多少次吗？实际上不知道。你想要不断要求他们再试一次，直到他们猜对。在这个游戏中，你不知道你想要重复任务的次数。因为你不知道，你不能使用`for`循环。Python有另一种在这种情况下有用的循环类型：`while`循环。
- en: '|  |'
  id: totrans-7
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: '**Consider this**'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '**考虑这个**'
- en: Using only the information given in the following scenarios, do you know the
    maximum number of times you want to repeat the task?
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 仅使用以下场景中提供的信息，你知道你想要重复任务的最大次数吗？
- en: You have five TV channels and you cycle though using the Up button until you’ve
    checked out what’s on every channel.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你有五个电视频道，你使用向上按钮循环查看每个频道有什么节目。
- en: Eat a cookie until there are no more cookies in the box.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 吃掉盒子里的所有饼干。
- en: Say “punch buggy” every time you see a VW Beetle.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每次看到大众甲壳虫时都说“打甲壳虫”。
- en: Click Next on your jogging song playlist until you’ve sampled 20 songs.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在你的慢跑歌曲播放列表上点击“下一曲”，直到你已经试听了20首歌曲。
- en: 'Answer:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 答案：
- en: 'Yes'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是的
- en: 'Yes'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是的
- en: 'No'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不是
- en: 'Yes'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是的
- en: '|  |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: 18.1\. Looping while a condition is true
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.1. 当条件为真时循环
- en: If you have a task that must be repeated an uncertain number of times, a `for`
    loop won’t be appropriate because it won’t work.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你有一个必须重复不确定次数的任务，`for`循环就不合适，因为它不会工作。
- en: 18.1.1\. Looping to make a guess
  id: totrans-22
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 18.1.1. 循环进行猜测
- en: Start with a guessing game. You think of a secret word and ask a player to guess
    your word. Every time the player makes a guess, tell them whether they’re right.
    If they’re wrong, ask again. Keep track of the number of guesses a player makes
    until they get it right. [Figure 18.1](#ch18fig01) shows a flowchart of this game.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 从猜词游戏开始。你想一个秘密单词，并要求玩家猜你的单词。每次玩家猜测时，告诉他们他们是否猜对了。如果他们猜错了，再问一次。记录玩家猜对的次数。[图18.1](#ch18fig01)显示了这个游戏的流程图。
- en: Figure 18.1\. Flowchart of the guessing game. A user guesses a word. The guessing
    loop is represented by the gray diamond, which checks whether the user guess is
    equal to the secret word. If it is, the game finishes. If it isn’t equal, you
    tell the player that they’re wrong, ask them to guess again, and add 1 to the
    number of times that they made a guess.
  id: totrans-24
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图18.1. 猜词游戏的流程图。用户猜测一个单词。猜测循环由灰色菱形表示，它检查用户的猜测是否等于秘密单词。如果是，游戏结束。如果不是，你告诉玩家他们猜错了，要求他们再次猜测，并将他们猜测的次数加1。
- en: '![](images/18fig01.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![图片](images/18fig01.jpg)'
- en: '[Listing 18.1](#ch18ex01) shows an implementation of the game in code. The
    user is trying to guess a secret word chosen by the programmer. The user is first
    prompted to enter a word. The first time you reach the `while` loop, you compare
    the user guess with the secret word. If the guess isn’t correct, you enter the
    `while` loop code block, consisting of three lines. You first print the number
    of times the user guessed so far. Then you ask the user for another guess; notice
    that the user’s guess is assigned to the variable `guess`, which is used in the
    `while` loop’s condition to check the guess against the secret word. Lastly, you
    increment the number of tries to keep an accurate count of the number of times
    the user tried to guess the word.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '[列表 18.1](#ch18ex01) 展示了游戏的代码实现。用户试图猜测程序员选择的秘密单词。首先提示用户输入一个单词。第一次进入 `while`
    循环时，您将用户猜测与秘密单词进行比较。如果猜测不正确，您将进入由三个语句组成的 `while` 循环代码块。首先打印用户迄今为止猜测的次数。然后要求用户再次猜测；请注意，用户的猜测被分配给变量
    `guess`，该变量用于 `while` 循环的条件中，以检查猜测是否与秘密单词匹配。最后，您增加尝试次数以准确统计用户尝试猜测单词的次数。'
- en: After these three lines are executed, you check the condition of the `while`
    loop again, this time with the updated guess. If the user continues to guess the
    secret word incorrectly, the program doesn’t go past the `while` loop and its
    code block. When the user gets the secret word correct, the `while` loop condition
    becomes false, and the `while` loop code block isn’t executed. Instead, you skip
    the `while` code block, move to the statement immediately following the `while`
    loop and its code block, and print a congratulatory message. In this game, you
    must use a `while` loop because you don’t know the number of wrong guesses the
    user will give.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 执行这三行代码后，您再次检查 `while` 循环的条件，这次是使用更新的猜测。如果用户继续错误地猜测秘密单词，程序不会越过 `while` 循环及其代码块。当用户猜对秘密单词时，`while`
    循环的条件变为假，`while` 循环的代码块不会执行。相反，您跳过 `while` 代码块，移动到 `while` 循环及其代码块之后的语句，并打印一条祝贺信息。在这个游戏中，您必须使用
    `while` 循环，因为您不知道用户会给出多少次错误的猜测。
- en: Listing 18.1\. A `while` loop example of a guessing game
  id: totrans-28
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 18.1\. 一个猜谜游戏的 `while` 循环示例
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '***1* Checks whether the guess is different than the secret word**'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 检查猜测是否与秘密单词不同**'
- en: '***2* Asks user again**'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 再次询问用户**'
- en: '***3* Reached when guess is correct**'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 当猜测正确时到达**'
- en: At this point, you should notice that the code block has to include a statement
    to change something about the condition itself. If the code block is independent
    of the condition, you enter an infinite loop. In [listing 18.1](#ch18ex01), the
    guess was updated by asking the user to enter another word.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，您应该注意到代码块必须包含一个语句来更改条件本身。如果代码块独立于条件，您将进入无限循环。在 [列表 18.1](#ch18ex01) 中，猜测是通过要求用户输入另一个单词来更新的。
- en: 18.1.2\. while loops
  id: totrans-34
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 18.1.2\. `while` 循环
- en: In Python, the keyword that begins a `while` loop is, not surprisingly, `while`.
    The following listing shows a general way of writing a `while` loop.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Python 中，开始 `while` 循环的关键字不出所料是 `while`。以下列表显示了编写 `while` 循环的一般方法。
- en: Listing 18.2\. A general way to write a `while` loop
  id: totrans-36
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 18.2\. 编写 `while` 循环的一般方法
- en: '[PRE1]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '***1* Indicates beginning of loop**'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 表示循环的开始**'
- en: When Python first encounters the `while` loop, it checks whether the condition
    is true. If it is, it enters the `while` loop code block and executes the statements
    as part of that block. After it finishes with the code block, it checks the condition
    again. It executes the code block inside the `while` loop as long as the condition
    is true.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 当 Python 首次遇到 `while` 循环时，它会检查条件是否为真。如果是，它将进入 `while` 循环代码块，并执行该块中的语句。完成代码块后，它再次检查条件。只要条件为真，它就会执行
    `while` 循环内部的代码块。
- en: '|  |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Quick check 18.1**'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '**快速检查 18.1**'
- en: '**[Q1:](kindle_split_056.html#app01qa72q0a1)**'
  id: totrans-42
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[Q1:](kindle_split_056.html#app01qa72q0a1)**'
- en: ''
  id: totrans-43
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Write a piece of code that asks the user for a number between 1 and 14\. If
    the user guesses right, print `You guessed right, my number was` and then print
    the number. Otherwise, keep asking for another guess.
  id: totrans-44
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 编写一段代码，提示用户输入介于 1 和 14 之间的数字。如果用户猜对了，打印 `You guessed right, my number was` 并然后打印该数字。否则，继续要求用户再次猜测。
- en: '|  |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 18.1.3\. Infinite loop
  id: totrans-46
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 18.1.3\. 无限循环
- en: With `while` loops, it’s possible to write code that will never finish. For
    example, this piece of code infinitely prints `when will it end?!`
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `while` 循环，可以编写永远不会结束的代码。例如，这段代码无限地打印 `when will it end?!`
- en: '[PRE2]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Letting a program like this run for a long time will slow your computer. But
    if this happens, don’t panic! There are a few ways to manually stop a program
    that entered an infinite loop, as shown in [figure 18.2](#ch18fig02). You can
    do one of the following:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 让这样的程序长时间运行会减慢你的电脑。但如果是这种情况，不要慌张！有几种方法可以手动停止进入无限循环的程序，如图18.2所示。你可以做以下之一：
- en: Click the red square at the top of the console.
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 点击控制台顶部的红色方块。
- en: Click into the console and then hit Ctrl-C (press and hold the Ctrl key and
    then press the C key).
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 点击控制台，然后按Ctrl-C（按住Ctrl键然后按C键）。
- en: Click the menu in the console (beside the red square) and choose Restart Kernel.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 点击控制台中的菜单（在红色方块旁边）并选择“重启内核”。
- en: Figure 18.2\. To manually exit out of an infinite loop, you can click the red
    square, or press Ctrl-C, or choose Restart Kernel from the console menu beside
    the red square.
  id: totrans-53
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图18.2\. 要手动退出无限循环，你可以点击红色方块，或者按Ctrl-C，或者选择红色方块旁边的控制台菜单中的“重启内核”。
- en: '![](images/18fig02_alt.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](images/18fig02_alt.jpg)'
- en: 18.2\. Using for loops vs. while loops
  id: totrans-55
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.2\. 使用for循环与while循环的比较
- en: Any `for` loop can be converted into a `while` loop. A `for` loop iterates a
    set number of times. To convert this to a `while` loop, you need to add a variable
    whose value is checked in the `while` condition. The variable is changed every
    time through the `while` loop. The following listing shows a `for` loop and `while`
    loop side by side. The while loop case is more verbose. You must initialize a
    loop variable yourself; otherwise, Python doesn’t know to what variable `x` you’re
    referring inside the loop. You must also increment the loop variable. In the `for`
    loop case, Python does these two steps automatically for you.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 任何`for`循环都可以转换为`while`循环。`for`循环迭代一组固定次数。要将此转换为`while`循环，你需要添加一个变量，其值在`while`条件中检查。该变量在每次通过`while`循环时都会改变。以下列表显示了并排的`for`循环和`while`循环。`while`循环的情况更详细。你必须自己初始化循环变量；否则，Python不知道在循环内部你指的是哪个变量`x`。你还必须增加循环变量。在`for`循环的情况下，Python会自动为你完成这两个步骤。
- en: Listing 18.3\. A `for` loop rewritten as a `while` loop
  id: totrans-57
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表18.3\. 将`for`循环重写为`while`循环
- en: '**With a for loop**'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用for循环**'
- en: '[PRE3]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '**With a while loop**'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用while循环**'
- en: '[PRE4]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '***1* Indicates beginning of loop**'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 表示循环的开始**'
- en: '***2* Initializes loop variable**'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 初始化循环变量**'
- en: '***3* Increments loop variable**'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 增加循环变量**'
- en: In [listing 18.3](#ch18ex03), you have to create another variable. You must
    manually increment its value inside the `while` loop; remember that the `for`
    loop increments the value of the loop variable automatically. [Figure 18.3](#ch18fig03)
    shows how to visualize the code in [listing 18.3](#ch18ex03).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在[列表18.3](#ch18ex03)中，你必须创建另一个变量。你必须在`while`循环内部手动增加它的值；记住，`for`循环会自动增加循环变量的值。[图18.3](#ch18fig03)显示了如何可视化[列表18.3](#ch18ex03)中的代码。
- en: Figure 18.3\. (A) shows the `for` loop code that prints the value of the loop
    variable with each iteration of the loop. (B) shows the `while` loop code and
    how the variables in change values when the `for` loop is converted into a `while`
    loop. You have to create your own variable and increment it yourself inside the
    body of the `while` loop. Additionally, you have to write a conditional as a function
    of your variable that will cause the body of the `while` loop to repeat three
    times.
  id: totrans-66
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图18.3\. (A)显示了打印循环变量值的`for`循环代码，每次循环迭代都会打印。 (B)显示了转换为`while`循环的`while`循环代码以及变量在`for`循环转换为`while`循环时的变化值。你必须自己创建变量并在`while`循环体内部自己增加它。此外，你必须编写一个作为变量函数的条件，这将导致`while`循环体重复三次。
- en: '![](images/18fig03_alt.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](images/18fig03_alt.jpg)'
- en: Any `for` loop can be converted into a `while` loop. But not all `while` loops
    can be converted into `for` loops, because some `while` loops don’t have a set
    number of times to iterate. For example, when you ask the user to guess a number,
    you don’t know how many tries the user will take to guess the number, so you don’t
    know what sequence of items to use with a `for` loop.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 任何`for`循环都可以转换为`while`循环。但并非所有`while`循环都可以转换为`for`循环，因为有些`while`循环没有固定的迭代次数。例如，当你要求用户猜测一个数字时，你不知道用户需要尝试多少次才能猜到数字，因此你不知道使用`for`循环应该使用什么序列的项。
- en: '|  |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Quick check 18.2**'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '**快速检查18.2**'
- en: '**[Q1:](kindle_split_056.html#app01qa73q0a1)**'
  id: totrans-71
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[Q1:](kindle_split_056.html#app01qa73q0a1)**'
- en: ''
  id: totrans-72
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Rewrite the following code with a `for` loop:'
  id: totrans-73
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用`for`循环重写以下代码：
- en: ''
  id: totrans-74
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-75
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '|  |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '|  |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Thinking like a programmer**'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '**像程序员一样思考**'
- en: In programming, there’s usually more than one way to do something. Some ways
    are terse, and some are verbose. A good Python programmer should find a way to
    write code that’s as simple and short as possible, while being easy to understand.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 在编程中，通常有多种方法来完成某件事。有些方法简洁，而有些则冗长。一个优秀的 Python 程序员应该找到一种方法来编写尽可能简单、简洁的代码，同时易于理解。
- en: '|  |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 18.3\. Manipulating loops
  id: totrans-81
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.3\. 操作循环
- en: You’ve seen the basic structure of `for` and `while` loops. Their behavior is
    straightforward, but they’re a bit limiting. When you use a `for` loop, you go
    through the loop as many times as you still have items in your sequence of values
    (either integers or string characters). With a `while` loop, the only way to stop
    repeating it is for the `while` loop condition to become false.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经看到了 `for` 和 `while` 循环的基本结构。它们的行为简单明了，但它们有点限制性。当你使用 `for` 循环时，你会根据你的值序列（整数或字符串字符）中的项目数量来遍历循环。使用
    `while` 循环时，唯一停止重复的方法是让 `while` 循环条件变为假。
- en: But to write more-flexible code, you may want the option to exit out of a `for`
    loop early. Or you may want to exit out of a `while` loop early if an event happens
    inside the code block that’s independent of the `while` loop condition.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 但为了编写更灵活的代码，你可能希望有提前退出 `for` 循环的选项。或者，如果你在代码块中遇到一个与 `while` 循环条件无关的事件，你可能希望提前退出
    `while` 循环。
- en: 18.3.1\. Exiting early out of a loop
  id: totrans-84
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 18.3.1\. 提前退出循环
- en: The only way that you know how to exit out of a `while` loop is for the `while`
    condition to become false. But you’ll often want to exit out of a loop early (either
    a `for` or `while` loop). A keyword in Python, `break`, makes it possible to exit
    out of a loop whenever Python executes that keyword, even if the `while` loop
    condition is still true. [Listing 18.4](#ch18ex04) shows example code using the
    `break` keyword.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 你知道退出 `while` 循环的唯一方法就是让 `while` 条件变为假。但通常你希望提前退出循环（无论是 `for` 循环还是 `while` 循环）。Python
    中的一个关键字 `break` 使得在 Python 执行该关键字时可以随时退出循环，即使 `while` 循环条件仍然为真。[列表 18.4](#ch18ex04)
    展示了使用 `break` 关键字的示例代码。
- en: In [listing 18.4](#ch18ex04), you see the addition of an extra condition within
    the loop to check whether the user tried to guess at least 100 times. When that
    condition is true, you print a message and break out of the loop. When you encounter
    the `break` statement, the loop immediately terminates; nothing after the `break`
    statement, but within the loop, is executed. Because there’s now a possibility
    of exiting the loop for causes other than the user getting the word right, you
    have to add a conditional after the loop to check why the loop terminated.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [列表 18.4](#ch18ex04) 中，你看到了在循环中添加了一个额外的条件来检查用户是否尝试猜测至少 100 次。当这个条件为真时，你会打印一条消息并退出循环。当你遇到
    `break` 语句时，循环会立即终止；`break` 语句之后，但仍在循环内的任何内容都不会执行。因为现在有退出循环的原因不仅仅是用户猜对了词，你必须在循环之后添加一个条件来检查循环终止的原因。
- en: Listing 18.4\. Using the `break` keyword
  id: totrans-87
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 18.4\. 使用 `break` 关键字
- en: '[PRE6]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '***1* Breaks out of loop when exceed max_tries**'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 当超过最大尝试次数时退出循环**'
- en: '***2* Checks why exited out of loop**'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 检查退出循环的原因**'
- en: 'Why does this code have an extra `if` statement after the `while` loop? Think
    about what happens in two cases: the user guesses the secret word, or the user
    runs out of tries. In either case, you stop executing the `while` loop and execute
    any statements right after the `while` loop block. You want to print a congratulatory
    message only if the exit from the loop was due to the correct guess. The congratulatory
    message has to come after the `while` loop terminates, but you can’t just print
    the message outright. The `while` loop may have terminated because the user ran
    out of tries; you just don’t know why you exited the `while` loop.'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么这段代码在 `while` 循环之后有一个额外的 `if` 语句？考虑两种情况：用户猜对了秘密词，或者用户用完了尝试次数。在任何一种情况下，你都会停止执行
    `while` 循环，并执行 `while` 循环块之后的任何语句。你只想在退出循环是因为正确猜测的情况下打印祝贺信息。祝贺信息必须在 `while` 循环终止后打印，但你不能直接打印信息。`while`
    循环可能因为用户用完了尝试次数而终止；你只是不知道为什么退出 `while` 循环。
- en: You need to add a conditional that checks whether the user still has tries left
    and whether the user’s guess matched the secret. The conditional ensures that
    if the user still has tries left, you exited the `while` loop because the user
    guessed the secret word and not because the user ran out of tries.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要添加一个条件来检查用户是否还有剩余的尝试次数，以及用户的猜测是否与秘密匹配。这个条件确保如果用户还有剩余的尝试次数，你退出 `while` 循环是因为用户猜对了秘密词，而不是因为用户用完了尝试次数。
- en: '|  |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Thinking like a programmer**'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '**像程序员一样思考**'
- en: It’s always a good idea to create variables to store values that you’re going
    to reuse many times in your code. In [listing 18.4](#ch18ex04), you created a
    variable named `max_tries` to hold the number of times to ask the user to guess.
    If you ever decide to change the value, you have to change it in only one place
    (where it’s initialized) instead of trying to remember everywhere you used it.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 总是创建变量来存储你将在代码中多次重用的值是一个好主意。在[列表 18.4](#ch18ex04)中，你创建了一个名为`max_tries`的变量来保存用户猜测次数的数量。如果你决定更改该值，你只需在初始化的地方更改一次（而不是试图记住你使用它的所有地方）。
- en: '|  |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: The `break` statement works with `for` and `while` loops. It can be useful in
    many situations, but you have to use it with caution. If you have loops within
    loops, only the loop that the `break` statement is a part of terminates.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '`break`语句与`for`和`while`循环一起工作。它在许多情况下可能很有用，但你必须谨慎使用。如果你有嵌套循环，只有`break`语句所在的循环会终止。'
- en: '|  |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Quick check 18.3**'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '**快速检查 18.3**'
- en: Write a program that uses a `while` loop to ask the user to guess a secret word
    of your choosing. The user gets 21 tries. When the user gets it right, end the
    program. If the user uses up all 21 tries, exit the loop and print an appropriate
    message.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 编写一个程序，使用`while`循环让用户猜测你选择的秘密单词。用户有21次机会。当用户猜对时，结束程序。如果用户用完了所有21次机会，退出循环并打印一条适当的消息。
- en: '|  |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 18.3.2\. Going to the beginning of a loop
  id: totrans-102
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 18.3.2\. 跳到循环的开始
- en: The `break` statement in the previous section caused any remaining statements
    in a loop to be skipped, and the next statement executed was the one right after
    the loop.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 上一个部分中的`break`语句会导致循环中剩余的所有语句被跳过，并且执行的下一条语句是循环之后的语句。
- en: Another situation you might find yourself in is that you want to skip any remaining
    statements inside a loop and go to the beginning of the loop to check the conditional
    again. To do this, you use the `continue` keyword, which is often used to make
    code look cleaner. Consider [listing 18.5](#ch18ex05). Both versions of the code
    do the same thing. In the first version, you use nested conditionals to make sure
    all conditions are satisfied. In the second version, the `continue` keyword skips
    all subsequent statements inside the loop and fast-forwards to the beginning of
    the loop with the next `x` in the sequence.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能还会遇到的情况是你想要跳过循环内的任何剩余语句，并回到循环的开始再次检查条件。为此，你使用`continue`关键字，这通常用于使代码看起来更整洁。考虑[列表
    18.5](#ch18ex05)。这两个版本的代码做的是同一件事。在第一个版本中，你使用嵌套条件来确保所有条件都得到满足。在第二个版本中，`continue`关键字跳过循环内的所有后续语句，并快速跳转到循环的开始，使用序列中的下一个`x`。
- en: Listing 18.5\. Comparing code that does and doesn’t use the `continue` keyword
  id: totrans-105
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 18.5\. 比较使用和不使用`continue`关键字的代码
- en: '[PRE7]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '***1* Skips remaining loop statements**'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 跳过剩余的循环语句**'
- en: '***2* Get here when x > 5**'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 当 x > 5 时到达这里**'
- en: '***3* Get here when x%10 ! = 0**'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 当 x%10 ! = 0 时到达这里**'
- en: '***4* Get here when x is 2, 4, 16, 32, or 64**'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 当 x 是 2、4、16、32 或 64 时到达这里**'
- en: 'In [listing 18.5](#ch18ex05), you can write two versions of the same code:
    with and without the `continue` keyword. In the version that contains the `continue`
    keyword, when the conditionals evaluate to true, all remaining statements in the
    loop are skipped. You go to the beginning of the loop and assign the next value
    for `x`, as if the loop statements are executed. But the code that doesn’t use
    the `continue` keyword ends up being a lot more convoluted than the one that does.
    In this situation, it’s useful to use the `continue` keyword when you have a lot
    of code that you want to execute when a bunch of nested conditions hold.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在[列表 18.5](#ch18ex05)中，你可以编写相同代码的两个版本：带有和不带有`continue`关键字。在包含`continue`关键字的版本中，当条件表达式评估为真时，循环中剩余的所有语句都会被跳过。你将回到循环的开始，为`x`分配下一个值，就像循环语句被执行一样。但是，不使用`continue`关键字的代码最终会比使用`continue`关键字的代码复杂得多。在这种情况下，当你有很多代码需要在多个嵌套条件成立时执行时，使用`continue`关键字是有用的。
- en: Summary
  id: totrans-112
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 概述
- en: In this lesson, my objective was for you to write programs that repeat certain
    tasks with a `while` loop. `while` loops repeat tasks while a certain condition
    holds.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在本课中，我的目标是让你使用`while`循环编写重复特定任务的程序。`while`循环在某个条件保持时重复任务。
- en: Whenever you write a `for` loop, you can convert it into a `while` loop. The
    opposite isn’t always possible. This is because `for` loops repeat a certain number
    of times, but the condition for entering inside a `while` loop might not have
    a known, set number of times that it can happen. In the examples, you saw that
    you can ask the user to enter a value; you don’t know how many times the user
    will enter the wrong value, which is why a `while` loop is useful in that situation.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 每次你编写一个`for`循环时，你都可以将其转换为`while`循环。但反过来并不总是可能的。这是因为`for`循环会重复执行一定次数，但进入`while`循环的条件可能没有已知、固定的次数。在示例中，你看到了可以要求用户输入一个值；你不知道用户会输入多少次错误值，这就是为什么在这种情况下`while`循环很有用。
- en: You also saw how to use the `break` and `continue` statements within loops.
    The `break` statement is used to stop executing all remaining statements inside
    the innermost loop. The `continue` statement is used to skip all remaining statements
    inside the innermost loop and continue from the beginning of the innermost loop.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 你还看到了如何在循环中使用`break`和`continue`语句。`break`语句用于停止执行最内层循环中剩余的所有语句。`continue`语句用于跳过最内层循环中剩余的所有语句，并从最内层循环的开始处继续。
- en: 'Here are key takeaways from this lesson:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是这个课程的关键要点：
- en: '`while` loops repeat statements as long as a certain condition holds.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`while`循环会在特定条件保持的情况下重复执行语句。'
- en: A `for` loop can be written as a `while` loop, but the opposite may not be true.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以将`for`循环写成`while`循环，但反过来可能不成立。
- en: A `break` statement can be used to exit a loop prematurely.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以使用`break`语句提前退出循环。
- en: A `continue` statement can be used to skip remaining statements in the loop
    and check the `while` loop conditional again or go to the next item in the `for`
    loop sequence.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以使用`continue`语句来跳过循环中剩余的语句，并再次检查`while`循环的条件，或者跳到`for`循环序列中的下一个项目。
- en: There’s no penalty for trying one kind of loop (`for` or `while`) and finding
    it’s not working out in your program. Try out a couple of things and think of
    it as trying to put together a coding puzzle.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果尝试一种循环（`for`或`while`）并发现它不适合你的程序，没有惩罚。尝试一些事情，把它看作是尝试拼凑一个编码谜题。
- en: Let’s see if you got this...
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看你是否掌握了这个...
- en: '**[Q18.1](kindle_split_056.html#app01qa74q0a1)**'
  id: totrans-123
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[Q18.1](kindle_split_056.html#app01qa74q0a1)**'
- en: ''
  id: totrans-124
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: This program has a bug. Change one line to avoid the infinite loop. For a few
    pairs of inputs, write what the program does and what it’s supposed to do.
  id: totrans-125
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这个程序有一个错误。更改一行以避免无限循环。对于几组输入，写出程序执行的操作和它应该执行的操作。
- en: ''
  id: totrans-126
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-127
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**[Q18.2](kindle_split_056.html#app01qa74q0a2)**'
  id: totrans-128
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**[Q18.2](kindle_split_056.html#app01qa74q0a2)**'
- en: ''
  id: totrans-129
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Write a program that asks a user whether they want to play a game. If the user
    enters `y` or `yes`, indicate that you’re thinking of a number between 1 and 10
    and ask the user to guess the number. Your program should continue asking the
    user to guess the number until they get it right. If they get it right, print
    a congratulatory message and then ask if they want to play again. This process
    should be repeated as long as the user enters `y` or `yes`.
  id: totrans-130
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 编写一个程序，询问用户是否想玩游戏。如果用户输入`y`或`yes`，表明你在想一个介于1到10之间的数字，并要求用户猜测这个数字。你的程序应该继续要求用户猜测数字，直到他们猜对为止。如果他们猜对了，打印一条祝贺信息，然后询问他们是否想再玩一次。只要用户输入`y`或`yes`，这个过程就应该重复进行。
