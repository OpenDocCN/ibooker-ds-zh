- en: '10 Learning Flask: Your first web application'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 10 学习Flask：你的第一个网络应用程序
- en: In this chapter
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章
- en: Erik creates his first simple web application
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 艾瑞克创建了第一个简单的网络应用程序
- en: Simon explains what Flask is and how it works
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 西蒙解释了Flask是什么以及它是如何工作的
- en: Emily and Erik work on a web form
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 埃米莉和艾瑞克在处理一个网络表单
- en: The first coffee shop web-based menu is ready!
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一个咖啡店基于Web的菜单准备好了！
- en: “You said you wanted to create a web application?” Simon asked Erik the next
    week.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: “你说过你想创建一个网络应用程序吗？”西蒙在下周问艾瑞克。
- en: “Yes, sure!” Erik said. “Otherwise, how could I use my program on my iPad?”
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，当然！”艾瑞克说。“否则，我怎么能在我的iPad上使用我的程序呢？”
- en: '“Okay, but be prepared: it’s not an easy task. It will require all your attention.
    If you don’t completely understand *everything* we do here, don’t worry. I’ll
    help you when you need it.”'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: “好的，但要做好准备：这不是一件容易的任务。它将需要你全部的注意力。如果你不完全理解我们在这里做的*所有*事情，不要担心。当你需要时我会帮助你。”
- en: “I know—you’re a good brother,” Erik said. There was almost no irony in the
    way he said it.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: “我知道——你是个好哥哥，”艾瑞克说。他说话的方式几乎没有讽刺意味。
- en: “We’ll use our good friend, the Mu editor, for our web application. It has a
    special mode for that. Start the editor and click Mode in the top-left corner.”
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: “我们将使用我们的好朋友，Mu编辑器，来构建我们的网络应用程序。它为此有一个特殊的模式。启动编辑器，点击左上角的模式。”
- en: Erik did and saw a menu.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克做了，并看到了一个菜单。
- en: '![](../Images/10-01-mu-change-mode.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-01-mu-change-mode.png)'
- en: “Scroll to the bottom,” Simon said. “Find the Web mode and click it. Then click
    OK.”
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: “滚动到页面底部，”西蒙说。“找到Web模式并点击它。然后点击确定。”
- en: '![](../Images/10-02-mu-web-mode.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-02-mu-web-mode.png)'
- en: After Erik did that, Simon pointed to the bottom-right corner and said, “See
    this word ‘Web’ next to the cogwheel? That shows we’ve switched to Web mode. Now
    let’s see what we can do with it—click New.”
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克这样做后，西蒙指向右下角并说：“看到这个齿轮旁边的单词‘Web’了吗？这表明我们已经切换到了Web模式。现在让我们看看我们能用它做什么——点击新建。”
- en: Erik did, and Python code immediately appeared in the editor window.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克确实这样做了，Python代码立即出现在编辑器窗口中。
- en: '![](../Images/10-03-mu-web-new.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-03-mu-web-new.png)'
- en: “Interesting,” he said. “Mu already wrote something for me. Can I run it?”
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: “很有趣，”他说。“Mu已经为我写了一些东西。我可以运行它吗？”
- en: “Sure, go ahead. First, you’ll have to save it. Call it `first_app.py`.”
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，继续。首先，你必须保存它。命名为`first_app.py`。”
- en: Erik clicked Run and entered `first_app.py` in the Save dialog. He saw the output
    at the bottom of the window.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克点击运行，并在保存对话框中输入`first_app.py`。他看到了窗口底部的输出。
- en: '![](../Images/10-04-mu-web-run.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-04-mu-web-run.png)'
- en: “What is that?” he asked.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: “那是什么？”他问。
- en: '“This tells you that your first web application is running. See this message:
    ‘Running on http://127.0.0.1:5000/’? That means you can go to your browser and
    enter this address: `http://127.0.0.1:5000/`. Sometimes, this address is called
    a *URL* or *Uniform Resource Locator*—you’ll hear those terms all the time when
    working with the web.”'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: “这告诉你你的第一个网络应用程序正在运行。看到这条消息：‘运行在http://127.0.0.1:5000/’吗？这意味着你可以去你的浏览器并输入这个地址：`http://127.0.0.1:5000/`。有时，这个地址被称为*URL*或*统一资源定位符*——当你与网络一起工作时，你经常会听到这些术语。”
- en: Erik opened a new tab in his browser and entered the address. He was surprised
    at what he saw.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克在他的浏览器中打开了一个新标签页并输入了地址。他对他所看到的东西感到惊讶。
- en: '![](../Images/10-05-hello-from-mu.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-05-hello-from-mu.png)'
- en: “Wait, is this all written by my editor?” he asked Simon.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: “等等，这些都是我的编辑写的吗？”他问西蒙。
- en: “Yes, but look, Mu suggests that you write the rest yourself,” Simon said. He
    pointed to the code example on the page. “Mu recommends you copy the code from
    the first gray window to your program. Go ahead and do that.”
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，但看，Mu建议你自己写剩下的部分，”西蒙说。他指向页面上的代码示例。“Mu建议你将代码从第一个灰色窗口复制到你的程序中。去试试吧。”
- en: That was easy. Erik quickly copied the text and pasted it below the existing
    code.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这很简单。艾瑞克迅速复制了文本并将其粘贴在现有代码下方。
- en: “Now Mu tells you to create a new file,” Simon continued. “Copy the text from
    the second window, and save it as a new file named `greeting.html`.”
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: “现在Mu告诉你创建一个新文件，”西蒙继续说。“从第二个窗口复制文本，并将其保存为名为`greeting.html`的新文件。”
- en: Erik knew how to do that. He clicked New in the Mu editor and removed the program
    Mu had put into it. He copied and pasted the text from the second gray window.
    Then he clicked Save.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克知道如何做这件事。他在Mu编辑器中点击新建，移除了Mu放入其中的程序。他从第二个灰色窗口复制并粘贴了文本。然后他点击保存。
- en: Simon helped him, “Use the drop-down menu to change from ‘*.py’ to ‘Other (*.*)’.
    Otherwise, Mu will think you’re trying to save a Python program. We need to tell
    it that this is a different type of file. In the Save As field, type `greeting.html`.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙帮他，“使用下拉菜单将‘*.py’更改为‘Other (*.*)’。否则，Mu会认为你试图保存一个Python程序。我们需要告诉它这是一个不同类型的文件。在“另存为”字段中，键入`greeting.html`。”
- en: '![](../Images/10-06-save-html.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/10-06-save-html.png)'
- en: “Now stop the program and run it again,” Simon said. “Don’t forget to switch
    to the first_app.py tab.”
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: “现在停止程序并再次运行它，”西蒙说。“别忘了切换到`first_app.py`标签页。”
- en: Erik switched to the application tab, clicked Stop, and clicked Run again. He
    saw the same output at the bottom of the window.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 埃里克切换到应用程序标签，点击停止，然后再次点击运行。他看到窗口底部的输出与之前相同。
- en: “Now go back to your browser and do what it suggests. Look, it says ‘Go visit
    /hello/yourname’ and tells you to use your own name. Add `/hello/Erik` in the
    address bar, right after `5000`.”
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: “现在回到你的浏览器，按照它建议的操作去做。看，它说‘访问/hello/你的名字’并告诉你使用你自己的名字。在地址栏中，在`5000`之后添加`/hello/Erik`。”
- en: Now this looked like real hacking. Erik entered what Simon suggested and pressed
    Enter.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 现在看起来像真正的黑客行为。埃里克输入了西蒙建议的内容并按下了Enter键。
- en: '![](../Images/10-07-hello-erik.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/10-07-hello-erik.png)'
- en: “Wow! It talks to me!” He was really impressed.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: “哇！它和我说话了！”他真的很印象深刻。
- en: “It’s already *your* program that talks to you,” Simon said. “That was easy,
    huh?”
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: “这已经是你的程序了，它会和你说话，”西蒙说。“很简单，对吧？”
- en: “Wait,” Erik said, “if we’re going to work on this web stuff, I should call
    Emily. She told me she learned HTML, and this is what we need for the web, right?”
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: “等等，”埃里克说，“如果我们要处理这些网页内容，我应该叫艾米丽。她告诉我她学过HTML，这是我们做网页需要的东西，对吧？”
- en: “Absolutely correct,” Simon agreed. “Go ahead, call her. It’s always good to
    work together.”
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: “绝对正确，”西蒙同意。“继续，给她打电话。一起工作总是好的。”
- en: '*Your Turn!* Create your first web application'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 创建你的第一个网络应用程序'
- en: Switch to the Web mode in the Mu editor and create your first web application
    by copying the example from the browser’s page, just like Erik did. Try to run
    it with your name. Try other names. Show it to your friends and ask them to use
    their names.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在Mu编辑器中切换到Web模式，并像埃里克一样从浏览器页面复制示例来创建你的第一个网络应用程序。试着用你的名字运行它。试其他名字。向你的朋友展示并让他们使用他们的名字。
- en: Emily lived nearby. She arrived in about 15 minutes, very excited about the
    project. She said immediately, “Erik, show me your HTML!”
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 艾米丽住在附近。她大约15分钟后到达，对项目非常兴奋。她说，“埃里克，给我看看你的HTML！”
- en: Erik showed her the `greeting.html` file. He said, “Well, it’s not *my* code,
    it’s from this Mu editor.”
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 埃里克给她展示了`greeting.html`文件。他说，“嗯，这不是我的代码，是从这个Mu编辑器来的。”
- en: “Wow, interesting,” Emily said. “I’ve never seen these curly braces in HTML.”
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: “哇，很有趣，”艾米丽说。“我从未在HTML中看到过这些花括号。”
- en: “Right,” Simon said, “because this isn’t pure HTML—it’s a *template*. We’re
    using a program called Flask here, which is included with Mu, and it uses templates
    to generate HTML.”
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: “没错，”西蒙说，“因为这不是纯HTML——这是一个*模板*。我们在这里使用了一个叫做Flask的程序，它是Mu的一部分，它使用模板来生成HTML。”
- en: “I see,” Emily said. “But I know these `<h1>` and `<p>` tags.”
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: “我明白了，”艾米丽说。“但我知道这些`<h1>`和`<p>`标签。”
- en: “Tags? What are ‘tags’?” Erik asked.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: “标签？‘标签’是什么？”埃里克问。
- en: “Tags are these small pieces of code that you put in your text to change how
    it looks. Look here, you place `<h1>` before ‘Hello!’ and `</h1>` after it, and
    it looks larger. This is what in HTML is called a *header*, like chapter headers.”
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: “标签是你放入文本中以改变其外观的小段代码。看这里，你在‘Hello！’之前放置`<h1>`，并在其后放置`</h1>`，它看起来更大。这在HTML中被称为*标题*，就像章节标题。”
- en: “What about `<p>`?” Erik asked.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: “那`<p>`呢？”埃里克问。
- en: '“It means ‘paragraph’,” Emily explained. “In HTML, you can write your text
    how you want: in one long line, in many short lines, or one word per line. But
    if it has `<p>` at the beginning and `</p>` at the end, it will be displayed as
    one paragraph in the browser.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: “它意味着‘段落’，”艾米丽解释道。“在HTML中，你可以按照你想要的方式编写你的文本：一行很长，很多短行，或者每行一个单词。但是如果在开头有`<p>`并在结尾有`</p>`，它将在浏览器中显示为一个段落。”
- en: “There are a lot of other tags,” she continued. “You can make your text bold
    or italic, change colors, and more.”
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: “还有很多其他的标签，”她继续说。“你可以使你的文本加粗或斜体，改变颜色，等等。”
- en: “Emily, do you know anything about HTML forms?” Simon asked.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: “艾米丽，你知道关于HTML表单的任何东西吗？”西蒙问。
- en: “They told us in class that we can create forms in HTML to enter text or use
    menus,” Emily answered. “But I haven’t tried them myself.”
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: “课堂上他们告诉我们可以在HTML中创建表单来输入文本或使用菜单，”艾米丽回答。“但我自己还没有尝试过。”
- en: “Menus is what we want!” Erik exclaimed.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: “菜单就是我们想要的！”埃里克惊呼。
- en: “I’ll help you,” Simon said. “First, we should use the mandatory HTML tags.
    We should always have `<html>` at the beginning of the file and `</html>` at the
    end. Also, we should use `<body>` tags around our text. Again, we use `<body>`
    to *open* the text and `</body>` to close it. That’s why the tags with a slash,
    `/`, are called *closing* tags.”
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: “我会帮你的，”西蒙说。“首先，我们应该使用必需的HTML标签。我们应该在文件的开始处有`<html>`，在结尾处有`</html>`。此外，我们应该在文本周围使用`<body>`标签。再次强调，我们使用`<body>`来*打开*文本，使用`</body>`来关闭它。这就是为什么带有斜杠`/`的标签被称为*闭合*标签。”
- en: '[PRE0]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: “Tags are like brackets in a list in Python,” Erik said. He wanted to show Emily
    that he knew Python already.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: “标签就像Python列表中的括号，”艾瑞克说。他想向艾米丽展示他已经知道了Python。
- en: “You’re right,” Simon confirmed. “These tags *enclose* some text and explain
    its meaning. Some pieces of text are headers, some are paragraphs. But now we
    want to create a menu. For that, we’ll need a `<form>` tag first and then a `<select>`
    tag inside it. Let’s create a very simple menu.” He started writing.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: “你说得对，”西蒙确认道。“这些标签*包含*一些文本并解释其含义。一些文本是标题，一些是段落。但现在我们想要创建一个菜单。为了做到这一点，我们首先需要一个`<form>`标签，然后在其内部使用`<select>`标签。让我们创建一个非常简单的菜单。”他开始写起来。
- en: Listing 10.1 The first menu form with two options
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 列表10.1 带有两个选项的第一个菜单表单
- en: '[PRE1]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '*Your Turn!* Create your first web form'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 创建你的第一个网页表单'
- en: Create a `forms.html` file and save it under `mu_code/templates`. Copy the preceding
    code and test it in your browser. Try to change the options and add more options.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个`forms.html`文件，并将其保存到`mu_code/templates`目录下。复制前面的代码并在浏览器中测试它。尝试更改选项并添加更多选项。
- en: Simon finished writing and clicked Save. He saved the file as `forms.html` under
    the `mu_code/templates` directory. “How many elements enclosed in tags do you
    see here? Emily, you should be more familiar with that.”
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙写完之后点击了保存。他将文件保存为`forms.html`，位于`mu_code/templates`目录下。“你在这里看到了多少被标签包含的元素？艾米丽，你应该对此更熟悉。”
- en: Emily started counting. “First, the `<html>` tag, then the `<body>` tag. Inside
    the body we have a `<form>`, and inside the form we have `<select>`. It’s for
    the menu, correct? And then in the select, we have two `<option>` elements.”
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 艾米丽开始计数。“首先，`<html>`标签，然后是`<body>`标签。在`<body>`内部我们有一个`<form>`，在`<form>`内部我们有一个`<select>`。这是菜单，对吗？然后在`<select>`中，我们有两个`<option>`元素。”
- en: “Right. You did a great job, Emily,” Simon said. “And don’t forget the `<input>`
    element, which is a part of the form. It doesn’t have a closing tag—it exists
    by itself. We use it to create the Submit button.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: “没错。艾米丽，你做得很好，”西蒙说。“别忘了`<input>`元素，它是表单的一部分。它没有闭合标签——它独立存在。我们用它来创建提交按钮。”
- en: “Let’s see what it looks like in the browser,” Simon continued.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: “让我们看看它在浏览器中的样子，”西蒙继续说。
- en: “Can you open *files* in the browser?” Erik asked. “I thought browsers are only
    for websites.”
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: “你能在浏览器中打开*文件*吗？”艾瑞克问。“我以为浏览器只用于网站。”
- en: “Of course, you can,” Emily answered. “We did it all the time in our HTML class!
    You just use the File menu in your browser and then click Open File. Then you
    find your file. That’s it.”
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，你可以，”艾米丽回答。“我们在HTML课程中一直这么做！你只需在浏览器中使用文件菜单，然后点击打开文件。然后你找到你的文件。就这样。”
- en: Erik did what Emily just said and opened the `forms.html` file. He saw a menu,
    very similar to what he had seen and used on many sites. He clicked the menu,
    and it opened.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克做了艾米丽说的，打开了`forms.html`文件。他看到了一个菜单，非常类似于他在许多网站上看到和使用过的。他点击了菜单，它打开了。
- en: '![](../Images/10-08-greeting-html.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-08-greeting-html.png)'
- en: “I didn’t know that you could create forms so easily,” Emily said.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: “我不知道你可以这么容易地创建表单，”艾米丽说。
- en: “Yes, it’s pretty easy to create a simple form like this, but there are some
    missing parts,” Simon said.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，创建这样一个简单的表单很容易，但还有一些缺失的部分，”西蒙说。
- en: “It looks good to me,” Erik said. “What’s missing?”
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: “看起来不错，”艾瑞克说。“缺少什么？”
- en: '“Yes, it *looks* good, but it doesn’t *do* anything,” Simon said. “We have
    to get data from the user and then *pass* that data to the program. How can we
    pass the data?” Simon asked. He then answered his own question, “We should use
    variables and values, very similar to Python. Let me add something to this form:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，*看起来*不错，但它*不做*任何事情，”西蒙说。“我们必须从用户那里获取数据，然后将这些数据传递给程序。我们如何传递数据？”西蒙问道。然后他回答了自己的问题，“我们应该使用变量和值，这与Python非常相似。让我在这个表单中添加一些内容：”
- en: Listing 10.2 The updated form with a variable and the `action` target
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 列表10.2 带有变量和`action`目标的更新后的表单
- en: '[PRE2]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: ❶ Defines the variable the menu will return
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 定义菜单将返回的变量
- en: ❷ Adds an option that tells the user what to do
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 添加一个选项告诉用户要做什么
- en: ❸ Defines the values the menu options will return
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 定义菜单选项将返回的值
- en: “First,” Simon said, “we define the *variable* we want to return from this menu.
    In this menu, the variable is called `drink`.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: “首先，”Simon说，“我们定义从这个菜单返回的*变量*。在这个菜单中，变量叫做`drink`。”
- en: “In the first option, we tell the user what to do. This option will show first
    in the menu and work as a prompt. As you can see, its value is empty. If the user
    hasn’t chosen a drink, they will see this prompt. You can’t prepare their order
    without this information, can you?
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: “在第一个选项中，我们告诉用户该做什么。这个选项将首先显示在菜单中，并作为提示使用。正如你所看到的，它的值是空的。如果用户没有选择饮料，他们会看到这个提示。没有这个信息，你无法准备他们的订单，对吧？”
- en: “Finally, the next two options define the *value* this menu option can return.
    It’s similar to what we did when we chose items from a text menu, remember?”
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: “最后，接下来的两个选项定义了这个菜单选项可以返回的*值*。这和我们选择文本菜单中的项目时做的是类似的，记得吗？”
- en: “Can I try it?” Erik asked.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: “我能试试吗？”Erik问。
- en: “Of course, go ahead and open the file again. Or just reload it in the browser.”
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，你可以再次打开文件。或者只需在浏览器中重新加载它。”
- en: Erik reloaded the file and chose Decaf from the menu. Then he clicked Submit.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Erik重新加载了文件，并从菜单中选择了脱咖啡因。然后他点击了提交。
- en: '![](../Images/10-09-first-menu.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/10-09-first-menu.png)'
- en: “What’s that?” he asked, visibly puzzled.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: “那是什么？”他问，显然很困惑。
- en: “Oh, I forgot to tell you,” Simon said. “Look, I changed the `form` tag a little
    bit.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: “哦，我忘了告诉你，”Simon说。“看，我稍微修改了`form`标签。”
- en: Listing 10.3 The `action` target
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 列表10.3 `action`目标
- en: '[PRE3]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '“Each form should have an *action*,” he started to explain. “An action is something
    that our application will do when the user submits the form. When the user makes
    their choice—coffee or decaf—they should *pass* this information to some function.
    That function should know what to do with this information: store it in the file
    or database, print the order, and so on.”'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: “每个表单都应该有一个*action*，”他开始解释。“当用户提交表单时，我们的应用程序会执行一些操作。当用户做出选择——咖啡或脱咖啡因——他们应该将这个信息传递给某个函数。这个函数应该知道如何处理这个信息：将其存储在文件或数据库中，打印订单，等等。”
- en: “Like what we did in our previous program?” Erik asked.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: “就像我们以前程序中做的那样？”Erik问。
- en: “You keep talking about your ‘previous’ program. Can you show it to me?” Emily
    demanded.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: “你一直在谈论你的‘以前’的程序。你能给我看看吗？”Emily要求。
- en: “I’m sorry, Emily,” Simon said. “I should have explained it earlier. I worked
    with Erik on a program that collects orders in a coffee shop, similar to Starbucks,
    where you can order a drink, add flavors and toppings, and all that. Erik wrote
    a program that shows menus and asks the customer what they want to order. When
    they choose their drinks, flavors, and toppings, the program prints the order.
    But the program only works in a terminal, in text mode, for now. Erik needs your
    help to convert it to a web application.”
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: “对不起，Emily，”Simon说。“我应该早点解释的。我和Erik合作编写了一个收集咖啡店订单的程序，类似于星巴克，在那里你可以点饮料，添加风味和配料，等等。Erik编写了一个显示菜单并询问客户他们想点什么的程序。当他们选择饮料、风味和配料时，程序会打印订单。但现在程序只能在终端的文本模式下工作。Erik需要你的帮助将这个程序转换为Web应用程序。”
- en: “This sounds like a cool project!” Emily said. “I hope Erik will teach me Python
    too.”
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: “这听起来是个很酷的项目！”Emily说。“我希望Erik也会教我Python。”
- en: “Of course,” Simon said. “Teaching somebody is the best way to learn.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，”Simon说。“教别人是最好的学习方法。”
- en: '“Back to our form,” he continued. “That `action` attribute tells the browser:
    ‘After the user submits the form, open this address and pass the information from
    the form there.’ In our case, the address is called `/order`.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: “回到我们的形式，”他继续说。“这个`action`属性告诉浏览器：‘在用户提交表单后，打开这个地址并传递表单中的信息。’在我们的例子中，这个地址叫做`/order`。”
- en: “Don’t worry, it only sounds scary—I’ll show you what to do with it,” Simon
    added. He noticed the confusion on Emily’s and Erik’s face.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: “别担心，听起来可能有点可怕——我会告诉你如何使用它，”Simon补充道。他注意到Emily和Erik脸上的困惑。
- en: “I still don’t understand,” Erik said. “Where is this address that you’re talking
    about?”
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: “我仍然不明白，”Erik说。“你说的这个地址在哪里？”
- en: '“Look at your first application,” Simon said. “See this `greet` function? This
    function was written by the Mu editor for us—or, rather, by its authors,” Simon
    said. “You see the now familiar function definition that starts with `def`, but,
    right above it, you can see something new: `@app.route(''/hello/<name>'')`. In
    Python, it’s called a *decorator*, but we aren’t going to learn about decorators
    today.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: “看看你的第一个应用程序，”Simon说。“看到这个`greet`函数了吗？这个函数是由Mu编辑器为我们写的——或者更确切地说，是由它的作者写的，”Simon说。“你看到现在熟悉的以`def`开始的函数定义，但是，就在它上面，你可以看到一些新的东西：`@app.route('/hello/<name>')`。在Python中，它被称为*装饰器*，但我们今天不会学习装饰器。”
- en: '[PRE4]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: “What’s important for us today is that you can use it to tell your program which
    function to use for which address.”
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: “对我们今天来说重要的是，你可以用它来告诉你的程序使用哪个函数来处理哪个地址。”
- en: “Aha, the address is that `/hello/Erik` I entered in the browser! I see now,”
    Erik said. “Let’s show Emily how it works.” He opened the tab with the `first_app.py`
    file in the editor and clicked Run. Then he clicked Browse. His browser opened
    a page with greetings from Mu.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: “啊哈，这正是我在浏览器中输入的地址 `/hello/Erik`！我现在明白了，”艾瑞克说。“让我们给艾米丽展示一下它是如何工作的。”他在编辑器中打开了包含
    `first_app.py` 文件的标签页，并点击了运行。然后他点击了浏览。他的浏览器打开了一个显示穆的问候语的页面。
- en: “Emily, look, I can type the address here, right after these numbers, `127.0.0.1:5000`.
    Look what it shows us!” Erik typed `/hello/Emily` and pressed Enter. The browser
    showed them the result.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: “艾米丽，看，我可以在这些数字后面直接输入地址，`127.0.0.1:5000`。看看它显示给我们什么！”艾瑞克输入了 `/hello/Emily` 并按下了回车键。浏览器显示了结果。
- en: '![](../Images/10-10-order-file-not-found.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![文件未找到](../Images/10-10-order-file-not-found.png)'
- en: “Wow, I like it!” Emily said. “Can I try?” She changed “Emily” to “Erik”. Of
    course, the browser showed the page with “Hello Erik, how are you?”
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: “哇，我喜欢！”艾米丽说。“我可以试试吗？”她将“Emily”改成了“Erik”。当然，浏览器显示了“Hello Erik，你好吗？”的页面。
- en: “Interesting!” she said. “In our HTML class, we could change pages, but we had
    to edit HTML. This is much easier!”
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: “很有趣！”她说。“在我们的HTML课程中，我们可以更改页面，但我们必须编辑HTML。这要容易得多！”
- en: “Right,” Simon said. “This is what we call *dynamic* pages—pages that change
    depending on what you enter. You can enter your information in the address, like
    `/hello/Emily`, or you can use forms. Then the page is *generated* using the information
    you entered. I’m sure you’ve seen this kind of page many times—for example, when
    you enter a comment or chat with someone on the web. You click Submit or just
    press Enter, and the page is updated, right? Now you’ll learn how to make such
    pages yourself.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: “没错，”西蒙说。“这就是我们所说的*动态页面*——根据你输入的内容而变化的页面。你可以在地址中输入你的信息，比如 `/hello/Emily`，或者你可以使用表单。然后页面就会根据你输入的信息*生成*。我相信你一定见过很多这样的页面——例如，当你在网上输入评论或与人聊天时。你点击提交或直接按回车键，页面就会更新，对吧？现在你将学习如何自己制作这样的页面。”
- en: “Let me show it in a diagram,” he said. Simon started drawing.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: “让我用图表来展示，”他说。西蒙开始画图。
- en: '![](../Images/10-11-hello-emily.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![hello-emily](../Images/10-11-hello-emily.png)'
- en: “This combination of letters and numbers at the top of your browser is the *address*
    or *URL*. I labeled it in blue. Usually, you’ll see the site’s name here, like
    `google.com`. In our case, it uses numbers, which are the site’s IP address. We’re
    using your own computer, and, for every computer in the world, the address `127.0.0.1`
    means ‘this computer.’ But don’t worry about that now.”
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: “你浏览器顶部的这个字母和数字的组合是*地址*或*URL*。我用蓝色标出了它。通常，你会在这里看到网站的名称，比如 `google.com`。在我们的例子中，它使用的是数字，这是网站的IP地址。我们正在使用你的电脑，对于世界上每台电脑，地址
    `127.0.0.1` 都意味着‘这台电脑’。但现在你不用担心这个。”
- en: Simon pointed to the first red circle around the word ‘order’ in the address
    and said, “This is what you should care about. Look, it’s part of the address.
    When we open this address, we see the form with the drinks menu. When you click
    Submit,” and he followed the arrow down his diagram, “the form knows that it should
    find the function responsible for the `/order` address. You see, it’s here, in
    the `form action` field.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙指向地址中“order”这个词的第一个红色圆圈，说：“这就是你应该关注的。看，它是地址的一部分。当我们打开这个地址时，我们看到的是带有饮料菜单的表单。当你点击提交”时，他顺着图中的箭头指向，“表单知道它应该找到负责
    `/order` 地址的函数。你看，它就在这里的 `form action` 字段中。”
- en: “And then,” he followed the arrow up to the Python block, “the form finds the
    Python function that can work with it, because we used the `@app.route('/order')`
    decorator. You see, these three things are connected; you just have to use the
    same name in the address, form, and Python program.”
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: “然后，”他顺着箭头指向Python块，“表单找到了可以与之一起工作的Python函数，因为我们使用了 `@app.route('/order')` 装饰器。你看，这三者是有联系的；你只需要在地址、表单和Python程序中使用相同的名字。”
- en: “I see that the function is also called ‘order’—is that the fourth place where
    we use it?” Erik asked.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: “我注意到函数也被称作‘order’——这是第四个我们使用它的地方吗？”艾瑞克问道。
- en: “You have a very sharp eye!” Simon said and smiled. “No, in this case, the function
    can have a different name. I could call it ‘new_order’ or ‘get_order’.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: “你真有一双敏锐的眼睛！”西蒙说，并微笑着。“不，在这种情况下，函数可以有不同的名字。我可以叫它‘new_order’或‘get_order’。”
- en: “But now we have to write the actual function. I’ll help you here. It will look
    a bit scary, but don’t worry. I’m learning this Flask system myself, and, usually,
    I follow the online tutorial and take examples from there. Don’t think that I
    remember all these things myself.”
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: “但现在我们必须编写实际的函数。我会在这里帮助你。它看起来可能有点吓人，但别担心。我自己也在学习这个Flask系统，通常我会遵循在线教程并从中取例。别以为我都是自己记住的这些事情。”
- en: 'Simon wrote the function, looking at the example he kept open in the browser.
    “In the first line, you see the words `GET` and `POST`. These are the *methods*
    that we use with web servers. We use `GET` when we want to get something from
    a web server, like a web page. We use `POST` to *send* information to the web
    server. Like in this case—we want to send or `POST` the drink chosen by the customer.
    To put it another way: when you load a page in the browser, you use `GET`; and
    when you click Submit in your form, you use `POST`. You’ll understand it better
    when we start using it, don’t worry.'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 西蒙编写这个函数时，正在查看浏览器中打开的示例。他说：“在第一行，你看到的是`GET`和`POST`这两个词。这是我们与网络服务器一起使用的*方法*。当我们想从网络服务器获取东西时，比如一个网页，我们使用`GET`。我们使用`POST`来*发送*信息到网络服务器。就像这个案例一样——我们想要发送或`POST`客户选择的饮料。换句话说：当你用浏览器加载一个页面时，你使用`GET`；当你点击表单中的提交时，你使用`POST`。当你开始使用它时，你会更好地理解它，别担心。”
- en: '“Below that, we start using one of the words, `POST`: `if request.method ==
    ''POST'':`. Look at what it says: if the method is `POST`, which means somebody
    filled out the form and clicked Submit, we read the information they entered in
    the form and print it.'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: “在那之下，我们开始使用一个单词，`POST`：`if request.method == 'POST':`。看看它说了什么：如果方法是`POST`，这意味着有人填写了表单并点击了提交，我们就读取他们在表单中输入的信息并打印出来。
- en: '“Remember that we used `<select name="drink">` in the form? This is the name
    we use in the next line, in the square brackets: `drink = request.form[''drink'']`.
    Later, we’ll add other menus for flavors and toppings. In the form, they will
    have names like `flavor` and `topping`. Here, in the code, we’ll use them as `request.form[''flavor'']`
    and `request.form[''topping'']`.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: “记住我们在表单中使用了`<select name="drink">`吗？这就是我们在下一行，在方括号中使用的名字：`drink = request.form['drink']`。稍后，我们将添加其他用于口味和配料的选择菜单。在表单中，它们将具有`flavor`和`topping`这样的名字。在这里，在代码中，我们将使用`request.form['flavor']`和`request.form['topping']`。
- en: “In the `print` line, we just print whatever we received from the form. You’ll
    see it in the editor.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: “在`print`行中，我们只是打印从表单接收到的任何内容。你会在编辑器中看到它。
- en: “In the last line, we tell our web server to print this page with the menu.
    It’s like the menu loop that we used in our program before—you get the information
    from the customer, print it out, and return to the menu to get another order.
    You repeat this loop until you’re done entering orders.”
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: “在最后一行，我们告诉我们的网络服务器打印这个带有菜单的页面。它就像我们之前程序中使用的菜单循环——你从客户那里获取信息，打印出来，然后返回菜单以获取另一个订单。你重复这个循环，直到你完成订单输入。”
- en: 'The following listing shows the function Simon wrote:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的列表显示了西蒙编写的函数：
- en: Listing 10.4 The function to process an order
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 列表10.4 处理订单的函数
- en: '[PRE5]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: ❶ Methods that we’ll use with this form
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 我们将使用此表单的方法
- en: ❷ The POST method means we’re submitting information.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ POST方法意味着我们在提交信息。
- en: ❸ Gets the customer choice from the form’s field called drink
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 从表单的名为`drink`的字段获取客户选择
- en: ❹ Prints the choice we’ve received
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 打印我们收到的选择
- en: ❺ Display the forms.html template.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: ❺ 显示forms.html模板。
- en: '“Let me add one more thing,” Simon said. He added `request` to the first line
    with `import`. “This module, called `request`, is a part of Flask. If we use it,
    we have to import it.” Now the first line looked like this:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: “让我再补充一点，”西蒙说。他在`import`的第一行添加了`request`。“这个名为`request`的模块是Flask的一部分。如果我们使用它，我们必须导入它。”现在第一行看起来是这样的：
- en: '[PRE6]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '*Your Turn!* Write your own `order()` function'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 编写你自己的`order()`函数'
- en: Add the preceding `order()` function to your `first_app.py` program. Don’t forget
    to change the `import` line.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 将前面的`order()`函数添加到你的`first_app.py`程序中。别忘了更改`import`行。
- en: Then try to run it. Open a new tab in the browser and use the `http:// 127.0.0.1:5000/order`
    address. If you’re having problems, continue reading and follow what Emily and
    Erik are doing.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 然后尝试运行它。在浏览器中打开一个新标签页，并使用`http:// 127.0.0.1:5000/order`地址。如果你遇到问题，继续阅读并跟随艾米丽和埃里克的做法。
- en: “Can I run it now?” Erik asked. He was a bit tired after such a long explanation.
    Emily, on the other hand, listened to Simon’s explanations as if he was a wizard.
    She liked all this programming magic and couldn’t wait to try the program.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: “我现在可以运行它了吗？”埃里克问道。经过这样长时间的讲解，他有点累了。另一方面，艾米丽好像在听西蒙施展魔法一样，她喜欢所有这些编程魔法，迫不及待地想尝试程序。
- en: “Can I run it?” Emily asked.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: “我可以运行它吗？”艾米丽问道。
- en: “Of course,” Erik said. “Just click Save and then Run.”
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，”埃里克说。“只需点击保存然后运行。”
- en: “Now click Browse,” Simon said.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: “现在点击浏览，”西蒙说。
- en: Emily did, and the page opened in a new browser tab.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 艾米丽确实做到了，页面在新浏览器标签页中打开了。
- en: '![](../Images/10-12-form-action.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-12-form-action.png)'
- en: “Now we have to add `/order` to the address, remember?” Simon helped her.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: “现在我们必须在地址中添加`/order`，记住？”西蒙帮她解释。
- en: 'Emily did, and the address line in the browser became: `http://127.0.0.1:5000/
    order`. The page showed the menu they just created together.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 艾米丽确实做到了，浏览器中的地址行变成了：`http://127.0.0.1:5000/ order`。页面显示了他们刚刚一起创建的菜单。
- en: '![](../Images/10-13-hello-from-mu-with-emily.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-13-hello-from-mu-with-emily.png)'
- en: “Go ahead. Choose your drink and click Submit,” Simon said.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: “继续。选择你的饮料并点击提交，”西蒙说。
- en: Emily chose Decaf and clicked Submit. She got the same page with the Choose
    Drink menu.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 艾米丽选择了无咖啡因咖啡并点击了提交。她得到了与选择饮料菜单相同的页面。
- en: “Did it work?” she asked. She looked confused.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: “它工作了吗？”她问道。她看起来很困惑。
- en: “Let’s check,” Simon said. “Go back to the editor. Look at the bottom window.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: “让我们检查一下，”西蒙说。“回到编辑器。看看底部的窗口。
- en: '![](../Images/10-14-web-drink-menu.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-14-web-drink-menu.png)'
- en: '“Do you see this line: `Drink: decaf`? It’s what our program is printing,”
    Simon said. “That means it works!”'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '“你看到这条线：`Drink: decaf`吗？这是我们程序打印的内容，”西蒙说。“这意味着它工作了！”'
- en: “But I thought that it would print the order on the page,” Emily said.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: “但我以为它会将订单打印在页面上，”艾米丽说。
- en: “It will, trust me,” Simon said. “We haven’t written that part yet. We’re getting
    there, right now.”
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: “它会，相信我，”西蒙说。“我们还没有写那部分。我们正在接近，现在。”
- en: He took the keyboard and changed the `first_app.py` file by adding one line
    after the `print()` line. Simon explained, “When we first open the `/order` address
    in the browser, that means we use the `GET` method. We want to *get* the page
    first, right? We don’t have anything to `POST` yet. In that case, we use the `forms.html`
    template that displays our drink menu.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 他拿起键盘，在`print()`行之后添加了一行到`first_app.py`文件中。西蒙解释说，“当我们第一次在浏览器中打开`/order`地址时，这意味着我们使用的是`GET`方法。我们想要*获取*页面，对吧？我们还没有什么要`POST`的。在这种情况下，我们使用显示饮料菜单的`forms.html`模板。
- en: “But after we have chosen a drink and clicked Submit, we use the `POST` method.
    We want to *send* this information to the program. In that case, we collect the
    data from the form—the drink choice—and we use *another* template. I called it
    `print.html`, because we want to print the order.”
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: “但我们在选择了一款饮料并点击提交后，我们使用的是`POST`方法。我们想要*发送*这些信息到程序。在这种情况下，我们从表单中收集数据——饮料选择——并使用*另一个*模板。我称之为`print.html`，因为我们想要打印订单。”
- en: 'The `order()` function now looked like this:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`order()`函数现在看起来是这样的：'
- en: '[PRE7]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: ❶ Prints the order using the print.html template
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 使用`print.html`模板打印订单
- en: “But we don’t have a file called `print.html`,” Emily said.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: “但我们没有名为`print.html`的文件，”艾米丽说。
- en: '“Right, I’m going to create it right now.” Simon created another file in the
    editor and saved it as `print.html` under `templates`:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: “好的，我现在就创建它。”西蒙在编辑器中创建了一个新的文件，并将其保存为`print.html`，位于`templates`目录下：
- en: Listing 10.5 A template to print the order (first version)
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 列表10.5 打印订单的模板（第一版）
- en: '[PRE8]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Emily looked at his code and said, “Oh, this I can understand! You print the
    header, ‘Thanks for your order’, and then you open a new paragraph and print ‘Your
    drink’, and then in bold you print the drink itself. And this `drink` in double
    curly braces works the same way it worked with my name when it printed ‘Hello
    Emily’, right?”
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 艾米丽看了他的代码说，“哦，这个我可以理解！你打印标题‘感谢您的订单’，然后打开一个新的段落并打印‘您的饮料’，然后在粗体中打印饮料本身。并且这个双大括号中的`drink`工作方式和我打印‘Hello
    Emily’时使用我的名字的方式是一样的，对吗？”
- en: “Exactly right!” exclaimed Simon. “You’re absolutely correct, Emily!”
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: “完全正确！”西蒙大声说道。“你完全正确，艾米丽！”
- en: '*Your Turn!* Edit your web form to print the drink choice on the page'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '*轮到你了!* 编辑你的网页表单以在页面上打印饮料选择'
- en: Copy the preceding template into your `print.html` file. Feel free to change
    the title and the text. Change the `first_app.py` file by adding the line with
    `return` and save it too. Try running your program.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 将前面的模板复制到你的`print.html`文件中。你可以随意更改标题和文本。通过添加带有`return`的行来更改`first_app.py`文件，并保存它。尝试运行你的程序。
- en: “Can I try it?” Emily asked.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: “我可以试试吗？”埃米莉问。
- en: “Sure, go ahead and click Run,” Simon said.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，继续点击运行，”西蒙说。
- en: Emily clicked Run and chose Coffee from the menu. She saw the updated page.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 埃米莉点击运行并从菜单中选择咖啡。她看到了更新后的页面。
- en: '![](../Images/10-15-console-output-decaf.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-15-console-output-decaf.png)'
- en: “Yeah, it works!” she exclaimed.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，它工作了！”她惊呼。
- en: “It’s like calling the `print_order()` function in our previous program,” Erik
    said.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: “这就像在我们之前的程序中调用`print_order()`函数一样，”艾瑞克说。
- en: “Yes, exactly!” Simon said.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，正是这样！”西蒙说。
- en: “But how do I get back to the order page?” Erik asked.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: “但我怎么回到订单页面呢？”艾瑞克问。
- en: “You see that the address in the browser is still pointing to `/order`?” Simon
    asked. “That means if you click the address line with the mouse and press Enter,
    you’ll reload the order page. Just don’t click the reload button, or it will create
    another order.”
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: “你看到浏览器中的地址仍然是指向`/order`吗？”西蒙问，“这意味着如果你用鼠标点击地址行并按Enter键，你会重新加载订单页面。只是不要点击刷新按钮，否则会创建另一个订单。”
- en: Emily did what Simon said, and she saw the order page again.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 埃米莉按照西蒙说的做了，她又看到了订单页面。
- en: “But there is a better way,” Simon said. “You were looking for a button on the
    print page, like Back To The Order Page, weren’t you?”
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: “但有一个更好的方法，”西蒙说，“你之前在打印页面上找的是一个按钮，比如回到订单页面，对吧？”
- en: “Yes, that would be easier,” Emily agreed.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，这样会更容易，”埃米莉同意了。
- en: “We can use another form for that,” Simon said. “It will be very simple.” He
    added several lines to the `templates/print.html` file.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: “我们可以使用另一个表单来做这件事，”西蒙说，“这会非常简单。”他在`templates/print.html`文件中添加了几行。
- en: “Look, I created another form that has only the Submit button. I just renamed
    it to ‘New order’. Look, it points to `/order` in its `action` field. That means
    when we click the New Order button, it will send us to the `/order` page, and
    it will show the drink menu again. Try it!”
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: “看，我创建了一个只有提交按钮的另一个表单。我只是把它改名为‘新订单’。看，它的`action`字段指向`/order`。这意味着当我们点击新订单按钮时，它会带我们到`/order`页面，并再次显示饮料菜单。试试！”
- en: Listing 10.6 The updated print template with the New Order button
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 列表10.6 带有新订单按钮的更新版打印模板
- en: '[PRE9]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Emily did, and, after she clicked Submit, she saw a page with the new button.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 埃米莉照做了，点击提交后，她看到了带有新按钮的页面。
- en: '![](../Images/10-16-print-order-1.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-16-print-order-1.png)'
- en: She clicked the button and got back to the order page.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 她点击了按钮，然后回到了订单页面。
- en: Erik noted, “It’s like our main menu with a loop. Order, then confirm, then
    print, and then back to the order menu.”
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 艾瑞克指出，“它就像我们的主菜单带有一个循环。订单，然后确认，然后打印，然后回到订单菜单。”
- en: “You’re right!” Simon confirmed. “Let me show it in a diagram.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: “你说得对！”西蒙确认道，“让我用图来展示。
- en: '![](../Images/10-17-print-order-2.png)'
  id: totrans-188
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10-17-print-order-2.png)'
- en: '“Look at the diagram. Step one: you choose Decaf from the menu. This assigns
    the value `decaf` to the `drink` variable in the form.'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: “看看这个图。第一步：你从菜单中选择Decaf。这会将值`decaf`分配给表单中的`drink`变量。
- en: '“Step two: that value `decaf` is passed to our Python program via `request.form`.
    Now the `drink` variable in the Python program has the value `decaf`.'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: “第二步：那个值`decaf`通过`request.form`传递到我们的Python程序中。现在Python程序中的`drink`变量有了`decaf`的值。
- en: '“Step three: we pass the value of the `drink` variable from Python—which is
    `decaf`—to the `drink` variable in the `print.html` template.'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: “第三步：我们将Python中的`drink`变量的值——即`decaf`——传递到`print.html`模板中的`drink`变量。
- en: '“Step four: we call `render_template()` with the `drink` variable, which is
    replaced with its value, `decaf`. And now `decaf` is printed on the web page.'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: “第四步：我们调用`render_template()`函数，并传入`drink`变量，它会被其值`decaf`所替换。现在`decaf`已经在网页上打印出来了。
- en: '“Finally, step five: we click New Order and return to the order page.'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: “最后，第五步：我们点击新订单，返回到订单页面。
- en: '*Your Turn!* Change the `print.html` template'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '*你的机会来了!* 修改`print.html`模板'
- en: Add a New Order button to the `templates/print.html` template. Test it. Can
    you return to the order page?
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 将新订单按钮添加到`templates/print.html`模板中。测试一下。你能返回到订单页面吗？
- en: “Emily and Erik, you did a great job today,” Simon said. “Most importantly,
    you didn’t fall asleep during all those long explanations.”
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: “埃米莉和艾瑞克，你们今天做得很好，”西蒙说，“最重要的是，你们在整个漫长的解释过程中都没有睡着。”
- en: “I almost did,” Erik said.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: “我差点就做到了，”艾瑞克说。
- en: “Yes, I noticed,” Simon said and smiled. “But seriously, creating web applications
    is 10 times more difficult than working on text menus and dialogues. I admire
    your patience!”
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: “是的，我注意到了，”西蒙说，然后微笑。“但说真的，创建Web应用是比处理文本菜单和对话框难10倍的事情。我钦佩你的耐心！”
- en: “But it was worth it,” Emily said. “The program works now!”
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: “但是这很值得，”埃米莉说，“程序现在可以工作了！”
- en: “We also need to add flavors and toppings,” Erik said.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: “我们还需要添加一些风味和配料，”艾瑞克说。
- en: “Right!” Simon said. “We have to create all the menus, but in the web form.
    I’m pretty sure Emily will help you with that.”
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: “对！”西蒙说。“我们必须创建所有的菜单，但要以Web表单的形式。我非常确信艾米丽会帮你做这件事。”
- en: “Sure,” Emily said. “It looks like we need to add more `select` forms to the
    template. Erik, will you show me your previous program? We can start working on
    the web application tomorrow.”
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，”艾米丽说。“看起来我们需要在模板中添加更多的`select`表单。艾瑞克，你能给我看看你之前的程序吗？我们明天就可以开始制作网络应用程序了。”
- en: “Of course,” Erik said. “Let’s get together tomorrow and work on that.”
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: “当然，”艾瑞克说。“我们明天聚在一起工作吧。”
- en: “I’ll be happy to help,” Simon said. “Please let me know when you start.”
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: “我很乐意帮忙，”西蒙说。“请告诉我你什么时候开始。”
- en: New things you have learned today
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 你今天学到的新知识
- en: '*Web mode in Mu editor*—In addition to the standard Python mode, the Mu editor
    also has a web mode. It has a simple web application example.'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Mu编辑器的Web模式*——除了标准的Python模式外，Mu编辑器还有一个Web模式。它有一个简单的网络应用程序示例。'
- en: '*HTML forms*—This is a way to get information from users into a web application.
    You can have menus, text fields, and buttons. When you click Submit, the form
    sends information to a special address configured in the `action` field. From
    that address, the information can be processed by a program.'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*HTML表单*——这是一种将用户信息输入到网络应用程序中的方法。你可以有菜单、文本字段和按钮。当你点击提交时，表单会将信息发送到在`action`字段中配置的特殊地址。从该地址，信息可以被程序处理。'
- en: '*Flask*—A program that helps us create web applications. It’s being developed
    by the open source community, and it has good tutorials and examples. It’s used
    by many online sites and web applications.'
  id: totrans-208
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Flask*——一个帮助我们创建网络应用程序的程序。它由开源社区开发，拥有良好的教程和示例。许多在线网站和网络应用程序都在使用它。'
- en: Code for this chapter
  id: totrans-209
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 本章的代码
- en: 'You can find the code for this chapter here: [https://github.com/pavelanni/pythonicadventure-code/tree/main/ch10](https://github.com/pavelanni/pythonicadventure-code/tree/main/ch10).'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在这里找到本章的代码：[https://github.com/pavelanni/pythonicadventure-code/tree/main/ch10](https://github.com/pavelanni/pythonicadventure-code/tree/main/ch10)。
