- en: 2 Meet PowerShell
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2 探索PowerShell
- en: This chapter is all about getting you situated and helping you to decide which
    PowerShell interface you’ll use (yes, you have a choice). If you’ve used PowerShell
    before, this material might seem redundant, so feel free to *skim* this chapter—you
    might still find some tidbits here and there that’ll help you down the line.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章全部关于让您熟悉环境，并帮助您决定您将使用哪个PowerShell界面（是的，您有选择）。如果您之前使用过PowerShell，这些材料可能看起来有些重复，所以请随意*浏览*本章——您可能仍然会在这里和那里找到一些有用的信息。
- en: Also, this chapter applies exclusively to PowerShell on Windows, macOS, and
    Ubuntu 18.04\. Other Linux distributions have a similar setup, but they will not
    be covered in this chapter. For those other installation instructions, you can
    get them right from PowerShell’s GitHub page at [https://github.com/PowerShell/PowerShell#](https://github.com/PowerShell/PowerShell#).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，本章仅适用于Windows、macOS和Ubuntu 18.04上的PowerShell。其他Linux发行版有类似的设置，但本章不会涉及。对于其他安装说明，您可以直接从PowerShell的GitHub页面[https://github.com/PowerShell/PowerShell#](https://github.com/PowerShell/PowerShell#)获取。
- en: Useful terms
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 有用术语
- en: We should define a few terms that we will use quite a bit in this chapter.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该定义一些在本章中会大量使用的术语。
- en: '*PowerShell*—Refers to the 7.x version that you have installed.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '*PowerShell*—指的是您已安装的7.x版本。'
- en: '*Shell* *—*A shell is basically an application that can accept text-based commands
    and is commonly used to interact with your computer or other machines via a script
    or interactive experience like a terminal. Examples of shells include Bash, fish,
    or PowerShell.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '*Shell* *—*Shell基本上是一个可以接受基于文本的命令的应用程序，通常用于通过脚本或终端等交互式体验与您的计算机或其他机器进行交互。Shell的例子包括Bash、fish或PowerShell。'
- en: '*Terminal*—A terminal is an application that can run a shell application within
    it so that a user can interact with the shell in a visual way. Terminals are shell
    agnostic, so you can run any shell in any terminal you’d like.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '*Terminal*—终端是一个可以在其中运行shell应用程序的应用程序，这样用户就可以以可视化的方式与shell进行交互。终端是shell无关的，因此您可以在任何终端中运行任何shell。'
- en: '*Windows PowerShell*—Refers to PowerShell 5.1 that comes preinstalled on your
    Windows 10 device.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '*Windows PowerShell*—指的是预装在您的Windows 10设备上的PowerShell 5.1。'
- en: 2.1 PowerShell on Windows
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.1 Windows上的PowerShell
- en: PowerShell has come preinstalled on Windows PCs since Windows 7 (and Server
    2008). It is important to note that the process name for PowerShell 7 has changed
    on Windows. It is no longer `powershell.exe` but `pwsh.exe.` PowerShell 7 is a
    side-by-side installation, meaning that Windows PowerShell (5.1) is still installed
    by default (hence why the process name had to change).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell自Windows 7（以及Server 2008）以来就预装在Windows PC上。需要注意的是，Windows上PowerShell
    7的进程名已更改。它不再是`powershell.exe`，而是`pwsh.exe`。PowerShell 7是并行安装，这意味着Windows PowerShell（5.1）仍然默认安装（这就是为什么进程名必须更改）。
- en: 'Let’s install PowerShell 7 first. There are multiple ways to install this (e.g.,
    from the Microsoft Store, winget, Chocolatey), so you can choose any method you
    like, but for this book we are going with the straightforward approach, which
    is to download the MSI from the PowerShell GitHub repo: [PowerShell/PowerShell](https://github.com/PowerShell/PowerShell).
    Make sure you download the stable release, as this is the latest GA (general availability)
    release from the PowerShell team (figure 2.1).'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先安装PowerShell 7。安装此软件有多种方式（例如，从Microsoft Store、winget、Chocolatey），因此您可以选择您喜欢的任何方法，但在这本书中，我们采用直接的方法，即从PowerShell的GitHub仓库下载MSI：[PowerShell/PowerShell](https://github.com/PowerShell/PowerShell)。请确保您下载的是稳定版本，因为这是PowerShell团队发布的最新GA（通用可用）版本（如图2.1所示）。
- en: '![](Images/CH02_F01_Plunk.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH02_F01_Plunk.png)'
- en: Figure 2.1 This shows the different installs available for PowerShell, with
    the MSI pointed out for Windows installation.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.1 这显示了可用于PowerShell的不同安装方式，其中MSI用于Windows安装。
- en: Walk through the MSI wizard, accept the defaults, and then you are done. There
    are several ways to launch PowerShell (figure 2.2). After it is installed, you
    can search for it in the task bar. This is also a great time to point out that
    the icons have changed a little bit as well.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 按照MSI向导进行操作，接受默认设置，然后您就完成了。启动PowerShell有多种方式（如图2.2所示）。安装后，您可以在任务栏中搜索它。这也是指出图标也略有变化的好时机。
- en: '![](Images/CH02_F02_Plunk.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH02_F02_Plunk.png)'
- en: Figure 2.2 Start menu on Windows 10 showing the side-by-side installation for
    PowerShell 7 and PowerShell 5.1
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.2 Windows 10的开始菜单显示了PowerShell 7和PowerShell 5.1的并行安装
- en: If you click the PowerShell 7 icon (we suggest you make it a task bar icon as
    well), this will launch the PowerShell console. If you are familiar with Windows
    PowerShell, you will see a noticeable difference in the way it looks. That is
    because the background color is black and not blue. For the purposes of this book,
    we have changed our conosle colors so that they are easier to read.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你点击 PowerShell 7 图标（我们建议你将其也设置为任务栏图标），这将启动 PowerShell 控制台。如果你熟悉 Windows PowerShell，你将注意到它在外观上的明显差异。这是因为背景色是黑色而不是蓝色。为了这本书的目的，我们已经更改了控制台颜色，以便更容易阅读。
- en: 'The PowerShell console application is your only option when you’re running
    PowerShell on a server that doesn’t have a GUI shell installed:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在没有安装 GUI 终端的服务器上运行 PowerShell 时，PowerShell 控制台应用程序是你的唯一选择：
- en: The console application is tiny. It loads fast and doesn’t use much memory.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制台应用程序非常小巧。它加载速度快，且内存占用很少。
- en: It doesn’t require any more .NET Framework stuff than PowerShell itself needs.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它不需要比 PowerShell 本身更多的 .NET Framework 支持。
- en: You can set the colors to green text on a black background and pretend you’re
    working on a 1970s-era mainframe.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以将颜色设置为绿色文本和黑色背景，假装你在使用 1970 年代的巨型计算机。
- en: If you decide to use the console application, we have a few suggestions for
    configuring it. You can make all of these configurations by clicking the window’s
    upper-left-corner control box and selecting Properties. The resulting dialog box
    is shown in figure 2.3\. This looks slightly different in Windows 10, as it’s
    gained some new options, but the gist is the same.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你决定使用控制台应用程序，我们有一些建议来配置它。你可以通过点击窗口左上角的控制框并选择属性来设置所有这些配置。如图 2.3 所示的对话框。在 Windows
    10 中，它看起来略有不同，因为它增加了一些新选项，但基本原理是相同的。
- en: '![](Images/CH02_F03_Plunk.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH02_F03_Plunk.png)'
- en: Figure 2.3 Configuring the console application’s properties
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.3 配置控制台应用程序属性
- en: On the Options tab, you can increase the size of the Command History Buffer
    Size. This buffer enables the console to remember which commands you’ve typed
    and lets you recall them by using the up and down arrows on your keyboard.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在选项选项卡上，你可以增加命令历史缓冲区的大小。这个缓冲区使控制台能够记住你输入过的命令，并允许你通过使用键盘上的上箭头和下箭头来回忆它们。
- en: On the Font tab, pick something a bit larger than the default 12-point font.
    Please. We don’t care if you have 20/10 vision; jack up the font size a bit. PowerShell
    needs you to be able to quickly distinguish between a lot of similar-looking characters—such
    as `'` (an apostrophe or a single quote) and `` ` `` (a backtick or a grave accent)—and
    a tiny font doesn’t help.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 在字体选项卡上，选择比默认的 12 点字体稍大一些的字体。求你了。我们不在乎你是否有 20/10 的视力；稍微增加字体大小。PowerShell 需要你能够快速区分许多相似外观的字符——例如
    `'`（撇号或单引号）和 `` ` ``（反引号或重音符号）——而小字体无助于此。
- en: On the Layout tab, set both width sizes to the same number and make sure the
    resulting window fits on your screen. Failing to do this can result in a horizontal
    scrollbar at the bottom of the window, which can lead to some PowerShell output
    appearing wrapped off the right side of the window, where you’ll never see it.
    We’ve had students spend half an hour running commands, thinking they were producing
    no output at all, when in fact the output was scrolled off to the right. Annoying.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在布局选项卡上，将两个宽度大小设置为相同的数字，并确保生成的窗口适合你的屏幕。未能做到这一点可能会导致窗口底部出现水平滚动条，这可能导致一些 PowerShell
    输出被包裹在窗口的右侧，你永远看不到。这很烦人。
- en: Finally, on the Colors tab, don’t go nuts. Keep things high contrast and easy
    to read. And if you really want to, you can set the colors to match your Windows
    PowerShell terminal.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在颜色选项卡上，不要太过分。保持高对比度和易于阅读。如果你真的想的话，你可以将颜色设置为与你的 Windows PowerShell 终端匹配。
- en: 'One point to keep in mind: this console application isn’t PowerShell; it’s
    merely the means by which you interact with PowerShell.'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 需要记住的一点是：这个控制台应用程序不是 PowerShell；它只是你与 PowerShell 交互的途径。
- en: NOTE We will not be using Windows PowerShell or the ISE for any part of our
    journey together. The ISE does not support PowerShell 7\. We will instead be using
    Visual Studio Code, which is covered a little later in the chapter.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：在我们的旅程中，我们将不会使用 Windows PowerShell 或 ISE。ISE 不支持 PowerShell 7。我们将改用 Visual
    Studio Code，这在本章稍后会有所介绍。
- en: 2.2 PowerShell on macOS
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.2 macOS 上的 PowerShell
- en: If you’re using a Mac, this section is for you. We’ll talk about how to install
    and run PowerShell specifically on macOS. This book assumes that you know how
    to open Terminal—macOS’s default Terminal application. You can use a different
    terminal on macOS if you have it, but we’ll stick with the default one for this
    book. Okay, let’s install PowerShell!
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是 Mac，这一部分是为你准备的。我们将讨论如何在 macOS 上安装和运行 PowerShell。这本书假设你知道如何打开终端——macOS
    的默认终端应用程序。如果你有其他终端，你也可以使用，但我们将在这本书中坚持使用默认的终端。好，让我们安装 PowerShell！
- en: 2.2.1 Installation on macOS
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.2.1 在 macOS 上的安装
- en: Today, PowerShell does not come included with macOS. Maybe one day that will
    happen, but until then, we have to install it ourselves. Thankfully, it’s easy
    to install and there are many ways to do it. We’ll cover the easiest way to install
    PowerShell for macOS, which is via Homebrew—the preferred package manager for
    macOS. Homebrew provides the ability to install PowerShell via a terminal without
    a single click of our mouse.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，PowerShell 并没有包含在 macOS 中。也许有一天会发生这种情况，但在此之前，我们必须自己安装它。幸运的是，安装很简单，有很多种方法可以做到。我们将介绍在
    macOS 上安装 PowerShell 的最简单方法，即通过 Homebrew——macOS 上的首选包管理器。Homebrew 提供了通过终端安装 PowerShell
    的能力，无需点击鼠标。
- en: Note Homebrew also doesn’t come with macOS, so if you don’t have it already,
    you can head over to Homebrew’s website ([https://brew.sh](https://brew.sh)) for
    instructions on how to install it. Go ahead and get it. We’ll wait for you to
    get back!
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，Homebrew 也没有包含在 macOS 中，所以如果你还没有安装它，你可以访问 Homebrew 的网站 ([https://brew.sh](https://brew.sh))
    获取安装说明。去安装它吧。我们等你回来！
- en: 'Once you have Homebrew installed and ready to go, you can install PowerShell.
    All you need is an instance of `Terminal`, so go ahead and open that on your Mac.
    Leveraging Homebrew, you will install PowerShell in one command:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你安装了 Homebrew 并准备就绪，你就可以安装 PowerShell。你只需要一个 `终端` 实例，所以请打开你的 Mac 上的终端。利用 Homebrew，你将使用一条命令安装
    PowerShell：
- en: '[PRE0]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Type that command into `Terminal` and press `ENTER`. You will then see Homebrew
    install PowerShell (figure 2.4).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 将该命令输入到 `终端` 并按 `回车键`。然后你会看到 Homebrew 正在安装 PowerShell（图 2.4）。
- en: '![](Images/CH02_F04_Plunk.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH02_F04_Plunk.png)'
- en: Figure 2.4 Homebrew installing PowerShell
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.4 Homebrew 安装 PowerShell
- en: 'You’re all set! Let’s run it. What do we run? Great question. To run PowerShell,
    all you do is run the command `pwsh`, which will start PowerShell in your terminal.
    You should see the following output:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经设置好了！让我们运行它。我们要运行什么？这是一个好问题。要运行 PowerShell，你只需运行命令 `pwsh`，这将在你的终端中启动 PowerShell。你应该会看到以下输出：
- en: '[PRE1]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: We now have PowerShell running in the Terminal app on macOS! Well done. This
    is one of the main ways to interact with PowerShell on macOS. We’ll go over the
    other main way in a bit, but first we need to address those of you who are using
    Linux as your operating system.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经在 macOS 的终端应用程序中运行 PowerShell 了！做得好。这是在 macOS 上与 PowerShell 交互的主要方式之一。我们稍后会介绍另一种主要方式，但首先我们需要解决那些使用
    Linux 作为操作系统的人的问题。
- en: 2.3 PowerShell on Linux (Ubuntu 18.04)
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.3 PowerShell 在 Linux（Ubuntu 18.04）上
- en: 'This is the part where we tell you that PowerShell is so awesome that it’s
    able to run on an incredibly long list of Linux distributions. This is also the
    part where we tell you that if we went through the installation of every one of
    those distributions, our publisher would wonder why the book turned into one million
    pages. We’re going to run through how to install PowerShell on Ubuntu 18.04, since
    it was the latest LTS version at the time of writing. If you’re using a machine
    that runs something else, fear not! All the documentation on how to install PowerShell
    on all the different supported Linux distributions can be found in the PowerShell
    docs article on specifically this topic: [http://mng.bz/YgnK](http://mng.bz/YgnK).'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们要告诉你 PowerShell 非常棒，能够在极其广泛的 Linux 发行版上运行的部分。这也是我们要告诉你，如果我们逐一介绍了所有这些发行版的安装过程，我们的出版商会想知道为什么这本书变成了百万页。我们将介绍如何在
    Ubuntu 18.04 上安装 PowerShell，因为它是写作时的最新 LTS 版本。如果你使用的是其他类型的机器，不用担心！有关如何在所有支持的 Linux
    发行版上安装 PowerShell 的所有文档都可以在 PowerShell 文档中找到，具体是关于这个主题的文章：[http://mng.bz/YgnK](http://mng.bz/YgnK)。
- en: All right, now on to the installation. We should also mention . . . this book
    assumes that you know how to open the Terminal application on Ubuntu 18.04\. You
    can use any terminal for these steps, but we’ll stick to the default one.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，现在让我们谈谈安装。我们还应该提到……这本书假设你知道如何在 Ubuntu 18.04 上打开终端应用程序。你可以使用任何终端进行这些步骤，但我们将坚持使用默认的终端。
- en: 2.3.1 Installation on Ubuntu 18.04
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3.1 在 Ubuntu 18.04 上的安装
- en: 'Ubuntu 18.04 ships with Canonical’s own package manager, called `snap`. This
    gives us a single command installation of PowerShell. First, go ahead and open
    up an instance of Terminal and type the following command:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: Ubuntu 18.04 预装了 Canonical 自家的包管理器，称为 `snap`。这使我们能够通过单个命令安装 PowerShell。首先，请打开一个终端实例并输入以下命令：
- en: '[PRE2]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Once you do that, press `ENTER` to run it. You may be asked to put in your
    password, and if so, go ahead and put that in. This is because `snap` needs to
    be run as `root` to install PowerShell. The output you see should look like this:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 完成上述操作后，按 `ENTER` 运行。你可能需要输入密码，如果是这样，请输入。这是因为 `snap` 需要以 `root` 权限运行才能安装 PowerShell。你看到的输出应该看起来像这样：
- en: '[PRE3]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note We are adding `--classic` to the command because PowerShell is considered
    a “classic snap package.” Classic snaps remove the restrictions on snap packages,
    allowing PowerShell to fully interact with the operating system.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：我们在命令中添加了 `--classic`，因为 PowerShell 被视为“经典 snap 包”。经典 snap 包移除了对 snap 包的限制，允许
    PowerShell 完全与操作系统交互。
- en: 'You’re all set! Let’s run it. What do we run? Great question. To run PowerShell,
    all you have to do is run the command `pwsh`, which will start PowerShell in your
    terminal. You should see the following output:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经准备好了！让我们运行它。我们要运行什么？这是一个好问题。要运行 PowerShell，你只需运行命令 `pwsh`，它将在你的终端中启动 PowerShell。你应该会看到以下输出：
- en: '[PRE4]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: We now have PowerShell running in Terminal on Ubuntu 18.04! Well done. This
    is one of the main ways to interact with PowerShell on Ubuntu 18.04\. Now that
    we’ve got it working in the terminal, let’s get the other PowerShell interface
    working.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经在 Ubuntu 18.04 的终端中运行了 PowerShell！做得好。这是在 Ubuntu 18.04 上与 PowerShell 交互的主要方式之一。现在我们已经让它在终端中运行，让我们让其他
    PowerShell 界面也运行起来。
- en: 2.4 Visual Studio Code and the PowerShell extension
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.4 Visual Studio Code 和 PowerShell 扩展
- en: Wait! Don’t run away yet. We know it sounds like we’re asking you to get that
    application that all your C# developer friends use, but it’s just not true! Let
    us explain.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 等等！别急着走。我们知道这听起来像是我们要你安装所有 C# 开发者朋友都在用的那个应用程序，但这并不准确！让我们来解释一下。
- en: 'Microsoft offers two products with very similar names that are completely different
    (the saying “There are two hard problems in tech: cache invalidation, naming things,
    and off-by-1 errors” is true). The first product is one you might have heard of:
    Visual Studio. It’s a full-featured integrated development environment (IDE).
    It’s typically used by C# and F# developers. Visual Studio Code, on the other
    hand, is a completely different application. It’s a lightweight text editor that
    has some resemblance to other text editors like Sublime Text or Notepad++, except
    that it has some added features to enhance the experience.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 微软提供了两个名称非常相似但完全不同的产品（“技术领域有两个难题：缓存失效、命名事物和 off-by-1 错误”这句话是正确的）。第一个产品是你可能听说过的：Visual
    Studio。它是一个功能齐全的集成开发环境（IDE）。它通常被 C# 和 F# 开发者使用。另一方面，Visual Studio Code 是一个完全不同的应用程序。它是一个轻量级的文本编辑器，与
    Sublime Text 或 Notepad++ 等其他文本编辑器有些相似之处，但它增加了一些功能来增强用户体验。
- en: 'One of the added features is extensibility. People can author extensions for
    Visual Studio Code and put them on the Visual Studio Code’s marketplace for other
    folks to consume. The PowerShell team offers an extension for PowerShell on the
    marketplace, and with it comes a whole bunch of nice features that will help you
    along your journey of learning PowerShell. Visual Studio Code with the PowerShell
    extension is the recommended editing experience for PowerShell, and just like
    PowerShell itself, they’re open source and work cross-platform. You can find the
    source code at these locations:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一个新增功能是可扩展性。人们可以为 Visual Studio Code 编写扩展并将其放在 Visual Studio Code 的市场上供其他人使用。PowerShell
    团队在市场上提供了一个 PowerShell 扩展，它带来了一系列有助于你学习 PowerShell 的优秀功能。带有 PowerShell 扩展的 Visual
    Studio Code 是推荐用于 PowerShell 的编辑体验，就像 PowerShell 本身一样，它们都是开源的并且跨平台工作。你可以在以下位置找到源代码：
- en: Visual Studio Code—[https://github.com/Microsoft/vscode](https://github.com/Microsoft/vscode)
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Visual Studio Code—[https://github.com/Microsoft/vscode](https://github.com/Microsoft/vscode)
- en: PowerShell extension—[https://github.com/PowerShell/vscode-powershell](https://github.com/PowerShell/vscode-powershell)
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PowerShell 扩展—[https://github.com/PowerShell/vscode-powershell](https://github.com/PowerShell/vscode-powershell)
- en: This is also a great opportunity for us to say that if you do have any issues
    with those products, open an issue on their respective GitHub pages. That’s the
    best way to give feedback and report problems. All right, let’s get into the installation
    steps.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 这也是我们向大家说明的一个好机会，如果你对那些产品有任何问题，请在它们各自的GitHub页面上打开一个issue。这是提供反馈和报告问题的最佳方式。好的，让我们进入安装步骤。
- en: NOTE Visual Studio Code and the PowerShell extension will be more valuable in
    later chapters when you learn to write scripts. You’ll get there. We promise.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：在后续章节中学习编写脚本时，Visual Studio Code和PowerShell扩展将更有价值。你将会达到那里。我们保证。
- en: What about the PowerShell ISE?
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 那PowerShell ISE呢？
- en: If you already know a thing or two about PowerShell and are familiar with the
    PowerShell ISE, you might be wondering why it’s not being mentioned. The PowerShell
    ISE does not work with PowerShell and is in support mode only, meaning that it
    will only receive security-related updates. The team’s focus has moved to Visual
    Studio Code with the PowerShell extension.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经对PowerShell有所了解，并且熟悉PowerShell ISE，你可能想知道为什么它没有被提及。PowerShell ISE不与PowerShell一起工作，目前只处于支持模式，这意味着它只会接收安全相关的更新。团队的关注点已经转移到带有PowerShell扩展的Visual
    Studio Code上。
- en: 2.4.1 Installing Visual Studio Code and the PowerShell extension
  id: totrans-66
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.1 安装Visual Studio Code和PowerShell扩展
- en: If you’ve gotten this far, you’ve already installed PowerShell on your operating
    system. To install Visual Studio Code, you can use the same steps. For Windows,
    macOS, or Linux, go to [https://code.visualstudio.com/Download](https://code.visualstudio.com/Download)
    and download and run the installer (figure 2.5).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经做到了这一步，你已经在你的操作系统上安装了PowerShell。要安装Visual Studio Code，你可以使用相同的步骤。对于Windows、macOS或Linux，请访问[https://code.visualstudio.com/Download](https://code.visualstudio.com/Download)并下载并运行安装程序（图2.5）。
- en: To add the PowerShell extension, launch VS Code and go to the marketplace.
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要添加PowerShell扩展，启动VS Code并转到市场。
- en: Search for PowerShell and click Install.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索PowerShell并点击安装。
- en: '![](Images/CH02_F05_Plunk.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH02_F05_Plunk.png)'
- en: Figure 2.5 This shows the logo for the extensions and the Install button for
    the PowerShell 7 extension in VS Code.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.5 这显示了VS Code中PowerShell 7扩展的扩展图标和安装按钮。
- en: 'For those of you who prefer the command line, you can also install VS Code
    and the PowerShell Extension via the terminal:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 对于那些喜欢命令行的人来说，你也可以通过终端安装VS Code和PowerShell扩展：
- en: 'macOS: Open `Terminal` and run `brew cask install vscode`.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: macOS：打开`Terminal`并运行`brew cask install vscode`。
- en: 'Ubuntu 18.04: Open `Terminal` and run `snap install code --classic`.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ubuntu 18.04：打开`Terminal`并运行`snap install code --classic`。
- en: 'You’re getting the hang of this! If you’ve done this correctly, running the
    `code` command in the terminal should open an instance of Visual Studio Code.
    If it doesn’t work, close all of your terminal windows, open a new one, and try
    running the `code` command again. Once that’s installed, you need to install the
    PowerShell extension. Since we like typing in the world of PowerShell, let’s install
    the extension in a single command. You can install extensions by using the `code`
    command like so:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你已经掌握了这个！如果你正确地做了，在终端中运行`code`命令应该会打开一个Visual Studio Code的实例。如果不起作用，关闭所有终端窗口，打开一个新的，然后再次尝试运行`code`命令。一旦安装完成，你需要安装PowerShell扩展。由于我们喜欢在PowerShell的世界中打字，让我们用一条命令安装扩展。你可以使用`code`命令安装扩展，如下所示：
- en: '[PRE5]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Which gives you the following output:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这将给出以下输出：
- en: '[PRE6]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Let’s look at the checklist:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看清单：
- en: '[PRE7]'
  id: totrans-80
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We’re ready to see what this all has to offer. If you haven’t already, go ahead
    and open Visual Studio Code by running the `code` command in your terminal.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们准备好看看这一切能提供什么。如果你还没有做，请运行终端中的`code`命令来打开Visual Studio Code。
- en: 2.4.2 Getting familiar with Visual Studio Code
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.2 熟悉Visual Studio Code
- en: From here on, the experiences will be the same regardless of what OS you are
    running. Here we have Visual Studio Code. It might look daunting at first, but
    with a little bit of practice, you’ll be able to harness its power to help you
    write some awesome PowerShell scripts. With Visual Studio Code open, we should
    get it ready to work with PowerShell. Start by clicking on the little PowerShell
    stencil icon on the left side next to the other crazy-looking icons. It’s highlighted
    in figure 2.6.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，无论你运行什么操作系统，体验都将相同。这里我们有Visual Studio Code。一开始可能看起来有些吓人，但经过一点练习，你将能够利用它的力量来帮助你编写一些出色的PowerShell脚本。打开Visual
    Studio Code后，我们应该准备好让它与PowerShell一起工作。首先，点击左侧靠近其他奇怪图标的小PowerShell模板图标。它在图2.6中被突出显示。
- en: '![](Images/CH02_F06_Plunk.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH02_F06_Plunk.png)'
- en: Figure 2.6 Visual Studio Code startup screen
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.6 Visual Studio Code启动屏幕
- en: 'After clicking on the PowerShell icon, a couple of things pop up. Let’s go
    over what we see (figure 2.7):'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 点击PowerShell图标后，会出现几个东西。让我们来看看我们看到的内容（图2.7）：
- en: '*Command Explorer* (A)—A list of commands that are available for you to run.
    When you hover over one, it gives you a few different actions. You can hide this
    by clicking on the PowerShell icon again.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*命令探索器*（A）——可供您运行的命令列表。当您悬停在其中一个上时，它会为您提供几个不同的操作。您可以再次点击PowerShell图标来隐藏它。'
- en: '*Script editor pane* (B)—We won’t be using this until the end of the book,
    but this is where your scripts will appear in different tabs.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*脚本编辑面板*（B）——我们将在本书的结尾使用它，但这是您的脚本将在不同的标签中出现的部分。'
- en: '*Integrated Console* (C)—This is where the magic happens. This is PowerShell.
    You can run commands here just like you did in the PowerShell running in the Terminal
    application.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*集成控制台*（C）——这是魔法发生的地方。这是PowerShell。您可以在这里运行命令，就像您在终端应用程序中运行的PowerShell一样。'
- en: '![](Images/CH02_F07_Plunk.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH02_F07_Plunk.png)'
- en: Figure 2.7 Visual Studio Code with the PowerShell extension breakdown
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.7 带有PowerShell扩展的Visual Studio Code分解图
- en: 'In the top right of the Integrated Console, we see a few different actions.
    Let’s start from the right side. First we see an “x” icon. This will hide the
    Integrated Console and the whole terminal pane. If you ever want to bring it back,
    press Ctrl+`. After that you have the caret (`^`) icon. This will hide the script
    pane and maximize the terminal pane. Then we have trash can icon. This *kills
    terminals*. Repeat after us: “I PROMISE TO NEVER EVER EVER KILL THE POWERSHELL
    INTEGRATED CONSOLE.” The Integrated Console is the heart of the PowerShell extension
    and all its features, and if you kill it, then the extension will stop working—so,
    please, don’t trash the Integrated Console.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在集成控制台的右上角，我们可以看到几个不同的操作。让我们从右侧开始。首先我们看到一个“x”图标。这个图标会隐藏集成控制台和整个终端面板。如果您想再次打开它，请按Ctrl+`。之后，您会看到一个光标（`^`）图标。这个图标会隐藏脚本面板并最大化终端面板。然后我们有一个垃圾桶图标。这个图标会*关闭终端*。请跟着我们重复：
    “我保证永远永远永远不关闭PowerShell集成控制台。” 集成控制台是PowerShell扩展的核心，以及所有其功能，如果您关闭它，那么扩展将停止工作——所以，请，请不要删除集成控制台。
- en: PowerShell Integrated Console vs. a normal terminal?
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell集成控制台与普通终端相比？
- en: 'As we touched on before, the PowerShell Integrated Console is the heart of
    the PowerShell extension. Where do you think the commands in the Command Explorer
    came from? Yep, that’s right—the Integrated Console. There is a plethora of features
    to explore in the extension that depend on the Integrated Console, but just know
    that there’s only one of them. Any other terminal that is spawned, even if it’s
    running PowerShell, is not “integrated.” Remember: Don’t delete the Integrated
    Console.'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们之前提到的，PowerShell集成控制台是PowerShell扩展的核心。您认为命令探索器中的命令是从哪里来的？是的，没错——集成控制台。扩展中有许多功能依赖于集成控制台，但只需知道只有一个。任何其他生成的终端，即使它运行PowerShell，也不是“集成”的。记住：不要删除集成控制台。
- en: Next we have the split terminal button and the plus sign button. These buttons
    spawn additional terminals that can be seen in the drop-down next to them. It’s
    important to note that Visual Studio Code picks Bash as default for these terminals
    since Bash is installed by default. You can easily configure this in your settings,
    but we can come back to that later. In the meantime, if you open a Bash terminal
    in Visual Studio Code, you can type `pwsh` just as you did in the Terminal application,
    and you get PowerShell.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是分割终端按钮和加号按钮。这些按钮会生成额外的终端，可以在它们旁边的下拉菜单中看到。需要注意的是，Visual Studio Code默认为这些终端选择Bash，因为Bash默认安装。您可以在设置中轻松配置此选项，但我们可以稍后再讨论。在此期间，如果您在Visual
    Studio Code中打开Bash终端，您可以像在终端应用程序中一样输入`pwsh`，您就会得到PowerShell。
- en: The Visual Studio Code experience with PowerShell is heavily catered toward
    writing PowerShell scripts and modules, while the PowerShell in a Terminal application
    is an experience more for running through a few quick commands or long-running
    tasks. They both serve their purpose, and we’ll see more of them throughout the
    book.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 使用PowerShell的Visual Studio Code体验主要针对编写PowerShell脚本和模块，而终端应用程序中的PowerShell则是一个更适用于运行几个快速命令或长时间运行任务的体验。它们都各司其职，我们将在本书中看到更多关于它们的内容。
- en: 2.4.3 Customizing Visual Studio Code and the PowerShell extension
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4.3 自定义Visual Studio Code和PowerShell扩展
- en: Like we said earlier, extensibility is a big deal to Visual Studio Code. As
    such, it’s very easy to customize Visual Studio Code and the PowerShell extension
    to your liking. We’ll go through a few things you can do—some useful, others just
    for fun!
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前所说的，可扩展性对 Visual Studio Code 来说非常重要。因此，很容易根据您的喜好自定义 Visual Studio Code
    和 PowerShell 扩展。我们将介绍您可以执行的一些操作——有些很有用，有些只是为了娱乐！
- en: First, let’s start with Visual Studio Code’s Settings page. We’ll be able to
    configure just about anything we want. Go to File > Preferences > Settings to
    open the Settings page (figure 2.8). From here you can search for anything you’d
    like in the search box, or just scroll through everything. There’s a lot to configure!
    If you’re curious what settings the PowerShell extension provides, all you have
    to do is search for `powershell`, and you’ll see them all.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们从 Visual Studio Code 的设置页面开始。我们将能够配置我们想要的几乎所有内容。转到文件 > 预设 > 设置以打开设置页面（图
    2.8）。从这里您可以在搜索框中搜索任何您想要的内容，或者简单地滚动浏览所有内容。有很多可以配置的！如果您对 PowerShell 扩展提供的设置感兴趣，只需搜索
    `powershell`，您就会看到所有设置。
- en: '![](Images/CH02_F08_Plunk.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH02_F08_Plunk.png)'
- en: Figure 2.8 Visual Studio Code’s Settings page. We’ve outlined where to see the
    JSON version of the settings.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.8 Visual Studio Code 的设置页面。我们已概述了查看设置 JSON 版本的位置。
- en: You might notice that we outlined a button in this screenshot. If you click
    on this, you’ll get a JavaScript Object Notation (JSON) representation of the
    settings that you have set. If you’re not already familiar with JSON, don’t worry.
    You can use the regular setting window to do just about everything the JSON view
    can do.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能会注意到我们在截图中突出显示了一个按钮。如果您点击此按钮，您将获得您已设置的设置的 JavaScript 对象表示法（JSON）。如果您不熟悉 JSON，不要担心。您可以使用常规设置窗口执行
    JSON 视图可以做的几乎所有操作。
- en: Table 2.1 shows a list of commonly used settings that you can paste right into
    the search box and configure to your liking.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 表 2.1 显示了一组您可以直接粘贴到搜索框中并根据您的喜好配置的常用设置。
- en: Table 2.1 Recommended settings
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 表 2.1 推荐设置
- en: '| Setting | Description |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| 设置 | 描述 |'
- en: '| Tab Completion | The Tab Completion setting helps replicate the experience
    you get from PowerShell in the regular terminal. You’ll learn more about this
    concept later, but you might find this setting useful. |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '| Tab Completion | Tab 完成设置有助于复制您在常规终端中从 PowerShell 获得的经验。您将在稍后了解更多关于这个概念的信息，但您可能会发现这个设置很有用。|'
- en: '| Terminal.Integrated.Shell.WindowsTerminal.Integrated.Shell.OSX Terminal.Integrated.Shell.Linux
    | If you remember earlier in this chapter, when we press the “+” sign in the terminal
    part of Visual Studio Code, it opened Bash. This is because the default terminal
    on macOS and Linux is Bash. You can change this to PowerShell by changing this
    setting to `pwsh`. |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| Terminal.Integrated.Shell.WindowsTerminal.Integrated.Shell.OSX Terminal.Integrated.Shell.Linux
    | 如果您记得在本章前面的内容，当我们按下 Visual Studio Code 终端部分的“+”号时，它会打开 Bash。这是因为 macOS 和 Linux
    的默认终端是 Bash。您可以通过将此设置更改为 `pwsh` 来将其更改为 PowerShell。|'
- en: '| Files.Default Language | When you open a new file in Visual Studio Code,
    it assumes that it is plain text. You can change this behavior by changing the
    Default Language setting. Changing this to `powershell` will ensure that new files
    will be PowerShell files and will give you all the PowerShell extension features.
    |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '| Files.Default Language | 当您在 Visual Studio Code 中打开新文件时，它假定它是纯文本。您可以通过更改默认语言设置来更改此行为。将此更改为
    `powershell` 将确保新文件将是 PowerShell 文件，并为您提供所有 PowerShell 扩展功能。|'
- en: Another thing you can change about Visual Studio Code is the color theme. The
    default dark theme is nice, but you have a plethora of options out there if you’d
    like to go digging for the theme that fits you perfectly. It’s easy to change—all
    we have to do is open the Command Palette. To do this, press CMD+SHIFT+P on macOS
    or CTRL+SHIFT+P on Windows/Linux (alternatively, you can press F1 on either platform).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以更改关于 Visual Studio Code 的另一件事，那就是颜色主题。默认的深色主题很漂亮，但如果您想寻找一个完美匹配的主题，那么您有很多选择。更改起来很简单——我们只需要打开命令面板。为此，在
    macOS 上按 CMD+SHIFT+P，在 Windows/Linux 上按 CTRL+SHIFT+P（或者您可以在任一平台上按 F1）。
- en: '![](Images/CH02_F09_Plunk.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH02_F09_Plunk.png)'
- en: Figure 2.9 Visual Studio Code’s Command Palette. Search for actions you want
    to take.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.9 Visual Studio Code 的命令面板。搜索您要执行的操作。
- en: 'The Command Palette (figure 2.9) is one of the most useful features of Visual
    Studio Code, as it allows you to search for actions that you can take. The action
    we want to take is “changing the color theme,” so let’s just search for `theme`
    in the Command Palette. You should see an option called Preferences: Color Theme—click
    that. This gives you a list of theme choices that you have available (figure 2.10).
    Use the arrow keys to go through the themes; you’ll notice the theme of Visual
    Studio Code gets updated automatically, so you can see what you’re getting into
    before you commit.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 命令面板（图2.9）是Visual Studio Code最有用的功能之一，因为它允许你搜索可以执行的操作。我们想要执行的操作是“更改颜色主题”，所以让我们在命令面板中搜索`theme`。你应该会看到一个名为“首选项：颜色主题”的选项——点击它。这将给你一个可用的主题选择列表（图2.10）。使用箭头键浏览主题；你会注意到Visual
    Studio Code的主题会自动更新，这样你可以在提交之前看到你将得到什么。
- en: '![](Images/CH02_F10_Plunk.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH02_F10_Plunk.png)'
- en: Figure 2.10 Theme selection in Visual Studio Code
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 图2.10 Visual Studio Code中的主题选择
- en: Most in the list are default themes that come with Visual Studio Code; however,
    the PowerShell ISE theme comes with the PowerShell extension. You can search for
    more cool themes on the extension marketplace (we personally like the Horizon
    theme, but that’s just us!) by choosing the Install Additional Color Themes item
    in the list.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 列表中的大多数是Visual Studio Code自带的默认主题；然而，PowerShell ISE主题是随着PowerShell扩展一起提供的。你可以在扩展市场中搜索更多酷炫的主题（我们个人喜欢Horizon主题，但那只是我们个人喜好！），通过在列表中选择“安装更多颜色主题”项。
- en: Try it Now For the remainder of this book, we’ll assume you’re using Visual
    Studio Code with the PowerShell extension and not some other scripting editor
    when you need to write or examine a script. Go ahead and configure the settings
    and your color theme to your liking if you so choose. If you decide to use PowerShell
    in a Terminal application instead, you’ll be fine—most everything in the book
    will still work. We’ll let you know if something is console-only or editor-only.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 现在试试看对于本书的剩余部分，我们将假设你在使用带有PowerShell扩展的Visual Studio Code，而不是其他脚本编辑器来编写或检查脚本。如果你愿意，可以配置设置和你的颜色主题。如果你决定在终端应用程序中使用PowerShell，你也会做得很好——本书中的大多数内容仍然有效。如果有什么是仅控制台或仅编辑器特有的，我们会告诉你。
- en: 2.5 It’s typing class all over again
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.5 再次是打字课
- en: PowerShell is a command-line interface, and that means you’ll do a lot of typing.
    Typing leaves room for errors—typos. Fortunately, both PowerShell applications
    provide ways to help minimize typos.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: PowerShell是一个命令行界面，这意味着你将进行大量的输入。输入会留下出错的空间——打字错误。幸运的是，PowerShell应用程序都提供了帮助最小化打字错误的方法。
- en: Try it Now The following examples are impossible to illustrate in a book, but
    they’re cool to see in action. Consider following along in your own copy of the
    shell.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 现在试试看以下示例在书中无法展示，但看到它们在实际操作中的效果是很有趣的。考虑在你的shell副本中跟随操作。
- en: 'The console application supports tab completion in four areas:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 控制台应用程序支持在四个区域进行Tab补全：
- en: Type `Get-P` and press Tab a few times. You’ll notice a list of possible completions.
    As you type more, this list will get smaller, and when PowerShell can guess that
    it must be a certain command, it will complete it for you.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输入`Get-P`并多次按Tab键。你会注意到一个可能的补全列表。随着你输入更多，这个列表会缩小，当PowerShell可以猜测它必须是一个特定的命令时，它会为你完成它。
- en: Type `Dir`, then a space, then `/`, and then press Tab. PowerShell shows you
    the files and folders that you can drill into from this directory.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输入`Dir`，然后一个空格，然后`/`，再按Tab键。PowerShell会显示你可以从该目录深入查看的文件和文件夹。
- en: Type `Get-Proc` and press Tab. Then type a space and a hyphen (`-`). Start pressing
    Tab to see PowerShell’s possible completions for this parameter. You could also
    type part of a parameter name (e.g., `-E`), and press Tab twice to see matching
    parameters. Press Esc to clear the command line.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输入`Get-Proc`并按Tab键。然后输入一个空格和一个连字符（`-`）。开始按Tab键以查看PowerShell为此参数提供的可能补全。你也可以输入参数名称的一部分（例如，`-E`），然后按Tab键两次以查看匹配的参数。按Esc键以清除命令行。
- en: Type `New-I` and press Tab. Type a space, then `-I`, and press Tab again. Type
    another space and press Tab twice. PowerShell shows the legal values for that
    parameter. This works only for parameters that have a predefined set of allowable
    values (the set is called an *enumeration*). Again, press Esc to clear the command
    line; you don’t want to run that command yet.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输入`New-I`并按Tab键。输入一个空格，然后`-I`，再按Tab键。PowerShell会显示该参数的有效值。这仅适用于具有预定义允许值集的参数（该集合称为*枚举*）。再次按Esc键以清除命令行；你还不希望运行该命令。
- en: 'Visual Studio Code with the PowerShell extension offers the editor pane something
    like, and better than, tab completion: IntelliSense. This feature operates in
    all four of the same situations that we showed you for tab completion, except
    that you get a cool little pop-up menu, like the one shown in figure 2.11\. Use
    your arrow keys to scroll up or down and find the item you want, press Tab or
    Enter to select it, and then keep typing.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PowerShell 扩展的 Visual Studio Code 提供的编辑器面板类似于，甚至优于 tab 完成功能：IntelliSense。这个功能在所有四种与
    tab 完成相同的情况下运行，除了你将得到一个酷炫的小弹出菜单，就像图 2.11 中所示的那样。使用你的箭头键向上或向下滚动，找到你想要的项，按 Tab 或
    Enter 键选择它，然后继续输入。
- en: Caution It’s *very, very, very, very, very* important to be *very, very, very,
    very* accurate when you’re typing in PowerShell. In some cases, a single misplaced
    space, quotation mark, or even carriage return can make everything fail. If you’re
    getting errors, double- and triple-check what you’ve typed.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 警告 在 PowerShell 中输入时，**非常、非常、非常、非常、非常**重要的是要**非常、非常、非常、非常**准确。在某些情况下，一个空格、引号，甚至回车符的错误都可能导致一切失败。如果你遇到错误，请仔细检查你输入的内容。
- en: '![](Images/CH02_F11_Plunk.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH02_F11_Plunk.png)'
- en: Figure 2.11 IntelliSense works like tab completion in Visual Studio Code with
    the PowerShell extension. It also shows you information about the item you’re
    completing if it’s available.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2.11 IntelliSense 在 Visual Studio Code 中使用 PowerShell 扩展时，就像 tab 完成一样工作。它还会显示你正在完成的项的相关信息（如果有的话）。
- en: 2.6 What version is this?
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.6 这是哪个版本？
- en: 'With PowerShell, there’s an easy way to check your version. Type `$PSVersionTable`
    and press Enter:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 PowerShell，有一个简单的方法来检查你的版本。输入 `$PSVersionTable` 并按 Enter 键：
- en: '[PRE8]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You’ll immediately see the version number for every PowerShell-related piece
    of technology, including PowerShell itself. If this doesn’t work, or if it doesn’t
    indicate 7.0 or later for `PSVersion`, you’re not using the right version of PowerShell
    for this book. Refer to earlier sections in this chapter (2.2, 2.3, and 2.4, depending
    on your OS) for instructions on getting the most current version of PowerShell.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 你将立即看到与 PowerShell 相关的每一项技术的版本号，包括 PowerShell 本身。如果这不起作用，或者它没有显示 `PSVersion`
    为 7.0 或更高版本，那么你使用的 PowerShell 版本不适合这本书。请参考本章前面的部分（2.2、2.3 和 2.4，取决于你的操作系统）以获取获取最新版本
    PowerShell 的说明。
- en: Try it Now Don’t wait any longer to start using PowerShell. Start by checking
    your version number to ensure it’s at least 7.1\. If it isn’t, don’t go any further
    until you’ve installed at least v7.1.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 现在试试看 不要再等待，开始使用 PowerShell。首先检查你的版本号，确保它至少是 7.1。如果不是，请不要继续，直到你安装了至少 v7.1。
- en: 2.7 Lab
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2.7 实验室
- en: Because this is the book’s first lab, we’ll take a moment to describe how these
    are supposed to work. For each lab, we give you a few tasks that you can try to
    complete on your own. Sometimes we provide a hint or two to get you going in the
    right direction. From there, you’re on your own.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 因为这是本书的第一个实验，我们将花一点时间来描述这些实验应该如何工作。对于每个实验，我们给你一些你可以尝试自己完成的任务。有时我们会提供一两个提示，帮助你找到正确的方向。从那里开始，你就自由发挥了。
- en: We absolutely guarantee that everything you need to know to complete every lab
    is either in that same chapter or covered in a previous chapter (and the previously
    covered information is the stuff for which we’re most likely to give you a hint).
    We’re not saying the answer is in plain sight; most often, a chapter teaches you
    how to discover something on your own, and you have to go through that discovery
    process to find the answer. It might seem frustrating, but forcing yourself to
    do it will absolutely make you more successful with PowerShell in the long run.
    We promise.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们绝对保证，完成每个实验所需了解的一切要么在同一章中，要么在前面的章节中介绍（之前介绍的信息是我们最有可能给你提示的内容）。我们并不是说答案显而易见；通常，一个章节会教你如何自己发现某些东西，你必须通过这个发现过程来找到答案。这可能看起来很令人沮丧，但强迫自己这样做将绝对使你在长期使用
    PowerShell 时更加成功。我们保证。
- en: Keep in mind that you can find sample answers at the end of each chapter. Our
    answers might not exactly match yours, and that will become increasingly true
    as we move on to more complex material. You’ll often find that PowerShell offers
    a half dozen or more ways to accomplish almost anything. We’ll show you the way
    we use the most, but if you come up with something different, you’re not wrong.
    Any way that gets the job done is correct.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，您可以在每个章节的末尾找到示例答案。我们的答案可能不会与您的答案完全一致，而且随着我们转向更复杂的内容，这一点将变得越来越明显。您经常会发现 PowerShell
    提供了六种或更多方式来完成几乎任何任务。我们将向您展示我们最常用的方法，但如果您找到了不同的方法，您并没有做错。任何能完成任务的方法都是正确的。
- en: Note For this lab, you can complete it on any machine running Windows 10, macOS,
    or Linux as long as you have PowerShell 7.1 or higher installed.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：对于这个实验，只要您安装了 PowerShell 7.1 或更高版本，您就可以在任何运行 Windows 10、macOS 或 Linux 的机器上完成它。
- en: 'We’ll start easy: we just want you to get both the console and Visual Studio
    Code with the PowerShell extension set up to meet your needs. Follow these five
    steps:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从简单开始：我们只想确保您已经将控制台和带有 PowerShell 扩展的 Visual Studio Code 设置好，以满足您的需求。请按照以下五个步骤操作：
- en: If you haven’t downloaded and installed everything, go do that.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您还没有下载和安装所有内容，请先完成这一步。
- en: Configure the font and text size in your Terminal application (you may have
    to dig around for this!) and in Visual Studio Code (hint hint . . . it’s a setting!).
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的终端应用程序中（您可能需要查找一下！）和在 Visual Studio Code 中（提示提示……这是一个设置！）配置字体和文本大小。
- en: In Visual Studio Code, maximize the Console pane; remove or leave the Commands
    Explorer at your discretion.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 Visual Studio Code 中，最大化控制台面板；根据您的意愿删除或保留命令资源管理器。
- en: In both applications, type a single quote (`'`) and a backtick (`` ` ``) and
    make sure you can easily tell the difference. On a US keyboard (at least), a backtick
    is on the same key as the tilde (`~`) character, under the Esc key.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这两个应用程序中，输入一个单引号 (`'`) 和一个反引号 (``` ` ```)，并确保您能轻松地区分它们。在美式键盘上（至少是这样），反引号键与波浪号
    (`~`) 字符在同一键上，位于 Esc 键下方。
- en: Also type parentheses `( )`, square brackets `[ ]`, angle brackets `< >`, and
    curly brackets `{}` to make sure the font and size you’ve selected display well,
    so that all of these symbols are immediately distinguishable. If there’s some
    visual confusion about which is which, change fonts or select a bigger font size.
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 还请输入括号 `( )`、方括号 `[ ]`、尖括号 `< >` 和花括号 `{}`，以确保您选择的字体和大小显示良好，这样所有这些符号都可以立即区分开来。如果对哪些符号是哪些符号存在视觉上的混淆，请更改字体或选择更大的字体大小。
- en: We’ve already walked you through how to accomplish most of these steps, so you
    don’t have any answers to check for this lab, other than to be sure you’ve completed
    all five of the steps.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经向您介绍了如何完成这些步骤中的大多数，所以您不需要检查这个实验的任何答案，只需确保您已经完成了所有五个步骤。
