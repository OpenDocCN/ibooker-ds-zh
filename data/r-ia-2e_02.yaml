- en: 1 Introduction to R
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1 R简介
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Installing R and RStudio
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装R和RStudio
- en: Understanding the R language
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解R语言
- en: Running programs
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行程序
- en: In recent years, how we analyze data has changed dramatically. With the advent
    of personal computers and the internet, the sheer volume of data we have available
    has grown enormously. Companies have terabytes of data about the consumers they
    interact with, and governmental, academic, and private research institutions have
    extensive archival and survey data on every manner of research topic. Gleaning
    information (let alone wisdom) from these massive stores of data has become an
    industry in itself. At the same time, presenting the information in easily accessible
    and digestible ways has become increasingly challenging.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，我们分析数据的方式发生了巨大的变化。随着个人电脑和互联网的出现，我们可用的数据量急剧增长。公司拥有与消费者互动的数TB数据，政府、学术和私人研究机构在各个研究主题上都有广泛的存档和调查数据。从这些庞大的数据存储中获取信息（更不用说智慧）已经成为一个行业。同时，以易于访问和易于消化的方式呈现信息变得越来越具有挑战性。
- en: The science of data analysis (statistics, psychometrics, econometrics, and machine
    learning) has kept pace with this explosion of data. Before personal computers
    and the internet, academic researchers developed new statistical methods that
    they published as theoretical papers in professional journals. It could take years
    for programmers to adapt these methods and incorporate them into the statistical
    packages that were widely available to data analysts. Now new methodologies are
    appearing *daily*. Statistical researchers publish new and improved methods, along
    with the code to produce them, on easily accessible websites.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 数据分析的科学（统计学、心理测量学、计量经济学和机器学习）与数据的爆炸性增长保持了同步。在个人电脑和互联网出现之前，学术研究人员开发了新的统计方法，并将它们作为理论论文发表在专业期刊上。程序员可能需要数年才能适应这些方法，并将它们纳入广泛可用的统计软件包中。现在，新的方法每天都在出现。统计研究人员在易于访问的网站上发布新的和改进的方法，以及产生它们的代码。
- en: The advent of personal computers had another effect on the way we analyze data.
    When data analysis was carried out on mainframe computers, computer time was precious
    and difficult to come by. Analysts carefully set up a computer run with all the
    parameters and options they thought would be needed. The resulting output of the
    procedure could be dozens or hundreds of pages long. The analyst sifted through
    this output, extracting useful material and discarding the rest. Many popular
    statistical packages (such as SAS and SPSS) were originally developed during this
    period and still follow this approach to some degree.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 个人电脑的出现对我们分析数据的方式产生了另一种影响。当在大型机上进行数据分析时，计算机时间宝贵且难以获得。分析师们会仔细设置计算机运行，包括他们认为可能需要的所有参数和选项。该程序产生的输出可能长达数十或数百页。分析师会筛选这些输出，提取有用材料并丢弃其余部分。许多流行的统计软件包（如SAS和SPSS）最初是在这个时期开发的，并且在某种程度上仍然遵循这种方法。
- en: With the cheap and easy access afforded by personal computers, the paradigm
    of modern data analysis has shifted. Rather than setting up a complete data analysis
    all at once, the process has become highly interactive, with the output from each
    stage serving as the input for the next stage. Figure 1.1 shows a typical analysis.
    At any point, the cycles may include transforming the data, imputing missing values,
    adding or deleting variables, fitting statistical models, and looping back through
    the whole process again. The process stops when the analyst believes they understand
    the data intimately and have answered all the relevant questions that can be answered.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 由于个人电脑提供的廉价和便捷的访问，现代数据分析的模式已经发生了转变。而不是一次性设置完整的数据分析，这个过程已经变得高度交互式，每个阶段的输出都作为下一阶段的输入。图1.1显示了典型的分析。在任何时候，循环可能包括转换数据、填补缺失值、添加或删除变量、拟合统计模型，并再次通过整个流程。当分析师认为他们已经深入理解了数据并回答了所有可以回答的相关问题时，这个过程才会停止。
- en: '![](Images/CH01_F01_Kabacoff3.png)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH01_F01_Kabacoff3.png)'
- en: Figure 1.1 Steps in a typical data analysis
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.1 典型数据分析步骤
- en: The advent of personal computers (and especially the availability of high-resolution
    monitors) has also affected how results are understood and presented. A picture
    really can be worth a thousand words, and human beings are adept at extracting
    useful information from visual presentations. Modern data analysis increasingly
    relies on graphical presentations to uncover meaning and convey results.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 个人电脑（尤其是高分辨率显示器的可用性）的出现也影响了结果的理解和展示方式。一张图片确实可以胜过千言万语，人类擅长从视觉展示中提取有用信息。现代数据分析越来越多地依赖于图形展示来揭示意义和传达结果。
- en: Data analysts now need to access data from a wide range of sources (database
    management systems, text files, statistical packages, spreadsheets, and web pages),
    merge the pieces of data together, clean and annotate them, analyze them with
    the latest methods, present the findings in meaningful and graphically appealing
    ways, and incorporate the results into attractive reports that can be distributed
    to stakeholders and the public. As you’ll see in this chapter, R is a comprehensive
    software package that’s ideally suited to achieve these goals.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 数据分析师现在需要从广泛的数据源（数据库管理系统、文本文件、统计软件包、电子表格和网页）中获取数据，合并数据片段，清洗和注释它们，使用最新的方法进行分析，以有意义和图形吸引人的方式展示结果，并将结果纳入吸引人的报告中，以便分发给利益相关者和公众。正如你将在本章中看到的，R
    是一个综合性的软件包，非常适合实现这些目标。
- en: 1.1 Why use R?
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.1 为什么使用 R？
- en: R is a language and environment for statistical computing and graphics, similar
    to the S language originally developed at Bell Labs. It’s an open source solution
    to data analysis that’s supported by a large and active worldwide research community.
    But many popular statistical and graphing packages are available (such as Microsoft
    Excel, SAS, IBM SPSS, Stata, and Minitab). Why turn to R?
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: R 是一种用于统计计算和图形的语言和环境，类似于最初在贝尔实验室开发的 S 语言。它是一个开源的数据分析解决方案，得到了一个庞大且活跃的全球研究社区的支撑。但许多流行的统计和绘图软件包也都可以使用（例如
    Microsoft Excel、SAS、IBM SPSS、Stata 和 Minitab）。为什么选择 R？
- en: 'R has many features to recommend it:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: R 有许多值得推荐的特点：
- en: Most commercial statistical software platforms cost thousands, if not tens of
    thousands, of dollars. R is free! If you’re a teacher or a student, the benefits
    are obvious.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大多数商业统计软件平台的价格是数千美元，如果不是数万美元。R 是免费的！如果你是教师或学生，这些好处是显而易见的。
- en: R is a comprehensive statistical platform that offers all manner of data analytic
    techniques. Just about any type of data analysis can be done in R.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 是一个全面的统计平台，提供了各种数据分析技术。几乎任何类型的数据分析都可以在 R 中完成。
- en: R contains advanced statistical routines that are not yet available in other
    packages. In fact, new methods become available for download on a weekly basis.
    If you’re a SAS user, imagine getting a new SAS PROC every few days.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 包含了其他软件包中尚未提供的先进统计程序。实际上，每周都会有新的方法可供下载。如果你是 SAS 用户，想象一下每隔几天就有一个新的 SAS PROC。
- en: R has state-of-the-art graphics capabilities. If you want to visualize complex
    data, R has the most comprehensive and powerful feature set.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 拥有最先进的图形功能。如果你想可视化复杂的数据，R 拥有最全面和强大的功能集。
- en: R is a powerful platform for interactive data analysis and exploration. From
    its inception, it was designed to support the approach outlined in figure 1.1\.
    For example, the results of any analytic step can easily be saved, manipulated,
    and used as input for additional analyses.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 是一个强大的交互式数据分析和平滑探索的平台。从其诞生之初，它就被设计来支持图 1.1 中概述的方法。例如，任何分析步骤的结果都可以轻松保存、操作，并用作其他分析的输入。
- en: Getting data into a usable form from multiple sources can be challenging. R
    can easily import data from a wide variety of sources, including text files, database-management
    systems, statistical packages, and specialized data stores. It can write data
    out to these systems as well. R can also access data directly from web pages,
    social media sites, and a wide range of online data services.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从多个来源获取可用的数据可能具有挑战性。R 可以轻松地从各种来源导入数据，包括文本文件、数据库管理系统、统计软件包和专门的数据存储。它还可以将这些系统中的数据写出来。R
    还可以直接从网页、社交媒体网站和广泛的在线数据服务中访问数据。
- en: R provides an unparalleled platform for programming new statistical methods
    in an easy, straightforward manner. It’s easily extensible and provides a natural
    language for quickly programming recently published methods.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 提供了一个无与伦比的编程新统计方法的平台，方式简单直接。它易于扩展，并提供了一种自然语言，可以快速编程最近发表的方法。
- en: R functionality can be integrated into applications written in other languages,
    including C++, Java, Python, PHP, Pentaho, SAS, and SPSS. This allows you to continue
    working in a language that you are familiar with while adding R’s capabilities
    to your applications.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R的功能可以集成到用其他语言编写的应用程序中，包括C++、Java、Python、PHP、Pentaho、SAS和SPSS。这允许你在熟悉的语言中继续工作，同时将R的功能添加到你的应用程序中。
- en: R runs on a wide array of platforms, including Windows, Unix, and macOS. It’s
    likely to run on any computer you may have. (I’ve even come across guides for
    installing R on an iPhone, which is impressive, but probably not a good idea.)
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R可以在包括Windows、Unix和macOS在内的多种平台上运行。它很可能在你的任何一台电脑上都能运行。（我甚至见过安装R在iPhone上的指南，这很令人印象深刻，但可能不是一个好主意。）
- en: If you don’t want to learn a new language, a variety of graphic user interfaces
    (GUIs) are available, offering the power of R through menus and dialogs.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你不想学习一门新语言，有许多图形用户界面（GUIs）可供选择，它们通过菜单和对话框提供R的强大功能。
- en: You can see an example of R’s graphic capabilities in figure 1.2\. This graph
    describes the relationships between years of experience and wages for men in women
    in six industries, collected from the US Current Population Survey in 1985\. Technically,
    it’s a matrix of scatterplots with gender displayed by color and symbol. Trends
    are described using linear regression lines. If these terms *scatterplot* and
    *regression* *lines* are unfamiliar to you, don’t worry. We’ll cover them in later
    chapters.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在图1.2中看到R的图形功能示例。这张图描述了六个行业中男性和女性工作经验与工资之间的关系，数据来自1985年的美国人口普查。从技术上讲，这是一个散点矩阵图，性别通过颜色和符号来表示。趋势是通过线性回归线来描述的。如果你对“散点图”和“回归线”这些术语不熟悉，不要担心。我们将在后面的章节中介绍它们。
- en: '![](Images/CH01_F02_Kabacoff3.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH01_F02_Kabacoff3.png)'
- en: Figure 1.2 Relationships between wages and years of experience for men and women
    in six industries. Graphs like this can be created easily with a few lines of
    code in R (graph created with `mosaicData` package).
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.2 六个行业中男性和女性工资与工作经验之间的关系。这样的图表可以用R中几行代码轻松创建（使用`mosaicData`包创建的图表）。
- en: Some of the more interesting findings from this graph are
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 从这张图中可以得出的更有趣的发现是
- en: The relationship between experience and wages varies by both gender and industry.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 经验与工资之间的关系因性别和行业而异。
- en: In the service industry, wages do not appear to go up with experience for either
    men or women.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在服务业，无论是男性还是女性，工资似乎并不随着经验的增加而提高。
- en: In management positions, wages tend to go up with experience for men, but not
    for women.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在管理职位上，男性的工资往往随着经验的增加而提高，但女性的工资则不然。
- en: Are these differences real, or can they be explained as chance sampling variation?
    We'll discuss this further in chapter 8\. The important point is that R allows
    you to create elegant, informative, highly customized graphs in a simple and straightforward
    fashion. Creating similar plots in other statistical languages would be difficult,
    time-consuming, or impossible.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这些差异是真实的，还是可以解释为随机抽样变异？我们将在第8章中进一步讨论这个问题。重要的是，R允许你以简单直接的方式创建优雅、信息丰富、高度定制的图表。在其他统计语言中创建类似的图表可能会很困难、耗时或不可能。
- en: Unfortunately, R can have a steep learning curve. Because it can do so much,
    documentation and help files are voluminous. Additionally, because much of the
    functionality comes from optional modules created by independent contributors,
    this documentation can be scattered and difficult to locate. In fact, getting
    a handle on all that R can do is challenging.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，R的学习曲线可能很陡峭。因为它可以做很多事情，所以文档和帮助文件非常庞大。此外，由于许多功能来自独立贡献者创建的可选模块，这些文档可能分散且难以找到。实际上，掌握R能做什么是一项挑战。
- en: The goal of this book is to make access to R quick and easy. We’ll tour the
    many features of R, covering enough material to get you started on your data,
    with pointers on where to go when you need to learn more. Let’s begin by installing
    the program.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书的目标是让访问R变得快速和简单。我们将浏览R的许多功能，涵盖足够的材料来帮助你开始数据处理，并提供当你需要学习更多时去哪里学习的指南。让我们从安装程序开始吧。
- en: 1.2 Obtaining and installing R
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.2 获取和安装R
- en: R is freely available from the Comprehensive R Archive Network (CRAN) at [https://cran.r-project.org](https://cran.r-project.org).
    Precompiled binaries are available for Linux, macOS, and Windows. Follow the directions
    for installing the base product on the platform of your choice. Later, we’ll talk
    about adding functionality through optional modules called packages (also available
    from CRAN).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: R 可从综合 R 存档网络（CRAN）免费获得，网址为 [https://cran.r-project.org](https://cran.r-project.org)。预编译的二进制文件适用于
    Linux、macOS 和 Windows。请按照你选择平台上的安装说明安装基本产品。稍后，我们将讨论通过可选模块（也称为包）添加功能，这些包也来自 CRAN。
- en: 1.3 Working with R
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.3 使用 R
- en: R is a case-sensitive, interpreted language. You can enter commands one at a
    time at the command prompt (`>`) or run a set of commands from a source file.
    There are a wide variety of data types, including vectors, matrices, data frames
    (similar to datasets), and lists (collections of objects). I’ll discuss each of
    these data types in chapter 2.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: R 是一个区分大小写的解释型语言。你可以在命令提示符（`>`）中逐个输入命令，或者从一个源文件中运行一组命令。它有各种各样的数据类型，包括向量、矩阵、数据框（类似于数据集）和列表（对象的集合）。我将在第
    2 章中讨论这些数据类型。
- en: Most functionality is provided through built-in and user-created functions and
    the creation and manipulation of objects. An *object* is basically anything that
    can be assigned a value. For R, that is just about everything (data, functions,
    graphs, analytic results, and more). Every object has a *class attribute* (basically
    one or more associated text descriptors) that tells R how to print, plot, summarize,
    or in some other way manipulate the object.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数功能都是通过内置和用户创建的函数以及对象的创建和操作来提供的。一个 *对象* 基本上是可以赋予值的任何东西。对于 R 来说，这几乎包括一切（数据、函数、图表、分析结果等等）。每个对象都有一个
    *类属性*（基本上是一个或多个相关的文本描述符），它告诉 R 如何打印、绘图、总结或以其他方式操作该对象。
- en: All objects are kept in memory during an interactive session. Basic functions
    are available by default. Other functions are contained in packages that can be
    attached to a current session as needed.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在交互式会话期间，所有对象都保存在内存中。基本函数默认可用。其他函数包含在可以按需附加到当前会话的包中。
- en: Statements consist of functions and assignments. R uses the symbol `<-` for
    assignments, rather than the typical `=` sign. For example, the statement
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 语句由函数和赋值组成。R 使用 `<-` 符号进行赋值，而不是典型的 `=` 符号。例如，以下语句
- en: '[PRE0]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: creates a vector object named `x` that contains five random deviates from a
    standard normal distribution.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个名为 `x` 的向量对象，其中包含来自标准正态分布的五个随机偏差值。
- en: NOTE R allows the `=` sign to be used for object assignments. That said, you
    won’t find many programs written that way because it’s not standard syntax, it
    won’t work in some situations, and R programmers will make fun of you. You can
    also reverse the assignment direction. For instance, `rnorm(5)` `->` `x` is equivalent
    to the previous statement. Again, doing so is uncommon and isn’t recommended in
    this book.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 注意 R 允许使用 `=` 符号进行对象赋值。尽管如此，你不会发现很多程序是这样编写的，因为这不是标准语法，在某些情况下可能无法工作，而且 R 程序员会取笑你。你还可以反转赋值方向。例如，`rnorm(5)`
    `->` `x` 等同于前面的语句。再次强调，这样做并不常见，本书也不推荐这样做。
- en: Comments are preceded by the `#` symbol. The R interpreter ignores any text
    appearing after the `#`. An example program is given in section 1.3.1.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 注释以 `#` 符号开头。R 解释器会忽略 `#` 符号后面的任何文本。一个示例程序在第 1.3.1 节中给出。
- en: 1.3.1 Getting started
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.1 开始使用
- en: The first step in using R is, of course, installing it. Instructions are provided
    on CRAN. Once R is installed, start it up. If you’re using Windows, launch R from
    the Start menu. On a Mac, double-click the R icon in the Applications folder.
    For Linux, type `R` at the command prompt of a terminal window. Any of these will
    start the R interface (see figure 1.3 for an example).
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 R 的第一步当然是安装它。安装说明可在 CRAN 上找到。一旦安装了 R，启动它。如果你使用 Windows，可以从开始菜单启动 R。在 Mac
    上，双击应用程序文件夹中的 R 图标。在 Linux 上，在终端窗口的命令提示符中输入 `R`。这些操作中的任何一个都会启动 R 界面（见图 1.3 中的示例）。
- en: '![](Images/CH01_F03_Kabacoff3.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH01_F03_Kabacoff3.png)'
- en: Figure 1.3 Example of the R interface on Windows
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.3 Windows 上 R 界面的示例
- en: To get a feel for the interface, let’s work through a simple example. Say you’re
    studying physical development, and you’ve collected the ages and weights of 10
    infants in
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 为了了解界面，让我们通过一个简单的例子来操作。假设你正在研究身体发展，并且你已经收集了 10 个婴儿的年龄和体重
- en: their first year of life (see table 1.1). You’re interested in the distribution
    of the weights and their relationship to age.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 他们生命中的第一年（见表 1.1）。你感兴趣的是体重的分布及其与年龄的关系。
- en: Table 1.1 The ages and weights of 10 infants
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 表 1.1 10 名婴儿的年龄和体重
- en: '| Age (mo.) | Weight (kg.) |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| 年龄（月） | 体重（kg） |'
- en: '| 01 | 4.4 |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| 01 | 4.4 |'
- en: '| 03 | 5.3 |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| 03 | 5.3 |'
- en: '| 05 | 7.2 |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| 05 | 7.2 |'
- en: '| 02 | 5.2 |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| 02 | 5.2 |'
- en: '| 11 | 8.5 |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| 11 | 8.5 |'
- en: '| 09 | 7.3 |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| 09 | 7.3 |'
- en: '| 03 | 6.0 |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 03 | 6.0 |'
- en: '| 09 | 10.4 |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 09 | 10.4 |'
- en: '| 12 | 10.2 |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 12 | 10.2 |'
- en: '| 03 | 6.1 |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 03 | 6.1 |'
- en: '| Note: These are fictional data. |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| 注意：这些数据是虚构的。 |'
- en: Listing 1.1 shows the analysis. Age and weight data are entered as vectors using
    the function `c()`, which combines its arguments into a vector or list. The mean
    and standard deviation of the weights, along with the correlation between age
    and weight, are provided by the functions `mean()`, `sd()`, and `cor()`, respectively.
    Finally, age is plotted against weight using the `plot()` function, allowing you
    to visually inspect the trend. The `q()` function ends the session and lets you
    quit.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 1.1 展示了分析。年龄和体重数据使用函数 `c()` 作为向量输入，该函数将其参数组合成一个向量或列表。体重的平均值和标准差，以及年龄和体重之间的相关性，分别由函数
    `mean()`、`sd()` 和 `cor()` 提供。最后，使用 `plot()` 函数将年龄与体重绘制在一起，允许你直观地检查趋势。`q()` 函数结束会话并允许你退出。
- en: Listing 1.1 A sample R session
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 1.1 一个示例 R 会话
- en: '[PRE1]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: You can see from listing 1.1 that the mean weight for these 10 infants is 7.06
    kilograms, that the standard deviation is 2.08 kilograms, and that there is strong
    linear relationship between age in months and weight in kilograms (correlation
    = 0.91). The relationship can also be seen in the scatter plot in figure 1.4\.
    Not surprisingly, as infants get older, they tend to weigh more.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 从列表 1.1 可以看出，这 10 名婴儿的平均体重为 7.06 千克，标准差为 2.08 千克，年龄（以月为单位）和体重（以千克为单位）之间存在强烈的线性关系（相关系数
    = 0.91）。这种关系也可以在图 1.4 的散点图中看到。不出所料，随着婴儿的成长，他们往往会变得更重。
- en: '![](Images/CH01_F04_Kabacoff3.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH01_F04_Kabacoff3.png)'
- en: Figure 1.4 Scatter plot of infant weight (kg.) by age (mo.)
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.4 婴儿体重（kg）与年龄（月）的散点图
- en: The scatter plot in figure 1.4 is informative, but somewhat utilitarian and
    unattractive. In later chapters, you’ll see how to create more attractive and
    sophisticated graphs.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.4 中的散点图很有信息量，但有些实用且不够吸引人。在后面的章节中，你将了解到如何创建更吸引人和复杂的图表。
- en: TIP To get a sense of what R can do graphically, take a look at the graphs described
    in Data Visualization with R ([http://rkabacoff.github.io/datavis](http://rkabacoff.github.io/datavis))
    and The Top 50 ggplot2 Visualizations – The Master List ([http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html](http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html)).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 提示：为了了解 R 在图形方面的能力，请参阅《使用 R 进行数据可视化》（[http://rkabacoff.github.io/datavis](http://rkabacoff.github.io/datavis)）和《Top
    50 ggplot2 可视化 – 主列表》（[http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html](http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html)）中描述的图表。
- en: 1.3.2 Using RStudio
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.2 使用 RStudio
- en: The standard interface to R is very basic, offering little more than a command
    prompt for entering lines of code. For real-life projects, you'll want a more
    comprehensive tool for writing code and viewing output. Several such tools, called
    Integrated Development Environments (IDEs), have been developed for R, including
    Eclipse with StatET, Visual Studio for R, and RStudio Desktop.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: R 的标准接口非常基础，仅提供用于输入代码行的命令提示符。对于实际项目，你可能需要一个更全面的工具来编写代码和查看输出。为 R 开发了几个这样的工具，称为集成开发环境（IDE），包括带有
    StatET 的 Eclipse、R 的 Visual Studio 和 RStudio 桌面版。
- en: RStudio Desktop ([https://www.rstudio.com](https://www.rstudio.com)) is by far
    the most popular choice. It provides a multiwindow, multitabbed environment with
    tools for importing data, writing clean code, debugging errors, visualizing output,
    and writing reports.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: RStudio 桌面版（[https://www.rstudio.com](https://www.rstudio.com)）无疑是最受欢迎的选择。它提供了一个多窗口、多标签的环境，包括导入数据、编写整洁代码、调试错误、可视化输出和编写报告的工具。
- en: RStudio is freely available as an open source product and is easily installed
    on Windows, Mac, and Linux. Since RStudio is an interface to R, be sure to install
    R before installing RStudio Desktop.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: RStudio 作为开源产品免费提供，并且可以轻松安装在 Windows、Mac 和 Linux 上。由于 RStudio 是 R 的接口，因此在安装
    RStudio 桌面版之前，请确保已安装 R。
- en: TIP You can customize the RStudio interface by selecting the Tools> Global Options
    ... from the menu bar. On the General tab, I recommend unchecking Restore .RData
    into Workspace at Startup and selecting Never for Save Workspace to .RData on
    Exit. This will ensure a clean startup each time you run RStudio.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: TIP 您可以通过从菜单栏中选择工具>全局选项...来自定义 RStudio 界面。在常规选项卡中，我建议取消选中启动时恢复 .RData 到工作区，并将保存工作区到
    .RData 设置为永不。这将确保每次运行 RStudio 时都有一个干净的启动。
- en: Let's rerun the code from listing 1.1 using RStudio. If you’re using Windows,
    launch RStudio from the Start menu. On a Mac, double-click the RStudio icon in
    the Applications folder. For Linux, type `rstudio` at the command prompt of a
    terminal window. The same interface will appear on all three platforms (see figure
    1.5).
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用 RStudio 重新运行列表 1.1 中的代码。如果您使用的是 Windows，请从开始菜单启动 RStudio。在 Mac 上，双击应用程序文件夹中的
    RStudio 图标。在 Linux 上，在终端窗口的命令提示符中输入 `rstudio`。这三个平台都将显示相同的界面（见图 1.5）。
- en: '![](Images/CH01_F05_Kabacoff3.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![图像](Images/CH01_F05_Kabacoff3.png)'
- en: Figure 1.5 RStudio Desktop
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.5 RStudio 桌面
- en: Script window
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 脚本窗口
- en: From the File menu, select New File > R Script. A new script window will open
    in the upper left-hand corner of the screen (figure 1.5 A). Type the code from
    listing 1.1\. into this window.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 从文件菜单中选择新建文件> R 脚本。一个新的脚本窗口将在屏幕的右上角打开（见图 1.5 A）。将列表 1.1 中的代码输入到这个窗口中。
- en: As you type, the editor offers syntax highlighting and code completion (see
    figure 1.6). For example, as you type `plot` a pop-up window will appear with
    all functions that start with the letters that you've typed so far. You can use
    the up and down arrow keys to select a function from the list and press Tab to
    select it. Within functions (parentheses), press Tab to see function options.
    Within quote marks, press Tab to complete file paths.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 当您键入时，编辑器提供语法高亮和代码补全（见图 1.6）。例如，当您键入 `plot` 时，将出现一个弹出窗口，显示所有以您已键入的字母开头的函数。您可以使用上箭头和下箭头键从列表中选择一个函数，并按
    Tab 键选择它。在函数（括号内）中按 Tab 键查看函数选项。在引号内按 Tab 键完成文件路径。
- en: '![](Images/CH01_F06_Kabacoff3.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![图像](Images/CH01_F06_Kabacoff3.png)'
- en: Figure 1.6 Script window
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.6 脚本窗口
- en: To execute code, highlight/select it and click the Run button or press Ctrl+Enter.
    Pressing Ctrl+Shift+Enter will run the entire script.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行代码，请突出显示/选择它并点击运行按钮或按 Ctrl+Enter。按 Ctrl+Shift+Enter 将运行整个脚本。
- en: To save the script, press the Save icon or select File > Save from the menu
    bar. Select a name and location from the dialog box that opens. By convention,
    script files end with a .R extension. The name of the script file will appear
    in the window tab in a red starred format if the current version has not been
    saved.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 要保存脚本，请按保存图标或从菜单栏中选择文件>保存。从打开的对话框中选择名称和位置。按照惯例，脚本文件以 .R 扩展名结尾。如果当前版本尚未保存，脚本文件名将以红色带星号的形式出现在窗口选项卡中。
- en: Console window
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 控制台窗口
- en: Code runs in the console window (figure 1.5 B). This is basically the same console
    you would see if you were using the basic R interface. You can submit code from
    a script window with a Run command or enter interactive commands directly in this
    window at the command prompt (>).
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 代码在控制台窗口中运行（见图 1.5 B）。这基本上与您使用基本 R 界面时看到的控制台相同。您可以使用运行命令从脚本窗口提交代码，或者直接在此窗口的命令提示符（>）中输入交互式命令。
- en: If the command prompt changes to a plus (+) sign, the interpreter is waiting
    for a complete statement. This will often happen if the statement is too long
    for one line or if there are mismatched parentheses in the code. You can get back
    to the command prompt by pressing the Esc key.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 如果命令提示符变为加号（+），则解释器正在等待一个完整的语句。如果语句太长而无法在一行中显示，或者代码中有不匹配的括号，这通常会发生。按 Esc 键可以返回到命令提示符。
- en: Additionally, pressing the up and down arrow keys will cycle through past commands.
    You can edit a command and resubmit it with the Enter key. Clicking on the broom
    icon clears text from the window.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，按上箭头和下箭头键将循环显示过去的命令。您可以使用 Enter 键编辑一个命令并重新提交它。点击扫帚图标将清除窗口中的文本。
- en: Environment and history windows
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 环境和历史窗口
- en: Any objects that were created (in this example, `age` and `weight`) will appear
    in the Environment window (see figure 1.5 C). A record of executed commands will
    be saved in the History window (the tab to the right of Environment).
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 创建的任何对象（例如，本例中的 `age` 和 `weight`）将出现在环境窗口中（见图 1.5 C）。执行命令的记录将被保存在历史窗口中（环境选项卡右侧）。
- en: Plot window
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 绘图窗口
- en: Any plots that are created from the script will appear in the plot window (figure
    1.5 D). The toolbar for this window allows you to cycle through the graphs that
    have been created. In addition, you can open a zoom window to see the graph at
    different sizes, export the graphs in several formats, and delete one or all the
    graphs you’ve created so far.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 从脚本中创建的任何图表都将出现在图表窗口中（图 1.5 D）。此窗口的工具栏允许您在已创建的图表之间切换。此外，您还可以打开缩放窗口以查看不同大小的图表，以多种格式导出图表，以及删除您迄今为止创建的一个或所有图表。
- en: 1.3.3 Getting help
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.3 获取帮助
- en: R provides extensive help facilities, and learning to navigate them will help
    you significantly in your programming efforts. The built-in help system provides
    details, references, and examples of any function contained in a currently installed
    package. You can obtain help by executing any of functions listed in table 1.2.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: R 提供了广泛的帮助功能，学会如何导航这些功能将大大有助于您的编程工作。内置的帮助系统提供了当前已安装包中任何函数的详细信息、参考和示例。您可以通过执行表
    1.2 中列出的任何函数来获取帮助。
- en: Help is also available through the RStudio interface. In the script window,
    place the cursor on a function name and press F1 to bring up the help window.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 帮助信息也通过 RStudio 界面提供。在脚本窗口中，将光标放在函数名上并按 F1 键可打开帮助窗口。
- en: Table 1.2 R help functions
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 表 1.2 R 帮助函数
- en: '| Function | Action |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '| 函数 | 操作 |'
- en: '| `help.start``()` | General help |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| `help.start()` | 通用帮助 |'
- en: '| `help("*foo*")` or `?*foo*` | Help on function `foo` |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
  zh: '| `help("*foo*")` 或 `?*foo*` | 关于函数 `foo` 的帮助 |'
- en: '| `help(package ="*foo*")` | Help on a package named `foo` |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '| `help(package = "*foo*")` | 帮助信息，关于名为 `foo` 的包 |'
- en: '| `help.search("*foo*")` or `??*foo*` | Searches the help system for instances
    of the string `foo` |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| `help.search("*foo*")` 或 `??*foo*` | 在帮助系统中搜索字符串 `foo` 的实例 |'
- en: '| `example("*foo*")` | Examples of function `foo` (quotation marks optional)
    |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '| `example("*foo*")` | 函数 `foo` 的示例（引号可选）|'
- en: '| `data()` | Lists all available example datasets contained in currently loaded
    packages |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| `data()` | 列出当前已加载包中包含的所有可用示例数据集 |'
- en: '| `vignette()` | Lists all available vignettes for currently installed packages
    |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '| `vignette()` | 列出当前已安装包中所有可用的 vignette |'
- en: '| `vignette("*foo*")` | Displays specific vignettes for topic `foo` |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| `vignette("*foo*")` | 显示特定于主题 `foo` 的 vignette |'
- en: The function `help.start()` opens a browser window with access to introductory
    and advanced manuals, FAQs, and reference materials. Alternatively, choose Help
    > R Help from the menu. The vignettes returned by the `vignette()` function are
    practical introductory articles provided in PDF or HTML format. Not all packages
    have vignettes.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 函数 `help.start()` 打开一个浏览器窗口，可以访问入门和高级手册、常见问题解答和参考材料。或者，从菜单中选择帮助 > R 帮助。`vignette()`
    函数返回的 vignette 是以 PDF 或 HTML 格式提供的实用入门文章。并非所有包都有 vignette。
- en: All help files have a similar format (see figure 1.7). The help page has a title
    and brief description, followed by the function's syntax and options. Computational
    details are provided in the Details section. The See Also section describes and
    links to related functions. The help page almost always ends with examples illustrating
    typical uses of the function.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 所有帮助文件都有类似的格式（见图 1.7）。帮助页面包含标题和简要描述，随后是函数的语法和选项。计算细节在“详细信息”部分提供。在“相关内容”部分描述并链接到相关函数。帮助页面几乎总是以说明函数典型用法的示例结束。
- en: '![](Images/CH01_F07_Kabacoff3.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH01_F07_Kabacoff3.png)'
- en: Figure 1.7 Help window
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.7 帮助窗口
- en: As you can see, learning to navigate R’s extensive help facilities will definitely
    aid your programming efforts. It’s a rare session that I don’t use ? to look up
    the features (such as options or return values) of some function.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，学会如何导航 R 的广泛帮助功能无疑将有助于您的编程工作。我很少不使用 `?` 来查找某些函数的功能（如选项或返回值）。
- en: 1.3.4 The workspace
  id: totrans-115
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.4 工作空间
- en: The workspace is your current R working environment and includes any user-defined
    objects (vectors, matrices, functions, data frames, and lists). The current working
    directory is the directory from which R will read files and to which it will save
    results by default. You can identify the current working directory by using the
    `getwd()` function. You can set the current working directory by using the `setwd()`
    function. If you need to input a file that isn’t in the current working directory,
    use the full pathname in the call. Always enclose the names of files and directories
    from the operating system in quotation marks. Table 1.3 lists some standard commands
    for managing your workspace.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 工作空间是当前R工作环境，包括任何用户定义的对象（向量、矩阵、函数、数据框和列表）。当前工作目录是R将从中读取文件并将结果默认保存到的目录。你可以使用`getwd()`函数来识别当前工作目录。你可以使用`setwd()`函数来设置当前工作目录。如果你需要输入不在当前工作目录中的文件，请在调用中使用完整的路径名。始终用引号括起来自操作系统的文件和目录名称。表
    1.3 列出了一些管理工作空间的标准命令。
- en: Table 1.3 Functions for managing the R workspace
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 表 1.3 管理R工作空间的函数
- en: '| Function | Action |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| 函数 | 操作 |'
- en: '| `getwd()` | Lists the current working directory |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| `getwd()` | 列出当前工作目录 |'
- en: '| `setwd("*mydirectory*")` | Changes the current working directory to *`mydirectory`*
    |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| `setwd("*mydirectory*")` | 将当前工作目录更改为 *`mydirectory`* |'
- en: '| `ls()` | Lists the objects in the current workspace |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| `ls()` | 列出当前工作空间中的对象 |'
- en: '| `rm(*objectlist*)` | Removes (deletes) one or more objects |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| `rm(*objectlist*)` | 删除（删除）一个或多个对象 |'
- en: '| `help(*options*)` | Provides information about available options |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| `help(*options*)` | 提供有关可用选项的信息 |'
- en: '| `options()` | Lets you view or set current options |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| `options()` | 允许你查看或设置当前选项 |'
- en: '| `save.image("*myfile*")` | Saves the workspace to *`myfile`* (default = .RData)
    |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| `save.image("*myfile*")` | 将工作空间保存到 *`myfile`*（默认 = .RData）|'
- en: '| `save(*objectlist*, file="*myfile*")` | Saves specific objects to a file
    |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| `save(*objectlist*, file="*myfile*")` | 将特定对象保存到文件 |'
- en: '| `load("*myfile*")` | Loads a workspace into the current session |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| `load("*myfile*")` | 将工作空间加载到当前会话 |'
- en: To see these commands in action, look at the following listing.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看这些命令的实际效果，请查看以下列表。
- en: Listing 1.2 An example of commands used to manage the R workspace
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 1.2 管理R工作空间所使用的命令示例
- en: '[PRE2]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: First, the current working directory is set to C:/myprojects/project1\. The
    current option settings are then displayed, and numbers are formatted to print
    with three digits after the decimal place.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，将当前工作目录设置为 C:/myprojects/project1\. 然后，显示当前选项设置，数字格式化为小数点后三位打印。
- en: Note the forward slashes in the pathname of the `setwd()` command. R treats
    the backslash (\) as an escape character. Even when you’re using R on a Windows
    platform, use forward slashes in pathnames. Also note that the `setwd()` function
    won’t create a directory that doesn’t exist. If necessary, you can use the `dir.create()`
    function to create a directory and then use `setwd()` to change to its location.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 注意`setwd()`命令路径名中的正斜杠。R将反斜杠（\）视为转义字符。即使你在Windows平台上使用R，也应在路径名中使用正斜杠。此外，请注意`setwd()`函数不会创建不存在的目录。如果需要，你可以使用`dir.create()`函数创建目录，然后使用`setwd()`更改到其位置。
- en: 1.3.5 Projects
  id: totrans-133
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.3.5 项目
- en: It’s a good idea to keep your projects in separate directories. RStudio provides
    a simple mechanism for this. Choose File > New Project ... and specify either
    New Directory to start a project in a brand-new working directory or Existing
    Directory to associate a project with an existing working directory. All your
    program files, command history, report output, graphs, and data will be saved
    in the project directory. You can easily switch between projects using the Project
    drop-down menu in the upper-right portion of the RStudio application.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 将你的项目保存在单独的目录中是个好主意。RStudio为此提供了一个简单的机制。选择文件 > 新建项目 ... 并指定新建目录以在全新的工作目录中开始一个项目，或者选择现有目录以将项目与现有工作目录关联。你所有的程序文件、命令历史、报告输出、图表和数据都将保存在项目目录中。你可以通过使用RStudio应用右上角的“项目”下拉菜单轻松地在项目之间切换。
- en: It is easy to become overwhelmed with project files. I recommend creating several
    subfolders within the main project folder. I usually create a *data* folder to
    contain raw data files, an *img* folder for image files and graphical output,
    a *docs* folder for project documentation, and a *reports* folder for reports.
    I keep the R scripts and a README file in the main directory. If there is an order
    to the R scripts, I number them (e.g., 01_import_data.R, 02_clean_data.R, etc.).
    The README is a text file containing information such as author, date, stakeholders
    and their contact information, and the purpose of the project. Six months from
    now, this will remind me of what I did and why I did it.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 项目文件很容易让人感到不知所措。我建议在主项目文件夹内创建几个子文件夹。我通常创建一个 *data* 文件夹来存放原始数据文件，一个 *img* 文件夹用于图像文件和图形输出，一个
    *docs* 文件夹用于项目文档，以及一个 *reports* 文件夹用于报告。我将 R 脚本和 README 文件放在主目录中。如果 R 脚本有顺序，我会给它们编号（例如，01_import_data.R、02_clean_data.R
    等）。README 是一个包含作者、日期、利益相关者和他们的联系方式以及项目目的的文本文件。六个月之后，这将提醒我我做了什么以及为什么这么做。
- en: 1.4 Packages
  id: totrans-136
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.4 软件包
- en: R comes with extensive capabilities right out of the box, but some of its most
    exciting features are available as optional modules that you can download and
    install. There are more than 10,000 user-contributed modules, called *packages*,
    that you can download from [http://cran.r-project.org/web/packages](http://cran.r-project.org/web/packages).
    They provide a tremendous range of new capabilities, from the analysis of geospatial
    data to protein mass spectra processing to the analysis of psychological tests!
    You’ll use many of these optional packages in this book.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: R 默认就提供了广泛的功能，但其中一些最令人兴奋的功能作为可选模块提供，你可以下载并安装它们。有超过 10,000 个用户贡献的模块，称为 *软件包*，你可以从
    [http://cran.r-project.org/web/packages](http://cran.r-project.org/web/packages)
    下载。它们提供了极其广泛的新功能，从地理空间数据分析到蛋白质质量光谱处理，再到心理测试分析！你将在本书中使用许多这些可选软件包。
- en: One set of packages, collectively called the *tidyverse*, deserves particular
    attention. This is a relatively new collection that offers a streamlined, consistent,
    and intuitive approach to data manipulation and analysis. The advantages offered
    by tidyverse packages (with names like *tidyr*, *dplyr*, *lubridate*, *stringr*,
    and *ggplot2*) are changing the way data scientists write code in R, and we will
    be employing these packages often. In fact, the opportunity to describe how to
    use these packages for data analysis and visualization was a major motivation
    for writing a third edition of this book.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 一组被称为 *tidyverse* 的软件包集合特别值得关注。这是一个相对较新的集合，它提供了一种简明、一致且直观的数据操作和分析方法。tidyverse
    软件包（如 *tidyr*、*dplyr*、*lubridate*、*stringr* 和 *ggplot2*）提供的优势正在改变数据科学家在 R 中编写代码的方式，我们将会经常使用这些软件包。实际上，描述如何使用这些软件包进行数据分析和可视化的机会是撰写本书第三版的主要动机。
- en: 1.4.1 What are packages?
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.4.1 什么是软件包？
- en: Packages are collections of R functions, data, and compiled code in a well-defined
    format. The directory where packages are stored on your computer is called the
    *library*. The function `.libPaths()` shows you where your library is located,
    and the function `library()` shows you what packages you’ve saved in your library.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 软件包是一组以良好定义的格式组织的 R 函数、数据和编译代码。存储软件包的计算机目录称为 *库*。函数 `.libPaths()` 会显示你的库在哪里，而函数
    `library()` 会显示你已保存到库中的软件包。
- en: R comes with a standard set of packages (including `base`, `datasets`, `utils`,
    `gr-Devices`, `graphics`, `stats`, and `methods`). They provide a wide range of
    functions and datasets that are available by default. Other packages are available
    for download and installation. Once installed, they must be loaded into the session
    to be used. The command `search()` tells you which packages are loaded and ready
    to use.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: R 默认提供了一套标准软件包（包括 `base`、`datasets`、`utils`、`gr-Devices`、`graphics`、`stats`
    和 `methods`）。它们提供了广泛的功能和默认可用的数据集。其他软件包可供下载和安装。一旦安装，它们必须被加载到会话中才能使用。命令 `search()`
    会告诉你哪些软件包已加载并准备好使用。
- en: 1.4.2 Installing a package
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.4.2 安装软件包
- en: Several R functions let you manipulate packages. To install a package for the
    first time, use the `install.packages()` command. For example, the `gclus` package
    contains functions for creating enhanced scatter plots. You can download and install
    the package with the command `install.packages("gclus")`.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 几个 R 函数允许你操作软件包。要首次安装软件包，使用 `install.packages()` 命令。例如，`gclus` 软件包包含用于创建增强散点图的函数。你可以使用命令
    `install.packages("gclus")` 下载并安装该软件包。
- en: You only need to install a package once. But like any software, packages are
    often updated by their authors. Use the command `update.packages()` to update
    any packages that you’ve installed. To see details on your packages, you can use
    the `installed.packages()` command. It lists the packages you have, along with
    their version numbers, dependencies, and other information.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 你只需要安装一次包。但像任何软件一样，包通常会被其作者更新。使用`update.packages()`命令更新你已安装的任何包。要查看你的包的详细信息，你可以使用`installed.packages()`命令。它列出了你拥有的包，包括它们的版本号、依赖关系和其他信息。
- en: You can also install and update packages using the RStudio interface. Select
    the Packages tab (from the window on the lower right). Enter the name (or partial
    name) in the search box in the upper right of that tabbed window. Place a check
    mark next to the package(s) you want to install and click the Install button.
    Alternatively, click the Update button to update a package that’s already installed.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以使用RStudio界面安装和更新包。选择“包”选项卡（从右下角的窗口）。在上右角的选项卡窗口中的搜索框中输入名称（或部分名称）。在要安装的包旁边放置勾选标记，然后点击安装按钮。或者，点击更新按钮来更新已安装的包。
- en: 1.4.3 Loading a package
  id: totrans-146
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.4.3 加载包
- en: Installing a package downloads it from a CRAN mirror site and places it in your
    library. To use it in an R session, you need to load the package using the `library()`
    command. For example, to use the package `gclus`, issue the command `library (gclus)`.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 安装包会从CRAN镜像站点下载它并将其放置在你的库中。要在R会话中使用它，你需要使用`library()`命令来加载包。例如，要使用`gclus`包，输入命令`library(gclus)`。
- en: Of course, you must have installed a package before you can load it. You’ll
    only have to load the package once in a given session. If you like, you can customize
    your startup environment to automatically load the packages you use most often.
    Appendix B explains how to customize your startup.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，在加载包之前，你必须已经安装了它。在给定会话中，你只需要加载一次包。如果你愿意，你可以自定义启动环境，以便自动加载你最常用的包。附录B解释了如何自定义启动。
- en: 1.4.4 Learning about a package
  id: totrans-149
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 1.4.4 了解包
- en: When you load a package, a new set of functions and datasets becomes available.
    Small illustrative datasets are provided along with sample code, allowing you
    to try out the new functionalities. The help system contains a description of
    each function (along with examples) and information about each dataset included.
    Entering `help(package="package_name")` provides a brief description of the package
    and an index of the functions and datasets that are included. Using `help()` with
    any of these function or dataset names provides further details. The same information
    can be downloaded as a PDF manual from CRAN. To get help on a package using the
    RStudio interface, click on the Packages tab (the lower-right window), enter the
    name of the package in the search window, and click on the name of the package.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 当你加载一个包时，一组新的函数和数据集变得可用。提供了小型示例数据集和示例代码，让你可以尝试新功能。帮助系统包含每个函数的描述（包括示例）以及包含的每个数据集的信息。输入`help(package="package_name")`会提供包的简要描述以及包含的函数和数据集索引。使用`help()`加上任何这些函数或数据集的名称可以提供更多详细信息。相同的信息可以从CRAN下载为PDF手册。要使用RStudio界面获取包的帮助，请点击“包”选项卡（右下角的窗口），在搜索窗口中输入包的名称，然后点击包的名称。
- en: Common mistakes in R programming
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: R编程中的常见错误
- en: 'Both beginning and experienced R programmers frequently make some common mistakes.
    If your program generates an error, be sure to check for the following:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 初学者和经验丰富的R程序员经常犯一些常见的错误。如果你的程序生成错误，请务必检查以下内容：
- en: Using the wrong case—`help()`, `Help()`, and `HELP``()` are three different
    functions (only the first will work).
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用错误的字母大小写——`help()`, `Help()`, 和 `HELP()` 是三个不同的函数（只有第一个会起作用）。
- en: Forgetting to use quotation marks when they’re needed—`install.packages("gclus")`
    works, whereas `install.packages(gclus)` generates an error.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 忘记在需要时使用引号——`install.packages("gclus")` 是有效的，而 `install.packages(gclus)` 会生成错误。
- en: Forgetting to include the parentheses in a function call—For example, `help()`
    works, but `help` doesn’t. Even if there are no options, you still need the `()`.
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在函数调用中忘记包含括号——例如，`help()` 是有效的，但 `help` 则不行。即使没有选项，你仍然需要括号。
- en: Using the \ in a pathname on Windows—R sees the backslash character as an escape
    character. `setwd("c:\mydata")` generates an error. Use `setwd("c:/mydata")` or
    `setwd("c:\\mydata")` instead.
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Windows的路径名中使用反斜杠（\）——R将反斜杠字符视为转义字符。`setwd("c:\mydata")` 会生成错误。请使用 `setwd("c:/mydata")`
    或 `setwd("c:\\mydata")` 代替。
- en: Using a function from a package that’s not loaded—The function `order .clusters()`
    is contained in the `gclus` package. If you try to use it before loading the package,
    you’ll get an error.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用未加载的包中的函数——函数 `order .clusters()` 包含在 `gclus` 包中。如果你在加载包之前尝试使用它，你会得到一个错误。
- en: The error messages in R can be cryptic, but if you’re careful about following
    these points, you should avoid seeing many of them.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: R 中的错误消息可能难以理解，但如果你注意以下几点，你应该可以避免看到很多错误。
- en: '1.5 Using output as input: Reusing results'
  id: totrans-159
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.5 将输出作为输入：重用结果
- en: One of the most useful design features of R is that the output of analyses can
    easily be saved and used as input to additional analyses. Let’s walk through an
    example, using one of the datasets that comes preinstalled with R. If you don’t
    understand the statistics involved, don’t worry. We’re focusing on the general
    principle here.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: R 最有用的设计特性之一是分析输出可以轻松保存并用作其他分析的输入。让我们通过一个例子来了解一下，使用 R 预先安装的数据集之一。如果你不理解涉及的统计，不要担心。我们在这里关注的是一般原则。
- en: R comes with many built-in datasets that can be used to practice data analyses.
    One such dataset, called `mtcars`, contains information about 32 automobiles collected
    from *Motor Trend* magazine road tests. Suppose we're interested in describing
    the relationship between a car's fuel efficiency and weight.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: R 随带了许多内置数据集，可用于练习数据分析。其中一个名为 `mtcars` 的数据集包含了从 *Motor Trend* 杂志道路测试收集的 32 辆汽车的信息。假设我们感兴趣的是描述汽车的燃油效率与重量之间的关系。
- en: 'First, we could run a simple linear regression predicting miles per gallon
    (`mpg`) from car weight (`wt`). This is accomplished with the following function
    call:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们可以运行一个简单的线性回归，预测每加仑英里数（`mpg`）与汽车重量（`wt`）之间的关系。这是通过以下函数调用实现的：
- en: '[PRE3]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The results are displayed on the screen, and no information is saved.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 结果显示在屏幕上，并且没有保存任何信息。
- en: 'Alternatively, run the regression, but store the results in an object:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，运行回归，但将结果存储在对象中：
- en: '[PRE4]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The assignment creates a list object called `lmfit` that contains extensive
    information from the analysis (including the predicted values, residuals, regression
    coefficients, and more). Although no output is sent to the screen, the results
    can be both displayed and manipulated further.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 赋值创建了一个名为 `lmfit` 的列表对象，其中包含分析的大量信息（包括预测值、残差、回归系数等）。尽管没有输出到屏幕，但结果可以显示并进一步操作。
- en: Typing `summary(lmfit)` displays a summary of the results, and `plot(lmfit)`
    produces diagnostic plots. The statement `cook<-cooks.distance(lmfit)` generates
    and stores influence statistics, and `plot(cook)` graphs them. To predict miles
    per gallon from car weight in a new set of data, you’d use `predict(lmfit,` `mynewdata)`.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 输入 `summary(lmfit)` 会显示结果摘要，而 `plot(lmfit)` 会生成诊断图。语句 `cook<-cooks.distance(lmfit)`
    生成并存储影响统计量，而 `plot(cook)` 则将它们绘制成图。要从新数据集中的汽车重量预测每加仑英里数，你会使用 `predict(lmfit, mynewdata)`。
- en: To see what a function returns, look at the Value section of the R help page
    for that function. Here you’d look at `help(lm)` or `?lm`. This tells you what’s
    saved when you assign the results of that function to an object.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看函数返回的内容，请查看该函数的 R 帮助页面的值部分。这里你会查看 `help(lm)` 或 `?lm`。这会告诉你当你将函数的结果赋给对象时，保存了什么信息。
- en: 1.6 Working with large datasets
  id: totrans-170
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.6 与大数据集一起工作
- en: Programmers frequently ask me if R can handle large data problems. Typically,
    they work with massive amounts of data gathered from web research, climatology,
    or genetics. Because R holds objects in memory, you’re generally limited by the
    amount of RAM available. For example, on my nine-year-old Windows PC with 2 GB
    of RAM, I can easily handle datasets with 10 million elements (100 variables by
    100,000 observations). On an iMac with 4 GB of RAM, I can usually handle 100 million
    elements without difficulty.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 程序员经常问我 R 是否可以处理大数据问题。通常，他们处理来自网络研究、气候学或遗传学的海量数据。由于 R 在内存中存储对象，你通常受限于可用的 RAM
    量。例如，在我的 9 年老 Windows PC 上，它有 2 GB 的 RAM，我可以轻松处理包含 1000 万个元素（100 个变量和 10 万个观测值）的数据集。在
    4 GB RAM 的 iMac 上，我通常可以轻松处理 1 亿个元素。
- en: 'But there are two issues to consider: the size of the dataset and the statistical
    methods that will be applied. R can handle data analysis problems in the gigabyte
    to terabyte range, but specialized procedures are required. Appendix F discusses
    the management and analysis of very large datasets.'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 但有两个问题需要考虑：数据集的大小和将要应用的统计方法。R 可以处理从千兆到太字节范围的数据分析问题，但需要专门的程序。附录 F 讨论了非常大数据集的管理和分析。
- en: 1.7 Working through an example
  id: totrans-173
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1.7 通过示例进行工作
- en: 'We’ll finish this chapter with an example that ties together many of these
    ideas. Here’s the task:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将以一个示例结束本章，该示例将许多这些想法联系起来。这里是任务：
- en: Open the general help and look at the Introduction to R section.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一般帮助并查看 R 简介部分。
- en: Install the `vcd` package (a package for visualizing categorical data that you’ll
    be using in chapter 11).
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装 `vcd` 包（一个用于可视化分类数据的包，你将在第 11 章中使用）。
- en: List the functions and datasets available in this package.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出此包中可用的函数和数据集。
- en: Load the package and read the description of the dataset `Arthritis`.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 加载包并阅读数据集 `Arthritis` 的描述。
- en: Print out the `Arthritis` dataset (entering the name of an object will list
    it).
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打印出 `Arthritis` 数据集（输入对象名称将列出它）。
- en: Run the example that comes with the `Arthritis` dataset. Don’t worry if you
    don’t understand the results; it basically shows that arthritis patients receiving
    treatment improved much more than patients receiving a placebo.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行随 `Arthritis` 数据集提供的示例。如果你不理解结果，不用担心；它基本上显示接受治疗的关节炎患者改善程度远大于接受安慰剂的患者。
- en: The code required is provided in the following listing, with a sample of the
    results displayed in figure 1.8\. As this short exercise demonstrates, you can
    accomplish a great deal with a small amount of code.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 所需的代码在以下列表中提供，结果样本显示在图 1.8 中。正如这个简短练习所展示的，你可以用很少的代码完成很多事情。
- en: Listing 1.3 Working with a new package
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 1.3 使用新包
- en: '[PRE5]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](Images/CH01_F08_Kabacoff3.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH01_F08_Kabacoff3.png)'
- en: Figure 1.8 RStudio window when executing the code in listing 1.3
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.8 执行列表 1.3 中的代码时的 RStudio 窗口
- en: In this chapter, we looked at some of the strengths that make R an attractive
    option for students, researchers, statisticians, and data analysts who are trying
    to understand the meaning of their data. We walked through the program’s installation
    and talked about how to enhance R’s capabilities by downloading additional packages.
    We explored the basic interface and produced a few simple graphs. Because R can
    be a complex program, we spent some time looking at how to access the extensive
    help that’s available. Hopefully you’re getting a sense of how powerful this freely
    available software can be.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们探讨了使 R 成为试图理解其数据含义的学生、研究人员、统计学家和数据分析师有吸引力的选择的一些优势。我们介绍了程序的安装，并讨论了如何通过下载额外的包来增强
    R 的功能。我们探索了基本界面并制作了一些简单的图表。由于 R 可以是一个复杂的程序，我们花了些时间来看如何访问广泛可用的帮助。希望你能感受到这款免费软件的强大之处。
- en: Now that you have R and RStudio up and running, it’s time to add your data to
    the mix. In the next chapter, we’ll look at the types of data R can handle and
    how to import them into R from text files, other programs, and database management
    systems.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你已经安装并运行了 R 和 RStudio，是时候将你的数据添加进来了。在下一章中，我们将探讨 R 可以处理的数据类型以及如何从文本文件、其他程序和数据库管理系统导入它们。
- en: Summary
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: R provides a comprehensive, highly interactive environment for analyzing and
    visualizing data.
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 提供了一个全面、高度交互的环境，用于分析和可视化数据。
- en: RStudio is an integrated development environment that makes programming in R
    easier and more productive.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RStudio 是一个集成开发环境，它使 R 编程更容易、更高效。
- en: Packages are freely available add-on modules that greatly extend the power of
    the R platform.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 包是免费的可添加模块，可以极大地扩展 R 平台的功能。
- en: R has an extensive help system, and learning how to use it will greatly facilitate
    your ability to program effectively.
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R 有一个广泛的支持系统，学习如何使用它将极大地促进你有效编程的能力。
