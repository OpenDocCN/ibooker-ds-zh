- en: Chapter 1\. Welcome to Docker
  id: totrans-0
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 第1章。欢迎使用Docker
- en: This chapter covers
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: What Docker is
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker是什么
- en: 'Example: “Hello, World”'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 示例：“Hello, World”
- en: An introduction to containers
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 容器简介
- en: How Docker addresses software problems that most people tolerate
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker如何解决大多数人容忍的软件问题
- en: When, where, and why you should use Docker
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 何时、何地以及为什么应该使用Docker
- en: A best practice is an optional investment in your product or system that should
    yield better outcomes in the future. Best practices enhance security, prevent
    conflicts, improve serviceability, or increase longevity. Best practices often
    need advocates because justifying the immediate cost can be difficult. This is
    especially so when the future of the system or product is uncertain. Docker is
    a tool that makes adopting software packaging, distribution, and utilization best
    practices cheap and sensible defaults. It does so by providing a complete vision
    for process containers and simple tooling for building and working with them.
  id: totrans-7
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 最佳实践是对你的产品或系统的一种可选投资，它应该在将来产生更好的结果。最佳实践可以增强安全性、防止冲突、提高可维护性或延长使用寿命。最佳实践通常需要倡导者，因为证明即时成本是困难的。特别是在系统或产品的未来不确定时更是如此。Docker是一种工具，它使采用软件打包、分发和利用最佳实践变得既便宜又合理。它是通过提供对进程容器的完整愿景以及构建和使用它们的简单工具来做到这一点的。
- en: If you’re on a team that operates service software with dynamic scaling requirements,
    deploying software with Docker can help reduce customer impact. Containers come
    up more quickly and consume fewer resources than virtual machines.
  id: totrans-8
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果你所在的团队运营具有动态扩展需求的软件服务，使用Docker部署软件可以帮助减少对客户的影响。容器启动更快，比虚拟机消耗的资源更少。
- en: Teams that use continuous integration and continuous deployment techniques can
    build more expressive pipelines and create more robust functional testing environments
    if they use Docker. The containers being tested hold the same software that will
    go to production. The results are higher production change confidence, tighter
    production change control, and faster iteration.
  id: totrans-9
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用持续集成和持续部署技术的团队，如果使用Docker，可以构建更具有表达力的管道并创建更健壮的功能测试环境。正在测试的容器包含将进入生产的相同软件。结果是更高的生产变更信心，更紧密的生产变更控制，以及更快的迭代。
- en: If your team uses Docker to model local development environments, you will decrease
    member onboarding time and eliminate the inconsistencies that slow you down. Those
    same environments can be version controlled with the software and updated as the
    software requirements change.
  id: totrans-10
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果你的团队使用Docker来模拟本地开发环境，你会减少成员的入职时间并消除那些减慢你速度的不一致性。这些相同的开发环境可以与软件一起进行版本控制，并随着软件需求的变化而更新。
- en: Software authors usually know how to install and configure their software with
    sensible defaults and required dependencies. If you write software, distributing
    that software with Docker will make it easier for your users to install and run
    it. They will be able to leverage the default configuration and helper material
    that you include. If you use Docker, you can reduce your product “Installation
    Guide” to a single command and a single portable dependency.
  id: totrans-11
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 软件作者通常知道如何使用合理的默认值和必需依赖项安装和配置他们的软件。如果你编写软件，使用Docker分发该软件将使你的用户更容易安装和运行它。他们可以利用你包含的默认配置和辅助材料。如果你使用Docker，你可以将你的产品“安装指南”简化为一条命令和一个可携带的依赖项。
- en: Whereas software authors understand dependencies, installation, and packaging,
    it is system administrators who understand the systems where the software will
    run. Docker provides an expressive language for running software in containers.
    That language lets system administrators inject environment-specific configuration
    and tightly control access to system resources. That same language, coupled with
    built-in package management, tooling, and distribution infrastructure, makes deployments
    declarative, repeatable, and trustworthy. It promotes disposable system paradigms,
    persistent state isolation, and other best practices that help system administrators
    focus on higher-value activities.
  id: totrans-12
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 虽然软件作者理解依赖关系、安装和打包，但理解软件将运行的系统的系统管理员才真正了解这些系统。Docker提供了一种在容器中运行软件的表达性语言。这种语言允许系统管理员注入特定环境的配置并严格控制对系统资源的访问。这种相同的语言，结合内置的包管理、工具和分发基础设施，使得部署声明性、可重复和可信。它促进了可丢弃的系统范式、持久状态隔离以及其他有助于系统管理员专注于更高价值活动的最佳实践。
- en: Launched in March 2013, Docker works with your operating system to package,
    ship, and run software. You can think of Docker as a software logistics provider
    that will save you time and let you focus on core competencies. You can use Docker
    with network applications such as web servers, databases, and mail servers, and
    with terminal applications including text editors, compilers, network analysis
    tools, and scripts; in some cases, it’s even used to run GUI applications such
    as web browsers and productivity software.
  id: totrans-13
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker 于 2013 年 3 月推出，与你的操作系统协作来打包、运输和运行软件。你可以把 Docker 视为一个软件物流提供商，它将为你节省时间，让你专注于核心能力。你可以使用
    Docker 与网络应用程序（如 Web 服务器、数据库和邮件服务器）以及终端应用程序（包括文本编辑器、编译器、网络分析工具和脚本）一起使用；在某些情况下，它甚至用于运行
    GUI 应用程序，如 Web 浏览器和生产力软件。
- en: Docker runs Linux software on most systems. Docker for Mac and Docker for Windows
    integrate with common virtual machine (VM) technology to create portability with
    Windows and macOS. But Docker can run native Windows applications on modern Windows
    server machines.
  id: totrans-14
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker 在大多数系统上运行 Linux 软件。Docker for Mac 和 Docker for Windows 与常见的虚拟机（VM）技术集成，以在
    Windows 和 macOS 上创建可移植性。但 Docker 也可以在现代 Windows 服务器机器上运行本机 Windows 应用程序。
- en: Docker isn’t a programming language, and it isn’t a framework for building software.
    Docker is a tool that helps solve common problems such as installing, removing,
    upgrading, distributing, trusting, and running software. It’s open source Linux
    software, which means that anyone can contribute to it and that it has benefited
    from a variety of perspectives. It’s common for companies to sponsor the development
    of open source projects. In this case, Docker Inc. is the primary sponsor. You
    can find out more about Docker Inc. at [https://docker.com/company/](https://docker.com/company/).
  id: totrans-15
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker 不是一个编程语言，也不是构建软件的框架。Docker 是一个帮助解决常见问题（如安装、删除、升级、分发、信任和运行软件）的工具。它是开放源代码的
    Linux 软件，这意味着任何人都可以为其做出贡献，并且它已经从各种观点中受益。公司赞助开源项目的发展是很常见的。在这种情况下，Docker Inc. 是主要赞助商。你可以在
    [https://docker.com/company/](https://docker.com/company/) 上了解更多关于 Docker Inc.
    的信息。
- en: 1.1\. WHAT IS DOCKER?
  id: totrans-16
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.1\. 什么是 Docker？
- en: If you’re picking up this book, you have probably already heard of Docker. Docker
    is an open source project for building, shipping, and running programs. It is
    a command-line program, a background process, and a set of remote services that
    take a logistical approach to solving common software problems and simplifying
    your experience installing, running, publishing, and removing software. It accomplishes
    this by using an operating system technology called containers.
  id: totrans-17
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 如果你正在阅读这本书，你可能已经听说过 Docker。Docker 是一个用于构建、运输和运行程序的开放源代码项目。它是一个命令行程序，一个后台进程，以及一组远程服务，这些服务采用物流方法来解决常见的软件问题，并简化你安装、运行、发布和删除软件的体验。它是通过使用名为容器的一种操作系统技术来实现的。
- en: 1.1.1\. “Hello, World”
  id: totrans-18
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.1.1\. “Hello, World”
- en: 'This topic is easier to learn with a concrete example. In keeping with tradition,
    we’ll use “Hello, World.” Before you begin, download and install Docker for your
    system. Detailed instructions are kept up-to-date for every available system at
    [https://docs.docker.com/install/](https://docs.docker.com/install/). Once you
    have Docker installed and an active internet connection, head to your command
    prompt and type the following:'
  id: totrans-19
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 通过一个具体的例子来学习这个主题会更容易。按照传统，我们将使用 “Hello, World。” 在开始之前，请下载并安装适用于你系统的 Docker。每个可用的系统的详细说明都保存在
    [https://docs.docker.com/install/](https://docs.docker.com/install/) 上。一旦你安装了
    Docker 并有一个活跃的互联网连接，前往你的命令提示符并输入以下内容：
- en: '`docker run dockerinaction/hello_world`'
  id: totrans-20
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`docker run dockerinaction/hello_world`'
- en: After you do so, Docker will spring to life. It will start downloading various
    components and eventually print out `"hello world"`. If you run it again, it will
    just print out `"hello world"`. Several things are happening in this example,
    and the command itself has a few distinct parts.
  id: totrans-21
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在这样做之后，Docker 将会启动。它将开始下载各种组件，最终打印出 `"hello world"`。如果你再次运行它，它只会打印出 `"hello
    world"`。在这个例子中，有几个事情正在发生，而这个命令本身有几个不同的部分。
- en: First, you use the `docker run` command. This tells Docker that you want to
    trigger the sequence (shown in [figure 1.1](#filepos100409)) that installs and
    runs a program inside a container.
  id: totrans-22
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 首先，你使用 `docker run` 命令。这告诉 Docker 你想要触发一个序列（如图 1.1 所示），该序列会在容器内安装并运行一个程序。
- en: Figure 1.1\. What happens after running `docker run`
  id: totrans-23
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图 1.1\. 运行 `docker run` 后会发生什么
- en: '![](images/00024.jpg)'
  id: totrans-24
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](images/00024.jpg)'
- en: The second part specifies the program that you want Docker to run in a container.
    In this example, that program is `dockerinaction/hello_world`. This is called
    the image (or repository) name. For now, you can think of the image name as the
    name of the program you want to install or run. The image itself is a collection
    of files and metadata. That metadata includes the specific program to execute
    and other relevant configuration details.
  id: totrans-25
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 第二部分指定了 Docker 在容器中要运行的程序。在这个例子中，这个程序是 `dockerinaction/hello_world`。这被称为镜像（或仓库）名称。目前，你可以将镜像名称视为你想要安装或运行的程序的名称。镜像本身是一组文件和元数据。这些元数据包括要执行的特定程序和其他相关配置细节。
- en: '|    |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '|    |'
- en: Note
  id: totrans-27
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 注意
- en: This repository and several others were created specifically to support the
    examples in this book. By the end of [part 2](index_split_062.html#filepos666610),
    you should feel comfortable examining these open source examples.
  id: totrans-28
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这个仓库以及几个其他仓库是专门为支持本书中的示例而创建的。到 [第二部分](index_split_062.html#filepos666610) 结束时，你应该能够舒适地检查这些开源示例。
- en: '|    |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '|    |'
- en: The first time you run this command, Docker has to figure out whether the `docker-inaction/hello_world`
    image has already been downloaded. If it’s unable to locate it on your computer
    (because it’s the first thing you do with Docker), Docker makes a call to Docker
    Hub. Docker Hub is a public registry provided by Docker Inc. Docker Hub replies
    to Docker running on your computer to indicate where the image (`docker-inaction/hello_world`)
    can be found, and Docker starts the download.
  id: totrans-30
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 第一次运行此命令时，Docker 需要确定 `docker-inaction/hello_world` 镜像是否已经被下载。如果它无法在你的电脑上找到它（因为你第一次使用
    Docker），Docker 会调用 Docker Hub。Docker Hub 是 Docker Inc. 提供的一个公共注册表。Docker Hub 回应运行在你电脑上的
    Docker，指示镜像（`docker-inaction/hello_world`）的位置，然后 Docker 开始下载。
- en: 'Once the image is installed, Docker creates a new container and runs a single
    command. In this case, the command is simple:'
  id: totrans-31
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 一旦镜像安装完成，Docker 将创建一个新的容器并运行一个单独的命令。在这种情况下，命令很简单：
- en: '`echo "hello world"`'
  id: totrans-32
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`echo "hello world"`'
- en: After the `echo` command prints `"hello world"` to the terminal, the program
    exits, and the container is marked as stopped. Understand that the running state
    of a container is directly tied to the state of a single running program inside
    the container. If a program is running, the container is running. If the program
    is stopped, the container is stopped. Restarting a container will run the program
    again.
  id: totrans-33
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在 `echo` 命令将 `"hello world"` 打印到终端后，程序退出，容器被标记为停止。理解到容器的运行状态直接与容器内单个运行程序的状态相关联。如果一个程序正在运行，容器也在运行。如果一个程序停止，容器也会停止。重新启动容器将再次运行程序。
- en: When you give the command a second time, Docker will check again to see whether
    `docker-inaction/hello_world` is installed. This time it will find the image on
    the local machine and can build another container and execute it right away. We
    want to emphasize an important detail. When you use `docker run` the second time,
    it creates a second container from the same repository ([figure 1.2](#filepos108198)
    illustrates this). This means that if you repeatedly use `docker run` and create
    a bunch of containers, you’ll need to get a list of the containers you’ve created
    and maybe at some point destroy them. Working with containers is as straightforward
    as creating them, and both topics are covered in [chapter 2](index_split_024.html#filepos153412).
  id: totrans-34
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 当你第二次执行命令时，Docker 将再次检查 `docker-inaction/hello_world` 是否已安装。这次它将在本地机器上找到镜像，并可以立即构建另一个容器并执行它。我们想强调一个重要细节。当你第二次使用
    `docker run` 时，它会从相同的仓库创建第二个容器（[图 1.2](#filepos108198) 说明了这一点）。这意味着如果你反复使用 `docker
    run` 并创建了一堆容器，你需要获取你创建的容器列表，并在某个时候可能需要销毁它们。与容器一起工作就像创建它们一样简单，这两个主题都在 [第 2 章](index_split_024.html#filepos153412)
    中进行了介绍。
- en: Figure 1.2\. Running `docker run` a second time. Because the image is already
    installed, Docker can start the new container right away.
  id: totrans-35
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图 1.2\. 第二次运行 `docker run`。因为镜像已经安装，Docker 可以立即启动新的容器。
- en: '![](images/00049.jpg)'
  id: totrans-36
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](images/00049.jpg)'
- en: Congratulations! You’re now an official Docker user. Using Docker is just this
    easy. But it can test your understanding of the application you are running. Consider
    running a web application in a container. If you did not know that it was a long-running
    application that listened for inbound network communication on TCP port 80, you
    might not know exactly what Docker command should be used to start that container.
    These are the types of sticking points people encounter as they migrate to containers.
  id: totrans-37
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 恭喜！您现在是一名官方的Docker用户。使用Docker非常简单。但它可以测试您对正在运行的应用程序的理解。考虑在一个容器中运行一个Web应用程序。如果您不知道它是一个长时间运行的应用程序，它监听TCP端口80上的传入网络通信，您可能不知道应该使用什么Docker命令来启动该容器。这些是人们在迁移到容器时遇到的问题。
- en: Although this book cannot speak to the needs of your specific applications,
    it does identify the common use cases and help teach most relevant Docker use
    patterns. By the end of [part 1](index_split_023.html#filepos151791), you should
    have a strong command of containers with Docker.
  id: totrans-38
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 尽管这本书不能针对您特定的应用需求进行评论，但它确实确定了常见用例，并帮助教授大多数相关的Docker使用模式。到[第1部分](index_split_023.html#filepos151791)结束时，您应该对使用Docker的容器有很强的掌握。
- en: 1.1.2\. Containers
  id: totrans-39
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.1.2\. 容器
- en: Historically, UNIX-style operating systems have used the term jail to describe
    a modified runtime environment that limits the scope of resources that a jailed
    program can access. Jail features go back to 1979 and have been in evolution ever
    since. In 2005, with the release of Sun’s Solaris 10 and Solaris Containers, container
    has become the preferred term for such a runtime environment. The goal has expanded
    from limiting filesystem scope to isolating a process from all resources except
    where explicitly allowed.
  id: totrans-40
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 从历史上看，UNIX风格的操作系统使用术语“监狱”来描述一个修改后的运行时环境，该环境限制了被监禁的程序可以访问的资源范围。监狱功能可以追溯到1979年，并且自那时以来一直在发展。2005年，随着Sun的Solaris
    10和Solaris容器的发布，容器已成为此类运行时环境的首选术语。目标已从限制文件系统范围扩展到隔离进程，除了明确允许的资源外，从所有资源中隔离进程。
- en: Using containers has been a best practice for a long time. But manually building
    containers can be challenging and easy to do incorrectly. This challenge has put
    them out of reach for some. Others using misconfigured containers are lulled into
    a false sense of security. This was a problem begging to be solved, and Docker
    helps. Any software run with Docker is run inside a container. Docker uses existing
    container engines to provide consistent containers built according to best practices.
    This puts stronger security within reach for everyone.
  id: totrans-41
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用容器已经是一项最佳实践很长时间了。但手动构建容器可能具有挑战性，并且很容易出错。这个挑战使一些人望而却步。其他人使用配置错误的容器，却陷入了一种虚假的安全感。这是一个亟待解决的问题，而Docker帮助解决了这个问题。任何使用Docker运行的软件都是在容器内运行的。Docker使用现有的容器引擎来提供根据最佳实践构建的一致容器。这使得每个人都能获得更强的安全性。
- en: With Docker, users get containers at a much lower cost. Running the example
    in [section 1.1.1](#filepos98288) uses a container and does not require any special
    knowledge. As Docker and its container engines improve, you get the latest and
    greatest isolation features. Instead of keeping up with the rapidly evolving and
    highly technical world of building strong containers, you can let Docker handle
    the bulk of that for you.
  id: totrans-42
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用Docker，用户可以以更低的成本获得容器。在[第1.1.1节](#filepos98288)中运行示例使用了一个容器，并且不需要任何特殊知识。随着Docker及其容器引擎的改进，您将获得最新和最强大的隔离功能。您不必跟上快速发展和高度技术化的构建强大容器的世界，而是可以让Docker为您处理大部分工作。
- en: 1.1.3\. Containers are not virtualization
  id: totrans-43
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.1.3\. 容器不是虚拟化
- en: In this cloud-native era, people tend to think about virtual machines as units
    of deployment, where deploying a single process means creating a whole network-attached
    virtual machine. Virtual machines provide virtual hardware (or hardware on which
    an operating system and other programs can be installed). They take a long time
    (often minutes) to create and require significant resource overhead because they
    run a whole operating system in addition to the software you want to use. Virtual
    machines can perform optimally once everything is up and running, but the startup
    delays make them a poor fit for just-in-time or reactive deployment scenarios.
  id: totrans-44
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在这个云原生时代，人们倾向于将虚拟机视为部署单元，其中部署单个进程意味着创建一个整个网络连接的虚拟机。虚拟机提供虚拟硬件（或可以安装操作系统和其他程序的硬件）。它们创建需要很长时间（通常是几分钟），并且由于它们除了您想要使用的软件外还运行整个操作系统，因此需要大量的资源开销。虚拟机在一切运行正常后可以表现出最佳性能，但启动延迟使它们不适合即时或反应式部署场景。
- en: Unlike virtual machines, Docker containers don’t use any hardware virtualization.
    Programs running inside Docker containers interface directly with the host’s Linux
    kernel. Many programs can run in isolation without running redundant operating
    systems or suffering the delay of full boot sequences. This is an important distinction.
    Docker is not a hardware virtualization technology. Instead, it helps you use
    the container technology already built into your operating system kernel.
  id: totrans-45
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 与虚拟机不同，Docker容器不使用任何硬件虚拟化。Docker容器内运行的程序直接与宿主机的Linux内核接口。许多程序可以在不运行冗余操作系统或遭受完整引导序列延迟的情况下独立运行。这是一个重要的区别。Docker不是硬件虚拟化技术。相反，它帮助您使用已经内置到操作系统内核中的容器技术。
- en: Virtual machines provide hardware abstractions so you can run operating systems.
    Containers are an operating system feature. So you can always run Docker in a
    virtual machine if that machine is running a modern Linux kernel. Docker for Mac
    and Windows users, and almost all cloud computing users, will run Docker inside
    virtual machines. So these are really complementary technologies.
  id: totrans-46
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 虚拟机提供硬件抽象，以便您可以在其中运行操作系统。容器是操作系统的一个特性。因此，如果机器运行的是现代Linux内核，您始终可以在虚拟机中运行Docker。对于Mac和Windows用户，以及几乎所有云计算用户，他们都会在虚拟机中运行Docker。因此，这些实际上是互补的技术。
- en: 1.1.4\. Running software in containers for isolation
  id: totrans-47
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.1.4. 在容器中运行软件以实现隔离
- en: Containers and isolation features have existed for decades. Docker uses Linux
    namespaces and cgroups, which have been part of Linux since 2007\. Docker doesn’t
    provide the container technology, but it specifically makes it simpler to use.
    To understand what containers look like on a system, let’s first establish a baseline.
    [Figure 1.3](#filepos114862) shows a basic example running on a simplified computer
    system architecture.
  id: totrans-48
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 容器和隔离特性已经存在了几十年。Docker使用Linux命名空间和cgroups，这些自2007年以来一直是Linux的一部分。Docker不提供容器技术，但它特别简化了其使用。为了了解系统上的容器看起来是什么样子，让我们首先建立一个基线。[图1.3](#filepos114862)显示了一个在简化的计算机系统架构上运行的基本示例。
- en: Figure 1.3\. A basic computer stack running two programs that were started from
    the command lin
  id: totrans-49
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图1.3. 一个基本的计算机堆栈运行了从命令行启动的两个程序
- en: '![](images/00006.jpg)'
  id: totrans-50
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![图片](images/00006.jpg)'
- en: Notice that the command-line interface, or CLI, runs in what is called user
    space memory, just like other programs that run on top of the operating system.
    Ideally, programs running in user space can’t modify kernel space memory. Broadly
    speaking, the operating system is the interface between all user programs and
    the hardware that the computer is running on.
  id: totrans-51
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 注意，命令行界面（CLI）运行在所谓的用户空间内存中，就像运行在操作系统之上的其他程序一样。理想情况下，运行在用户空间中的程序不能修改内核空间内存。广义上讲，操作系统是所有用户程序与计算机运行的硬件之间的接口。
- en: You can see in [figure 1.4](#filepos116382) that running Docker means running
    two programs in user space. The first is the Docker engine. If installed properly,
    this process should always be running. The second is the Docker CLI. This is the
    Docker program that users interact with. If you want to start, stop, or install
    software, you’ll issue a command by using the Docker program.
  id: totrans-52
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 您可以在[图1.4](#filepos116382)中看到，运行Docker意味着在用户空间中运行两个程序。第一个是Docker引擎。如果安装正确，此进程应始终运行。第二个是Docker
    CLI。这是用户与之交互的Docker程序。如果您想启动、停止或安装软件，您将通过Docker程序发出命令。
- en: Figure 1.4\. Docker running three containers on a basic Linux computer system
  id: totrans-53
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图1.4. Docker在基本的Linux计算机系统上运行三个容器
- en: '![](images/00043.jpg)'
  id: totrans-54
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![图片](images/00043.jpg)'
- en: '[Figure 1.4](#filepos116382) also shows three running containers. Each is running
    as a child process of the Docker engine, wrapped with a container, and the delegate
    process is running in its own memory subspace of the user space. Programs running
    inside a container can access only their own memory and resources as scoped by
    the container.'
  id: totrans-55
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '[图1.4](#filepos116382)也显示了三个正在运行的容器。每个容器都是作为Docker引擎的子进程运行的，被容器封装，并且代表进程在其用户空间的独立内存子空间中运行。容器内运行的程序只能访问由容器定义的自己的内存和资源。'
- en: 'Docker builds containers using 10 major system features. [Part 1](index_split_023.html#filepos151791)
    of this book uses Docker commands to illustrate how these features can be modified
    to suit the needs of the contained software and to fit the environment where the
    container will run. The specific features are as follows:'
  id: totrans-56
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker使用10个主要系统特性来构建容器。本书的[第1部分](index_split_023.html#filepos151791)使用Docker命令来说明如何修改这些特性以满足容器内软件的需求，并适应容器运行的环境。具体特性如下：
- en: PID namespace—  Process identifiers and capabilities
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PID 命名空间— 进程标识符和能力
- en: UTS namespace—  Host and domain name
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: UTS 命名空间— 主机和域名
- en: MNT namespace—  Filesystem access and structure
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MNT 命名空间— 文件系统访问和结构
- en: IPC namespace—  Process communication over shared memory
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IPC 命名空间— 通过共享内存的进程通信
- en: NET namespace—  Network access and structure
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NET 命名空间— 网络访问和结构
- en: USR namespace—  User names and identifiers
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: USR 命名空间— 用户名和标识符
- en: '`chroot`  syscall—Controls the location of the filesystem root'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`chroot` 系统调用— 控制文件系统根的位置'
- en: cgroups—  Resource protection
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: cgroups— 资源保护
- en: CAP drop—  Operating system feature restrictions
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CAP 降级— 操作系统功能限制
- en: Security modules—  Mandatory access controls
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全模块— 强制访问控制
- en: Docker uses those to build containers at runtime, but it uses another set of
    technologies to package and ship containers.
  id: totrans-67
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker 使用这些来在运行时构建容器，但它使用另一套技术来打包和分发容器。
- en: 1.1.5\. Shipping containers
  id: totrans-68
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.1.5. 运输集装箱
- en: You can think of a Docker container as a physical shipping container. It’s a
    box where you store and run an application and all of its dependencies (excluding
    the running operating system kernel). Just as cranes, trucks, trains, and ships
    can easily work with shipping containers, so can Docker run, copy, and distribute
    containers with ease. Docker completes the traditional container metaphor by including
    a way to package and distribute software. The component that fills the shipping
    container role is called an image.
  id: totrans-69
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你可以将 Docker 容器想象成一个物理的运输集装箱。它是一个存放并运行应用程序及其所有依赖项（不包括正在运行的操作系统内核）的盒子。正如起重机、卡车、火车和船只可以轻松地与运输集装箱协同工作一样，Docker
    也可以轻松地运行、复制和分发容器。Docker 通过包括软件打包和分发的方式，完成了传统集装箱隐喻的完整性。在运输集装箱中起作用的组件被称为镜像。
- en: 'The example in [section 1.1.1](#filepos98288) used an image named `dockerinaction/hello_world`.
    That image contains single file: a small executable Linux program. More generally,
    a Docker image is a bundled snapshot of all the files that should be available
    to a program running inside a container. You can create as many containers from
    an image as you want. But when you do, containers that were started from the same
    image don’t share changes to their filesystem. When you distribute software with
    Docker, you distribute these images, and the receiving computers create containers
    from them. Images are the shippable units in the Docker ecosystem.'
  id: totrans-70
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '[第 1.1.1 节](#filepos98288) 中的示例使用了一个名为 `dockerinaction/hello_world` 的镜像。这个镜像包含单个文件：一个小型的可执行
    Linux 程序。更普遍地说，Docker 镜像是一个捆绑的快照，包含了在容器内运行的程序应该可用的所有文件。你可以从一个镜像创建任意数量的容器。但是当你这样做时，从同一镜像启动的容器不会共享它们文件系统的更改。当你使用
    Docker 分发软件时，你分发这些镜像，接收的计算机从它们创建容器。镜像是在 Docker 生态系统中的可运输单元。'
- en: Docker provides a set of infrastructure components that simplify distributing
    Docker images. These components are registries and indexes. You can use publicly
    available infrastructure provided by Docker Inc., other hosting companies, or
    your own registries and indexes.
  id: totrans-71
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker 提供了一套基础设施组件，简化了 Docker 镜像的分发。这些组件是注册表和索引。你可以使用 Docker Inc. 提供的公共基础设施，其他托管公司提供的，或者你自己的注册表和索引。
- en: 1.2\. WHAT PROBLEMS DOES DOCKER SOLVE?
  id: totrans-72
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.2. DOCKER 解决了哪些问题？
- en: Using software is complex. Before installation, you have to consider the operating
    system you’re using, the resources the software requires, what other software
    is already installed, and what other software it depends on. You need to decide
    where it should be installed. Then you need to know how to install it. It’s surprising
    how drastically installation processes vary today. The list of considerations
    is long and unforgiving. Installing software is at best inconsistent and overcomplicated.
    The problem is only worsened if you want to make sure that several machines use
    a consistent set of software over time.
  id: totrans-73
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用软件是复杂的。在安装之前，你必须考虑你使用的操作系统，软件需要的资源，已经安装的其他软件，以及它依赖的其他软件。你需要决定它应该安装在哪里。然后你需要知道如何安装它。今天安装过程的差异之大令人惊讶。考虑的事项列表很长且不容忍。安装软件至多是不一致和过度复杂的。如果你想要确保几台机器在一段时间内使用一致的软件集合，这个问题只会变得更糟。
- en: 'Package managers such as APT, Homebrew, YUM, and npm attempt to manage this,
    but few of those provide any degree of isolation. Most computers have more than
    one application installed and running. And most applications have dependencies
    on other software. What happens when applications you want to use don’t play well
    together? Disaster! Things are only made more complicated when applications share
    dependencies:'
  id: totrans-74
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 包管理器如APT、Homebrew、YUM和npm试图管理这个问题，但其中很少有提供任何程度的隔离。大多数计算机安装并运行了不止一个应用程序。大多数应用程序都依赖于其他软件。当你想用的应用程序不能很好地协同工作时会发生什么？灾难！当应用程序共享依赖项时，事情只会变得更加复杂：
- en: What happens if one application needs an upgraded dependency, but the other
    does not?
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果一个应用程序需要升级依赖项，而另一个不需要，会发生什么？
- en: What happens when you remove an application? Is it really gone?
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当你移除一个应用程序时会发生什么？它真的消失了？
- en: Can you remove old dependencies?
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你能移除旧的依赖项吗？
- en: Can you remember all the changes you had to make to install the software you
    now want to remove?
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你能记得你为安装现在想要移除的软件所做的所有更改吗？
- en: The truth is that the more software you use, the more difficult it is to manage.
    Even if you can spend the time and energy required to figure out installing and
    running applications, how confident can you be about your security? Open and closed
    source programs release security updates continually, and being aware of all the
    issues is often impossible. The more software you run, the greater the risk that
    it’s vulnerable to attack.
  id: totrans-79
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 事实是，你使用的软件越多，管理起来就越困难。即使你能花时间和精力来弄清楚安装和运行应用程序，你对安全性的信心又能有多大？开源和闭源程序持续发布安全更新，而意识到所有问题往往是无法实现的。你运行的软件越多，它受到攻击的风险就越大。
- en: Even enterprise-grade service software must be deployed with dependencies. It
    is common for those projects to be shipped with and deployed to machines with
    hundreds, if not thousands, of files and other programs. Each of those creates
    a new opportunity for conflict, vulnerability, or licensing liability.
  id: totrans-80
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 即使是面向企业的服务软件也必须在依赖项中部署。这些项目通常与数百甚至数千个文件和其他程序一起发货并部署到机器上。每个都为冲突、漏洞或许可责任创造了新的机会。
- en: All of these issues can be solved with careful accounting, management of resources,
    and logistics, but those are mundane and unpleasant things to deal with. Your
    time would be better spent using the software that you’re trying to install, upgrade,
    or publish. The people who built Docker recognized that, and thanks to their hard
    work, you can breeze through the solutions with minimal effort in almost no time
    at all.
  id: totrans-81
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 所有这些问题都可以通过仔细的核算、资源管理和物流来解决，但这些是平凡且令人不愉快的事情。你最好把时间花在安装、升级或发布你正在尝试使用的软件上。构建Docker的人认识到了这一点，多亏了他们的辛勤工作，你几乎可以毫不费力地迅速找到解决方案。
- en: It’s possible that most of these issues seem acceptable today. Maybe they feel
    trivial because you’re used to them. After reading how Docker makes these issues
    approachable, you may notice a shift in your opinion.
  id: totrans-82
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 很可能，今天大多数人觉得这些问题是可以接受的。也许它们看起来微不足道，因为你已经习惯了它们。在阅读了Docker如何使这些问题变得可接近之后，你可能注意到你的观点发生了转变。
- en: 1.2.1\. Getting organized
  id: totrans-83
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.2.1\. 整理
- en: Without Docker, a computer can end up looking like a junk drawer. Applications
    have all sorts of dependencies. Some applications depend on specific system libraries
    for common things like sound, networking, graphics, and so on. Others depend on
    standard libraries for the language they’re written in. Some depend on other applications,
    such as the way a Java program depends on the Java Virtual Machine, or a web application
    might depend on a database. It’s common for a running program to require exclusive
    access to a scarce resource such as a network connection or a file.
  id: totrans-84
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 没有Docker，一台计算机最终可能看起来像是一个杂乱无章的抽屉。应用程序有各种各样的依赖项。一些应用程序依赖于特定的系统库来处理像声音、网络、图形等常见事物。其他应用程序依赖于它们所使用的语言的库。一些应用程序依赖于其他应用程序，例如Java程序依赖于Java虚拟机，或者一个网络应用程序可能依赖于数据库。一个正在运行的程序通常需要独占访问稀缺资源，如网络连接或文件。
- en: Today, without Docker, applications are spread all over the filesystem and end
    up creating a messy web of interactions. [Figure 1.5](#filepos128333) illustrates
    how example applications depend on example libraries without Docker.
  id: totrans-85
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 今天，如果没有Docker，应用程序会散布在文件系统中，最终形成一个混乱的交互网络。[图1.5](#filepos128333)展示了在没有Docker的情况下，示例应用程序如何依赖于示例库。
- en: Figure 1.5\. Dependency relationships of example programs
  id: totrans-86
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图1.5\. 示例程序的依赖关系
- en: '![](images/00057.jpg)'
  id: totrans-87
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![](images/00057.jpg)'
- en: In contrast, the example in [section 1.1.1](index_split_016.html#filepos98288)
    installed the required software automatically, and that same software can be reliably
    removed with a single command. Docker keeps things organized by isolating everything
    with containers and images.
  id: totrans-88
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 相比之下，[第1.1.1节](index_split_016.html#filepos98288)中的示例自动安装了所需的软件，并且可以使用单个命令可靠地删除该软件。Docker通过使用容器和镜像将一切隔离来保持事物的有序。
- en: '[Figure 1.6](#filepos129846) illustrates these same applications and their
    dependencies running inside containers. With the links broken and each application
    neatly contained, understanding the system is an approachable task. At first it
    seems like this would introduce storage overhead by creating redundant copies
    of common dependencies such as gcc. [Chapter 3](index_split_032.html#filepos303917)
    describes how the Docker packaging system typically reduces the storage overhead.'
  id: totrans-89
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '[图1.6](#filepos129846)说明了这些相同的应用程序及其依赖项在容器内运行的情况。由于链接被断开，每个应用程序都被整洁地包含在内，理解系统成为一个可接近的任务。起初，这似乎会通过创建如gcc等常见依赖项的冗余副本来引入存储开销。[第3章](index_split_032.html#filepos303917)描述了Docker打包系统通常如何减少存储开销。'
- en: Figure 1.6\. Example programs running inside containers with copies of their
    dependencies
  id: totrans-90
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图1.6. 在容器内运行并复制其依赖项的示例程序
- en: '![](images/00047.jpg)'
  id: totrans-91
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![图片](images/00047.jpg)'
- en: 1.2.2\. Improving portability
  id: totrans-92
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.2.2. 提高可移植性
- en: Another software problem is that an application’s dependencies typically include
    a specific operating system. Portability between operating systems is a major
    problem for software users. Although it’s possible to have compatibility between
    Linux software and macOS, using that same software on Windows can be more difficult.
    Doing so can require building whole ported versions of the software. Even that
    is possible only if suitable replacement dependencies exist for Windows. This
    represents a major effort for the maintainers of the application and is frequently
    skipped. Unfortunately for users, a whole wealth of powerful software is too difficult
    or impossible to use on their system.
  id: totrans-93
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 另一个软件问题是，应用程序的依赖项通常包括特定的操作系统。操作系统之间的可移植性是软件用户面临的一个主要问题。尽管Linux软件和macOS之间可能存在兼容性，但在Windows上使用相同的软件可能更困难。这样做可能需要构建整个移植版本的应用程序。即使这样，也只有在Windows存在合适的替代依赖项的情况下才可能。这对应用程序的维护者来说是一项重大努力，而且通常会被跳过。不幸的是，对于用户来说，大量强大的软件在他们的系统上使用起来太困难或不可能。
- en: At present, Docker runs natively on Linux and comes with a single virtual machine
    for macOS and Windows environments. This convergence on Linux means that software
    running in Docker containers need be written only once against a consistent set
    of dependencies. You might have just thought to yourself, “Wait a minute. You
    just finished telling me that Docker is better than virtual machines.” That’s
    correct, but they are complementary technologies. Using a virtual machine to contain
    a single program is wasteful. This is especially so when you’re running several
    virtual machines on the same computer. On macOS and Windows, Docker uses a single,
    small virtual machine to run all the containers. By taking this approach, the
    overhead of running a virtual machine is fixed, while the number of containers
    can scale up.
  id: totrans-94
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 目前，Docker在Linux上原生运行，并为macOS和Windows环境提供了一个单独的虚拟机。这种在Linux上的统一意味着在Docker容器中运行的软件只需针对一组一致的依赖项编写一次。你可能刚刚在想，“等等，你刚才不是告诉我Docker比虚拟机更好吗？”这是正确的，但它们是互补的技术。使用虚拟机来包含单个程序是浪费的。当你在一台计算机上运行多个虚拟机时，这种情况尤其如此。在macOS和Windows上，Docker使用单个小型虚拟机来运行所有容器。通过采取这种方法，运行虚拟机的开销是固定的，而容器的数量可以扩展。
- en: This new portability helps users in a few ways. First, it unlocks a whole world
    of software that was previously inaccessible. Second, it’s now feasible to run
    the same software—exactly the same software—on any system. That means your desktop,
    your development environment, your company’s server, and your company’s cloud
    can all run the same programs. Running consistent environments is important. Doing
    so helps minimize any learning curve associated with adopting new technologies.
    It helps software developers better understand the systems that will be running
    their programs. It means fewer surprises. Third, when software maintainers can
    focus on writing their programs for a single platform and one set of dependencies,
    it’s a huge time-saver for them and a great win for their customers.
  id: totrans-95
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这种新的可移植性以几种方式帮助用户。首先，它解锁了一个之前无法访问的软件世界。其次，现在可以在任何系统上运行相同的软件——确切地说，是相同的软件。这意味着你的桌面、你的开发环境、你公司的服务器以及你公司的云都可以运行相同的程序。运行一致的环境很重要。这样做有助于最小化与采用新技术相关的任何学习曲线。它有助于软件开发者更好地理解将运行其程序的系统。这意味着更少的意外。第三，当软件维护者可以专注于为单个平台和一组依赖项编写程序时，这对他们来说节省了大量时间，对他们的客户来说是一个巨大的胜利。
- en: Without Docker or virtual machines, portability is commonly achieved at an individual
    program level by basing the software on a common tool. For example, Java lets
    programmers write a single program that will mostly work on several operating
    systems because the programs rely on a program called a Java Virtual Machine (JVM).
    Although this is an adequate approach while writing software, other people, at
    other companies, wrote most of the software we use. For example, if we want to
    use a popular web server that was not written in Java or another similarly portable
    language, we doubt that the authors would take time to rewrite it for us. In addition
    to this shortcoming, language interpreters and software libraries are the very
    things that create dependency problems. Docker improves the portability of every
    program regardless of the language it was written in, the operating system it
    was designed for, or the state of the environment where it’s running.
  id: totrans-96
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 没有Docker或虚拟机，通常通过基于通用工具的软件来实现单个程序的可移植性。例如，Java允许程序员编写一个可以在多个操作系统上大部分正常工作的单一程序，因为程序依赖于一个名为Java虚拟机（JVM）的程序。虽然这在编写软件时是一个足够的方法，但其他公司的人编写了我们使用的绝大多数软件。例如，如果我们想使用一个流行的、不是用Java或其他类似可移植语言编写的Web服务器，我们怀疑作者会花时间为我们重写它。除了这个缺点之外，语言解释器和软件库正是造成依赖问题的东西。Docker提高了无论用何种语言编写的程序、为哪种操作系统设计的程序，还是在何种环境中运行的程序的可移植性。
- en: 1.2.3\. Protecting your computer
  id: totrans-97
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.2.3. 保护你的电脑
- en: 'Most of what we’ve mentioned so far have been problems from the perspective
    of working with software and the benefits of doing so from outside a container.
    But containers also protect us from the software running inside a container. There
    are all sorts of ways that a program might misbehave or present a security risk:'
  id: totrans-98
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 我们之前提到的大部分问题都是从使用软件的角度出发，以及从容器外部使用软件的好处。但容器也保护我们免受容器内运行的软件的影响。程序可能会以各种方式表现不当或带来安全风险：
- en: A program might have been written specifically by an attacker.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个程序可能是专门为攻击者编写的。
- en: Well-meaning developers could write a program with harmful bugs.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 好心的开发者可能会编写带有有害错误的程序。
- en: A program could accidentally do the bidding of an attacker through bugs in its
    input handling.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个程序可能会因为其输入处理中的漏洞而意外地执行攻击者的指令。
- en: Any way you cut it, running software puts the security of your computer at risk.
    Because running software is the whole point of having a computer, it’s prudent
    to apply the practical risk mitigations.
  id: totrans-102
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 无论从哪个角度看，运行软件都会使你的电脑安全处于风险之中。因为运行软件是拥有电脑的全部目的，所以采取实际的风险缓解措施是明智的。
- en: Like physical jail cells, anything inside a container can access only things
    that are inside it as well. Exceptions to this rule exist, but only when explicitly
    created by the user. Containers limit the scope of impact that a program can have
    on other running programs, the data it can access, and system resources. [Figure
    1.7](#filepos136324) illustrates the difference between running software outside
    and inside a container.
  id: totrans-103
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 就像物理牢房一样，容器内的任何东西只能访问它内部的东西。这个规则有例外，但只有当用户明确创建时。容器限制了程序对其他运行程序、它可以访问的数据和系统资源的影响范围。[图1.7](#filepos136324)说明了在容器外和容器内运行软件之间的差异。
- en: 'Figure 1.7\. Left: A malicious program with direct access to sensitive resources.
    Right: A malicious program inside a container.'
  id: totrans-104
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 图1.7. 左：直接访问敏感资源的恶意程序。右：容器内的恶意程序。
- en: '![](images/00044.jpg)'
  id: totrans-105
  prefs:
  - PREF_BQ
  type: TYPE_IMG
  zh: '![图片](images/00044.jpg)'
- en: What this means for you or your business is that the scope of any security threat
    associated with running a particular application is limited to the scope of the
    application itself. Creating strong application containers is complicated and
    a critical component of any in-depth defense strategy. It is far too commonly
    skipped or implemented in a half-hearted manner.
  id: totrans-106
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这对你或你的业务意味着，与运行特定应用程序相关的任何安全威胁的范围仅限于应用程序本身的范围。创建强大的应用程序容器很复杂，是任何深入防御策略的关键组成部分。它通常被忽视或半心半意地实施。
- en: 1.3\. WHY IS DOCKER IMPORTANT?
  id: totrans-107
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.3. 为什么Docker很重要？
- en: Docker provides an abstraction. Abstractions allow you to work with complicated
    things in simplified terms. So, in the case of Docker, instead of focusing on
    all the complexities and specifics associated with installing an application,
    all we need to consider is what software we’d like to install.
  id: totrans-108
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker提供了一个抽象。抽象允许你以简化的术语处理复杂的事物。因此，在Docker的情况下，我们不需要关注与安装应用程序相关的所有复杂性和具体细节，我们只需要考虑我们想要安装的软件即可。
- en: Like a crane loading a shipping container onto a ship, the process of installing
    any software with Docker is identical to any other. The shape or size of the thing
    inside the shipping container may vary, but the way that the crane picks up the
    container will always be the same. All the tooling is reusable for any shipping
    container.
  id: totrans-109
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 就像起重机将一个货柜装上船一样，使用Docker安装任何软件的过程与其他方式相同。货柜内部物品的形状或大小可能不同，但起重机提起货柜的方式始终如一。所有工具都可以用于任何货柜。
- en: This is also the case for application removal. When you want to remove software,
    you simply tell Docker which software to remove. No lingering artifacts will remain
    because they were all contained and accounted for by Docker. Your computer will
    be as clean as it was before you installed the software.
  id: totrans-110
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这也适用于应用程序的移除。当你想要移除软件时，你只需告诉Docker要移除哪个软件。由于所有这些都被Docker包含并记录在案，因此不会有任何残留的碎片。你的电脑将和安装软件之前一样干净。
- en: The container abstraction and the tools Docker provides for working with containers
    has changed the system administration and software development landscape. Docker
    is important because it makes containers available to everyone. Using it saves
    time, money, and energy.
  id: totrans-111
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 容器抽象和Docker提供的用于处理容器的工具已经改变了系统管理和软件开发领域。Docker之所以重要，是因为它让容器对每个人来说都变得可用。使用它可以节省时间、金钱和能源。
- en: The second reason Docker is important is that there is significant push in the
    software community to adopt containers and Docker. This push is so strong that
    companies including Amazon, Microsoft, and Google have all worked together to
    contribute to its development and adopt it in their own cloud offerings. These
    companies, which are typically at odds, have come together to support an open
    source project instead of developing and releasing their own solutions.
  id: totrans-112
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker之所以重要的第二个原因是，软件社区中有很大的推动力要采用容器和Docker。这种推动力非常强烈，以至于包括亚马逊、微软和谷歌在内的公司都共同合作，为其开发做出贡献，并在他们自己的云服务中采用它。这些通常存在分歧的公司聚集在一起，支持一个开源项目，而不是开发并发布他们自己的解决方案。
- en: The third reason Docker is important is that it has accomplished for the computer
    what app stores did for mobile devices. It has made software installation, compartmentalization,
    and removal simple. Better yet, Docker does it in a cross-platform and open way.
    Imagine if all the major smartphones shared the same app store. That would be
    a pretty big deal. With this technology in place, it’s possible that the lines
    between operating systems may finally start to blur, and third-party offerings
    will be less of a factor in choosing an operating system.
  id: totrans-113
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker之所以重要的第三个原因是，它为计算机完成了应用商店为移动设备所做的事情。它使软件安装、分区和移除变得简单。更好的是，Docker以跨平台和开放的方式完成这些。想象一下，如果所有的主要智能手机都使用同一个应用商店，那将是一件大事。有了这项技术，操作系统之间的界限可能最终开始变得模糊，第三方产品在选择操作系统时的影响力将减小。
- en: Fourth, we’re finally starting to see better adoption of some of the more advanced
    isolation features of operating systems. This may seem minor, but quite a few
    people are trying to make computers more secure through isolation at the operating
    system level. It’s been a shame that their hard work has taken so long to see
    mass adoption. Containers have existed for decades in one form or another. It’s
    great that Docker helps us take advantage of those features without all the complexity.
  id: totrans-114
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 第四，我们终于开始看到操作系统一些更高级隔离功能的更好采用。这看起来可能微不足道，但相当多的人正在尝试通过操作系统级别的隔离来使计算机更加安全。他们的辛勤工作如此长时间才得到大规模采用，这确实令人遗憾。容器以某种形式存在了几十年。Docker帮助我们利用这些功能，而不必承受所有复杂性，这真是太好了。
- en: 1.4\. WHERE AND WHEN TO USE DOCKER
  id: totrans-115
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.4\. 何时何地使用DOCKER
- en: Docker can be used on most computers at work and at home. Practically, how far
    should this be taken?
  id: totrans-116
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker可以在大多数工作和家庭计算机上使用。实际上，应该将其扩展到什么程度？
- en: Docker can run almost anywhere, but that doesn’t mean you’ll want to do so.
    For example, currently Docker can run only applications that can run on a Linux
    operating system, or Windows applications on Windows Server. If you want to run
    a macOS or Windows native application on your desktop, you can’t yet do so with
    Docker.
  id: totrans-117
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Docker几乎可以在任何地方运行，但这并不意味着您一定会想这样做。例如，目前Docker只能运行在Linux操作系统上运行的应用程序，或者在Windows
    Server上运行的Windows应用程序。如果您想在您的桌面上运行macOS或Windows原生应用程序，您目前还不能使用Docker来做到这一点。
- en: By narrowing the conversation to software that typically runs on a Linux server
    or desktop, a solid case can be made for running almost any application inside
    a container. This includes server applications such as web servers, mail servers,
    databases, proxies, and the like. Desktop software such as web browsers, word
    processors, email clients, or other tools are also a great fit. Even trusted programs
    are as dangerous to run as a program you downloaded from the internet if they
    interact with user-provided data or network data. Running these in a container
    and as a user with reduced privileges will help protect your system from attack.
  id: totrans-118
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 通过将对话缩小到通常在Linux服务器或桌面运行的软件，可以有力地论证几乎任何应用程序都可以在容器内运行。这包括服务器应用程序，如Web服务器、邮件服务器、数据库、代理等。桌面软件，如网络浏览器、文字处理器、电子邮件客户端或其他工具也非常适合。即使是受信任的程序，如果它们与用户提供的或网络数据交互，其危险性也如同从互联网下载的程序一样。将这些程序在容器中以具有较低权限的用户身份运行，将有助于保护您的系统免受攻击。
- en: Beyond the added in-depth benefit of defense, using Docker for day-to-day tasks
    helps keep your computer clean. Keeping a clean computer will prevent you from
    running into shared resource issues and ease software installation and removal.
    That same ease of installation, removal, and distribution simplifies management
    of computer fleets and could radically change the way companies think about maintenance.
  id: totrans-119
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 除了增加的深入防御优势外，使用DOCKER进行日常任务有助于保持您的计算机整洁。保持计算机整洁可以防止您遇到共享资源问题，并简化软件的安装和卸载。同样的安装、卸载和分发便利性简化了计算机群的管理，并可能彻底改变公司对维护的看法。
- en: The most important thing to remember is that sometimes containers are inappropriate.
    Containers won’t help much with the security of programs that have to run with
    full access to the machine. At the time of this writing, doing so is possible
    but complicated. Containers are not a total solution for security issues, but
    they can be used to prevent many types of attacks. Remember, you shouldn’t use
    software from untrusted sources. This is especially true if that software requires
    administrative privileges. That means it’s a bad idea to blindly run customer-provided
    containers in a co-located environment.
  id: totrans-120
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 最重要的是要记住，有时容器并不适用。容器对需要完全访问机器的程序的安全性帮助不大。在撰写本文时，这样做是可能的，但很复杂。容器不是安全问题的全面解决方案，但它们可以用来防止许多类型的攻击。记住，您不应该使用来自不可信来源的软件。如果该软件需要管理员权限，这一点尤其正确。这意味着盲目在协同定位环境中运行客户提供的容器是一个糟糕的主意。
- en: 1.5\. DOCKER IN THE LARGER ECOSYSTEM
  id: totrans-121
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.5\. 在更大生态系统中的DOCKER
- en: Today the greater container ecosystem is rich with tooling that solves new or
    higher-level problems. Those problems include container orchestration, high-availability
    clustering, microservice life cycle management, and visibility. It can be tricky
    to navigate that market without depending on keyword association. It is even trickier
    to understand how Docker and those products work together.
  id: totrans-122
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 今天，更大的容器生态系统拥有丰富的工具，可以解决新的或更高层次的问题。这些问题包括容器编排、高可用性集群、微服务生命周期管理和可见性。在没有依赖关键词关联的情况下，在这个市场中导航可能会很棘手。理解
    Docker 和那些产品如何协同工作甚至更困难。
- en: Those products work with Docker in the form of plugins or provide a certain
    higher-level functionality and depend on Docker. Some tools use the Docker subcomponents.
    Those subcomponents are independent projects such as runc, libcontainerd, and
    notary.
  id: totrans-123
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这些产品以插件的形式与 Docker 一起工作，或提供某种更高层次的功能，并依赖于 Docker。一些工具使用 Docker 的子组件。这些子组件是独立的项目，例如
    runc、libcontainerd 和 notary。
- en: Kubernetes is the most notable project in the ecosystem aside from Docker itself.
    Kubernetes provides an extensible platform for orchestrating services as containers
    in clustered environments. It is growing into a sort of “datacenter operating
    system.” Like the Linux Kernel, cloud providers and platform companies are packaging
    Kubernetes. Kubernetes depends on container engines such as Docker, and so the
    containers and images you build on your laptop will run in Kubernetes.
  id: totrans-124
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: Kubernetes 是生态系统中最引人注目的项目，除了 Docker 本身之外。Kubernetes 为在集群环境中编排服务作为容器提供了一个可扩展的平台。它正在成长为一个“数据中心操作系统”。像
    Linux 内核一样，云提供商和平台公司正在打包 Kubernetes。Kubernetes 依赖于容器引擎，如 Docker，因此您在笔记本电脑上构建的容器和镜像将在
    Kubernetes 中运行。
- en: You need to consider several trade-offs when picking up any tool. Kubernetes
    draws power from its extensibility, but that comes at the expense of its learning
    curve and ongoing support effort. Today building, customizing, or extending Kubernetes
    clusters is a full-time job. But using existing Kubernetes clusters to deploy
    your applications is straightforward with minimal research. Most readers looking
    at Kubernetes should consider adopting a managed offering from a major public
    cloud provider before building their own. This book focuses on and teaches solutions
    to higher-level problems using Docker alone. Once you understand what the problems
    are and how to solve them with one tool, you’re more likely to succeed in picking
    up more complicated tooling.
  id: totrans-125
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在选择任何工具时，您需要考虑几个权衡。Kubernetes 从其可扩展性中汲取力量，但这是以学习曲线和持续支持工作为代价的。今天，构建、定制或扩展 Kubernetes
    集群是一项全职工作。但使用现有的 Kubernetes 集群来部署您的应用程序却很简单，只需进行最少的研究。大多数查看 Kubernetes 的读者在构建自己的集群之前应该考虑采用主要公共云提供商的托管服务。本书专注于并教授使用
    Docker 解决更高层次问题的解决方案。一旦您了解了问题是什么以及如何使用一个工具来解决它们，您更有可能成功地掌握更复杂的工具。
- en: 1.6\. GETTING HELP WITH THE DOCKER COMMAND LINE
  id: totrans-126
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 1.6\. 使用 Docker 命令行程序获取帮助
- en: 'You’ll use the `docker` command-line program throughout the rest of this book.
    To get you started with that, we want to show you how to get information about
    commands from the `docker` program itself. This way, you’ll understand how to
    use the exact version of Docker on your computer. Open a terminal, or command
    prompt, and run the following command:'
  id: totrans-127
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 您将在本书的其余部分使用 `docker` 命令行程序。为了让您开始使用它，我们想向您展示如何从 `docker` 程序本身获取有关命令的信息。这样，您就会了解如何使用您计算机上的确切版本的
    Docker。打开终端或命令提示符，并运行以下命令：
- en: '`docker help`'
  id: totrans-128
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`docker help`'
- en: Running `docker help` will display information about the basic syntax for using
    the `docker` command-line program as well as a complete list of commands for your
    version of the program. Give it a try and take a moment to admire all the neat
    things you can do.
  id: totrans-129
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 运行 `docker help` 将显示有关使用 `docker` 命令行程序的基本语法以及程序版本的完整命令列表。试一试，并花点时间欣赏您能做的事情。
- en: '`docker help` gives you only high-level information about what commands are
    available. To get detailed information about a specific command, include the command
    in the `<COMMAND>` argument. For example, you might enter the following command
    to find out how to copy files from a location inside a container to a location
    on the host machine:'
  id: totrans-130
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`docker help` 只会提供关于可用命令的高级信息。要获取特定命令的详细信息，请将命令包含在 `<COMMAND>` 参数中。例如，您可能输入以下命令来了解如何将容器内部位置上的文件复制到主机机器上的位置：'
- en: '`docker help cp`'
  id: totrans-131
  prefs:
  - PREF_BQ
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '`docker help cp`'
- en: That will display a usage pattern for `docker cp`, a general description of
    what the command does, and a detailed breakdown of its arguments. We’re confident
    that you’ll have a great time working through the commands introduced in the rest
    of this book now that you know how to find help if you need it.
  id: totrans-132
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这将显示 `docker cp` 的使用模式，该命令的一般描述以及其参数的详细分解。我们相信，现在你知道了如何查找帮助，如果你需要的话，你将能够愉快地完成本书中介绍的其他命令。
- en: SUMMARY
  id: totrans-133
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 摘要
- en: 'This chapter has been a brief introduction to Docker and the problems it helps
    system administrators, developers, and other software users solve. In this chapter
    you learned that:'
  id: totrans-134
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 本章简要介绍了 Docker 以及它帮助系统管理员、开发人员和其他软件用户解决的问题。在本章中，你了解到：
- en: Docker takes a logistical approach to solving common software problems and simplifies
    your experience with installing, running, publishing, and removing software. It’s
    a command-line program, an engine background process, and a set of remote services.
    It’s integrated with community tools provided by Docker Inc.
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker 采用物流方法来解决常见的软件问题，并简化了你在安装、运行、发布和删除软件时的体验。它是一个命令行程序、一个后台引擎进程以及一系列远程服务。它与
    Docker Inc. 提供的社区工具集成。
- en: The container abstraction is at the core of its logistical approach.
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 容器抽象是其物流方法的核心。
- en: Working with containers instead of software creates a consistent interface and
    enables the development of more sophisticated tools.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用容器而不是软件创建了一个一致的接口，并使得更复杂的工具的开发成为可能。
- en: Containers help keep your computers tidy because software inside containers
    can’t interact with anything outside those containers, and no shared dependencies
    can be formed.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 容器有助于保持你的计算机整洁，因为容器内的软件无法与容器外部的东西交互，也无法形成共享依赖。
- en: Because Docker is available and supported on Linux, macOS, and Windows, most
    software packaged in Docker images can be used on any computer.
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于 Docker 可在 Linux、macOS 和 Windows 上使用并得到支持，因此大多数打包在 Docker 镜像中的软件都可以在任何计算机上使用。
- en: Docker doesn’t provide container technology; it hides the complexity of working
    directly with the container software and turns best practices into reasonable
    defaults.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker 不提供容器技术；它隐藏了直接与容器软件工作的复杂性，并将最佳实践转化为合理的默认设置。
- en: Docker works with the greater container ecosystem; that ecosystem is rich with
    tooling that solves new and higher-level problems.
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker 与更大的容器生态系统协同工作；该生态系统拥有丰富的工具，可以解决新的和更高级别的问题。
- en: If you need help with a command, you can always consult the `docker help` subcommand.
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你在使用命令时需要帮助，你可以始终咨询 `docker help` 子命令。
