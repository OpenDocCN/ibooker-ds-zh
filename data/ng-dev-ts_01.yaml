- en: Chapter 2\. The main artifacts of an Angular app
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第 2 章. Angular 应用的主要工件
- en: '*This chapter covers*'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '*本章涵盖*'
- en: Understanding components, directives, services, modules, and pipes
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解组件、指令、服务、模块和管道
- en: Generating components, directives, services, and routes with Angular CLI
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Angular CLI 生成组件、指令、服务和路由
- en: Looking at Angular data bindings
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看 Angular 数据绑定
- en: Building the first version of the ngAuction app
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建 ngAuction 应用的第一个版本
- en: In this chapter, we’ll start by explaining the roles of the main artifacts of
    Angular applications. We’ll introduce you to each one and show how Angular CLI
    can generate these artifacts. Then we’ll do an overview of the Angular CLI configuration
    file where you can modify your project settings.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将首先解释 Angular 应用主要工件的作用。我们将向你介绍每一个，并展示 Angular CLI 如何生成这些工件。然后我们将概述 Angular
    CLI 配置文件，你可以在这里修改你的项目设置。
- en: After that, we’ll discuss how data binding is implemented in Angular. At the
    end of the chapter, you’ll develop the initial version of the ngAuction application
    that you’ll continue working on throughout the book.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，我们将讨论如何在 Angular 中实现数据绑定。在本章结束时，你将开发 ngAuction 应用的初始版本，你将在整本书中继续对其进行工作。
- en: 2.1\. Components
  id: totrans-8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.1. 组件
- en: A component, the main artifact of any Angular app, is a class with a view (UI).
    To turn a class into component, you need to decorate it with the `@Component()`
    decorator. A component can consist of one or more files—for example, a file with
    the extension .ts with the component class, a .css file with styles, an .html
    file with a template, and a .spec.ts file with test code for the component.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 组件，任何 Angular 应用的主要工件，是一个带有视图（UI）的类。要将一个类转换为组件，你需要用 `@Component()` 装饰器对其进行装饰。一个组件可以由一个或多个文件组成——例如，一个扩展名为
    .ts 的文件，其中包含组件类，一个 .css 文件包含样式，一个 .html 文件包含模板，以及一个 .spec.ts 文件包含组件的测试代码。
- en: You don’t have to split the code of each component into these files. For example,
    you can have a component in just one file with inline styles and templates and
    no files with tests. No matter how many files will represent your component, they
    all should be located in the same directory.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 你不必将每个组件的代码分割到这些文件中。例如，你可以将一个组件放在一个文件中，包含内联样式和模板，并且没有测试的文件。无论有多少文件代表你的组件，它们都应该位于同一个目录中。
- en: Any component belongs to exactly one module of an app, and you have to include
    the name of the component’s class into the `declarations` property of the `@NgModule()`
    decorator in the module file. In [chapter 1](kindle_split_010.xhtml#ch01), we
    already had an `AppComponent` listed in the `AppModule`.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 任何组件都属于应用的一个确切模块，你必须将组件类的名称包含在模块文件中 `@NgModule()` 装饰器的 `declarations` 属性中。在
    [第 1 章](kindle_split_010.xhtml#ch01) 中，我们已经将 `AppComponent` 列在 `AppModule` 中。
- en: '|  |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**The ng generate command of Angular CLI**'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: '**Angular CLI 的 ng generate 命令**'
- en: 'Even after generating a new project, you can keep using Angular CLI for generating
    artifacts by using the `ng generate` command or its alias `ng g`. Here are some
    options you can use with the `ng g` command:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 即使在生成新项目之后，你仍然可以使用 Angular CLI 通过使用 `ng generate` 命令或其别名 `ng g` 来生成工件。以下是一些你可以与
    `ng g` 命令一起使用的选项：
- en: '**`ng g c`—** Generates a new component.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng g c`——** 生成一个新的组件。'
- en: '**`ng g s`—** Generates a new service.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng g s`——** 生成一个新的服务。'
- en: '**`ng g d`—** Generates a new directive.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng g d`——** 生成一个新的指令。'
- en: '**`ng g m`—** Generates a new module.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng g m`——** 生成一个新的模块。'
- en: '**`ng g application`—** Generates a new app within the same project. This command
    was introduced in Angular 6.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng g application`——** 在同一个项目中生成一个新的应用。这个命令是在 Angular 6 中引入的。'
- en: '**`ng g library`—** Starting with Angular 6, you can generate a library project.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng g library`——** 从 Angular 6 开始，你可以生成一个库项目。'
- en: This is not an app, but can include services and components as well.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 这不是一个应用，但它可以包括服务和组件。
- en: Each of these commands requires an argument, such as the name of the item, to
    generate. For a complete list of available options and arguments, run the `ng
    help generate` command or refer to the Angular CLI documentation.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 每个这些命令都需要一个参数，例如项目的名称，来生成。要获取完整的选项和参数列表，请运行 `ng help generate` 命令或参考 Angular
    CLI 文档。
- en: 'Here are some examples of using the `ng g` command:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是使用 `ng g` 命令的一些示例：
- en: '`ng g c product` will generate four files for a new product component in the
    src/app/product directory and add the `ProductComponent` class to the `declarations`
    property of `@NgModule`.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ng g c product` 将在 src/app/product 目录中为新的产品组件生成四个文件，并将 `ProductComponent`
    类添加到 `@NgModule` 的 `declarations` 属性中。'
- en: '`ng g c product -is --it --spec false` will generate a single file, product.component.ts,
    with inlined styles and template and no test in the src/app/product directory,
    and add `ProductComponent` to the `declarations` property of `@NgModule`.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ng g c product -is --it --spec false` 将在 src/app/product 目录中生成一个包含内联样式和模板的单个文件
    product.component.ts，且不包含测试，并将 `ProductComponent` 添加到 `@NgModule` 的 `declarations`
    属性中。'
- en: '`ng g s product` will generate the file product.service.ts containing a class
    decorated with `@Injectable` and the file product.service.spec.ts in the src/app
    directory.'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ng g s product` 将生成包含用 `@Injectable` 装饰的类的文件 product.service.ts，以及位于 src/app
    目录中的 product.service.spec.ts 文件。'
- en: '`ng g s product -m app.module` will generate the same files as the preceding
    command and will also add `ProductService` to the `providers` property of `@NgModule`.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '`ng g s product -m app.module` 将生成与前面命令相同的文件，并将 `ProductService` 添加到 `@NgModule`
    的 `providers` 属性中。'
- en: '|  |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 'Let’s add a product component to the Hello CLI project you created in [chapter
    1](kindle_split_010.xhtml#ch01) by running the following command in the root directory
    of that project:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在第 1 章中创建的 Hello CLI 项目中添加一个产品组件，通过在该项目的根目录中运行以下命令：
- en: '[PRE0]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This command will create the src/app/product directory with the product.component
    .ts file.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将在 src/app/product 目录中创建 product.component.ts 文件。
- en: Listing 2.1\. product.component.ts
  id: totrans-32
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.1\. product.component.ts
- en: '[PRE1]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '***1* A default text to render**'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 默认要渲染的文本**'
- en: '***2* Implementing OnInit requires the ngOnInit() method in the class.**'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 实现 OnInit 需要在类中实现 ngOnInit() 方法。**'
- en: '***3* A lifecycle method**'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 生命周期方法**'
- en: The generated `@Component()` decorator has the `app-product` selector, the `template`
    property with inlined HTML, and the `styles` property for inline CSS. Other components
    can include your product component in their templates by using the `<app-product>`
    tag.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的 `@Component()` 装饰器具有 `app-product` 选择器，带有内联 HTML 的 `template` 属性，以及用于内联
    CSS 的 `styles` 属性。其他组件可以通过使用 `<app-product>` 标签将你的产品组件包含在其模板中。
- en: The class in [listing 2.1](#ch02ex01) has an empty constructor and one method,
    `ngOnInit()`, which is one of the component lifecycle methods. If implemented,
    `ngOnInit()` is invoked after the code in the constructor. `OnInit` is one of
    the lifecycle interfaces that require the implementation of `ngOnInit()`. We’ll
    cover a component lifecycle in [section 9.2](kindle_split_018.xhtml#ch09lev1sec2)
    in [chapter 9](kindle_split_018.xhtml#ch09).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[列表 2.1](#ch02ex01) 中的类有一个空的构造函数和一个方法，`ngOnInit()`，这是组件生命周期方法之一。如果实现，`ngOnInit()`
    将在构造函数中的代码之后调用。`OnInit` 是需要实现 `ngOnInit()` 的生命周期接口之一。我们将在第 9 章的 [9.2 节](kindle_split_018.xhtml#ch09lev1sec2)中介绍组件生命周期。'
- en: '|  |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-40
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: The `@Component()` decorator has a few more properties that we’ll discuss when
    it comes time to use them. All properties of the `@Component()` decorator are
    described at [https://angular.io/api/core/Component](https://angular.io/api/core/Component).
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '`@Component()` 装饰器还有一些其他属性，我们将在使用它们的时候讨论。`@Component()` 装饰器的所有属性都描述在 [https://angular.io/api/core/Component](https://angular.io/api/core/Component)。'
- en: '|  |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '|  |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Using selector prefixes**'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**使用选择器前缀**'
- en: 'The selector of the component in [listing 2.1](#ch02ex01) has the prefix `app-`,
    which is a default prefix for apps. For library projects, the default prefix is
    `lib-`. A good practice is to come up with a more specific prefix that would better
    identify your application. Your project is called Hello CLI, so you may want to
    give the `hello-` prefix to all your components. To do this, use the `-prefix`
    option while generating your components:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '[列表 2.1](#ch02ex01) 中的组件选择器以 `app-` 为前缀，这是应用程序的默认前缀。对于库项目，默认前缀是 `lib-`。一个好的做法是想出一个更具体的、能更好地识别你的应用程序的前缀。你的项目名为
    Hello CLI，因此你可能希望给你的所有组件都加上 `hello-` 前缀。为此，在生成组件时使用 `-prefix` 选项：'
- en: '[PRE2]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: That command would generate a component with the `hello-product` selector. An
    easier way to ensure that all generated components have a specific prefix is to
    specify the prefix in the file .angular-cli.json (or in angular.json, starting
    with Angular 6), discussed later in this chapter.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令将生成一个具有 `hello-product` 选择器的组件。确保所有生成的组件都有一个特定前缀的一个更简单的方法是在文件 .angular-cli.json（或从
    Angular 6 开始的 angular.json）中指定前缀，这将在本章后面讨论。
- en: '|  |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 'If you open the app.module.ts file, you’ll see that `ProductComponent` has
    been imported and added to the `declarations` section by your `ng g c` command:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你打开 app.module.ts 文件，你会看到 `ProductComponent` 已经被你的 `ng g c` 命令导入并添加到 `declarations`
    部分：
- en: '[PRE3]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The newly generated `ProductComponent` class was added to the `declarations`
    property of `@NgModule()`. We’ll keep using components in each chapter of this
    book so you’ll get a chance to learn the various features of Angular components.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 新生成的`ProductComponent`类被添加到`@NgModule()`的`declarations`属性中。在这本书的每一章中，我们都会继续使用组件，这样你就有机会学习Angular组件的各种功能。
- en: '|  |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: '**What’s metadata?**'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**什么是元数据？**'
- en: TypeScript decorators allow you to modify the behavior of a class, property,
    or method (or its arguments) without changing their code by enabling you to provide
    metadata about the decorated artifact. In general, *metadata* is additional information
    about data. For example, in an MP3 file, the audio is the data, but the name of
    the artist, song title, and album cover are metadata. MP3 players include metadata
    processors that read the metadata and display some of it while playing the song.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: TypeScript装饰器允许你通过提供关于装饰实体的元数据来修改类、属性或方法（或其参数）的行为，而无需更改它们的代码。一般来说，*元数据*是关于数据的额外信息。例如，在MP3文件中，音频是数据，但艺术家名称、歌曲标题和专辑封面是元数据。MP3播放器包括元数据处理器，可以读取元数据并在播放歌曲时显示其中的一些信息。
- en: In the case of classes, metadata refers to additional information about the
    class. For example, the `@Component()` decorator tells Angular (the metadata processor)
    that this is not a regular class, but a component. Angular generates additional
    JavaScript code based on the information provided in the properties of the `@Component()`
    nsdecorator to turn a class into a UI component. The `@Component()` decorator
    doesn’t change the internals of the decorated class but adds some data describing
    the class so the Angular compiler can properly generate the final code of the
    component.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在类的情况下，元数据指的是关于类的额外信息。例如，`@Component()`装饰器告诉Angular（元数据处理器）这不是一个普通类，而是一个组件。Angular根据`@Component()`装饰器属性中提供的信息生成额外的JavaScript代码，将类转换为UI组件。`@Component()`装饰器不会改变装饰类的内部结构，而是添加一些描述类的数据，以便Angular编译器可以正确生成组件的最终代码。
- en: In the case of class properties, the `@Input()` decorator tells Angular that
    this class property should support binding and be able to receive data from the
    parent component. You’ll learn about the `@Input()` decorator in [section 8.2.1](kindle_split_017.xhtml#ch08lev2sec1)
    in [chapter 8](kindle_split_017.xhtml#ch08).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在类属性的情况下，`@Input()`装饰器告诉Angular这个类属性应该支持绑定，并能够从父组件接收数据。你将在[第八章的8.2.1节](kindle_split_017.xhtml#ch08lev2sec1)中学习关于`@Input()`装饰器的更多内容。
- en: Under the hood, a decorator is a function that attaches some data to the decorated
    element. See [section B.10](kindle_split_026.xhtml#app02lev1sec10) in [appendix
    B](kindle_split_026.xhtml#app02) for more details.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在底层，装饰器是一个将一些数据附加到装饰元素上的函数。有关更多详细信息，请参阅[附录B中的B.10节](kindle_split_026.xhtml#app02lev1sec10)。
- en: '|  |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: A component is a class with a UI, and a service is a class where you implement
    the business logic of your app. Let’s get familiar with services.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 组件是一个具有UI的类，而服务是一个实现应用程序业务逻辑的类。让我们熟悉一下服务。
- en: 2.2\. Services
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.2\. 服务
- en: For cleaner code separation, we usually don’t use a component for code that
    fetches or manipulates data. An injectable service is the right place for handling
    data. A component may depend on one or more services. [Chapter 5](kindle_split_014.xhtml#ch05)
    covers how dependency injection works in Angular. Here, we’ll give you an idea
    of how services and components work together.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更清晰地分离代码，我们通常不会为获取或操作数据的代码使用组件。注入式服务是处理数据的正确位置。一个组件可能依赖于一个或多个服务。[第五章](kindle_split_014.xhtml#ch05)介绍了Angular中依赖注入的工作原理。在这里，我们将向您展示服务和组件是如何协同工作的。
- en: 'Let’s start with generating a service in a shared folder, assuming that this
    service will be used by multiple components. To ensure that the `providers` property
    of `@NgModule()` will be updated with the newly generated service, use the following
    option:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从在共享文件夹中生成一个服务开始，假设这个服务将被多个组件使用。为了确保`@NgModule()`的`providers`属性会更新为新生成的服务，请使用以下选项：
- en: '[PRE4]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The new file product.service.ts will be generated in the src/app/shared directory:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 新文件product.service.ts将在src/app/shared目录下生成：
- en: '[PRE5]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Accordingly, the app.module.ts file will be updated to include the provider
    for this service:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，app.module.ts文件将被更新以包含此服务的提供者：
- en: '[PRE6]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Next, implement some methods in `ProductService` with the required business
    logic. Note that the generated `ProductService` class is annotated with the `@Injectable()`
    decorator. To have Angular instantiate and inject this service into any component,
    add the following argument to the component’s constructor:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，在 `ProductService` 中实现一些具有所需业务逻辑的方法。请注意，生成的 `ProductService` 类被 `@Injectable()`
    装饰器注解。为了使 Angular 实例化并将此服务注入到任何组件中，请将以下参数添加到组件的构造函数中：
- en: '[PRE7]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: A service isn’t the only artifact without a UI. Directives also don’t have their
    own UI, but they can be attached to the UI of components.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 服务并不是唯一没有 UI 的工件。指令也没有自己的 UI，但它们可以附加到组件的 UI 上。
- en: '|  |'
  id: totrans-71
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**What’s new in Angular 6**'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '**Angular 6 的新特性**'
- en: 'Starting from Angular 6, the `ng g s` command generates a class with the `Injectable()`
    decorator:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 从 Angular 6 开始，`ng g s` 命令生成一个带有 `Injectable()` 装饰器的类：
- en: '[PRE8]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '`provideIn: ''root''` allows you to skip the step of specifying the service
    in the `providers` property of the `NgModule()` decorator.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '`provideIn: ''root''` 允许您跳过在 `NgModule()` 装饰器的 `providers` 属性中指定服务的步骤。'
- en: '|  |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 2.3\. Directives
  id: totrans-77
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3\. 指令
- en: Think of an Angular directive as an HTML enhancer. Directives allow you to teach
    an old HTML element new tricks. A *directive* is a class annotated with the `@Directive()`
    decorator. You’ll see the `@Directive()` decorator used in [section 11.7](kindle_split_020.xhtml#ch11lev1sec7)
    in [chapter 11](kindle_split_020.xhtml#ch11).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 将 Angular 指令视为 HTML 增强器。指令允许您教一个旧的 HTML 元素新的技巧。*指令* 是一个带有 `@Directive()` 装饰器的类。您将在第
    11 章的第 11.7 节（[section 11.7](kindle_split_020.xhtml#ch11lev1sec7)）中看到 `@Directive()`
    装饰器的使用。
- en: 'A directive can’t have its own UI, but can be attached to a component or a
    regular HTML element to change their visual representation. There are two types
    of directives in Angular:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 指令不能有自己的 UI，但可以附加到组件或常规 HTML 元素上以改变它们的视觉表示。Angular 中有两种类型的指令：
- en: '***Structural*—** The directive changes the structure of the component’s template.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***结构型*—** 指令改变组件模板的结构。'
- en: '***Attribute*—** The directive changes the behavior or visual representation
    of an individual component or HTML element.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***属性型*—** 指令改变单个组件或 HTML 元素的行性行为或视觉表示。'
- en: For example, with the structural `*ngFor` directive, you can iterate through
    an array (or other collection) and render an HTML element for each item of the
    array. The following listing uses the `*ngFor` directive to loop through the `products`
    array and render an `<li>` element for each product (assuming there’s an interface
    or `Product` class with a `title` property).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，使用结构型 `*ngFor` 指令，您可以遍历数组（或其他集合），并为数组中的每个项目渲染一个 HTML 元素。以下列表使用 `*ngFor` 指令遍历
    `products` 数组，并为每个产品渲染一个 `<li>` 元素（假设有一个接口或 `Product` 类，其中有一个 `title` 属性）。
- en: Listing 2.2\. Iterating through products with `*ngFor`
  id: totrans-83
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.2\. 使用 `*ngFor` 迭代产品
- en: '[PRE9]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '***1* Renders <li> for each product**'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 为每个产品渲染 <li>**'
- en: '***2* Each <li> element shows the product title.**'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 每个 <li> 元素显示产品标题。**'
- en: '***3* *ngFor iterates through this array.**'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* *ngFor 遍历此数组。**'
- en: 'The following element uses the structural `*ngIf` directive to either show
    or hide the `<mat-error>` element, depending on the return (true or false) of
    the `hasError()` method, which checks whether the value in a form field `title`
    has invalid minimum length:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 以下元素使用结构型 `*ngIf` 指令根据 `hasError()` 方法返回的（true 或 false）来显示或隐藏 `<mat-error>`
    元素，该方法检查表单字段 `title` 中的值是否具有无效的最小长度：
- en: '[PRE10]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Later in this chapter when we talk about two-way binding, we’ll use the attribute
    `ngModel` directive to bind the value in the `<input>` element to a class variable,
    `shippingAddress`:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章后面讨论双向绑定时，我们将使用属性 `ngModel` 指令将 `<input>` 元素中的值绑定到类变量 `shippingAddress`：
- en: '[PRE11]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: You can create custom attribute directives as well, described in the product
    documentation at [https://angular.io/guide/attribute-directives](https://angular.io/guide/attribute-directives).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以创建自定义属性指令，这在产品文档 [https://angular.io/guide/attribute-directives](https://angular.io/guide/attribute-directives)
    中有描述。
- en: Yet another artifact that doesn’t have its own UI but that can transform values
    in the component template is a pipe.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个没有自己的 UI 但可以在组件模板中转换值的工件是管道。
- en: 2.4\. Pipes
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4\. 管道
- en: 'A *pipe* is a template element that allows you to transform a value into a
    desired output. A pipe is specified by adding the vertical bar (`|`) and the pipe
    name right after the value to be transformed:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: '*管道* 是一个模板元素，允许您将一个值转换成期望的输出。通过在要转换的值后添加垂直线（`|`）和管道名称来指定管道：'
- en: '[PRE12]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'In the preceding example, the value of the `birthday` variable will be transformed
    into a date of a default format. Angular comes with a number of built-in pipes,
    and each pipe has a class that implements its functionality (for example, `DatePipe`)
    as well as the name that you can use in the template (such as `date`):'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例中，`birthday`变量的值将被转换为默认格式的日期。Angular附带了许多内置管道，每个管道都有一个实现其功能的类（例如，`DatePipe`），以及你可以在模板中使用的名称（例如`date`）：
- en: An `UpperCasePipe` allows you to convert an input string to uppercase by using
    `| uppercase` in the template.
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`UpperCasePipe`允许你通过在模板中使用`| uppercase`将输入字符串转换为大写。'
- en: A `LowerCasePipe` allows you to convert an input string to lowercase by using
    `| lowercase` in the template.
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`LowerCasePipe`允许你通过在模板中使用`| lowercase`将输入字符串转换为小写。'
- en: A `DatePipe` allows you to display a date in different formats by using `| date`.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`DatePipe`允许你通过使用`| date`来以不同的格式显示日期。'
- en: A `CurrencyPipe` transforms a number into a desired currency by using `| currency`.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CurrencyPipe`通过使用`| currency`将数字转换为所需的货币。'
- en: An `AsyncPipe` unwraps the data from the provided `Observable` stream by using
    `| async`. You’ll see a code sample that uses `async` in [section 6.5](kindle_split_015.xhtml#ch06lev1sec5)
    in [chapter 6](kindle_split_015.xhtml#ch06).
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`AsyncPipe`通过使用`| async`来展开提供的`Observable`流中的数据。你将在[第6.5节](kindle_split_015.xhtml#ch06lev1sec5)中找到使用`async`的代码示例，该节位于[第6章](kindle_split_015.xhtml#ch06)。'
- en: 'Some pipes don’t require input parameters (such as `uppercase`), and some do
    (such as `date:''medium''`). You can chain as many pipes as you want. The following
    code snippet shows how you can display the value of the `birthday` variable in
    a medium date format and in uppercase (for example, JUN 15, 2001, 9:43:11 PM):'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 一些管道不需要输入参数（例如`uppercase`），而一些则需要（例如`date:'medium'`）。你可以链式调用任意数量的管道。以下代码片段展示了如何以中等日期格式和大写形式（例如，JUN
    15, 2001, 9:43:11 PM）显示`birthday`变量的值：
- en: '[PRE13]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: As you can see, with literally no coding you can convert a date into the required
    format as well as show it uppercase (see the date formats in the Angular `DatePipe`
    documentation, [http://mng.bz/78lD](http://mng.bz/78lD)).
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，实际上无需编写任何代码，你就可以将日期转换为所需的格式，并显示为大写（请参阅Angular `DatePipe`文档中的日期格式，[http://mng.bz/78lD](http://mng.bz/78lD)）。
- en: In addition to predefined pipes, you can create custom pipes that can include
    code specific to your application. The process of creating custom pipes is described
    at [https://angular.io/guide/pipes](https://angular.io/guide/pipes). Code samples
    for this chapter include an app demonstrating a custom pipe that can convert the
    temperature from Fahrenheit to Celsius and back.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 除了预定义的管道外，你还可以创建自定义管道，这些管道可以包含特定于你应用程序的代码。创建自定义管道的过程在[https://angular.io/guide/pipes](https://angular.io/guide/pipes)中描述。本章的代码示例包括一个演示如何将华氏度转换为摄氏度并返回的自定义管道的应用程序。
- en: Now you know that your app can include components, services, directives, and
    pipes. All these artifacts must be declared in your app module(s).
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经知道你的应用程序可以包含组件、服务、指令和管道。所有这些元素都必须在你的应用程序模块中声明。
- en: 2.5\. Modules
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.5. 模块
- en: An Angular module is a container for a group of related components, services,
    directives, and pipes. You can think of a module as a package that implements
    certain functionality from the business domain of your application, such as a
    shipping or billing module. All elements of a small application can be located
    in one module (the root module), whereas larger apps may have more than one module
    (feature modules). All apps must have at least a root module that’s bootstrapped
    during app launch.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: Angular模块是一个用于存放一组相关组件、服务、指令和管道的容器。你可以将模块视为一个实现应用程序业务领域特定功能的包，例如运输或计费模块。小型应用程序的所有元素都可以位于一个模块中（根模块），而大型应用程序可能包含多个模块（功能模块）。所有应用程序都必须至少有一个在应用程序启动时启动的根模块。
- en: 'From a syntax perspective, an Angular module is a class annotated with the
    `@NgModule()` decorator. To load the root module on application startup, invoke
    the `bootstrapModule()` method in the main.ts file of your app:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 从语法角度来看，Angular模块是一个带有`@NgModule()`装饰器的类。要在应用程序启动时加载根模块，请在你的应用程序的main.ts文件中调用`bootstrapModule()`方法。
- en: '[PRE14]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The Angular framework itself is split into modules. Including some of the Angular
    modules is a must (for example, `@angular/core`), whereas some modules are optional.
    For example, if you’re planning to use the Angular Forms API and make HTTP requests,
    you should add `@angular/forms` and `@angular/common/http` in your package.json
    file and should include `FormsModule` and `HttpClientModule` in the root module
    of your app, as shown in the following listing.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: Angular框架本身被拆分为模块。包括一些Angular模块是必须的（例如，`@angular/core`），而一些模块是可选的。例如，如果你计划使用Angular表单API和进行HTTP请求，你应该在package.json文件中添加`@angular/forms`和`@angular/common/http`，并在你的应用根模块中包含`FormsModule`和`HttpClientModule`，如下面的列表所示。
- en: Listing 2.3\. A sample root module
  id: totrans-113
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.3\. 示例根模块
- en: '[PRE15]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '***1* The only component included in this module**'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 此模块中包含的唯一组件**'
- en: '***2* Other modules that are needed for this app**'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 其他本应用所需的模块**'
- en: '***3* The top-level component to be loaded on app startup**'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 应用启动时加载的顶级组件**'
- en: If you decide to split your app into several modules, in addition to the root
    module you’ll need to create *feature modules*, covered next.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你决定将应用拆分为几个模块，除了根模块外，你还需要创建*功能模块*，下文将介绍。
- en: 2.5.1\. Feature modules
  id: totrans-119
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.5.1\. 功能模块
- en: An Angular app may consist of a root module and feature modules. You can implement
    a certain feature of your app (for example, shipping) in a feature module. Whereas
    the `@NgModule()` decorator of the root module of a web application must include
    the `BrowserModule`, feature modules include the `CommonModule` instead. Feature
    modules can be imported by other modules. The `@NgModule()` decorator of feature
    modules doesn’t include the `bootstrap` property, because bootstrapping the entire
    app is the responsibility of the root module.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 一个Angular应用可能由根模块和功能模块组成。你可以在功能模块中实现应用的一个特定功能（例如，运输）。而Web应用的根模块的`@NgModule()`装饰器必须包含`BrowserModule`，功能模块则包含`CommonModule`。功能模块可以被其他模块导入。功能模块的`@NgModule()`装饰器不包含`bootstrap`属性，因为启动整个应用是根模块的责任。
- en: The following listing generates a small app called Hello Modules and adds a
    feature module called `ShippingModule` to it.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的列表生成一个名为Hello Modules的小型应用，并向其中添加一个名为`ShippingModule`的功能模块。
- en: Listing 2.4\. Generating a project and a feature module
  id: totrans-122
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.4\. 生成项目和功能模块
- en: '[PRE16]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '***1* Generates a new project called hello-modules**'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 生成名为hello-modules的新项目**'
- en: '***2* Generates a new feature module called shipping**'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 生成名为shipping的新功能模块**'
- en: This app will have a feature module with the following listing’s content in
    the file src/app/shipping/shipping.module.ts.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 此应用将有一个功能模块，其内容如下所示，位于文件src/app/shipping/shipping.module.ts中。
- en: Listing 2.5\. Generated feature module
  id: totrans-127
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.5\. 生成的功能模块
- en: '[PRE17]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '***1* Feature module imports CommonModule instead of the BrowserModule**'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 功能模块导入CommonModule而不是BrowserModule**'
- en: 'Now let’s generate a new shipping component, instructing Angular CLI to include
    it into `ShippingModule`:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们生成一个新的运输组件，并指示Angular CLI将其包含到`ShippingModule`中：
- en: '[PRE18]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: This command generates the file shipping/shipping.component.ts with the decorated
    class `ShippingComponent` with an inline template and an empty `styles` property.
    The command also adds it to the `declarations` section of the `ShippingModule`.
    The code for the shipping component is shown in the following listing.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令生成文件shipping/shipping.component.ts，其中包含装饰过的类`ShippingComponent`，一个内联模板和一个空的`styles`属性。该命令还将它添加到`ShippingModule`的`declarations`部分。运输组件的代码如下所示。
- en: Listing 2.6\. Generated shipping component
  id: totrans-133
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.6\. 生成的运输组件
- en: '[PRE19]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '***1* A default template**'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 默认模板**'
- en: '***2* Implementing the lifecycle interface OnInit**'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 实现OnInit生命周期接口**'
- en: '***3* This lifecycle hook is invoked after the constructor.**'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 此生命周期钩子在构造函数之后被调用。**'
- en: 'Note the selector of the shipping component: `app-shipping`. You’ll be using
    this name in the template of the `AppComponent`.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到运输组件的选择器：`app-shipping`。你将在`AppComponent`的模板中使用这个名称。
- en: The code for your shipping module will include the shipping component and will
    look like the following listing.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 你的运输模块代码将包括运输组件，其外观如下所示。
- en: Listing 2.7\. Generated shipping module
  id: totrans-140
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.7\. 生成的运输模块
- en: '[PRE20]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: A feature module may declare its own components and services, but to make all
    or some of them visible to other modules, you need to export them. In this case,
    you need to add an `exports` section to the shipping module so it looks as follows.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 特殊模块可以声明自己的组件和服务，但要使所有或部分组件和服务对其他模块可见，你需要导出它们。在这种情况下，你需要向发货模块添加一个`exports`部分，使其看起来如下所示。
- en: Listing 2.8\. Exporting a shipping component
  id: totrans-143
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.8\. 导出发货组件
- en: '[PRE21]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '***1* Exporting a component from the module**'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 从模块中导出组件**'
- en: External modules will see only those members of the shipping module that were
    explicitly mentioned in `exports`. The shipping module may include other members,
    like classes, directives, and pipes. If you don’t list them in the `exports` section,
    these members will remain private to the shipping module and will be hidden from
    the rest of the app. Now you should include the shipping module in the root module.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 外部模块将只能看到在`exports`中明确提到的发货模块的成员。发货模块可能包含其他成员，如类、指令和管道。如果你没有在`exports`部分中列出它们，这些成员将保持私有，并从应用的其他部分隐藏。现在你应该将发货模块包含在根模块中。
- en: Listing 2.9\. Adding the shipping module to the root module
  id: totrans-147
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.9\. 将发货模块添加到根模块
- en: '[PRE22]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '***1* Adds the shipping module to the root module**'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 将发货模块添加到根模块**'
- en: To have the browser render the shipping component in the root component, you
    can add the `<app-shipping>` tag to the template of the `AppComponent`.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 要让浏览器在根组件中渲染发货组件，你可以在`AppComponent`的模板中添加`<app-shipping>`标签。
- en: Listing 2.10\. Adding a shipping component
  id: totrans-151
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.10\. 添加发货组件
- en: '[PRE23]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '***1* Adds the ShippingComponent to the root component’s template**'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 将ShippingComponent添加到根组件的模板**'
- en: Run this app with `ng serve` and open the browser at http://localhost:4200\.
    You’ll see the window that renders the `AppComponent` from the root module and
    the `ShippingComponent` from the shipping module, as shown in [figure 2.1](#ch02fig01).
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`ng serve`运行此应用，并在浏览器中打开http://localhost:4200。你会看到从根模块渲染的`AppComponent`和从发货模块渲染的`ShippingComponent`，如图2.1所示。
- en: Figure 2.1\. Running the two-module app
  id: totrans-155
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.1\. 运行双模块应用
- en: '![](Images/02fig01.jpg)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig01.jpg)'
- en: “Welcome to app!!” is the greeting from the `AppComponent` located in the root
    module, whereas “shipping Works!” comes from the `ShippingComponent` located in
    your feature module. This was a rather simple example, but it illustrates how
    you can *modularize* an app so its specific features are located in a separate
    reusable module and can be developed by a separate developer(s).
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: “欢迎使用app!!”是位于根模块中的`AppComponent`发出的问候，而“shipping Works!”则来自位于你的功能模块中的`ShippingComponent`。这是一个相当简单的例子，但它说明了你可以如何*模块化*一个应用，使其特定功能位于一个单独的可重用模块中，并由单独的开发者（们）开发。
- en: Your app modules can be loaded either eagerly on application startup, as was
    done with the Hello Modules project, or lazily, such as when the user clicks a
    specific link. In section 4.3 in [chapter 4](kindle_split_013.xhtml#ch04), you’ll
    see a sample app with a module that’s lazy loaded.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 你的应用模块可以在应用启动时预先加载，就像Hello Modules项目中所做的那样，或者按需加载，例如当用户点击特定的链接时。在第4.3节中，你将看到具有懒加载模块的示例应用。
- en: You know by now that a component consists of TypeScript code and the UI (the
    template). The next concept to learn is how the code and the UI can be synchronized
    as the data changes either programmatically or as the result of the user’s interaction
    with the app.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 到现在为止，你知道组件由TypeScript代码和UI（模板）组成。接下来要学习的概念是如何在数据通过编程方式或用户与应用交互的结果发生变化时同步代码和UI。
- en: 2.6\. Understanding data binding
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.6\. 理解数据绑定
- en: Angular has a mechanism called *data binding* that allows you to keep a component’s
    properties in sync with the view. In this section, we’ll explain how data binding
    works with properties and events.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: Angular有一个名为*数据绑定*的机制，允许你保持组件属性与视图同步。在本节中，我们将解释数据绑定是如何与属性和事件一起工作的。
- en: 'Angular supports two types of data binding: *unidirectional* (default) and
    *two-way*. With unidirectional data binding, the data is synchronized in one direction:
    either from the class member variable (property) to the view or from the view
    event to the class variable or a method that handles the event. Angular updates
    the binding during its change detection cycle, explained in [section 9.1](kindle_split_018.xhtml#ch09lev1sec1)
    in [chapter 9](kindle_split_018.xhtml#ch09).'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: Angular支持两种类型的数据绑定：*单向*（默认）和*双向*。在单向数据绑定中，数据在一个方向上同步：要么是从类成员变量（属性）到视图，要么是从视图事件到类变量或处理事件的函数。Angular在其变更检测周期中更新绑定，这在第9章的第9.1节[section
    9.1](kindle_split_018.xhtml#ch09lev1sec1)中解释。
- en: 2.6.1\. Binding properties and events
  id: totrans-163
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.6.1\. 绑定属性和事件
- en: 'To display a value of a class variable in a template’s string, use double curly
    braces. If a class has a variable called `name`, you can show its value like this:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 要在模板的字符串中显示类变量的值，请使用双大括号。如果一个类有一个名为`name`的变量，你可以这样显示它的值：
- en: '[PRE24]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: This is also known as *interpolation*, and you can use any valid expression
    inside these double curly braces.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 这也被称为*插值*，你可以在这些双大括号内使用任何有效的表达式。
- en: 'Use square brackets to bind the value from a class variable to a property of
    an HTML element or an Angular component. The following binds the value of the
    class variable `isValid` to the `hidden` property of the HTML `<span>` element:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 使用方括号将类变量的值绑定到HTML元素或Angular组件的属性。以下示例将类变量`isValid`的值绑定到HTML `<span>`元素的`hidden`属性：
- en: '[PRE25]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Note that the square brackets are used to the left of the equals sign. If the
    value of the `isValid` variable is false, the text of the `span` element isn’t
    hidden, and the user will see the message “This field is required.” As soon as
    the value of the `isValid` variable becomes true, the text “This field is required”
    becomes hidden.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 注意方括号位于等号左侧。如果`isValid`变量的值为`false`，则`span`元素的文本不会隐藏，用户将看到消息“此字段为必填项。”一旦`isValid`变量的值变为`true`，文本“此字段为必填项”将变为隐藏。
- en: The preceding examples illustrate unidirectional binding from the class variable
    to the view. The next listings will illustrate the unidirectional binding from
    the view to a class member, such as a method.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 上述示例说明了从类变量到视图的单向绑定。接下来的列表将展示从视图到类成员（如方法）的单向绑定。
- en: To assign an event-handler function to an event, put the event name in parentheses
    in the component’s template. The following listing shows how to bind the `onClickEvent()`
    function to the `click` event, and the `onInputEvent()` function to the `input`
    event.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 要将事件处理函数分配给事件，请在组件的模板中将事件名称放在括号内。以下列表展示了如何将`onClickEvent()`函数绑定到`click`事件，以及将`onInputEvent()`函数绑定到`input`事件。
- en: Listing 2.11\. Two events with handlers
  id: totrans-172
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.11\. 带有处理器的两个事件
- en: '[PRE26]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '***1* If the button is clicked, invoke the method onClickEvent().**'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 如果按钮被点击，调用onClickEvent()方法。**'
- en: '***2* As soon as the value of the input field changes, invoke the method onInputEvent().**'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 一旦输入字段的值发生变化，就调用onInputEvent()方法。**'
- en: When the event specified in parentheses is triggered, the expression in double
    quotes is reevaluated. In [listing 2.11](#ch02ex11), the expressions are functions,
    so they’re invoked each time the corresponding event is triggered.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 当括号中指定的事件被触发时，双引号中的表达式将被重新评估。在[列表2.11](#ch02ex11)中，表达式是函数，因此每次触发相应的事件时都会调用它们。
- en: If you’re interested in analyzing the properties of the event object, add the
    `$event` argument to the method handler. In particular, the target `property`
    of the event object represents the DOM node where the event occurred. The instance
    of the event object will be available only within the binding scope (that is,
    in the event-handler method). [Figure 2.2](#ch02fig02) shows how to read the event-binding
    syntax.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你对分析事件对象的属性感兴趣，请将`$event`参数添加到方法处理器中。特别是，事件对象的`target`属性表示事件发生的DOM节点。事件对象的实例仅在绑定作用域内（即在事件处理器方法中）可用。[图2.2](#ch02fig02)展示了如何读取事件绑定语法。
- en: Figure 2.2\. Event-binding syntax
  id: totrans-178
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.2\. 事件绑定语法
- en: '![](Images/02fig02.jpg)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig02.jpg)'
- en: The event in parentheses is called the *target of binding*. You can bind functions
    to any standard DOM events that exist today (see “Event reference” in the Mozilla
    Developer Network documentation, [http://mzl.la/1JcBR22](http://mzl.la/1JcBR22))
    or that will be introduced in the future.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 括号中的事件被称为**绑定目标**。您可以将函数绑定到今天存在的任何标准DOM事件（参见Mozilla开发者网络文档中的“事件参考”，[http://mzl.la/1JcBR22](http://mzl.la/1JcBR22)）或未来将要引入的事件。
- en: 'Parentheses are used for binding to the standard DOM events as well as the
    custom events of a component. For example, say you have a price-quoter component
    that can emit a custom event, `lastPrice`. The following code snippet shows how
    to bind the `lastPrice` event to the class method `priceQuoteHandler()`:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 括号用于将标准DOM事件以及组件的自定义事件进行绑定。例如，假设您有一个可以发出自定义事件 `lastPrice` 的价格报价组件。以下代码片段显示了如何将
    `lastPrice` 事件绑定到类方法 `priceQuoteHandler()`：
- en: '[PRE27]'
  id: totrans-182
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: You’ll learn how to create components that emit custom events in [chapter 8](kindle_split_017.xhtml#ch08),
    [section 8.2.2](kindle_split_017.xhtml#ch08lev2sec2).
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 您将在第8章（[kindle_split_017.xhtml#ch08](kindle_split_017.xhtml#ch08)）和第8.2.2节（[kindle_split_017.xhtml#ch08lev2sec2](kindle_split_017.xhtml#ch08lev2sec2)）中学习如何创建发出自定义事件的组件。
- en: 2.6.2\. One- and two-way data binding in action
  id: totrans-184
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.6.2\. 单向和双向数据绑定实例
- en: Let’s run and review two simple apps from the project bindings that come with
    this chapter. If you use the Angular 5 code samples, the two apps `oneway` and
    `twoway` are configured by creating two elements in the `apps` array in the file
    .angular-cli.json. If you use the Angular 6 code samples, these two apps are configured
    in the file angular .json.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们运行并回顾本章附带的项目绑定中的两个简单应用程序。如果您使用Angular 5代码示例，这两个应用程序 `oneway` 和 `twoway` 通过在文件
    .angular-cli.json 中的 `apps` 数组中创建两个元素来配置。如果您使用Angular 6代码示例，这两个应用程序在文件 angular.json
    中配置。
- en: '|  |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Configuring Angular CLI projects**'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '**配置Angular CLI项目**'
- en: Prior to Angular 6, the generated projects include the configuration file .angular-cli.json,
    which allows you to specify where the source code is located, which directory
    will contain the compiled code, where to find the assets of your project, where
    the code and styles required by third-party libraries (if any) are, and more.
    Angular CLI uses properties of this file during generation of the your app artifacts,
    during builds, and while running tests.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在Angular 6之前，生成的项目包括配置文件 .angular-cli.json，它允许您指定源代码的位置，哪个目录将包含编译后的代码，在哪里可以找到您项目的资源，以及第三方库（如果有）所需的代码和样式在哪里，等等。Angular
    CLI在生成您的应用程序工件、构建和运行测试时使用此文件的属性。
- en: You can find the complete and current description of each config property in
    the document “Angular CLI Config Schema,” available at [https://github.com/angular/angular-cli/wiki/angular-cli](https://github.com/angular/angular-cli/wiki/angular-cli).
    You’ll use the `apps` config property in this section and the `styles` and `scripts`
    properties in [section 2.7](#ch02lev1sec7).
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在文档“Angular CLI配置模式”中找到每个配置属性的完整和当前描述，该文档可在 [https://github.com/angular/angular-cli/wiki/angular-cli](https://github.com/angular/angular-cli/wiki/angular-cli)
    找到。您将在本节中使用 `apps` 配置属性，并在第2.7节（[#ch02lev1sec7](#ch02lev1sec7)）中使用 `styles` 和
    `scripts` 属性。
- en: 'Starting in Angular 6, projects are configured in the angular.json file, and
    its schema is described at [https://github.com/angular/angular-cli/wiki/angular-workspace](https://github.com/angular/angular-cli/wiki/angular-workspace).
    Now the project is treated as a workspace, which can contain one or more apps
    and libraries with their own configurations, but all of them share the dependencies
    located in a single directory: node_modules.'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 从Angular 6开始，项目在 angular.json 文件中配置，其模式描述在 [https://github.com/angular/angular-cli/wiki/angular-workspace](https://github.com/angular/angular-cli/wiki/angular-workspace)。现在项目被视为一个工作区，它可以包含一个或多个具有自己配置的应用程序和库，但它们都共享位于单个目录中的依赖项：node_modules。
- en: '|  |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: These two apps will be configured similarly—only the app names and the names
    of the files that boot these apps will differ, as shown in the following listing.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个应用程序将类似地配置——只有应用程序名称和引导这些应用程序的文件名称将不同，如下面的列表所示。
- en: 'Listing 2.12\. Angular 5: Configuring two apps in .angular-cli.json'
  id: totrans-193
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '列表 2.12\. Angular 5: 在 .angular-cli.json 中配置两个应用程序'
- en: '[PRE28]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '***1* The name of the first app**'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 第一个应用程序的名称**'
- en: '***2* The bootstrap file of the first app**'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 第一个应用程序的引导文件**'
- en: '***3* The name of the second app**'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 第二个应用程序的名称**'
- en: '***4* The bootstrap file of the second app**'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 第二个应用程序的引导文件**'
- en: Because both apps are located in the same project, you need to run `npm install`
    once. In Angular 5 and earlier versions, you can bundle and run any of these app
    by specifying the `--app` option with the `ng serve` or `ng build` command. The
    file main-one-way-binding.ts contains the code to bootstrap the app module from
    the directory named one-way, and the file main-two-way-binding.ts bootstraps the
    app module from the two-way directory of this project.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 因为这两个应用程序位于同一个项目中，所以您只需要运行一次 `npm install`。在 Angular 5 及更早版本中，您可以通过指定 `ng serve`
    或 `ng build` 命令中的 `--app` 选项来捆绑和运行这些应用程序中的任何一个。`main-one-way-binding.ts` 文件包含从名为
    `one-way` 的目录中引导应用程序模块的代码，而 `main-two-way-binding.ts` 文件则从本项目的 `two-way` 目录中引导应用程序模块。
- en: 'In Angular 5, if you want to build the bundles in memory and start the dev
    server with the app configured under the name `oneway`, the following command
    will do it:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Angular 5 中，如果您想将捆绑包构建到内存中，并使用名为 `oneway` 的应用程序启动开发服务器，以下命令将实现这一点：
- en: '[PRE29]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '|  |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-203
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: 'If you use the Angular 6 version of the code samples, the option `--app` is
    not required: `ng serve oneway`.'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用 Angular 6 版本的代码示例，则不需要 `--app` 选项：`ng serve oneway`。
- en: '|  |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 'If you also want Angular CLI to open the browser to http://localhost:4200,
    add the `-o` to the preceding command:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您还希望 Angular CLI 打开浏览器到 http://localhost:4200，请将 `-o` 添加到前面的命令中：
- en: '[PRE30]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Open the bindings project in your IDE and run the `npm i` command in its Terminal
    window. After dependencies are installed, run the preceding command to see the
    one-way sample app in action. It’ll render the page as shown in [figure 2.3](#ch02fig03).
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的 IDE 中打开绑定项目，并在其终端窗口中运行 `npm i` 命令。在依赖项安装完成后，运行前面的命令以查看单向示例应用程序的实际效果。它将渲染如图
    2.3 所示的页面。
- en: Figure 2.3\. Running a one-way binding app
  id: totrans-209
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 2.3\. 运行单向绑定应用程序
- en: '![](Images/02fig03.jpg)'
  id: totrans-210
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig03.jpg)'
- en: In the Angular 6 version of the code samples, the apps `oneway` and `twoway`
    are configured in the angular.json file in the `projects` section. The following
    command will run the `oneway` app, rendering the UI shown in [figure 2.3](#ch02fig03).
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Angular 6 版本的代码示例中，`oneway` 和 `twoway` 应用程序在 `projects` 部分的 `angular.json`
    文件中进行了配置。以下命令将运行 `oneway` 应用程序，渲染如图 2.3 所示的 UI。
- en: '[PRE31]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: The following listing shows the code of the `AppComponent` that rendered this
    page.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列表显示了渲染此页面的 `AppComponent` 的代码。
- en: Listing 2.13\. The `AppComponent` for the one-way binding sample
  id: totrans-214
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.13\. 单向绑定示例的 `AppComponent`
- en: '[PRE32]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '***1* Initially uses a one-way property binding to render the value of the
    class variable name**'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 初始时使用单向属性绑定来渲染类变量 `name` 的值**'
- en: '***2* A button click updates the value of the variable name to Bill Smart using
    a one-way event binding to the method changeName().**'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 点击按钮通过单向事件绑定到 `changeName()` 方法来更新变量 `name` 的值为 "Bill Smart"。**'
- en: As soon as the user clicks the button, the `changeName()` method modifies the
    value of `name`, one-way property binding kicks in, and the new value of the `name`
    variable will be shown on the page.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦用户点击按钮，`changeName()` 方法就会修改 `name` 的值，单向属性绑定随即生效，`name` 变量的新值将在页面上显示。
- en: 'Now stop the dev server (Ctrl-C), and run the app configured under the name
    `twoway`:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 现在停止开发服务器（Ctrl-C），并运行名为 `twoway` 的应用程序：
- en: '[PRE33]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'The template of this page has the following HTML tags: `<input>`, `<button>`,
    and `<p>`. Enter `26 Broadway` in the input field, and you’ll see a page like
    the one shown in [figure 2.4](#ch02fig04).'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 此页面的模板包含以下 HTML 标签：`<input>`、`<button>` 和 `<p>`。在输入字段中输入 `26 Broadway`，您将看到如图
    2.4 所示的页面。
- en: Figure 2.4\. Running a twoway binding sample app
  id: totrans-222
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 2.4\. 运行双向绑定示例应用程序
- en: '![](Images/02fig04_alt.jpg)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig04_alt.jpg)'
- en: The value of the text inside the `<p>` tag changes as soon as the value in the
    input field changes. If you click the button, the value of the input field and
    the paragraph will change to `"The shipping address is 123 Main Street"`. In this
    app, you use two-way binding. The code for the app component is shown in the following
    listing.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 当输入字段中的值改变时，`<p>` 标签内的文本值会立即改变。如果您点击按钮，输入字段和段落的值将更改为 `"The shipping address
    is 123 Main Street"`。在这个应用程序中，您使用了双向绑定。应用程序组件的代码如下所示。
- en: Listing 2.14\. A two-way binding sample
  id: totrans-225
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.14\. 双向绑定示例
- en: '[PRE34]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '***1* Using ngModel to denote the two-way binding**'
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 使用 ngModel 表示双向绑定**'
- en: '***2* Updating the value of shippingAddress on click**'
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 点击时更新 `shippingAddress` 的值**'
- en: 'You bind the value of the input field to the `shippingAddress` variable by
    using the Angular `ngModel` directive:'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过使用 Angular 的 `ngModel` 指令将输入字段的值绑定到 `shippingAddress` 变量：
- en: '[PRE35]'
  id: totrans-230
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Remember, square brackets represent property binding, and parentheses represent
    event binding. To denote two-way binding, surround a template element’s `ngModel`
    with both square brackets and parentheses. In the preceding code, you instruct
    Angular to update the `shippingAddress` variable as soon as the value in the input
    field changes, and update the value of the input field as soon when the value
    of `shippingAddress` changes. This is what the two-way binding means.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，方括号表示属性绑定，圆括号表示事件绑定。为了表示双向绑定，将模板元素的 `ngModel` 用方括号和圆括号同时包围。在上面的代码中，您指示 Angular
    在输入字段中的值改变时立即更新 `shippingAddress` 变量，并在 `shippingAddress` 的值改变时立即更新输入字段的值。这就是双向绑定的含义。
- en: When you were typing `26 Broadway`, the value of the `shippingAddress` variable
    was changing as well. The click on the button would programmatically change the
    address to 123 Main Street, and this value is propagated back to the input field.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 当您输入 `26 Broadway` 时，`shippingAddress` 变量的值也在改变。按钮的点击会程序性地将地址更改为 123 Main Street，并且这个值会传播回输入字段。
- en: While reviewing the code of this app located in the two-way directory, note
    that the app module imports `FormsModule`, required because you use the `ngModel`
    directive, which is part of the Forms API, covered in [chapter 7](kindle_split_016.xhtml#ch07).
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 在审查位于双向目录中的此应用程序代码时，请注意应用程序模块导入了 `FormsModule`，这是由于您使用了 `ngModel` 指令，它是 Forms
    API 的一部分，在 [第 7 章](kindle_split_016.xhtml#ch07) 中介绍。
- en: '2.7\. Hands-on: Getting started with ngAuction'
  id: totrans-234
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.7\. 实战：开始使用 ngAuction
- en: From here on, most chapters will end with a hands-on section containing code
    review or instructions for developing a certain aspect of the ngAuction app, where
    people can see a list of featured products, view details for a specific product,
    perform a product search, and monitor bidding by other users. We’ll gradually
    add code to this application so you can see how different Angular parts fit together.
    The source code that comes with this book includes the completed version of such
    hands-on sections in the ngAuction folders of the respective chapters, but we
    encourage you to try these exercises on your own (source code can be found at
    [https://github.com/Farata/angulartypescript](https://github.com/Farata/angulartypescript)
    and [www.manning.com/books/angular-development-with-typescript-second-edition](http://www.manning.com/books/angular-development-with-typescript-second-edition)).
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 从现在开始，大多数章节将以一个实战部分结束，包含代码审查或开发 ngAuction 应用程序某个方面的说明，人们可以查看精选产品的列表，查看特定产品的详细信息，执行产品搜索，并监控其他用户的出价。我们将逐步向这个应用程序添加代码，以便您可以看到不同的
    Angular 部分是如何结合在一起的。本书附带源代码包括各章节 ngAuction 文件夹中的此类实战部分的完成版本，但我们鼓励您亲自尝试这些练习（源代码可在
    [https://github.com/Farata/angulartypescript](https://github.com/Farata/angulartypescript)
    和 [www.manning.com/books/angular-development-with-typescript-second-edition](http://www.manning.com/books/angular-development-with-typescript-second-edition)
    找到)。
- en: This hands-on exercise contains instructions for developing an initial version
    of the sample auction introduced in [chapter 1](kindle_split_010.xhtml#ch01).
    You’ll start by generating a new Angular CLI project, and then you’ll create the
    home page, split it into Angular components, and create a service to fetch products.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 本实战练习包含开发第 1 章[https://kindle.split/010.xhtml#ch01](https://kindle.split/010.xhtml#ch01)中介绍的示例拍卖初始版本的说明。您将首先生成一个新的
    Angular CLI 项目，然后创建主页，将其拆分为 Angular 组件，并创建一个用于获取产品的服务。
- en: '|  |'
  id: totrans-237
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Note
  id: totrans-238
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 注意
- en: The completed version of this exercise is located in the directory chapter2/ngAuction.
    To run this version of ngAuction, switch to the ngAuction directory, run `npm
    install`, and start the application by running the `ng serve` command. We assume
    you have Angular CLI and the npm package manager installed on your computer.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 本练习的完成版本位于 chapter2/ngAuction 目录中。要运行这个版本的 ngAuction，切换到 ngAuction 目录，运行 `npm
    install`，然后通过运行 `ng serve` 命令启动应用程序。我们假设您已经在您的计算机上安装了 Angular CLI 和 npm 软件包管理器。
- en: '|  |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 2.7.1\. The initial project setup for ngAuction
  id: totrans-241
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.1\. ngAuction 的初始项目设置
- en: Let’s start the development of ngAuction from scratch. Each section in the hands-on
    exercise will contain a set of instructions for you to follow so you can develop
    ngAuction on your own.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从零开始开发 ngAuction。实战练习中的每个部分都将包含一组您需要遵循的说明，以便您自己开发 ngAuction。
- en: 'Generate a new directory and, using Angular CLI, generate a new project—ngAuction—by
    running the following command:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的目录，并使用 Angular CLI 运行以下命令来生成一个新的项目—ngAuction：
- en: '[PRE36]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '**`ng new`—** Generates a new project.'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`ng new`**—生成一个新的项目。'
- en: '**`--prefix nga`—** The generated .angular-cli.json file will have the `prefix`
    property value `nga` (for ngAuction). The generated app component will have the
    `nga-root` selector, and all other components that we’ll be generating for ngAuction
    will also have selectors with the prefix `nga-`.'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`--prefix nga`—** 生成的 .angular-cli.json 文件将具有 `prefix` 属性值 `nga`（对于 ngAuction）。生成的应用程序组件将具有
    `nga-root` 选择器，而我们将为 ngAuction 生成的所有其他组件也将具有带有前缀 `nga-` 的选择器。'
- en: '**`--routing`—** You’ll add navigation to ngAuction in [chapter 3](kindle_split_012.xhtml#ch03).
    The `--routing` option will generate a boilerplate module for routing support.'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**`--routing`—** 您将在 [第 3 章](kindle_split_012.xhtml#ch03) 中为 ngAuction 添加导航。`--routing`
    选项将生成一个用于路由支持的样板模块。'
- en: 'Open the newly generated ngAuction directory in your IDE, go to the integrated
    Terminal view, and run the following command there:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的 IDE 中打开新创建的 ngAuction 目录，转到集成终端视图，并运行以下命令：
- en: '[PRE37]'
  id: totrans-249
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: This command will build the bundles, start the dev server, and open the browser,
    which will render the page as in the Hello CLI app shown in [chapter 1](kindle_split_010.xhtml#ch01)
    in [figure 1.5](kindle_split_010.xhtml#ch01fig05).
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将构建包，启动开发服务器，并打开浏览器，浏览器将渲染页面，就像在 [第 1 章](kindle_split_010.xhtml#ch01) 中 [图
    1.5](kindle_split_010.xhtml#ch01fig05) 所示的 Hello CLI 应用程序一样。
- en: In [chapters 2](#ch02), [3](kindle_split_012.xhtml#ch03), and [5](kindle_split_014.xhtml#ch05)
    you’ll use the Bootstrap 4 framework (see [http://getbootstrap.com](http://getbootstrap.com))
    for styling and implementing the responsive web design in ngAuction. The term
    *responsive web design* (RWD) means that the view layouts can adapt to the screen
    size of the user’s device. Starting in [chapter 7](kindle_split_016.xhtml#ch07),
    you’ll redesign the UI of ngAuction using Angular Material components (see [https://material.angular.io](https://material.angular.io))
    and remove the Bootstrap framework from this project.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [第 2 章](#ch02)、[第 3 章](kindle_split_012.xhtml#ch03) 和 [第 5 章](kindle_split_014.xhtml#ch05)
    中，您将使用 Bootstrap 4 框架（见 [http://getbootstrap.com](http://getbootstrap.com)）进行样式设计和在
    ngAuction 中实现响应式网页设计。术语 *响应式网页设计*（RWD）意味着视图布局可以适应用户设备的屏幕大小。从 [第 7 章](kindle_split_016.xhtml#ch07)
    开始，您将使用 Angular Material 组件（见 [https://material.angular.io](https://material.angular.io)）重新设计
    ngAuction 的 UI，并从该项目中移除 Bootstrap 框架。
- en: Because the Bootstrap library has jQuery and Popper.js as peer dependencies,
    you need to run the command in the following listing to install them in the ngAuction
    project.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 Bootstrap 库有 jQuery 和 Popper.js 作为依赖项，您需要在以下列表中运行命令来在 ngAuction 项目中安装它们。
- en: Listing 2.15\. Installing Bootstrap, jQuery, and Popper.js
  id: totrans-253
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.15\. 安装 Bootstrap、jQuery 和 Popper.js
- en: '[PRE38]'
  id: totrans-254
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: '|  |'
  id: totrans-255
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: Tip
  id: totrans-256
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 提示
- en: 'If you use npm older than 5.0, use the `--save` option instead of `--save-prod`.
    In npm 5, there are shortcuts: `-P` for `--save-prod` (default) and `-D` for `--save-dev`.'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用的是低于 5.0 的 npm，请使用 `--save` 选项而不是 `--save-prod`。在 npm 5 中，有快捷方式：`-P` 对应于
    `--save-prod`（默认）和 `-D` 对应于 `--save-dev`。
- en: '|  |'
  id: totrans-258
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: 'When you have to use global styles or scripts from an external JavaScript library,
    you can add them to the .angular-cli.json config file or, starting in Angular
    6, to angular .json. In your case, the Bootstrap getting-started guide (see [https://getbootstrap.com/docs/4.1/getting-started](https://getbootstrap.com/docs/4.1/getting-started))
    instructs you to add bootstrap.min.css to the index .html of the app. But because
    you’re use Angular CLI, you’ll add it to the `styles` section in .angular-cli.json,
    so it looks like this:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 当您需要使用来自外部 JavaScript 库的全局样式或脚本时，您可以将其添加到 .angular-cli.json 配置文件中，或者从 Angular
    6 开始，添加到 angular .json 中。在您的案例中，Bootstrap 入门指南（见 [https://getbootstrap.com/docs/4.1/getting-started](https://getbootstrap.com/docs/4.1/getting-started)）指导您将
    bootstrap.min.css 添加到应用的 index .html 文件中。但由于您使用 Angular CLI，您将把它添加到 .angular-cli.json
    中的 `styles` 部分，所以看起来是这样的：
- en: '[PRE39]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The Bootstrap documentation also instructs you to add the jQuery js/bootstrap.min.js
    file, and you’ll add it to the `scripts` section in .angular-cli.json as follows:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: Bootstrap 文档还指导您添加 jQuery js/bootstrap.min.js 文件，并将它添加到 .angular-cli.json 中的
    `scripts` 部分，如下所示：
- en: '[PRE40]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '|  |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: Tip
  id: totrans-264
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 提示
- en: When you’re running the `ng serve` or `ng build` commands, the preceding scripts
    will be placed in the scripts.bundle.js file.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 当您运行 `ng serve` 或 `ng build` 命令时，前面的脚本将被放置在 scripts.bundle.js 文件中。
- en: '|  |'
  id: totrans-266
  prefs: []
  type: TYPE_TB
  zh: '|'
- en: 2.7.2\. Generating components for ngAuction
  id: totrans-267
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.2\. 为 ngAuction 生成组件
- en: Your ngAuction app will consist of several Angular components. In the last section,
    you generated the project with the root app component. Now, you’ll generate more
    components using the command `ng generate component` (or `ng g c`). Run the commands
    in the following listing in your Terminal window to generate the components shown
    in [figure 1.10](kindle_split_010.xhtml#ch01fig10) in [chapter 1](kindle_split_010.xhtml#ch01).
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 你的 ngAuction 应用将包含几个 Angular 组件。在上一个部分，你使用根组件 app 生成了项目。现在，你将使用命令 `ng generate
    component`（或 `ng g c`）生成更多组件。在终端窗口中运行以下清单中的命令以生成 [第 1 章](kindle_split_010.xhtml#ch01)
    中的 [图 1.10](kindle_split_010.xhtml#ch01fig10) 所示的组件。
- en: Listing 2.16\. Generating components for ngAuction
  id: totrans-269
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 清单 2.16\. 为 ngAuction 生成组件
- en: '[PRE41]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: Each of the components in [listing 2.12](#ch02ex12) will be generated in a separate
    folder. Open app.module.ts, and you’ll see that Angular CLI has also added the
    import statements and declared all of the these components there.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: '[清单 2.12](#ch02ex12) 中的每个组件都将生成在单独的文件夹中。打开 app.module.ts，你会看到 Angular CLI 也已经添加了导入语句并声明了所有这些组件。'
- en: 'Now you’ll generate the product service that will provide the data for ngAuction
    in the next chapter. Run the following command to generate the product service:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你将生成将在下一章为 ngAuction 提供数据的产物服务。运行以下命令以生成产物服务：
- en: '[PRE42]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Add `ProductService` to the `providers` property of `@NgModule()`:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 将 `ProductService` 添加到 `@NgModule()` 的 `providers` 属性中：
- en: '[PRE43]'
  id: totrans-275
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: '|  |'
  id: totrans-276
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Tip
  id: totrans-277
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 提示
- en: While writing or generating code, you may see that some of your code fragments
    are marked with red squiggly lines. Hover over these lines to get more information.
    It may be not a TypeScript compiler error but a TSLint complaint about your coding
    style. Run the command `ng lint --fix`, and these styling errors could be automatically
    fixed.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 在编写或生成代码时，你可能注意到一些代码片段被标记为红色的波浪线。将鼠标悬停在这些行上以获取更多信息。这可能不是 TypeScript 编译器错误，而是
    TSLint 对你的编码风格的投诉。运行命令 `ng lint --fix`，这些样式错误可以自动修复。
- en: '|  |'
  id: totrans-279
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: 2.7.3\. The application component
  id: totrans-280
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.3\. 应用组件
- en: 'The application component is the root component of ngAuction and will host
    all other components. Your app.component.html will include the following elements:
    navbar at the top, search on the left, the router outlet on the right, and the
    footer at the bottom. In [chapter 3](kindle_split_012.xhtml#ch03), you’ll use
    the tag `<router-outlet>` to render either the `HomeComponent` or `ProductDetailComponent`,
    but in the initial version of ngAuction, you’ll be rendering only `HomeComponent`
    there. Replace the content of app.component.html with the following listing.'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 应用组件是 ngAuction 的根组件，并将托管所有其他组件。你的 app.component.html 将包括以下元素：顶部是导航栏，左侧是搜索，右侧是路由出口，底部是页脚。在第
    [3 章](kindle_split_012.xhtml#ch03) 中，你将使用 `<router-outlet>` 标签来渲染 `HomeComponent`
    或 `ProductDetailComponent`，但在 ngAuction 的初始版本中，你将只在那里渲染 `HomeComponent`。用以下清单替换
    app.component.html 的内容。
- en: Listing 2.17\. The `AppComponent` template
  id: totrans-282
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 清单 2.17\. `AppComponent` 模板
- en: '[PRE44]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: '***1* The navbar component goes at the top.**'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 导航栏组件位于顶部。**'
- en: '***2* Three columns of the Bootstrap’s flex grid are given to the search component.**'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* Bootstrap 的 flex 网格的三列分配给了搜索组件。**'
- en: '***3* Rendering the search component**'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 渲染搜索组件**'
- en: '***4* Nine columns are given to the router outlet area.**'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 九列分配给了路由出口区域。**'
- en: '***5* Router outlet area**'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***5* 路由出口区域**'
- en: '***6* The footer component is rendered at the bottom.**'
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***6* 页脚组件在底部渲染。**'
- en: You may see some unfamiliar CSS classes in HTML elements—they all come from
    the Bootstrap framework. For example, the styles `col-md-3` and `col-md-9` come
    from the Bootstrap flexible grid layout system, in which the width of the viewport
    is divided into 12 invisible columns. You can read about the Bootstrap grid system
    at [https://getbootstrap.com/docs/4.0/layout/grid](https://getbootstrap.com/docs/4.0/layout/grid).
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能在 HTML 元素中看到一些不熟悉的 CSS 类——它们都来自 Bootstrap 框架。例如，样式 `col-md-3` 和 `col-md-9`
    来自 Bootstrap 可伸缩网格布局系统，其中视口的宽度被分成 12 个不可见的列。你可以在 [https://getbootstrap.com/docs/4.0/layout/grid](https://getbootstrap.com/docs/4.0/layout/grid)
    上阅读有关 Bootstrap 网格系统的信息。
- en: 'Out of the box, the Bootstrap grid supports five tiers for different widths
    of user devices: `xs`, `sm`, `md`, `lg`, and `xl`. For example, `md` stands for
    medium devices (992 px (pixels) or more), `lg` is 1200 px or more, and so on.
    In your app component, you want to allocate three columns in medium or larger
    viewports to the search component (`<nga-search>`) and nine columns to the `<router-outlet>`.'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Bootstrap网格支持五个级别，用于不同用户设备宽度：`xs`、`sm`、`md`、`lg`和`xl`。例如，`md`代表中等设备（992像素或更多），`lg`是1200像素或更多，依此类推。在你的应用组件中，你希望在中等或更大的视口中为搜索组件（`<nga-search>`）分配三列，并为`<router-outlet>`分配九列。
- en: Since you didn’t specify how many columns to allocate to `<nga-search>` if the
    device is smaller than `md`, the browser will give the entire viewport’s width
    to your search component, and `<router-outlet>` will be rendered under the search.
    The UI elements of your app component will be laid out differently, depending
    on the width of the user’s screen.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你没有指定当设备小于`md`时为`<nga-search>`分配多少列，浏览器将整个视口的宽度分配给你的搜索组件，`<router-outlet>`将在搜索下方渲染。你的应用组件的UI元素布局将根据用户屏幕的宽度不同而有所不同。
- en: Start the app with `ng serve -o`, and the browser will display a page that looks
    similar to the page shown in [figure 2.5](#ch02fig05).
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`ng serve -o`启动应用，浏览器将显示一个与图2.5所示页面相似的页面。
- en: Figure 2.5\. Running the first version of ngAuction
  id: totrans-294
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.5\. 运行ngAuction的第一个版本
- en: '![](Images/02fig05.jpg)'
  id: totrans-295
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/02fig05.jpg)'
- en: This doesn’t look like a landing page of an online auction app yet, but at least
    the app didn’t break after you added the Bootstrap framework and generated components
    and a service. Keep this app running and continue adding code according to the
    upcoming instructions, and you’ll see how it gradually turns into a more usable
    web page.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 这还不像是一个在线拍卖应用的着陆页，但至少在添加Bootstrap框架、生成组件和服务后，应用没有崩溃。保持此应用运行，并按照即将到来的说明继续添加代码，你将看到它如何逐渐变成一个更可用的网页。
- en: 2.7.4\. The navbar component
  id: totrans-297
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.4\. 导航栏组件
- en: A typical navigation bar stays at the top of the page, providing the app menu.
    The Bootstrap framework offers multiple styles for the navigation bar component
    described at [https://getbootstrap.com/docs/4.0/components/navbar](https://getbootstrap.com/docs/4.0/components/navbar).
    Replace the contents of navbar.component.html with the following listing.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 典型的导航栏位于页面顶部，提供应用菜单。Bootstrap框架为导航栏组件提供了多种样式，具体描述见[https://getbootstrap.com/docs/4.0/components/navbar](https://getbootstrap.com/docs/4.0/components/navbar)。将navbar.component.html的内容替换为以下列表。
- en: Listing 2.18\. The navbar component template
  id: totrans-299
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.18\. 导航栏组件模板
- en: '[PRE45]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: '***1* Bootstrap’s nav component and CSS selectors**'
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* Bootstrap的导航组件和CSS选择器**'
- en: '***2* Bootstrap’s navbar-brand denotes your auction brand and routes to the
    default page on click.**'
  id: totrans-302
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* Bootstrap的navbar-brand表示你的拍卖品牌，点击时将路由到默认页面。**'
- en: '***3* Bootstrap’s collapsible is rendered as three horizontal bars on small
    screens.**'
  id: totrans-303
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* Bootstrap的折叠组件在小屏幕上以三个水平条的形式呈现。**'
- en: '***4* Services drop-down menu**'
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 服务下拉菜单**'
- en: '***5* Drop-down menu items**'
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***5* 下拉菜单项**'
- en: As soon as you save this file, Angular CLI will automatically rebuild the bundles,
    and your page will look like [figure 2.6](#ch02fig06).
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 保存此文件后，Angular CLI将自动重新构建包，你的页面将类似于图2.6所示。
- en: Figure 2.6\. Rendering the navbar
  id: totrans-307
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.6\. 渲染导航栏
- en: '![](Images/02fig06_alt.jpg)'
  id: totrans-308
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/02fig06_alt.jpg)'
- en: What if you don’t see the page shown in [figure 2.6](#ch02fig06), and the browser
    just renders an empty page instead? Any time you see something you don’t expect,
    open Chrome Dev Tools and see if there are any error messages in the Console tab.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你没有看到图2.6中显示的页面，而是浏览器只渲染了一个空页面，那会怎样？每次当你看到不期望看到的内容时，打开Chrome开发者工具，查看控制台标签页中是否有任何错误信息。
- en: Make the width of the browser window small, and the menu will collapse, rendering
    three horizontal bars on the right, as shown in [figure 2.7](#ch02fig07).
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 将浏览器窗口宽度缩小，菜单将折叠，在右侧显示三个水平条，如图2.7所示。
- en: Figure 2.7\. Collapsed navbar menu
  id: totrans-311
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.7\. 折叠的导航栏菜单
- en: '![](Images/02fig07_alt.jpg)'
  id: totrans-312
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/02fig07_alt.jpg)'
- en: 2.7.5\. The search component
  id: totrans-313
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.5\. 搜索组件
- en: Eventually, you’ll implement the `SearchComponent` to perform the product search
    based on the product title, price, or category. But in the initial version of
    ngAuction, you just want to render the view of the `SearchComponent`. Replace
    the content of search.component.html to look like the following listing.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 最终，你将实现`SearchComponent`以根据产品标题、价格或类别执行产品搜索。但在ngAuction的初始版本中，你只想渲染`SearchComponent`的视图。将search.component.html的内容替换为以下列表。
- en: Listing 2.19\. The search component template
  id: totrans-315
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.19\. 搜索组件模板
- en: '[PRE46]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '***1* All values in class selectors come from the Bootstrap framework.**'
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 类选择器中的所有值都来自Bootstrap框架。**'
- en: The rendered app is shown in [figure 2.8](#ch02fig08).
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 渲染的应用程序如图2.8所示[图2.8](#ch02fig08)。
- en: Figure 2.8\. Rendering the search component
  id: totrans-319
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.8\. 渲染搜索组件
- en: '![](Images/02fig08.jpg)'
  id: totrans-320
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig08.jpg)'
- en: Now, let’s take care of the footer component.
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们处理页脚组件。
- en: 2.7.6\. The footer component
  id: totrans-322
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.6\. 页脚组件
- en: Your footer will just display the copyright message. The following listing modifies
    the content of footer.component.html.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 你的页脚将仅显示版权信息。以下列表修改了footer.component.html的内容。
- en: Listing 2.20\. The footer component template
  id: totrans-324
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.20\. 页脚组件模板
- en: '[PRE47]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '***1* All values in class selectors come from the Bootstrap framework.**'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 类选择器中的所有值都来自Bootstrap框架。**'
- en: Your ngAuction app renders the home page as shown in [figure 2.9](#ch02fig09).
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 你的ngAuction应用程序渲染的首页如图2.9所示[图2.9](#ch02fig09)。
- en: Figure 2.9\. Rendering the footer
  id: totrans-328
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图2.9\. 渲染页脚
- en: '![](Images/02fig09_alt.jpg)'
  id: totrans-329
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig09_alt.jpg)'
- en: 2.7.7\. The carousel component
  id: totrans-330
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.7\. 轮播组件
- en: At the top of the ngAuction landing page, you want to implement a slide show
    of the featured products. For this, you’ll use the carousel component that comes
    with Bootstrap (see [https://getbootstrap.com/docs/4.0/components/carousel](https://getbootstrap.com/docs/4.0/components/carousel)).
    To rotate slides manually, the carousel component includes previous/next controls
    (little arrows on the sides) and indicators of the current slide (dashes at the
    bottom).
  id: totrans-331
  prefs: []
  type: TYPE_NORMAL
  zh: 在ngAuction着陆页的顶部，你想要实现特色产品的幻灯片展示。为此，你将使用Bootstrap附带的自定义轮播组件（见[https://getbootstrap.com/docs/4.0/components/carousel](https://getbootstrap.com/docs/4.0/components/carousel)）。为了手动旋转幻灯片，轮播组件包括上一个/下一个控制（侧边的箭头）和当前幻灯片的指示器（底部的短横线）。
- en: For simplicity, you’ll use gray rectangles instead of actual images. The handy
    [https://placeholder.com](https://placeholder.com) service returns gray rectangles
    of a specified size, and in the carousel, you’ll use three 800 x 300 px gray rectangles.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化，你将使用灰色矩形而不是实际图像。方便的[https://placeholder.com](https://placeholder.com)服务返回指定大小的灰色矩形，在轮播图中，你将使用三个800
    x 300 px的灰色矩形。
- en: Modify the code of carousel.component.html to look like the following listing.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 修改carousel.component.html的代码，使其看起来像以下列表。
- en: Listing 2.21\. The carousel component template
  id: totrans-334
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.21\. 轮播组件模板
- en: '[PRE48]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '***1* The first slide is an 800 x 300 px gray rectangle.**'
  id: totrans-336
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 第一张幻灯片是一个800 x 300 px的灰色矩形。**'
- en: '***2* Second slide**'
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 第二张幻灯片**'
- en: '***3* Third slide**'
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 第三张幻灯片**'
- en: '***4* Clicking the left arrow renders the previous image.**'
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 点击左箭头显示上一张图片。**'
- en: '***5* Clicking the right arrow renders the next image.**'
  id: totrans-340
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***5* 点击右箭头显示下一张图片。**'
- en: 'Now, you need to add some styles to the carousel. Because it’s a custom component,
    you’ll add `display: block` to its CSS file. You also want to add some space at
    the bottom of the carousel so other components won’t overlap. To apply these styles
    to the component itself and not to its internals, you’ll use the pseudo class
    selector `:host` that represents the carousel, in this case. To ensure that the
    slide images take the entire width of the `<div>` that hosts the carousel, add
    the following listing’s style to the carousel.component.css file.'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: '现在，你需要为轮播图添加一些样式。因为它是一个自定义组件，你将在其CSS文件中添加`display: block`。你还想在轮播图的底部添加一些空间，这样其他组件就不会重叠。为了将这些样式应用于组件本身而不是其内部，你将使用代表轮播图的伪类选择器`:host`。为了确保幻灯片图像占据轮播图宿主`<div>`的整个宽度，将以下列表的样式添加到carousel.component.css文件中。'
- en: Listing 2.22\. carousel.component.css
  id: totrans-342
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表2.22\. carousel.component.css
- en: '[PRE49]'
  id: totrans-343
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '***1* Applies styles to the carousel component and not to its internals**'
  id: totrans-344
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 将样式应用于轮播组件，而不是其内部**'
- en: '***2* Displays the component as a block element that takes the entire width**'
  id: totrans-345
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 将组件显示为占用整个宽度的块元素**'
- en: '***3* Adds some space below the carousel**'
  id: totrans-346
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 在轮播图下方添加一些空间**'
- en: '***4* Images should take the entire width of the carousel.**'
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 图片应占据轮播图的整个宽度。**'
- en: '|  |'
  id: totrans-348
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: '**Overriding Bootstrap styles**'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: '**覆盖Bootstrap样式**'
- en: Most of the Bootstrap framework styles are located in the node_modules/bootstrap/dist/css/bootstrap.css
    file. If you want to override some of the default styles, see how Bootstrap defines
    them and decide what you want to change. Then, define the CSS style in your component
    that matches the selector of the Bootstrap file.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数 Bootstrap 框架样式都位于 node_modules/bootstrap/dist/css/bootstrap.css 文件中。如果您想覆盖一些默认样式，请查看
    Bootstrap 如何定义它们，并决定您想更改什么。然后，在您的组件中定义与 Bootstrap 文件选择器匹配的 CSS 样式。
- en: 'For example, the carousel indicators are rendered as dashes, and the Bootstrap
    CSS selector `.carousel-indicators li` looks like the following:'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，轮播指示器以破折号的形式渲染，Bootstrap CSS 选择器 `.carousel-indicators li` 看起来如下：
- en: '[PRE50]'
  id: totrans-352
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: 'If you want to change the indicators from dashes to circles, add the following
    style to the carousel.component.css:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想将指示器从破折号改为圆形，请向 carousel.component.css 添加以下样式：
- en: '[PRE51]'
  id: totrans-354
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '|  |'
  id: totrans-355
  prefs: []
  type: TYPE_TB
  zh: '|  |'
- en: Don’t be surprised if, after adding code in the carousel component, the rendering
    of ngAuction hasn’t changed and still looks like [figure 2.9](#ch02fig09). That’s
    because you haven’t added the `<nga-carousel>` tag to any parent component yet.
    You’ll add `<nga-carousel>` to the home component, which you’ll create next.
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 如果在轮播组件中添加代码后，ngAuction 的渲染没有变化，仍然看起来像 [图 2.9](#ch02fig09)，请不要感到惊讶。这是因为您还没有将
    `<nga-carousel>` 标签添加到任何父组件中。您将向主页组件添加 `<nga-carousel>`，这是您接下来要创建的。
- en: 2.7.8\. The home component
  id: totrans-357
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 2.7.8\. 主页组件
- en: The template of your app component includes the `<router-outlet>` area, which,
    on the `md`-size viewports, will be located to the right of `<nga-search>`. In
    [chapter 3](kindle_split_012.xhtml#ch03), you’ll modify ngAuction to render either
    the home or the product-detail component in the `<router-outlet>`, but for now,
    you’ll render the home component there. Your home component will host and render
    the carousel at the top and several products under it.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 您的应用组件模板包括 `<router-outlet>` 区域，在 `md`-size 视口上，该区域将位于 `<nga-search>` 的右侧。在
    [第 3 章](kindle_split_012.xhtml#ch03) 中，您将修改 ngAuction 以在 `<router-outlet>` 中渲染主页或产品详情组件，但到目前为止，您将渲染主页组件。您的主页组件将托管并渲染顶部的轮播组件，以及其下的几个产品。
- en: Modify the content of the generated home.component.html to look like the following
    listing.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 修改生成的 home.component.html 的内容，使其看起来如下列表。
- en: Listing 2.23\. The home component template
  id: totrans-360
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.23\. 主页组件模板
- en: '[PRE52]'
  id: totrans-361
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: '***1* The carousel goes at the top of the home component.**'
  id: totrans-362
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 轮播组件位于主页组件的顶部。**'
- en: '***2* In [chapter 3](kindle_split_012.xhtml#ch03), you’ll replace this text
    with product-item components.**'
  id: totrans-363
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 在 [第 3 章](kindle_split_012.xhtml#ch03) 中，您将用产品项组件替换此文本。**'
- en: The first `<div>` hosts the carousel, and the second one displays the text revealing
    your plans to render several product items there. Still, the UI of your running
    ngAuction hasn’t changed, and you may have guessed that it’s because you didn’t
    include the `<nga-home>` tag in your app component. And you won’t be doing that.
    You’ll use Angular Router to render `HomeComponent` inside the `<router-outlet>`
    area.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个 `<div>` 托管轮播组件，第二个 `<div>` 显示文本，表明您计划在那里渲染多个产品项。尽管如此，您正在运行的 ngAuction 的
    UI 仍未改变，您可能已经猜到这是由于您没有在应用组件中包含 `<nga-home>` 标签。您不会这样做。您将使用 Angular Router 在 `<router-outlet>`
    区域内渲染 `HomeComponent`。
- en: '[Chapters 3](kindle_split_012.xhtml#ch03) and [4](kindle_split_013.xhtml#ch04)
    cover the router in detail—for now, you’ll just make a small change in the generated
    app/app-routing.module.ts file, which includes the line in the following listing
    for route configuration.'
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: '[第 3 章](kindle_split_012.xhtml#ch03) 和 [第 4 章](kindle_split_013.xhtml#ch04)
    详细介绍了路由器——现在，您只需在生成的 app/app-routing.module.ts 文件中进行一个小改动，该文件包含以下列表中的行，用于路由配置。'
- en: Listing 2.24\. Configuring routes
  id: totrans-366
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.24\. 配置路由
- en: '[PRE53]'
  id: totrans-367
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Replace the code in the preceding listing with the code in the following one.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 将前面列表中的代码替换为以下列表中的代码。
- en: Listing 2.25\. Mapping an empty path to the home component
  id: totrans-369
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 列表 2.25\. 将空路径映射到主页组件
- en: '[PRE54]'
  id: totrans-370
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: This means that if the path after the base URL is empty (the URL of ngAuction
    has nothing after the port number), render the `HomeComponent`. You’ll also need
    to add an import statement for `HomeComponent` in the app-routing.module.ts file.
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着如果基础 URL 后的路径为空（ngAuction 的 URL 在端口号后没有内容），则渲染 `HomeComponent`。您还需要在 app-routing.module.ts
    文件中添加对 `HomeComponent` 的导入语句。
- en: Now your ngAuction renders as shown in [figure 2.10](#ch02fig10), and the carousel
    will run a slide show of gray rectangles.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 现在 ngAuction 的渲染如图 [图 2.10](#ch02fig10) 所示，轮播组件将运行灰色矩形的幻灯片展示。
- en: Figure 2.10\. Rendering ngAuction with the home component
  id: totrans-373
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 2.10\. 使用主页组件渲染 ngAuction
- en: '![](Images/02fig10_alt.jpg)'
  id: totrans-374
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/02fig10_alt.jpg)'
- en: The initial version of ngAuction is ready. You can start reducing the width
    of the browser window to see how this UI will be rendered on a smaller device.
    As soon as the window width becomes smaller than 992 pixels (the value of the
    Bootstrap `md` size), the browser will change the page layout, giving the entire
    window’s width to the search component, and the home component will be rendered
    under the search. This is responsive web design in action.
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: ngAuction的初始版本已经准备好了。你可以开始缩小浏览器窗口的宽度，看看这个UI在小设备上是如何渲染的。一旦窗口宽度小于992像素（Bootstrap
    `md`尺寸的值），浏览器将更改页面布局，将整个窗口宽度分配给搜索组件，而主页组件将在搜索组件下方渲染。这就是响应式网页设计的实际应用。
- en: Summary
  id: totrans-376
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 摘要
- en: An Angular application is represented by a hierarchy of components that are
    packaged into modules.
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Angular应用程序由组件的层次结构表示，这些组件被打包成模块。
- en: Each Angular component contains a template for UI rendering and a class implementing
    the component’s functionality.
  id: totrans-378
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个Angular组件都包含一个用于UI渲染的模板和一个实现组件功能的类。
- en: Templates and styles can be either inlined or stored in separate files.
  id: totrans-379
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模板和样式可以是内联的，也可以存储在单独的文件中。
- en: Angular CLI is a useful tool even after the project has been generated.
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 即使项目已经生成，Angular CLI也是一个有用的工具。
- en: Data binding is a mechanism to keep the UI of the component and the values in
    the underlying class in sync.
  id: totrans-381
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据绑定是一种机制，用于保持组件的UI和底层类中的值同步。
- en: You can use third-party JavaScript libraries in Angular projects.
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以在Angular项目中使用第三方JavaScript库。
