- en: Front matter
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前言
- en: foreword to the second edition
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第二版序言
- en: The year must have been 2009\. I was speaking at the Norwegian Developers Conference
    in Oslo. (Ah, Oslo in June!) The event was held in a huge sports arena. The conference
    organizers divided the bleachers into sections, built stages in front of them,
    and draped them with thick black cloth in order to create eight different session
    “rooms.” I remember I was just about finished with my talk, which was about TDD,
    or SOLID, or astronomy, or something, when suddenly, from the stage next to me,
    came this loud and raucous singing and guitar playing.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 那年一定是2009年。我在奥斯陆的挪威开发者大会上发表演讲。（啊，六月的奥斯陆！）活动在一个巨大的体育场馆举行。会议组织者将看台分成了几个区域，在它们前面搭建了舞台，并用厚厚的黑色布料覆盖起来，以创造八个不同的会议“房间”。我记得我差不多结束了我的演讲，内容是关于TDD、SOLID、天文学，或者诸如此类的东西，突然，从我旁边的舞台上传来了大声而嘈杂的唱歌和弹吉他声。
- en: The drapes were such that I was able to peer around them and see the fellow
    on the stage next to mine, who was making all the noise. Of course, it was Roy
    Osherove.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 遮帘如此之厚，以至于我能够透过它们看到我旁边舞台上的那个人，他正在制造所有的噪音。当然，那是Roy Osherove。
- en: Now, those of you who know me know that breaking into song in the middle of
    a technical talk about software is something that *I* might just do, if the mood
    struck me. So as I turned back to my audience, I thought to myself that this Osherove
    fellow was a kindred spirit, and I’d have to get to know him better.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，那些了解我的人知道，在关于软件的技术演讲中突然唱歌，是我可能会做的事情，如果心情来了。所以当我转身回到我的观众时，我想，这位Osherove先生是一个志同道合的人，我必须更好地了解他。
- en: And getting to know him better is just what I did. In fact, he made a significant
    contribution to my most recent book, *The Clean Coder*, and spent three days with
    me co-teaching a TDD class. My experiences with Roy have all been very positive,
    and I hope there are many more.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 而去更好地了解他，正是我所做的事情。事实上，他为我的最新著作《Clean Coder》做出了重大贡献，并花三天时间与我共同教授TDD课程。我与Roy的经历都非常积极，希望还有更多。
- en: I predict that your experience with Roy, in the reading of this book, will be
    very positive as well, because this book is something special.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 我预测，你在阅读这本书的过程中，对Roy的经验也会非常积极，因为这本书是特别的。
- en: Have you ever read a Michener novel? I haven’t; but I’ve been told that they
    all start at “the atom.” The book you’re holding isn’t a James Michener novel,
    but it does start at the atom—the atom of unit testing.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 你读过Michener的小说吗？我没有；但有人告诉我，它们都是从“原子”开始的。你手中的这本书不是James Michener的小说，但它确实是从“原子”——单元测试的原子开始的。
- en: Don’t be misled as you thumb through the early pages. This is *not* a mere introduction
    to unit testing. It starts that way, and if you’re experienced you can skim those
    first chapters. As the book progresses, the chapters start to build on each other
    into a rather startling accumulation of depth. Indeed, as I read the last chapter
    (not knowing it was the last chapter), I thought to myself that the next chapter
    would be dealing with world peace—because, I mean, where else can you go after
    solving the problem of introducing unit testing into obstinate organizations with
    old legacy systems?
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 当你翻阅早期页面时，不要被误导。这不仅仅是一本关于单元测试的介绍。它确实是从介绍开始的，如果你有经验，可以快速浏览那些前几章。随着书的进展，章节开始相互构建，形成了一个相当惊人的深度积累。确实，当我读到最后一章（并不知道那是最后一章）时，我想，下一章可能会讨论世界和平——因为，我的意思是，在解决了将单元测试引入固执的、拥有老旧遗留系统的组织的问题之后，你还能去哪里呢？
- en: This book is technical—deeply technical. There’s a lot of code. That’s a good
    thing. But Roy doesn’t restrict himself to the technical. From time to time he
    pulls out his guitar and breaks into song as he tells anecdotes from his professional
    past or waxes philosophical about the meaning of design or the definition of *integration*.
    He seems to relish regaling us with stories about some of the things he did really
    badly in the deep, dark past of 2006.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书是技术性的——非常技术性。有很多代码。这是好事。但Roy并不局限于技术。时不时地，他会拿出吉他，在讲述他过去职业生活中的趣事或哲学地讨论设计的意义或*集成*的定义时即兴唱歌。他似乎很喜欢用他2006年深远的黑暗过去中的一些糟糕经历来娱乐我们。
- en: Oh, and don’t be too concerned that the code is all in C#. I mean, who can tell
    the difference between C# and Java anyway? Right? And besides, it just doesn’t
    matter. He may use C# as a vehicle to communicate his intent, but the lessons
    in this book also apply to Java, C, Ruby, Python, PHP, or any other programming
    language (except, perhaps COBOL).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 哦，对了，不要过于担心代码都是用C#编写的。我的意思是，谁又能区分C#和Java的区别呢？对吧？而且，这根本不重要。他可能用C#作为传达意图的工具，但本书中的教训也适用于Java、C、Ruby、Python、PHP或其他任何编程语言（也许除了COBOL）。
- en: If you’re a newcomer to unit testing and test-driven development, or if you’re
    an old hand at it, you’ll find this book has something for you. So get ready for
    a treat as Roy sings you the song, “The Art of Unit Testing.”
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是一个单元测试和测试驱动开发的初学者，或者如果你已经是一个老手，你会发现这本书对你有所助益。所以准备好享受罗伊为你演唱的“单元测试的艺术”这首歌曲吧。
- en: And Roy, please tune that guitar!
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 罗伊，请调好那把吉他！
- en: —Robert C. Martin (Uncle Bob)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ——罗伯特·C·马丁（Uncle Bob）
- en: '[cleancoder.com](http://cleancoder.com)'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[cleancoder.com](http://cleancoder.com)'
- en: foreword to the first edition
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第一版序言
- en: When Roy Osherove told me that he was working on a book about unit testing,
    I was very happy to hear it. The testing meme has been rising in the industry
    for years, but there has been a relative dearth of material available about unit
    testing. When I look at my bookshelf, I see books that are about test-driven development
    specifically and books about testing in general, but until now there has been
    no comprehensive reference for unit testing—no book that introduces the topic
    and guides the reader from first steps to widely accepted best practices. The
    fact that this is true is stunning. Unit testing isn’t a new practice. How did
    we get to this point?
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 当罗伊·奥斯霍夫（Roy Osherove）告诉我他正在写一本关于单元测试的书时，我非常高兴地听到了这个消息。测试这一概念在业界已经流行多年，但关于单元测试的资料相对匮乏。当我看看我的书架，我看到的是关于特定测试驱动开发（test-driven
    development）的书籍和关于一般测试的书籍，但直到现在，还没有一本关于单元测试的全面参考书——没有一本书能介绍这个主题并指导读者从第一步到广泛接受的最佳实践。这个事实令人震惊。单元测试并不是一项新实践。我们是如何到达这个地步的？
- en: It’s almost a cliché to say that we work in a very young industry, but it’s
    true. Mathematicians laid the foundations of our work less than 100 years ago,
    but we’ve only had hardware fast enough to exploit their insights for the last
    60 years. There was an initial gap between theory and practice in our industry,
    and we’re only now discovering how it has impacted our field.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 说到我们工作在一个非常年轻的行业，这几乎成了一种陈词滥调，但这是真的。数学家们不到100年前为我们奠定了基础，但我们只有60年来才有足够的硬件来利用他们的洞察力。在我们行业中，理论与实践之间存在一个初始差距，而我们现在才刚刚发现它对我们领域的影响。
- en: In the early days, machine cycles were expensive. We ran programs in batches.
    Programmers had a scheduled time slot, and they had to punch their programs into
    decks of cards and walk them to the machine room. If your program wasn’t right,
    you lost your time, so you desk-checked your program with pencil and paper, mentally
    working out all of the scenarios, all of the edge cases. I doubt the notion of
    automated unit testing was even imaginable. Why use the machine for testing when
    you could use it to solve the problems it was meant to solve? Scarcity kept us
    in the dark.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在早期，机器周期非常昂贵。我们以批处理的方式运行程序。程序员有一个预定的时间段，他们必须将程序输入到卡片堆中，然后步行到机房。如果你的程序不正确，你就浪费了时间，所以你用铅笔和纸检查你的程序，在脑海中考虑所有的情况，所有的边缘情况。我怀疑自动单元测试的概念甚至无法想象。为什么要在测试时使用机器，而你可以用它来解决它本来要解决的问题呢？稀缺性让我们处于黑暗之中。
- en: Later, machines became faster and we became intoxicated with interactive computing.
    We could just type in code and change it on a whim. The idea of desk-checking
    code faded away, and we lost some of the discipline of the early years. We knew
    programming was hard, but that just meant that we had to spend more time at the
    computer, changing lines and symbols until we found the magical incantation that
    worked.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 后来，机器变得更快，我们沉溺于交互式计算。我们只需输入代码，就可以随心所欲地更改它。桌面检查代码的想法逐渐消失，我们失去了一些早期年份的纪律。我们知道编程很难，但这只是意味着我们必须花更多的时间在电脑前，更改行和符号，直到找到那个神奇的咒语，让它工作。
- en: We went from scarcity to surplus and missed the middle ground, but now we’re
    regaining it. Automated unit testing marries the discipline of desk-checking with
    a newfound appreciation for the computer as a development resource. We can write
    automated tests in the language we develop in to check our work—not just once,
    but as often as we’re able to run them. I don’t think there is any other practice
    that’s quite as powerful in software development.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们从稀缺到过剩，错过了中间地带，但现在我们正在重新获得它。自动化单元测试将桌面检查的纪律与对计算机作为开发资源的全新认识相结合。我们可以用我们开发的语言编写自动化测试来检查我们的工作——不仅一次，而且只要我们能够运行它们。我认为在软件开发中没有任何其他实践具有如此强大的效果。
- en: As I write this, in 2009, I’m happy to see Roy’s book come into print. It’s
    a practical guide that will help you get started and also serve as a great reference
    as you go about your testing tasks. *The Art of Unit Testing* isn’t a book about
    idealized scenarios. It teaches you how to test code as it exists in the field,
    how to take advantage of widely used frameworks, and, most importantly, how to
    write code that’s far easier to test.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 当我写这篇东西的时候，在2009年，我很高兴看到罗伊的书出版。这是一本实用的指南，它将帮助你开始，并在你进行测试任务时作为一个很好的参考。*单元测试的艺术*不是一本关于理想化场景的书。它教你如何测试实际存在的代码，如何利用广泛使用的框架，最重要的是，如何编写易于测试的代码。
- en: '*The Art of Unit Testing* is an important title that should have been written
    years ago, but we weren’t ready then. We are ready now. Enjoy.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: '*单元测试的艺术*是一个重要的标题，它本应该在几年前就写成，但我们当时还没有准备好。我们现在准备好了。享受吧。'
- en: —Michael Feathers
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: ——迈克尔·费舍斯
- en: Object Mentor
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 对象导师
- en: preface
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 前言
- en: One of the biggest failed projects I worked on had unit tests. Or so I thought.
    I was leading a group of programmers creating a billing application, and we were
    doing it in a fully test-driven manner—writing the test, then writing the code,
    seeing the test fail, making the test pass, refactoring, and starting all over
    again.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 我参与过的最大的失败项目之一有单元测试。或者我以为是这样。我领导着一组程序员创建一个计费应用程序，我们完全采用测试驱动的方式——编写测试，然后编写代码，看到测试失败，让测试通过，重构，然后从头开始。
- en: The first few months of the project were great. Things were going well, and
    we had tests that proved that our code worked. But as time went by, requirements
    changed. We were forced to change our code to fit those new requirements, and
    when we did, tests broke and had to be fixed. The code still worked, but the tests
    we wrote were so brittle that any little change in our code broke them, even though
    the code was working fine. It became a daunting task to change code in a class
    or method because we also had to fix all the related unit tests.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 项目的前几个月进展顺利。一切都很顺利，我们有测试证明了我们的代码是有效的。但随着时间的推移，需求发生了变化。我们被迫改变我们的代码以适应那些新的需求，当我们这样做的时候，测试失败了，不得不修复。代码仍然有效，但我们编写的测试如此脆弱，以至于我们代码的任何微小变化都会使它们失败，尽管代码本身运行良好。在类或方法中更改代码变成了一项艰巨的任务，因为我们还必须修复所有相关的单元测试。
- en: Worse yet, some tests became unusable because the people who wrote them left
    the project, and no one knew how to maintain the tests or what they were testing.
    The names we gave our unit testing methods weren’t clear enough, and we had tests
    relying on other tests. We ended up throwing out most of the tests less than six
    months into the project.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 更糟糕的是，一些测试变得无法使用，因为编写它们的那些人离开了项目，没有人知道如何维护测试或它们在测试什么。我们给单元测试方法取的名字不够清晰，我们有一些测试依赖于其他测试。我们在项目开始不到六个月的时候就抛弃了大部分测试。
- en: The project was a miserable failure because we let the tests we wrote do more
    harm than good. They took more time to maintain and understand than they saved
    us in the long run, so we stopped using them. I moved on to other projects, where
    we did a better job writing our unit tests, and we had some great successes using
    them, saving huge amounts of debugging and integration time. Since that first
    failed project, I’ve been compiling best practices for unit tests and using them
    on subsequent projects. I find a few more best practices with every project I
    work on.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这个项目是一个悲惨的失败，因为我们让我们所编写的测试带来的伤害大于好处。它们在维护和理解上花费的时间比它们在长期为我们节省的时间要多，所以我们停止了使用它们。我转向了其他项目，在这些项目中，我们编写单元测试做得更好，并且在使用它们时取得了一些巨大的成功，节省了大量调试和集成时间。自从那个失败的项目以来，我一直整理单元测试的最佳实践，并在后续的项目中使用它们。我在每个项目上都能找到一些新的最佳实践。
- en: Understanding how to write unit tests—and how to make them maintainable, readable,
    and trustworthy—is what this book is about, no matter what language or integrated
    development environment you work with. This book covers the basics of writing
    a unit test, moves on to the basics of interaction testing, and introduces best
    practices for writing, managing, and maintaining unit tests in the real world.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 理解如何编写单元测试，以及如何使它们易于维护、可读和可信，是本书的主题，无论您使用哪种语言或集成开发环境。本书涵盖了编写单元测试的基础知识，进而转向交互测试的基础，并介绍了在现实世界中编写、管理和维护单元测试的最佳实践。
- en: —Roy Osherove
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: —罗伊·奥斯休维
- en: When Manning asked me to help complete a book on unit testing that was nearly
    finished, my initial thought was to decline. After all, I already had my own book
    on unit testing, so why should I work on someone else’s project? But I changed
    my mind when I realized that the book in question was none other than Roy’s *The
    Art of Unit Testing*. The first edition of *The Art of Unit Testing* was one of
    the first books I read on the topic, and it helped shape my views on unit testing.
    I feel honored to contribute to the third edition of this momentous work.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 当Manning邀请我帮助完成一本即将完成的关于单元测试的书时，我最初的反应是拒绝。毕竟，我已经有了一本关于单元测试的书，为什么还要参与别人的项目呢？但是当我意识到这本书正是罗伊的《单元测试的艺术》时，我的想法改变了。作为《单元测试的艺术》第一版的读者之一，这本书帮助塑造了我对单元测试的看法。我为能参与这部重要作品的第三版感到荣幸。
- en: I personally see this book as an excellent introduction to the subject of unit
    testing. Once you have completed it and are ready to delve deeper, pick up my
    book, *Unit Testing Principles, Practices, and Patterns* (Manning, 2020).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我个人认为，这本书是关于单元测试主题的优秀入门书籍。一旦您完成它并准备好深入研究，请拿起我的书，《单元测试原则、实践和模式》（Manning，2020）。
- en: —Vladimir Khorikov
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: —弗拉基米尔·科里科夫
- en: acknowledgments
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 致谢
- en: We would like to thank the many reviewers of the manuscript, whose feedback
    helped us to improve the book. Thanks go to Aboudou Samadou Sare, Adhir Ramjiawan,
    Adriaan Beiertz, Alain Lompo, Barnaby Norman, Charles Lam, Conor Redmond, Daut
    Morina, Esref Durna, Foster Haines, Harinath Mallepally, Jared Duncan, Jason Hales,
    Jaume López, Jeremy Chen, Joel Holmes, John Larsen, Jonathan Reeves, Jorge E.
    Bo, Kent Spillner, Kim Gabrielsen, Marcel van den Brink, Mark Graham, Matt Van
    Winkle, Matteo Battista, Matteo Gildone, Mike Holcomb, Oliver Korten, Onofrei
    George, Paul Roebuck, Pablo Herrera J., Patrice Maldague, Rahul Modpur, Ranjit
    Sahai, Rich Yonts, Richard Meinsen, Rodrigo Encinas, Ronald Borman, Sachin Singhi,
    Samantha Berk, Sander Zegveld, Satej Kumar Sahu, Shayn Cornwell, Tanya Wilke,
    Tom Madden, Udit Bhardwaj, and Vadim Turkov.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 我们要感谢许多手稿审阅者，他们的反馈帮助我们改进了本书。感谢阿布杜·萨马杜·萨雷、阿迪尔·拉姆吉瓦安、阿德里安·贝尔特茨、阿兰·洛姆波、巴纳比·诺曼、查尔斯·兰姆、康纳·雷德蒙德、达乌特·莫里纳、埃斯雷夫·德恩纳、福斯特·海因斯、哈里纳特·马莱帕利、贾里德·邓肯、贾森·黑尔斯、豪梅·洛佩斯、杰里米·陈、乔尔·霍姆斯、约翰·拉森、乔纳森·里夫斯、乔治·E·博、肯特·斯皮尔纳、金·加布里埃尔森、马塞尔·范登布林克、马克·格雷厄姆、马特·范·温克尔、马泰奥·巴蒂斯塔、马泰奥·吉尔多内、迈克·霍尔科姆、奥利弗·科滕、奥诺弗雷·乔治、保罗·罗布、帕布洛·埃雷拉·J、帕特里斯·马尔达格、拉胡尔·莫德普尔、拉尼特·萨海、里奇·扬茨、理查德·梅森、罗德里戈·恩卡纳斯、罗纳德·博尔曼、萨钦·辛吉、萨曼莎·伯克、桑德·泽格尔德、萨特杰·库马尔·萨胡、谢恩·科尔维尔、塔尼亚·威尔克、汤姆·马登、乌迪特·布拉德瓦杰、瓦迪姆·图尔科夫。
- en: Many hands go into the making of a successful book. We would like to thank Manning
    acquisitions editor Michael Stephens, development editor Connor O’Brien, technical
    development editor Mike Shepard, technical proofreader Jean-François Morin, and
    review editors Adriana Sabo and Dunja Nikitović. We also thank everyone else at
    Manning who worked on the third edition in production and behind the scenes.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 一本成功的书籍的诞生需要许多人的共同努力。我们想要感谢Manning的收购编辑迈克尔·斯蒂普斯、开发编辑康纳·奥布赖恩、技术发展编辑迈克·谢泼德、技术校对员让-弗朗索瓦·莫林，以及审阅编辑阿德里安娜·萨博和邓雅·尼科托维奇。我们还要感谢Manning的其他所有人，他们在第三版的生产和幕后工作中付出了努力。
- en: A final word of thanks goes to the early readers of the book in Manning’s Early
    Access Program for their comments in the online forum. You helped shape the book.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我要向在Manning早期访问计划中阅读本书的早期读者表示感谢，他们在在线论坛上的评论帮助塑造了本书。您们的帮助对本书的完善至关重要。
- en: about this book
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于本书
- en: One of the smartest things I ever heard anyone say about learning (and I forget
    who it was) is that to truly learn something, teach it. Writing the first edition
    of this book and publishing it in 2009 was nothing short of a true learning experience
    for me. I initially wrote the book because I got tired of answering the same questions
    over and over again. But there were other reasons, too. I wanted to try something
    new; I wanted to try an experiment; I wondered what I could learn from writing
    a book—any book. Unit testing was what I was good at, I thought. The curse is
    that the more experience you have, the more stupid you feel.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我听说过的关于学习的最聪明的事情之一（我忘了是谁说的）是，要真正学会某样东西，就去教授它。撰写这本书的第一版并在2009年出版，对我来说是一次真正的学习体验。我最初写这本书是因为我厌倦了反复回答同样的问题。但还有其他原因。我想尝试新事物；我想尝试一个实验；我想知道写一本书——任何一本书——我能学到什么。我认为我擅长单元测试。诅咒在于，你经验越多，感觉越愚蠢。
- en: There are parts of the first edition that today I do not agree with—for example,
    that a *unit* refers to a method. That’s not true at all. A unit is a unit of
    work, as I discuss in chapter 1 of this third edition. It can be as small as a
    method, or as big as several classes (possibly assemblies), and there are other
    things as well that have changed, as you will learn next.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 第一版中有些内容，我现在并不认同——例如，一个*单元*指的是一个方法。这完全不对。单元是一个工作单元，正如我在本版第三版的第1章中讨论的那样。它可以小到只是一个方法，也可以大到几个类（可能是程序集），还有其他一些变化，你将在下一章了解到。
- en: What’s new in the third edition
  id: totrans-42
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 第三版的新内容
- en: In this third edition, we switched from .NET to JavaScript and TypeScript. All
    the related tools and frameworks got updated, too, of course. For example, instead
    of NUnit test runner and NSubstitute, we used Jest, both as a unit testing framework
    and as a mocking library.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在本版第三版中，我们从.NET切换到了JavaScript和TypeScript。当然，所有相关的工具和框架也得到了更新。例如，我们不再使用NUnit测试运行器和NSubstitute，而是使用了Jest，它既是一个单元测试框架，也是一个模拟库。
- en: We added more techniques to the chapter about implementing unit testing at the
    organizational level.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在关于在组织层面实施单元测试的章节中增加了更多技术。
- en: There are plenty of design changes in the code we show in the book. They are
    mostly related to the use of dynamically typed languages such as JavaScript, but
    we talk about statically typed techniques as well with the help of TypeScript.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在书中展示的代码中，有很多设计上的变化。它们大多与动态类型语言（如JavaScript）的使用相关，但我们也借助TypeScript讨论了静态类型技术。
- en: 'The discussion about test trustworthiness, maintainability, and readability
    has been expanded into three separate chapters. We also added a new chapter about
    testing strategies: how to decide between different test types and what techniques
    to use.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 关于测试可信度、可维护性和可读性的讨论已经扩展到三个单独的章节。我们还增加了一个关于测试策略的新章节：如何在不同测试类型之间做出决定以及使用哪些技术。
- en: Who should read this book
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 应该阅读这本书的人
- en: The book is for anyone who writes code and is interested in learning best practices
    for unit testing. All the examples are written in JavaScript and TypeScript, so
    JavaScript developers will find the examples particularly useful. But the lessons
    we teach apply equally to most, if not all, object-oriented and statically typed
    languages (C#, VB.NET, Java, and C++, to name a few). If you’re an architect,
    developer, team lead, QA engineer (who writes code), or novice programmer, this
    book should suit you well.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书是为任何编写代码并对学习单元测试最佳实践感兴趣的人而写的。所有示例都使用JavaScript和TypeScript编写，因此JavaScript开发者会发现这些示例特别有用。但我们所教授的教训同样适用于大多数，如果不是所有面向对象和静态类型语言（例如C#、VB.NET、Java和C++等）。如果你是架构师、开发者、团队领导、QA工程师（编写代码的人）或新手程序员，这本书应该非常适合你。
- en: 'How this book is organized: A road map'
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本书组织结构：路线图
- en: If you’ve never written a unit test, it’s best to read this book from start
    to finish so you get the full picture. If you have experience, you should feel
    comfortable jumping into the chapters as you see fit. The book is divided into
    four parts.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你从未编写过单元测试，最好从头到尾阅读这本书，以便获得全面了解。如果你有经验，你应该可以舒适地根据需要跳转到章节。本书分为四个部分。
- en: 'Part 1 takes you from 0 to 60 in writing unit tests. Chapters 1 and 2 cover
    the basics, such as how to use a testing framework (Jest), and they introduce
    automated test concepts, such as test libraries, assertion libraries, and test
    runners. They also introduce the ideas of asserts, ignoring tests, unit-of-work
    testing, the three types of end results of a unit test, and the three types of
    tests you need for them: value tests, state-based tests, and interaction tests.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 第一部分将带您从零开始学习编写单元测试。第1章和第2章涵盖了基础知识，例如如何使用测试框架（Jest），并介绍了自动化测试的概念，如测试库、断言库和测试运行器。它们还介绍了断言、忽略测试、工作单元测试以及单元测试的三个类型的结果，以及为这些结果所需的三个类型的测试：值测试、基于状态的测试和交互测试。
- en: 'Part 2 discusses advanced techniques for breaking dependencies: mock objects,
    stubs, isolation frameworks, and patterns for refactoring your code to use them.
    Chapter 3 introduces the idea of stubs and shows how to manually create and use
    them. Chapter 4 introduces interaction testing with mock objects. Chapter 5 merges
    these two concepts and shows how isolation frameworks combine these two ideas
    and allow them to be automated. Chapter 6 dives deeper into understanding how
    to test asynchronous code.'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 第二部分讨论了打破依赖的高级技术：模拟对象、存根、隔离框架以及重构代码以使用它们的模式。第3章介绍了存根的概念，并展示了如何手动创建和使用它们。第4章介绍了使用模拟对象的交互测试。第5章将这两个概念合并，展示了隔离框架如何结合这两个想法并使它们自动化。第6章深入探讨了如何测试异步代码。
- en: Part 3 is about ways to organize test code, patterns for running and refactoring
    its structure, and best practices when writing tests. Chapter 7 discusses techniques
    for writing tests that you can trust. Chapter 8 discusses best practices in unit
    testing for creating maintainable tests.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 第三部分是关于如何组织测试代码、运行和重构其结构的模式，以及编写测试时的最佳实践。第7章讨论了编写可信赖测试的技术。第8章讨论了单元测试中的最佳实践，以创建可维护的测试。
- en: Part 4 is all about how to implement change in an organization and how to work
    on existing code. Chapter 9 is about test readability. Chapter 10 shows how to
    develop a testing strategy. Chapter 11 discusses problems and solutions you’d
    encounter when trying to introduce unit testing into an organization, and it identifies
    and answers some questions you might be asked in the course of such an effort.
    Chapter 12 talks about introducing unit testing into legacy code. It identifies
    a couple of ways to determine where to begin testing and discusses some tools
    for testing untestable code.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 第四部分全部关于如何在组织中实施变更以及如何处理现有代码。第9章是关于测试可读性的。第10章展示了如何制定测试策略。第11章讨论了在尝试将单元测试引入组织时可能遇到的问题和解决方案，并识别并回答了您在实施此类努力过程中可能会被问到的一些问题。第12章讨论了将单元测试引入遗留代码。它确定了确定开始测试位置的一两种方法，并讨论了一些用于测试不可测试代码的工具。
- en: The appendix has a list of monkey-patching techniques you might find useful
    in your testing efforts.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 附录列出了您可能在测试工作中发现有用的猴子补丁技术。
- en: Code conventions and downloads
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 代码约定和下载
- en: All source code in listings or in the text is in a `fixed-width font` like this
    to distinguish it from ordinary text. In listings, `**bold code**` indicates code
    that has changed from the previous example or that will change in the next example.
    In many listings, the code is annotated to point out the key concepts.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 列表中或文本中的所有源代码都使用类似于这样的`固定宽度字体`来区分它们与普通文本。在列表中，`**粗体代码**`表示与上一个示例相比已更改或将在下一个示例中更改的代码。在许多列表中，代码都有注释来指出关键概念。
- en: You can download the source code for this book from GitHub at [https://github.com/royosherove/aout3-samples](https://github.com/royosherove/aout3-samples),
    as well as from the publisher’s website at [https://www.manning.com/books/the-art-of-unit-testing-third-edition](https://www.manning.com/books/the-art-of-unit-testing-third-edition).
    You can get executable snippets of code from the liveBook (online) version of
    this book at [https://livebook.manning.com/book/the-art-of-unit-testing-third-edition](https://livebook.manning.com/book/the-art-of-unit-testing-third-edition).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从GitHub在[https://github.com/royosherove/aout3-samples](https://github.com/royosherove/aout3-samples)下载本书的源代码，也可以从出版社的网站[https://www.manning.com/books/the-art-of-unit-testing-third-edition](https://www.manning.com/books/the-art-of-unit-testing-third-edition)下载。您还可以从本书的在线（liveBook）版本中获取可执行的代码片段，网址为[https://livebook.manning.com/book/the-art-of-unit-testing-third-edition](https://livebook.manning.com/book/the-art-of-unit-testing-third-edition)。
- en: Software requirements
  id: totrans-59
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 软件需求
- en: To use the code in this book, you’ll need VS Code (which is free). You’ll also
    need Jest (an open source and free framework) and other tools that will be referenced
    where they’re relevant. All the tools mentioned are either free, open source,
    or have trial versions you can use freely as you read this book.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用本书中的代码，您需要VS Code（它是免费的）。您还需要Jest（一个开源和免费的框架）以及其他将在相关位置引用的工具。所有提到的工具都是免费、开源的，或者您可以在阅读本书时免费试用。所有工具都将在您阅读本书时免费使用。
- en: liveBook discussion forum
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: liveBook讨论论坛
- en: Purchase of *The Art of Unit Testing, Third Edition*, includes free access to
    liveBook, Manning’s online reading platform. Using liveBook’s exclusive discussion
    features, you can attach comments to the book globally or to specific sections
    or paragraphs. It’s a snap to make notes for yourself, ask and answer technical
    questions, and receive help from the author and other users. To access the forum,
    go to [https://livebook.manning.com/book/the-art-of-unit-testing-third-edition/discussion](https://livebook.manning.com/book/the-art-of-unit-testing-third-edition/discussion).
    You can also learn more about Manning’s forums and the rules of conduct at [https://livebook.manning.com/discussion](https://livebook.manning.com/discussion).
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 购买《单元测试艺术，第三版》包括对liveBook的免费访问，这是曼宁的在线阅读平台。使用liveBook的独特讨论功能，您可以在全球范围内或针对特定章节或段落添加评论。为个人做笔记、提出和回答技术问题以及从作者和其他用户那里获得帮助都非常简单。要访问论坛，请访问[https://livebook.manning.com/book/the-art-of-unit-testing-third-edition/discussion](https://livebook.manning.com/book/the-art-of-unit-testing-third-edition/discussion)。您还可以在[https://livebook.manning.com/discussion](https://livebook.manning.com/discussion)了解更多关于曼宁论坛和行为准则的信息。
- en: Manning’s commitment to our readers is to provide a venue where a meaningful
    dialogue between individual readers and between readers and authors can take place.
    It is not a commitment to any specific amount of participation on the part of
    the authors, whose contribution to the forum remains voluntary (and unpaid). We
    suggest you try asking them some challenging questions, lest their interest stray!
    The forum and the archives of previous discussions will be accessible from the
    publisher’s website as long as the book is in print.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 曼宁对读者的承诺是提供一个场所，让读者之间以及读者与作者之间可以进行有意义的对话。这不是对作者参与特定数量活动的承诺，作者对论坛的贡献仍然是自愿的（且未付费）。我们建议您尝试向他们提出一些挑战性的问题，以免他们的兴趣转移！只要书籍在印刷中，论坛和以前讨论的存档将可通过出版社的网站访问。
- en: Other projects by Roy Osherove
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 罗伊·奥谢罗夫的其他项目
- en: 'Roy is also the author of *Elastic Leadership: Growing Self-organizing Teams*,
    available at [www.manning.com/books/elastic-leadership](http://www.manning.com/books/elastic-leadership),
    and *Notes to a Software Team Leader: Growing Self-Organizing Teams* (Team Agile
    Publishing, 2014).'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 罗伊还是《弹性领导：培养自我组织团队》一书的作者，可在[www.manning.com/books/elastic-leadership](http://www.manning.com/books/elastic-leadership)找到，以及《给软件团队领导者的笔记：培养自我组织团队》（Team
    Agile Publishing，2014年）。
- en: 'Other resources:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 其他资源：
- en: A blog for team leaders related to this book is available at [http://5whys.com](http://5whys.com).
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个与本书相关的团队领导者的博客可在[http://5whys.com](http://5whys.com)找到。
- en: An online video TDD Master Class by Roy is available at [https://courses.osherove.com/courses](https://courses.osherove.com/courses).
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 罗伊提供的在线视频TDD大师班可在[https://courses.osherove.com/courses](https://courses.osherove.com/courses)找到。
- en: Many free videos about unit testing are available at [http://ArtOfUnitTesting.com](http://ArtOfUnitTesting.com)
    and [http://Osherove.com/Videos](http://Osherove.com/Videos).
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在[http://ArtOfUnitTesting.com](http://ArtOfUnitTesting.com)和[http://Osherove.com/Videos](http://Osherove.com/Videos)上可找到许多关于单元测试的免费视频。
- en: Roy is continuously training and consulting around the world. You can contact
    him at [http://contact.osherove.com](http://contact.osherove.com) to book training
    at your own company.
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 罗伊在全球范围内持续进行培训和咨询。您可以通过[http://contact.osherove.com](http://contact.osherove.com)联系他，以在自己的公司预订培训。
- en: And you can follow him on X at @RoyOsherove.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在X上关注他 @RoyOsherove。
- en: Other projects by Vladimir Khorikov
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 弗拉基米尔·科里科夫的其他项目
- en: Vladimir is also the author of *Unit Testing Principles, Practices, and Patterns*,
    which you can find at [https://www.manning.com/books/unit-testing](https://www.manning.com/books/unit-testing).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 弗拉基米尔还是《单元测试原则、实践和模式》一书的作者，您可以在[https://www.manning.com/books/unit-testing](https://www.manning.com/books/unit-testing)找到。
- en: 'Other resources:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 其他资源：
- en: 'A blog for developers striving to learn about unit testing and domain-driven
    design: [https://enterprisecraftsmanship.com/](https://enterprisecraftsmanship.com/).'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个致力于学习单元测试和领域驱动设计的开发者的博客：[https://enterprisecraftsmanship.com/](https://enterprisecraftsmanship.com/)。
- en: Video courses on Pluralsight are available at [https://bit.ly/ps-all](https://bit.ly/ps-all).
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Pluralsight上的视频课程可在[https://bit.ly/ps-all](https://bit.ly/ps-all)找到。
- en: And you can follow him on X at @vkhorikov.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在X上关注他 @vkhorikov。
- en: about the authors
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于作者
- en: '![Osherove](../Images/Osherove.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![Osherove](../Images/Osherove.png)'
- en: Roy Osherove is one of the original ALT.NET organizers and previously worked
    at Typemock as a chief architect. He consults and trains teams worldwide on the
    gentle art of unit testing and test-driven development, and he teaches team leaders
    how to lead better at [5whys.com](http://5whys.com). Roy tweets at @RoyOsherove
    and has many videos about unit testing at [ArtOfUnitTesting.com](http://ArtOfUnitTesting.com).
    He can also be booked for talks and training at [Osherove.com](http://Osherove.com).
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: Roy Osherove是ALT.NET的原始组织者之一，之前在Typemock担任首席架构师。他为全球团队提供关于单元测试和测试驱动开发的咨询和培训，并教导团队领导者如何在[5whys.com](http://5whys.com)上更好地领导。Roy在@RoyOsherove上发推文，并在[ArtOfUnitTesting.com](http://ArtOfUnitTesting.com)上有很多关于单元测试的视频。他还可以在[Osherove.com](http://Osherove.com)预订演讲和培训。
- en: '![Khorikov](../Images/Khorikov.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![Khorikov](../Images/Khorikov.png)'
- en: Vladimir Khorikov is a Microsoft MVP, blogger, and Pluralsight author. He has
    been professionally involved in software development for more than 10 years, including
    mentoring teams on the ins and outs of unit testing. Vladimir is the author of
    *Unit Testing, Principles, Practices, and Patterns* from Manning, and he has written
    several popular blog post series and an online training course on the topic of
    unit testing. The biggest advantage of his teaching style, and the one students
    often praise, is his tendency to have a strong theoretic background, which he
    then applies to practical examples. His blog is at [EnterpriseCraftsmanship.com](http://EnterpriseCraftsmanship.com).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: Vladimir Khorikov是微软MVP、博客作者和Pluralsight作者。他从事软件开发工作已超过10年，包括指导团队进行单元测试的方方面面。Vladimir是Manning出版的《单元测试：原则、实践和模式》一书的作者，他还撰写了几个流行的博客文章系列和关于单元测试的在线培训课程。他教学风格的最大优势，也是学生经常赞扬的地方，是他倾向于拥有强大的理论背景，然后将这些应用到实际例子中。他的博客在[EnterpriseCraftsmanship.com](http://EnterpriseCraftsmanship.com)。
- en: about the cover illustration
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 关于封面插图
- en: The figure on the cover of *The Art of Unit Testing, Third Edition*, is a “Japonais
    en costume de cérémonie,” or a “Japanese man in ceremonial dress.” The illustration
    is taken from James Prichard’s *Natural History of Man*, a book of hand-colored
    lithographs published in England in 1847\. It was found by our cover designer
    in an antique shop in San Francisco.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 《单元测试艺术，第三版》封面上的图像是一位“着礼服的日本人”，或称“日本礼仪男子”。这幅插图取自詹姆斯·普里查德的《人类自然史》，这是一本于1847年在英国出版的彩色石版画集。我们的封面设计师在旧金山的一家古董店发现了它。
- en: In those days, it was easy to identify where people lived and what their trade
    or station in life was just by their dress. Manning celebrates the inventiveness
    and initiative of the computer business with book covers based on the rich diversity
    of regional culture centuries ago, brought back to life by pictures from collections
    such as this one.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在那些日子里，人们通过他们的服饰就能轻易识别出他们的居住地以及他们的职业或社会地位。曼宁通过基于几个世纪前丰富多样的地域文化的封面设计来庆祝计算机行业的创新精神和主动性，这些文化通过像这一系列这样的图片被重新带回生活。
