- en: 18 Advanced methods for missing data
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 18 缺失数据的先进方法
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Identifying missing data
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别缺失数据
- en: Visualizing missing-data patterns
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可视化缺失数据模式
- en: Deleting missing values
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除缺失值
- en: Imputing missing values
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 填充缺失值
- en: In previous chapters, we focused on analyzing complete datasets (that is, datasets
    without missing values). Although doing so helps simplify the presentation of
    statistical and graphical methods, in the real world, missing data are ubiquitous.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们专注于分析完整的数据集（即没有缺失值的数据集）。尽管这样做有助于简化统计和图形方法的展示，但在现实世界中，缺失数据无处不在。
- en: In some ways, the impact of missing data is a subject most of us want to avoid.
    Statistics books may not mention it or may limit discussion to a few paragraphs.
    Statistical packages offer automatic handling of missing data using methods that
    may not be optimal. Even though most data analyses (at least in the social sciences)
    involve missing data, this topic is rarely mentioned in the methods and results
    sections of journal articles. Given how often missing values occur and the degree
    to which their presence can invalidate study results, it’s fair to say that the
    subject has received insufficient attention outside of specialized books and courses.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在某些方面，缺失数据的影响是一个我们大多数人希望避免的主题。统计学书籍可能不会提及它，或者可能将讨论限制在几段之内。统计软件包提供使用可能不是最佳方法的自动处理缺失数据。尽管大多数数据分析（至少在社会科学领域）都涉及缺失数据，但这个主题在期刊文章的方法和结果部分很少被提及。鉴于缺失值出现的频率以及它们的存在可能使研究结果无效的程度，可以说这个主题在专业书籍和课程之外没有得到足够的关注。
- en: Data can be missing for many reasons. Survey participants may forget to answer
    one or more questions, refuse to answer sensitive questions, or grow fatigued
    and fail to complete a long questionnaire. Study participants may miss appointments
    or drop out of a study prematurely. Recording equipment may fail, internet connections
    may be lost, or data may be miscoded. Analysts may even plan for some data to
    be missing. For example, to increase study efficiency or reduce costs, you may
    choose not to collect all data from all participants. Finally, data may be lost
    for reasons that you’re never able to ascertain.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 数据可能因为许多原因而缺失。调查参与者可能忘记回答一个或多个问题，拒绝回答敏感问题，或者因疲劳而未能完成一个漫长的问卷。研究参与者可能错过预约或提前退出研究。记录设备可能故障，互联网连接可能丢失，或者数据可能被错误编码。分析师甚至可能计划某些数据缺失。例如，为了提高研究效率或降低成本，您可能选择不收集所有参与者的所有数据。最后，数据可能因您永远无法确定的原因而丢失。
- en: Unfortunately, most statistical methods assume that you’re working with complete
    matrices, vectors, and data frames. In most cases, you have to eliminate missing
    data before you address the substantive questions that led you to collect the
    data. You can eliminate missing data by either removing cases with missing data
    or replacing missing data with reasonable substitute values. In either case, the
    end result is a dataset without missing values.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，大多数统计方法都假设您正在处理完整矩阵、向量和数据框。在大多数情况下，您必须在解决导致您收集数据的具体问题之前消除缺失数据。您可以通过删除具有缺失数据的案例或用合理的替代值替换缺失数据来消除缺失数据。在两种情况下，最终结果都是一个没有缺失值的数据集。
- en: In this chapter, we’ll look at both traditional and modern approaches for dealing
    with missing data. We’ll primarily use the `VIM`, `mice`, and `missForest` packages.
    The command `install.packages(c("VIM",` `"mice",` `"missForest"))` will download
    and install them.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将探讨处理缺失数据的传统和现代方法。我们将主要使用`VIM`、`mice`和`missForest`软件包。命令`install.packages(c("VIM",
    "mice", "missForest"))`将下载并安装它们。
- en: To motivate the discussion, we’ll look at the mammal sleep dataset (`sleep`)
    provided in the `VIM` package (not to be confused with the `sleep` dataset describing
    the impact of drugs on sleep, provided in the base installation). The data come
    from a study by Allison and Chichetti (1976) that examined the relationship between
    sleep and ecological and constitutional variables for 62 mammal species. The authors
    were interested in why animals’ sleep requirements vary from species to species.
    The sleep variables served as the dependent variables, whereas the ecological
    and constitutional variables served as the independent or predictor variables.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 为了激发讨论，我们将查看`VIM`包中提供的哺乳动物睡眠数据集（`sleep`）（不要与描述药物对睡眠影响的`sleep`数据集混淆，该数据集包含在基本安装中）。数据来自Allison和Chichetti（1976）的研究，该研究考察了62种哺乳动物睡眠与生态和体质变量之间的关系。作者们对为什么动物的睡眠需求从一种物种到另一种物种会有所不同感兴趣。睡眠变量作为因变量，而生态和体质变量作为自变量或预测变量。
- en: Sleep variables included length of dreaming sleep (`Dream`), nondreaming sleep
    (`NonD`), and their sum (`Sleep`). The constitutional variables included body
    weight in kilograms (`BodyWgt`), brain weight in grams (`BrainWgt`), life span
    in years (`Span`), and gestation time in days (`Gest`). The ecological variables
    included the degree to which species were preyed upon (`Pred`), the degree of
    their exposure while sleeping (`Exp`), and overall danger (`Danger`) they faced.
    The ecological variables were measured on 5-point rating scales ranging from 1
    (low) to 5 (high).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 睡眠变量包括梦境睡眠的长度（`Dream`）、非梦境睡眠（`NonD`）以及它们的总和（`Sleep`）。体质变量包括体重（以千克计，`BodyWgt`）、脑重（以克计，`BrainWgt`）、寿命（以年计，`Span`）和妊娠时间（以天计，`Gest`）。生态变量包括物种被猎食的程度（`Pred`）、睡眠期间暴露的程度（`Exp`）以及它们面临的总体危险（`Danger`）。生态变量是在1（低）到5（高）的五点评分量表上测量的。
- en: In their original article, Allison and Chichetti limited their analyses to the
    species that had complete data. We’ll go further, analyzing all 62 cases with
    a multiple imputation approach.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在他们的原始文章中，Allison和Chichetti将他们的分析限制在具有完整数据的物种上。我们将更进一步，使用多重插补方法分析所有62个案例。
- en: 18.1 Steps in dealing with missing data
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.1 处理缺失数据的步骤
- en: 'If you’re new to the study of missing data, you’ll find a bewildering array
    of approaches, critiques, and methodologies. The classic text in this area is
    Little and Rubin (2002). Excellent, accessible reviews can be found in Allison
    (2001); Schafer and Graham (2002); Enders (2010); and Schlomer, Bauman, and Card
    (2010). A comprehensive approach usually includes the following steps:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你刚开始研究缺失数据，你会发现自己面前有一系列令人眼花缭乱的方法、批评和方法论。这个领域的经典文本是Little和Rubin（2002）。在Allison（2001）、Schafer和Graham（2002）、Enders（2010）以及Schlomer、Bauman和Card（2010）中可以找到优秀的、易于理解的综述。一种全面的方法通常包括以下步骤：
- en: Identify the missing data.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别缺失数据。
- en: Examine the causes of the missing data.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 检查缺失数据的原因。
- en: Delete the cases containing missing data or replace (impute) the missing values
    with reasonable alternative data values.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除包含缺失数据的案例或用合理的替代数据值替换（插补）缺失值。
- en: Unfortunately, identifying missing data is usually the only unambiguous step.
    Learning why data are missing depends on your understanding of the processes that
    generated the data. Deciding how to treat missing values will depend on your estimation
    of which procedures will produce the most reliable and accurate results.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，识别缺失数据通常是唯一明确的步骤。了解数据为何缺失取决于你对生成数据的过程的理解。决定如何处理缺失值将取决于你对哪些程序将产生最可靠和准确的结果的估计。
- en: A classification system for missing data
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 缺失数据的分类系统
- en: 'Statisticians typically classify missing data into one of three types. These
    types are usually described in probabilistic terms, but the underlying ideas are
    straightforward. We’ll use the measurement of dreaming in the sleep study (where
    12 animals have missing values) to illustrate each type in turn:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学家通常将缺失数据分为三种类型。这些类型通常用概率术语描述，但基本思想是直接的。我们将使用睡眠研究中梦境的测量（其中12个动物有缺失值）依次说明每种类型：
- en: '*Missing completely at random*—If the presence of missing data on a variable
    is unrelated to any other observed or unobserved variable, then the data are missing
    completely at random (MCAR). If there’s no systematic reason why dream sleep is
    missing for these 12 animals, the data are said to be MCAR. Note that if every
    variable with missing data is MCAR, you can consider the complete cases to be
    a simple random sample from the larger dataset.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*完全随机缺失*——如果一个变量的缺失数据与任何其他观测或未观测变量无关，那么这些数据就是完全随机缺失（MCAR）。如果这12只动物梦境睡眠缺失没有系统性原因，那么这些数据被认为是MCAR。请注意，如果每个有缺失数据的变量都是MCAR，你可以认为完整案例是从更大的数据集中抽取的简单随机样本。'
- en: '*Missing at random*—If the presence of missing data on a variable is related
    to other observed variables but not to its own unobserved value, the data are
    missing at random (MAR). For example, if animals with smaller body weights are
    more likely to have missing values for dream sleep (perhaps because it’s harder
    to observe smaller animals) and the “missingness” is unrelated to an animal’s
    time spent dreaming, the data are considered MAR. In this case, the presence or
    absence of dream sleep data is random, once you control for body weight.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*随机缺失*——如果一个变量的缺失数据与其它的观测变量相关，但与其自身的未观测值无关，那么这些数据就是随机缺失（MAR）。例如，如果体重较轻的动物更有可能缺失梦境睡眠的数据（可能是因为观察较小的动物更困难），并且“缺失性”与动物花在梦境中的时间无关，那么这些数据被认为是MAR。在这种情况下，一旦控制了体重，梦境睡眠数据的缺失与否就是随机的。'
- en: '*Not missing at random*—If the missing data for a variable are neither MCAR
    nor MAR, the data are not missing at random (NMAR). For example, if animals that
    spend less time dreaming are also more likely to have a missing dream value (perhaps
    because it’s harder to measure shorter events), the data are considered NMAR.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*非随机缺失*——如果一个变量的缺失数据既不是MCAR也不是MAR，那么这些数据就不是随机缺失（NMAR）。例如，如果花较少时间做梦的动物也更有可能缺失梦境值（可能是因为测量较短的持续时间更困难），那么这些数据被认为是NMAR。'
- en: Most approaches to missing data assume that the data are either MCAR or MAR.
    In this case, you can ignore the mechanism producing the missing data and (after
    replacing or deleting the missing data) model the relationships of interest directly.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数处理缺失数据的方法都假设数据要么是MCAR（完全随机缺失）要么是MAR（随机缺失）。在这种情况下，你可以忽略产生缺失数据的机制，并且在替换或删除缺失数据后，直接对感兴趣的关系进行建模。
- en: Data that are NMAR can be difficult to analyze properly. When data are NMAR,
    you have to model the mechanisms that produced the missing values as well as the
    relationships of interest. (Current approaches to analyzing NMAR data include
    the use of selection models and pattern mixtures. The analysis of NMAR data can
    be complex and is beyond the scope of this book.)
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于NMAR数据，正确分析可能很困难。当数据是NMAR时，你必须同时建模产生缺失值的机制以及感兴趣的关系。（分析NMAR数据的方法包括使用选择模型和模式混合。NMAR数据的分析可能很复杂，超出了本书的范围。）
- en: '![](Images/CH18_F01_Kabacoff3.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图像](Images/CH18_F01_Kabacoff3.png)'
- en: Figure 18.1 Methods for handling incomplete data, along with the R packages
    that support them
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.1 处理不完整数据的方法，以及支持它们的R包
- en: There are *many* methods for dealing with missing data—and no guarantee that
    they’ll produce the same results. Figure 18.1 describes an array of methods used
    for handling incomplete data and the R packages that support them.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 处理缺失数据的方法有很多，并且不能保证它们会产生相同的结果。图18.1描述了用于处理不完整数据的一系列方法以及支持它们的R包。
- en: 'A complete review of missing-data methodologies would require a book in itself
    (Enders [2010] is a great example). In this chapter, we’ll review methods for
    exploring missing-values patterns and focus on the four most popular methods for
    dealing with incomplete data: a rational approach, listwise deletion, single imputation,
    and multiple imputation. We’ll end with a brief discussion of other methods, including
    those that are useful in special circumstances.'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 对缺失数据方法的全面回顾需要一本书来阐述（Enders [2010] 是一个很好的例子）。在本章中，我们将回顾探索缺失值模式的方法，并重点关注处理不完整数据的四种最流行方法：理性方法、列表删除、单次插补和多次插补。我们将以对其他方法的简要讨论结束，包括在特殊情况下有用的那些方法。
- en: 18.2 Identifying missing values
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.2 识别缺失值
- en: To begin, let’s review the material introduced in section 3.5 and expand on
    it. R represents missing values using the symbol `NA` (not available) and impossible
    values using the symbol `NaN` (not a number). In addition, the symbols `Inf` and
    `-Inf` represent positive infinity and negative infinity, respectively. The functions
    `is.na``()`, `is.nan``()`, and `is.infinite``()` can be used to identify missing,
    impossible, and infinite values, respectively. Each returns either `TRUE` or `FALSE`.
    Table 18.1 gives examples.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们回顾第3.5节中介绍的材料，并在此基础上进行扩展。R使用符号`NA`（不可用）表示缺失值，使用符号`NaN`（非数字）表示不可能的值。此外，符号`Inf`和`-Inf`分别表示正无穷和负无穷。函数`is.na()`、`is.nan()`和`is.infinite()`可以分别用来识别缺失、不可能和无限值。每个函数返回`TRUE`或`FALSE`。表18.1给出了示例。
- en: Table 18.1 Examples of return values for the `is.na()`, `is.nan()`, and `is.infinite()`
    functions
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 表18.1 `is.na()`、`is.nan()`和`is.infinite()`函数的返回值示例
- en: '| `x` | `is.na(x)` | `is.nan(x)` | `is.infinite(x)` |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| `x` | `is.na(x)` | `is.nan(x)` | `is.infinite(x)` |'
- en: '| `x <- NA` | `TRUE` | `FALSE` | `FALSE` |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| `x <- NA` | `TRUE` | `FALSE` | `FALSE` |'
- en: '| `x <- 0 / 0` | `TRUE` | `TRUE` | `FALSE` |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| `x <- 0 / 0` | `TRUE` | `TRUE` | `FALSE` |'
- en: '| `x <- 1 / 0` | `FALSE` | `FALSE` | `TRUE` |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| `x <- 1 / 0` | `FALSE` | `FALSE` | `TRUE` |'
- en: These functions return an object that’s the same size as its argument, with
    each element replaced by `TRUE` if the element is of the type being tested or
    `FALSE` otherwise. For example, let `y` `<-` `c(1,` `2,` `3,` `NA)`. Then `is.na(y)`
    will return the vector `c(FALSE,` `FALSE,` `FALSE,` `TRUE)`.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这些函数返回一个与它的参数大小相同的对象，如果元素是正在测试的类型，则每个元素被替换为`TRUE`，否则为`FALSE`。例如，设`y <- c(1,
    2, 3, NA)`。那么`is.na(y)`将返回向量`c(FALSE, FALSE, FALSE, TRUE)`。
- en: The function `complete.cases``()` can be used to identify the rows in a matrix
    or data frame that don’t contain missing data. It returns a logical vector with
    `TRUE` for every row that contains complete cases and `FALSE` for every row that
    has one or more missing values.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 函数`complete.cases()`可以用来识别矩阵或数据框中不包含缺失值的行。它返回一个逻辑向量，对于包含完整案例的每一行返回`TRUE`，对于有缺失值的每一行返回`FALSE`。
- en: 'Let’s apply this to the sleep dataset:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将此应用于睡眠数据集：
- en: '[PRE0]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Examining the output reveals that 42 cases have complete data and 20 cases have
    one or more missing values.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 检查输出结果显示，有42个案例数据完整，20个案例有一个或多个缺失值。
- en: 'Because the logical values `TRUE` and `FALSE` are equivalent to the numeric
    values 1 and 0, the `sum``()` and `mean()` functions can be used to obtain useful
    information about missing data. Consider the following:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 因为逻辑值`TRUE`和`FALSE`等同于数值1和0，所以`sum()`和`mean()`函数可以用来获取有关缺失数据的有用信息。考虑以下内容：
- en: '[PRE1]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The results indicate that 12 values are missing for the variable `Dream`. Nineteen
    percent of the cases have a missing value on this variable. In addition, 32% of
    the cases in the dataset have one or more missing values.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 结果表明，变量`Dream`有12个值缺失。在这个变量上，19%的案例有缺失值。此外，数据集中32%的案例有一个或多个缺失值。
- en: There are two things to keep in mind when identifying missing values. First,
    the `complete.cases()` function only identifies `NA` and `NaN` as missing. Infinite
    values (`Inf` and `–Inf`) are treated as valid values. Second, you must use missing-values
    functions, like those in this section, to identify the missing values in R data
    objects. Logical comparisons such as `myvar == NA` are never true.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在识别缺失值时有两个需要注意的事项。首先，`complete.cases()`函数只识别`NA`和`NaN`为缺失值。无限值（`Inf`和`–Inf`）被视为有效值。其次，你必须使用缺失值函数，如本节中所述，来识别R数据对象中的缺失值。逻辑比较如`myvar
    == NA`永远不会为真。
- en: Now that you know how to identify missing values programmatically, let’s look
    at tools that help you explore possible patterns in the occurrence of missing
    data.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经知道了如何通过编程方式识别缺失值，让我们看看帮助探索缺失数据发生可能模式的工具。
- en: 18.3 Exploring missing-values patterns
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.3 探索缺失值模式
- en: Before deciding how to deal with missing data, you’ll find it useful to determine
    which variables have missing values, in what amounts, and in what combinations.
    In this section, we’ll review tabular, graphical, and correlational methods for
    exploring missing-values patterns. Ultimately, you want to understand why the
    data is missing. The answer will have implications for how you proceed with further
    analyses.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在决定如何处理缺失数据之前，确定哪些变量有缺失值、缺失的数量以及缺失的组合将非常有用。在本节中，我们将回顾探索缺失值模式的各种表格、图形和相关性方法。最终，你想要了解数据缺失的原因。这个答案将影响你如何进行进一步的分析。
- en: 18.3.1 Visualizing missing values
  id: totrans-50
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.3.1 可视化缺失值
- en: The `md.pattern()` function in the `mice` package produces a tabulation of the
    missing-data patterns in a matrix or data frame. Additionally, it plots the tabulation
    as a graph. Applying this function to the `sleep` dataset produces the output
    in the following listing and the graph in figure 18.2.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '`mice` 包中的 `md.pattern()` 函数在矩阵或数据框中生成缺失数据模式的表格。此外，它还以图形的形式绘制这个表格。将此函数应用于 `sleep`
    数据集，生成以下列表和图 18.2 中的图形。'
- en: Listing 18.1 Missing-values patterns with `md.pattern()`
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 18.1 使用 `md.pattern()` 的缺失值模式
- en: '[PRE2]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: The 1s and 0s in the body of the table indicate the missing-values patterns,
    with a 0 indicating a missing value for a given column variable and a 1 indicating
    a nonmissing value. The first row describes the pattern of *no missing values*
    (all elements are 1). The second row describes the pattern *no missing values
    except for* `Span`. The first column indicates the number of cases in each missing-data
    pattern, and the last column indicates the number of variables with missing values
    present in each pattern. Here you can see that there are 42 cases without missing
    data and 2 cases that are missing `Span` alone. Nine cases are missing both `NonD`
    and `Dream` values. The dataset has a total of (42 × 0) + (2 × 1) + ... + (1 ×
    3) = 38 missing values. The last row gives the total number of missing values
    on each variable.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 表格主体中的 1 和 0 表示缺失值模式，其中 0 表示给定列变量缺失值，1 表示非缺失值。第一行描述了 *无缺失值* 的模式（所有元素都是 1）。第二行描述了
    *除了 Span 外无缺失值* 的模式。第一列表示每个缺失数据模式中的案例数量，最后一列表示每个模式中存在缺失值的变量数量。在这里，您可以看到有 42 个没有缺失数据的案例，2
    个案例仅缺失 `Span`。有 9 个案例同时缺失 `NonD` 和 `Dream` 值。该数据集总共有 (42 × 0) + (2 × 1) + ...
    + (1 × 3) = 38 个缺失值。最后一行给出了每个变量的总缺失值数。
- en: Although the tabular output from the `md.pattern()` function is compact, I often
    find it easier to discern patterns visually. In figure 18.2, each row represents
    a pattern. Dark blue indicates values that are present, while light red indicates
    missing values. Numbers on the left indicate the number of cases in a pattern,
    the numbers on the right indicate the number of missing variables in a pattern,
    and the numbers on the bottom indicate the number of missing values for each variable.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然来自 `md.pattern()` 函数的表格输出很紧凑，但我经常发现通过视觉方式更容易识别模式。在图 18.2 中，每一行代表一个模式。深蓝色表示存在值，而浅红色表示缺失值。左侧的数字表示模式中的案例数量，右侧的数字表示模式中缺失变量的数量，底部的数字表示每个变量的缺失值数量。在这里，您可以看到有
    42 个没有缺失数据的案例，2 个案例仅缺失 `Span`。有 9 个案例同时缺失 `NonD` 和 `Dream` 值。该数据集总共有 (42 × 0)
    + (2 × 1) + ... + (1 × 3) = 38 个缺失值。最后一行给出了每个变量的总缺失值数。
- en: '![](Images/CH18_F02_Kabacoff3.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH18_F02_Kabacoff3.png)'
- en: Figure 18.2 Missing-values patterns summarized by the `md.pattern()` function.
    Each row represents a pattern of missing (light red) and nonmissing (dark blue)
    data.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18.2 由 `md.pattern()` 函数总结的缺失值模式。每一行代表缺失（浅红色）和非缺失（深蓝色）数据的一个模式。
- en: 'The `VIM` package provides numerous functions for visualizing missing-values
    patterns in datasets. Here, we will look at three of the most useful: `aggr``()`,
    `matrixplot``()`, and `marginplot``()`.'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '`VIM` 包提供了许多用于可视化数据集中缺失值模式的函数。在这里，我们将查看其中三个最有用的：`aggr()`、`matrixplot()` 和 `marginplot()`。'
- en: The `aggr()` function plots the number of missing values for each variable alone
    and for each combination of variables. It provides a nice alternative to figure
    18.2\. For example, the code
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '`aggr()` 函数单独为每个变量以及每个变量的组合绘制缺失值的数量。它为图 18.2 提供了一个很好的替代方案。例如，以下代码'
- en: '[PRE3]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: produces the graph in figure 18.3.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 生成图 18.3 的图形。
- en: '![](Images/CH18_F03_Kabacoff3.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH18_F03_Kabacoff3.png)'
- en: Figure 18.3 `aggr()`-produced plot of missing-values patterns for the sleep
    dataset
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 图 18.3 `aggr()` 生成的睡眠数据集的缺失值模式图
- en: You can see that the variable `NonD` has the largest number of missing values
    (14), and that two mammals are missing `NonD`, `Dream`, and `Sleep` scores. Forty-two
    mammals have no missing data.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到变量 `NonD` 有最多的缺失值（14个），并且有两种哺乳动物缺失 `NonD`、`Dream` 和 `Sleep` 分数。四十二种哺乳动物没有缺失数据。
- en: The statement `aggr(sleep, prop=TRUE, numbers=TRUE)` produces the same plot,
    but proportions are displayed instead of counts. The option `numbers=FALSE` (the
    default) suppresses the numeric labels. Note that as the number of variables in
    the dataset increases, the plot labels for this graph can become badly distorted.
    You can fix this by manually decreasing the size of plot labels. Including the
    parameters `cex.lab=``n`, `cex.axis=``n`, and `cex.number=``n` (where `n` is a
    number less than 1) will shrink the size of the axis, variable, and number labels,
    respectively.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 语句 `aggr(sleep, prop=TRUE, numbers=TRUE)` 生成相同的图表，但显示的是比例而不是计数。选项 `numbers=FALSE`（默认值）抑制了数字标签。请注意，随着数据集中变量数量的增加，此图表的标签可能会严重变形。你可以通过手动减小标签大小来修复此问题。包括参数
    `cex.lab=``n`，`cex.axis=``n`，和 `cex.number=``n`（其中 `n` 是小于1的数字）将分别缩小轴、变量和数字标签的大小。
- en: The `matrixplot()` function produces a plot displaying the data for each case.
    Figure 18.4 shows a graph created using `matrixplot(sleep,` `sort="BodyWgt")`.
    Here, the numeric data are rescaled to the interval [0, 1] and represented by
    grayscale colors, with lighter colors representing lower values and darker colors
    representing larger values. By default, missing values are represented in red.
    Note that in figure 18.4, red has been replaced with crosshatching by hand, so
    that the missing values are viewable in grayscale. The rows in figure 18.4 are
    sorted by `BodyWgt`.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '`matrixplot()` 函数生成一个显示每个案例数据的图表。图18.4展示了使用 `matrixplot(sleep, sort="BodyWgt")`
    创建的图形。在这里，数值数据被缩放到区间 [0, 1]，并以灰度颜色表示，较浅的颜色代表较小的值，较深的颜色代表较大的值。默认情况下，缺失值用红色表示。请注意，在图18.4中，红色已被手工替换为交叉线，以便在灰度下查看缺失值。图18.4中的行按
    `BodyWgt` 排序。'
- en: '![](Images/CH18_F04_Kabacoff3.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH18_F04_Kabacoff3.png)'
- en: Figure 18.4 Matrix plot of actual and missing values by case (row) for the `sleep`
    dataset. The matrix is sorted by `BodyWgt`.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.4展示了 `sleep` 数据集中按案例（行）实际和缺失值的矩阵图。矩阵按 `BodyWgt` 排序。
- en: The `marginplot()` function produces a scatter plot between two variables with
    information about missing values shown in the plot’s margins. Consider the relationship
    between the amount of dream sleep and the length of a mammal’s gestation. The
    statement
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '`marginplot()` 函数在两个变量之间生成散点图，并在图表的边缘显示有关缺失值的信息。考虑梦境睡眠量和哺乳动物妊娠长度之间的关系。以下语句'
- en: '[PRE4]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: produces the graph in figure 18.5\. The `pch` and `col` parameters are optional
    and provide control over the plotting symbols and colors.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 生成图18.5中的图形。`pch` 和 `col` 参数是可选的，它们提供了对绘图符号和颜色的控制。
- en: '![](Images/CH18_F05_Kabacoff3.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH18_F05_Kabacoff3.png)'
- en: Figure 18.5 Scatter plot between amount of dream sleep and length of gestation,
    with information about missing data in the margins
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.5展示了梦境睡眠量和妊娠长度之间的散点图，边缘包含缺失数据的信息
- en: The body of the graph displays the scatter plot between `Gest` and `Dream` (based
    on complete cases for the two variables). In the left margin, box plots display
    the distribution of `Dream` for mammals with (dark gray) and without (red) `Gest`
    values. (Note that in grayscale, red is the darker shade.) Four red dots represent
    the values of `Dream` for mammals missing `Gest` scores. In the bottom margin,
    the roles of `Gest` and `Dream` are reversed. You can see that a negative relationship
    exists between length of gestation and dream sleep and that dream sleep tends
    to be higher for mammals that are missing a gestation score. The number of observations
    missing values on both variables at the same time is printed in blue at the intersection
    of both margins (bottom left).
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图形主体显示了 `Gest` 和 `Dream` 之间的散点图（基于两个变量的完整案例）。在左侧边缘，箱线图显示了具有（深灰色）和没有（红色）`Gest`
    值的哺乳动物的 `Dream` 分布。（注意，在灰度图中，红色是较深的色调。）四个红色点代表缺失 `Gest` 得分的哺乳动物的 `Dream` 值。在底部边缘，`Gest`
    和 `Dream` 的角色被反转。你可以看到妊娠长度和梦境睡眠之间存在负相关关系，并且对于缺失妊娠得分的哺乳动物，梦境睡眠往往较高。同时缺失两个变量值的观测数以蓝色打印在两个边缘的交叉点（左下角）。
- en: The `VIM` package has many graphs that can help you understand the role of missing
    data in a dataset and is well worth exploring. There are functions to produce
    scatter plots, box plots, histograms, scatter plot matrices, parallel plots, rug
    plots, and bubble plots that incorporate information about missing values.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '`VIM` 包含许多图表，可以帮助你理解缺失数据在数据集中的作用，并且值得探索。有生成散点图、箱线图、直方图、散点图矩阵、平行图、地毯图和包含缺失值信息的气泡图的函数。'
- en: 18.3.2 Using correlations to explore missing values
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.3.2 使用相关系数探索缺失值
- en: Before we move on, there’s one more approach worth noting. You can replace the
    data in a dataset with indicator variables coded `1` for missing and `0` for present.
    The resulting matrix is sometimes called a shadow matrix. Correlating these indicator
    variables with each other and with the original (observed) variables can help
    you see which variables tend to be missing together, as well as relationships
    between a variable’s *missingness* and the values of the other variables.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们继续之前，还有一种值得注意的方法。你可以在数据集中用编码为`1`表示缺失和`0`表示存在的指示变量替换数据。得到的矩阵有时被称为影子矩阵。将这些指示变量相互之间以及与原始（观测）变量进行相关分析可以帮助你看到哪些变量倾向于同时缺失，以及一个变量的*缺失性*与其他变量的值之间的关系。
- en: 'Consider the following code:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑以下代码：
- en: '[PRE5]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The elements of data frame `x` are `1` if the corresponding element of `sleep`
    is missing and `0` otherwise. You can see this by viewing the first few rows of
    each:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 数据框`x`的元素如果是`sleep`对应元素缺失则为`1`，否则为`0`。你可以通过查看每个的前几行来看到这一点：
- en: '[PRE6]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The statement
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 以下声明
- en: '[PRE7]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: extracts the variables that have some (but not all) missing values, and
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 提取具有一些（但不是全部）缺失值的变量，并且
- en: '[PRE8]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'gives you the correlations among these indicator variables:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 给出这些指示变量之间的相关系数：
- en: '[PRE9]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here, you can see that `Dream` and `NonD` tend to be missing together (r = 0.91).
    To a lesser extent, `Sleep` and `NonD` tend to be missing together (r = 0.49),
    and `Sleep` and `Dream` tend to be missing together (r = 0.20).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到`Dream`和`NonD`倾向于同时缺失（r = 0.91）。在较小的程度上，`Sleep`和`NonD`也倾向于同时缺失（r =
    0.49），以及`Sleep`和`Dream`也倾向于同时缺失（r = 0.20）。
- en: 'Finally, you can look at the relationship between missing values in a variable
    and the observed values on other variables:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你可以查看一个变量中的缺失值与其他变量的观测值之间的关系：
- en: '[PRE10]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: In this correlation matrix, the rows are observed variables, and the columns
    are indicator variables representing missingness. You can ignore the warning message
    and `NA` values in the correlation matrix; they’re artifacts of our approach.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个相关矩阵中，行是观测变量，列是表示缺失性的指示变量。你可以忽略相关矩阵中的警告信息和`NA`值；它们是我们方法的艺术品。
- en: From the first column of the correlation matrix, you can see that nondreaming
    sleep scores are more likely to be missing for mammals with higher body weight
    (r = 0.227), gestation period (r = 0.202), and sleeping exposure (r = 0.245).
    Other columns are read in a similar fashion. None of the correlations in this
    table are particularly large or striking, which suggests that the data deviate
    minimally from MCAR and may be MAR.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 从相关矩阵的第一列中，你可以看到非做梦睡眠分数更有可能缺失于体重较高的哺乳动物（r = 0.227）、妊娠期（r = 0.202）和睡眠暴露（r = 0.245）。其他列以类似方式读取。这个表中的相关性都不是特别大或引人注目，这表明数据与MCAR偏差很小，可能是MAR。
- en: Note that you can never rule out the possibility that the data are NMAR because
    you don’t know what the values would have been for data that are missing. For
    example, you don’t know if there’s a relationship between the amount of dreaming
    a mammal engages in and the probability of a value being missing on this variable.
    In the absence of strong external evidence to the contrary, we typically assume
    that data are either MCAR or MAR.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，你永远不能排除数据是非缺失完全随机（NMAR）的可能性，因为你不知道缺失数据的值是什么。例如，你不知道哺乳动物做梦的数量与这个变量值缺失的概率之间是否存在关系。在没有强有力的外部证据的情况下，我们通常假设数据要么是完全随机缺失（MCAR）要么是随机缺失（MAR）。
- en: 18.4 Understanding the sources and impact of missing data
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.4 理解缺失数据的原因和影响
- en: 'You can identify the amount, distribution, and pattern of missing data to evaluate
    the potential mechanisms leading to the missing data and the impact of the missing
    data on your ability to answer substantive questions. In particular, you want
    to answer the following questions:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以确定缺失数据的数量、分布和模式，以评估导致缺失数据的潜在机制以及缺失数据对你回答实质性问题的能力的影响。特别是，你想要回答以下问题：
- en: What percentage of the data is missing?
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缺失数据占数据的百分比是多少？
- en: Are the missing data concentrated in a few variables or widely distributed?
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缺失数据是否集中在少数几个变量中或广泛分布？
- en: Do the missing values appear to be random?
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缺失值看起来是否是随机的？
- en: Does the covariation of missing data with each other or with observed data suggest
    a possible mechanism that’s producing the missing values?
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缺失数据彼此之间或与观测数据的相关性是否表明存在产生缺失值的可能机制？
- en: Answers to these questions help determine which statistical methods are most
    appropriate for analyzing your data. For example, if the missing data are concentrated
    in a few relatively unimportant variables, you may be able to delete these variables
    and continue your analyses normally. If a small amount of data (say, less than
    10%) is randomly distributed throughout the dataset (MCAR), you may be able to
    limit your analyses to cases with complete data and still get reliable and valid
    results. If you can assume that the data are either MCAR or MAR, you may be able
    to apply multiple imputation methods to arrive at valid conclusions. If the data
    are NMAR, you can turn to specialized methods, collect new data, or go into an
    easier and more rewarding profession.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 这些问题的答案有助于确定哪些统计方法最适合分析你的数据。例如，如果缺失数据集中在几个相对不重要的变量中，你可能能够删除这些变量并继续正常分析。如果少量数据（比如说，少于10%）在数据集中随机分布（MCAR），你可能能够将分析限制在具有完整数据的案例上，并仍然得到可靠和有效的结果。如果你可以假设数据是MCAR或MAR，你可能能够应用多重插补方法来得出有效的结论。如果数据是NMAR，你可以转向专门的方法，收集新的数据，或者选择一个更容易且更有回报的职业。
- en: 'Here are some examples:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一些例子：
- en: In a recent survey employing paper questionnaires, I found that several items
    tended to be missing together. It became apparent that these items clustered together
    because participants didn’t realize that the third page of the questionnaire had
    a reverse side—which contained the items. In this case, the data could be considered
    MCAR.
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在一项最近使用纸质问卷的调查中，我发现几个项目倾向于同时缺失。很明显，这些项目聚集在一起是因为参与者没有意识到问卷的第三页有背面——背面包含了这些项目。在这种情况下，数据可以考虑为MCAR。
- en: In another study, an education variable was frequently missing in a global survey
    of leadership styles. Investigation revealed that European participants were more
    likely to leave this item blank. It turned out that the categories didn’t make
    sense for participants in certain countries. In this case, the data were most
    likely MAR.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在另一项研究中，一个教育变量在全球领导风格调查中经常缺失。调查发现，欧洲参与者更有可能留空这一项。结果证明，某些国家的参与者认为这些类别没有意义。在这种情况下，数据最可能是MAR。
- en: Finally, I was involved in a study of depression in which older patients were
    more likely to omit items describing depressed mood compared with younger patients.
    Interviews revealed that older patients were loath to admit to such symptoms because
    doing so violated their values about “keeping a stiff upper lip.” Unfortunately,
    it was also determined that severely depressed patients were more likely to omit
    these items due to a sense of hopelessness and difficulties with concentration.
    In this case, the data had to be considered NMAR.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我参与了一项关于抑郁症的研究，其中老年患者比年轻患者更有可能省略描述抑郁情绪的项目。访谈显示，老年患者不愿意承认这些症状，因为这违反了他们关于“保持坚强”的价值观念。不幸的是，还发现严重抑郁的患者更有可能省略这些项目，因为感到绝望和注意力难以集中。在这种情况下，必须将数据视为NMAR。
- en: As you can see, identifying patterns is only the first step. You need to bring
    your understanding of the research subject matter and the data collection process
    to bear to determine the source of the missing values.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所见，识别模式只是第一步。你需要将你对研究主题和数据收集过程的理解应用于确定缺失值的来源。
- en: 'Now that we’ve considered the source and impact of missing data, let’s see
    how standard statistical approaches can be altered to accommodate them. We’ll
    focus on four popular approaches: a rational approach for recovering data, a traditional
    approach that involves deleting missing data, a modern approach that imputes individual
    missing values, and a modern approach that uses simulation to account for the
    impact of missing data on conclusions. Along the way, we’ll briefly look at methods
    for specialized situations and methods that have become obsolete and should be
    retired. The goal will remain constant: to answer, as accurately as possible,
    the substantive questions that led you to collect the data, given the absence
    of complete information.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经考虑了缺失数据的来源和影响，让我们看看标准统计方法如何被调整以适应它们。我们将关注四种流行的方法：一种用于恢复数据的有理方法，一种涉及删除缺失数据的传统方法，一种用于插补单个缺失值的方法，以及一种使用模拟来考虑缺失数据对结论影响的方法。在这个过程中，我们将简要介绍专门情况的方法和已经过时应该被淘汰的方法。目标将保持不变：尽可能准确地回答导致你收集数据的实质性问题，考虑到信息不完整的情况。
- en: 18.5 Rational approaches for dealing with incomplete data
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.5 处理不完整数据的理性方法
- en: In a rational approach, you use mathematical or logical relationships among
    variables to attempt to fill in or recover missing values. A few examples will
    help clarify this approach.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在理性方法中，你使用变量之间的数学或逻辑关系来尝试填补或恢复缺失值。一些例子将有助于阐明这种方法。
- en: In the `sleep` dataset, the variable `Sleep` is the sum of the `Dream` and `NonD`
    variables. If you know a mammal’s scores on any two, you can derive the third.
    Thus, if some observations were missing only one of the three variables, you could
    recover the missing information through addition or subtraction.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在`sleep`数据集中，变量`Sleep`是`Dream`和`NonD`变量的总和。如果你知道一种哺乳动物的任意两个得分，你就可以推导出第三个得分。因此，如果某些观测值缺失了三个变量中的一个，你可以通过加法或减法恢复缺失的信息。
- en: As a second example, consider research that focuses on work/life balance differences
    between generational cohorts (for example, Silents, Early Boomers, Late Boomers,
    Xers, Millennials), where cohorts are defined by their birth year. Participants
    are asked both their date of birth and their age. If date of birth is missing,
    you can recover their birth year (and therefore their generational cohort) by
    knowing their age and the date they completed the survey.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 作为第二个例子，考虑关注代际群体（例如，沉默的一代、早期婴儿潮一代、晚期婴儿潮一代、X一代、千禧一代）之间工作/生活平衡差异的研究，其中群体是根据他们的出生年份定义的。参与者被要求提供他们的出生日期和年龄。如果出生日期缺失，你可以通过知道他们的年龄和完成调查的日期来恢复他们的出生年份（因此他们的代际群体）。
- en: An example that uses logical relationships to recover missing data comes from
    a set of leadership studies in which participants were asked if they were a manager
    (yes/no) and the number of their direct reports (integer). If they left the manager
    question blank but indicated that they had one or more direct reports, it would
    be reasonable to infer that they were a manager.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 使用逻辑关系恢复缺失数据的一个例子来自一系列领导力研究，其中参与者被问及他们是否是管理者（是/否）以及他们直接下属的数量（整数）。如果他们留空管理者问题但表明他们有一个或多个直接下属，那么推断他们是管理者是合理的。
- en: As a final example, I frequently engage in gender research that compares the
    leadership styles and effectiveness of men and women. Participants complete surveys
    that include their name (first and last), their gender, and a detailed assessment
    of their leadership approach and impact. If participants leave the gender question
    blank, I have to impute the value to include them in the research. In one recent
    study of 66,000 managers, 11,000 (17%) were missing a value for gender.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 作为最后的例子，我经常参与性别研究，比较男性和女性的领导风格和有效性。参与者完成包括他们的名字（名和姓）、他们的性别以及他们领导方法和影响的详细评估的调查。如果参与者留空性别问题，我必须估算值以将他们包括在研究中。在一项最近对66,000名管理者的研究中，11,000名（17%）缺失性别值。
- en: To remedy the situation, I employed the following rational process. First, I
    cross-tabulated first name with gender. Some first names were associated with
    males, some with females, and some with both. For example, *William* appeared
    417 times and was always a male. Conversely, the name *Chris* appeared 237 times
    but was sometimes a male (86%) and sometimes a female (14%). If a first name appeared
    more than 20 times in the dataset and was always associated with males or with
    females (but never both), I assumed that the name represented a single gender.
    I used this assumption to create a gender-lookup table for gender-specific first
    names. By using this lookup table for participants with missing gender values,
    I was able to recover 7,000 cases (63% of the missing responses).
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决这个问题，我采用了以下理性过程。首先，我将名字和性别进行交叉制表。一些名字与男性相关联，一些与女性相关联，还有一些与两者都相关。例如，*William*出现了417次，并且总是男性。相反，名字*Chris*出现了237次，但有时是男性（86%）有时是女性（14%）。如果一个名字在数据集中出现了超过20次，并且总是与男性或女性相关联（但从不与两者都相关），我假设这个名字代表单一性别。我使用这个假设为特定性别的名字创建了一个性别查找表。通过使用这个查找表为缺失性别值的参与者，我能够恢复7,000个案例（63%的缺失响应）。
- en: A rational approach typically requires creativity and thoughtfulness, along
    with a degree of data management skill. Data recovery may be exact (as in the
    sleep example) or approximate (as in the gender example). In the next section,
    we’ll explore approaches that create complete datasets by removing observations.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 理性方法通常需要创造力、周到以及一定程度的数据管理技能。数据恢复可能是精确的（如睡眠示例所示）或近似的（如性别示例所示）。在下一节中，我们将探讨通过删除观测值来创建完整数据集的方法。
- en: 18.6 Deleting missing data
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.6 删除缺失数据
- en: The most common approach to missing data is to simply delete them. This usually
    involves deleting variables (columns) with excessive amounts of missing data and
    then deleting observations (rows) containing missing data on any of the remaining
    variables (listwise deletion). A less common alternative is to only delete missing
    data involved in a particular analysis (e.g., pairwise deletion). Each is described
    next.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 处理缺失数据最常见的方法是简单地删除它们。这通常涉及删除具有大量缺失数据的变量（列），然后删除包含任何剩余变量（列表删除）缺失数据的观测值。一个不太常见的选择是仅删除特定分析中涉及的缺失数据（例如，成对删除）。每种方法将在下面进行描述。
- en: 18.6.1 Complete-case analysis (listwise deletion)
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.6.1 完整案例分析（列表删除）
- en: In complete-case analysis, only observations containing valid data values on
    every variable are retained for further analysis. Practically, this involves deleting
    any row with one or more missing values and is also known as *listwise*, or *case-wise*,
    *deletion*. Most popular statistical packages employ listwise deletion as the
    default approach for handling missing data. In fact, it’s so common that many
    analysts carrying out analyses like regression or ANOVA may not even realize that
    there’s a *missing-values problem* to be dealt with!
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在完整案例分析中，只有包含每个变量有效数据值的观测值被保留用于进一步分析。实际上，这涉及到删除任何包含一个或多个缺失值的行，也被称为*列表删除*、*案例删除*或*逐个删除*。大多数流行的统计软件包将列表删除作为处理缺失数据的默认方法。事实上，它如此普遍，以至于许多执行回归或方差分析等分析的分析师甚至可能没有意识到存在一个*缺失值问题*需要解决！
- en: 'The function `complete.cases()` can be used to save the cases (rows) of a matrix
    or data frame without missing data:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用`complete.cases()`函数来保存没有缺失数据的矩阵或数据框的案例（行）：
- en: '[PRE11]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'The same result can be accomplished with the `na.omit` function:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 同样的结果可以使用`na.omit`函数实现：
- en: '[PRE12]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: In both statements, any rows that are missing data are deleted from `mydata`
    before the results are saved to `newdata`.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在这两个语句中，在结果保存到`newdata`之前，会从`mydata`中删除任何缺失数据的行。
- en: 'Suppose you’re interested in the correlations among the variables in the sleep
    study. Applying listwise deletion, you’d delete all mammals with missing data
    prior to calculating the correlations:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你对睡眠研究中变量的相关性感兴趣。应用列表删除，你会在计算相关性之前删除所有带有缺失数据的哺乳动物：
- en: '[PRE13]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'If you wanted to study the impact of life span and length of gestation on the
    amount of dream sleep, you could employ linear regression with listwise deletion:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要研究寿命和妊娠期长度对梦境睡眠量的影响，你可以使用列表删除的线性回归：
- en: '[PRE14]'
  id: totrans-127
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Here, you see that mammals with shorter gestation periods have more dream sleep
    (controlling for life span) and that life span is unrelated to dream sleep when
    controlling for gestation period. The analysis is based on 42 cases with complete
    data.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到，对于妊娠期较短的哺乳动物来说，它们的梦境睡眠时间更长（在控制寿命的情况下），而当控制妊娠期时，寿命与梦境睡眠无关。该分析基于42个完整数据案例。
- en: In the previous example, what would have happened if `data=na.omit(sleep)` had
    been replaced with `data=sleep`? Like many R functions, `lm``()` uses a limited
    definition of listwise deletion. Cases with any missing data on the variables
    fitted by the function (`Dream`, `Span`, and `Gest` in this case) would have been
    deleted. The analysis would have been based on 42 cases.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一个例子中，如果将`data=na.omit(sleep)`替换为`data=sleep`会发生什么？像许多R函数一样，`lm()`使用的是有限制的列表删除定义。在这种情况下，任何在函数拟合的变量（例如，梦境、寿命和妊娠期）上存在缺失数据的案例都会被删除。分析将基于42个案例。
- en: Listwise deletion assumes that the data are MCAR (that is, the complete observations
    are a random subsample of the full dataset). In the current example, we’ve assumed
    that the 42 mammals used are a random subsample of the 62 mammals collected. To
    the degree that the MCAR assumption is violated, the resulting regression parameters
    will be biased. Deleting all observations with missing data can also reduce statistical
    power by reducing the available sample size. In the current example, listwise
    deletion reduced the sample size by 32%.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 列表删除假设数据是MCAR（即，完整观测值是完整数据集的随机子样本）。在当前例子中，我们假设使用的42只哺乳动物是收集到的62只哺乳动物的随机子样本。在MCAR假设被违反到一定程度时，得到的回归参数将会存在偏差。删除所有带有缺失数据的观测值也会通过减少可用样本量来降低统计功效。在当前例子中，列表删除将样本量减少了32%。
- en: 18.6.2 Available case analysis (pairwise deletion)
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.6.2 可用案例分析（成对删除）
- en: '*Pairwise* *deletion* is often considered an alternative to listwise deletion
    when you’re working with datasets that have missing values. In pairwise deletion,
    observations are deleted only if they’re missing data for the variables involved
    in a specific analysis. Consider the following code:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '*成对* *删除* 通常被认为是处理具有缺失值的数据集时的另一种选择。在成对删除中，只有当观测值缺失了特定分析中涉及的变量数据时，才会删除观测值。考虑以下代码：'
- en: '[PRE15]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: In this example, correlations between any two variables use all available observations
    for those two variables (ignoring the other variables). The correlation between
    `BodyWgt` and `BrainWgt` is based on all 62 mammals (the number of mammals with
    data on both variables). The correlation between `Dream` and `BodyWgt` is based
    on 50 mammals, and the correlation between `Dream` and `NonD` is based on 48 mammals.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，任何两个变量之间的相关性都是基于这两个变量的所有可用观测值（忽略其他变量）。`BodyWgt` 和 `BrainWgt` 之间的相关性是基于所有
    62 只哺乳动物（这两个变量都有数据的哺乳动物数量）。`Dream` 和 `BodyWgt` 之间的相关性是基于 50 只哺乳动物，而 `Dream` 和
    `NonD` 之间的相关性是基于 48 只哺乳动物。
- en: Although pairwise deletion appears to use all available data, each calculation
    is in fact based on a different subset of the data. This can lead to distorted
    and difficult-to-interpret results. I recommend staying away from this approach.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然成对删除看起来使用了所有可用数据，但实际上每个计算都是基于数据的不同子集。这可能导致扭曲和难以解释的结果。我建议避免这种方法。
- en: Next, we’ll consider an approach that employs the entire dataset (including
    cases with missing data).
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将考虑一种采用整个数据集（包括缺失数据的案例）的方法。
- en: 18.7 Single imputation
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.7 单一填补
- en: In *single imputation*, each missing value is replaced by a reasonable alternative
    value (i.e., a plausible guess). In this section, we’ll cover three approaches
    and describe when to use (or not use) each.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *单一填补* 中，每个缺失值都替换为一个合理的替代值（即一个合理的猜测）。在本节中，我们将介绍三种方法，并描述何时使用（或不使用）每种方法。
- en: 18.7.1 Simple imputation
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.7.1 简单填补
- en: In *simple imputation*, the missing values in a variable are replaced with a
    single value (for example, the mean, median, or mode). Using mean substitution,
    you could replace each missing value on the `Dream` variable with 1.972 (the mean
    of the non-missing values).
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *简单填补* 中，一个变量的缺失值被替换为一个单一值（例如，均值、中位数或众数）。使用均值替换，你可以用非缺失值的均值 1.972 替换 `Dream`
    变量上的每个缺失值。
- en: An advantage of simple imputation is that it solves the missing-values problem
    without reducing the sample size available for analyses. Because simple imputation
    is, well, simple, it has become quite popular. However, it produces biased results
    for data that aren’t MCAR. If moderate-to-large amounts of data are missing, simple
    imputation is likely to underestimate standard errors, distort correlations among
    variables, and produce incorrect p-values in statistical tests. I recommend avoiding
    this approach for most missing-data problems.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 简单填补的一个优点是它解决了缺失值问题，而没有减少可用于分析的数据样本量。由于简单填补简单易行，因此它变得相当流行。然而，对于非完全随机缺失（MCAR）的数据，它会产生有偏的结果。如果缺失的数据量适中到较大，简单填补可能会低估标准误差，扭曲变量之间的相关性，并在统计测试中产生错误的
    p 值。我建议避免在大多数缺失值问题上使用这种方法。
- en: 18.7.2 K-nearest neighbor imputation
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.7.2 K-最近邻填补
- en: The idea behind *k-nearest neighbor imputation* is simple. For an observation
    with one or more missing values, find the observations that are most similar but
    have the values, and use these cases to make the imputation.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: '*k-最近邻填补* 的理念很简单。对于一个有一个或多个缺失值的观测值，找到最相似但具有这些值的观测值，并使用这些案例来进行填补。'
- en: 'For example, consider the following observation from the `sleep` data frame:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，考虑以下来自 `sleep` 数据框的观测值：
- en: '[PRE16]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This observation has a missing value on the gestation variable (`Gest`). To
    impute this missing value, you could
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 这个观测值在妊娠变量（`Gest`）上有缺失值。为了填补这个缺失值，你可以
- en: Find the *k* observations in the data frame that are nearest (most similar)
    to this case, based on the other nine variables.
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据其他九个变量，在数据框中找到最接近（最相似）的 *k* 个观测值。
- en: Aggregate the `Gest` values over these *k* observations. For example, take the
    mean of the *k* `Gest` values.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对这些 *k* 个观测值上的 `Gest` 值进行汇总。例如，取 *k* 个 `Gest` 值的平均值。
- en: Replace the missing value with this aggregated value.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用这个汇总值替换缺失值。
- en: The steps would be repeated for each observation containing missing values.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这些步骤将重复应用于每个包含缺失值的观测值。
- en: To use this approach, three questions must be answered. How should we define
    a nearest neighbor? How many nearest neighbors should we use? How should we aggregate
    the values?
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用这种方法，必须回答三个问题。我们应该如何定义最近邻？我们应该使用多少个最近邻？我们应该如何汇总值？
- en: 'The `kNN()` function in the `VIM` package performs k-nearest neighbor imputation.
    The defaults follow:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '`VIM` 包中的 `kNN()` 函数执行 k 近邻插补。默认设置如下：'
- en: Nearest neighbors are defined as those cases with the smallest Gower distance
    (Kowarik and Templ, 2016) to the target observation. Unlike the Euclidean distances
    described in chapter 16, the Gower distance can be computed for data that contains
    both quantitative and categorical variables. All available variables are used
    when defining a nearest neighbor.
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最近邻被定义为与目标观测值具有最小 Gower 距离（Kowarik 和 Templ，2016）的案例。与第 16 章中描述的欧几里得距离不同，Gower
    距离可以用于包含定量和分类变量的数据。定义最近邻时使用所有可用变量。
- en: For each observation with missing values, five nearest neighbors are identified.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于每个具有缺失值的观测值，确定五个最近邻。
- en: The aggregated value for a quantitative missing value is the median of the *k*
    nearest-neighbor values. For categorical missing values, the mode (most frequently
    occurring category) is used.
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定量缺失值的汇总值是 *k* 个最近邻值的中间值。对于分类缺失值，使用众数（最频繁出现的类别）。
- en: Each of these defaults can be modified by the user. See `help(kNN)` for details.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 每个这些默认值都可以由用户修改。有关详细信息，请参阅 `help(kNN)`。
- en: An application of `kNN` imputation for the `sleep` data frame is provided in
    the following listing.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 以下列出 `sleep` 数据框的 `kNN` 插补应用。
- en: Listing 18.2 K-nearest neighbor Imputation for the sleep data frame
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 18.2 睡眠数据框的 K 近邻插补
- en: '[PRE17]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: In the `sleep_imp` data frame, all missing values have been replaced with imputed
    values. By default, the `kNN()` function would add 10 new variables to the data
    frame (`BodyWgt_imp`, `BrainWgt_imp`, `...` , `Danger_imp`), coded `TRUE/FALSE`
    to indicate which values have been imputed. Setting `var_imp=FALSE` suppresses
    these additional variables.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `sleep_imp` 数据框中，所有缺失值都已用插补值替换。默认情况下，`kNN()` 函数会在数据框中添加 10 个新变量（`BodyWgt_imp`，`BrainWgt_imp`，...，`Danger_imp`），用
    `TRUE/FALSE` 编码来指示哪些值已被插补。设置 `var_imp=FALSE` 会抑制这些附加变量。
- en: '`kNN` imputation is an excellent option for small-to-moderately sized datasets
    (say, < 1000 observations). Since a distance is calculated between each observation
    with missing data and all other observations in the data frame, it does not scale
    well to larger problems. In that case, the approach described next can be very
    effective.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`kNN` 插补是小型到中等规模数据集（例如，< 1000 个观测值）的一个优秀选项。由于需要在数据框中的每个缺失数据观测值与其他所有观测值之间计算距离，因此它不适合较大的问题。在这种情况下，下面描述的方法可能非常有效。'
- en: 18.7.3 missForest
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 18.7.3 missForest
- en: 'For larger `data` `sets`, random forests (chapter 17) can be used to impute
    missing values. If you have p variables *X*[1], *X*[2], ..., *X[p]*) the steps
    would be as follows:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更大的 `数据集`，可以使用随机森林（第 17 章）来插补缺失值。如果你有 p 个变量 *X*[1]，*X*[2]，...，*X[p]*)，步骤如下：
- en: Replace missing values in each quantitative variable using mean substitution.
    Replace missing values for each categorical variable using the mode. Keep track
    of the location of missing values.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用均值替换每个定量变量的缺失值。使用众数替换每个分类变量的缺失值。跟踪缺失值的位置。
- en: Return the missing data for variable *X*[1]. Create a training dataset of cases
    that don’t have missing values on this variable. Using the training set, build
    a random forest model (chapter 17) to predict *X*[1]. Use the model to impute
    *X*[1] for the cases with missing *X*[1] values.
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回变量 *X*[1] 的缺失数据。创建一个没有此变量缺失值的案例训练数据集。使用训练集，构建随机森林模型（第 17 章）来预测 *X*[1]。使用该模型为具有缺失
    *X*[1] 值的案例插补 *X*[1]。
- en: Repeat step 2 for variables *X*[2] through *X[p]*.
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对变量 *X*[2] 通过 *X[p]* 重复步骤 2。
- en: Repeat steps 2 and 3 until imputed values do not change more than a specified
    amount.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复步骤 2 和 3，直到插补值的变化不超过指定的量。
- en: It’s actually easier to perform these operations than to describe them! The
    `missForest()` function in the `missForest` package can be used. Using the `sleep`
    data frame, the code is provided in the following listing.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上执行这些操作比描述它们要容易！`missForest` 包中的 `missForest()` 函数可以用来。使用 `sleep` 数据框，以下列出代码。
- en: Listing 18.3 Random forest imputation for the `sleep` data frame
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 18.3 睡眠数据框的随机森林插补
- en: '[PRE18]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: A random number seed is set so that the results are reproducible. In this case,
    it takes six iterations over the data frame before the imputed values stabilize.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 设置了一个随机数种子，以确保结果可重复。在这种情况下，在插补值稳定之前，需要对数据框进行六次迭代。
- en: Like the `kNN()` function, the `missForest()` function can work with data that
    is both quantitative and categorical. The random forest approach requires a moderate-to-large
    dataset (say, 500+ cases) to avoid issues of overfitting. For smaller datasets,
    the `kNN` approach tends to be more effective.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 与`kNN()`函数类似，`missForest()`函数可以处理定量和分类数据。随机森林方法需要中等或大型数据集（例如，500个以上案例）以避免过拟合的问题。对于较小的数据集，`kNN`方法往往更有效。
- en: If hypothesis testing is the focus of the analyses, it’s a good idea to use
    an imputation method that takes into account the uncertainty introduced by missing
    values. Multiple imputation is such an approach.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 如果假设检验是分析的重点，那么使用一种考虑缺失值引入的不确定性的插补方法是个好主意。多重插补就是这样一种方法。
- en: 18.8 Multiple imputation
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.8 多重插补
- en: '*Multiple* *imputation* (MI) provides an approach to missing values that’s
    based on repeated simulations. MI is frequently the method of choice for complex
    missing-values problems. In MI, a set of complete datasets (typically 3 to 10)
    is generated from an existing dataset that has missing values. Monte Carlo methods
    are used to fill in the missing data in each simulated dataset. Standard statistical
    methods are applied to each simulated dataset, and the outcomes are combined to
    provide estimated results and confidence intervals that take into account the
    uncertainty introduced by the missing values. Good implementations are available
    in R through the `Amelia`, `mice`, and `mi` packages.'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '*多重* *插补*（MI）提供了一种基于重复模拟的缺失值处理方法。MI通常是复杂缺失值问题的首选方法。在MI中，从具有缺失值的存在数据集中生成一组完整的数据集（通常是3到10个）。蒙特卡洛方法用于填充每个模拟数据集中的缺失数据。对每个模拟数据集应用标准统计方法，并将结果合并，以提供考虑缺失值引入的不确定性的估计结果和置信区间。R中有良好的实现，例如`Amelia`、`mice`和`mi`包。'
- en: In this section, we’ll focus on the approach provided by the `mice` (multivariate
    imputation by chained equations) package. To understand how the `mice` package
    operates, consider the diagram in figure 18.6.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将重点关注`mice`（通过链式方程的多变量插补）包提供的方法。为了理解`mice`包的工作原理，请考虑图18.6中的示意图。
- en: '![](Images/CH18_F06_Kabacoff3.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![图18.6 应用`mice`方法对缺失数据进行多重插补的步骤](Images/CH18_F06_Kabacoff3.png)'
- en: Figure 18.6 Steps in applying multiple imputation to missing data via the `mice`
    approach
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图18.6 应用`mice`方法对缺失数据进行多重插补的步骤
- en: The function `mice``()` starts with a data frame that’s missing data and returns
    an object containing several complete datasets (the default is five). Each complete
    dataset is created by imputing values for the missing data in the original data
    frame. There’s a random component to the imputations, so each complete dataset
    is slightly different. The `with()` function is then used to apply a statistical
    model (for example, a linear or generalized linear model) to each complete dataset
    in turn. Finally, the `pool()` function combines the results of these separate
    analyses into a single set of results. The standard errors and p-values in this
    final model correctly reflect the uncertainty produced by both the missing values
    and the multiple imputations.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '`mice()`函数从缺失数据的数据框开始，返回一个包含多个完整数据集的对象（默认为五个）。每个完整数据集是通过在原始数据框中插补缺失数据创建的。插补有一个随机成分，因此每个完整数据集略有不同。然后使用`with()`函数依次对每个完整数据集应用统计模型（例如，线性或广义线性模型）。最后，`pool()`函数将单独分析的结果合并为单个结果集。这个最终模型中的标准误差和p值正确地反映了缺失值和多重插补产生的不确定性。'
- en: How does the `mice()` function impute missing values?
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '`mice()`函数是如何插补缺失值的？'
- en: Missing values are imputed by *Gibbs sampling*. By default, each variable with
    missing values is predicted from all other variables in the dataset. These prediction
    equations are used to impute plausible values for the missing data. The process
    iterates until convergence over the missing values is achieved. For each variable,
    you can choose the form of the prediction model (called an *elementary imputation
    method*) and the variables entered into it.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 缺失值通过*Gibbs抽样*进行插补。默认情况下，每个有缺失值的变量都是根据数据集中所有其他变量进行预测的。这些预测方程用于插补缺失数据的可能值。该过程会迭代，直到在缺失值上达到收敛。对于每个变量，你可以选择预测模型的格式（称为*基本插补方法*）以及进入它的变量。
- en: By default, predictive mean matching is used to replace missing data on continuous
    variables, whereas logistic or polytomous logistic regression is used for target
    variables that are *dichotomous* (factors with two levels) or *polytomous* (factors
    with more than two levels), respectively. Other elementary imputation methods
    include Bayesian linear regression, discriminant function analysis, two-level
    normal imputation, and random sampling from observed values. You can supply your
    own methods as well.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，预测均值匹配用于替换连续变量的缺失数据，而对于目标变量是 *二元的*（具有两个水平的因子）或 *多分类的*（具有超过两个水平的因子），分别使用逻辑回归或多项逻辑回归。其他基本插补方法包括贝叶斯线性回归、判别函数分析、两级正态插补和从观测值中进行随机抽样。您也可以提供自己的方法。
- en: 'An analysis based on the `mice` package typically conforms to the following
    structure:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 基于 `mice` 包的分析通常符合以下结构：
- en: '[PRE19]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: where
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '`data` is a matrix or data frame containing missing values.'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`data` 是一个包含缺失值的矩阵或数据框。'
- en: '`imp` is a list object containing the *m* imputed datasets, along with information
    on how the imputations were accomplished. By default, *m* = 5.'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`imp` 是一个包含 *m* 个插补数据集的列表对象，以及有关如何进行插补的信息。默认情况下，*m* = 5。'
- en: '`analysis` is a formula object specifying the statistical analysis to be applied
    to each of the m imputed datasets. Examples include `lm()` for linear regression
    models, `glm()` for generalized linear models, and `gam()` for generalized additive
    models. Formulas within the parentheses give the response variables on the left
    of the `~` and the predictor variables (separated by `+` signs) on the right.'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`analysis` 是一个公式对象，指定要对每个 *m* 个插补数据集应用哪种统计分析。例如，`lm()` 用于线性回归模型，`glm()` 用于广义线性模型，`gam()`
    用于广义加性模型。括号内的公式给出了 `~` 左侧的响应变量和右侧的预测变量（由 `+` 符号分隔）。'
- en: '`fit` is a list object containing the results of the *m* separate statistical
    analyses.'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`fit` 是一个包含 *m* 个单独统计分析结果的列表对象。'
- en: '`pooled` is a list object containing the averaged results of these *m* statistical
    analyses.'
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`pooled` 是一个包含这些 *m* 个统计分析平均结果的列表对象。'
- en: 'Let’s apply multiple imputation to the `sleep` dataset. You’ll repeat the analysis
    from section 18.6, but this time use all 62 mammals. Set the seed value for the
    random number generator to 1,234 so that your results will match the following:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将多重插补应用于 `sleep` 数据集。您将重复第 18.6 节的分析，但这次使用所有 62 种哺乳动物。将随机数生成器的种子值设置为 1,234，以便您的结果将与以下结果匹配：
- en: '[PRE20]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Here, you see that the regression coefficient for `Span` isn’t significant (p
    ≅ 0.07), and the coefficient for `Gest` is significant at the p < 0.01 level.
    If you compare these results with those produced by a complete case analysis (section
    18.6), you see that you’d come to the same conclusions in this instance. Length
    of gestation has a (statistically) significant, negative relationship with amount
    of dream sleep, controlling for life span. Although the complete-case analysis
    was based on the 42 mammals with complete data, the current analysis is based
    on information gathered from the full set of 62 mammals.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到 `Span` 的回归系数并不显著（p ≅ 0.07），而 `Gest` 的系数在 p < 0.01 水平上是显著的。如果您将这些结果与第
    18.6 节中产生的完整案例分析结果进行比较，您会发现在这种情况下您会得出相同的结论。在控制生命周期的条件下，妊娠长度与梦境睡眠量之间存在（统计上）显著的负相关关系。尽管完整案例分析是基于具有完整数据的
    42 种哺乳动物，但当前分析是基于从完整的 62 种哺乳动物中收集的信息。
- en: You can view the imputations by looking at subcomponents of the `imp` object.
    For example,
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过查看 `imp` 对象的子组件来查看插补。例如，
- en: '[PRE21]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: displays the 5 imputed values for each of the 12 mammals with missing data on
    the `Dream` variable. A review of these matrices helps you determine whether the
    imputed values are reasonable. A negative value for length of sleep might give
    you pause (or nightmares).
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 显示了 12 种哺乳动物中 `Dream` 变量缺失数据的 5 个插补值。审查这些矩阵有助于您确定插补值是否合理。睡眠长度为负值可能会让您感到惊讶（或噩梦）。
- en: You can view each of the *m* imputed datasets via the `complete()` function.
    The format is
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过 `complete()` 函数查看每个 *m* 个插补数据集。格式是
- en: '[PRE22]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: where `#` specifies one of the *m* synthetically complete datasets. For example,
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 `#` 指定了 *m* 个合成的完整数据集之一。例如，
- en: '[PRE23]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: displays the third (out of five) complete dataset created by the multiple imputation
    process.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 显示了由多重插补过程创建的五个完整数据集中的第三个。
- en: 'Due to space limitations, we’ve only briefly considered the MI implementation
    provided in the `mice` package. The `mi` and `Amelia` packages also contain valuable
    approaches. If you’re interested in the multiple imputation approach to missing
    data, I recommend the following resources:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 由于篇幅限制，我们只简要考虑了`mice`包中提供的MI实现。`mi`和`Amelia`包也包含有价值的方法。如果你对缺失数据的多重插补方法感兴趣，我推荐以下资源：
- en: An online book titled *Applied Missing Data Analysis with SPSS and (R)Studio*
    by Martijn W. Heymans and Iris Eekhout ([https://bookdown.org/mwheymans/bookmi/](https://bookdown.org/mwheymans/bookmi/))
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由Martijn W. Heymans和Iris Eekhout编写的在线书籍《使用SPSS和(R)Studio的缺失数据应用分析》([https://bookdown.org/mwheymans/bookmi/](https://bookdown.org/mwheymans/bookmi/))
- en: Articles by van Buuren and Groothuis-Oudshoorn (2010) and Yu-Sung, Gelman, Hill,
    and Yajima (2010)
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: van Buuren和Groothuis-Oudshoorn（2010）以及Yu-Sung、Gelman、Hill和Yajima（2010）的文章
- en: '“Amelia II: A Program for Missing Data” ([http://gking.harvard.edu/amelia](http://gking.harvard.edu/amelia))'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '“Amelia II: 缺失数据程序” ([http://gking.harvard.edu/amelia](http://gking.harvard.edu/amelia))'
- en: Each can help reinforce and extend your understanding of this important, but
    underutilized, methodology.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 每个都可以帮助你加强和扩展对这个重要但未充分利用的方法论的理解。
- en: 18.9 Other approaches to missing data
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 18.9 缺失数据的其他方法
- en: R supports several other approaches for dealing with missing data. Although
    not as broadly applicable as the methods described thus far, the packages described
    in table 18.2 offer functions that can be useful in specialized circumstances.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: R支持处理缺失数据的其他几种方法。尽管这些方法不像前面描述的方法那样广泛适用，但表18.2中描述的包提供了在特定情况下可能有用的函数。
- en: Table 18.2 Specialized methods for dealing with missing data
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 表18.2 处理缺失数据的专用方法
- en: '| Package | Description |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| 包 | 描述 |'
- en: '| `norm` | Maximum-likelihood estimation for multivariate normal data with
    missing values |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| `norm` | 多变量正态数据缺失值的最大似然估计 |'
- en: '| `cat` | Analysis of categorical variable datasets with missing values |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| `cat` | 分析具有缺失值的分类变量数据集 |'
- en: '| `longitudinalData` | Utility functions, including interpolation routines
    for imputing missing time-series values |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| `longitudinalData` | 包括用于填充缺失时间序列值的插值例程等实用函数 |'
- en: '| `kmi` | Kaplan-Meier multiple imputation for survival analysis with missing
    data |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| `kmi` | Kaplan-Meier多重插补，用于带有缺失数据的生存分析 |'
- en: '| `mix` | Multiple imputation for mixed categorical and continuous data |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| `mix` | 混合分类和连续数据的多重插补 |'
- en: '| `pan` | Multiple imputation for multivariate panel or clustered data |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| `pan` | 多变量面板或聚类数据的多重插补 |'
- en: See the CRAN Task View on Missing Data ([https://cran.r-project.org/web/views/MissingData.html](https://cran.r-project.org/web/views/MissingData.html))
    for a review of all the approaches R provides.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅CRAN缺失数据任务视图([https://cran.r-project.org/web/views/MissingData.html](https://cran.r-project.org/web/views/MissingData.html))，以了解R提供的所有方法的综述。
- en: Summary
  id: totrans-218
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Statistical methods require complete datasets, but most real-world data contains
    missing values.
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 统计方法需要完整的数据集，但大多数现实世界的数据都包含缺失值。
- en: Function in the `VIM` and `mice` packages can be used to explore the distribution
    of missing values in a dataset.
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`VIM`和`mice`包中的函数可用于探索数据集中缺失值的分布。'
- en: Listwise deletion is the most popular method for dealing with missing values
    and is the default approach for many statistical routines. It can result in loss
    of power if significant amounts of data are deleted.
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列删除是处理缺失值最流行的方法，并且是许多统计程序的默认方法。如果删除大量数据，可能会导致功效损失。
- en: '`kNN` and `missForest` are excellent methods of imputing missing values. The
    former works well with small-to-medium-sized datasets, while the latter works
    well with large datasets.'
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`kNN`和`missForest`是填充缺失值的优秀方法。前者适用于中小型数据集，而后者适用于大型数据集。'
- en: Multiple imputation uses simulation to account for the uncertainty that missing
    values add to statistical inference problems.
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多重插补通过模拟来处理缺失值给统计推断问题带来的不确定性。
- en: Unless the amount of missing data is very small, simple imputation (e.g., mean
    substitution) and pairwise deletion should usually be avoided.
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 除非缺失数据量非常小，否则通常应避免简单的插补（例如，均值替换）和成对删除。
