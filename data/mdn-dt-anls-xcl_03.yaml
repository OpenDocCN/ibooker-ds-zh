- en: Chapter 2\. First Steps in Excel Power Query
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第二章。Excel Power Query 的初步步骤
- en: In [Chapter 1](ch01.html#ch_01), tables were introduced as the gateway to modern
    Excel analytics. The following chapters of [Part I](part01.html#part-1) delve
    deeper into the modern Excel toolkit, particularly Power Query. This tool addresses
    many of Excel’s traditional limitations and offers a user-friendly, low-code environment.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html#ch_01)中，表格被介绍为现代Excel分析的入口。[第I部分](part01.html#part-1)的后续章节深入探讨了现代Excel工具包，特别是Power
    Query。这个工具解决了Excel传统限制的许多问题，并提供了一个用户友好的低代码环境。
- en: What Is Power Query?
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是Power Query？
- en: Power Query is a data connection technology that enables users to easily connect
    to, combine, and refine data from a wide range of sources from within Excel. Initially
    introduced as an add-in, it has become a core feature of modern Excel, significantly
    simplifying the data import and cleaning process. Power Query offers a user-friendly
    interface for performing complex data manipulations, such as merging tables, transforming
    data formats, and aggregating information, without requiring advanced programming
    skills.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: Power Query 是一种数据连接技术，允许用户在Excel内轻松连接、合并和优化来自各种来源的数据。最初作为附加组件引入，它已成为现代Excel的核心功能，显著简化了数据导入和清洗过程。Power
    Query 提供了一个用户友好的界面，用于执行诸如合并表格、转换数据格式和聚合信息等复杂数据操作，而无需高级编程技能。
- en: Power Query as Excel Myth Buster
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Power Query 作为Excel的神话破解者
- en: Analysts act as myth busters, challenging assumptions and revealing truths.
    Even in the domain of Excel, a legendary business tool, myths can arise. However,
    many of these myths no longer hold true. Power Query has successfully debunked
    numerous claims, positioning itself as the ultimate myth buster for Excel. The
    next section will refute common claims about Excel using Power Query.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 分析师们扮演着神话破解者的角色，挑战假设，揭示真相。即使在Excel这样一个传奇的商业工具领域，也可能出现神话。然而，许多这些神话已经不再成立。Power
    Query 已成功驳斥了许多主张，将自己定位为Excel的终极神话破解者。接下来的部分将使用Power Query来反驳关于Excel的常见主张。
- en: “Excel Is Not Reproducible”
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: “Excel 不具备可重复性”
- en: 'It’s a common scenario: you find yourself under pressure, facing imminent deadlines
    and an intrusive manager, while attempting to revise a report from the previous
    week. The original creator of the report is unavailable, leaving you perplexed
    about how it was assembled. The workbook appears to be a jumbled mess of deleted
    columns and altered values, making it difficult to decipher the necessary actions
    to take.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个常见的场景：你发现自己面临压力，面对紧迫的截止日期和过度干预的经理，试图修改上周报告。报告的原始创建者不在，让你感到困惑，不知道它是如何组装的。工作簿似乎是一团删除的列和改变的值的混乱，使得难以理解所需采取的行动。
- en: Reproducibility in computation allows the user to consistently achieve the same
    results by using identical inputs and processes. A workbook falls short of this
    goal when error-prone steps, complex calculations, or other elements that introduce
    uncertainty render consistent outcomes unattainable each time the file is opened.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 计算中的可重复性允许用户通过相同的输入和过程始终获得相同的结果。当工作簿由于容易出错的步骤、复杂的计算或其他引入不确定性的因素而无法每次打开时都获得一致的结果时，它未能实现这一目标。
- en: The lack of reproducibility in traditional Excel has become a significant point
    of criticism for the software. This concern has led many technical professionals
    to be cautious about using Excel altogether, fearing that a single deleted column
    or a hard-coded cell could compromise the integrity of their results.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 传统Excel中缺乏可重复性已成为该软件的一个重要批评点。这一关注点导致许多技术专业人士对完全使用Excel持谨慎态度，担心单个删除的列或硬编码的单元格可能会损害结果的完整性。
- en: The decision to completely abandon Excel based on its past limitations is misguided.
    Excel now offers a solution for reproducibility through Power Query. With Power
    Query, users can create a duplicate of the source data, apply consistent transformation
    steps, and document each action in the Applied Steps list. This approach ensures
    reproducibility and eliminates the need to track data cleanup actions, addressing
    the concerns previously associated with Excel’s lack of reproducibility.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 完全基于其过去的限制而彻底放弃Excel的决定是错误的。现在Excel通过Power Query提供了可重复性的解决方案。使用Power Query，用户可以创建源数据的副本，应用一致的转换步骤，并在“已应用步骤”列表中记录每个操作。这种方法确保了可重复性，并消除了追踪数据清理操作的需要，解决了以前与Excel缺乏可重复性有关的问题。
- en: “Excel Does Not Have a True null”
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: “Excel 没有真正的 null”
- en: In relational databases, the concept of a missing or `null` value, representing
    unknown or unspecified data, is well known. However, Excel lacks a reserved keyword
    for `null` values, resulting in storage and handling challenges. Users may adopt
    different approaches for representing missing values in Excel, such as leaving
    them blank or hard-coding values like `NA`. This discrepancy makes it challenging
    to identify genuinely unknown values versus those that are actually equal to zero
    or intentionally left blank.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在关系型数据库中，表示未知或未指定数据的缺失或`null`值的概念是众所周知的。然而，Excel缺乏保留`null`值的关键字，导致存储和处理方面的挑战。用户可能会采用不同的方法来表示Excel中的缺失值，比如将它们留空或硬编码为`NA`。这种差异使得难以识别真正未知值与实际等于零或有意留空的值之间的区别。
- en: To overcome this limitation, Power Query introduces a dedicated `null` value
    to represent missing data. This enhancement facilitates precise profiling, removal,
    and replacement of missing values, ensuring accuracy and reproducibility.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 为了克服这一限制，Power Query引入了一个专门的`null`值来表示缺失数据。这种增强功能促进了精确的数据分析、移除和替换缺失值，确保准确性和可重现性。
- en: “Excel Can’t Process More Than 1,048,576 Rows”
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: “Excel不能处理超过1,048,576行”
- en: Another frequently used argument against Excel is its perceived limitation when
    dealing with “big data.” Detractors assert that with its worksheet maximum of
    approximately one million rows, Excel falls short in the era of massive datasets.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Excel在处理“大数据”时常被批评存在局限性。批评者声称，由于其工作表最多只能容纳约一百万行的数据，Excel在大数据时代表现不佳。
- en: The solution lies, once again, in Power Query, which can easily import and process
    millions of rows and more. While it is true that Excel itself cannot handle more
    than a million rows, Power Query empowers users to aggregate and summarize the
    data within its editor before loading the results into an Excel worksheet.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案再次在于Power Query，它可以轻松地导入和处理数百万行及更多数据。虽然Excel本身确实无法处理超过百万行的数据，但Power Query使用户能够在其编辑器中聚合和汇总数据，然后将结果加载到Excel工作表中。
- en: For a compelling demonstration of surpassing the alleged million-row limit in
    Excel, check out this post from analytics consultant Orlando Mézquita on [analyzing
    fifty million rows](https://oreil.ly/wve_4) using Excel Power Query.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解如何在Excel中超越所谓的百万行限制的引人注目演示，请查看分析顾问Orlando Mézquita在[分析五千万行](https://oreil.ly/wve_4)时使用Excel
    Power Query的这篇文章。
- en: Power Query as Excel’s ETL Tool
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Power Query作为Excel的ETL工具
- en: In the world of tech, many terms may seem impossibly complex at first glance.
    They may even be disguised by confusing acronyms. Upon closer examination, however,
    these concepts reveal their simplicity.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在技术世界中，许多术语乍看起来可能极为复杂。它们甚至可能被混乱的首字母缩写所掩盖。然而，仔细审视后，这些概念揭示出它们的简单性。
- en: One such term is *ETL*, which stands for “extract, transform, load.” Database
    administrators and data engineers often passionately discuss their “ETL pipelines”
    and “ETL software.” It may give the impression that only certified data geeks
    can handle these tasks.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 一个这样的术语是*ETL*，它代表“提取、转换、加载”。数据库管理员和数据工程师经常热烈地讨论他们的“ETL管道”和“ETL软件”。这可能会给人留下只有认证过的数据极客才能处理这些任务的印象。
- en: Power Query democratizes the ETL process by integrating it directly into an
    Excel spreadsheet. Don’t let tech purists intimidate you! The essence of ETL is
    inherent in its name and can be accomplished using Excel.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Power Query通过直接将其集成到Excel电子表格中，使ETL过程变得平民化。不要让技术纯粹主义者吓到你！ETL的本质已经融入其名称中，并且可以使用Excel完成。
- en: The following sections present a step-by-step overview of this process. To follow
    along, open *ch_02.xlsx* from the book’s resources in the *ch_02* folder.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 以下各节详细介绍了这个过程的逐步概述。要跟随进行，打开书中资源文件夹中的*ch_02*文件夹中的*ch_02.xlsx*。
- en: Extract
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 提取
- en: 'The initial step in ETL is to “extract” the data from an external source. Power
    Query has the ability to connect to a diverse range of data sources, extending
    beyond Excel workbooks. Here are some examples of the sources it can connect to:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: ETL的初始步骤是从外部源“提取”数据。Power Query具有连接到各种数据源的能力，超越了Excel工作簿的范围。以下是一些它可以连接到的数据源的示例：
- en: Text and CSV files
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文本和CSV文件
- en: Relational databases like Oracle, Microsoft SQL Server, or SQLite
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如Oracle、Microsoft SQL Server或SQLite等关系型数据库
- en: SharePoint
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SharePoint
- en: XML, HTML, and web data
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: XML、HTML和Web数据
- en: However, for this demonstration, the data is conveniently located within the
    Excel workbook itself.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 不过，对于这个演示，数据方便地位于Excel工作簿本身内。
- en: To begin, extract data from the `sales` table in the `sales` worksheet of *ch_02.xlsx*.
    Click anywhere inside the table, then go to Data → Get & Transform Data → From
    Table/Range, as shown in [Figure 2-1](#get-data-table-range).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始，从 *ch_02.xlsx* 的“sales”工作表中提取数据。在表内任何位置单击，然后转到“数据” → “获取和转换数据” → “从表/范围获取”，如[图 2-1](#get-data-table-range)所示。
- en: '![Extracting data from a table](assets/mdae_0201.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![从表中提取数据](assets/mdae_0201.png)'
- en: Figure 2-1\. Extracting data from a table
  id: totrans-32
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-1\. 从表中提取数据
- en: The requirement of having this data in a table for utilizing Power Query is
    in part why we dedicated [Chapter 1](ch01.html#ch_01) to discussing tables. Tables
    serve as an essential gateway to accessing modern Excel tools.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 将数据放入 Power Query 的表格中的要求部分是我们为什么在[第一章](ch01.html#ch_01)中专门讨论表格的原因。表格是访问现代 Excel
    工具的重要门户。
- en: While it may seem odd to “connect to and extract” data that already exists in
    your workbook, this approach is justified by Power Query’s ability to preserve
    the raw data in its original form. Even when the raw data is within the same workbook
    as the analysis, it is advisable to extract a subset of the data (the “E” in ETL)
    to proceed with any analysis.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管“连接并提取”已经存在于工作簿中的数据似乎有些奇怪，但这种方法是合理的，因为 Power Query 能够保留原始数据的原始形式。即使原始数据与分析在同一个工作簿中，建议也提取数据的子集（“E”中的“E”）以便进行进一步的分析。
- en: Transform
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 转换
- en: The next step is to connect to this data and perform the necessary transformations
    (the “T” in ETL).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是连接到这些数据并执行必要的转换（ETL中的“T”）。
- en: 'Data transformation encompasses various tasks necessary to render data usable,
    such as:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 数据转换包括多种任务，以使数据可用，例如：
- en: Sorting or filtering rows
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 排序或过滤行
- en: Adding, dropping, renaming, or calculating columns
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加、删除、重命名或计算列
- en: Merging or reshaping data sources
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 合并或重塑数据源
- en: When you load your table into Power Query, the Power Query Editor pops up, offering
    numerous options for data cleaning and transformation. It can be quite overwhelming,
    especially if you’re used to the classic Excel environment. However, we’ll tackle
    this program step by step throughout the rest of [Part I](part01.html#part-1).
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 当你将表加载到 Power Query 中时，Power Query 编辑器会弹出，提供多种数据清洗和转换选项。这可能会令人感到有些不知所措，特别是如果你习惯了经典的
    Excel 环境。然而，我们将在[第一部分](part01.html#part-1)中逐步介绍这个程序。
- en: You will learn how to perform several data cleaning tasks later in the book.
    For now, a straightforward data transformation can be achieved by adding an index
    column. To do this, go to Add Column on the Power Query ribbon, then Index Column
    → From 1, as shown in [Figure 2-2](#add-index-column).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 你将在本书的后面学习如何执行多个数据清洗任务。现在，通过添加索引列可以实现一个简单的数据转换。要做到这一点，转到 Power Query 标签上的“添加列”，然后选择“索引列”
    → “从 1”，如[图 2-2](#add-index-column)所示。
- en: '![Add index column](assets/mdae_0202.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![添加索引列](assets/mdae_0202.png)'
- en: Figure 2-2\. Adding an index column from Power Query
  id: totrans-44
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-2\. 从 Power Query 添加索引列
- en: Load
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 加载
- en: Finally, in the Power Query Editor, navigate to the Home tab and choose Close
    & Load. This action will load the slightly transformed data extract into another
    Excel table and on a new worksheet, as seen in [Figure 2-3](#pq-loaded-data).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，在 Power Query 编辑器中，导航到主页选项卡，选择“关闭并加载”。此操作将把略有变化的数据提取加载到另一个 Excel 表格中，并显示在一个新的工作表中，如[图 2-3](#pq-loaded-data)所示。
- en: '![Add index column](assets/mdae_0203.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![添加索引列](assets/mdae_0203.png)'
- en: Figure 2-3\. Loading data from Power Query to an Excel table
  id: totrans-48
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-3\. 从 Power Query 加载数据到 Excel 表格
- en: 'Congratulations on completing an entire ETL job:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 祝贺你完成了一个完整的 ETL 作业：
- en: You extracted the raw data from an Excel table.
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你从 Excel 表格中提取了原始数据。
- en: You transformed the data using the Power Query Editor.
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你使用 Power Query 编辑器转换了数据。
- en: You loaded the results back into Excel.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你把结果加载回了 Excel。
- en: A Tour of the Power Query Editor
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Power Query 编辑器之旅
- en: Now that you’ve walked through a very simple example of the entire Power Query
    ETL process, let’s take a closer look at the Power Query Editor. For this demonstration,
    open the `penguins` worksheet, also found in *ch_02.xlsx*.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你已经完成了一个非常简单的整个 Power Query ETL 过程的示例，让我们更详细地看看 Power Query 编辑器。为此演示，打开 *ch_02.xlsx*
    中的“penguins”工作表。
- en: To get started, load the `penguins` table into Power Query. If you need a refresher
    on how to do this, you can refer back to the previous section. The resulting Power
    Query Editor should look like [Figure 2-4](#power-query-penguins-editor).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始，将“penguins”表格加载到 Power Query 中。如果你需要关于如何操作的复习，请回顾前面的部分。生成的 Power Query 编辑器应该看起来像[图 2-4](#power-query-penguins-editor)。
- en: '![Power Query Editor](assets/mdae_0204.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 编辑器](assets/mdae_0204.png)'
- en: Figure 2-4\. The Power Query Editor
  id: totrans-57
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图2-4\. Power Query 编辑器
- en: Take a moment to delve deeper and appreciate the distinctive environment you’re
    in. It bears a resemblance to Excel with its ribbon interface, yet it operates
    as an independent, standalone program. The subsequent section will explore its
    various elements.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 请稍作停留，深入探索并欣赏你所处的独特环境。它与Excel的功能区界面相似，但作为一个独立的独立程序运行。接下来的部分将探讨其各种元素。
- en: The Ribbon Menu
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 功能区菜单
- en: At the top of the interface, you will notice a ribbon menu closely modeled after
    Excel’s familiar interface, as shown in [Figure 2-5](#power-query-ribbon).
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 在界面顶部，您会注意到一个功能区菜单，其设计紧随Excel熟悉的界面，如[图2-5](#power-query-ribbon)所示。
- en: '![Power Query ribbon](assets/mdae_0205.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 功能区](assets/mdae_0205.png)'
- en: Figure 2-5\. The Power Query ribbon
  id: totrans-62
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图2-5\. Power Query 功能区
- en: 'You should see four tabs on the ribbon: Home, Transform, Add Column, and View:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该在功能区看到四个选项卡：主页、转换、添加列和视图：
- en: Home
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 主页
- en: Just like with regular Excel, the Home tab consists of the most fundamental
    operations in Power Query, such as selecting rows, deleting columns, and more.
    However, the Home tab in Power Query focuses on essential data transformation
    and cleaning tasks, unlike regular Excel’s formatting features.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 就像普通的Excel一样，主页选项卡包含了Power Query中最基本的操作，如选择行、删除列等。然而，Power Query中的主页选项卡专注于基本的数据转换和清理任务，而不是普通Excel的格式设置功能。
- en: Transform
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 转换
- en: The Transform tab offers additional options for data cleaning and transformation.
    You’ll have the opportunity to try many of these features in the following chapters.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 转换选项卡提供了更多的数据清理和转换选项。您将在接下来的章节中有机会尝试许多这些功能。
- en: Add Column
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 添加列
- en: This tab is dedicated to creating new columns through a variety of methods.
    In [“Transform”](#transform), you used this tab to add an index column to the
    data. In [Chapter 4](ch04.html#ch_04), you’ll use it to create calculated columns.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 此选项卡专门用于通过各种方法创建新列。在[“转换”](#transform)中，您可以使用此选项卡向数据添加索引列。在[第四章](ch04.html#ch_04)中，您将使用它来创建计算列。
- en: View
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 视图
- en: The View tab customizes the display of the Power Query Editor. To begin, click
    on Formula Bar in the Layout group. This action will reveal a formula bar above
    your dataset, similar to Excel, as shown in [Figure 2-6](#power-query-formula-bar).
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 视图选项卡定制 Power Query 编辑器的显示。首先，在“布局”组中点击“公式栏”。此举将在数据集上方显示一个类似Excel的公式栏，如[图2-6](#power-query-formula-bar)所示。
- en: '![Power Query formula bar](assets/mdae_0206.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 公式栏](assets/mdae_0206.png)'
- en: Figure 2-6\. The Power Query formula bar
  id: totrans-73
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图2-6\. Power Query 公式栏
- en: The formula displayed in the Power Query formula bar may appear different from
    typical Excel functions because it is written in the M programming language, which
    is specifically designed for Power Query. As you adjust your query through the
    Power Query Editor’s point-and-click interface, the underlying M code is altered
    accordingly. This allows for debugging, customization, or sharing of results.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: Power Query 公式栏中显示的公式可能与典型的Excel函数不同，因为它是用专为Power Query设计的M编程语言编写的。通过Power Query编辑器的点选接口调整查询时，底层的M代码相应地改变。这允许进行调试、定制或共享结果。
- en: Although the presence of the formula bar might imply that mastering a complex
    programming language is crucial for leveraging Power Query’s capabilities, this
    is not necessarily true. The majority of everyday tasks can be efficiently completed
    using the Home tab and other features, bypassing the need for M coding. This book
    focuses exclusively on these point-and-click options, making the formula bar redundant
    for our purposes.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管公式栏的存在可能暗示掌握复杂的编程语言对于利用Power Query的能力至关重要，但这并不一定是真的。大多数日常任务可以通过主页选项卡和其他功能有效完成，无需编写M代码。本书专注于这些点选选项，使公式栏对我们的目的来说变得多余。
- en: Note
  id: totrans-76
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: This book won’t use the formula bar in the Power Query Editor for future demonstrations.
    You can hide it by unchecking Formula Bar in the Layout group on the View tab.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将不会使用Power Query编辑器中的公式栏进行未来的演示。您可以通过取消“视图”选项卡中“布局”组中的“公式栏”来隐藏它。
- en: To explore writing your own M code in Power Query, start by checking out the
    Advanced Editor. Access it by going to the View tab in the Power Query Editor
    and clicking on Advanced Editor in the Advanced group. This window displays your
    entire query in a single, comprehensive view.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始在 Power Query 中编写自己的 M 代码，请首先查看高级编辑器。在 Power Query 编辑器的“查看”选项卡中，单击“高级编辑器”在“高级”组中打开此窗口。这个窗口会以单一的全面视图显示你的整个查询。
- en: Queries
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 将注意力从功能区转移到编辑器左上角的查询列表上。在这里，你会找到导入的数据源，可以在之间切换查看。虽然这些数据源都存在于工作簿中，但请记住 Power
    Query 支持各种数据源，包括 *.csv* 文件、数据库、网页等。
- en: Shift your attention from the ribbon to the list of queries on the upper left
    of the Editor. Here, you’ll find the imported data sources, which you can toggle
    between to view. While both sources reside within this workbook, keep in mind
    that Power Query supports a wide range of data sources, including *.csv* files,
    databases, web pages, and more.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '![Power Query 中的查询列表](assets/mdae_0207.png)'
- en: To perform actions on a specific query, right-click on its name, such as `penguins`,
    and a menu with various options will appear, as shown in [Figure 2-7](#queries-list).
    These options include renaming the query, deleting it, and more.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 要在特定查询上执行操作，请右键单击其名称，如`penguins`，将会显示一个包含各种选项的菜单，如 [图 2-7](#queries-list) 所示。这些选项包括重命名查询、删除查询等。
- en: '![List of queries in Power Query](assets/mdae_0207.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: 导入的数据
- en: Figure 2-7\. List of queries in Power Query
  id: totrans-83
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-7\. Power Query 中的查询列表
- en: Power Query offers a plethora of right-click options, so don’t hesitate to explore
    and try them out.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Power Query 提供了大量的右键选项，因此不要犹豫去探索和尝试它们。
- en: The Imported Data
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 现在，将注意力转移到占据编辑器大部分空间的组件：数据本身。与在 Excel 中可以自由操作数据不同，例如隐藏列或插入公式，Power Query 强制实施编辑限制。
- en: 'Now, shift your focus to the component occupying most of the Editor’s space:
    the data itself. Unlike in Excel, where you have the freedom to manipulate the
    data by, for example, hiding columns or inserting formulas, Power Query imposes
    editing restrictions.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2-9\. Power Query 中的应用步骤列表
- en: To paraphrase lyrics of a song by The Police, Power Query diligently observes
    and tracks every step and movement you make with your query. Randomly hard-coding
    formulas or hiding columns at will is not allowed. All actions must be executed
    programmatically within Power Query’s framework.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 要用警察乐队一首歌的歌词来表述，Power Query 努力观察和跟踪你对查询的每一步和动作。随意硬编码公式或随意隐藏列是不允许的。所有操作必须在 Power
    Query 的框架内以程序方式执行。
- en: Consider the straightforward task of deleting a column. To remove `island` from
    the `penguins` dataset, simply right-click on the column label and choose “Remove,”
    as shown in [Figure 2-8](#power-query-deleted-column).
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2-8\. Power Query 中删除列的操作
- en: '![Deleting a column](assets/mdae_0208.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![删除列](assets/mdae_0208.png)'
- en: Figure 2-8\. Deleting a column in Power Query
  id: totrans-90
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 查询
- en: The column has been permanently removed from the dataset…​or has it? To understand
    how data changes work in Power Query, take a look at the Applied Steps list to
    the right of the data, as shown in [Figure 2-9](#power-query-applied-steps).
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2-9\. Power Query 中删除列的应用步骤
- en: '![Applied Steps menu](assets/mdae_0209.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: 考虑一个简单的任务，删除一个列。要从`penguins`数据集中移除`island`，只需右键单击列标签，选择“删除”，如 [图 2-8](#power-query-deleted-column)
    所示。
- en: Figure 2-9\. The Applied Steps list in Power Query
  id: totrans-93
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: '![应用步骤菜单](assets/mdae_0209.png)'
- en: Power Query meticulously records every action, including deletions, in the Applied
    Steps list, displayed alongside your data. This ensures transparency and traceability
    of all operations.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: Power Query 详细记录每一个动作，包括删除，在显示的“应用步骤”列表中与你的数据一起显示。这确保了所有操作的透明性和可追溯性。
- en: To be more precise, this deletion is documented as the third step labeled Removed
    Columns in the Applied Steps section. The initial step is connecting to the data,
    referred to as the Source. The second step, Changed Type, involves setting data
    types for the table. Unlike Excel, Power Query requires every value within a column
    to be of the same type. This book will largely rely on Power Query’s automatic
    data type casting. You can learn more about Power Query data types in [Microsoft’s
    official documentation](https://oreil.ly/Yz5s1).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 更加精确地说，这个删除操作在“已应用步骤”部分标记为第三步“Removed Columns”。初始步骤是连接到数据，称为源数据。第二步“Changed
    Type”涉及为表格设置数据类型。与 Excel 不同，Power Query 要求列中的每个值都必须是相同类型的。本书将主要依赖 Power Query
    的自动数据类型转换。您可以在[Microsoft 的官方文档](https://oreil.ly/Yz5s1)中了解更多关于 Power Query 数据类型的信息。
- en: By clicking on any of the steps in the Applied Steps list, you can revisit the
    data as it appeared at that specific point in time. For instance, if you click
    on Changed Type (the step prior to the column removal), the `island` column will
    reappear in your Editor view.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 通过单击“已应用步骤”列表中的任何步骤，您可以重新查看数据在特定时间点的表现。例如，如果单击“Changed Type”（在删除列之前的步骤），则`island`列将重新出现在您的编辑器视图中。
- en: To reinforce your learning from earlier in this chapter, add an index column
    starting at 1 to the dataset with the Changed Type step still highlighted. You
    will receive a message to confirm that you wish to insert an intermediate step
    into the query, as in [Figure 2-10](#power-query-insert-step).
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 为了强化本章前面学习的内容，在仍然突出显示“Changed Type”步骤的数据集中添加一个从 1 开始的索引列。您将收到一条消息，确认您希望在查询中插入一个中间步骤，如[图
    2-10](#power-query-insert-step)所示。
- en: '![Insert Step warning](assets/mdae_0210.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![插入步骤警告](assets/mdae_0210.png)'
- en: Figure 2-10\. Inserting an intermediate step into Power Query
  id: totrans-99
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-10\. 在 Power Query 中插入一个中间步骤
- en: After clicking Insert, you will notice that Added Index is positioned before
    Removed Columns in the Applied Steps list, even though it was added at a later
    point in time. This allows for effortless modifications to the query as requirements
    evolve or new steps are added to the workflow.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“插入”后，您会注意到“Added Index”被放置在“已应用步骤”列表中“Removed Columns”之前，尽管它是在后来的时间点添加的。这允许根据需求的演变或工作流程中添加新步骤轻松修改查询。
- en: 'You can perform various actions on these steps, such as deleting or renaming
    them. Suppose you wish to reintroduce the `island` column that was previously
    deleted in the query. You have two options: either click the X icon located to
    the left of the Removed Columns query step, or right-click on that same step to
    access a menu that lets you delete, rename, and reorder steps, among other tasks.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以对这些步骤执行各种操作，例如删除或重命名它们。假设您希望在查询中重新引入之前删除的`island`列。您有两个选择：要么单击“删除列”查询步骤左侧的
    X 图标，要么右键单击同一步骤以访问一个菜单，该菜单允许您删除、重命名和重新排序步骤，以及其他任务。
- en: Warning
  id: totrans-102
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: 'Although the Applied Steps list offers flexibility, it lacks a cherished feature
    of classic Excel: the ability to undo actions. Once a step is deleted, there is
    no built-in option to undo the deletion. Because most of these steps can be easily
    replicated, it is often just as convenient to manually repeat the process instead
    of relying on an undo button.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管“已应用步骤”列表提供了灵活性，但它缺少 Excel 经典功能中珍贵的一个特性：撤销操作的能力。一旦删除了一个步骤，就没有内置的选项来撤销删除。因为大多数这些步骤可以轻松复制，通常手动重复过程与依赖撤销按钮一样方便。
- en: Exiting the Power Query Editor
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 退出 Power Query 编辑器
- en: After creating the desired query in the editor, it’s time to exit Power Query
    and return to the regular Excel workbook. Earlier in this chapter, you saw that
    clicking directly on Close & Load on the Home tab of the Power Query Editor loads
    the result of the query to an Excel table.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在编辑器中创建所需的查询后，现在是时候退出 Power Query 并返回常规的 Excel 工作簿了。本章前面提到，单击 Power Query 编辑器主页选项卡上的“关闭并加载”会将查询结果加载到
    Excel 表中。
- en: There are other load options, which you can view by clicking the drop-down button
    next to Close & Load, then selecting Close & Load To. You should now see the dialog
    in [Figure 2-11](#power-query-load-options).
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他加载选项，您可以通过单击“关闭并加载”旁边的下拉按钮，然后选择“关闭并加载到”。现在您应该能够在[图 2-11](#power-query-load-options)中看到对话框。
- en: '![Load options in Power Query](assets/mdae_0211.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 中的加载选项](assets/mdae_0211.png)'
- en: Figure 2-11\. Power Query loading options
  id: totrans-108
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-11\. Power Query 加载选项
- en: Your first decision is whether to load the data into a table, a PivotTable (referred
    to here as a PivotTable Report), a PivotChart, or to choose the connection-only
    option. When loading to connection only, the results of your query will not be
    loaded into Excel, but the query itself will remain accessible in the Power Query
    Editor.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 您的第一个决定是将数据加载到表、透视表（这里称为透视表报表）、透视图或选择仅连接选项。当仅加载到连接时，您的查询结果将不会加载到 Excel 中，但查询本身将保持在
    Power Query 编辑器中可访问。
- en: If you choose to load the data into your workbook, you can either place it in
    a new worksheet or an existing one.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 如果选择将数据加载到工作簿中，您可以将其放置在新工作表或现有工作表中。
- en: Additionally, you have the option to add the data to the Data Model. This enables
    you to construct a relational data model and leverage advanced reporting capabilities
    in your workbook. In [Part II](part02.html#part-2) of this book, you’ll be introduced
    to data models, Power Pivot, and DAX.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您还可以选择将数据添加到数据模型中。这使您能够构建关系数据模型，并在工作簿中利用高级报表功能。在本书的 [第二部分](part02.html#part-2)
    中，您将介绍数据模型、Power Pivot 和 DAX。
- en: Choose whichever option you’d like for this practice exercise, then click OK.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 选择练习的任何选项，然后单击确定。
- en: Returning to the Power Query Editor
  id: totrans-113
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 返回到 Power Query 编辑器
- en: To resume transforming your data in Power Query or to change the way you loaded
    your query, head to the Data tab on the Excel ribbon, then select Queries & Connections.
    Look for your `penguins` query in the pane that appears on the right side of the
    window.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 若要在 Power Query 中恢复转换数据或更改加载查询的方式，请转到 Excel 选项卡上的数据选项卡，然后选择查询和连接。在窗口右侧出现的窗格中查找您的`penguins`查询。
- en: You’ll see that Power Query is reporting two errors in this file; these will
    be identified and dealt with soon.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到 Power Query 报告此文件中的两个错误；这些将很快被识别并处理。
- en: Right-click on `penguins` and you’ll see several options for working with this
    query. To change how your query is loaded to Power Query, choose Load To. To go
    back to the Power Query Editor, choose Edit, as shown in [Figure 2-12](#power-query-queries-connection).
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 右键单击`penguins`，您将看到几个用于处理此查询的选项。要更改查询加载到 Power Query 的方式，请选择加载到。要返回到 Power Query
    编辑器，请选择编辑，如图 [2-12](#power-query-queries-connection) 所示。
- en: '![Queries and Connections menu](assets/mdae_0212.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![查询和连接菜单](assets/mdae_0212.png)'
- en: Figure 2-12\. Queries & Connections options
  id: totrans-118
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-12\. 查询和连接选项
- en: Data Profiling in Power Query
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Power Query 中的数据概要分析
- en: So far, we’ve highlighted Power Query as a robust ETL tool designed to streamline
    the data cleaning process. Yet, embarking on the task of cleaning a dataset without
    a clear understanding of what exactly makes it dirty is an impractical approach.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经强调了 Power Query 作为一个强大的 ETL 工具，旨在简化数据清理过程。然而，在不清楚数据“脏”的确切原因的情况下，着手清理数据集是一种不切实际的方法。
- en: To mitigate this challenge, Power Query is equipped with an array of data profiling
    techniques. This segment will explore the integral role of data profiling within
    Power Query, underscoring its importance in the optimization of data quality.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 为了缓解这一挑战，Power Query 配备了一系列数据概要分析技术。本节将探讨数据概要分析在 Power Query 中的重要作用，强调其在优化数据质量中的重要性。
- en: What Is Data Profiling?
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 什么是数据概要分析？
- en: 'Data profiling offers insights into data characteristics, such as missing values,
    value frequencies, and summary statistics. This knowledge supports informed decision
    making and efficient data transformations. During the profiling process, consider
    the following questions:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 数据概要提供有关数据特征的见解，例如缺失值、值频率和摘要统计信息。这些知识支持明智的决策和高效的数据转换。在概要分析过程中，请考虑以下问题：
- en: How accurate is the data?
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据有多精确？
- en: Are there evident issues?
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否存在明显的问题？
- en: Are the purpose and measurement of every variable and observation clear?
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个变量和观察的目的和测量是否清晰？
- en: Is all the necessary data available? Are there gaps?
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有必要的数据是否都可用？是否存在空白？
- en: In Excel-based data, are there formula errors affecting results?
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在基于 Excel 的数据中，是否存在影响结果的公式错误？
- en: Has the data been transcribed accurately?
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据是否已准确转录？
- en: Answering these questions allows analysts to gauge the data’s health and reliability,
    pinpoint potential problems, and decide on data cleaning, transformation, and
    analysis strategies.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 回答这些问题允许分析师评估数据的健康状况和可靠性，找出潜在问题，并决定数据清理、转换和分析策略。
- en: Exploring the Data Preview Options
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 探索数据预览选项
- en: Data profiling is somewhat tucked away in the Power Query Editor. To access
    it, navigate to the View tab on the ribbon and locate the Data Preview group,
    as shown in [Figure 2-13](#power-query-data-preview). You can explore the functionality
    of each of the five options by toggling them on one by one.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 数据概要分析有点隐藏在Power Query Editor中。要访问它，请导航到功能区中的“视图”选项卡，并找到“数据预览”组，如[图 2-13](#power-query-data-preview)所示。您可以逐个切换这五个选项来探索它们的功能。
- en: '![Data Preview in Power Query](assets/mdae_0213.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query中的数据预览](assets/mdae_0213.png)'
- en: Figure 2-13\. Data Preview options in Power Query
  id: totrans-134
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-13\. Power Query中的数据预览选项
- en: “Monospaced” and “Show whitespace”
  id: totrans-135
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: “等宽字体”和“显示空白”
- en: 'The first two options modify the data’s appearance within the Power Query Editor:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 前两个选项修改了数据在Power Query Editor中的外观：
- en: “Monospaced” will render the data as fixed-width text.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “等宽字体”将数据呈现为固定宽度文本。
- en: “Show whitespace” will reveal any leading or trailing spaces in the data
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “显示空白”将显示数据中的任何前导或尾随空格
- en: While these options are useful, particularly for identifying text that requires
    trimming, the true data profiling potential lies with subsequent options.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些选项很有用，特别是用于识别需要修剪的文本，但真正的数据概要分析潜力则在后续选项中。
- en: The “Column quality” and “Column distribution”
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: “列质量”和“列分布”
- en: Next, select the following two options. A box will display above each column,
    presenting valuable insights into the data, such as the percentage of valid, error,
    and empty values. It also presents a visualization of the distribution of values
    in the column. These options provide a comprehensive overview of the data’s quality
    and distribution, aiding in effective analysis and decision making.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，选择以下两个选项。每个列上方将显示一个框，提供有关数据的宝贵洞见，如有效值、错误值和空值的百分比。它还呈现了列中值的分布可视化。这些选项为数据的质量和分布提供了全面的概述，有助于有效的分析和决策。
- en: What is a valid cell?
  id: totrans-142
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 有效单元格是什么？
- en: When Excel refers to “valid” data, it simply means that the value is not empty
    and does not contain any errors. It’s important to note that this definition of
    “valid” does not take into account the logical correctness or meaningfulness of
    the data. As a result, Power Query may consider nonsensical data to be “valid.”
    For example, take row `71` of the `sex` column, as seen in [Figure 2-14](#power-query-valid-cell).
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 当Excel提到“有效”数据时，它仅意味着该值不为空且不包含任何错误。重要的是要注意，“有效”数据的这一定义不考虑数据的逻辑正确性或含义。因此，Power
    Query可能会认为荒谬的数据是“有效”的。例如，看一下第`71`行的`sex`列，如[图 2-14](#power-query-valid-cell)所示。
- en: '![Power Query valid cell](assets/mdae_0214.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query中的有效单元格](assets/mdae_0214.png)'
- en: Figure 2-14\. What is a valid cell in Power Query?
  id: totrans-145
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-14\. Power Query中的有效单元格是什么？
- en: Missing values
  id: totrans-146
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 缺失值
- en: Clearly, the entry of `99` is not a valid value for the `sex` column. It seems
    to be the result of a transcription error, where these cells were mistakenly filled
    with `99` instead of being left missing or `null`. To observe a genuine missing
    value in Power Query, head to row 296, as shown in [Figure 2-15](#power-query-null).
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 很明显，`99`不是`sex`列的有效值。这似乎是一个转录错误的结果，这些单元格错误地填充为`99`而不是缺失或`null`。要观察Power Query中真正的缺失值，请转到第296行，如[图 2-15](#power-query-null)所示。
- en: '![Power Query nulls](assets/mdae_0215.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query中的空值](assets/mdae_0215.png)'
- en: Figure 2-15\. Checking for nulls in Power Query
  id: totrans-149
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-15\. 在Power Query中检查空值
- en: Here you will notice several entries marked as `null`, which is the correct
    way to indicate an empty value in Power Query. Currently, the Column quality display
    shows fewer than 1% of cells categorized as “Empty” for each of these columns.
    Keep in mind, however, that these figures do not include incorrectly transcribed
    missing values.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您会注意到几个标记为`null`的条目，这是在Power Query中表示空值的正确方式。目前，“列质量显示”显示了每个这些列中少于1%的单元格被分类为“空白”。但是，请记住，这些数据不包括错误转录的缺失值。
- en: Cell errors
  id: totrans-151
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 单元格错误
- en: To gain an understanding of the Error category, remain on row 296 and focus
    on the `bl_bd_ratio` column. This particular column was calculated in Excel by
    dividing the values in the `bill_length_mm` column by those in the `bill_depth_mm`
    column. However, in this specific row, the denominator of the formula was left
    empty, resulting in an error. By clicking on the whitespace next to Error, you
    can verify that it results from a `#DIV/0` error, as shown in [Figure 2-16](#data-profiling-cell-errors).
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 要理解错误类别，请停留在第 296 行，并关注`bl_bd_ratio`列。此特定列在 Excel 中是通过将`bill_length_mm`列的值除以`bill_depth_mm`列的值计算得出的。然而，在这一特定行中，公式的分母为空，导致错误。通过单击“错误”旁边的空白处，可以验证其来源是`#DIV/0`错误，如
    [图 2-16](#data-profiling-cell-errors) 所示。
- en: '![Power Query nulls](assets/mdae_0216.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 空值](assets/mdae_0216.png)'
- en: Figure 2-16\. Cell errors in Power Query data profiling
  id: totrans-154
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-16\. Power Query 数据分析中的单元格错误
- en: There are two of these calculation errors found in this column, resulting in
    the error message seen in [Figure 2-16](#data-profiling-cell-errors). This error
    could be resolved in a number of ways, including writing a base Excel formula
    that accounts for division by zero errors, or perhaps by filtering out the rows
    that are resulting in errors. You will learn how to filter rows and perform other
    operations on rows in [Chapter 3](ch03.html#ch_03).
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 此列中发现了两个这类计算错误，导致在 [图 2-16](#data-profiling-cell-errors) 中看到的错误消息。可以通过多种方式解决此错误，包括编写一个基础的
    Excel 公式来处理除以零的错误，或者通过过滤掉导致错误的行来解决。在 [第 3 章](ch03.html#ch_03) 中，您将学习如何过滤行并执行其他行操作。
- en: The “Column distribution” option displays a visualization of the data distribution,
    along with some other information, as seen in [Figure 2-17](#column-distribution).
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: “列分布”选项显示数据分布的可视化，以及其他一些信息，如 [图 2-17](#column-distribution) 所示。
- en: '![Power Query Column Distribution](assets/mdae_0217.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 列分布](assets/mdae_0217.png)'
- en: Figure 2-17\. Column distribution in Power Query
  id: totrans-158
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-17\. Power Query 中的列分布
- en: However, these features are all available in the “Column profile” option, so
    we’ll focus there next.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这些功能都可以在“列轮廓”选项中找到，因此我们将在下一步重点关注这里。
- en: Column profile
  id: totrans-160
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 列轮廓
- en: Finally, select the “Column profile” check box, choose a specific column, and
    navigate to the “Column profile” output beneath the dataset for detailed insights.
    For instance, consider the `species` column, a qualitative variable. This selection
    will provide a detailed breakdown of the values within the column, including a
    visualization that depicts the frequency of observations for each value, as seen
    in [Figure 2-18](#qualitative-data-profile).
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，选择“列轮廓”复选框，选择特定列，并在数据集下方导航到“列轮廓”输出，以获取详细洞察。例如，考虑`species`列，这是一个定性变量。此选择将提供该列内值的详细分解，包括显示每个值观察频率的可视化，如
    [图 2-18](#qualitative-data-profile) 所示。
- en: '![Power Query Column Distribution](assets/mdae_0218.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 列分布](assets/mdae_0218.png)'
- en: Figure 2-18\. Profiling a qualitative variable
  id: totrans-163
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-18\. 分析定性变量
- en: For quantitative variables like `bill_depth_mm`, “Column profile” output will
    display additional measures such as the mean and standard deviation, as seen in
    [Figure 2-19](#quantitative-data-profile).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 对于像`bill_depth_mm`这样的定量变量，“列轮廓”输出将显示诸如平均值和标准偏差之类的其他度量，如 [图 2-19](#quantitative-data-profile)
    所示。
- en: Note
  id: totrans-165
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: 'If you’re unfamiliar with qualitative and quantitative variables, think of
    *qualitative variables* as asking “What kind?” and *quantitative variables* as
    asking “How much?” or “How many?” For a deeper exploration of these variable types,
    refer to my book [*Advancing into Analytics: From Excel to Python and R*](https://www.oreilly.com/library/view/advancing-into-analytics/9781492094333).
    In [Part II](part02.html#part-2) of this book, you’ll learn about dimensions and
    measures, which are similar concepts to qualitative and quantitative variables.'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您对定性和定量变量不熟悉，可以将*定性变量*理解为“是什么类型？”而将*定量变量*理解为“多少？”或“多少个？”有关这些变量类型的深入探讨，请参阅我的书籍
    [*进阶分析：从 Excel 到 Python 和 R*](https://www.oreilly.com/library/view/advancing-into-analytics/9781492094333)。在本书的
    [第 II 部分](part02.html#part-2) 中，您将学习维度和度量，这些概念类似于定性和定量变量。
- en: '![Power Query Column Profiling](assets/mdae_0219.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query 列轮廓](assets/mdae_0219.png)'
- en: Figure 2-19\. Column profiling in Power Query
  id: totrans-168
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-19\. Power Query 中的列轮廓
- en: Overriding the Thousand-Row Limit
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 超过千行限制
- en: If you are working with a dataset of greater than one thousand rows, make sure
    to include all observations in Power Query’s data profiling. To do this, click
    toward the bottom of the editor and select “Column profiling based on entire data
    set,” as seen in [Figure 2-20](#thousand-row-limit).
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你处理的数据集超过一千行，请确保在 Power Query 的数据分析中包含所有观察结果。要做到这一点，请点击编辑器底部并选择“基于整个数据集的列分析”，如图
    [Figure 2-20](#thousand-row-limit) 所示。
- en: '![Power Query Column Limit](assets/mdae_0220.png)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![Power Query Column Limit](assets/mdae_0220.png)'
- en: Figure 2-20\. Overriding the thousand-row limit for data profiling
  id: totrans-172
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 2-20\. 覆盖数据分析的千行限制
- en: 'With Power Query’s data profiling capabilities you were able to:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 借助 Power Query 的数据分析功能，您能够：
- en: Quickly spot incorrectly formatted cells
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 快速发现格式错误的单元格。
- en: Determine which columns contain missing values
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定哪些列包含缺失值。
- en: Visualize the distribution of each variable
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可视化每个变量的分布
- en: Closing Out of Data Profiling
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 结束数据分析
- en: When you are finished profiling your data in Power Query, you can simply click
    Close & Load to return to Excel without making any changes to your query. Remember,
    data profiling is about checking the data *first* before making any changes to
    it. For the rest of the book, to cut down on clutter, we will keep the Data Preview
    options turned off.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 当您在 Power Query 中完成数据分析后，只需点击“关闭并加载”即可返回到 Excel，而不对查询进行任何更改。请记住，在对数据进行任何更改之前，数据分析是检查数据*首要步骤*。为了减少混乱，本书的其余部分将保持数据预览选项关闭状态。
- en: Conclusion
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: This chapter debunked common myths associated with Excel by using Power Query
    as an ETL tool. It also explored both the Power Query Editor and the data profiling
    process. You are now ready to transform data using Power Query, which will be
    the focus of the remainder of [Part I](part01.html#part-1).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 本章通过使用 Power Query 作为 ETL 工具来揭开与 Excel 相关的常见神话。它还探索了 Power Query 编辑器和数据分析过程。现在，您已经准备好使用
    Power Query 转换数据，这将是[第一部分](part01.html#part-1)剩余部分的重点。
- en: Exercises
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习
- en: 'For this chapter’s exercises, explore a dataset of computer prices with Power
    Query. Open *ch_02_exercises.xlsx* in the *exercises\ch_02_exercises* folder in
    the book’s [companion repository](https://oreil.ly/modern-analytics-excel-exercises).
    Perform the following:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 对于本章的练习，使用 Power Query 探索一个包含计算机价格的数据集。在书的[附属库](https://oreil.ly/modern-analytics-excel-exercises)中的*exercises\ch_02_exercises*文件夹中打开*ch_02_exercises.xlsx*。执行以下操作：
- en: Load the data into Power Query as a table. Name the query `computers`.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将数据作为表格加载到 Power Query 中。将查询命名为`computers`。
- en: Add an index column starting from 1 to the data.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向数据添加从 1 开始的索引列。
- en: Rename the previous step in the Applied Steps list as “Added unique identifier.”
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将应用步骤列表中的上一步重命名为“添加唯一标识符”。
- en: Drag and drop the `Index` column so that it is the first column in the dataset.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 拖放`Index`列，使其成为数据集中的第一列。
- en: Use Power Query’s data profiling features to address the following questions.
    Be sure to adjust column profiling to work on the entire dataset.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Power Query 的数据分析功能回答以下问题。务必调整列分析以处理整个数据集。
- en: What is the range of prices for the computers in the dataset?
  id: totrans-188
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据集中计算机价格的范围是多少？
- en: What is the average amount of RAM in the dataset?
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据集中的平均 RAM 量是多少？
- en: Are there any missing values in this dataset? If so, where?
  id: totrans-190
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据集中是否存在缺失值？如果有，位于何处？
- en: Load the query results into an Excel PivotTable.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将查询结果加载到 Excel 透视表中。
- en: The solutions are available in *ch_02_exercise_solutions.xlsx* in the same folder.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 解决方案位于同一文件夹中的*ch_02_exercise_solutions.xlsx*中。
