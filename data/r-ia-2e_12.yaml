- en: 9 Analysis of variance
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 9 方差分析
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了
- en: Using R to model basic experimental designs
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 R 模拟基本实验设计
- en: Fitting and interpreting ANOVA type models
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拟合和解释 ANOVA 类型模型
- en: Evaluating model assumptions
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估模型假设
- en: In chapter 8, we looked at regression models for predicting a quantitative response
    variable from quantitative predictor variables, but there’s no reason why we couldn’t
    have included nominal or ordinal factors as predictors as well. When factors are
    included as explanatory variables, our focus usually shifts from prediction to
    understanding group differences, and the methodology is referred to as *analysis
    of variance (ANOVA)*. ANOVA methodology is used to analyze a wide variety of experimental
    and quasi-experimental designs. This chapter provides an overview of R functions
    for analyzing common research designs.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在第 8 章中，我们探讨了用于从定量预测变量预测定量响应变量的回归模型，但并没有理由我们不能将名义或有序因素作为预测变量包括在内。当因素作为解释变量时，我们的焦点通常从预测转移到理解组间差异，这种方法被称为
    *方差分析（ANOVA）*。ANOVA 方法用于分析各种实验和准实验设计。本章提供了 R 函数分析常见研究设计的概述。
- en: First, we’ll look at design terminology, followed by a general discussion of
    R’s approach to fitting ANOVA models. Then, we’ll explore several examples that
    illustrate the analysis of common designs. Along the way, you’ll treat anxiety
    disorders, lower blood cholesterol levels, help pregnant mice have fat babies,
    ensure that pigs grow long in the tooth, facilitate breathing in plants, and learn
    which grocery shelves to avoid.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将探讨设计术语，然后一般性地讨论 R 拟合 ANOVA 模型的方法。接着，我们将探索几个示例，以说明常见设计的分析。在这个过程中，你将治疗焦虑症、降低血液胆固醇水平、帮助怀孕的老鼠生下胖宝宝、确保猪长牙、促进植物的呼吸，并了解哪些货架需要避免。
- en: In addition to the base installation, you’ll be using the `car`, `rrcov`, `multcomp`,
    `effects`, `MASS`, `dplyr`, `ggplot2`, and `mvoutlier` packages in the examples.
    Be sure to install them before trying out the sample code.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 除了基本安装之外，在示例中你将使用 `car`、`rrcov`、`multcomp`、`effects`、`MASS`、`dplyr`、`ggplot2`
    和 `mvoutlier` 这些包。在尝试示例代码之前，请确保安装它们。
- en: 9.1 A crash course on terminology
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.1 术语速成课程
- en: Experimental design in general, and analysis of variance in particular, have
    their own language. Before discussing the analysis of these designs, we’ll quickly
    review some important terms. We’ll use a series of increasingly complex study
    designs to introduce the most significant concepts.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 实验设计一般而言，尤其是方差分析（ANOVA）有其特定的语言。在讨论这些设计的分析之前，我们将快速回顾一些重要术语。我们将通过一系列越来越复杂的实验设计来介绍最重要的概念。
- en: Say you’re interested in studying the treatment of anxiety. Two popular therapies
    for anxiety are cognitive behavior therapy (CBT) and eye-movement desensitization
    and reprocessing (EMDR). You recruit 10 anxious individuals and randomly assign
    half of them to receive five weeks of CBT and half to receive five weeks of EMDR.
    At the conclusion of therapy, each patient is asked to complete the State-Trait
    Anxiety Inventory (STAI), a self-report measure of anxiety. Figure 9.1A outlines
    the design.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你对焦虑症的治疗感兴趣。两种流行的焦虑症治疗方法是认知行为疗法（CBT）和眼动脱敏与再加工（EMDR）。你招募了 10 名焦虑症患者，并将其中一半随机分配接受五周的
    CBT 治疗，另一半接受五周的 EMDR 治疗。在治疗结束时，每位患者都被要求完成状态-特质焦虑量表（STAI），这是一种焦虑的自我报告测量工具。图 9.1A
    概述了该设计。
- en: '![](Images/CH09_F01_Kabacoff3.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH09_F01_Kabacoff3.png)'
- en: Figure 9.1 Three analysis of variance (ANOVA) designs
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.1 三种方差分析（ANOVA）设计
- en: In this design, Treatment is a *between-groups* factor with two levels (CBT,
    EMDR). It’s called a between-groups factor because patients are assigned to one
    and only one group. No patient receives both CBT and EMDR. The *s* characters
    represent the subjects (patients). STAI is the *dependent variable*, and Treatment
    is the *independent variable*. Because there is an equal number of observations
    in each treatment condition, you have a *balanced design*. When the sample sizes
    are unequal across the cells of a design, you have an *unbalanced design*.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个设计中，治疗是一个 *组间* 因素，有两个水平（CBT、EMDR）。它被称为组间因素，因为患者被分配到一组，并且只有一组。没有患者同时接受 CBT
    和 EMDR。*s* 字符代表受试者（患者）。STAI 是 *因变量*，而治疗是 *自变量*。由于每个治疗条件中的观察数量相等，你有一个 *平衡设计*。当设计中的单元格样本量不相等时，你有一个
    *不平衡设计*。
- en: The statistical design in figure 9.1A is called a *one-way ANOVA* because there’s
    a single classification variable. Specifically, it’s a one-way between-groups
    ANOVA. Effects in ANOVA designs are primarily evaluated through F-tests. If the
    F-test for Treatment is significant, you can conclude that the mean STAI scores
    for two therapies differed after five weeks of treatment.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.1A中的统计设计被称为**单因素方差分析**，因为有一个单一的分类变量。具体来说，它是一个单因素组间方差分析。在方差分析设计中，效应主要通过F检验来评估。如果治疗因素的F检验显著，你可以得出结论，两种治疗在五周治疗后平均STAI分数存在差异。
- en: If you were interested in the effect of CBT on anxiety over time, you could
    place all 10 patients in the CBT group and assess them at the conclusion of therapy
    and again six months later. Figure 9.1B shows this design.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你感兴趣的是CBT对焦虑随时间的影响，你可以将所有10名患者都放在CBT组中，并在治疗结束时以及六个月后再次评估他们。图9.1B显示了这种设计。
- en: Time is a *within-groups* factor with two levels (five weeks, six months). It’s
    called a within-groups factor because each patient is measured under both levels.
    The statistical design is a *one-way within-groups ANOVA*. Because each subject
    is measured more than once, the design is also called a *repeated measures ANOVA*.
    If the F-test for Time is significant, you can conclude that patients’ mean STAI
    scores changed between five weeks and six months.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 时间是一个**组内**因素，有两个水平（五周，六个月）。它被称为组内因素，因为每个患者在两个水平下都被测量。统计设计是一个**单因素组内方差分析**。由于每个受试者被测量多次，该设计也被称为**重复测量方差分析**。如果时间因素的F检验显著，你可以得出结论，患者的平均STAI分数在五周和六个月之间发生了变化。
- en: If you were interested in both treatment differences *and* change over time,
    you could combine the first two study designs and randomly assign five patients
    to CBT and five patients to EMDR and assess their STAI results at the end of therapy
    (five weeks) and at six months (see figure 9.1C).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你既对治疗差异**以及**时间变化感兴趣，你可以结合前两种研究设计，随机分配五名患者到认知行为治疗（CBT）组和五名患者到眼动脱敏与再加工（EMDR）组，并在治疗结束（五周）和六个月后评估他们的STAI结果（见图9.1C）。
- en: By including both Therapy and Time as factors, you’re able to examine the impact
    of Therapy (averaged across time), Time (averaged across therapy type), and the
    interaction of Therapy and Time. The first two are called the *main effects*,
    whereas the interaction is (not surprisingly) called an *interaction effect*.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 通过将治疗和时间都作为因素，你可以检查治疗（时间平均），时间（治疗类型平均），以及治疗和时间的交互作用的影响。前两者被称为**主效应**，而交互作用（不出所料）被称为**交互效应**。
- en: When you cross two or more factors, as is done here, you have a *factorial ANOVA*
    design. Crossing two factors produces a two-way ANOVA, crossing three factors
    produces a three-way ANOVA, and so forth. When a factorial design includes both
    between-groups and within-groups factors, it’s also called a *mixed-model ANOVA*.
    The current design is a two-way mixed-model factorial ANOVA (phew!).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 当你交叉两个或更多因素，就像这里所做的那样，你有一个**因子方差分析**设计。交叉两个因素产生一个双向方差分析，交叉三个因素产生一个三向方差分析，依此类推。当一个因子设计包括组间和组内因素时，它也被称为**混合模型方差分析**。当前的设计是一个双向混合模型因子方差分析（哇！）。
- en: 'In this case, you’ll have three F-tests: one for Therapy, one for Time, and
    one for the Therapy × Time interaction. A significant result for Therapy indicates
    that CBT and EMDR differ in their impact on anxiety. A significant result for
    Time indicates that anxiety changed from week five to the six-month follow-up.
    A significant Therapy × Time interaction indicates that the two treatments for
    anxiety had a differential impact over time (that is, the change in anxiety from
    five weeks to six months was different for the two treatments).'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，你将有三项F检验：一项用于治疗，一项用于时间，一项用于治疗×时间的交互作用。治疗因素显著表明CBT和EMDR在影响焦虑方面存在差异。时间因素显著表明焦虑从第五周到六个月随访期间发生了变化。治疗×时间交互作用显著表明两种焦虑治疗方法在时间上的影响存在差异（即，从五周到六个月焦虑的变化对两种治疗方法来说是不同的）。
- en: Now let’s extend the design a bit. It’s known that depression can have an impact
    on therapy, and that depression and anxiety often co-occur. Even though subjects
    were randomly assigned to treatment conditions, it’s possible that the two therapy
    groups differed in patient depression levels at the initiation of the study. Any
    post-therapy differences might then be due to the preexisting depression differences
    and not to your experimental manipulation. Because depression could also explain
    the group differences on the dependent variable, it’s a *confounding* factor.
    And because you’re not interested in depression, it’s called a *nuisance* variable.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们稍微扩展一下设计。众所周知，抑郁症可能会影响治疗效果，并且抑郁症和焦虑症常常同时发生。尽管受试者被随机分配到治疗条件中，但在研究开始时，两个治疗组的患者抑郁症水平可能存在差异。任何治疗后的差异可能是由预先存在的抑郁症差异造成的，而不是由于你的实验操作。因为抑郁症也可能解释依赖变量的组间差异，所以它是一个*混杂*因素。而且因为你对抑郁症不感兴趣，所以它被称为*干扰*变量。
- en: If you recorded depression levels using a self-report depression measure such
    as the Beck Depression Inventory (BDI) when patients were recruited, you could
    statistically adjust for any treatment group differences in depression before
    assessing the impact of therapy type. In this case, BDI would be called a *covariate*,
    and the design would be called an *analysis of covariance (ANCOVA**)*.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用自我报告的抑郁症量表（如招募患者时的贝克抑郁量表BDI）记录了抑郁症水平，你可以在评估治疗效果的影响之前对任何治疗组的抑郁症差异进行统计调整。在这种情况下，BDI被称为*协变量*，设计被称为*协方差分析（ANCOVA）*。
- en: Finally, you’ve recorded a single dependent variable in this study (the STAI).
    You could increase the validity of this study by including additional measures
    of anxiety (such as family ratings, therapist ratings, and a measure assessing
    the impact of anxiety on their daily functioning). When there are more than one
    dependent variable, the design is called a *multivariate analysis of variance
    (MANOVA)*. If there are covariates present, it’s called a *multivariate analysis
    of covariance (MANCOVA)*.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你在这项研究中记录了一个单一的依赖变量（STAI）。你可以通过包括额外的焦虑测量（如家庭评估、治疗师评估以及评估焦虑对日常生活功能影响的测量）来提高这项研究的有效性。当存在多个依赖变量时，设计被称为*多变量方差分析（MANOVA）*。如果存在协变量，则称为*多变量协方差分析（MANCOVA）*。
- en: Now that you have the basic terminology under your belt, you’re ready to amaze
    your friends, dazzle new acquaintances, and learn how to fit ANOVA/ANCOVA/MANOVA
    models with R.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 现在你已经掌握了基本术语，你准备好让你的朋友们惊叹，让新认识的人眼花缭乱，并学习如何使用R拟合ANOVA/ANCOVA/MANOVA模型。
- en: 9.2 Fitting ANOVA models
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.2 拟合ANOVA模型
- en: Although ANOVA and regression methodologies developed separately, functionally
    they’re both special cases of the general linear model. You could analyze ANOVA
    models using the same `lm()` function used for regression in chapter 8\. But you’ll
    primarily use the `aov()` function in this chapter. The results of `lm()` and
    `aov()` are equivalent, but the `aov()` function presents these results in a format
    that’s more familiar to ANOVA methodologists. For completeness, I’ll provide an
    example using `lm()` at the end of this chapter.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然ANOVA和回归方法分别发展，但在功能上它们都是一般线性模型的特殊情况。你可以使用第8章中用于回归的相同`lm()`函数来分析ANOVA模型。但本章你将主要使用`aov()`函数。`lm()`和`aov()`的结果是等效的，但`aov()`函数以ANOVA方法学家更熟悉的方式呈现这些结果。为了完整性，我将在本章末尾提供一个使用`lm()`的示例。
- en: 9.2.1 The aov() function
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.2.1 `aov()`函数
- en: The syntax of the `aov()` function is `aov(``formula``,` `data=``dataframe``)`.
    Table 9.1 describes special symbols that can be used in the formulas. In this
    table, `y` is the dependent variable and the letters `A`, `B`, and `C` represent
    factors.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '`aov()`函数的语法是`aov(formula, data=dataframe)`。表9.1描述了可以在公式中使用的特殊符号。在这个表中，`y`是依赖变量，字母`A`、`B`和`C`代表因素。'
- en: Table 9.1 Special symbols used in R formulas
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 表9.1 R公式中使用的特殊符号
- en: '| Symbol | Usage |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| 符号 | 用法 |'
- en: '| `~` | Separates response variables on the left from the explanatory variables
    on the right. For example, a prediction of `y` from `A`, `B`, and `C` would be
    coded`y ~ A + B + C` |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| `~` | 将左侧的响应变量与右侧的解释变量分开。例如，从`A`、`B`和`C`预测`y`的编码为`y ~ A + B + C` |'
- en: '| `:` | Denotes an interaction between variables. A prediction of `y` from
    `A`, `B`, and the interaction between `A` and `B` would be coded`y ~ A + B + A:B`
    |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| `:` | 表示变量之间的交互作用。从`A`、`B`以及`A`和`B`之间的交互作用预测`y`的编码为`y ~ A + B + A:B` |'
- en: '| `*` | Denotes the complete crossing of variables. The code `y ~ A*B*C` expands
    to`y ~ A + B + C + A:B + A:C + B:C + A:B:C` |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| `*` | 表示变量的完全交叉。代码 `y ~ A*B*C` 展开为 `y ~ A + B + C + A:B + A:C + B:C + A:B:C`
    |'
- en: '| `^` | Denotes crossing to a specified degree. The code `y ~ (A+B+C)^2` expands
    to`y ~ A + B + C + A:B + A:C + A:B` |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| `^` | 表示到指定程度的交叉。代码 `y ~ (A+B+C)^2` 展开为 `y ~ A + B + C + A:B + A:C + A:B`
    |'
- en: '| `.` | Denotes all remaining variables. The code `y` `~ .` expands to`y ~
    A + B + C` |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| `.` | 表示所有剩余变量。代码 `y ~ .` 展开为 `y ~ A + B + C` |'
- en: Table 9.2 provides formulas for several common research designs. In this table,
    lowercase letters are quantitative variables, uppercase letters are grouping factors,
    and `Subject` is a unique identifier variable for subjects.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 表 9.2 提供了几个常见研究设计的公式。在此表中，小写字母是定量变量，大写字母是分组因子，`Subject` 是受试者的唯一标识变量。
- en: Table 9.2 Formulas for common research designs
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 表 9.2 常见研究设计的公式
- en: '| Design | Formula |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 设计 | 公式 |'
- en: '| One-way ANOVA | `y ~ A` |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 单因素方差分析 | `y ~ A` |'
- en: '| One-way ANCOVA with one covariate | `y ~ x + A` |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 具有一个协变量的单因素协方差分析 | `y ~ x + A` |'
- en: '| Two-way factorial ANOVA | `y ~ A * B` |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 双因素方差分析 | `y ~ A * B` |'
- en: '| Two-way factorial ANCOVA with two covariates | `y ~ x1 + x2 + A * B` |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| 具有两个协变量的双因素协方差分析 | `y ~ x1 + x2 + A * B` |'
- en: '| Randomized block | `y ~ B + A` (where `B` is a blocking factor) |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 随机区组 | `y ~ B + A` (其中 `B` 是一个区组因子) |'
- en: '| One-way within-groups ANOVA | `y ~ A + Error(Subject/A``)` |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| 单因素组内方差分析 | `y ~ A + Error(Subject/A)` |'
- en: '| Repeated measures ANOVA with one within-groups factor `(W)` and one between-groups
    factor `(B)` | `y ~ B * W + Error(Subject/W)` |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| 具有一个组内因子 `(W)` 和一个组间因子 `(B)` 的重复测量方差分析 | `y ~ B * W + Error(Subject/W)` |'
- en: We’ll explore in-depth examples of several of these designs later in this chapter.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章后面深入探讨这些设计的几个示例。
- en: 9.2.2 The order of formula terms
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.2.2 公式项的顺序
- en: The order in which the effects appear in a formula matters when (a) there’s
    more than one factor and the design is unbalanced or (b) covariates are present.
    When either of these two conditions is present, the variables on the right side
    of the equation will be correlated with each other. In this case, there’s no unambiguous
    way to divide up their impact on the dependent variable. For example, in a two-way
    ANOVA with unequal numbers of observations in the treatment combinations, the
    model `y` `~` `A*B` *will not* produce the same results as the model `y` `~` `B*A`.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 当公式中存在多个因子且设计不平衡或存在协变量时，公式中效应出现的顺序很重要。当这两种条件中的任何一种存在时，方程右侧的变量将相互关联。在这种情况下，没有明确的方法来划分它们对因变量的影响。例如，在一个具有不等数量观察值的处理组合的两因素方差分析中，模型
    `y` `~` `A*B` *不会*产生与模型 `y` `~` `B*A` 相同的结果。
- en: By default, R employs the Type I (sequential) approach to calculating ANOVA
    effects (see the sidebar “Order counts!”). The first model can be written as `y`
    `~` `A` `+` `B` `+ A:B`. The resulting R ANOVA table will assess
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，R 使用类型 I（顺序）方法计算方差分析效应（见侧边栏“顺序很重要！”）。第一个模型可以写成 `y` `~` `A` `+` `B` `+
    A:B`。生成的 R 方差分析表将评估
- en: The impact of `A` on `y`
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`A` 对 `y` 的影响'
- en: The impact of `B` on `y`, controlling for `A`
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在控制 `A` 的情况下，`B` 对 `y` 的影响
- en: The interaction of `A` and `B`, controlling for the `A` and `B` main effects
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在控制 `A` 和 `B` 的主效应的情况下，`A` 和 `B` 的交互作用
- en: Order counts!
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 顺序很重要！
- en: 'When independent variables are correlated with each other or with covariates,
    there’s no unambiguous method for assessing the independent contributions of these
    variables to the dependent variable. Consider an unbalanced two-way factorial
    design with factors `A` and `B` and dependent variable `y`. There are three effects
    in this design: the `A` and `B` main effects and the `A` `×` `B` interaction.
    Assuming that you’re modeling the data using the formula `Y` `~` `A` `+` `B` `+`
    `A:B,` there are three typical approaches for partitioning the variance in `y`
    among the effects on the right side of this equation.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 当自变量相互关联或与协变量关联时，没有明确的方法来评估这些变量对因变量的独立贡献。考虑一个具有 `A` 和 `B` 因子和因变量 `y` 的不平衡两因素设计。该设计有三个效应：`A`
    和 `B` 的主效应以及 `A` `×` `B` 的交互作用。假设你正在使用公式 `Y` `~` `A` `+` `B` `+` `A:B` 来建模数据，那么在方程右侧的效应中划分
    `y` 的方差有三个典型方法。
- en: Type I (sequential)
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 类型 I（顺序）
- en: Effects are adjusted for those that appear earlier in the formula. `A` is unadjusted.
    `B` is adjusted for `A`. The `A:B` interaction is adjusted for `A` and `B`.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 效应会调整那些在公式中较早出现的效应。`A` 是未调整的。`B` 调整了 `A`。`A:B` 交互作用调整了 `A` 和 `B`。
- en: Type II (hierarchical)
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 类型 II (分层)
- en: Effects are adjusted for other effects at the same or lower level. `A` is adjusted
    for `B`. `B` is adjusted for A. The `A:B` interaction is adjusted for both `A`
    and `B`.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 效应调整以适应同一或更低级别的其他效应。`A` 调整以适应 `B`。`B` 调整以适应 `A`。`A:B` 交互作用调整以适应 `A` 和 `B`。
- en: Type III (marginal)
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: III 类（边际）
- en: Each effect is adjusted for every other effect in the model. `A` is adjusted
    for `B` and `A:B. B` is adjusted for `A` and `A:B`. The `A:B` interaction is adjusted
    for `A` and `B`.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 模型中的每个效应都会调整以适应模型中的其他效应。`A` 调整以适应 `B` 和 `A:B`。`B` 调整以适应 `A` 和 `A:B`。`A:B` 交互作用调整以适应
    `A` 和 `B`。
- en: R employs the Type I approach by default. Other programs such as SAS and SPSS
    employ the Type III approach by default.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: R 默认采用 I 类方法。其他程序如 SAS 和 SPSS 默认采用 III 类方法。
- en: 'The greater the imbalance in sample sizes, the greater the impact that the
    order of the terms will have on the results. In general, more fundamental effects
    should be listed earlier in the formula. In particular, covariates should be listed
    first, followed by main effects, followed by two-way interactions, followed by
    three-way interactions, and so on. For main effects, more fundamental variables
    should be listed first. Thus, gender would be listed before treatment. Here’s
    the bottom line: when the research design isn’t orthogonal (that is, when the
    factors and/or covariates are correlated), be careful when specifying the order
    of effects.'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 样本大小不平衡程度越大，项的顺序对结果的影响就越大。一般来说，更基本的效果应该更早地列在公式中。特别是，协变量应该首先列出，然后是主效应，接着是双向交互作用，然后是三向交互作用，依此类推。对于主效应，更基本的变量应该首先列出。因此，性别应该列在治疗之前。底线是：当研究设计不是正交的（即，当因素和/或协变量相关时），在指定效应顺序时要小心。
- en: Before moving on to specific examples, note that the `Anova()` function in the
    `car` package (not to be confused with the standard `anova()` function) provides
    the option of using the Type II or Type III approach, rather than the Type I approach
    used by the `aov()` function. You may want to use the `Anova()` function if you’re
    concerned about matching your results to those provided by other packages such
    as SAS and SPSS. See `help(Anova,` `package="car")` for details.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在具体示例之前，请注意，`car` 包中的 `Anova()` 函数（不要与标准 `anova()` 函数混淆）提供了使用 II 类或 III 类方法而不是
    `aov()` 函数使用的 I 类方法的选择。如果你担心将你的结果与 SAS 和 SPSS 等其他包提供的结果相匹配，你可能想使用 `Anova()` 函数。有关详细信息，请参阅
    `help(Anova, package="car")`。
- en: 9.3 One-way ANOVA
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.3 单因素方差分析
- en: In a one-way ANOVA, you’re interested in comparing the dependent variable means
    of two or more groups defined by a categorical grouping factor. This example comes
    from the `cholesterol` dataset in the `multcomp` package, taken from Westfall,
    Tobias, Rom, and Hochberg (1999). Fifty patients received one of five cholesterol-reducing
    drug regimens (`trt`). Three of the treatment conditions involved the same drug
    administered as 20 mg once per day (`1time`), 10 mg twice per day (`2times`),
    or 5 mg four times per day (`4times`). The two remaining conditions (`drugD` and
    `drugE`) represented competing drugs. Which drug regimen produced the greatest
    cholesterol reduction (`response`)? The following listing provides the analysis.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在单因素方差分析中，你感兴趣的是比较由分类分组因素定义的两个或多个组的因变量均值。此例来自 `multcomp` 包中的 `cholesterol` 数据集，由
    Westfall、Tobias、Rom 和 Hochberg（1999）提供。50 名患者接受了五种胆固醇降低药物方案之一（`trt`）。三种治疗方案涉及相同的药物，每天一次
    20 毫克（`1time`）、每天两次 10 毫克（`2times`）或每天四次 5 毫克（`4times`）。剩下的两种条件（`drugD` 和 `drugE`）代表竞争性药物。哪种药物方案产生了最大的胆固醇降低（响应）？以下列表提供了分析。
- en: Listing 9.1 One-way ANOVA
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 9.1 单因素方差分析（ANOVA）
- en: '[PRE0]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: ❶ Group sample sizes, means, standard deviations, and 95% confidence intervals
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 组样本大小、均值、标准差和 95% 置信区间
- en: ❷ Tests for group differences (ANOVA)
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 组间差异检验（ANOVA）
- en: ❸ Plots group means and confidence intervals
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 绘制组均值和置信区间
- en: Looking at the output, you can see that 10 patients received each of the drug
    regimens ❶. From the means, it appears that `drugE` produced the greatest cholesterol
    reduction, whereas `1time` produced the least ❷. Standard deviations were relatively
    constant across the five groups, ranging from 2.88 to 3.48\. We assume that each
    treatment group in our study is a sample from a larger potential population of
    patients who could receive the treatment. For each treatment, the sample mean
    +/– `ci` gives us an interval that we are 95% confident includes the true population
    means. The ANOVA F-test for treatment (`trt`) is significant (p < .0001), providing
    evidence that the five treatments aren’t all equally effective ❷.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 观察输出结果，你可以看到每种药物方案都有 10 名患者接受治疗 ❶。从均值来看，`drugE` 产生了最大的胆固醇降低效果，而 `1time` 产生了最小的效果
    ❷。标准差在五个组中相对恒定，范围从 2.88 到 3.48。我们假设我们研究的每个治疗组都是可能接受治疗的更大潜在患者群体中的一个样本。对于每种治疗，样本均值
    +/– `ci` 给我们一个区间，我们 95% 置信这个区间包含真实的总体均值。治疗 ANOVA F 检验（`trt`）是显著的（p < .0001），提供了证据表明五种治疗并不都同样有效
    ❷。
- en: The `ggplot2` functions are used to create a graph of group means and their
    confidence intervals ❸ A plot of the treatment means, with 95% confidence limits,
    is provided in figure 9.2 and allows you to clearly see these treatment differences.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `ggplot2` 函数创建一个显示组均值及其置信区间的图表 ❸ 图 9.2 提供了带有 95% 置信限的治疗均值图，允许你清楚地看到这些治疗差异。
- en: '![](Images/CH09_F02_Kabacoff3.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH09_F02_Kabacoff3.png)'
- en: Figure 9.2 Treatment group means with 95% confidence intervals for five cholesterol-reducing
    drug regimens
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.2 五种降胆固醇药物方案的 95% 置信区间治疗组均值
- en: By including the confidence intervals in figure 9.2, we show the degree of certainty
    (or uncertainty) in our estimates of the population means.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在图 9.2 中包含置信区间，我们展示了我们对总体均值估计的确定性（或不确定性）程度。
- en: 9.3.1 Multiple comparisons
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.1 多重比较
- en: The ANOVA F-test for treatment tells you that the five drug regimens aren’t
    equally effective, but it doesn’t tell you *which* treatments differ from one
    another. You can use a multiple comparison procedure to answer this question.
    For example, the `TukeyHSD()` function provides a test of all pairwise differences
    between group means, as shown in the next listing.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 治疗ANOVA F检验告诉你五种药物方案并不都同样有效，但它并没有告诉你 *哪些* 治疗方案彼此不同。你可以使用多重比较程序来回答这个问题。例如，`TukeyHSD()`
    函数提供了组均值之间所有配对差异的检验，如下一列表所示。
- en: Listing 9.2 Tukey HSD pairwise group comparisons
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 9.2 Tukey HSD 配对组比较
- en: '[PRE1]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: ❶ Calculates pairwise comparisons
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 计算配对比较
- en: ❷ Creates a dataset of the results
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 创建结果数据集
- en: ❸ Plots the results
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 绘制结果
- en: For example, the mean cholesterol reductions for `1time` and `2times` aren’t
    significantly different from each other (p = 0.138), whereas the difference between
    `1time` and `4times` is significantly different (p < .001).
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，`1time` 和 `2times` 的平均胆固醇降低量之间没有显著差异（p = 0.138），而 `1time` 和 `4times` 之间的差异是显著的（p
    < .001）。
- en: Figure 9.3 plots the pairwise comparisons. In this graph, confidence intervals
    that include 0 indicate treatments that aren’t significantly different (p > 0.5).
    Here, we can see that the largest mean difference is between `drugE` and `1time`
    and that the difference is significant (the confidence interval does not include
    0).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.3 绘制了配对比较。在这个图中，包含 0 的置信区间表示治疗之间没有显著差异（p > 0.5）。在这里，我们可以看到最大的均值差异是在 `drugE`
    和 `1time` 之间，并且差异是显著的（置信区间不包括 0）。
- en: Before moving on, I should point out that we could have created the graphs in
    figure 9.3 using base graphics. In this case, the code would simply be `plot(pairwise)`.
    The advantage of the `ggplot2` approach is that it creates a more attractive plot
    and allows you to fully customize the graph to meet your needs.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续之前，我应该指出，我们本可以使用基础图形创建图 9.3 中的图表。在这种情况下，代码将简单为 `plot(pairwise)`。使用 `ggplot2`
    方法的优点是它创建了一个更吸引人的图表，并允许你完全自定义图表以满足你的需求。
- en: '![](Images/CH09_F03_Kabacoff3.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH09_F03_Kabacoff3.png)'
- en: Figure 9.3 Plot of Tukey HSD pairwise mean comparisons
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.3 Tukey HSD 配对均值比较图
- en: 'The `glht()` function in the `multcomp` package provides a much more comprehensive
    set of methods for multiple mean comparisons that you can use for both linear
    models (such as those described in this chapter) and generalized linear models
    (covered in chapter 13). The following code reproduces the Tukey HSD test, along
    with a different graphical representation of the results (figure 9.4):'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '`multcomp`包中的`glht()`函数提供了一套更全面的多种均值比较方法，你可以用于线性模型（如本章所述）和广义线性模型（在第13章中介绍）。以下代码重现了Tukey
    HSD检验，以及结果的不同图形表示（图9.4）：'
- en: '[PRE2]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](Images/CH09_F04_Kabacoff3.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F04_Kabacoff3.png)'
- en: Figure 9.4 Tukey HSD tests provided by the `multcomp` package
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.4展示了`multcomp`包提供的Tukey HSD检验
- en: The `level` option in the `cld()` function provides the significance level to
    use (0.05, or 95% confidence in this case).
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '`cld()`函数中的`level`选项提供了要使用的显著性水平（在本例中为0.05，或95%的置信度）。'
- en: Groups (represented by box plots) that have the same letter don’t have significantly
    different means. You can see that `1time` and `2times` aren’t significantly different
    (they both have the letter `a`) and that `2times` and `4times` aren’t significantly
    different (they both have the letter `b`), but `1time` and `4times` are different
    (they don’t share a letter). Personally, I find figure 9.4 easier to read than
    figure 9.3\. It also has the advantage of providing information on the distribution
    of scores within each group.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 具有相同字母的组（由箱线图表示）没有显著不同的均值。你可以看到`1time`和`2times`没有显著差异（它们都有字母`a`），以及`2times`和`4times`也没有显著差异（它们都有字母`b`），但`1time`和`4times`是不同的（它们没有共享相同的字母）。我个人觉得图9.4比图9.3更容易阅读。它还有提供每个组内分数分布信息的优势。
- en: From these results, you can see that taking the cholesterol-lowering drug in
    5-mg doses four times a day was better than taking a 20-mg dose once per day.
    The competitor `drugD` wasn’t superior to this four-times-per-day regimen. But
    competitor `drugE` was superior to `both` `drugD` and all three dosage strategies
    for the focus drug.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些结果中，你可以看到每天四次服用5毫克剂量的降胆固醇药物比每天一次服用20毫克剂量更好。竞争对手`drugD`并不优于这种每天四次的治疗方案。但竞争对手`drugE`优于`both`
    `drugD`和针对目标药物的三个剂量策略。
- en: Multiple comparisons methodology is a complex and rapidly changing area of study.
    To learn more, see Bretz, Hothorn, and Westfall (2010).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 多重比较方法是一个复杂且快速发展的研究领域。要了解更多信息，请参阅Bretz, Hothorn, and Westfall (2010)。
- en: 9.3.2 Assessing test assumptions
  id: totrans-96
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.3.2 评估测试假设
- en: 'As you saw in the previous chapter, confidence in results depends on the degree
    to which your data satisfies the assumptions underlying the statistical tests.
    In a one-way ANOVA, the dependent variable is assumed to be normally distributed
    and have equal variance in each group. You can use a Q-Q plot to assess the normality
    assumption:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你在上一章中看到的，结果的置信度取决于你的数据满足统计检验假设的程度。在一元方差分析（ANOVA）中，假设因变量呈正态分布，并且在每个组中具有相等的方差。你可以使用Q-Q图来评估正态性假设：
- en: '[PRE3]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Figure 9.5 provides the graph. By default, the two observations with the highest
    standardized residuals are identified by data frame row number. The data falls
    within the 95% confidence envelope, suggesting that the normality assumption has
    been met fairly well.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.5提供了图表。默认情况下，具有最高标准化残差的两项观测值通过数据框的行号识别。数据落在95%置信区间内，表明正态性假设得到了较好的满足。
- en: '![](Images/CH09_F05_Kabacoff3.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F05_Kabacoff3.png)'
- en: Figure 9.5 Test of the normality for the studentized residuals. Residuals are
    the actual minus the predicted outcomes, and studentized residuals are these residuals
    divided by estimates of their standard deviations. If the studentized residuals
    are normally distributed, they should cluster around the line.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.5展示了学生化残差的正态性检验。残差是实际值与预测值的差，而学生化残差则是这些残差除以其标准差的估计值。如果学生化残差呈正态分布，它们应该围绕直线聚集。
- en: 'R provides several tests for the equality (homogeneity) of variances. For example,
    you can perform Bartlett’s test with this code:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: R提供了几个用于方差（同质性）相等的测试。例如，你可以使用以下代码执行Bartlett测试：
- en: '[PRE4]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Bartlett’s test indicates that the variances in the five groups don’t differ
    significantly (p = 0.97). Other possible tests include the Fligner–Killeen test
    (provided by the `fligner .test()` function) and the Brown–Forsythe test (provided
    by the `hov()` function in the `HH` package). Although not shown, the other two
    tests reach the same conclusion.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: Bartlett检验表明，五个组之间的方差没有显著差异（p = 0.97）。其他可能的检验包括Fligner-Killeen检验（由`fligner.test()`函数提供）和Brown-Forsythe检验（由`HH`包中的`hov()`函数提供）。尽管没有展示，其他两个检验也得出相同的结论。
- en: 'Finally, analysis of variance methodologies can be sensitive to the presence
    of outliers. You can test for outliers using the `outlierTest()` function in the
    `car` package:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，方差分析方法对异常值的存在可能很敏感。你可以使用`car`包中的`outlierTest()`函数来测试异常值：
- en: '[PRE5]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: From the output, you can see that there’s no indication of outliers in the cholesterol
    data (`NA` occurs when p > 1). Taking the Q-Q plot, Bartlett’s test, and outlier
    test together, the data appear to fit the ANOVA model quite well. This, in turn,
    adds to your confidence in the results.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 从输出结果中，你可以看到胆固醇数据中没有异常值（当p > 1时出现`NA`）。结合Q-Q图、Bartlett检验和异常值检验，数据似乎很好地符合方差分析模型。这反过来又增加了你对结果的信心。
- en: 9.4 One-way ANCOVA
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.4 一元方差分析协方差（ANCOVA）
- en: A one-way analysis of covariance (ANCOVA) extends the one-way ANOVA to include
    one or more quantitative covariates. This example comes from the `litter` dataset
    in the `multcomp` package (see Westfall et al., 1999). Pregnant mice were divided
    into four treatment groups; each group received a different dose of a drug (0,
    5, 50, or 500). The mean post-birth weight for each litter was the dependent variable,
    and gestation time was included as a covariate. The following listing gives the
    analysis.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 一元方差分析协方差（ANCOVA）将一元方差分析扩展到包括一个或多个定量协变量。此例来自`multcomp`包中的`litter`数据集（参见Westfall等，1999）。怀孕的雌鼠被分为四个治疗组；每个组接受不同剂量的药物（0、5、50或500）。每个窝的平均出生体重是因变量，妊娠时间被包括为协变量。以下列表给出了分析。
- en: Listing 9.3 One-way ANCOVA
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.3 一元方差分析协方差（ANCOVA）
- en: '[PRE6]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: From the `summarise()` function, you can see that there is an unequal number
    of litters at each dosage level, with 20 litters at zero dosage (no drug) and
    17 litters at dosage 500\. Based on the group means, the *no-drug* group had the
    highest mean litter weight (32.3). The ANCOVA F-tests indicate that (a) gestation
    time was related to birth weight, and (b) drug dosage was related to birth weight
    after controlling for gestation time. The mean birth weight isn’t the same for
    each of the drug dosages after controlling for gestation time.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 从`summarise()`函数中，你可以看到每个剂量水平上的窝数不等，零剂量（无药物）有20窝，剂量500有17窝。根据组均值，*无药物*组的平均窝重最高（32.3）。ANCOVA
    F检验表明，在控制妊娠时间后，(a)妊娠时间与出生体重相关，(b)药物剂量与出生体重相关。在控制妊娠时间后，不同药物剂量的平均出生体重并不相同。
- en: 'Because you’re using a covariate, you may want to obtain adjusted group means—that
    is, the group means obtained after partialing out the effects of the covariate.
    You can use the `effect()` function in the `effects` library to calculate adjusted
    means:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你使用了协变量，你可能希望获得调整后的组均值——也就是说，在部分消除协变量影响后得到的组均值。你可以使用`effects`库中的`effect()`函数来计算调整后的均值：
- en: '[PRE7]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: These are the mean litter weights for each treatment dose after statistically
    adjusting for initial differences in gestation time. In this case, the adjusted
    means differ quite a bit from the unadjusted means produced by the `summarise()`
    function. The `effects` package provides a powerful method of obtaining adjusted
    means for complex research designs and presenting them visually. See the package
    documentation on CRAN for more details.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是每个治疗剂量的平均窝重，在统计调整了妊娠时间初始差异后得到的。在这种情况下，调整后的均值与`summarise()`函数产生的未调整均值差异很大。`effects`包提供了一种强大的方法，用于获取复杂研究设计的调整均值并直观地展示它们。有关更多详细信息，请参阅CRAN上的包文档。
- en: As with the one-way ANOVA example in the last section, the F-test for dose indicates
    that the treatments don’t have the same mean birth weight, but it doesn’t tell
    you which means differ from one another. Again, you can use the multiple comparison
    procedures provided by the `multcomp` package to compute all pairwise mean comparisons.
    Additionally, the `multcomp` package can be used to test specific user-defined
    hypotheses about the means.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 与上一节中提到的一元方差分析示例类似，剂量F检验表明处理组之间的平均出生重量不同，但它并没有告诉你哪些平均值彼此不同。再次强调，你可以使用`multcomp`包提供的多重比较程序来计算所有成对平均值的比较。此外，`multcomp`包还可以用来测试关于平均值的具体用户定义假设。
- en: Suppose you’re interested in whether the no-drug condition differs from the
    three-drug condition. The code in the following listing can be used to test this
    hypothesis.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你对无药条件是否与三药条件不同感兴趣。以下列表中的代码可以用来测试这个假设。
- en: Listing 9.4 Multiple comparisons employing user-supplied contrasts
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.4使用用户提供的对比进行多重比较
- en: '[PRE8]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The contrast `c(3,` `-1,` `-1,` `-1)` specifies a comparison of the first group
    with the average of the other three. Specifically, the hypothesis being tested
    is
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 对比`c(3, -1, -1, -1)`指定了第一组与其他三组的平均值进行比较。具体来说，正在测试的假设是
- en: '![](Images/CH09_F05_Kabacoff3-EQ01a.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F05_Kabacoff3-EQ01a.png)'
- en: or
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 或者
- en: '![](Images/CH09_F05_Kabacoff3-EQ01b.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F05_Kabacoff3-EQ01b.png)'
- en: where *μ[n]* is the mean litter weight for dose *n*. The hypothesis is tested
    with a t-statistic (2.581 in this case), which is significant at the p < .05 level.
    Therefore, you can conclude that the no-drug group has a higher birth weight than
    the drug conditions. Other contrasts can be added to the `rbind()` function (see
    `help(glht)` for details).
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 其中*μ[n]*是剂量*n*的平均窝重。该假设通过t统计量（本例中为2.581）进行测试，该统计量在p < .05水平上是显著的。因此，你可以得出结论，无药组比药物条件下的出生重量更高。可以添加其他对比到`rbind()`函数中（有关详细信息，请参阅`help(glht)`）。
- en: 9.4.1 Assessing test assumptions
  id: totrans-125
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4.1 评估测试假设
- en: ANCOVA designs make the same normality and homogeneity of variance assumptions
    described for ANOVA designs, and you can test these assumptions using the same
    procedures described in section 9.3.2\. In addition, standard ANCOVA designs assume
    homogeneity of regression slopes. In this case, it’s assumed that the regression
    slope for predicting birth weight from gestation time is the same in each of the
    four treatment groups. A test for the homogeneity of regression slopes can be
    obtained by including a gestation × dose interaction term in your ANCOVA model.
    A significant interaction would imply that the relationship between gestation
    and birth weight depends on the level of the dose variable. The code and results
    are provided in the following listing.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: ANCOVA设计对ANOVA设计中描述的相同正态性和方差齐性假设，并且你可以使用本节9.3.2中描述的相同程序来测试这些假设。此外，标准的ANCOVA设计假设回归斜率同质性。在这种情况下，假设预测出生重量与妊娠时间之间的回归斜率在四个处理组中是相同的。可以通过在ANCOVA模型中包含妊娠×剂量交互项来获得回归斜率同质性的检验。显著的交互作用将意味着妊娠与出生重量之间的关系取决于剂量变量的水平。以下列表提供了代码和结果。
- en: Listing 9.5 Testing for homogeneity of regression slopes
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.5检验回归斜率的同质性
- en: '[PRE9]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The interaction is nonsignificant, supporting the assumption of equality of
    slopes. If the assumption is untenable, you could try transforming the covariate
    or dependent variable, using a model that accounts for separate slopes, or employing
    a nonparametric ANCOVA method that doesn’t require homogeneity of regression slopes.
    See the `sm.ancova()` function in the `sm` package for an example of the latter.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 交互作用不显著，支持斜率相等的假设。如果假设不可行，你可以尝试转换协变量或因变量，使用考虑单独斜率的模型，或者采用不需要回归斜率同质性的非参数ANCOVA方法。有关后者的示例，请参阅`sm`包中的`sm.ancova()`函数。
- en: 9.4.2 Visualizing the results
  id: totrans-130
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.4.2 可视化结果
- en: We can use `ggplot2` to visualize of the relationship between the dependent
    variable, the covariate, and the factor. For example,
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用`ggplot2`来可视化因变量、协变量和因素之间的关系。例如，
- en: '[PRE10]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: produces the plot shown in figure 9.6.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 生成如图9.6所示的图表。
- en: '![](Images/CH09_F06_Kabacoff3.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F06_Kabacoff3.png)'
- en: Figure 9.6 Plot of the relationship between gestation time and birth weight
    for each of four drug treatment groups
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.6展示了四个药物处理组中妊娠时间与出生重量的关系图
- en: Here you can see that the regression lines for predicting birth weight from
    gestation time are parallel in each group but have different intercepts. As gestation
    time increases, birth weight increases. Additionally, you can see that the zero-dose
    group has the largest intercept, and the five-dose group has the lowest intercept.
    The lines are parallel because they’ve been specified to be. If you used the code
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到预测出生重量的回归线在每个组中都是平行的，但截距不同。随着妊娠时间的增加，出生重量增加。此外，您还可以看到零剂量组的截距最大，而五剂量组的截距最低。这些线是平行的，因为它们被指定为平行的。如果您使用了代码
- en: '[PRE11]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: instead, you’d generate a plot that allows both the slopes and intercepts to
    vary by group. This approach is useful for visualizing the case where the homogeneity
    of regression slopes doesn’t hold.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，您会生成一个允许斜率和截距按组变化的图表。这种方法对于可视化回归斜率同质性不成立的情况很有用。
- en: 9.5 Two-way factorial ANOVA
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.5 双因素方差分析
- en: In a two-way factorial ANOVA, subjects are assigned to groups that are formed
    from the cross-classification of two factors. This example uses the `ToothGrowth`
    dataset in the base installation to demonstrate a two-way between-groups ANOVA.
    Sixty guinea pigs are randomly assigned to receive one of three levels of ascorbic
    acid (0.5, 1, or 2 mg) and one of two delivery methods (orange juice or vitamin
    C), under the restriction that each treatment combination has 10 guinea pigs.
    The dependent variable is tooth length. The following listing shows the code for
    the analysis.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在双因素方差分析中，受试者被分配到由两个因素的交叉分类形成的组。本例使用基础安装中的`ToothGrowth`数据集来演示双因素组间方差分析。六十只豚鼠被随机分配到接受三种水平的抗坏血酸（0.5毫克、1毫克或2毫克）和两种递送方法（橙汁或维生素C）之一，限制条件是每种治疗组合有10只豚鼠。因变量是牙齿长度。以下列表显示了分析的代码。
- en: Listing 9.6 Two-way ANOVA
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.6 双因素方差分析
- en: '[PRE12]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: ❶ Prepares data
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 准备数据
- en: ❷ Calculates summary statistics
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 计算摘要统计量
- en: ❸ Fits two-way ANOVA model
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 拟合双因素方差分析模型
- en: First, the `dose` variable is converted to a factor so the `aov()` function
    will treat it as a grouping variable rather than a numeric covariate ❶. Next,
    summary statistics (n, mean, standard deviation, and confidence interval for the
    mean) are calculated for each combination of treatments ❷. The sample sizes indicate
    that you have a balanced design (equal sample sizes in each cell of the design.
    The two-way ANOVA model is fitted to the data ❸, and the `summary()` function
    indicates that both main effects (`supp` and `dose`) and the interaction between
    these factors are significant.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，将`剂量`变量转换为因子，这样`aov()`函数会将其视为分组变量而不是数值协变量 ❶。接下来，计算每种治疗组合的摘要统计量（样本量、均值、标准差和均值的置信区间）
    ❷。样本量表明您有一个平衡的设计（设计中每个单元格的样本量相等）。将双因素方差分析模型拟合到数据 ❸，`summary()`函数表明主效应（`supp`和`dose`）以及这些因素之间的交互作用都是显著的。
- en: You can visualize the results in several ways, including the `interaction.plot()`
    function in base R, the `plotmeans()` function in the `gplots` package, and the
    `interaction2wt()` function in the `HH` package. In the code following figure
    9.7, we’ll use `ggplot2` to plot the means and 95% confidence intervals for the
    means for this two-way ANOVA. One advantage of using `ggplot2` is that we can
    customize the graph to suit our research and aesthetic needs. Figure 9.7\. presents
    the resulting graph.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过多种方式可视化结果，包括基础R中的`interaction.plot()`函数、`gplots`包中的`plotmeans()`函数以及`HH`包中的`interaction2wt()`函数。在图9.7之后的代码中，我们将使用`ggplot2`来绘制这个双因素方差分析的均值和均值的95%置信区间。使用`ggplot2`的一个优点是我们可以根据我们的研究和美学需求自定义图表。图9.7\.展示了生成的图表。
- en: '![](Images/CH09_F07_Kabacoff3.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F07_Kabacoff3.png)'
- en: Figure 9.7 Interaction between dose and delivery mechanism on tooth growth.
    The plot of means was created using the `ggplot2` code.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.7显示了剂量和递送机制对牙齿生长的交互作用。均值图是使用`ggplot2`代码创建的。
- en: '[PRE13]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: The graph indicates that tooth growth increases with the dose of ascorbic acid
    for both orange juice and vitamin C. For the 0.5 and 1 mg doses, orange juice
    produced more tooth growth than vitamin C. For 2 mg of ascorbic acid, both delivery
    methods produced identical growth.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 图表显示，无论是橙汁还是维生素C，牙齿生长都与抗坏血酸剂量成正比。对于0.5毫克和1毫克的剂量，橙汁产生的牙齿生长比维生素C多。对于2毫克的抗坏血酸，两种递送方法产生的生长相同。
- en: Although I don’t cover the tests of model assumptions and mean comparison procedures,
    they’re a natural extension of the methods you’ve seen so far. Additionally, the
    design is balanced, so you don’t have to worry about the order of effects.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我没有涵盖模型假设检验和均值比较程序，但它们是您迄今为止看到的方法的自然扩展。此外，设计是平衡的，因此您不必担心效应的顺序。
- en: 9.6 Repeated measures ANOVA
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.6 重复测量方差分析
- en: In repeated measures ANOVA, subjects are measured more than once. This section
    focuses on a repeated measures ANOVA with one within-groups and one between-groups
    factor (a common design). We’ll take our example from the field of physiological
    ecology. Physiological ecologists study how the physiological and biochemical
    processes of living systems respond to variations in environmental factors (a
    crucial area of study given the realities of global warming). The `CO2` dataset
    included in the base installation contains the results of a study of cold tolerance
    in northern and southern plants of the grass species *Echinochloa crus-galli*
    (Potvin, Lechowicz, and Tardif, 1990). The photosynthetic rates of chilled plants
    were compared with the photosynthetic rates of nonchilled plants at several ambient
    CO[2] concentrations. Half the plants were from Quebec, and half were from Mississippi.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在重复测量方差分析中，受试者被测量多次。本节重点介绍一个包含一个组内因素和一个组间因素的重复测量方差分析（这是一种常见的设计）。我们将从生理生态学领域取例。生理生态学家研究生物系统的生理和生化过程如何对环境因素的变异做出反应（鉴于全球变暖的现实，这是一个关键的研究领域）。包含在基本安装中的`CO2`数据集包含了对草种*Echinochloa
    crus-galli*（Potvin，Lechowicz和Tardif，1990）南北植物耐寒性研究的结果。冷却植物的光合速率与在几个环境CO[2]浓度下的非冷却植物的光合速率进行了比较。一半的植物来自魁北克，另一半来自密西西比。
- en: In this example, we’ll focus on chilled plants. The dependent variable is carbon
    dioxide uptake (`uptake`) in ml/L, and the independent variables are `Type` (Quebec
    versus Mississippi) and ambient CO[2] concentration (`conc`) with seven levels
    (ranging from 95 to 1000 umol/m^2 sec). `Type` is a between-groups factor, and
    `conc` is a within-groups factor. `Type` is already stored as a factor, but you’ll
    need to convert `conc` to a factor before continuing. The analysis is presented
    in the next listing.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在本例中，我们将关注冷却植物。因变量是二氧化碳吸收量（`uptake`）以毫升/升为单位，自变量是`Type`（魁北克与密西西比）和周围CO[2]浓度（`conc`），共有七个水平（从95到1000微摩尔/平方米秒）。`Type`是组间因素，而`conc`是组内因素。`Type`已经存储为因素，但您需要将`conc`转换为因素才能继续。分析将在下一列表中展示。
- en: Listing 9.7 Repeated measures ANOVA with a between- and a within-groups factor
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.7 具有组间和组内因素的重复测量方差分析
- en: '[PRE14]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The ANOVA table indicates that the `Type` and concentration main effects and
    the `Type` × concentration interaction are all significant at the 0.01 level.
    Figure 9.8 shows a plot of the interaction. In this case, I've left out confidence
    intervals to keep the graph from becoming too busy.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 方差分析表表明，`Type`和浓度的主效应以及`Type` × 浓度的交互作用在0.01水平上均显著。图9.8显示了交互作用的图示。在这种情况下，我省略了置信区间，以避免图表过于复杂。
- en: 'To demonstrate a different presentation of the interaction, the `geom_boxplot()`
    function is used to plot the same data. Figure 9.9 provides the results:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 为了展示交互作用的另一种表示，使用了`geom_boxplot()`函数来绘制相同的数据。图9.9提供了结果：
- en: '[PRE15]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](Images/CH09_F08_Kabacoff3.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F08_Kabacoff3.png)'
- en: Figure 9.8 Interaction of ambient CO[2] concentration and plant type on CO[2]
    uptake
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.8 环境CO[2]浓度和植物类型对CO[2]吸收的交互作用
- en: '![](Images/CH09_F09_Kabacoff3.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F09_Kabacoff3.png)'
- en: Figure 9.9 Interaction of ambient CO[2] concentration and plant type on CO[2]
    uptake
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.9 环境CO[2]浓度和植物类型对CO[2]吸收的交互作用
- en: From either graph, you can see that there’s a greater carbon dioxide uptake
    in plants from Quebec compared to Mississippi. The difference is more pronounced
    at higher ambient CO[2] concentrations.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 从任一图表中，您都可以看到来自魁北克的植物比密西西比州的植物有更高的二氧化碳吸收量。在较高的环境CO[2]浓度下，这种差异更为明显。
- en: Note Datasets are typically in *wide format*, where columns are variables and
    rows are observations, and there’s a single row for each subject. The `litter`
    data frame from section 9.4 is a good example. When dealing with repeated measures
    designs, you typically need the data in *long format* before fitting models. In
    long format, each measurement of the dependent variable is placed in its own row.
    The `CO2` dataset follows this form. Luckily, the `tidyr` package described in
    chapter 5 (section 5.5.2) can easily reorganize your data into the required format.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 注意数据集通常是*宽格式*，其中列是变量，行是观测值，每个受试者有一个单独的行。9.4节中的`litter`数据框是一个很好的例子。在处理重复测量设计时，通常在拟合模型之前需要将数据转换为*长格式*。在长格式中，因变量的每个测量值都放在自己的行中。`CO2`数据集遵循这种形式。幸运的是，第5章（5.5.2节）中描述的`tidyr`包可以轻松地将您的数据重新组织成所需的格式。
- en: The many approaches to mixed-model designs
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 混合模型设计的多种方法
- en: 'The CO[2] example in this section was analyzed using a traditional repeated
    measures ANOVA. The approach assumes that the covariance matrix for any within-groups
    factor follows a specified form known as sphericity. Specifically, it assumes
    that the variances of the differences between any two levels of the within-groups
    factor are equal. In real-world data, it’s unlikely that this assumption will
    be met. This has led to a number of alternative approaches, including the following:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中的CO[2]示例使用传统的重复测量方差分析（ANOVA）进行分析。该方法假设任何组内因素的协方差矩阵遵循称为球性的特定形式。具体来说，它假设组内因素任何两个水平之间的差异的方差是相等的。在现实世界的数据中，这个假设不太可能成立。这导致了许多替代方法，包括以下几种：
- en: Using the `lmer()` function in the `lme4` package to fit linear mixed models
    (Bates, 2005)
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`lme4`包中的`lmer()`函数来拟合线性混合模型（Bates，2005）
- en: Using the `Anova()` function in the `car` package to adjust traditional test
    statistics to account for lack of sphericity (for example, the Geisser–Greenhouse
    correction)
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`car`包中的`Anova()`函数调整传统的测试统计量以考虑球性不足（例如，Geisser-Greenhouse校正）
- en: Using the `gls()` function in the `nlme` package to fit generalized least squares
    models with specified variance-covariance structures (UCLA, 2009)
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`nlme`包中的`gls()`函数来拟合具有指定方差-协方差结构的广义最小二乘模型（UCLA，2009）
- en: Using multivariate analysis of variance to model repeated measured data (Hand,
    1987)
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用多元方差分析来建模重复测量数据（Hand，1987）
- en: Coverage of these approaches is beyond the scope of this text. If you’re interested
    in learning more, check out Pinheiro and Bates (2000) and Zuur et al. (2009).
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 这些方法的覆盖范围超出了本文的范围。如果您想了解更多信息，请参阅Pinheiro和Bates（2000）以及Zuur等人（2009）。
- en: Up to this point, all the methods in this chapter have assumed that there’s
    a single dependent variable. In the next section, we’ll briefly consider designs
    that include more than one outcome variable.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，本章中介绍的所有方法都假设存在一个单一的因变量。在下一节中，我们将简要讨论包括多个结果变量的设计。
- en: 9.7 Multivariate analysis of variance (MANOVA)
  id: totrans-175
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.7 多元方差分析（MANOVA）
- en: If there’s more than one dependent (outcome) variable, you can test them simultaneously
    using a multivariate analysis of variance (MANOVA). The following example is based
    on the `UScereal` dataset in the `MASS` package. The dataset comes from Venables
    and Ripley (1999). In this example, you’re interested in whether the calories,
    fat, and sugar content of US cereals vary by store shelf, where 1 is the bottom
    shelf, 2 is the middle shelf, and 3 is the top shelf. `Calories`, `fat`, and `sugars`
    are the dependent variables, and `shelf` is the independent variable, with three
    levels (1, 2, and 3). The following listing presents the analysis.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 如果存在多个因变量（结果变量），您可以使用多元方差分析（MANOVA）同时测试它们。以下示例基于`MASS`包中的`UScereal`数据集。数据集来自Venables和Ripley（1999）。在这个例子中，您感兴趣的是美国谷物的卡路里、脂肪和糖含量是否因货架位置而异，其中1是底层货架，2是中间货架，3是顶层货架。"Calories"、"fat"和"sugars"是因变量，"shelf"是自变量，有三个水平（1、2和3）。以下列表展示了分析。
- en: Listing 9.8 One-way MANOVA
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.8 一元MANOVA
- en: '[PRE16]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: ❶ Prints univariate results
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 打印单变量结果
- en: First, the shelf variable is converted to a factor so that it can represent
    a grouping variable in the analyses. Next, the `cbind()` function is used to form
    a matrix of the three dependent variables (`calories`, `fat`, and `sugars`). The
    `aggregate()` function provides the shelf means, and the `cov()` function provides
    the variance and the covariances across cereals.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，将货架变量转换为因子，以便在分析中代表分组变量。接下来，使用`cbind()`函数形成三个依赖变量（`calories`、`fat`和`sugars`）的矩阵。`aggregate()`函数提供货架均值，`cov()`函数提供谷物之间的方差和协方差。
- en: The `manova()` function provides the multivariate test of group differences.
    The significant F-value indicates that the three groups differ on the set of nutritional
    measures. Note that the shelf variable was converted to a factor so it can represent
    a grouping variable.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '`manova()`函数提供了组间差异的多元测试。显著的F值表明三个组在营养指标集合上有所不同。请注意，货架变量被转换为因子，以便它可以表示分组变量。'
- en: Because the multivariate test is significant, you can use the `summary.aov()`
    function to obtain the univariate one-way ANOVAs ❶. Here, you see that the three
    groups differ on each nutritional measure considered separately. Finally, you
    can use a mean comparison procedure (such as `TukeyHSD`) to determine which shelves
    differ from each other for each of the three dependent variables (omitted here
    to save space).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 由于多元测试是显著的，您可以使用`summary.aov()`函数来获取单因素方差分析。在这里，您可以看到三个组在单独考虑的每个营养指标上都有所不同。最后，您可以使用均值比较程序（如`TukeyHSD`）来确定三个因变量中哪些货架彼此不同（此处省略以节省空间）。
- en: 9.7.1 Assessing test assumptions
  id: totrans-183
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.7.1 评估测试假设
- en: The two assumptions underlying a one-way MANOVA are multivariate normality and
    homogeneity of variance-covariance matrices. The first assumption states that
    the vector of dependent variables jointly follows a multivariate normal distribution.
    You can use a Q-Q plot to assess this assumption (see the sidebar “A theory interlude”
    for a statistical explanation of how this works).
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 一元方差分析（MANOVA）的两个基本假设是多元正态性和方差协方差矩阵的同质性。第一个假设指出，依赖变量的向量共同遵循多元正态分布。您可以使用Q-Q图来评估此假设（有关如何工作的统计解释，请参阅侧边栏“理论插曲”）。
- en: A theory interlude
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 理论插曲
- en: If you have p × 1 multivariate normal random vector *x* with mean *µ* and covariance
    matrix *∑*, then the squared Mahalanobis distance between *x* and *µ* is chi-square
    distributed with p degrees of freedom. The Q-Q plot graphs the quantiles of the
    chi-square distribution for the sample against the Mahalanobis D-squared values.
    To the degree that the points fall along a line with slope 1 and intercept 0,
    there’s evidence that the data is multivariate normal.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您有一个p × 1的多元正态随机向量*x*，其均值为*µ*，协方差矩阵为*∑*，那么*x*与*µ*之间的马氏距离的平方是具有p个自由度的卡方分布。Q-Q图将样本的卡方分布分位数与马氏D平方值进行绘图。在多大程度上，点沿着斜率为1、截距为0的直线分布，就有证据表明数据是多元正态的。
- en: The code is shown in the next listing, and the resulting graph is displayed
    in figure 9.10.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 代码显示在下一条列表中，结果图显示在图9.10中。
- en: Listing 9.9 Assessing multivariate normality
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 列表9.9 评估多元正态性
- en: '[PRE17]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: If the data follows a multivariate normal distribution, then points will fall
    on the line. The `identify()` function allows you to interactively identify points
    in the graph. Click on each point of interest and then press ESC or the Finish
    button. Here, the dataset appears to violate multivariate normality, primarily
    due to the observations for Wheaties Honey Gold and Wheaties. You may want to
    delete these two cases and rerun the analyses.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 如果数据遵循多元正态分布，则点将落在直线上。`identify()`函数允许您交互式地识别图中的点。点击每个感兴趣的点，然后按ESC键或完成按钮。在这里，数据集似乎违反了多元正态性，这主要是由于Wheaties
    Honey Gold和Wheaties的观测值。您可能想要删除这两个案例并重新运行分析。
- en: '![](Images/CH09_F10_Kabacoff3.png)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH09_F10_Kabacoff3.png)'
- en: Figure 9.10 A Q-Q plot for assessing multivariate normality
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 图9.10 评估多元正态性的Q-Q图
- en: The homogeneity of variance-covariance matrices assumption requires that the
    covariance matrix for each group is equal. The assumption is usually evaluated
    with a Box’s M test. R doesn’t include a function for Box’s M, but an internet
    search will provide the appropriate code. Unfortunately, the test is sensitive
    to violations of normality, leading to rejection in most typical cases. This means
    that we don’t yet have a good working method for evaluating this important assumption
    (but see Anderson (2006) and Silva et al. (2008) for interesting alternative approaches
    not yet available in R).
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 方差-协方差矩阵同质性的假设要求每个组的协方差矩阵相等。这个假设通常使用 Box 的 M 测试来评估。R 不包括 Box 的 M 测试函数，但网络搜索将提供适当的代码。不幸的是，该测试对正态性的违反很敏感，导致在大多数典型情况下被拒绝。这意味着我们还没有一个很好的方法来评估这个重要的假设（但请参阅
    Anderson (2006) 和 Silva 等人 (2008) 的有趣替代方法，这些方法在 R 中尚未提供）。
- en: 'Finally, you can test for multivariate outliers using the `aq.plot()` function
    in the `mvoutlier` package. The code in this case looks like this:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你可以使用 `mvoutlier` 包中的 `aq.plot()` 函数来测试多元异常值。这个例子中的代码看起来是这样的：
- en: '[PRE18]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Try it, and see what you get!
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试一下，看看你得到什么！
- en: 9.7.2 Robust MANOVA
  id: totrans-197
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 9.7.2 稳健 MANOVA
- en: If the assumptions of multivariate normality or homogeneity of variance-covariance
    matrices are untenable, or if you’re concerned about multivariate outliers, you
    may want to consider using a robust or nonparametric version of the MANOVA test
    instead. The `Wilks.test()` function in the `rrcov` package provides a robust
    version of the one-way MANOVA. The `adonis()` function in the `vegan` package
    can provide the equivalent of a nonparametric MANOVA. The following listing applies
    `Wilks.test()` to the example.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 如果多元正态性或方差-协方差矩阵同质性的假设不可靠，或者如果你担心多元异常值，你可能想考虑使用稳健或非参数版本的 MANOVA 测试。`rrcov` 包中的
    `Wilks.test()` 函数提供了一个稳健的单因素 MANOVA 版本。`vegan` 包中的 `adonis()` 函数可以提供相当于非参数 MANOVA
    的结果。以下列表将 `Wilks.test()` 应用于示例。
- en: Listing 9.10 Robust one-way MANOVA
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 9.10 稳健单因素 MANOVA
- en: '[PRE19]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: From the results, you can see that using a robust test that’s insensitive to
    both outliers and violations of MANOVA assumptions still indicates that the cereals
    on the top, middle, and bottom store shelves differ in their nutritional profiles.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 从结果中，你可以看到使用对异常值和 MANOVA 假设违反都不敏感的稳健测试仍然表明，位于顶部、中间和底部货架上的谷物在营养特征上有所不同。
- en: 9.8 ANOVA as regression
  id: totrans-202
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 9.8 ANOVA 作为回归
- en: In section 9.2, we noted that ANOVA and regression are both special cases of
    the same general linear model. As such, the designs in this chapter could have
    been analyzed using the `lm()` function. But to understand the output, you need
    to understand how R deals with categorical variables when fitting models.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 在 9.2 节中，我们指出 ANOVA 和回归都是同一通用线性模型的特殊情况。因此，本章中的设计可以使用 `lm()` 函数进行分析。但要理解输出，你需要了解
    R 在拟合模型时如何处理分类变量。
- en: 'Consider the one-way ANOVA problem in section 9.3, which compares the impact
    of five cholesterol-reducing drug regimens (`trt`):'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑 9.3 节中的一元 ANOVA 问题，它比较了五种降低胆固醇的药物方案（`trt`）的影响：
- en: '[PRE20]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'First, let’s fit the model using the `aov()` function:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们使用 `aov()` 函数拟合模型：
- en: '[PRE21]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Now, let’s fit the same model using `lm()`. In this case, you get the results
    shown in the next listing.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们使用 `lm()` 拟合相同的模型。在这种情况下，你得到的结果将在下一个列表中显示。
- en: Listing 9.11 A regression approach to the ANOVA problem in section 9.3
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 9.11 9.3 节中 ANOVA 问题的回归方法
- en: '[PRE22]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: What are you looking at? Because linear models require numeric predictors, when
    the `lm()` function encounters a factor, it replaces that factor with a set of
    numeric variables representing contrasts among the levels. If the factor has *k*
    levels, *k* – 1 contrast variables are created. R provides five built-in methods
    for creating these contrast variables (see table 9.3). You can also create your
    own (we won’t cover that here). By default, treatment contrasts are used for unordered
    factors, and orthogonal polynomials are used for ordered factors.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 你在看什么？因为线性模型需要数值预测变量，当 `lm()` 函数遇到因子时，它会用表示水平之间对比的数值变量集替换该因子。如果因子有 *k* 个水平，就会创建
    *k* - 1 个对比变量。R 提供了五种内置方法来创建这些对比变量（见表 9.3）。你也可以创建自己的（我们在这里不会介绍这一点）。默认情况下，对于无序因子使用处理对比，对于有序因子使用正交多项式。
- en: Table 9.3 Built-in contrasts
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 表 9.3 内置对比
- en: '| Contrast | Description |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| 对比 | 描述 |'
- en: '| `contr.helmert` | Contrasts the second level with the first, the third level
    with the average of the first two, the fourth level with the average of the first
    three, and so on. |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| `contr.helmert` | 将第二级与第一级对立，第三级与前两级平均值对立，第四级与前三级平均值对立，依此类推。|'
- en: '| `contr.poly` | Contrasts are used for trend analysis (linear, quadratic,
    cubic, and so on) based on orthogonal polynomials. Used for ordered factors with
    equally spaced levels. |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| `contr.poly` | 对立性用于基于正交多项式的趋势分析（线性、二次、三次等）。用于具有等距水平的有序因素。|'
- en: '| `contr.sum` | Contrasts are constrained to sum to zero. Also called *deviation
    contrasts*, they compare the mean of each level to the overall mean across levels.
    |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| `contr.sum` | 对立性被限制为总和为零。也称为*偏差对立性*，它们比较每个级别的平均值与所有级别的总体平均值。|'
- en: '| `contr.treatment` | Contrasts each level with the baseline level (first level
    by default). Also called *dummy coding.* |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| `contr.treatment` | 将每个水平与基线水平（默认为第一级）对立。也称为*虚拟编码*。|'
- en: '| `contr.SAS` | Similar to `contr.treatment`, but the baseline level is the
    last level. This produces coefficients similar to contrasts used in most SAS procedures.
    |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| `contr.SAS` | 与`contr.treatment`类似，但基线水平是最后一个水平。这会产生类似于大多数SAS过程所使用的对立性系数。|'
- en: 'With treatment contrasts, the first level of the factor becomes the reference
    group, and each subsequent level is compared with it. You can see the coding scheme
    via the `contrasts()` function:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在处理对立性中，因素的第一级成为参考组，每个后续级别都与它进行比较。您可以通过`contrasts()`函数查看编码方案：
- en: '[PRE23]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: If a patient is in the `drugD` condition, then the variable `drugD` equals 1,
    and the variables `2times`, `4times`, and `drugE` each equal zero. You don’t need
    a variable for the first group because a zero on each of the four indicator variables
    uniquely determines that the patient is in the `1times` condition.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 如果患者处于`drugD`状态，则变量`drugD`等于1，而变量`2times`、`4times`和`drugE`各自等于零。对于第一组，您不需要变量，因为四个指标变量中的每一个为零可以唯一确定患者处于`1times`状态。
- en: In listing 9.11, the variable `trt2times` represents a contrast between the
    levels `1time` and `2times`. Similarly, `trt4times` is a contrast between `1time`
    and `4times`, and so on. You can see from the probability values in the output
    that each drug condition is significantly different from the first (`1time`).
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 在列表9.11中，变量`trt2times`代表`1time`和`2times`级别之间的对立性。同样，`trt4times`是`1time`和`4times`之间的对立性，依此类推。您可以从输出中的概率值中看到，每种药物状态都与第一级（`1time`）有显著差异。
- en: You can change the default contrasts used in `lm()` by specifying a `contrasts`
    option. For example, you can specify Helmert contrasts by using
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过指定`contrasts`选项来更改`lm()`中使用的默认对立性。例如，您可以通过使用
- en: '[PRE24]'
  id: totrans-224
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: You can change the default contrasts used during an R session via the `options()`
    function. For example,
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过`options()`函数在R会话期间更改默认对立性。例如，
- en: '[PRE25]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: would set the default contrast for unordered factors to `contr.SAS` and for
    ordered factors to `contr.helmert`. Although we’ve limited our discussion to the
    use of contrasts in linear models, note that they’re applicable to other modeling
    functions in R. This includes the generalized linear models covered in chapter
    13.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 将无序因素的默认对立性设置为`contr.SAS`，有序因素设置为`contr.helmert`。尽管我们已将讨论限制在对线性模型中使用对立性的应用，但请注意，它们适用于R中的其他建模函数。这包括第13章中涵盖的广义线性模型。
- en: Summary
  id: totrans-228
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Analysis of variance (ANOVA) is a set of statistical methods frequently used
    when analyzing data from experimental and quasi-experimental research.
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 方差分析（ANOVA）是一组在分析实验和准实验研究数据时经常使用的统计方法。
- en: ANOVA methodologies are particularly helpful when investigating the relationship
    between a quantitative outcome variable and one or more categorical explanatory
    variables.
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ANOVA方法在研究定量结果变量与一个或多个分类解释变量之间的关系时特别有用。
- en: If a quantitative outcome variable is related to a categorical explanatory variable
    with *more than* two levels, post hoc tests are conducted to identify which levels/groups
    differ on that outcome.
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果定量结果变量与具有*多于*两个水平的分类解释变量相关，则进行事后检验以确定哪些水平/组在该结果上有所不同。
- en: When there are two or more categorical explanatory variables, a factorial ANOVA
    can be used to study their unique and joint effects on the outcome variable.
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当有两个或更多分类解释变量时，可以使用因子方差分析（ANOVA）来研究它们对结果变量的独特和联合影响。
- en: When the effects of one or more quantitative nuisance variables are statistically
    controlled (removed), the design is called an analysis of covariance (ANCOVA).
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当一个或多个定量干扰变量的影响在统计上得到控制（消除）时，这种设计被称为协方差分析（ANCOVA）。
- en: When there is more than one outcome variable, the design is called a multivariate
    analysis of variance or covariance.
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当存在多个结果变量时，这种设计被称为多元方差分析或协方差分析。
- en: ANOVA and multiple regression are two equivalent expressions of the general
    linear model. The different terminologies, R functions, and output formats for
    these two approaches reflect their separate origins in different fields of research.
    When studies focus on group differences, ANOVA results are often easier to understand
    and communicate to others.
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 方差分析（ANOVA）和多元回归是广义线性模型的两种等价表达。这两种方法的不同术语、R 函数和输出格式反映了它们在不同研究领域中各自独立的起源。当研究关注组间差异时，ANOVA
    的结果通常更容易理解和向他人传达。
