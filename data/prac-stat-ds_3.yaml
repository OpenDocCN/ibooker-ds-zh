- en: Chapter 3\. Statistical Experiments and Significance Testing
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第三章\. 统计实验和显著性测试
- en: Design of experiments is a cornerstone of the practice of statistics, with applications
    in virtually all areas of research. The goal is to design an experiment in order
    to confirm or reject a hypothesis. Data scientists often need to conduct continual
    experiments, particularly regarding user interface and product marketing. This
    chapter reviews traditional experimental design and discusses some common challenges
    in data science. It also covers some oft-cited concepts in statistical inference
    and explains their meaning and relevance (or lack of relevance) to data science.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 实验设计是统计实践的基石，几乎在所有研究领域都有应用。目标是设计一个实验来确认或拒绝一个假设。数据科学家经常需要进行连续的实验，特别是关于用户界面和产品营销的方面。本章回顾了传统实验设计，并讨论了数据科学中一些常见挑战。还涵盖了统计推断中一些经常引用的概念，并解释了它们在数据科学中的意义和相关性（或缺乏相关性）。
- en: Whenever you see references to statistical significance, t-tests, or p-values,
    it is typically in the context of the classical statistical inference “pipeline”
    (see [Figure 3-1](#fig0301)). This process starts with a hypothesis (“drug A is
    better than the existing standard drug,” or “price A is more profitable than the
    existing price B”). An experiment (it might be an A/B test) is designed to test
    the hypothesis—designed in such a way that it hopefully will deliver conclusive
    results. The data is collected and analyzed, and then a conclusion is drawn. The
    term *inference* reflects the intention to apply the experiment results, which
    involve a limited set of data, to a larger process or population.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 每当您看到关于统计显著性、t 检验或 p 值的引用时，通常是在经典统计推断“管道”（见[图 3-1](#fig0301)）的背景下。这个过程从一个假设开始（“药物
    A 比现有标准药物更好”，或者“价格 A 比现有价格 B 更有利可图”）。设计一个实验（可能是 A/B 测试）来检验这个假设——希望能够得出确切的结果。收集和分析数据，然后得出结论。术语
    *推断* 反映了意图，即将实验结果应用于更大的过程或群体，这涉及到一组有限的数据。
- en: '![images/Inference-pipeline.png](Images/psd2_0301.png)'
  id: totrans-3
  prefs: []
  type: TYPE_IMG
  zh: '![图片/Inference-pipeline.png](Images/psd2_0301.png)'
- en: Figure 3-1\. The classical statistical inference pipeline
  id: totrans-4
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-1\. 经典统计推断流程
- en: A/B Testing
  id: totrans-5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: A/B 测试
- en: An A/B test is an experiment with two groups to establish which of two treatments,
    products, procedures, or the like is superior. Often one of the two treatments
    is the standard existing treatment, or no treatment. If a standard (or no) treatment
    is used, it is called the *control*. A typical hypothesis is that a new treatment
    is better than the control.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: A/B 测试是一个有两个组的实验，用来确定两种处理、产品、程序或类似物中哪个更优越。通常其中一种处理是标准现有处理，或者没有处理。如果使用了标准（或没有）处理，则称为
    *对照组*。一个典型的假设是新处理比对照更好。
- en: 'A/B tests are common in web design and marketing, since results are so readily
    measured. Some examples of A/B testing include:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: A/B 测试在网页设计和营销中很常见，因为结果很容易衡量。一些 A/B 测试的例子包括：
- en: Testing two soil treatments to determine which produces better seed germination
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试两种土壤处理方法，以确定哪种产生更好的种子发芽
- en: Testing two therapies to determine which suppresses cancer more effectively
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试两种治疗方法，以确定哪种更有效抑制癌症
- en: Testing two prices to determine which yields more net profit
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试两个价格，以确定哪个产生更多净利润
- en: Testing two web headlines to determine which produces more clicks ([Figure 3-2](#fig0302))
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试两个网络标题，以确定哪一个能产生更多点击（[图 3-2](#fig0302)）
- en: Testing two web ads to determine which generates more conversions
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试两个网络广告，以确定哪个生成更多转化
- en: '![images/Web-test-A-B.png](Images/psd2_0302.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![图片/Web-test-A-B.png](Images/psd2_0302.png)'
- en: Figure 3-2\. Marketers continually test one web presentation against another
  id: totrans-14
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-2\. 营销人员持续测试一种网页展示与另一种的差异
- en: 'A proper A/B test has *subjects* that can be assigned to one treatment or another.
    The subject might be a person, a plant seed, a web visitor; the key is that the
    subject is exposed to the treatment. Ideally, subjects are *randomized* (assigned
    randomly) to treatments. In this way, you know that any difference between the
    treatment groups is due to one of two things:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 一个合适的 A/B 测试有 *实验对象* 可以分配到一个或另一个处理组中。实验对象可以是人、植物种子、网站访问者；关键是实验对象被暴露于处理中。理想情况下，实验对象是
    *随机分配* 到处理中。通过这种方式，您可以知道处理组之间的任何差异是由以下两种因素之一引起的：
- en: The effect of the different treatments
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不同治疗方法的效果
- en: Luck of the draw in which subjects are assigned to which treatments (i.e., the
    random assignment may have resulted in the naturally better-performing subjects
    being concentrated in A or B)
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分配给哪些治疗（即，随机分配可能导致自然表现更好的受试者集中在 A 或 B）
- en: 'You also need to pay attention to the *test statistic* or metric you use to
    compare group A to group B. Perhaps the most common metric in data science is
    a binary variable: click or no-click, buy or don’t buy, fraud or no fraud, and
    so on. Those results would be summed up in a 2×2 table. [Table 3-1](#two_by_two)
    is a 2×2 table for an actual price test (see [“Statistical Significance and p-Values”](#Significance)
    for further discussion of these results).'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 你还需要注意用于比较 A 组和 B 组的 *测试统计量* 或度量。在数据科学中，也许最常见的度量是二元变量：点击或不点击，购买或不购买，欺诈或非欺诈等。这些结果将总结在一个
    2×2 的表格中。[表格 3-1](#two_by_two) 是一个实际价格测试的 2×2 表格（有关这些结果的进一步讨论，请参阅[“统计显著性和 p 值”](#Significance)）。
- en: Table 3-1\. 2×2 table for ecommerce experiment results
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 表格 3-1\. 电子商务实验结果的 2×2 表格
- en: '| Outcome | Price A | Price B |'
  id: totrans-20
  prefs: []
  type: TYPE_TB
  zh: '| 结果 | 价格 A | 价格 B |'
- en: '| --- | --- | --- |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Conversion | 200 | 182 |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| 转化率 | 200 | 182 |'
- en: '| No conversion | 23,539 | 22,406 |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| 无转化 | 23,539 | 22,406 |'
- en: 'If the metric is a continuous variable (purchase amount, profit, etc.) or a
    count (e.g., days in hospital, pages visited), the result might be displayed differently.
    If one were interested not in conversion but in revenue per page view, the results
    of the price test in [Table 3-1](#two_by_two) might look like this in typical
    default software output:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 如果度量标准是连续变量（购买金额、利润等）或计数（例如住院天数、访问页面数），结果可能显示不同。如果我们关心的不是转化率而是每页浏览的收入，在 [表格
    3-1](#two_by_two) 中价格测试的结果在典型的默认软件输出中可能如下所示：
- en: 'Revenue/page view with price A: mean = 3.87, SD = 51.10'
  id: totrans-25
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用价格 A 的收入/页面浏览：平均 = 3.87，标准偏差 = 51.10
- en: ''
  id: totrans-26
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'Revenue/page view with price B: mean = 4.11, SD = 62.98'
  id: totrans-27
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 使用价格 B 的收入/页面浏览：平均 = 4.11，标准偏差 = 62.98
- en: “SD” refers to the standard deviation of the values within each group.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: “SD” 指的是每组内数值的标准偏差。
- en: Warning
  id: totrans-29
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 警告
- en: Just because statistical software—including *R* and *Python*—generates output
    by default does not mean that all the output is useful or relevant. You can see
    that the preceding standard deviations are not that useful; on their face they
    suggest that numerous values might be negative, when negative revenue is not feasible.
    This data consists of a small set of relatively high values (page views with conversions)
    and a huge number of 0-values (page views with no conversion). It is difficult
    to sum up the variability of such data with a single number, though the mean absolute
    deviation from the mean (7.68 for A and 8.15 for B) is more reasonable than the
    standard deviation.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 只因为统计软件（包括 *R* 和 *Python*）默认生成输出，并不意味着所有输出都是有用或相关的。你可以看到前述的标准偏差并不那么有用；它们表明，许多数值可能是负数，但负收入是不可行的。这些数据由一小部分相对较高的值（具有转化的页面浏览）和大量的零值（没有转化的页面浏览）组成。用一个单一数字总结这样的数据的变异性是困难的，虽然与平均绝对偏差（A
    组为 7.68，B 组为 8.15）相比，标准偏差更为合理。
- en: Why Have a Control Group?
  id: totrans-31
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为什么需要一个对照组？
- en: Why not skip the control group and just run an experiment applying the treatment
    of interest to only one group, and compare the outcome to prior experience?
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么不跳过对照组，只对一个组应用感兴趣的治疗，并将结果与先前的经验进行比较？
- en: Without a control group, there is no assurance that “all other things are equal”
    and that any difference is really due to the treatment (or to chance). When you
    have a control group, it is subject to the same conditions (except for the treatment
    of interest) as the treatment group. If you simply make a comparison to “baseline”
    or prior experience, other factors, besides the treatment, might differ.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 没有对照组，无法保证“其他所有条件相同”，任何差异是否真的是由于治疗（或偶然性）。当你有一个对照组时，它接受与治疗组相同的条件（除了感兴趣的治疗）。如果你只是与“基线”或先前的经验进行比较，除了治疗之外可能还有其他因素可能会不同。
- en: Blinding in studies
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 研究中的盲法
- en: A *blind study* is one in which the subjects are unaware of whether they are
    getting treatment A or treatment B. Awareness of receiving a particular treatment
    can affect response. A *double-blind* study is one in which the investigators
    and facilitators (e.g., doctors and nurses in a medical study) also are unaware
    which subjects are getting which treatment. Blinding is not possible when the
    nature of the treatment is transparent—for example, cognitive therapy from a computer
    versus a psychologist.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '*盲目研究*是指受试者不知道他们是否接受了治疗 A 或治疗 B。意识到接受了特定治疗可能会影响反应。*双盲*研究是指调查人员和协助者（例如医学研究中的医生和护士）也不知道哪些受试者接受了哪种治疗。当治疗性质透明时不可能进行盲法，例如从计算机与心理学家进行的认知治疗。'
- en: A/B testing in data science is typically used in a web context. Treatments might
    be the design of a web page, the price of a product, the wording of a headline,
    or some other item. Some thought is required to preserve the principles of randomization.
    Typically the subject in the experiment is the web visitor, and the outcomes we
    are interested in measuring are clicks, purchases, visit duration, number of pages
    visited, whether a particular page is visited, and the like. In a standard A/B
    experiment, you need to decide on one metric ahead of time. Multiple behavior
    metrics might be collected and be of interest, but if the experiment is expected
    to lead to a decision between treatment A and treatment B, a single metric, or
    *test statistic*, needs to be established beforehand. Selecting a test statistic
    *after* the experiment is conducted opens the door to researcher bias.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据科学中，A/B 测试通常用于网络环境。治疗可以是网页设计、产品价格、标题文字或其他项目。保持随机化原则需要一些思考。通常实验中的受试者是网站访客，我们感兴趣的结果包括点击、购买、访问时长、访问页面数量、是否访问特定页面等。在标准的
    A/B 实验中，需要提前决定一个度量标准。可以收集多种行为度量标准并感兴趣，但如果实验预期会在治疗 A 和治疗 B 之间做出决策，需要预先确定一个单一的度量标准或*检验统计量*。在实验之后选择检验统计量会导致研究人员偏见。
- en: Why Just A/B? Why Not C, D,…?
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为什么只是 A/B？为什么不是 C、D……？
- en: A/B tests are popular in the marketing and ecommerce worlds, but are far from
    the only type of statistical experiment. Additional treatments can be included.
    Subjects might have repeated measurements taken. Pharmaceutical trials where subjects
    are scarce, expensive, and acquired over time are sometimes designed with multiple
    opportunities to stop the experiment and reach a conclusion.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: A/B 测试在营销和电子商务领域很受欢迎，但远非唯一的统计实验类型。可以包括其他治疗方式。受试者可能会重复测量。在药物试验中，由于受试者稀缺、昂贵且随时间获得，有时会设计多次机会停止实验并得出结论。
- en: 'Traditional statistical experimental designs focus on answering a static question
    about the efficacy of specified treatments. Data scientists are less interested
    in the question:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 传统的统计实验设计专注于回答关于特定治疗效果的静态问题。数据科学家对以下问题不太感兴趣：
- en: Is the difference between price A and price B statistically significant?
  id: totrans-40
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 价格 A 和价格 B 之间的差异在统计上是否显著？
- en: 'than in the question:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 而对以下问题感兴趣：
- en: Which, out of multiple possible prices, is best?
  id: totrans-42
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 在多个可能的价格中，哪一个是最好的？
- en: 'For this, a relatively new type of experimental design is used: the *multi-arm
    bandit* (see [“Multi-Arm Bandit Algorithm”](#bandits)).'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 为此，使用了一种相对较新的实验设计类型：*多臂老虎机*（参见[“多臂老虎机算法”](#bandits)）。
- en: Getting Permission
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 获取许可
- en: In scientific and medical research involving human subjects, it is typically
    necessary to get their permission, as well as obtain the approval of an institutional
    review board. Experiments in business that are done as a part of ongoing operations
    almost never do this. In most cases (e.g., pricing experiments, or experiments
    about which headline to show or which offer should be made), this practice is
    widely accepted. Facebook, however, ran afoul of this general acceptance in 2014
    when it experimented with the emotional tone in users’ newsfeeds. Facebook used
    sentiment analysis to classify newsfeed posts as positive or negative, and then
    altered the positive/negative balance in what it showed users. Some randomly selected
    users experienced more positive posts, while others experienced more negative
    posts. Facebook found that the users who experienced a more positive newsfeed
    were more likely to post positively themselves, and vice versa. The magnitude
    of the effect was small, however, and Facebook faced much criticism for conducting
    the experiment without users’ knowledge. Some users speculated that Facebook might
    have pushed some extremely depressed users over the edge if they got the negative
    version of their feed.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在涉及人类主体的科学和医学研究中，通常需要得到他们的许可，并获得机构审查委员会的批准。作为运营的一部分进行的业务实验几乎从不这样做。在大多数情况下（例如，定价实验或关于显示哪个标题或提供哪个优惠的实验），这种做法被广泛接受。然而，Facebook在2014年却违反了这种普遍接受的实验规范，当时它对用户的新闻提要进行了情感色彩的实验。Facebook使用情感分析将新闻提要帖子分类为积极或消极，并改变显示给用户的积极/消极平衡。随机选择的用户中有些体验到更多积极的帖子，而其他人体验到更多消极的帖子。Facebook发现，体验到更积极的新闻提要的用户更有可能自己积极发帖，反之亦然。然而，效果的幅度很小，Facebook因未经用户同意进行实验而受到了很多批评。有些用户推测，如果他们得到了消极版本的提要，Facebook可能会把一些极度沮丧的用户推向绝望的边缘。
- en: Further Reading
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Two-group comparisons (A/B tests) are a staple of traditional statistics, and
    just about any introductory statistics text will have extensive coverage of design
    principles and inference procedures. For a discussion that places A/B tests in
    more of a data science context and uses resampling, see *Introductory Statistics
    and Analytics: A Resampling Perspective* by Peter Bruce (Wiley, 2014).'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '两组比较（A/B测试）是传统统计学的基础，并且任何介绍性统计学文本都会广泛涵盖设计原则和推断过程。要在更多的数据科学背景中讨论A/B测试并使用重采样，请参阅彼得·布鲁斯（Wiley，2014年）的*Introductory
    Statistics and Analytics: A Resampling Perspective*。'
- en: For web testing, the logistical aspects of testing can be just as challenging
    as the statistical ones. A good place to start is the [Google Analytics help section
    on experiments](https://oreil.ly/mAbqF).
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于网页测试来说，测试的后勤方面与统计方面一样具有挑战性。一个好的起点是查看[Google Analytics关于实验的帮助部分](https://oreil.ly/mAbqF)。
- en: 'Beware advice found in the ubiquitous guides to A/B testing that you see on
    the web, such as these words in one such guide: “Wait for about 1,000 total visitors
    and make sure you run the test for a week.” Such general rules of thumb are not
    statistically meaningful; see [“Power and Sample Size”](#PowerSampleSize) for
    more detail.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要注意在网上看到的关于A/B测试的无处不在的指南中的建议，比如在其中一个指南中提到的这些话：“等待大约1,000名访客并确保您运行测试一周。”这些一般的经验法则在统计上并没有意义；更多细节请参见[“功效和样本大小”](#PowerSampleSize)。
- en: Hypothesis Tests
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 假设检验
- en: Hypothesis tests, also called *significance tests*, are ubiquitous in the traditional
    statistical analysis of published research. Their purpose is to help you learn
    whether random chance might be responsible for an observed effect.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验，也称为*显著性检验*，在传统的已发表研究的统计分析中无处不在。它们的目的是帮助你了解观察到的效应是否可能是由随机机会造成的。
- en: An A/B test (see [“A/B Testing”](#A-B-test)) is typically constructed with a
    hypothesis in mind. For example, the hypothesis might be that price B produces
    higher profit. Why do we need a hypothesis? Why not just look at the outcome of
    the experiment and go with whichever treatment does better?
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: A/B测试（见[“A/B测试”](#A-B-test)）通常在构建假设时构建。例如，假设可能是B价格能带来更高的利润。为什么我们需要一个假设？为什么不只看实验的结果然后选择表现更好的治疗方法？
- en: The answer lies in the tendency of the human mind to underestimate the scope
    of natural random behavior. One manifestation of this is the failure to anticipate
    extreme events, or so-called “black swans” (see [“Long-Tailed Distributions”](ch02.xhtml#LongTailedData)).
    Another manifestation is the tendency to misinterpret random events as having
    patterns of some significance. Statistical hypothesis testing was invented as
    a way to protect researchers from being fooled by random chance.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 答案在于人类大脑倾向于低估自然随机行为的范围。其中一种表现是未能预测极端事件，或所谓的“黑天鹅”（见[“长尾分布”](ch02.xhtml#LongTailedData)）。另一种表现是倾向于错误地将随机事件解释为具有某种意义的模式。统计假设检验的发明是为了防止研究人员被随机事件愚弄。
- en: 'In a properly designed A/B test, you collect data on treatments A and B in
    such a way that any observed difference between A and B must be due to either:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在一个设计良好的A/B测试中，您以这样一种方式收集A和B的治疗数据，使得A和B之间的任何观察到的差异必须要么是：
- en: Random chance in assignment of subjects
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主观分配中的随机机会
- en: A true difference between A and B
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: A和B之间的真实差异
- en: A statistical hypothesis test is further analysis of an A/B test, or any randomized
    experiment, to assess whether random chance is a reasonable explanation for the
    observed difference between groups A and B.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 统计假设检验是对A/B测试或任何随机实验的进一步分析，以评估随机机会是否可以合理解释观察到的A组和B组之间的差异。
- en: The Null Hypothesis
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**零假设**'
- en: 'Hypothesis tests use the following logic: “Given the human tendency to react
    to unusual but random behavior and interpret it as something meaningful and real,
    in our experiments we will require proof that the difference between groups is
    more extreme than what chance might reasonably produce.” This involves a baseline
    assumption that the treatments are equivalent, and any difference between the
    groups is due to chance. This baseline assumption is termed the *null hypothesis*.
    Our hope, then, is that we can in fact prove the null hypothesis *wrong* and show
    that the outcomes for groups A and B are more different than what chance might
    produce.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验使用以下逻辑：“鉴于人类倾向于对异常但随机的行为做出反应并将其解释为某种有意义和真实的东西，在我们的实验中，我们将需要证明组别间的差异比随机机会可能产生的更为极端。”
    这涉及一个基准假设，即治疗方法是等效的，任何组别之间的差异是由于偶然产生的。这个基准假设称为*零假设*。因此，我们的希望是，我们实际上可以证明零假设是*错误的*，并展示A组和B组的结果比随机机会产生的更为不同。
- en: One way to do this is via a resampling permutation procedure, in which we shuffle
    together the results from groups A and B and then repeatedly deal out the data
    in groups of similar sizes, and then observe how often we get a difference as
    extreme as the observed difference. The combined shuffled results from groups
    A and B, and the procedure of resampling from them, embodies the null hypothesis
    of groups A and B being equivalent and interchangeable and is termed the null
    model. See [“Resampling”](#Resampling) for more detail.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一种方法是通过重新抽样置换过程，将A组和B组的结果混合在一起，然后重复地将数据以类似大小的组合发放，并观察我们获得的极端差异频率有多少次与观察到的差异一样极端。从A组和B组的组合洗牌结果以及从中重新抽样的过程，体现了A组和B组等效和可互换的零模型，称为零假设。详见[“重新抽样”](#Resampling)。
- en: Alternative Hypothesis
  id: totrans-61
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '**替代假设**'
- en: 'Hypothesis tests by their nature involve not just a null hypothesis but also
    an offsetting alternative hypothesis. Here are some examples:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 假设检验的性质涉及不仅是零假设而且还有一个对立假设的抵消。以下是一些例子：
- en: Null = “no difference between the means of group A and group B”; alternative
    = “A is different from B” (could be bigger or smaller)
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 零假设 = “A组和B组的平均数之间没有差异”; 替代 = “A与B不同”（可能更大或更小）
- en: Null = “A <math alttext="less-than-or-equal-to"><mo>≤</mo></math> B”; alternative
    = “A > B”
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 零假设 = “A <math alttext="less-than-or-equal-to"><mo>≤</mo></math> B”; 替代 = “A
    > B”
- en: Null = “B is not X% greater than A”; alternative = “B is X% greater than A”
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 零假设 = “B不是比A大X%”; 替代 = “B比A大X%”
- en: Taken together, the null and alternative hypotheses must account for all possibilities.
    The nature of the null hypothesis determines the structure of the hypothesis test.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 总结起来，零假设和替代假设必须解释所有可能性。零假设的性质决定了假设检验的结构。
- en: One-Way Versus Two-Way Hypothesis Tests
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 单边与双边假设检验
- en: Often in an A/B test, you are testing a new option (say, B) against an established
    default option (A), and the presumption is that you will stick with the default
    option unless the new option proves itself definitively better. In such a case,
    you want a hypothesis test to protect you from being fooled by chance in the direction
    favoring B. You don’t care about being fooled by chance in the other direction,
    because you would be sticking with A unless B proves definitively better. So you
    want a *directional* alternative hypothesis (B is better than A). In such a case,
    you use a *one-way* (or one-tail) hypothesis test. This means that extreme chance
    results in only one direction count toward the p-value.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在 A/B 测试中经常会测试一个新选项（比如 B）与已建立的默认选项（A）相比，假设是你将坚持使用默认选项，除非新选项明显更好。在这种情况下，你希望通过假设检验避免被偶然误导，而且是在有利于
    B 的方向上。你不关心在其他方向上被偶然误导，因为除非 B 明显更好，否则你将坚持使用 A。因此，你需要一个 *单向*（或单尾）假设检验。这意味着极端偶然结果只在一个方向上计入
    p 值。
- en: If you want a hypothesis test to protect you from being fooled by chance in
    either direction, the alternative hypothesis is *bidirectional* (A is different
    from B; could be bigger or smaller). In such a case, you use a *two-way* (or two-tail)
    hypothesis. This means that extreme chance results in either direction count toward
    the p-value.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你希望通过假设检验避免被任何方向的偶然误导，替代假设是 *双向* 的（A 与 B 不同；可能更大或更小）。在这种情况下，你使用 *双向*（或双尾）假设。这意味着极端偶然结果在任何方向上都计入
    p 值。
- en: A one-tail hypothesis test often fits the nature of A/B decision making, in
    which a decision is required and one option is typically assigned “default” status
    unless the other proves better. Software, however, including *R* and `scipy` in
    *Python*, typically provides a two-tail test in its default output, and many statisticians
    opt for the more conservative two-tail test just to avoid argument. One-tail versus
    two-tail is a confusing subject, and not that relevant for data science, where
    the precision of p-value calculations is not terribly important.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 单尾假设检验通常适合 A/B 决策，其中需要做出决策，并且一种选项通常被指定为“默认”状态，除非另一种证明更好。然而，包括 *R* 和 *Python*
    中的 `scipy` 在内的软件通常以其默认输出提供双尾检验，许多统计学家选择更保守的双尾检验，只是为了避免争论。单尾与双尾是一个令人困惑的主题，在数据科学中并不那么重要，因为
    p 值计算的精度并不是非常重要。
- en: Further Reading
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*The Drunkard’s Walk* by Leonard Mlodinow (Pantheon, 2008) is a readable survey
    of the ways in which “randomness rules our lives.”'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 莱昂纳德·姆洛迪诺（Leonard Mlodinow）著 *The Drunkard’s Walk*（Pantheon，2008）是一本可读的调查，介绍了“随机性如何主宰我们的生活”。
- en: David Freedman, Robert Pisani, and Roger Purves’s classic statistics text *Statistics*,
    4th ed. (W. W. Norton, 2007), has excellent nonmathematical treatments of most
    statistics topics, including hypothesis testing.
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大卫·弗里德曼（David Freedman）、罗伯特·皮萨尼（Robert Pisani）和罗杰·珀维斯（Roger Purves）的经典统计学文本
    *Statistics*，第四版（W. W. Norton，2007），对大多数统计学主题进行了出色的非数学处理，包括假设检验。
- en: '*Introductory Statistics and Analytics: A Resampling Perspective* by Peter
    Bruce (Wiley, 2014) develops hypothesis testing concepts using resampling.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '彼得·布鲁斯（Peter Bruce）著 *Introductory Statistics and Analytics: A Resampling Perspective*（Wiley，2014）利用重采样开发了假设检验概念。'
- en: Resampling
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Resampling
- en: '*Resampling* in statistics means to repeatedly sample values from observed
    data, with a general goal of assessing random variability in a statistic. It can
    also be used to assess and improve the accuracy of some machine-learning models
    (e.g., the predictions from decision tree models built on multiple bootstrapped
    data sets can be averaged in a process known as *bagging*—see [“Bagging and the
    Random Forest”](ch06.xhtml#Bagging)).'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计学中，*重采样* 意味着从观察到的数据中重复抽样值，其一般目标是评估统计量的随机变异性。它还可用于评估和改进某些机器学习模型的准确性（例如，基于多个自举数据集构建的决策树模型的预测可以平均化，这个过程被称为
    *bagging* — 见 [“Bagging and the Random Forest”](ch06.xhtml#Bagging)）。
- en: 'There are two main types of resampling procedures: the *bootstrap* and *permutation*
    tests. The bootstrap is used to assess the reliability of an estimate; it was
    discussed in the previous chapter (see [“The Bootstrap”](ch02.xhtml#bootstrap)).
    Permutation tests are used to test hypotheses, typically involving two or more
    groups, and we discuss those in this section.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种主要的重采样程序：*bootstrap* 和 *permutation* 测试。Bootstrap 用于评估估计量的可靠性；它在前一章已经讨论过（见
    [“The Bootstrap”](ch02.xhtml#bootstrap)）。Permutation tests 用于测试假设，通常涉及两个或更多组，我们在本节中讨论这些内容。
- en: Permutation Test
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Permutation Test
- en: 'In a *permutation* procedure, two or more samples are involved, typically the
    groups in an A/B or other hypothesis test. *Permute* means to change the order
    of a set of values. The first step in a *permutation test* of a hypothesis is
    to combine the results from groups A and B (and, if used, C, D,…). This is the
    logical embodiment of the null hypothesis that the treatments to which the groups
    were exposed do not differ. We then test that hypothesis by randomly drawing groups
    from this combined set and seeing how much they differ from one another. The permutation
    procedure is as follows:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '*置换*过程中涉及两个或更多样本，通常是A/B或其他假设检验中的组。*置换*意味着改变一组值的顺序。假设检验中的*置换检验*的第一步是将A组和B组（如果有的话，还有C、D等）的结果结合起来。这体现了空假设的逻辑实现，即暴露于组的处理方式没有差异。然后我们通过从这个结合集中随机抽取组来测试这个假设，看看它们之间有多大差异。*置换*过程如下所示：'
- en: Combine the results from the different groups into a single data set.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将不同组的结果合并成一个数据集。
- en: Shuffle the combined data and then randomly draw (without replacement) a resample
    of the same size as group A (clearly it will contain some data from the other
    groups).
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 洗牌组合数据，然后随机抽取（不替换）与A组大小相同的重新采样（显然它会包含来自其他组的一些数据）。
- en: From the remaining data, randomly draw (without replacement) a resample of the
    same size as group B.
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从剩余数据中随机抽取（不替换）与B组大小相同的重新采样。
- en: Do the same for groups C, D, and so on. You have now collected one set of resamples
    that mirror the sizes of the original samples.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对C、D等组做同样的操作。现在你已经收集到了一组与原始样本大小相匹配的重新采样。
- en: Whatever statistic or estimate was calculated for the original samples (e.g.,
    difference in group proportions), calculate it now for the resamples, and record;
    this constitutes one permutation iteration.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对原始样本计算的任何统计量或估计值（例如，组间比例的差异），现在对重新采样计算，并记录；这构成一个置换迭代。
- en: Repeat the previous steps *R* times to yield a permutation distribution of the
    test statistic.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复前面的步骤*R*次，以获得检验统计量的置换分布。
- en: Now go back to the observed difference between groups and compare it to the
    set of permuted differences. If the observed difference lies well within the set
    of permuted differences, then we have not proven anything—the observed difference
    is within the range of what chance might produce. However, if the observed difference
    lies outside most of the permutation distribution, then we conclude that chance
    is *not* responsible. In technical terms, the difference is *statistically significant*.
    (See [“Statistical Significance and p-Values”](#Significance).)
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 现在回到组间的观察差异，并将其与置换差异集合进行比较。如果观察到的差异远远落在置换差异集合之内，那么我们没有证明任何事情——观察到的差异在偶然产生的范围内。然而，如果观察到的差异大部分位于置换分布之外，则我们得出结论偶然不是*负责*的。在技术术语中，差异是*统计显著*的。（见[“统计显著性和p-值”](#Significance)。）
- en: 'Example: Web Stickiness'
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 例如：网站粘性
- en: A company selling a relatively high-value service wants to test which of two
    web presentations does a better selling job. Due to the high value of the service
    being sold, sales are infrequent and the sales cycle is lengthy; it would take
    too long to accumulate enough sales to know which presentation is superior. So
    the company decides to measure the results with a proxy variable, using the detailed
    interior page that describes the service.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 一家销售相对高价值服务的公司想要测试两种网页展示中哪种更能促成销售。由于所售服务价值高，销售频率低且销售周期长；累积足够的销售量来判断哪种展示更胜一筹需要太长时间。因此，该公司决定使用代理变量来衡量结果，使用详细的介绍服务的内页作为代理变量。
- en: Tip
  id: totrans-89
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 提示
- en: A *proxy* variable is one that stands in for the true variable of interest,
    which may be unavailable, too costly, or too time-consuming to measure. In climate
    research, for example, the oxygen content of ancient ice cores is used as a proxy
    for temperature. It is useful to have at least *some* data on the true variable
    of interest, so the strength of its association with the proxy can be assessed.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '*代理*变量是代表真正感兴趣的变量的变量，该变量可能无法获取、成本过高或者测量时间过长。例如，在气候研究中，古冰芯的氧含量被用作温度的代理。至少对真正感兴趣的变量有*一些*数据是有用的，这样就可以评估它与代理的关联强度。'
- en: One potential proxy variable for our company is the number of clicks on the
    detailed landing page. A better one is how long people spend on the page. It is
    reasonable to think that a web presentation (page) that holds people’s attention
    longer will lead to more sales. Hence, our metric is average session time, comparing
    page A to page B.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 我们公司的一个潜在代理变量是详细落地页上的点击次数。更好的一个代理变量是人们在页面上花费的时间。合理地认为，一个能吸引人们注意力更长时间的网页会导致更多的销售。因此，我们的度量标准是平均会话时间，比较页面
    A 和页面 B。
- en: 'Due to the fact that this is an interior, special-purpose page, it does not
    receive a huge number of visitors. Also note that Google Analytics, which is how
    we measure session time, cannot measure session time for the last session a person
    visits. Instead of deleting that session from the data, though, Google Analytics
    records it as a zero, so the data requires additional processing to remove those
    sessions. The result is a total of 36 sessions for the two different presentations,
    21 for page A and 15 for page B. Using `ggplot`, we can visually compare the session
    times using side-by-side boxplots:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这是一个内部、专用页面，访问者数量不多。还要注意的是，我们使用的 Google Analytics 无法测量一个人的最后一次会话时间。而不是将该会话从数据中删除，Google
    Analytics 将其记录为零，因此需要额外的处理来删除这些会话。结果是两种不同演示的总共 36 个会话，其中页面 A 有 21 个，页面 B 有 15
    个。使用 `ggplot`，我们可以通过并排箱线图直观比较会话时间：
- en: '[PRE0]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The `pandas` `boxplot` command uses the keyword argument `by` to create the
    figure:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: '`pandas` 的 `boxplot` 命令使用关键字参数 `by` 来创建图像：'
- en: '[PRE1]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The boxplot, shown in [Figure 3-3](#SessionTimesBoxplot), indicates that page
    B leads to longer sessions than page A. The means for each group can be computed
    in *R* as follows:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 箱线图，显示在 [图 3-3](#SessionTimesBoxplot) 中，表明页面 B 的会话时间比页面 A 长。每组的均值可以在 *R* 中如下计算：
- en: '[PRE2]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'In *Python*, we filter the `pandas` data frame first by page and then determine
    the mean of the `Time` column:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *Python* 中，我们首先通过页面筛选 `pandas` 数据帧，然后确定 `Time` 列的平均值：
- en: '[PRE3]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Page B has session times that are greater than those of page A by 35.67 seconds,
    on average. The question is whether this difference is within the range of what
    random chance might produce, i.e., is statistically significant. One way to answer
    this is to apply a permutation test—combine all the session times together and
    then repeatedly shuffle and divide them into groups of 21 (recall that <math alttext="n
    Subscript upper A Baseline equals 21"><mrow><msub><mi>n</mi> <mi>A</mi></msub>
    <mo>=</mo> <mn>21</mn></mrow></math> for page A) and 15 ( <math alttext="n Subscript
    upper B Baseline equals 15"><mrow><msub><mi>n</mi> <mi>B</mi></msub> <mo>=</mo>
    <mn>15</mn></mrow></math> for page B).
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 页面 B 的会话时间比页面 A 的平均多出 35.67 秒。问题是这种差异是否在随机机会可能产生的范围内，即是否具有统计学意义。一个回答这个问题的方法是应用置换检验——将所有会话时间合并然后重复随机洗牌并分成
    21 组（回想一下 <math alttext="n Subscript upper A Baseline equals 21"><mrow><msub><mi>n</mi>
    <mi>A</mi></msub> <mo>=</mo> <mn>21</mn></mrow></math> 代表页面 A）和 15 组（ <math alttext="n
    Subscript upper B Baseline equals 15"><mrow><msub><mi>n</mi> <mi>B</mi></msub>
    <mo>=</mo> <mn>15</mn></mrow></math> 代表页面 B）。
- en: 'To apply a permutation test, we need a function to randomly assign the 36 session
    times to a group of 21 (page A) and a group of 15 (page B). The *R* version of
    this function is:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 要应用置换检验，我们需要一个函数将这 36 个会话时间随机分配给 21 个（页面 A）和 15 个（页面 B）的组。这个函数的 *R* 版本如下：
- en: '[PRE4]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The *Python* version of this permutation test is the following:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 进行这种置换检验的 *Python* 版本如下：
- en: '[PRE5]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![Session times for different presentations of a web page.](Images/psd2_0303.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![不同网页演示的会话时间。](Images/psd2_0303.png)'
- en: Figure 3-3\. Session times for web pages A and B
  id: totrans-106
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-3\. 网页 A 和 B 的会话时间
- en: 'This function works by sampling (without replacement) <math alttext="n Subscript
    upper B"><msub><mi>n</mi> <mi>B</mi></msub></math> indices and assigning them
    to the B group; the remaining <math alttext="n Subscript upper A"><msub><mi>n</mi>
    <mi>A</mi></msub></math> indices are assigned to group A. The difference between
    the two means is returned. Calling this function *R* = 1,000 times and specifying
    <math alttext="n Subscript upper A Baseline equals 21"><mrow><msub><mi>n</mi>
    <mi>A</mi></msub> <mo>=</mo> <mn>21</mn></mrow></math> and <math alttext="n Subscript
    upper B Baseline equals 15"><mrow><msub><mi>n</mi> <mi>B</mi></msub> <mo>=</mo>
    <mn>15</mn></mrow></math> leads to a distribution of differences in the session
    times that can be plotted as a histogram. In *R* this is done as follows using
    the `hist` function:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 此函数通过抽样（不替换）<math alttext="n Subscript upper B"><msub><mi>n</mi> <mi>B</mi></msub></math>
    索引，并将它们分配给 B 组；剩余的 <math alttext="n Subscript upper A"><msub><mi>n</mi> <mi>A</mi></msub></math>
    索引被分配给 A 组。返回两个均值之间的差异。将此函数调用 *R* = 1,000 次，并指定 <math alttext="n Subscript upper
    A Baseline equals 21"><mrow><msub><mi>n</mi> <mi>A</mi></msub> <mo>=</mo> <mn>21</mn></mrow></math>
    和 <math alttext="n Subscript upper B Baseline equals 15"><mrow><msub><mi>n</mi>
    <mi>B</mi></msub> <mo>=</mo> <mn>15</mn></mrow></math>，得到会话时间差异的分布，可以绘制成直方图。在*R*中，使用`hist`函数可以这样做：
- en: '[PRE6]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'In *Python*, we can create a similar graph using `matplotlib`:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在*Python*中，我们可以使用`matplotlib`创建一个类似的图形：
- en: '[PRE7]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'The histogram, in [Figure 3-4](#SessionTimesPerm) shows that mean difference
    of random permutations often exceeds the observed difference in session times
    (the vertical line). For our results, this happens in 12.6% of the cases:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 直方图在[图 3-4](#SessionTimesPerm) 中显示，随机排列的平均差异经常超过会话时间的观察差异（垂直线）。对于我们的结果，这种情况发生在
    12.6% 的情况下：
- en: '[PRE8]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'As the simulation uses random numbers, the percentage will vary. For example,
    in the *Python* version, we got 12.1%:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 由于模拟使用随机数，所以百分比会有所变化。例如，在*Python*版本中，我们得到了 12.1%：
- en: '[PRE9]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: This suggests that the observed difference in session time between page A and
    page B is well within the range of chance variation and thus is not statistically
    significant.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这表明，页面 A 和页面 B 之间会话时间的观察差异很大程度上在偶然变异范围内，因此在统计学上并不显著。
- en: '![Histogram of the difference in session times from the permutation procedure.](Images/psd2_0304.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![排列过程中会话时间差异的直方图。](Images/psd2_0304.png)'
- en: Figure 3-4\. Frequency distribution for session time differences between pages
    A and B; the vertical line shows the observed difference
  id: totrans-117
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-4\. 页面 A 和页面 B 之间会话时间差异的频率分布；垂直线显示了观察差异
- en: Exhaustive and Bootstrap Permutation Tests
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 详尽排列和自助法排列测试
- en: 'In addition to the preceding random shuffling procedure, also called a *random
    permutation test* or a *randomization test*, there are two variants of the permutation
    test:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 除了前面提到的随机洗牌过程，也称为*随机排列测试*或*随机化测试*，排列测试还有两个变体：
- en: An *exhaustive permutation test*
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个*详尽排列测试*
- en: A *bootstrap permutation test*
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个*自助法排列测试*
- en: In an exhaustive permutation test, instead of just randomly shuffling and dividing
    the data, we actually figure out all the possible ways it could be divided. This
    is practical only for relatively small sample sizes. With a large number of repeated
    shufflings, the random permutation test results approximate those of the exhaustive
    permutation test, and approach them in the limit. Exhaustive permutation tests
    are also sometimes called *exact tests*, due to their statistical property of
    guaranteeing that the null model will not test as “significant” more than the
    alpha level of the test (see [“Statistical Significance and p-Values”](#Significance)).
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在详尽的排列测试中，我们不仅仅是随机洗牌和分割数据，而是找出所有可能的分割方式。这只适用于相对较小的样本量。通过大量重复的洗牌次数，随机排列测试的结果逼近详尽排列测试的结果，并在极限情况下逼近它们。详尽排列测试有时也被称为*精确测试*，因为它们具有保证空模型不会测试为“显著”超过测试的
    alpha 水平的统计特性（参见[“统计显著性和 p-值”](#Significance)）。
- en: In a bootstrap permutation test, the draws outlined in steps 2 and 3 of the
    random permutation test are made *with replacement* instead of without replacement.
    In this way the resampling procedure models not just the random element in the
    assignment of treatment to subject but also the random element in the selection
    of subjects from a population. Both procedures are encountered in statistics,
    and the distinction between them is somewhat convoluted and not of consequence
    in the practice of data science.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在自助重排置换检验中，步骤2和3中所述的抽样是*有放回地*进行的，而不是无放回地进行的。这样一来，重新抽样过程不仅模拟了将处理分配给受试者中的随机元素，还模拟了从总体中选择受试者的随机元素。统计学中遇到了这两种过程，它们之间的区别有些复杂，但在数据科学的实践中并不重要。
- en: 'Permutation Tests: The Bottom Line for Data Science'
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 置换检验：数据科学的底线
- en: Permutation tests are useful heuristic procedures for exploring the role of
    random variation. They are relatively easy to code, interpret, and explain, and
    they offer a useful detour around the formalism and “false determinism” of formula-based
    statistics, in which the precision of formula “answers” tends to imply unwarranted
    certainty.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 置换检验是探索随机变化作用的有用启发式程序。它们相对容易编码、解释和解释，并且它们为绕过基于公式的统计学形式主义和“虚假决定论”提供了一个有用的绕道，公式“答案”的精确性往往暗示了不必要的确定性。
- en: One virtue of resampling, in contrast to formula approaches, is that it comes
    much closer to a one-size-fits-all approach to inference. Data can be numeric
    or binary. Sample sizes can be the same or different. Assumptions about normally
    distributed data are not needed.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 与公式方法相比，重抽样的一个优点是更接近推断的一刀切方法。数据可以是数值型或二元的。样本大小可以相同也可以不同。不需要假设数据正态分布。
- en: Further Reading
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Randomization Tests*, 4th ed., by Eugene Edgington and Patrick Onghena (Chapman
    & Hall/CRC Press, 2007)—but don’t get too drawn into the thicket of nonrandom
    sampling'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《随机化检验》，第4版，尤金·埃奇顿和帕特里克·昂海纳*（Chapman & Hall/CRC Press，2007年）—但不要太过于深入非随机抽样的林莽之中'
- en: '*Introductory Statistics and Analytics: A Resampling Perspective* by Peter
    Bruce (Wiley, 2014)'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《入门统计与分析：重抽样视角》* 彼得·布鲁斯（Wiley，2014年）'
- en: Statistical Significance and p-Values
  id: totrans-130
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 统计显著性和p值
- en: Statistical significance is how statisticians measure whether an experiment
    (or even a study of existing data) yields a result more extreme than what chance
    might produce. If the result is beyond the realm of chance variation, it is said
    to be statistically significant.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 统计显著性是统计学家衡量实验（甚至是对现有数据进行研究）是否产生了比偶然性更极端结果的方法。如果结果超出了偶然变异的范围，就说具有统计显著性。
- en: Consider in [Table 3-2](#dataframe2) the results of the web test shown earlier.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑在[表3-2](#dataframe2)中早期显示的网络测试结果。
- en: Table 3-2\. 2×2 table for ecommerce experiment results
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 表3-2\. 电子商务实验结果的2×2表
- en: '| Outcome | Price A | Price B |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| 结果 | 价格 A | 价格 B |'
- en: '| --- | --- | --- |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Conversion | 200 | 182 |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| 转化 | 200 | 182 |'
- en: '| No conversion | 23,539 | 22,406 |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 不进行转换 | 23,539 | 22,406 |'
- en: Price A converts almost 5% better than price B (0.8425% = 200/(23539+200)*100,
    versus 0.8057% = 182/(22406+182)*100—a difference of 0.0368 percentage points),
    big enough to be meaningful in a high-volume business. We have over 45,000 data
    points here, and it is tempting to consider this as “big data,” not requiring
    tests of statistical significance (needed mainly to account for sampling variability
    in small samples). However, the conversion rates are so low (less than 1%) that
    the actual meaningful values—the conversions—are only in the 100s, and the sample
    size needed is really determined by these conversions. We can test whether the
    difference in conversions between prices A and B is within the range of *chance
    variation*, using a resampling procedure. By chance variation, we mean the random
    variation produced by a probability model that embodies the null hypothesis that
    there is no difference between the rates (see [“The Null Hypothesis”](#Null_hypothesis)).
    The following permutation procedure asks, “If the two prices share the same conversion
    rate, could chance variation produce a difference as big as 5%?”
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 价格 A 的转化率几乎比价格 B 高出 5%（0.8425% = 200/(23539+200)*100，相对于 0.8057% = 182/(22406+182)*100——相差
    0.0368 个百分点），这在高流量业务中是有意义的。我们这里有超过 45,000 个数据点，很容易将其视为“大数据”，不需要进行统计显著性测试（主要是为了考虑样本量小的采样变异性）。然而，转化率如此之低（不到
    1%），以至于实际的有意义值——转化率——仅在 100 多个，而所需的样本量实际上是由这些转化决定的。我们可以通过重新采样程序测试价格 A 和价格 B 之间的转化率差异是否在
    *偶然变化* 范围内。通过偶然变化，我们指的是由一个概率模型产生的随机变化，该模型体现了零假设，即两个速率之间没有差异（参见[“零假设”](#Null_hypothesis)）。以下排列程序询问：“如果两个价格共享相同的转化率，偶然变化能否产生与
    5% 一样大的差异？”
- en: 'Put cards labeled 1 and 0 in a box: this represents the supposed shared conversion
    rate of 382 ones and 45,945 zeros = 0.008246 = 0.8246%.'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将标有 1 和 0 的卡片放入盒子中：这表示了 382 个 1 和 45,945 个 0 的假设共享转化率 = 0.008246 = 0.8246%。
- en: Shuffle and draw out a resample of size 23,739 (same *n* as price A), and record
    how many 1s.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 洗牌并从中抽出大小为 23,739 的重新采样（与价格 A 相同的 *n*），并记录有多少个 1。
- en: Record the number of 1s in the remaining 22,588 (same *n* as price B).
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记录剩余 22,588（与价格 B 相同的 *n*）中的 1 的数量。
- en: Record the difference in proportion of 1s.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记录 1 的比例差异。
- en: Repeat steps 2–4.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复步骤 2–4。
- en: How often was the difference >= 0.0368?
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 差异大于等于 0.0368 的频率有多少？
- en: 'Reusing the function `perm_fun` defined in [“Example: Web Stickiness”](#PermutationExample),
    we can create a histogram of randomly permuted differences in conversion rate
    in *R*:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在[“示例：网站粘性”](#PermutationExample)中定义的 `perm_fun` 函数可重用，我们可以创建一个在 *R* 中随机排列的转化率差异直方图：
- en: '[PRE10]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The corresponding *Python* code is:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 相应的 *Python* 代码如下：
- en: '[PRE11]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'See the histogram of 1,000 resampled results in [Figure 3-5](#conversion-rates-histogram):
    as it happens, in this case the observed difference of 0.0368% is well within
    the range of chance variation.'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 参见 1,000 次重新采样结果的直方图，链接为[图 3-5](#conversion-rates-histogram)：正如在这个例子中所发生的那样，在这种情况下，观察到的差异
    0.0368% 完全在偶然变化范围内。
- en: '![Histogram of the difference in conversion rates from the permutation procedure.](Images/psd2_0305.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![通过排列程序得到的转化率差异直方图。](Images/psd2_0305.png)'
- en: Figure 3-5\. Frequency distribution for the difference in conversion rates between
    prices A and B
  id: totrans-151
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-5\. 价格 A 和价格 B 之间的转化率差异的频率分布
- en: p-Value
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: p 值
- en: 'Simply looking at the graph is not a very precise way to measure statistical
    significance, so of more interest is the *p-value*. This is the frequency with
    which the chance model produces a result more extreme than the observed result.
    We can estimate a p-value from our permutation test by taking the proportion of
    times that the permutation test produces a difference equal to or greater than
    the observed difference:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 简单地观察图形并不是衡量统计显著性的非常精确的方法，所以更感兴趣的是 *p 值*。这是偶然模型产生比观察到的结果更极端结果的频率。我们可以从我们的排列测试中估算出一个
    p 值，方法是取排列测试产生的差异等于或大于观察到的差异的比例：
- en: '[PRE12]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '[PRE13]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Here, both *R* and *Python* use the fact that true is interpreted as 1 and false
    as 0.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，*R* 和 *Python* 都使用 true 被解释为 1，false 被解释为 0 的事实。
- en: The p-value is 0.308, which means that we would expect to achieve a result as
    extreme as this, or a more extreme result, by random chance over 30% of the time.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: p 值为 0.308，这意味着我们预计在 30% 的时间内会通过随机机会获得像这样的结果，或者更极端的结果。
- en: 'In this case, we didn’t need to use a permutation test to get a p-value. Since
    we have a binomial distribution, we can approximate the p-value. In *R* code,
    we do this using the function `prop.test`:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们不需要使用排列测试来获取 p 值。由于我们有二项分布，可以近似计算 p 值。在 *R* 代码中，我们使用 `prop.test` 函数来实现这一点：
- en: '[PRE14]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The argument `x` is the number of successes for each group, and the argument
    `n` is the number of trials.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 参数 `x` 表示每个组的成功次数，参数 `n` 表示试验次数。
- en: 'The method `scipy.stats.chi2_contingency` takes the values as shown in [Table 3-2](#dataframe2):'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 方法 `scipy.stats.chi2_contingency` 使用的数值如 [表3-2](#dataframe2) 所示：
- en: '[PRE15]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The normal approximation yields a p-value of 0.3498, which is close to the p-value
    obtained from the permutation test.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 正态近似得出一个 p 值为 0.3498，与排列测试得出的 p 值接近。
- en: Alpha
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 显著水平
- en: Statisticians frown on the practice of leaving it to the researcher’s discretion
    to determine whether a result is “too unusual” to happen by chance. Rather, a
    threshold is specified in advance, as in “more extreme than 5% of the chance (null
    hypothesis) results”; this threshold is known as *alpha*. Typical alpha levels
    are 5% and 1%. Any chosen level is an arbitrary decision—there is nothing about
    the process that will guarantee correct decisions x% of the time. This is because
    the probability question being answered is *not* “What is the probability that
    this happened by chance?” but rather “Given a chance model, what is the probability
    of a result this extreme?” We then deduce backward about the appropriateness of
    the chance model, but that judgment does not carry a probability. This point has
    been the subject of much confusion.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 统计学家不赞成将结果是否“太不寻常”交给研究者自行决定。相反，需要事先指定一个阈值，比如“比（零假设）结果的5%更极端”; 这个阈值称为*显著水平*。常见的显著水平为5%和1%。任何选择的水平都是一个任意的决定——这个过程并不能保证
    x% 的正确决策。这是因为所回答的概率问题不是“这是偶然事件的概率吗？”而是“在给定的偶然模型下，出现如此极端结果的概率是多少？”我们然后逆推关于偶然模型适当性的判断，但这个判断本身并不包含概率。这一点已经引起了很多混淆。
- en: p-value controversy
  id: totrans-166
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: p 值争议
- en: Considerable controversy has surrounded the use of the p-value in recent years.
    One psychology journal has gone so far as to “ban” the use of p-values in submitted
    papers on the grounds that publication decisions based solely on the p-value were
    resulting in the publication of poor research. Too many researchers, only dimly
    aware of what a p-value really means, root around in the data, and among different
    possible hypotheses to test, until they find a combination that yields a significant
    p-value and, hence, a paper suitable for publication.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，关于 p 值的使用引起了相当大的争议。某些心理学期刊甚至“禁止”在提交的论文中使用 p 值，理由是仅基于 p 值的出版决策导致了糟糕研究的发表。许多研究人员对
    p 值的真实含义知之甚少，他们在数据中和各种可能的假设之间摸索，直到找到一个产生显著 p 值（从而适合发表的论文）的组合。
- en: 'The real problem is that people want more meaning from the p-value than it
    contains. Here’s what we would *like* the p-value to convey:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 真正的问题在于，人们希望从 p 值中得到比其实际含义更多的信息。以下是我们希望 p 值能传达的信息：
- en: The probability that the result is due to chance.
  id: totrans-169
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 结果是由偶然导致的概率。
- en: 'We hope for a low value, so we can conclude that we’ve proved something. This
    is how many journal editors were interpreting the p-value. But here’s what the
    p-value *actually* represents:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望 p 值较低，这样我们就可以得出我们已经证明了某些东西。这就是许多期刊编辑解读 p 值的方式。但 p 值 *实际上* 代表着以下内容：
- en: The probability that, *given a chance model*, results as extreme as the observed
    results could occur.
  id: totrans-171
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*给定偶然模型*，观察结果如此极端的概率。'
- en: The difference is subtle but real. A significant p-value does not carry you
    quite as far along the road to “proof” as it seems to promise. The logical foundation
    for the conclusion “statistically significant” is somewhat weaker when the real
    meaning of the p-value is understood.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 差异微妙但确实存在。显著的 p 值并不能像看起来承诺的那样“证明”你的结果有多可靠。当真正理解 p 值的含义时，其逻辑基础来支持“统计显著”的结论稍显薄弱。
- en: 'In March 2016, the American Statistical Association, after much internal deliberation,
    revealed the extent of misunderstanding about p-values when it issued a cautionary
    statement regarding their use. The [ASA statement](https://oreil.ly/WVfYU) stressed
    six principles for researchers and journal editors:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 2016年3月，美国统计协会在经过长时间的内部讨论后，发布了一份关于 p 值使用的警示性声明。[ASA声明](https://oreil.ly/WVfYU)
    强调了研究人员和期刊编辑的六项原则：
- en: P-values can indicate how incompatible the data are with a specified statistical
    model.
  id: totrans-174
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: p 值可以指示数据与指定统计模型的不兼容程度。
- en: ''
  id: totrans-175
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-176
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: P-values do not measure the probability that the studied hypothesis is true,
    or the probability that the data were produced by random chance alone.
  id: totrans-177
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: p 值不测量所研究假设为真的概率，也不测量数据仅由随机机会产生的概率。
- en: ''
  id: totrans-178
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-179
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: Scientific conclusions and business or policy decisions should not be based
    only on whether a p-value passes a specific threshold.
  id: totrans-180
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 科学结论和商业或政策决策不应仅仅基于 p 值是否通过了特定的阈值。
- en: ''
  id: totrans-181
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-182
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: Proper inference requires full reporting and transparency.
  id: totrans-183
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 适当的推断需要完整报告和透明度。
- en: ''
  id: totrans-184
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-185
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: A p-value, or statistical significance, does not measure the size of an effect
    or the importance of a result.
  id: totrans-186
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: p 值或统计显著性不测量效应的大小或结果的重要性。
- en: ''
  id: totrans-187
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  id: totrans-188
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: By itself, a p-value does not provide a good measure of evidence regarding a
    model or hypothesis.
  id: totrans-189
  prefs:
  - PREF_BQ
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单单 p 值本身并不能提供关于模型或假设证据的良好度量。
- en: Practical significance
  id: totrans-190
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 实际意义
- en: Even if a result is statistically significant, that does not mean it has practical
    significance. A small difference that has no practical meaning can be statistically
    significant if it arose from large enough samples. Large samples ensure that small,
    non-meaningful effects can nonetheless be big enough to rule out chance as an
    explanation. Ruling out chance does not magically render important a result that
    is, in its essence, unimportant.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 即使一个结果在统计上是显著的，也不意味着它具有实际意义。如果一个没有实际意义的小差异是从足够大的样本中产生的，那么它也可能是统计上显著的。大样本确保即使是微小的、无意义的影响也足够大，可以排除偶然性作为解释。排除偶然性并不能神奇地使一个本质上不重要的结果变得重要。
- en: Type 1 and Type 2 Errors
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 类型 1 和类型 2 错误
- en: 'In assessing statistical significance, two types of error are possible:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估统计显著性时，可能存在两种类型的错误：
- en: A Type 1 error, in which you mistakenly conclude an effect is real, when it
    is really just due to chance
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类型 1 错误是指错误地得出了一个效应是真实的结论，而实际上只是由于偶然性
- en: A Type 2 error, in which you mistakenly conclude that an effect is not real
    (i.e., due to chance), when it actually is real
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 类型 2 错误是指错误地得出一个效应不是真实的结论（即，由于偶然性），而实际上它是真实的
- en: Actually, a Type 2 error is not so much an error as a judgment that the sample
    size is too small to detect the effect. When a p-value falls short of statistical
    significance (e.g., it exceeds 5%), what we are really saying is “effect not proven.”
    It could be that a larger sample would yield a smaller p-value.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，类型 2 错误并不是一个错误，而是判断样本量太小，无法检测到效应。当 p 值未达到统计显著性（例如，超过了5%）时，我们真正表达的是“效应未经证实”。可能是因为更大的样本会产生更小的
    p 值。
- en: The basic function of significance tests (also called *hypothesis tests*) is
    to protect against being fooled by random chance; thus they are typically structured
    to minimize Type 1 errors.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 显著性检验（也称为 *假设检验*）的基本功能是防止被随机机会愚弄；因此，它们通常被设计成最小化类型 1 错误。
- en: Data Science and p-Values
  id: totrans-198
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据科学与 p 值
- en: The work that data scientists do is typically not destined for publication in
    scientific journals, so the debate over the value of a p-value is somewhat academic.
    For a data scientist, a p-value is a useful metric in situations where you want
    to know whether a model result that appears interesting and useful is within the
    range of normal chance variability. As a decision tool in an experiment, a p-value
    should not be considered controlling, but merely another point of information
    bearing on a decision. For example, p-values are sometimes used as intermediate
    inputs in some statistical or machine learning models—a feature might be included
    in or excluded from a model depending on its p-value.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 数据科学家的工作通常不会被发表在科学期刊上，因此对 p 值价值的争论有点学术化。对于数据科学家来说，p 值是一个有用的度量标准，在您想知道一个看起来有趣且有用的模型结果是否在正常机会变异范围内时。作为实验中的决策工具，p
    值不应被认为是控制性的，而仅仅是决策上的另一个信息点。例如，p 值有时被用作某些统计或机器学习模型中的中间输入——根据其 p 值，一个特征可能被包含在模型中或从模型中排除。
- en: Further Reading
  id: totrans-200
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Stephen Stigler, “Fisher and the 5% Level,” *Chance* 21, no. 4 (2008): 12\.
    This article is a short commentary on Ronald Fisher’s 1925 book *Statistical Methods
    for Research Workers* (Oliver & Boyd), and on Fisher’s emphasis on the 5% level
    of significance.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Stephen Stigler, “Fisher and the 5% Level,” *Chance* 21, no. 4 (2008): 12\.
    这篇文章是对罗纳德·费希尔（Ronald Fisher）1925年的著作 *Statistical Methods for Research Workers*（奥利弗与博伊德）的简短评论，以及费希尔对5%水平显著性的强调。'
- en: See also [“Hypothesis Tests”](#Hypothesis_test) and the further reading mentioned
    there.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 另请参阅[“假设检验”](#Hypothesis_test)及其进一步阅读。
- en: t-Tests
  id: totrans-203
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: t-Tests
- en: There are numerous types of significance tests, depending on whether the data
    comprises count data or measured data, how many samples there are, and what’s
    being measured. A very common one is the *t-test*, named after Student’s t-distribution,
    originally developed by W. S. Gosset to approximate the distribution of a single
    sample mean (see [“Student’s t-Distribution”](ch02.xhtml#t-distribution)).
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 根据数据是否包含计数数据或测量数据、样本数量以及被测量的内容，显著性检验有许多类型。一个非常常见的是*t-test*，以学生t分布命名，最初由W.S.高斯特开发，用于近似单个样本均值的分布（见[“学生t分布”](ch02.xhtml#t-distribution)）。
- en: All significance tests require that you specify a *test statistic* to measure
    the effect you are interested in and help you determine whether that observed
    effect lies within the range of normal chance variation. In a resampling test
    (see the discussion of permutation in [“Permutation Test”](#Permutation)), the
    scale of the data does not matter. You create the reference (null hypothesis)
    distribution from the data itself and use the test statistic as is.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 所有显著性检验都要求您指定一个*检验统计量*来衡量您感兴趣的效果，并帮助您确定观察到的效果是否在正常偶然变异的范围内。在重新取样检验中（参见[“排列检验”](#Permutation)中的排列讨论），数据的尺度并不重要。您从数据本身创建参考（零假设）分布，并直接使用检验统计量。
- en: In the 1920s and 1930s, when statistical hypothesis testing was being developed,
    it was not feasible to randomly shuffle data thousands of times to do a resampling
    test. Statisticians found that a good approximation to the permutation (shuffled)
    distribution was the t-test, based on Gosset’s t-distribution. It is used for
    the very common two-sample comparison—A/B test—in which the data is numeric. But
    in order for the t-distribution to be used without regard to scale, a standardized
    form of the test statistic must be used.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 在20世纪20年代和30年代开发统计假设检验时，不可能随机洗牌数据数千次以进行重新取样检验。统计学家发现，基于高斯特的t分布的t-test是排列（洗牌）分布的良好近似。它用于非常常见的两样本比较——A/B测试，其中数据是数值的。但为了无视尺度地使用t分布，必须使用标准化的检验统计量。
- en: 'A classic statistics text would at this stage show various formulas that incorporate
    Gosset’s distribution and demonstrate how to standardize your data to compare
    it to the standard t-distribution. These formulas are not shown here because all
    statistical software, as well as *R* and *Python*, includes commands that embody
    the formula. In *R*, the function is `t.test`:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 经典的统计学文本此时将展示各种包含高斯特分布的公式，并演示如何标准化您的数据以将其与标准t分布进行比较。这里没有展示这些公式，因为所有统计软件以及*R*和*Python*都包含了体现这些公式的命令。在*R*中，函数是`t.test`：
- en: '[PRE16]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The function `scipy.stats.ttest_ind` can be used in *Python*:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 函数`scipy.stats.ttest_ind`可以在*Python*中使用：
- en: '[PRE17]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The alternative hypothesis is that the session time mean for page A is less
    than that for page B. The p-value of 0.1408 is fairly close to the permutation
    test p-values of 0.121 and 0.126 (see [“Example: Web Stickiness”](#PermutationExample)).'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 备择假设是页面A的会话时间均值小于页面B的均值。p值为0.1408，接近于排列测试的p值0.121和0.126（见[“示例：Web粘性”](#PermutationExample)）。
- en: In a resampling mode, we structure the solution to reflect the observed data
    and the hypothesis to be tested, not worrying about whether the data is numeric
    or binary, whether or not sample sizes are balanced, sample variances, or a variety
    of other factors. In the formula world, many variations present themselves, and
    they can be bewildering. Statisticians need to navigate that world and learn its
    map, but data scientists do not—they are typically not in the business of sweating
    the details of hypothesis tests and confidence intervals the way a researcher
    preparing a paper for presentation might.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 在重新取样模式下，我们将解决方案构建为反映观察到的数据和要测试的假设，而不必担心数据是数值还是二进制、样本大小是否平衡、样本方差或其他各种因素。在公式世界中，存在许多变体，它们可能令人困惑。统计学家需要在这个世界中导航并学习它的地图，但数据科学家通常不需要——他们通常不会过多关注假设检验和置信区间的细节，就像研究人员为展示准备论文时那样。
- en: Further Reading
  id: totrans-213
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: Any introductory statistics text will have illustrations of the t-statistic
    and its uses; two good ones are *Statistics*, 4th ed., by David Freedman, Robert
    Pisani, and Roger Purves (W. W. Norton, 2007), and *The Basic Practice of Statistics*,
    8th ed., by David S. Moore, William I. Notz, and Michael A. Fligner (W. H. Freeman,
    2017).
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何初级统计学教材都会有 t 统计量及其用途的示例；两本好书是《Statistics》，第 4 版，作者 David Freedman、Robert Pisani
    和 Roger Purves（W. W. Norton，2007），以及《The Basic Practice of Statistics》，第 8 版，作者
    David S. Moore、William I. Notz 和 Michael A. Fligner（W. H. Freeman，2017）。
- en: 'For a treatment of both the t-test and resampling procedures in parallel, see
    *Introductory Statistics and Analytics: A Resampling Perspective* by Peter Bruce
    (Wiley, 2014) or *Statistics: Unlocking the Power of Data*, 2nd ed., by Robin
    Lock and four other Lock family members (Wiley, 2016).'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '关于 t 检验和重采样程序的同时处理，请参阅 Peter Bruce（Wiley，2014）的*Introductory Statistics and
    Analytics: A Resampling Perspective* 或 Robin Lock 及其四位 Lock 家族成员（Wiley，2016）的*Statistics:
    Unlocking the Power of Data*，第 2 版。'
- en: Multiple Testing
  id: totrans-216
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多重检验
- en: 'As we’ve mentioned previously, there is a saying in statistics: “Torture the
    data long enough, and it will confess.” This means that if you look at the data
    through enough different perspectives and ask enough questions, you almost invariably
    will find a statistically significant effect.'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们之前提到的，在统计学中有一句话：“折磨数据足够长时间，它就会招供。” 这意味着如果您从足够多的不同角度查看数据并提出足够多的问题，您几乎无可避免地会发现一个统计显著的效果。
- en: For example, if you have 20 predictor variables and one outcome variable, all
    *randomly* generated, the odds are pretty good that at least one predictor will
    (falsely) turn out to be statistically significant if you do a series of 20 significance
    tests at the alpha = 0.05 level. As previously discussed, this is called a *Type
    1 error*. You can calculate this probability by first finding the probability
    that all will *correctly* test nonsignificant at the 0.05 level. The probability
    that *one* will correctly test nonsignificant is 0.95, so the probability that
    all 20 will correctly test nonsignificant is 0.95 × 0.95 × 0.95…, or 0.95^(20)
    = 0.36.^([1](ch03.xhtml#idm46522858323800)) The probability that at least one
    predictor will (falsely) test significant is the flip side of this probability,
    or 1 – (*probability that all will be nonsignificant*) = 0.64\. This is known
    as *alpha inflation*.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果您有 20 个预测变量和一个结果变量，所有这些变量都是随机生成的，那么如果您在 alpha = 0.05 水平上进行一系列 20 次显著性检验，至少会有一个预测变量（错误地）显示出统计显著性的概率相当高。正如前面讨论的那样，这被称为*Type
    1 error*。您可以通过首先找到所有变量在 0.05 水平上都能正确地测试为非显著的概率来计算这一概率。一个变量能正确地测试为非显著的概率是 0.95，因此所有
    20 个变量都能正确地测试为非显著的概率是 0.95 × 0.95 × 0.95…，即 0.95^(20) = 0.36.^([1](ch03.xhtml#idm46522858323800))
    至少有一个预测变量（错误地）显示出显著性的概率是这个概率的反面，即 1 –（*所有变量都为非显著的概率*）= 0.64。这被称为*alpha inflation*。
- en: This issue is related to the problem of overfitting in data mining, or “fitting
    the model to the noise.” The more variables you add, or the more models you run,
    the greater the probability that something will emerge as “significant” just by
    chance.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 这个问题与数据挖掘中过拟合问题相关，或者称为“将模型拟合到噪声中”。您添加的变量越多，或者运行的模型越多，某些东西被“显著”地发现的可能性就越大，仅仅是由于偶然性。
- en: In supervised learning tasks, a holdout set where models are assessed on data
    that the model has not seen before mitigates this risk. In statistical and machine
    learning tasks not involving a labeled holdout set, the risk of reaching conclusions
    based on statistical noise persists.
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在监督学习任务中，使用一个保留集，在这个集合中模型评估数据是模型之前未见过的，可以减轻这种风险。在不涉及标记保留集的统计和机器学习任务中，基于统计噪声得出结论的风险仍然存在。
- en: 'In statistics, there are some procedures intended to deal with this problem
    in very specific circumstances. For example, if you are comparing results across
    multiple treatment groups, you might ask multiple questions. So, for treatments
    A–C, you might ask:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计学中，有一些旨在处理这个问题的程序，适用于非常具体的情况。例如，如果您正在比较多个治疗组的结果，您可能会提出多个问题。因此，对于治疗方案 A–C，您可能会问：
- en: Is A different from B?
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: A 和 B 有何不同？
- en: Is B different from C?
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: B 和 C 有何不同？
- en: Is A different from C?
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: A 和 C 有何不同？
- en: Or, in a clinical trial, you might want to look at results from a therapy at
    multiple stages. In each case, you are asking multiple questions, and with each
    question, you are increasing the chance of being fooled by chance. Adjustment
    procedures in statistics can compensate for this by setting the bar for statistical
    significance more stringently than it would be set for a single hypothesis test.
    These adjustment procedures typically involve “dividing up the alpha” according
    to the number of tests. This results in a smaller alpha (i.e., a more stringent
    bar for statistical significance) for each test. One such procedure, the Bonferroni
    adjustment, simply divides the alpha by the number of comparisons. Another, used
    in comparing multiple group means, is Tukey’s “honest significant difference,”
    or *Tukey’s HSD*. This test applies to the maximum difference among group means,
    comparing it to a benchmark based on the *t-distribution* (roughly equivalent
    to shuffling all the values together, dealing out resampled groups of the same
    sizes as the original groups, and finding the maximum difference among the resampled
    group means).
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，在临床试验中，你可能想要在多个阶段检查治疗结果。在每种情况下，你都在提出多个问题，并且对于每个问题，你都在增加被偶然误导的机会。统计学中的调整程序可以通过将统计显著性的门槛设得比单个假设检验更严格来弥补这一点。这些调整程序通常涉及根据测试数量“分割阿尔法”。这样可以使每次测试的阿尔法（即，统计显著性的门槛）更小。其中一种调整程序，邦费罗尼校正，简单地将阿尔法除以比较数量。另一种，在比较多个组均值时使用的是图基的“诚实显著差异”，或*图基的HSD*。该测试应用于组均值中的最大差异，将其与基于*t-分布*（大致等效于将所有值混合在一起，以原始组大小重新抽样组，并找到重新抽样组均值中的最大差异）的基准进行比较。
- en: 'However, the problem of multiple comparisons goes beyond these highly structured
    cases and is related to the phenomenon of repeated data “dredging” that gives
    rise to the saying about torturing the data. Put another way, given sufficiently
    complex data, if you haven’t found something interesting, you simply haven’t looked
    long and hard enough. More data is available now than ever before, and the number
    of journal articles published nearly doubled between 2002 and 2010. This gives
    rise to lots of opportunities to find something interesting in the data, including
    multiplicity issues such as:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，多重比较问题不仅限于这些高度结构化的情况，并且与反复数据挖掘的现象相关，这导致了有关拷问数据的说法。换句话说，如果数据足够复杂，如果你还没有找到有趣的东西，那么你只是没有花足够长时间和精力去寻找。现在的数据比以往任何时候都更加丰富，2002年至2010年间发表的期刊文章数量几乎翻了一番。这给了我们很多在数据中发现有趣事物的机会，包括多重性问题，比如：
- en: Checking for multiple pairwise differences across groups
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查组间的多个成对差异
- en: Looking at multiple subgroup results (“we found no significant treatment effect
    overall, but we did find an effect for unmarried women younger than 30”)
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看多个子组结果（“我们在整体上没有发现显著的治疗效果，但我们发现了对于未婚女性30岁以下的效果”）
- en: Trying lots of statistical models
  id: totrans-229
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尝试许多统计模型
- en: Including lots of variables in models
  id: totrans-230
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在模型中包含大量变量
- en: Asking a number of different questions (i.e., different possible outcomes)
  id: totrans-231
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向多个不同问题提问（即，不同可能的结果）
- en: False Discovery Rate
  id: totrans-232
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: False Discovery Rate
- en: The term *false discovery rate* was originally used to describe the rate at
    which a given set of hypothesis tests would falsely identify a significant effect.
    It became particularly useful with the advent of genomic research, in which massive
    numbers of statistical tests might be conducted as part of a gene sequencing project.
    In these cases, the term applies to the testing protocol, and a single false “discovery”
    refers to the outcome of a hypothesis test (e.g., between two samples). Researchers
    sought to set the parameters of the testing process to control the false discovery
    rate at a specified level. The term has also been used for classification in data
    mining; it is the misclassification rate within the class 1 predictions. Or, put
    another way, it is the probability that a “discovery” (labeling a record as a
    “1”) is false. Here we typically are dealing with the case where 0s are abundant
    and 1s are interesting and rare (see [Chapter 5](ch05.xhtml#Classification) and
    [“The Rare Class Problem”](ch05.xhtml#RareClassProblem)).
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 术语*假阳性发现率*最初用于描述给定一组假设检验会错误地识别显著效应的比率。随着基因组研究的出现，这个术语变得特别有用，因为可能在基因测序项目中进行大量的统计检验。在这些情况下，该术语适用于测试协议，并且单个错误的“发现”指的是假设检验的结果（例如，两个样本之间）。研究人员试图设置测试过程的参数，以控制指定水平上的假阳性发现率。在数据挖掘中，这个术语还被用于分类；它是类别1预测中的误分类率。或者换句话说，它是“发现”（将记录标记为“1”）是假的概率。在这里，我们通常处理0丰富且1有趣且稀少的情况（参见[第5章](ch05.xhtml#Classification)和[“罕见类问题”](ch05.xhtml#RareClassProblem)）。
- en: For a variety of reasons, including especially this general issue of “multiplicity,”
    more research does not necessarily mean better research. For example, the pharmaceutical
    company Bayer found in 2011 that when it tried to replicate 67 scientific studies,
    it could fully replicate only 14 of them. Nearly two-thirds could not be replicated
    at all.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 由于“多重性”等一系列原因，更多的研究并不一定意味着更好的研究。例如，制药公司拜耳在2011年发现，当它试图复制67项科学研究时，只有14项可以完全复制。将近三分之二的研究根本无法复制。
- en: 'In any case, the adjustment procedures for highly defined and structured statistical
    tests are too specific and inflexible to be of general use to data scientists.
    The bottom line for data scientists on multiplicity is:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，针对高度定义和结构化的统计测试的调整程序过于具体和不灵活，以至于不能普遍适用于数据科学家。对于数据科学家而言，多重性的关键点是：
- en: For predictive modeling, the risk of getting an illusory model whose apparent
    efficacy is largely a product of random chance is mitigated by cross-validation
    (see [“Cross-Validation”](ch04.xhtml#CrossValidation)) and use of a holdout sample.
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于预测建模，通过交叉验证（参见[“交叉验证”](ch04.xhtml#CrossValidation)）和使用保留样本，可以减少因为随机偶然性而导致虚假模型的风险。
- en: 'For other procedures without a labeled holdout set to check the model, you
    must rely on:'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于其他没有标记保留集来检查模型的程序，您必须依赖于：
- en: Awareness that the more you query and manipulate the data, the greater the role
    that chance might play.
  id: totrans-238
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请注意，您查询和操作数据越多，偶然因素可能会起到更大的作用。
- en: Resampling and simulation heuristics to provide random chance benchmarks against
    which observed results can be compared.
  id: totrans-239
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重新采样和模拟启发法提供了随机偶然基准，用以比较观察到的结果。
- en: Further Reading
  id: totrans-240
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: For a short exposition of one procedure (Dunnett’s test) to adjust for multiple
    comparisons, see David Lane’s [online statistics text](https://oreil.ly/hd_62).
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于一种过程（Dunnett's test）用于多重比较校正的简短说明，请参阅David Lane的[在线统计文本](https://oreil.ly/hd_62)。
- en: Megan Goldman offers a [slightly longer treatment of the Bonferroni adjustment
    procedure](https://oreil.ly/Dt4Vi).
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Megan Goldman提供了一个稍微更长的介绍，关于Bonferroni校正程序的处理方法，请参阅[这里](https://oreil.ly/Dt4Vi)。
- en: For an in-depth treatment of more flexible statistical procedures for adjusting
    p-values, see *Resampling-Based Multiple Testing* by Peter Westfall and Stanley
    Young (Wiley, 1993).
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于更灵活的统计程序调整p值的深入处理，请参阅《Resampling-Based Multiple Testing》一书，作者为Peter Westfall和Stanley
    Young（Wiley，1993年）。
- en: For a discussion of data partitioning and the use of holdout samples in predictive
    modeling, see Chapter 2 of *Data Mining for Business Analytics*, by Galit Shmueli,
    Peter Bruce, Nitin Patel, Peter Gedeck, Inbal Yahav, and Kenneth Lichtendahl (Wiley,
    2007–2020, with editions for *R*, *Python*, Excel, and JMP).
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于数据分区和在预测建模中使用保留样本的讨论，请参阅《Data Mining for Business Analytics》第2章，作者为Galit Shmueli、Peter
    Bruce、Nitin Patel、Peter Gedeck、Inbal Yahav和Kenneth Lichtendahl（Wiley，2007–2020，有适用于*R*、*Python*、Excel和JMP的版本）。
- en: Degrees of Freedom
  id: totrans-245
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自由度
- en: In the documentation and settings for many statistical tests and probability
    distributions, you will see a reference to “degrees of freedom.” The concept is
    applied to statistics calculated from sample data, and refers to the number of
    values free to vary. For example, if you know the mean for a sample of 10 values,
    there are 9 degrees of freedom (once you know 9 of the sample values, the 10th
    can be calculated and is not free to vary). The degrees of freedom parameter,
    as applied to many probability distributions, affects the shape of the distribution.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多统计测试和概率分布的文档和设置中，您会看到“自由度”的引用。这个概念适用于从样本数据计算的统计量，并且指的是可以自由变化的值的数量。例如，如果您知道一个包含10个值的样本的均值，那么有9个自由度（一旦知道了9个样本值，第10个可以计算出来，不再是自由变化的）。自由度参数，适用于许多概率分布，影响分布的形状。
- en: The number of degrees of freedom is an input to many statistical tests. For
    example, degrees of freedom is the name given to the *n* – 1 denominator seen
    in the calculations for variance and standard deviation. Why does it matter? When
    you use a sample to estimate the variance for a population, you will end up with
    an estimate that is slightly biased downward if you use *n* in the denominator.
    If you use *n* – 1 in the denominator, the estimate will be free of that bias.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 自由度的数量是许多统计测试的输入。例如，自由度是在方差和标准差计算中看到的*n* – 1的分母。为什么这很重要？当您使用样本来估计总体方差时，如果在分母中使用*n*，您将得到一个稍微有偏低的估计。如果在分母中使用*n*
    – 1，估计将不受这种偏差的影响。
- en: A large share of a traditional statistics course or text is consumed by various
    standard tests of hypotheses (t-test, F-test, etc.). When sample statistics are
    standardized for use in traditional statistical formulas, degrees of freedom is
    part of the standardization calculation to ensure that your standardized data
    matches the appropriate reference distribution (t-distribution, F-distribution,
    etc.).
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 传统统计课程或文本的很大一部分内容用于各种假设检验（t检验，F检验等）。当样本统计数据标准化以用于传统统计公式时，自由度是标准化计算的一部分，以确保您的标准化数据与适当的参考分布（t分布，F分布等）匹配。
- en: Is it important for data science? Not really, at least in the context of significance
    testing. For one thing, formal statistical tests are used only sparingly in data
    science. For another, the data size is usually large enough that it rarely makes
    a real difference for a data scientist whether, for example, the denominator has
    *n* or *n* – 1\. (As *n* gets large, the bias that would come from using *n* in
    the denominator disappears.)
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 对数据科学重要吗？实际上并不重要，至少在显著性测试的背景下不重要。首先，形式化的统计测试在数据科学中很少使用。其次，数据规模通常足够大，以至于对于数据科学家来说，分母是*n*还是*n*
    – 1几乎没有真正的区别。（随着*n*的增大，使用*n*导致的偏差消失。）
- en: 'There is one context, though, in which it is relevant: the use of factored
    variables in regression (including logistic regression). Some regression algorithms
    choke if exactly redundant predictor variables are present. This most commonly
    occurs when factoring categorical variables into binary indicators (dummies).
    Consider the variable “day of week.” Although there are seven days of the week,
    there are only six degrees of freedom in specifying day of week. For example,
    once you know that day of week is not Monday through Saturday, you know it must
    be Sunday. Inclusion of the Mon–Sat indicators thus means that *also* including
    Sunday would cause the regression to fail, due to a *multicollinearity* error.'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，有一个情境很重要：在回归（包括逻辑回归）中使用因子变量时。如果存在完全冗余的预测变量，一些回归算法可能会失败。这种情况最常出现在将分类变量转换为二元指标（虚拟变量）时。考虑变量“星期几”。虽然一周有七天，但在指定星期几时只有六个自由度。例如，一旦知道星期几不是星期一到星期六，就可以确定它一定是星期日。因此，如果包括星期一到星期六的指标，再包括星期日将导致回归失败，因为会出现*多重共线性*错误。
- en: Further Reading
  id: totrans-251
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: There are [several web tutorials on degrees of freedom](https://oreil.ly/VJyts).
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 有[几个关于自由度的网络教程](https://oreil.ly/VJyts)。
- en: ANOVA
  id: totrans-253
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ANOVA
- en: Suppose that, instead of an A/B test, we had a comparison of multiple groups,
    say A/B/C/D, each with numeric data. The statistical procedure that tests for
    a statistically significant difference among the groups is called *analysis of
    variance*, or *ANOVA*.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们不是进行A/B测试，而是比较多个组，比如A/B/C/D，每组都有数值数据。用于测试组间统计显著差异的统计程序称为*方差分析*，或简称*ANOVA*。
- en: '[Table 3-3](#FourSessionsData) shows the stickiness of four web pages, defined
    as the number of seconds a visitor spent on the page. The four pages are switched
    out so that each web visitor receives one at random. There are a total of five
    visitors for each page, and in [Table 3-3](#FourSessionsData), each column is
    an independent set of data. The first viewer for page 1 has no connection to the
    first viewer for page 2. Note that in a web test like this, we cannot fully implement
    the classic randomized sampling design in which each visitor is selected at random
    from some huge population. We must take the visitors as they come. Visitors may
    systematically differ depending on time of day, time of week, season of the year,
    conditions of their internet, what device they are using, and so on. These factors
    should be considered as potential bias when the experiment results are reviewed.'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '[表 3-3](#FourSessionsData) 显示了四个网页的粘性，定义为访客在页面上停留的秒数。这四个页面被随机切换，以便每个网络访客随机接收一个页面。每个页面有五名访客，[表 3-3](#FourSessionsData)
    中的每一列都是独立的数据集。第一个查看页面 1 的观众与页面 2 的第一个查看者没有联系。请注意，在这样的网络测试中，我们无法完全实施经典的随机抽样设计，即从某个庞大人口中随机选择每个访客。我们必须根据它们的到来接受访客。访客可能因每天的时间、每周的时间、年份的季节、其互联网条件、使用的设备等因素而有所不同。在审查实验结果时应考虑这些因素作为潜在的偏倚。'
- en: Table 3-3\. Stickiness (in seconds) of four web pages
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3-3\. 四个网页的粘性（以秒为单位）
- en: '|  | Page 1 | Page 2 | Page 3 | Page 4 |'
  id: totrans-257
  prefs: []
  type: TYPE_TB
  zh: '|  | 页面 1 | 页面 2 | 页面 3 | 页面 4 |'
- en: '| --- | --- | --- | --- | --- |'
  id: totrans-258
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- |'
- en: '|  | 164 | 178 | 175 | 155 |'
  id: totrans-259
  prefs: []
  type: TYPE_TB
  zh: '|  | 164 | 178 | 175 | 155 |'
- en: '|  | 172 | 191 | 193 | 166 |'
  id: totrans-260
  prefs: []
  type: TYPE_TB
  zh: '|  | 172 | 191 | 193 | 166 |'
- en: '|  | 177 | 182 | 171 | 164 |'
  id: totrans-261
  prefs: []
  type: TYPE_TB
  zh: '|  | 177 | 182 | 171 | 164 |'
- en: '|  | 156 | 185 | 163 | 170 |'
  id: totrans-262
  prefs: []
  type: TYPE_TB
  zh: '|  | 156 | 185 | 163 | 170 |'
- en: '|  | 195 | 177 | 176 | 168 |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
  zh: '|  | 195 | 177 | 176 | 168 |'
- en: '| Average | 172 | 185 | 176 | 162 |'
  id: totrans-264
  prefs: []
  type: TYPE_TB
  zh: '| 平均值 | 172 | 185 | 176 | 162 |'
- en: '| Grand average |  |  |  | 173.75 |'
  id: totrans-265
  prefs: []
  type: TYPE_TB
  zh: '| 总平均值 |  |  |  | 173.75 |'
- en: 'Now we have a conundrum (see [Figure 3-6](#FourGroups)). When we were comparing
    just two groups, it was a simple matter; we merely looked at the difference between
    the means of each group. With four means, there are six possible comparisons between
    groups:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们面临一个难题（见[图 3-6](#FourGroups)）。当我们只比较两组时，这是一个简单的问题；我们只需查看每组的平均值之间的差异。但是有了四个平均值，就有六种可能的组间比较：
- en: Page 1 compared to page 2
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Page 1 相比于 Page 2
- en: Page 1 compared to page 3
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Page 1 相比于 Page 3
- en: Page 1 compared to page 4
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Page 1 相比于 Page 4
- en: Page 2 compared to page 3
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Page 2 相比于 Page 3
- en: Page 2 compared to page 4
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Page 2 相比于 Page 4
- en: Page 3 compared to page 4
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Page 3 相比于 Page 4
- en: The more such *pairwise* comparisons we make, the greater the potential for
    being fooled by random chance (see [“Multiple Testing”](#MultipleTesting)). Instead
    of worrying about all the different comparisons between individual pages we could
    possibly make, we can do a single overall test that addresses the question, “Could
    all the pages have the same underlying stickiness, and the differences among them
    be due to the random way in which a common set of session times got allocated
    among the four pages?”
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 我们进行的*逐对*比较越多，就越容易被随机机会愚弄（见[“多重测试”](#MultipleTesting)）。与担心我们可能做出的所有不同页面之间的比较不同，我们可以进行一个单一的总体测试，来回答这个问题：“所有页面是否具有相同的基础粘性，并且它们之间的差异是否是由于随机方式分配了一组共同的会话时间？”
- en: '![Session times across four different web pages.](Images/psd2_0306.png)'
  id: totrans-274
  prefs: []
  type: TYPE_IMG
  zh: '![四个不同网页的会话时间。](Images/psd2_0306.png)'
- en: Figure 3-6\. Boxplots of the four groups show considerable differences among
    them
  id: totrans-275
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-6\. 四组的箱线图显示它们之间存在显著差异
- en: 'The procedure used to test this is ANOVA. The basis for it can be seen in the
    following resampling procedure (specified here for the A/B/C/D test of web page
    stickiness):'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: 用于测试此项的过程是方差分析（ANOVA）。其基础可以在以下重抽样过程中看到（这里指定为页面粘性的 A/B/C/D 测试）：
- en: Combine all the data together in a single box.
  id: totrans-277
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将所有数据汇总在一个单一的箱中。
- en: Shuffle and draw out four resamples of five values each.
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 洗牌并抽取每个五个值的四次重抽样。
- en: Record the mean of each of the four groups.
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记录四组中每组的平均值。
- en: Record the variance among the four group means.
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记录四组均值之间的方差。
- en: Repeat steps 2–4 many (say, 1,000) times.
  id: totrans-281
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复步骤 2–4 多次（例如，1,000 次）。
- en: What proportion of the time did the resampled variance exceed the observed variance?
    This is the p-value.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 重新抽样方差超过观察方差的比例是多少？这就是 p 值。
- en: 'This type of permutation test is a bit more involved than the type used in
    [“Permutation Test”](#Permutation). Fortunately, the `aovp` function in the `lmPerm`
    package computes a permutation test for this case:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的排列检验比 [“Permutation Test”](#Permutation) 中使用的类型更为复杂。幸运的是，`lmPerm` 包中的 `aovp`
    函数为此情况计算排列检验：
- en: '[PRE18]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: The p-value, given by `Pr(Prob)`, is 0.09278\. In other words, given the same
    underlying stickiness, 9.3% of the time the response rate among four pages might
    differ as much as was actually observed, just by chance. This degree of improbability
    falls short of the traditional statistical threshold of 5%, so we conclude that
    the difference among the four pages could have arisen by chance.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: p 值，由 `Pr(Prob)` 给出，为 0.09278。换句话说，假设存在相同的粘性底层，四页中响应率的差异有 9.3% 的可能性实际上是观察到的，这纯粹是偶然发生的。这种不太可能性不足以达到传统的统计显著性阈值
    5%，因此我们得出结论，四页之间的差异可能是偶然造成的。
- en: The column `Iter` lists the number of iterations taken in the permutation test.
    The other columns correspond to a traditional ANOVA table and are described next.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 列 `Iter` 列出了排列检验中进行的迭代次数。其他列对应传统的 ANOVA 表，并将在下文中描述。
- en: 'In *Python*, we can compute the permutation test using the following code:'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *Python* 中，我们可以使用以下代码计算排列检验：
- en: '[PRE19]'
  id: totrans-288
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: F-Statistic
  id: totrans-289
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: F 统计量
- en: Just like the t-test can be used instead of a permutation test for comparing
    the mean of two groups, there is a statistical test for ANOVA based on the *F-statistic*.
    The F-statistic is based on the ratio of the variance across group means (i.e.,
    the treatment effect) to the variance due to residual error. The higher this ratio,
    the more statistically significant the result. If the data follows a normal distribution,
    then statistical theory dictates that the statistic should have a certain distribution.
    Based on this, it is possible to compute a p-value.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 就像 t 检验可以用于比较两组均值而不是排列检验一样，基于 *F 统计量* 的 ANOVA 的统计检验也存在。F 统计量基于组均值间方差（即处理效应）与残差误差方差的比率。此比率越高，结果在统计上显著性越大。如果数据符合正态分布，则统计理论规定该统计量应该有一定分布。基于此，可以计算出
    p 值。
- en: 'In *R*, we can compute an *ANOVA table* using the `aov` function:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *R* 中，我们可以使用 `aov` 函数计算 *ANOVA 表*：
- en: '[PRE20]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'The `statsmodels` package provides an ANOVA implementation in *Python*:'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '`statsmodels` 包提供了 *Python* 中的 ANOVA 实现：'
- en: '[PRE21]'
  id: totrans-294
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The output from the *Python* code is almost identical to that from *R*.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: '*Python* 代码的输出与 *R* 的几乎完全相同。'
- en: '`Df` is “degrees of freedom,” `Sum Sq` is “sum of squares,” `Mean Sq` is “mean
    squares” (short for mean-squared deviations), and `F value` is the F-statistic.
    For the grand average, sum of squares is the departure of the grand average from
    0, squared, times 20 (the number of observations). The degrees of freedom for
    the grand average is 1, by definition.'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: '`Df` 是“自由度”，`Sum Sq` 是“平方和”，`Mean Sq` 是“均方差”（即均方差偏差的缩写），而 `F value` 是 F 统计量。对于总平均数，平方和是总平均数与
    0 的偏离值的平方乘以 20（观察数）。总平均数的自由度根据定义为 1。'
- en: For the treatment means, the degrees of freedom is 3 (once three values are
    set, and then the grand average is set, the other treatment mean cannot vary).
    Sum of squares for the treatment means is the sum of squared departures between
    the treatment means and the grand average.
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 对于处理均值，自由度为 3（设置了三个值后，总平均值被设置，其他处理均值不能变动）。处理均值的平方和是处理均值与总平均数之间偏离的平方和。
- en: For the residuals, degrees of freedom is 20 (all observations can vary), and
    SS is the sum of squared difference between the individual observations and the
    treatment means. Mean squares (MS) is the sum of squares divided by the degrees
    of freedom.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 对于残差，自由度为 20（所有观察值均可变动），SS 是个体观察值与处理均值之间的平方差之和。均方（MS）是平方和除以自由度。
- en: The F-statistic is MS(treatment)/MS(error). The F value thus depends only on
    this ratio and can be compared to a standard F-distribution to determine whether
    the differences among treatment means are greater than would be expected in random
    chance variation.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: F 统计量为 MS（处理）/MS（误差）。因此，F 值仅取决于此比率，可以与标准 F 分布进行比较，以确定处理均值之间的差异是否超出了随机机会变化的预期。
- en: Decomposition of Variance
  id: totrans-300
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 方差分解
- en: 'Observed values in a data set can be considered sums of different components.
    For any observed data value within a data set, we can break it down into the grand
    average, the treatment effect, and the residual error. We call this a “decomposition
    of variance”:'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 数据集中的观察值可以被视为不同组成部分的总和。对于数据集中的任何观察数据值，我们可以将其分解为总体平均值、治疗效应和残差误差。我们称之为“方差分解”：
- en: Start with grand average (173.75 for web page stickiness data).
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以总体平均值开始（网页粘性数据为173.75）。
- en: Add treatment effect, which might be negative (independent variable = web page).
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加治疗效果，可能是负面的（自变量=网页）。
- en: Add residual error, which might be negative.
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加残差误差，可能是负面的。
- en: 'Thus the decomposition of the variance for the top-left value in the A/B/C/D
    test table is as follows:'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，A/B/C/D测试表中左上角值的方差分解如下：
- en: 'Start with grand average: 173.75.'
  id: totrans-306
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以总体平均值开始：173.75。
- en: 'Add treatment (group) effect: –1.75 (172 – 173.75).'
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加治疗（组）效应：-1.75（172 - 173.75）。
- en: 'Add residual: –8 (164 – 172).'
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加残差：-8（164 - 172）。
- en: 'Equals: 164.'
  id: totrans-309
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 等于：164。
- en: Two-Way ANOVA
  id: totrans-310
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 双向方差分析
- en: The A/B/C/D test just described is a “one-way” ANOVA, in which we have one factor
    (group) that is varying. We could have a second factor involved—say, “weekend
    versus weekday”—with data collected on each combination (group A weekend, group
    A weekday, group B weekend, etc.). This would be a “two-way ANOVA,” and we would
    handle it in similar fashion to the one-way ANOVA by identifying the “interaction
    effect.” After identifying the grand average effect and the treatment effect,
    we then separate the weekend and weekday observations for each group and find
    the difference between the averages for those subsets and the treatment average.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 刚刚描述的A/B/C/D测试是“单因素”方差分析，其中我们有一个变化的因素（组）。我们可能涉及第二个因素——比如“周末与工作日”的情况——收集每种组合的数据（A组周末，A组工作日，B组周末等）。这将是“双向方差分析”，我们将通过识别“交互作用效应”类似于单因素方差分析来处理。在确定总体平均效应和治疗效应之后，我们然后将每组周末和工作日的观察结果分离，并找到这些子集的平均值与治疗平均值之间的差异。
- en: You can see that ANOVA and then two-way ANOVA are the first steps on the road
    toward a full statistical model, such as regression and logistic regression, in
    which multiple factors and their effects can be modeled (see [Chapter 4](ch04.xhtml#Regression)).
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到，方差分析，然后是双向方差分析，是通向完整统计模型（如回归和 logistic 回归）的第一步，在这些模型中，可以对多个因素及其影响进行建模（参见[第4章](ch04.xhtml#Regression)）。
- en: Further Reading
  id: totrans-313
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Introductory Statistics and Analytics: A Resampling Perspective* by Peter
    Bruce (Wiley, 2014) has a chapter on ANOVA.'
  id: totrans-314
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《入门统计与分析：重新抽样视角》*（Peter Bruce著，Wiley出版，2014年）有一章关于方差分析。'
- en: '*Introduction to Design and Analysis of Experiments* by George Cobb (Wiley,
    2008) is a comprehensive and readable treatment of its subject.'
  id: totrans-315
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*《实验设计与分析导论》*（George Cobb著，Wiley出版，2008年）是其主题的全面且可读的处理。'
- en: Chi-Square Test
  id: totrans-316
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 卡方检验
- en: Web testing often goes beyond A/B testing and tests multiple treatments at once.
    The chi-square test is used with count data to test how well it fits some expected
    distribution. The most common use of the *chi-square* statistic in statistical
    practice is with <math alttext="r times c"><mrow><mi>r</mi> <mo>×</mo> <mi>c</mi></mrow></math>
    contingency tables, to assess whether the null hypothesis of independence among
    variables is reasonable (see also [“Chi-Square Distribution”](ch02.xhtml#chi-square-dist)).
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 网页测试通常超越A/B测试，同时测试多种治疗方法。卡方检验用于计数数据，以测试其与某些预期分布的拟合程度。在统计实践中，*chi-square*统计量最常见的用途是与<math
    alttext="r times c"><mrow><mi>r</mi> <mo>×</mo> <mi>c</mi></mrow></math>列联表一起使用，以评估变量之间独立性的零假设是否合理（另见[“卡方分布”](ch02.xhtml#chi-square-dist)）。
- en: The chi-square test was [originally developed by Karl Pearson in 1900](https://oreil.ly/cEubO).
    The term *chi* comes from the Greek letter Χ used by Pearson in the article.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方检验最初由卡尔·皮尔逊（1900年）开发，术语*chi*来自皮尔逊在文章中使用的希腊字母Χ。
- en: Note
  id: totrans-319
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 注意
- en: <math alttext="r times c"><mrow><mi>r</mi> <mo>×</mo> <mi>c</mi></mrow></math>
    means “rows by columns”—a 2 × 3 table has two rows and three columns.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: <math alttext="r times c"><mrow><mi>r</mi> <mo>×</mo> <mi>c</mi></mrow></math>
    表示“行乘以列”——一个2 × 3表有两行和三列。
- en: 'Chi-Square Test: A Resampling Approach'
  id: totrans-321
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 卡方检验：重新抽样方法
- en: Suppose you are testing three different headlines—A, B, and C—and you run them
    each on 1,000 visitors, with the results shown in [Table 3-4](#table0304).
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你正在测试三个不同的标题——A、B和C——并将它们分别在1,000名访客上运行，结果显示在[表3-4](#table0304)中。
- en: Table 3-4\. Web testing results for three different headlines
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 表3-4。三个不同标题的网页测试结果
- en: '|  | Headline A | Headline B | Headline C |'
  id: totrans-324
  prefs: []
  type: TYPE_TB
  zh: '|  | 标题 A | 标题 B | 标题 C |'
- en: '| --- | --- | --- | --- |'
  id: totrans-325
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Click | 14 | 8 | 12 |'
  id: totrans-326
  prefs: []
  type: TYPE_TB
  zh: '| Click | 14 | 8 | 12 |'
- en: '| No-click | 986 | 992 | 988 |'
  id: totrans-327
  prefs: []
  type: TYPE_TB
  zh: '| No-click | 986 | 992 | 988 |'
- en: The headlines certainly appear to differ. Headline A returns nearly twice the
    click rate of B. The actual numbers are small, though. A resampling procedure
    can test whether the click rates differ to an extent greater than chance might
    cause. For this test, we need to have the “expected” distribution of clicks, and
    in this case, that would be under the null hypothesis assumption that all three
    headlines share the same click rate, for an overall click rate of 34/3,000. Under
    this assumption, our contingency table would look like [Table 3-5](#table0305).
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 这些标题显然有所不同。标题 A 的点击率几乎是 B 的两倍。虽然实际数字较小，但是一个重采样过程可以测试点击率是否超过了可能由偶然引起的程度。对于这个测试，我们需要有点击的“预期”分布，在这种情况下，这将是在所有三个标题共享相同点击率的零假设下的分布，总体点击率为
    34/3,000。根据这一假设，我们的列联表将如[表 3-5](#table0305)所示。
- en: Table 3-5\. Expected if all three headlines have the same click rate (null hypothesis)
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3-5\. 如果所有三个标题具有相同的点击率（零假设下的预期）
- en: '|  | Headline A | Headline B | Headline C |'
  id: totrans-330
  prefs: []
  type: TYPE_TB
  zh: '|  | 标题 A | 标题 B | 标题 C |'
- en: '| --- | --- | --- | --- |'
  id: totrans-331
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Click | 11.33 | 11.33 | 11.33 |'
  id: totrans-332
  prefs: []
  type: TYPE_TB
  zh: '| Click | 11.33 | 11.33 | 11.33 |'
- en: '| No-click | 988.67 | 988.67 | 988.67 |'
  id: totrans-333
  prefs: []
  type: TYPE_TB
  zh: '| No-click | 988.67 | 988.67 | 988.67 |'
- en: 'The *Pearson residual* is defined as:'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: '*皮尔逊残差*定义为：'
- en: <math display="block"><mrow><mi>R</mi> <mo>=</mo> <mfrac><mrow><mtext>Observed</mtext><mo>-</mo><mtext>Expected</mtext></mrow>
    <msqrt><mtext>Expected</mtext></msqrt></mfrac></mrow></math>
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mrow><mi>R</mi> <mo>=</mo> <mfrac><mrow><mtext>Observed</mtext><mo>-</mo><mtext>Expected</mtext></mrow>
    <msqrt><mtext>Expected</mtext></msqrt></mfrac></mrow></math>
- en: '*R* measures the extent to which the actual counts differ from these expected
    counts (see [Table 3-6](#table0306)).'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: '*R*测量实际计数与期望计数的差异程度（见 [表 3-6](#table0306)）。'
- en: Table 3-6\. Pearson residuals
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 表 3-6\. 皮尔逊残差
- en: '|  | Headline A | Headline B | Headline C |'
  id: totrans-338
  prefs: []
  type: TYPE_TB
  zh: '|  | 标题 A | 标题 B | 标题 C |'
- en: '| --- | --- | --- | --- |'
  id: totrans-339
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| Click | 0.792 | –0.990 | 0.198 |'
  id: totrans-340
  prefs: []
  type: TYPE_TB
  zh: '| Click | 0.792 | –0.990 | 0.198 |'
- en: '| No-click | –0.085 | 0.106 | –0.021 |'
  id: totrans-341
  prefs: []
  type: TYPE_TB
  zh: '| No-click | –0.085 | 0.106 | –0.021 |'
- en: 'The chi-square statistic is defined as the sum of the squared Pearson residuals:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方统计量定义为平方皮尔逊残差的总和：
- en: <math display="block"><mrow><mi>Χ</mi> <mo>=</mo> <munderover><mo>∑</mo> <mi>i</mi>
    <mi>r</mi></munderover> <munderover><mo>∑</mo> <mi>j</mi> <mi>c</mi></munderover>
    <msup><mi>R</mi> <mn>2</mn></msup></mrow></math>
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mrow><mi>Χ</mi> <mo>=</mo> <munderover><mo>∑</mo> <mi>i</mi>
    <mi>r</mi></munderover> <munderover><mo>∑</mo> <mi>j</mi> <mi>c</mi></munderover>
    <msup><mi>R</mi> <mn>2</mn></msup></mrow></math>
- en: where *r* and *c* are the number of rows and columns, respectively. The chi-square
    statistic for this example is 1.666. Is that more than could reasonably occur
    in a chance model?
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 其中*r*和*c*分别是行数和列数。该示例的卡方统计量为 1.666。这比在随机模型中可能出现的要多吗？
- en: 'We can test with this resampling algorithm:'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用这个重采样算法进行测试：
- en: Constitute a box with 34 ones (clicks) and 2,966 zeros (no clicks).
  id: totrans-346
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建一个盒子，其中包含 34 个“1”（点击）和 2,966 个“0”（无点击）。
- en: Shuffle, take three separate samples of 1,000, and count the clicks in each.
  id: totrans-347
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 洗牌，取三个独立的样本各 1,000 次，并计算每次的点击数。
- en: Find the squared differences between the shuffled counts and the expected counts
    and sum them.
  id: totrans-348
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 找到洗牌计数与期望计数之间的平方差异并将它们求和。
- en: Repeat steps 2 and 3, say, 1,000 times.
  id: totrans-349
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复步骤 2 和 3，例如 1,000 次。
- en: How often does the resampled sum of squared deviations exceed the observed?
    That’s the p-value.
  id: totrans-350
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重复多次的重采样平方偏差总和是否超过观察到的频次？这就是 p 值。
- en: 'The function `chisq.test` can be used to compute a resampled chi-square statistic
    in *R*. For the click data, the chi-square test is:'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 函数`chisq.test`可以用于在*R*中计算重采样卡方统计量。对于点击数据，卡方检验如下：
- en: '[PRE22]'
  id: totrans-352
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: The test shows that this result could easily have been obtained by randomness.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 测试表明，这个结果很可能是随机得到的。
- en: 'To run a permutation test in *Python*, use the following implementation:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
  zh: 要在*Python*中运行置换检验，请使用以下实现：
- en: '[PRE23]'
  id: totrans-355
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Chi-Square Test: Statistical Theory'
  id: totrans-356
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 卡方检验：统计理论
- en: 'Asymptotic statistical theory shows that the distribution of the chi-square
    statistic can be approximated by a *chi-square distribution* (see [“Chi-Square
    Distribution”](ch02.xhtml#chi-square-dist)). The appropriate standard chi-square
    distribution is determined by the *degrees of freedom* (see [“Degrees of Freedom”](#DOF)).
    For a contingency table, the degrees of freedom are related to the number of rows
    (*r*) and columns (*c*) as follows:'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 渐近统计理论表明，卡方统计量的分布可以近似为*卡方分布*（见 [“卡方分布”](ch02.xhtml#chi-square-dist)）。适当的标准卡方分布由*自由度*决定（见
    [“自由度”](#DOF)）。对于列联表，自由度与行数（*r*）和列数（*c*）相关如下：
- en: <math display="block"><mrow><mtext>degrees</mtext> <mtext>of</mtext> <mtext>freedom</mtext>
    <mo>=</mo> <mo>(</mo> <mi>r</mi> <mo>-</mo> <mn>1</mn> <mo>)</mo> <mo>×</mo> <mo>(</mo>
    <mi>c</mi> <mo>-</mo> <mn>1</mn> <mo>)</mo></mrow></math>
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: <math display="block"><mrow><mtext>degrees</mtext> <mtext>of</mtext> <mtext>freedom</mtext>
    <mo>=</mo> <mo>(</mo> <mi>r</mi> <mo>-</mo> <mn>1</mn> <mo>)</mo> <mo>×</mo> <mo>(</mo>
    <mi>c</mi> <mo>-</mo> <mn>1</mn> <mo>)</mo></mrow></math>
- en: The chi-square distribution is typically skewed, with a long tail to the right;
    see [Figure 3-7](#ChiSquareDist) for the distribution with 1, 2, 5, and 20 degrees
    of freedom. The further out on the chi-square distribution the observed statistic
    is, the lower the p-value.
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方分布通常是偏态的，右侧有一个长尾；详见[图 3-7](#ChiSquareDist)，其中包括 1、2、5 和 20 自由度的分布。观察到的统计量越偏离卡方分布的中心，p
    值就越低。
- en: 'The function `chisq.test` can be used to compute the p-value using the chi-square
    distribution as a reference:'
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 函数 `chisq.test` 可用于使用卡方分布作为参考计算 p 值：
- en: '[PRE24]'
  id: totrans-361
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'In *Python*, use the function `scipy.stats.chi2_contingency`:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *Python* 中，使用函数 `scipy.stats.chi2_contingency`：
- en: '[PRE25]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: The p-value is a little less than the resampling p-value; this is because the
    chi-square distribution is only an approximation of the actual distribution of
    the statistic.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: p 值略低于重采样 p 值；这是因为卡方分布仅是统计量实际分布的近似。
- en: '![Chi-square distribution for 1, 2, 5 and 20 degrees of freedom](Images/psd2_0307.png)'
  id: totrans-365
  prefs: []
  type: TYPE_IMG
  zh: '![1, 2, 5 和 20 自由度的卡方分布](Images/psd2_0307.png)'
- en: Figure 3-7\. Chi-square distribution with various degrees of freedom
  id: totrans-366
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 3-7\. 具有不同自由度的卡方分布
- en: Fisher’s Exact Test
  id: totrans-367
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 费希尔精确检验
- en: 'The chi-square distribution is a good approximation of the shuffled resampling
    test just described, except when counts are extremely low (single digits, especially
    five or fewer). In such cases, the resampling procedure will yield more accurate
    p-values. In fact, most statistical software has a procedure to actually enumerate
    *all* the possible rearrangements (permutations) that can occur, tabulate their
    frequencies, and determine exactly how extreme the observed result is. This is
    called *Fisher’s exact test* after the great statistician R. A. Fisher. *R* code
    for Fisher’s exact test is simple in its basic form:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方分布是刚刚描述的洗牌重采样测试的良好近似，除非计数非常低（特别是五个或更少）。在这种情况下，重采样过程将产生更准确的 p 值。事实上，大多数统计软件都有一个过程，可以实际枚举所有可能的重新排列（排列），记录它们的频率，并确定观察结果的极端程度。这被称为*费希尔精确检验*，以伟大的统计学家
    R. A. 费希尔命名。*R* 中费希尔精确检验的基本形式代码很简单：
- en: '[PRE26]'
  id: totrans-369
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: The p-value is very close to the p-value of 0.4853 obtained using the resampling
    method.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: p 值非常接近使用重采样方法得到的 p 值 0.4853。
- en: Where some counts are very low but others are quite high (e.g., the denominator
    in a conversion rate), it may be necessary to do a shuffled permutation test instead
    of a full exact test, due to the difficulty of calculating all possible permutations.
    The preceding *R* function has several arguments that control whether to use this
    approximation (`simulate.p.value=TRUE or FALSE`), how many iterations should be
    used (`B=...`), and a computational constraint (`workspace=...`) that limits how
    far calculations for the *exact* result should go.
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 在一些计数非常低而其他计数相当高的情况下（例如转化率中的分母），可能需要执行一个洗牌重排测试，而不是完全精确的检验，因为计算所有可能的排列的难度。前述的
    *R* 函数有几个参数可以控制是否使用这种近似 (`simulate.p.value=TRUE or FALSE`)，使用多少次迭代 (`B=...`)，以及限制计算
    *精确* 结果的计算约束 (`workspace=...`)。
- en: There is no implementation of Fisher’s exact test easily available in *Python*.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *Python* 中，没有费希尔精确检验的易于使用的实现。
- en: Relevance for Data Science
  id: totrans-373
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据科学的相关性
- en: The chi-square test, or Fisher’s exact test, is used when you want to know whether
    an effect is for real or might be the product of chance. In most classical statistical
    applications of the chi-square test, its role is to establish statistical significance,
    which is typically needed before a study or an experiment can be published. This
    is not so important for data scientists. In most data science experiments, whether
    A/B or A/B/C…, the goal is not simply to establish statistical significance but
    rather to arrive at the best treatment. For this purpose, multi-armed bandits
    (see [“Multi-Arm Bandit Algorithm”](#bandits)) offer a more complete solution.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方检验或费希尔精确检验，用于确定效应是否真实或可能是偶然产生的结果。在大多数经典统计应用中，卡方检验的作用是建立统计显著性，在研究或实验发表之前通常是必需的。但对于数据科学家来说，并不是那么重要。在大多数数据科学实验中，无论是
    A/B 测试还是 A/B/C...，目标不仅仅是建立统计显著性，而是找到最佳处理方法。为此，多臂赌博机算法（参见[“多臂赌博机算法”](#bandits)）提供了更完整的解决方案。
- en: One data science application of the chi-square test, especially Fisher’s exact
    version, is in determining appropriate sample sizes for web experiments. These
    experiments often have very low click rates, and despite thousands of exposures,
    count rates might be too small to yield definitive conclusions in an experiment.
    In such cases, Fisher’s exact test, the chi-square test, and other tests can be
    useful as a component of power and sample size calculations (see [“Power and Sample
    Size”](#PowerSampleSize)).
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方检验的一个数据科学应用，特别是Fisher确切版本，是确定网页实验的适当样本大小。这些实验通常具有非常低的点击率，尽管曝光量可能很高，但计数率可能太低，无法在实验中得出明确的结论。在这种情况下，Fisher确切检验、卡方检验和其他检验可以作为功效和样本大小计算的组成部分是有用的（见[“功效和样本大小”](#PowerSampleSize)）。
- en: Chi-square tests are used widely in research by investigators in search of the
    elusive statistically significant p-value that will allow publication. Chi-square
    tests, or similar resampling simulations, are used in data science applications
    more as a filter to determine whether an effect or a feature is worthy of further
    consideration than as a formal test of significance. For example, they are used
    in spatial statistics and mapping to determine whether spatial data conforms to
    a specified null distribution (e.g., are crimes concentrated in a certain area
    to a greater degree than random chance would allow?). They can also be used in
    automated feature selection in machine learning, to assess class prevalence across
    features and identify features where the prevalence of a certain class is unusually
    high or low, in a way that is not compatible with random variation.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 卡方检验广泛应用于研究中，研究人员希望找到那个难以捉摸的具有统计显著性的p值，这将允许发表成果。卡方检验或类似的重抽样模拟在数据科学应用中更多地作为一种筛选工具，用于确定效应或特征是否值得进一步考虑，而不是作为正式的显著性检验。例如，在空间统计和地图制作中使用它们来确定空间数据是否符合指定的空值分布（例如，犯罪是否比随机机会更集中在某一区域？）。它们还可以用于机器学习中的自动特征选择，以评估跨特征的类别普遍性，并识别类别普遍性异常高或低的特征，这与随机变化不兼容。
- en: Further Reading
  id: totrans-377
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: R. A. Fisher’s famous “Lady Tasting Tea” example from the beginning of the 20th
    century remains a simple and effective illustration of his exact test. Google
    “Lady Tasting Tea,” and you will find a number of good writeups.
  id: totrans-378
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: R·A·费舍尔在20世纪初著名的“品茶女士”例子仍然是他确切检验的一个简单有效的说明。搜索“品茶女士”，你会找到一些很好的文章。
- en: Stat Trek offers a [good tutorial on the chi-square test](https://oreil.ly/77DUf).
  id: totrans-379
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Stat Trek提供了一个[卡方检验的好教程](https://oreil.ly/77DUf)。
- en: Multi-Arm Bandit Algorithm
  id: totrans-380
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 多臂老虎机算法
- en: Multi-arm bandits offer an approach to testing, especially web testing, that
    allows explicit optimization and more rapid decision making than the traditional
    statistical approach to designing experiments.
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 多臂老虎机提供了一种测试方法，特别是网页测试，它允许显式优化和比传统统计方法更快的决策制定。
- en: A traditional A/B test involves data collected in an experiment, according to
    a specified design, to answer a specific question such as, “Which is better, treatment
    A or treatment B?” The presumption is that once we get an answer to that question,
    the experimenting is over and we proceed to act on the results.
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 传统的A/B测试涉及根据指定的设计收集实验数据，以回答特定问题，例如，“哪个更好，处理A还是处理B？”假设一旦我们得到了这个问题的答案，实验就结束了，我们就可以根据结果采取行动。
- en: 'You can probably perceive several difficulties with that approach. First, our
    answer may be inconclusive: “effect not proven.” In other words, the results from
    the experiment may suggest an effect, but if there is an effect, we don’t have
    a big enough sample to prove it (to the satisfaction of the traditional statistical
    standards). What decision do we take? Second, we might want to begin taking advantage
    of results that come in prior to the conclusion of the experiment. Third, we might
    want the right to change our minds or to try something different based on additional
    data that comes in after the experiment is over. The traditional approach to experiments
    and hypothesis tests dates from the 1920s and is rather inflexible. The advent
    of computer power and software has enabled more powerful flexible approaches.
    Moreover, data science (and business in general) is not so worried about statistical
    significance, but concerned more with optimizing overall effort and results.'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能会发现这种方法存在几个困难。首先，我们的答案可能不确定：“效果未被证明”。换句话说，实验结果可能显示出效果，但如果有效果，我们没有足够大的样本来证明它（达到传统统计标准的要求）。我们应该做出什么决定？其次，我们可能希望在实验结束之前开始利用获得的结果。第三，我们可能希望根据实验结束后获得的额外数据改变主意或尝试其他方法。传统的实验和假设检验方法可以追溯到20世纪20年代，而且相当死板。计算机技术和软件的出现使得更加强大和灵活的方法成为可能。此外，数据科学（以及业务普遍）并不像传统统计学那样担心统计显著性，而更关心优化整体工作和结果。
- en: Bandit algorithms, which are very popular in web testing, allow you to test
    multiple treatments at once and reach conclusions faster than traditional statistical
    designs. They take their name from slot machines used in gambling, also termed
    one-armed bandits (since they are configured in such a way that they extract money
    from the gambler in a steady flow). If you imagine a slot machine with more than
    one arm, each arm paying out at a different rate, you would have a multi-armed
    bandit, which is the full name for this algorithm.
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: 多臂老虎机算法在网络测试中非常流行，允许您同时测试多种治疗方法，并比传统统计设计更快地得出结论。它们的名字源自赌场中的老虎机，也称为单臂老虎机（因为它们被配置成稳定地从赌徒那里提取钱财）。如果您想象一个有多个手臂的老虎机，每个手臂的支付速率都不同，那么您就有了一个多臂老虎机，这就是这种算法的完整名称。
- en: 'Your goal is to win as much money as possible and, more specifically, to identify
    and settle on the winning arm sooner rather than later. The challenge is that
    you don’t know at what overall rate the arms pay out—you only know the results
    of individual pulls on the arms. Suppose each “win” is for the same amount, no
    matter which arm. What differs is the probability of a win. Suppose further that
    you initially try each arm 50 times and get the following results:'
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: 您的目标是尽可能赢取更多的钱，更具体地说，尽早确定并决定赢利的手臂。挑战在于您不知道每个手臂的总体支付率是多少 —— 您只知道各个手臂的单次拉动结果。假设每次“赢”的金额都相同，无论是哪个手臂。不同的是赢的概率。进一步假设您最初对每个手臂进行了50次尝试，并获得了以下结果：
- en: 'Arm A: 10 wins out of 50'
  id: totrans-386
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手臂 A：50 次中赢了 10 次
- en: 'Arm B: 2 win out of 50'
  id: totrans-387
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手臂 B：50 次中赢了 2 次
- en: 'Arm C: 4 wins out of 50'
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手臂 C：50 次中赢了 4 次
- en: 'One extreme approach is to say, “Looks like arm A is a winner—let’s quit trying
    the other arms and stick with A.” This takes full advantage of the information
    from the initial trial. If A is truly superior, we get the benefit of that early
    on. On the other hand, if B or C is truly better, we lose any opportunity to discover
    that. Another extreme approach is to say, “This all looks to be within the realm
    of chance—let’s keep pulling them all equally.” This gives maximum opportunity
    for alternates to A to show themselves. However, in the process, we are deploying
    what seem to be inferior treatments. How long do we permit that? Bandit algorithms
    take a hybrid approach: we start pulling A more often, to take advantage of its
    apparent superiority, but we don’t abandon B and C. We just pull them less often.
    If A continues to outperform, we continue to shift resources (pulls) away from
    B and C and pull A more often. If, on the other hand, C starts to do better, and
    A starts to do worse, we can shift pulls from A back to C. If one of them turns
    out to be superior to A and this was hidden in the initial trial due to chance,
    it now has an opportunity to emerge with further testing.'
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 一种极端的方法是说：“看起来 A 臂是赢家——让我们停止尝试其他臂并坚持使用 A。” 这充分利用了初始试验的信息。 如果 A 确实更优越，我们会从早期就获得这个好处。
    另一方面，如果 B 或 C 确实更好，我们将失去发现这一点的机会。 另一种极端的方法是说：“这一切似乎都在偶然范围内——让我们保持所有的选择机会均等。” 这给了
    A 的备选品最大的展示机会。 然而，在这个过程中，我们正在使用似乎是次优的处理方法。 我们要允许这样多久？ 赌徒算法采用混合方法：我们开始更频繁地拉 A，以利用其表面上的优势，但我们不放弃
    B 和 C。 我们只是更少地拉它们。 如果 A 继续表现优异，我们将继续将资源（拉动）从 B 和 C 转移并更频繁地拉 A。 另一方面，如果 C 开始做得更好，而
    A 开始做得更差，我们可以将拉动从 A 转移到 C。 如果其中一个证明比 A 更优秀，并且由于偶然在初始试验中隐藏了这一点，那么它现在有机会通过进一步测试出现。
- en: Now think of applying this to web testing. Instead of multiple slot machine
    arms, you might have multiple offers, headlines, colors, and so on being tested
    on a website. Customers either click (a “win” for the merchant) or don’t click.
    Initially, the offers are shown randomly and equally. If, however, one offer starts
    to outperform the others, it can be shown (“pulled”) more often. But what should
    the parameters of the algorithm that modifies the pull rates be? What “pull rates”
    should we change to, and when should we change?
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 现在考虑将其应用于网页测试。 而不是多个老虎机臂，您可能在网站上测试多个优惠、标题、颜色等。 客户要么点击（对商家来说是“赢”），要么不点击。 最初，优惠是随机和平等地显示的。
    但是，如果一个优惠开始优于其他优惠，它可以更频繁地显示（“拉动”）。 但是，修改拉动率的算法的参数应该是什么？ 我们应该将“拉动率”更改为什么，以及何时更改？
- en: 'Here is one simple algorithm, the epsilon-greedy algorithm for an A/B test:'
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一个简单的算法，用于 A/B 测试的 epsilon-greedy 算法：
- en: Generate a uniformly distributed random number between 0 and 1.
  id: totrans-392
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成一个介于 0 和 1 之间的均匀分布随机数。
- en: 'If the number lies between 0 and epsilon (where epsilon is a number between
    0 and 1, typically fairly small), flip a fair coin (50/50 probability), and:'
  id: totrans-393
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果数字在 0 到 epsilon 之间（其中 epsilon 是介于 0 和 1 之间的数字，通常相当小），则抛硬币（50/50 概率），并且：
- en: If the coin is heads, show offer A.
  id: totrans-394
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果硬币正面朝上，则显示优惠 A。
- en: If the coin is tails, show offer B.
  id: totrans-395
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果硬币是反面朝上，则显示优惠 B。
- en: If the number is ≥ epsilon, show whichever offer has had the highest response
    rate to date.
  id: totrans-396
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果数字 ≥ epsilon，则显示到目前为止响应率最高的优惠。
- en: Epsilon is the single parameter that governs this algorithm. If epsilon is 1,
    we end up with a standard simple A/B experiment (random allocation between A and
    B for each subject). If epsilon is 0, we end up with a purely *greedy* algorithm—one
    that chooses the best available immediate option (a local optimum). It seeks no
    further experimentation, simply assigning subjects (web visitors) to the best-performing
    treatment.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: Epsilon 是控制此算法的单个参数。 如果 epsilon 为 1，则我们最终得到一个标准的简单 A/B 实验（对每个对象在 A 和 B 之间进行随机分配）。
    如果 epsilon 为 0，则我们最终得到一个纯粹的 *贪心* 算法——选择最佳的可用即时选项（局部最优解）。 它不寻求进一步的实验，只是将对象（网站访问者）分配给表现最佳的处理方式。
- en: 'A more sophisticated algorithm uses “Thompson’s sampling.” This procedure “samples”
    (pulls a bandit arm) at each stage to maximize the probability of choosing the
    best arm. Of course you don’t know which is the best arm—that’s the whole problem!—but
    as you observe the payoff with each successive draw, you gain more information.
    Thompson’s sampling uses a Bayesian approach: some prior distribution of rewards
    is assumed initially, using what is called a *beta distribution* (this is a common
    mechanism for specifying prior information in a Bayesian problem). As information
    accumulates from each draw, this information can be updated, allowing the selection
    of the next draw to be better optimized as far as choosing the right arm.'
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 更复杂的算法使用“汤普森抽样”。该过程在每个阶段“抽样”（拉动老虎机手臂）以最大化选择最佳手臂的概率。当然，你不知道哪个是最佳手臂——这正是整个问题的关键！但随着每次抽样的观察结果，你会获得更多信息。汤普森抽样采用贝叶斯方法：最初假设一些奖励的先验分布，使用所谓的*贝塔分布*（这是贝叶斯问题中指定先验信息的常见机制）。随着每次抽样积累的信息，可以更新此信息，允许更好地优化选择正确的手臂。
- en: Bandit algorithms can efficiently handle 3+ treatments and move toward optimal
    selection of the “best.” For traditional statistical testing procedures, the complexity
    of decision making for 3+ treatments far outstrips that of the traditional A/B
    test, and the advantage of bandit algorithms is much greater.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 赌徒算法能够高效处理3个以上的处理，并朝向选择“最佳”方向优化。对于传统的统计测试程序，处理3个以上的复杂决策远远超过传统的A/B测试，赌徒算法的优势则更为明显。
- en: Further Reading
  id: totrans-400
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: An excellent short treatment of multi-arm bandit algorithms is found in *Bandit
    Algorithms for Website Optimization*, by John Myles White (O’Reilly, 2012). White
    includes *Python* code, as well as the results of simulations to assess the performance
    of bandits.
  id: totrans-401
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: John Myles White在《网站优化的赌徒算法》（O’Reilly, 2012）中对多臂老虎机算法进行了出色的简要介绍。White包括*Python*代码，以及评估老虎机性能的模拟结果。
- en: For more (somewhat technical) information about Thompson sampling, see [“Analysis
    of Thompson Sampling for the Multi-armed Bandit Problem”](https://oreil.ly/OgWrG)
    by Shipra Agrawal and Navin Goyal.
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于汤普森抽样的更多（稍微技术性的）信息，请参见[《多臂老虎机问题的汤普森抽样分析》](https://oreil.ly/OgWrG)，作者是Shipra
    Agrawal和Navin Goyal。
- en: Power and Sample Size
  id: totrans-403
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 动力和样本量
- en: If you run a web test, how do you decide how long it should run (i.e., how many
    impressions per treatment are needed)? Despite what you may read in many guides
    to web testing, there is no good general guidance—it depends, mainly, on the frequency
    with which the desired goal is attained.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你进行网页测试，如何决定它应该运行多长时间（即每种处理需要多少次印象）？尽管你可能在许多网页测试指南中读到，没有好的通用指导——这主要取决于实现期望目标的频率。
- en: One step in statistical calculations for sample size is to ask “Will a hypothesis
    test actually reveal a difference between treatments A and B?” The outcome of
    a hypothesis test—the p-value—depends on what the real difference is between treatment
    A and treatment B. It also depends on the luck of the draw—who gets selected for
    the groups in the experiment. But it makes sense that the bigger the actual difference
    between treatments A and B, the greater the probability that our experiment will
    reveal it; and the smaller the difference, the more data will be needed to detect
    it. To distinguish between a .350 hitter and a .200 hitter in baseball, not that
    many at-bats are needed. To distinguish between a .300 hitter and a .280 hitter,
    a good many more at-bats will be needed.
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 在样本量统计计算中，判断一个假设检验是否能够揭示处理A和处理B之间的差异是一个步骤。假设检验的结果——p值——取决于处理A和处理B之间的实际差异大小，也取决于实验中选择组的随机性。但逻辑上讲，处理A和处理B之间的实际差异越大，我们的实验揭示它的可能性就越大；而差异越小，就需要更多数据来检测它。在棒球中区分打击率为.350和.200的击球手，并不需要很多打数。而要区分打击率为.300和.280的击球手，则需要更多打数。
- en: '*Power* is the probability of detecting a specified *effect size* with specified
    sample characteristics (size and variability). For example, we might say (hypothetically)
    that the probability of distinguishing between a .330 hitter and a .200 hitter
    in 25 at-bats is 0.75. The effect size here is a difference of .130. And “detecting”
    means that a hypothesis test will reject the null hypothesis of “no difference”
    and conclude there is a real effect. So the experiment of 25 at-bats (*n* = 25)
    for two hitters, with an effect size of 0.130, has (hypothetical) power of 0.75,
    or 75%.'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: '*功效*是指在具有特定样本特征（大小和变异性）的情况下检测到指定*效应大小*的概率。例如，我们可能会（假设地）说，在 25 次打击中区分 .330 的击球手和
    .200 的击球手的概率是 0.75。这里的效应大小是 0.130 的差异。“检测”意味着假设检验将拒绝“没有差异”的零假设，并得出存在真实效应的结论。因此，对于两名击球手的
    25 次打击实验（*n* = 25），效应大小为 0.130，具有（假设的）功效为 0.75，或 75%。'
- en: 'You can see that there are several moving parts here, and it is easy to get
    tangled up in the numerous statistical assumptions and formulas that will be needed
    (to specify sample variability, effect size, sample size, alpha-level for the
    hypothesis test, etc., and to calculate power). Indeed, there is special-purpose
    statistical software to calculate power. Most data scientists will not need to
    go through all the formal steps needed to report power, for example, in a published
    paper. However, they may face occasions where they want to collect some data for
    an A/B test, and collecting or processing the data involves some cost. In that
    case, knowing approximately how much data to collect can help avoid the situation
    where you collect data at some effort, and the result ends up being inconclusive.
    Here’s a fairly intuitive alternative approach:'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到这里有几个可变部分，很容易在需要的众多统计假设和公式中陷入混乱（用于指定样本变异性、效应大小、样本大小、假设检验的 alpha 水平等，并计算功效）。事实上，有专门的统计软件来计算功效。大多数数据科学家不需要经历报告功效所需的所有正式步骤，例如在发表的论文中。但是，他们可能会面临一些情况，他们希望为
    A/B 测试收集一些数据，而收集或处理数据涉及一些成本。在这种情况下，知道大约需要收集多少数据可以帮助避免这样的情况，即您付出一些努力收集数据，而结果最终变得无法确定。这里有一种相当直观的替代方法：
- en: Start with some hypothetical data that represents your best guess about the
    data that will result (perhaps based on prior data)—for example, a box with 20
    ones and 80 zeros to represent a .200 hitter, or a box with some observations
    of “time spent on website.”
  id: totrans-408
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从一些假设数据开始，这些数据代表了您对结果数据的最佳猜测（可能基于先前数据）—例如，一个包含20个1和80个0的盒子，代表一个 .200 的击球率，或者一个包含一些“网站上花费时间”的观察结果的盒子。
- en: Create a second sample simply by adding the desired effect size to the first
    sample—for example, a second box with 33 ones and 67 zeros, or a second box with
    25 seconds added to each initial “time spent on website.”
  id: totrans-409
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 简单地通过在第一个样本上添加所需的效应大小来创建第二个样本—例如，一个包含33个1和67个0的第二个盒子，或者一个在每个初始“网站上花费时间”上添加25秒的第二个盒子。
- en: Draw a bootstrap sample of size *n* from each box.
  id: totrans-410
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从每个盒子中抽取大小为 *n* 的自举样本。
- en: Conduct a permutation (or formula-based) hypothesis test on the two bootstrap
    samples and record whether the difference between them is statistically significant.
  id: totrans-411
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对两个自举样本进行排列（或基于公式的）假设检验，并记录它们之间的差异是否在统计上显著。
- en: Repeat the preceding two steps many times and determine how often the difference
    was significant—that’s the estimated power.
  id: totrans-412
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 多次重复前面两个步骤，并确定差异显著的频率—这就是估计的功效。
- en: Sample Size
  id: totrans-413
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 样本大小
- en: The most common use of power calculations is to estimate how big a sample you
    will need.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 功效计算最常见的用途是估计您需要多大的样本。
- en: For example, suppose you are looking at click-through rates (clicks as a percentage
    of exposures), and testing a new ad against an existing ad. How many clicks do
    you need to accumulate in the study? If you are interested only in results that
    show a huge difference (say, a 50% difference), a relatively small sample might
    do the trick. If, on the other hand, even a minor difference would be of interest,
    then a much larger sample is needed. A standard approach is to establish a policy
    that a new ad must do better than an existing ad by some percentage, say, 10%;
    otherwise, the existing ad will remain in place. This goal, the “effect size,”
    then drives the sample size.
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设您正在观察点击率（点击数占曝光数的百分比），并测试一个新广告与现有广告的差异。在研究中需要累积多少点击次数？如果您只对显示出巨大差异的结果感兴趣（比如50%的差异），可能一个相对较小的样本就足够了。另一方面，如果即使是微小的差异也值得关注，那么就需要一个更大的样本。一个标准的方法是建立一个政策，即新广告必须比现有广告好出一定百分比，比如10%；否则，现有广告将继续使用。这个目标，即“效应大小”，驱动着样本量。
- en: 'For example, suppose current click-through rates are about 1.1%, and you are
    seeking a 10% boost to 1.21%. So we have two boxes: box A with 1.1% ones (say,
    110 ones and 9,890 zeros), and box B with 1.21% ones (say, 121 ones and 9,879
    zeros). For starters, let’s try 300 draws from each box (this would be like 300
    “impressions” for each ad). Suppose our first draw yields the following:'
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设当前的点击率约为1.1%，您希望增加到1.21%。所以我们有两个盒子：盒子A有1.1%的1（比如，110个1和9,890个0），盒子B有1.21%的1（比如，121个1和9,879个0）。首先，让我们从每个盒子中尝试300次抽样（这相当于每个广告300次“曝光”）。假设我们第一次抽样结果如下：
- en: 'Box A: 3 ones'
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 盒子A：3个1
- en: 'Box B: 5 ones'
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 盒子B：5个1
- en: Right away we can see that any hypothesis test would reveal this difference
    (5 versus 3) to be well within the range of chance variation. This combination
    of sample size (*n* = 300 in each group) and effect size (10% difference) is too
    small for any hypothesis test to reliably show a difference.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 立即就可以看出，任何假设检验都会显示这种差异（5比3）远远在随机变动范围内。样本量（*n* = 每组300个）和效应大小（10%的差异）的组合太小，以至于任何假设检验都无法可靠地显示出差异。
- en: So we can try increasing the sample size (let’s try 2,000 impressions), and
    require a larger improvement (50% instead of 10%).
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以尝试增加样本量（让我们尝试2,000次曝光），并要求更大的改进（50%而不是10%）。
- en: 'For example, suppose current click-through rates are still 1.1%, but we are
    now seeking a 50% boost to 1.65%. So we have two boxes: box A still with 1.1%
    ones (say, 110 ones and 9,890 zeros), and box B with 1.65% ones (say, 165 ones
    and 9,868 zeros). Now we’ll try 2,000 draws from each box. Suppose our first draw
    yields the following:'
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设当前的点击率仍然是1.1%，但我们现在希望增加50%到1.65%。所以我们有两个盒子：盒子A仍然有1.1%的1（比如，110个1和9,890个0），盒子B有1.65%的1（比如，165个1和9,868个0）。现在我们将从每个盒子中抽取2,000次。假设我们第一次抽样结果如下：
- en: 'Box A: 19 ones'
  id: totrans-422
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 盒子A：19个1
- en: 'Box B: 34 ones'
  id: totrans-423
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 盒子B：34个1
- en: A significance test on this difference (34–19) shows it still registers as “not
    significant” (though much closer to significance than the earlier difference of
    5–3). To calculate power, we would need to repeat the previous procedure many
    times, or use statistical software that can calculate power, but our initial draw
    suggests to us that even detecting a 50% improvement will require several thousand
    ad impressions.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这种差异（34-19）的显著性检验仍然显示为“不显著”（尽管比之前的5-3差异更接近显著）。要计算功率，我们需要多次重复上述过程，或者使用可以计算功率的统计软件，但我们最初的抽样结果提示我们，即使是检测到50%的改进，也需要数千次广告曝光。
- en: 'In summary, for calculating power or required sample size, there are four moving
    parts:'
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 总结一下，用于计算功率或所需样本量的有四个变动部分：
- en: Sample size
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 样本量
- en: Effect size you want to detect
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您希望检测的效应大小
- en: Significance level (alpha) at which the test will be conducted
  id: totrans-428
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 进行测试的显著水平（α）
- en: Power
  id: totrans-429
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 功率
- en: 'Specify any three of them, and the fourth can be calculated. Most commonly,
    you would want to calculate sample size, so you must specify the other three.
    With *R* and *Python*, you also have to specify the alternative hypothesis as
    “greater” or “larger” to get a one-sided test; see [“One-Way Versus Two-Way Hypothesis
    Tests”](#directional) for more discussion of one-way versus two-way tests. Here
    is *R* code for a test involving two proportions, where both samples are the same
    size (this uses the `pwr` package):'
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 指定其中三个，第四个可以计算。通常，您希望计算样本大小，因此必须指定其他三个。使用*R*和*Python*，您还必须指定备择假设为“更大”或“较大”，以进行单侧检验；请参阅[“单向与双向假设检验”](#directional)了解更多单侧与双侧检验的讨论。这里是一个涉及两个比例的检验的*R*代码，其中两个样本大小相同（使用`pwr`包）：
- en: '[PRE27]'
  id: totrans-431
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: The function `ES.h` calculates the effect size. We see that if we want a power
    of 80%, we require a sample size of almost 120,000 impressions. If we are seeking
    a 50% boost (`p1=0.0165`), the sample size is reduced to 5,500 impressions.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: 函数`ES.h`计算效应大小。我们看到，如果我们希望达到80%的功效，我们需要近120,000次印象的样本大小。如果我们寻求50%的增长（`p1=0.0165`），样本大小可减少到5,500次印象。
- en: 'The `statsmodels` package contains several methods for power calculation. Here,
    we use `proportion_effectsize` to calculate the effect size and `TTestIndPower`
    to solve for the sample size:'
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: '`statsmodels`包含几种功效计算方法。在这里，我们使用`proportion_effectsize`来计算效应大小，并使用`TTestIndPower`来解决样本大小：'
- en: '[PRE28]'
  id: totrans-434
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Further Reading
  id: totrans-435
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: '*Sample Size Determination and Power* by Thomas Ryan (Wiley, 2013) is a comprehensive
    and readable review of this subject.'
  id: totrans-436
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*样本大小确定和功效*，作者托马斯·瑞安（Thomas Ryan）（Wiley, 2013），对这一主题进行了全面而易读的评论。'
- en: Steve Simon, a statistical consultant, has written a [very engaging narrative-style
    post on the subject](https://oreil.ly/18mtp).
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 统计顾问史蒂夫·西蒙（Steve Simon）撰写了一篇[非常引人入胜的叙事风格文章](https://oreil.ly/18mtp)。
- en: Summary
  id: totrans-438
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: The principles of experimental design—randomization of subjects into two or
    more groups receiving different treatments—allow us to draw valid conclusions
    about how well the treatments work. It is best to include a control treatment
    of “making no change.” The subject of formal statistical inference—hypothesis
    testing, p-values, t-tests, and much more along these lines—occupies much time
    and space in a traditional statistics course or text, and the formality is mostly
    unneeded from a data science perspective. However, it remains important to recognize
    the role that random variation can play in fooling the human brain. Intuitive
    resampling procedures (permutation and bootstrap) allow data scientists to gauge
    the extent to which chance variation can play a role in their data analysis.
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 实验设计原则——将受试者随机分配到接受不同处理的两个或多个组中——允许我们对处理效果进行有效结论。最好包括“不做任何变化”的对照处理。正式的统计推断——假设检验、p值、t检验以及更多类似内容——在传统统计课程或文本中占据了大量时间和空间，但从数据科学的角度来看，这种形式大多数情况下并不需要。然而，仍然重要的是认识到随机变异可能会在数据分析中误导人类大脑的角色。直观的重采样过程（排列和自举）使数据科学家能够评估偶然变异在其数据分析中的作用程度。
- en: ^([1](ch03.xhtml#idm46522858323800-marker)) The multiplication rule states that
    the probability of *n* independent events all happening is the product of the
    individual probabilities. For example, if you and I each flip a coin once, the
    probability that your coin and my coin will both land heads is 0.5 × 0.5 = 0.25.
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: ^([1](ch03.xhtml#idm46522858323800-marker)) 乘法规则指出，*n*个独立事件同时发生的概率等于各个事件概率的乘积。例如，如果你和我各抛一次硬币，你的硬币和我的硬币都是正面朝上的概率是0.5
    × 0.5 = 0.25。
