- en: 13 Generalized linear models
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 13 广义线性模型
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Formulating a generalized linear model
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建广义线性模型
- en: Predicting categorical outcomes
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预测分类结果
- en: Modeling count data
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型计数数据
- en: 'In chapters 8 (regression) and 9 (ANOVA), we explored linear models that can
    be used to predict a normally distributed response variable from a set of continuous
    and/or categorical predictor variables. But in many situations, it’s unreasonable
    to assume that the dependent variable is normally distributed (or even continuous).
    For example:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在第8章（回归）和第9章（方差分析）中，我们探讨了可以用来从一组连续和/或分类预测变量预测正态分布响应变量的线性模型。但在许多情况下，假设因变量是正态分布的（甚至连续的）是不合理的。例如：
- en: The outcome variable may be categorical. Binary variables (for example, yes/no,
    passed/failed, lived/died) and polytomous variables (for example, poor/good/excellent,
    Republican/Democrat/independent) clearly aren’t normally distributed.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果变量可能是分类的。二元变量（例如，是/否、通过/失败、活着/死去）和多分类变量（例如，差/好/优秀、共和党/民主党/独立）显然不是正态分布的。
- en: The outcome variable may be a count (for example, the number of traffic accidents
    in a week, the number of drinks per day). Such variables take on a limited number
    of values and are never negative. Additionally, their mean and variance are often
    related (which isn’t true for normally distributed variables).
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果变量可能是一个计数（例如，一周内发生的交通事故数量，每天饮酒的数量）。这样的变量只取有限数量的值，永远不会是负数。此外，它们的均值和方差通常相关（这对于正态分布变量来说是不成立的）。
- en: '*Generalized linear models* extend the linear-model framework to include dependent
    variables that are decidedly non-normal.'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '*广义线性模型* 将线性模型框架扩展到包括明显非正态的因变量。'
- en: 'In this chapter, we’ll start with a brief overview of generalized linear models
    and the `glm()` function used to estimate them. Then we’ll focus on two popular
    models in this framework: *logistic regression* (where the dependent variable
    is categorical) and *Poisson regression* (where the dependent variable is a count
    variable).'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将从广义线性模型和用于估计它们的 `glm()` 函数的简要概述开始。然后我们将关注该框架中两种流行的模型：*逻辑回归*（其中因变量是分类的）和*泊松回归*（其中因变量是计数变量）。
- en: 'To motivate the discussion, you’ll apply generalized linear models to two research
    questions that aren’t easily addressed with standard linear models:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 为了激发讨论，你将应用广义线性模型来解决两个标准线性模型难以解决的问题：
- en: What personal, demographic, and relationship variables predict marital infidelity?
    In this case, the outcome variable is binary (affair/no affair).
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 哪些个人、人口统计和关系变量可以预测婚外情？在这种情况下，结果变量是二元的（有外遇/无外遇）。
- en: What impact does a drug treatment for seizures have on the number of seizures
    experienced over an eight-week period? In this case, the outcome variable is a
    count (number of seizures).
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 抗癫痫药物对在八周期间经历的癫痫发作次数有什么影响？在这种情况下，结果变量是一个计数（癫痫发作次数）。
- en: You’ll apply logistic regression to address the first question and Poison regression
    to address the second. Along the way, we’ll consider extensions of each technique.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 你将应用逻辑回归来解决第一个问题，并使用泊松回归来解决第二个问题。在这个过程中，我们将考虑每种技术的扩展。
- en: 13.1 Generalized linear models and the glm() function
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.1 广义线性模型和glm()函数
- en: A wide range of popular data analytic methods are subsumed within the framework
    of the generalized linear model. In this section, we’ll briefly explore some of
    the theory behind this approach. You can safely skip this section if you like
    and come back to it later.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 许多流行的数据分析方法都包含在广义线性模型的框架内。在本节中，我们将简要探讨这种方法的背后的一些理论。如果你愿意，可以安全地跳过这一节，稍后再回来。
- en: Let’s say that you want to model the relationship between a response variable
    *Y* and a set of *p* predictor variables *X*[1] ... *X[p]*. In the standard linear
    model, you assume that *Y* is normally distributed and that the form of the relationship
    is
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你想建立一个响应变量 *Y* 与一组 *p* 个预测变量 *X*[1] ... *X[p]* 之间的关系模型。在标准线性模型中，你假设 *Y* 是正态分布的，并且关系的形式是
- en: '![](Images/CH13_F00_Kabacoff3-EQ01.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH13_F00_Kabacoff3-EQ01.png)'
- en: This equation states that the conditional mean of the response variable is a
    linear combination of the predictor variables. The *β*[j] are the parameters specifying
    the expected change in *Y* for a unit change in *X*[j], and *β*[0] is the expected
    value of *Y* when all the predictor variables are 0\. You’re saying that you can
    predict the mean of the *Y* distribution for observations with a given set of
    *X* values by applying the proper weights to the *X* variables and adding them
    up.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 该方程表示反应变量的条件均值是预测变量的线性组合。*β*[j] 是指定 *X*[j] 单位变化时 *Y* 预期变化的参数，*β*[0] 是所有预测变量均为
    0 时 *Y* 的预期值。你可以说，通过应用适当的权重到 *X* 变量并将它们相加，你可以预测具有给定 *X* 值的观察值的 *Y* 分布的均值。
- en: Note that you’ve made no distributional assumptions about the predictor variables,
    *X*[j]. Unlike *Y*, there’s no requirement that they be normally distributed.
    In fact, they’re often categorical (for example, ANOVA designs). Additionally,
    nonlinear functions of the predictors are allowed. You often include such predictors
    as *X*² or *X*[1] × *X*[2]. What is important is that the equation is linear in
    the parameters (*β*[0], *β*[1],..., *β*[p]).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，你没有对预测变量 *X*[j] 做出分布假设。与 *Y* 不同，没有要求它们必须是正态分布的。事实上，它们通常是分类的（例如，方差分析设计）。此外，允许预测变量的非线性函数。你经常将此类预测变量包括为
    *X*² 或 *X*[1] × *X*[2]。重要的是，方程在参数（*β*[0]，*β*[1]，...，*β*[p]）上是线性的。
- en: In generalized linear models, you fit models of the form
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在广义线性模型中，你拟合形式为的模型
- en: '![](Images/CH13_F00_Kabacoff3-EQ02.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH13_F00_Kabacoff3-EQ02.png)'
- en: where *g*(*µ[Y]*) is a function of the conditional mean (called the *link function*).
    Additionally, you relax the assumption that *Y* is normally distributed. Instead,
    you assume that *Y* follows a distribution that’s a member of the exponential
    family. You specify the link function and the probability distribution, and the
    parameters are derived through an iterative maximum-likelihood-estimation procedure.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *g*(*µ[Y]*) 是条件均值（称为 *连接函数*）的函数。此外，你放宽了 *Y* 是正态分布的假设。相反，你假设 *Y* 遵循指数族成员的分布。你指定连接函数和概率分布，并通过迭代最大似然估计过程推导出参数。
- en: 13.1.1 The glm() function
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.1 glm() 函数
- en: Generalized linear models are typically fit in R through the `glm()` function
    (although other specialized functions are available). The form of the function
    is similar to `lm()` but includes additional parameters. The basic format of the
    function is
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 广义线性模型通常通过 R 中的 `glm()` 函数进行拟合（尽管还有其他专门的函数可用）。该函数的形式类似于 `lm()`，但包含额外的参数。函数的基本格式如下
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: where the probability distribution (*`family`*) and corresponding default link
    function (*`function`*) are given in table 13.1.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，概率分布（*`family`*）和相应的默认连接函数（*`function`*）在表 13.1 中给出。
- en: Table 13.1 `glm()` parameters
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 表 13.1 `glm()` 参数
- en: '| Family | Default link function |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| Family | Default link function |'
- en: '| `binomial` | `(link = "logit")` |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| `binomial` | `(link = "logit")` |'
- en: '| `gaussian` | `(link = "identity")` |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| `gaussian` | `(link = "identity")` |'
- en: '| `gamma` | `(link = "inverse")` |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| `gamma` | `(link = "inverse")` |'
- en: '| `inverse.gaussian` | `(link = "1/mu^2")` |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| `inverse.gaussian` | `(link = "1/mu^2")` |'
- en: '| `poisson` | `(link = "log")` |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| `poisson` | `(link = "log")` |'
- en: '| `quasi` | `(link = "identity", variance = "constant")` |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| `quasi` | `(link = "identity", variance = "constant")` |'
- en: '| `quasibinomial` | `(link = "logit")` |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| `quasibinomial` | `(link = "logit")` |'
- en: '| `quasipoisson` | `(link = "log")` |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| `quasipoisson` | `(link = "log")` |'
- en: The `glm()` function allows you to fit a number of popular models, including
    logistic regression, Poisson regression, and survival analysis (not considered
    here). You can demonstrate this for the first two models as follows. Assume that
    you have a single response variable (`Y`), three predictor variables (`X1,` `X2,`
    `X3`), and a data frame (`mydata`) containing the data.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`glm()` 函数允许你拟合多种流行的模型，包括逻辑回归、泊松回归和生存分析（此处未考虑）。你可以如下演示前两种模型。假设你有一个单一的反应变量（`Y`），三个预测变量（`X1,`
    `X2,` `X3`），以及包含数据的 `mydata` 数据框。'
- en: Logistic regression is applied to situations in which the response variable
    is dichotomous (0 or 1). The model assumes that `Y` follows a binomial distribution
    and that you can fit a linear model of the form
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归适用于反应变量为二分（0 或 1）的情况。模型假设 `Y` 遵循二项分布，并且你可以拟合形式为的线性模型
- en: '![](Images/CH13_F00_Kabacoff3-EQ03.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH13_F00_Kabacoff3-EQ03.png)'
- en: where *π* = *µ[Y]* is the conditional mean of *Y* (that is, the probability
    that *Y* = 1 given a set of *X* values), (*π*/1 – *π*) is the odds that *Y* =
    1, and log(*π*/1 – *π*) is the log odds, or *logit*. In this case, log(*π*/1 –
    *π*) is the link function, the probability distribution is binomial, and the logistic
    regression model can be fit using
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *π* = *µ[Y]* 是 *Y* 的条件均值（即给定一组 *X* 值时 *Y* = 1 的概率），(*π*/1 – *π*) 是 *Y* =
    1 的几率，log(*π*/1 – *π*) 是对数几率，或 *logit*。在这种情况下，log(*π*/1 – *π*) 是连接函数，概率分布是二项分布，逻辑回归模型可以使用
- en: '[PRE1]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Logistic regression is described more fully in section 13.2.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 逻辑回归在13.2节中描述得更详细。
- en: Poisson regression is applied to situations in which the response variable is
    the number of events to occur in a given period of time. The Poisson regression
    model assumes that *Y* follows a Poisson distribution and that you can fit a linear
    model of the form
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 泊松回归适用于响应变量是在给定时间段内发生事件数量的情况。泊松回归模型假设 *Y* 符合泊松分布，并且可以拟合形式为的线性模型
- en: '![](Images/CH13_F00_Kabacoff3-EQ04.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH13_F00_Kabacoff3-EQ04.png)'
- en: where *λ* is the mean (and variance) of *Y*. In this case, the link function
    is log(*λ*), the probability distribution is Poisson, and the Poisson regression
    model can be fit using
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 中的相同结果，其中 *λ* 是 *Y* 的均值（和方差）。在这种情况下，连接函数是 *λ* 的对数，概率分布是泊松分布，泊松回归模型可以使用
- en: '[PRE2]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Poisson regression is described in section 13.3.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 泊松回归在13.3节中描述。
- en: It’s worth noting that the standard linear model is also a special case of the
    generalized linear model. If you let the link function *g*(*µ[Y]*) = *µ[Y]* or
    the identity function and specify that the probability distribution is normal
    (Gaussian), then
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，标准线性模型也是广义线性模型的一个特例。如果你让连接函数 *g*(*µ[Y]*) = *µ[Y]* 或恒等函数，并指定概率分布是正态分布（高斯分布），那么
- en: '[PRE3]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: would produce the same results as
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 将产生与
- en: '[PRE4]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: To summarize, generalized linear models extend the standard linear model by
    fitting a *function* of the conditional mean response (rather than the conditional
    mean response) and assuming that the response variable follows a member of the
    *exponential* family of distributions (rather than being limited to the normal
    distribution). The parameter estimates are derived via maximum likelihood rather
    than least squares.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 总结来说，广义线性模型通过拟合条件均值响应的 *函数*（而不是条件均值响应）并假设响应变量遵循 *指数* 分布族（而不是仅限于正态分布）来扩展标准线性模型。参数估计是通过最大似然而不是最小二乘法得到的。
- en: 13.1.2 Supporting functions
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.2 支持函数
- en: Many of the functions that you used in conjunction with `lm()` when analyzing
    standard linear models have corresponding versions for `glm()`. Table 13.2 gives
    some commonly used functions.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 当分析标准线性模型时，你与 `lm()` 一起使用的许多函数都有 `glm()` 的对应版本。表13.2给出了一些常用函数。
- en: Table 13.2 Functions that support `glm()`
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 表13.2 支持的 `glm()` 函数
- en: '| Function | Description |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| 函数 | 描述 |'
- en: '| `summary``()` | Displays detailed results for the fitted model |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| `summary()` | 显示拟合模型的详细结果 |'
- en: '| `coefficients(), coef``()` | Lists the model parameters (intercept and slopes)
    for the fitted model |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| `coefficients(), coef()` | 列出拟合模型的模型参数（截距和斜率） |'
- en: '| `confint``()` | Provides confidence intervals for the model parameters (95%
    by default) |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| `confint()` | 提供模型参数的置信区间（默认为95%） |'
- en: '| `residuals``()` | Lists the residual values in a fitted model |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| `residuals()` | 列出拟合模型的残差值 |'
- en: '| `anova``()` | Generates an ANOVA table comparing two fitted models |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| `anova()` | 生成比较两个拟合模型的方差分析表 |'
- en: '| `plot``()` | Generates diagnostic plots for evaluating the fit of a model
    |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| `plot()` | 生成用于评估模型拟合的诊断图 |'
- en: '| `predict``()` | Uses a fitted model to predict response values for a new
    dataset |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| `predict()` | 使用拟合模型预测新数据集的响应值 |'
- en: '| `deviance``()` | Deviance for the fitted model |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| `deviance()` | 拟合模型的偏差 |'
- en: '| `df.residual``()` | Residual degrees of freedom for the fitted model |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| `df.residual()` | 拟合模型的残差自由度 |'
- en: We’ll explore examples of these functions in later sections. In the next section,
    we’ll briefly consider the assessment of model adequacy.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在后面的章节中探讨这些函数的示例。在下一节中，我们将简要考虑模型充分性的评估。
- en: 13.1.3 Model fit and regression diagnostics
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.1.3 模型拟合和回归诊断
- en: The assessment of model adequacy is as important for generalized linear models
    as it is for standard (OLS) linear models. Unfortunately, there’s less agreement
    in the statistical community regarding appropriate assessment procedures. In general,
    you can use the techniques described in chapter 8 with the following caveats.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 模型充分性的评估对于广义线性模型和标准（OLS）线性模型同样重要。不幸的是，在统计界关于适当的评估程序上存在较少的共识。一般来说，你可以使用第8章中描述的技术，但要注意以下事项。
- en: When assessing model adequacy, you’ll typically want to plot predicted values
    expressed in the metric of the original response variable against residuals of
    the deviance type. For example, a common diagnostic plot would be
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在评估模型充分性时，你通常会希望绘制以原始响应变量的度量单位表示的预测值与偏差类型残差的关系图。例如，一个常见的诊断图可以是
- en: '[PRE5]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: where `model` is the object returned by the `glm()` function.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 `model` 是 `glm()` 函数返回的对象。
- en: 'The hat values, studentized residuals, and Cook’s D statistics that R provides
    will be approximate values. Additionally, there’s no general consensus on cutoff
    values for identifying problematic observations. Values have to be judged relative
    to each other. One approach is to create index plots for each statistic and look
    for unusually large values. For example, you could use the following code to create
    three diagnostic plots:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: R提供的帽子值、学生化残差和Cook的D统计量将是近似值。此外，在确定识别问题观察值的截止值上没有普遍共识。值必须相对判断。一种方法是为每个统计量创建索引图，并寻找异常大的值。例如，你可以使用以下代码创建三个诊断图：
- en: '[PRE6]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Alternatively, you could use the code
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，你可以使用以下代码
- en: '[PRE7]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: to create one omnibus plot. In the latter graph, the horizontal axis is the
    leverage, the vertical axis is the studentized residual, and the plotted symbol
    is proportional to the Cook’s distance.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个综合图。在后一个图中，水平轴是杠杆，垂直轴是学生化残差，绘制的符号与Cook距离成正比。
- en: Diagnostic plots tend to be most helpful when the response variable takes on
    many values. When the response variable can only take on a limited number of values
    (for example, logistic regression), the utility of these plots is decreased.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 当响应变量具有许多值时，诊断图通常最有帮助。当响应变量只能取有限数量的值（例如，逻辑回归）时，这些图的效用会降低。
- en: 'For more on regression diagnostics for generalized linear models, see Fox (2008)
    and Faraway (2006). In the rest of this chapter, we’ll consider two of the most
    popular forms of the generalized linear model in detail: logistic regression and
    Poisson regression.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 关于广义线性模型的回归诊断的更多信息，请参阅Fox（2008）和Faraway（2006）。在本章的其余部分，我们将详细考虑两种最流行的广义线性模型形式：逻辑回归和泊松回归。
- en: 13.2 Logistic regression
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.2 逻辑回归
- en: Logistic regression is useful when you’re predicting a binary outcome from a
    set of continuous and/or categorical predictor variables. To demonstrate this,
    let’s explore the data on infidelity contained in the data frame `Affairs`, provided
    with the `AER` package. Be sure to download and install the package (using `install.packages("AER")`)
    before first use.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 当你需要从一组连续和/或分类预测变量预测二元结果时，逻辑回归是有用的。为了演示这一点，让我们探索包含在`Affairs`数据框中的不忠数据，该数据框由`AER`包提供。在使用之前，请确保下载并安装该包（使用`install.packages("AER")`）。
- en: The infidelity data, known as Fair’s Affairs, is based on a cross-sectional
    survey conducted by *Psychology Today* in 1969 and is described in Greene (2003)
    and Fair (1978). It contains 9 variables collected on 601 participants and includes
    how often the respondent engaged in extramarital sexual intercourse during the
    past year, as well as their gender, age, years married, whether they had children,
    their religiousness (on a 5-point scale from 1 = anti to 5 = very), education,
    occupation (Hollingshead 7-point classification with reverse numbering), and a
    numeric self-rating of their marriage (from 1 = very unhappy to 5 = very happy).
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 不忠数据，被称为Fair的Affairs，基于1969年由《心理学今天》进行的横断面调查，并在Greene（2003）和Fair（1978）中描述。它包含9个变量，收集于601名参与者，包括过去一年中受访者参与婚外性交的频率，以及他们的性别、年龄、结婚年限、是否有孩子、他们的宗教性（从1
    = 反对到5 = 非常反对的5点量表），教育、职业（Hollingshead 7点分类，反向编号）以及他们对婚姻的数值自我评价（从1 = 非常不幸福到5 =
    非常幸福）。
- en: 'Let’s look at some descriptive statistics:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一些描述性统计：
- en: '[PRE8]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: From these statistics, you can see that that 52% of respondents were female,
    72% had children, and the median age for the sample was 32 years. With regard
    to the response variable, 75% of respondents reported not engaging in an infidelity
    in the past year (451/601). The largest number of encounters reported was 12 (6%).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些统计数据中，你可以看到，52%的受访者是女性，72%有孩子，样本的中位年龄为32岁。关于响应变量，75%的受访者表示在过去一年中没有不忠行为（451/601）。报告的邂逅次数最多的是12次（6%）。
- en: 'Although the *number* of indiscretions was recorded, your interest here is
    in the binary outcome (had an affair/didn’t have an affair). You can transform
    affairs into a dichotomous factor called `ynaffair` with the following code:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然记录了不检点的*数量*，但你的兴趣在于二进制结果（是否出轨/没有出轨）。你可以使用以下代码将出轨转换为一个名为`ynaffair`的二分因素：
- en: '[PRE9]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'This dichotomous factor can now be used as the outcome variable in a logistic
    regression model:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 这个二分因素现在可以用作逻辑回归模型中的结果变量：
- en: '[PRE10]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'From the p-values for the regression coefficients (the last column), you can
    see that gender, presence of children, education, and occupation may not make
    a significant contribution to the equation (you can’t reject the hypothesis that
    the parameters are 0). Let’s fit a second equation without them and test whether
    this reduced model fits the data as well:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 从回归系数的p值（最后一列）中，你可以看到性别、孩子是否存在、教育和职业可能对等式没有显著的贡献（你不能拒绝参数为0的假设）。让我们拟合一个没有它们的第二个等式，并测试这个简化模型是否与数据拟合得一样好：
- en: '[PRE11]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Each regression coefficient in the reduced model is statistically significant
    (p < .05). Because the two models are nested (`fit.reduced` is a subset of `fit.full`),
    you can use the `anova()` function to compare them. For generalized linear models,
    you’ll want a chi-square version of this test:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 简化模型中的每个回归系数都具有统计学意义（p < .05）。因为两个模型是嵌套的（`fit.reduced`是`fit.full`的子集），你可以使用`anova()`函数来比较它们。对于广义线性模型，你将想要一个卡方版本的这个测试：
- en: '[PRE12]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: The nonsignificant chi-square value (p = 0.21) suggests that the reduced model
    with four predictors fits as well as the full model with nine predictors, reinforcing
    your belief that gender, children, education, and occupation don’t add significantly
    to the prediction above and beyond the other variables in the equation. Therefore,
    you can base your interpretations on the simpler model.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 非显著的卡方值（p = 0.21）表明，具有四个预测变量的简化模型与具有九个预测变量的完整模型拟合得一样好，这加强了你认为性别、孩子、教育和职业不会显著增加预测的信念，除了方程中的其他变量。因此，你可以基于这个更简单的模型进行解释。
- en: 13.2.1 Interpreting the model parameters
  id: totrans-94
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.2.1 解释模型参数
- en: 'Let’s look at the regression coefficients:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看回归系数：
- en: '[PRE13]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: In a logistic regression, the response being modeled is the log(odds) that *Y*
    = 1\. The regression coefficients give the change in log(odds) in the response
    for a unit change in the predictor variable, holding all other predictor variables
    constant.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 在逻辑回归中，被建模的响应是*Y* = 1的对数几率。回归系数给出了预测变量单位变化时响应对数几率的改变，同时保持所有其他预测变量不变。
- en: 'Because log(odds) are difficult to interpret, you can exponentiate them to
    put the results on an odds scale:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 因为对数几率难以解释，你可以对它们进行指数化，以便将结果放在几率尺度上：
- en: '[PRE14]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Now you can see that the odds of an extramarital encounter are increased by
    a factor of 1.106 for a one-year increase in years married (holding age, religiousness,
    and marital rating constant). Conversely, the odds of an extramarital affair are
    multiplied by a factor of 0.965 for every year increase in age. The odds of an
    extramarital affair increase with years married and decrease with age, religiousness,
    and marital rating. Because the predictor variables can’t equal 0, the intercept
    isn’t meaningful in this case.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以看到，已婚年限增加一年，婚外邂逅的几率会增加1.106倍（保持年龄、宗教信仰和婚姻评级不变）。相反，每增加一年年龄，婚外情事的几率会乘以0.965倍。婚外情事的几率随着已婚年限的增加而增加，随着年龄、宗教信仰和婚姻评级的降低而减少。因为预测变量不能等于0，所以截距在这种情况下没有意义。
- en: If desired, you can use the `confint()` function to obtain confidence intervals
    for the coefficients. For example, `exp(confint(fit.reduced))` would print 95%
    confidence intervals for each of the coefficients on an odds scale.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，你可以使用`confint()`函数来获取系数的置信区间。例如，`exp(confint(fit.reduced))`将打印出每个系数在几率尺度上的95%置信区间。
- en: Finally, a one-unit change in a predictor variable may not be inherently interesting.
    For binary logistic regression, the change in the odds of the higher value on
    the response variable for an *n* unit change in a predictor variable is exp*(β[j])^n*.
    If a 1-year increase in years married multiplies the odds of an affair by 1.106,
    a 10-year increase would increase the odds by a factor of 1.106^10, or 2.7, holding
    the other predictor variables constant.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，预测变量中的一个单位的变化可能本身并不有趣。对于二元逻辑回归，当预测变量变化 *n* 个单位时，响应变量上更高值的几率变化为 exp*(β[j])^n*。如果结婚年限增加1年将婚外情的几率乘以1.106，那么增加10年会将几率乘以1.106^10，即2.7，保持其他预测变量不变。
- en: 13.2.2 Assessing the impact of predictors on the probability of an outcome
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.2.2 评估预测变量对结果概率的影响
- en: For many of us, it’s easier to think in terms of probabilities than odds. You
    can use the `predict()` function to observe the impact of varying the levels of
    a predictor variable on the probability of the outcome. The first step is to create
    an artificial dataset containing the values of the predictor variables you’re
    interested in. Then you can use this artificial dataset with the `predict()` function
    to predict the probabilities of the outcome event occurring for these values.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们中的许多人来说，用概率而不是几率来思考更容易。你可以使用`predict()`函数来观察改变预测变量的水平对结果概率的影响。第一步是创建一个包含你感兴趣的预测变量值的一个人工数据集。然后你可以使用这个人工数据集与`predict()`函数一起预测这些值发生结果事件的概率。
- en: 'Let’s apply this strategy to assess the impact of marital ratings on the probability
    of having an extramarital affair. First, create an artificial dataset where age,
    years married, and religiousness are set to their means, and marital rating varies
    from 1 to 5:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们应用这个策略来评估婚姻评级对婚外情概率的影响。首先，创建一个人工数据集，其中年龄、结婚年限和宗教信仰设置为它们的平均值，婚姻评级从1到5变化：
- en: '[PRE15]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Next, use the test dataset and prediction equation to obtain probabilities:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，使用测试数据集和预测方程来获取概率：
- en: '[PRE16]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'From these results, you see that the probability of an extramarital affair
    decreases from 0.53 when the marriage is rated 1 = very unhappy to 0.15 when the
    marriage is rated 5 = very happy (holding age, years married, and religiousness
    constant). Now look at the impact of age:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 从这些结果中，你可以看到，当婚姻被评为1 = 非常不幸福时，婚外情的概率从0.53下降到当婚姻被评为5 = 非常幸福时的0.15（保持年龄、结婚年限和宗教信仰不变）。现在看看年龄的影响：
- en: '[PRE17]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Here, you see that as age increases from 17 to 57, the probability of an extramarital
    encounter decreases from 0.34 to 0.11, holding the other variables constant. Using
    this approach, you can explore the impact of each predictor variable on the outcome.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以看到，随着年龄从17岁增加到57岁，婚外遇的概率从0.34下降到0.11，保持其他变量不变。使用这种方法，你可以探索每个预测变量对结果的影响。
- en: 13.2.3 Overdispersion
  id: totrans-112
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.2.3 过度离散
- en: The expected variance for data drawn from a binomial distribution is *σ*² =
    *n**π*(1 − *π*), where *n* is the number of observations and *π* is the probability
    of belonging to the *Y* = 1 group. *Overdispersion* occurs when the observed variance
    of the response variable is larger than what would be expected from a binomial
    distribution. Overdispersion can lead to distorted test standard errors and inaccurate
    tests of significance.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 从二项分布中抽取数据的预期方差为 *σ*² = *n**π*(1 − *π*)，其中 *n* 是观测数的数量，*π* 是属于 *Y* = 1 组的概率。*过度离散*发生在响应变量的观察方差大于从二项分布中预期的方差。过度离散可能导致测试标准误差扭曲和显著性测试不准确。
- en: When overdispersion is present, you can still fit a logistic regression using
    the `glm()` function, but in this case, you should use the quasibinomial distribution
    rather than the binomial distribution.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 当存在过度离散时，你仍然可以使用`glm()`函数拟合逻辑回归，但在这个情况下，你应该使用准二项分布而不是二项分布。
- en: One way to detect overdispersion is to compare the residual deviance with the
    residual degrees of freedom in your binomial model. If the ratio
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 检测过度离散的一种方法是将二项模型的残差偏差与残差自由度进行比较。如果这个比率
- en: '![](Images/CH13_F00_Kabacoff3-EQ05.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![图像](Images/CH13_F00_Kabacoff3-EQ05.png)'
- en: is considerably larger than 1, you have evidence of overdispersion. Applying
    this to the `Affairs` example, you have
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 比较大于1，你有过度离散的证据。应用这个方法到“婚外情”的例子中，你有
- en: '[PRE18]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: which is close to 1, suggesting no overdispersion.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这接近于1，表明没有过度离散。
- en: You can also test for overdispersion. To do this, you fit the model twice, but
    in the first instance, you use `family="binomial"`, and in the second instance,
    you use `family="quasibinomial"`. If the `glm()` object returned in the first
    case is called `fit` and the object returned in the second case is called `fit.od`,
    then
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以测试过度离散。为此，您需要拟合模型两次，但在第一次拟合中，您使用`family="binomial"`，在第二次拟合中，您使用`family="quasibinomial"`。如果第一次情况中返回的`glm()`对象称为`fit`，而第二次情况中返回的对象称为`fit.od`，那么
- en: '[PRE19]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'provides the p-value for testing the null hypothesis *H*[0]: φ = 1 versus the
    alternative hypothesis *H*[1]: φ ≠ 1\. If *p* is small (say, less than 0.05),
    you’d reject the null hypothesis.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '提供了检验零假设 *H*[0]: φ = 1 与备择假设 *H*[1]: φ ≠ 1 的p值。如果 *p* 值较小（例如，小于0.05），则拒绝零假设。'
- en: Applying this to the `Affairs` dataset, you have
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 将此应用于`Affairs`数据集，您有
- en: '[PRE20]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: The resulting p-value (0.34) is clearly not significant (p > 0.05), strengthening
    your belief that overdispersion isn’t a problem. We’ll return to the issue of
    overdispersion when we discuss Poisson regression.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 得到的p值（0.34）显然不显著（p > 0.05），这加强了您对过度离散不是问题的信念。当我们讨论Poisson回归时，我们将回到过度离散的问题。
- en: 13.2.4 Extensions
  id: totrans-126
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.2.4 扩展
- en: 'Several logistic regression extensions and variations are available in R:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: R中提供了几个逻辑回归扩展和变体：
- en: '*Robust logistic regression*—The `glmRob()` function in the `robustbase` package
    can be used to fit a robust generalized linear model, including robust logistic
    regression. Robust logistic regression can be helpful when fitting logistic regression
    models to data containing outliers and influential observations.'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*稳健逻辑回归*——`robustbase`包中的`glmRob()`函数可以用来拟合稳健广义线性模型，包括稳健逻辑回归。当拟合包含异常值和有影响力的观察值的逻辑回归模型时，稳健逻辑回归可能很有帮助。'
- en: '*Multinomial logistic regression*—If the response variable has more than two
    unordered categories (for example, married/widowed/divorced), you can fit a polytomous
    logistic regression using the `mlogit()` function in the `mlogit` package. Alternatively,
    you can use the `multinom()` function in the `nnet` package.'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*多项逻辑回归*——如果响应变量有超过两个无序类别（例如，已婚/丧偶/离婚），您可以使用`mlogit`包中的`mlogit()`函数拟合多项逻辑回归。或者，您可以使用`nnet`包中的`multinom()`函数。'
- en: '*Ordinal logistic regression*—If the response variable is a set of ordered
    categories (for example, credit risk as poor/good/excellent), you can fit an ordinal
    logistic regression using the `polyr()` function in the `MASS` package.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*有序逻辑回归*——如果响应变量是一组有序类别（例如，信用风险为差/好/优秀），您可以使用`MASS`包中的`polyr()`函数拟合有序逻辑回归。'
- en: The ability to model a response variable with multiple categories (both ordered
    and unordered) is an important extension, but it comes at the expense of greater
    interpretive complexity. Assessing model fit and regression diagnostics in these
    cases will also be more complex.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 能够用多个类别（有序和无序）建模响应变量是一个重要的扩展，但它以更大的解释复杂性为代价。在这些情况下评估模型拟合和回归诊断也将更加复杂。
- en: In the `Affairs` example, the number of extramarital contacts was dichotomized
    into a yes/no response variable because our interest centered on whether respondents
    had an affair in the past year. If our interest had been centered on magnitude—the
    number of encounters in the past year—we would have analyzed the count data directly.
    One popular approach to analyzing count data is Poisson regression, the next topic
    we’ll address.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 在`Affairs`示例中，婚外联系的数量被二分化为是/否响应变量，因为我们的兴趣集中在受访者过去一年是否有婚外情。如果我们对数量——过去一年的遭遇次数——感兴趣，我们会直接分析计数数据。分析计数数据的一种流行方法是Poisson回归，这是我们接下来要讨论的主题。
- en: 13.3 Poisson regression
  id: totrans-133
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 13.3 Poisson回归
- en: Poisson regression is useful when you’re predicting an outcome variable representing
    counts from a set of continuous and/or categorical predictor variables. Coxe,
    West, and Aiken (2009) provide a comprehensive, yet accessible, introduction to
    Poisson regression.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: Poisson回归在预测由一组连续和/或分类预测变量表示的计数结果变量时非常有用。Coxe、West和Aiken（2009）提供了一个全面且易于理解的Poisson回归介绍。
- en: To illustrate the fitting of a Poisson regression model, along with some issues
    that can come up in the analysis, we’ll use the Breslow seizure data (Breslow,
    1993) provided in the `robustbase` package. Specifically, we’ll consider the impact
    of an antiepileptic drug treatment on the number of seizures occurring over an
    eight-week period following the initiation of therapy. Be sure to install the
    `robustbase` package before continuing.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 为了说明泊松回归模型的拟合以及分析中可能出现的一些问题，我们将使用`robustbase`包中提供的Breslow癫痫数据（Breslow，1993）。具体来说，我们将考虑抗癫痫药物治疗对治疗开始后八周内发生的癫痫发作次数的影响。在继续之前，请确保已安装`robustbase`包。
- en: Data were collected on the age and number of seizures reported by patients suffering
    from simple or complex partial seizures during an eight-week period before, and
    an eight-week period after, randomization into a drug or placebo condition. `Ysum`
    (the number of seizures in the eight-week period post-randomization) is the response
    variable. Treatment condition (`Trt`), age in years (`Age`), and number of seizures
    reported in the baseline eight-week period (`Base`) are the predictor variables.
    The baseline number of seizures and age are included because of their potential
    effect on the response variable. We’re interested in whether evidence exists that
    the drug treatment decreases the number of seizures after accounting for these
    covariates.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在随机分配到药物或安慰剂条件之前和之后，对患有简单或复杂部分性癫痫的患者在八周期间内报告的年龄和癫痫发作次数进行了收集。`Ysum`（随机化后八周期间的癫痫发作次数）是响应变量。治疗条件（`Trt`）、年龄（`Age`）和基线八周期间报告的癫痫发作次数（`Base`）是预测变量。基线癫痫发作次数和年龄包括在内，因为它们可能对响应变量有影响。我们感兴趣的是，在考虑这些协变量后，是否存在药物治疗减少癫痫发作的证据。
- en: 'First, let’s look at summary statistics for the dataset:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们看看数据集的摘要统计：
- en: '[PRE21]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Note that although there are 11 variables in the dataset, we’re limiting our
    attention to the 4 described earlier. Both the baseline and post-randomization
    number of seizures are highly skewed. Let’s look at the response variable in more
    detail. The following code produces the graphs in figure 13.1:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，尽管数据集中有11个变量，但我们只关注前面描述的4个变量。基线和随机化后的癫痫发作次数都高度偏斜。让我们更详细地看看响应变量。以下代码生成了图13.1中的图形：
- en: '[PRE22]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '![](Images/CH13_F01_Kabacoff3.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![图像](Images/CH13_F01_Kabacoff3.png)'
- en: 'Figure 13.1 Distribution of post-treatment seizure counts (source: Breslow
    seizure data)'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.1 治疗后癫痫发作次数的分布（来源：Breslow癫痫数据）
- en: You can clearly see the skewed nature of the dependent variable and the possible
    presence of outliers. At first glance, the number of seizures in the drug condition
    appears to be smaller and has a smaller variance. (You’d expect a smaller variance
    to accompany a smaller mean with Poisson distributed data.) Unlike standard OLS
    regression, this heterogeneity of variance isn’t a problem in Poisson regression.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以清楚地看到因变量的偏斜性质和可能存在的异常值。乍一看，药物条件下的癫痫发作次数似乎较少，方差也较小。（你可能会期望泊松分布的数据伴随较小的均值会有较小的方差。）与标准OLS回归不同，这种方差的异质性在泊松回归中不是问题。
- en: 'The next step is to fit the Poisson regression:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是拟合泊松回归：
- en: '[PRE23]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: The output provides the deviances, regression parameters, standard errors, and
    tests that these parameters are 0\. Note that each of the predictor variables
    is significant at the *p* < 0.05 level.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 输出提供了偏差、回归参数、标准误差以及这些参数是否为0的检验。请注意，每个预测变量在*p* < 0.05的水平上都是显著的。
- en: 13.3.1 Interpreting the model parameters
  id: totrans-147
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.1 解释模型参数
- en: 'The model coefficients are obtained using the `coef()` function or by examining
    the `Coefficients` table in the `summary()` function output:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 模型系数是通过`coef()`函数获得的，或者在`summary()`函数输出中的`系数`表中查看：
- en: '[PRE24]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: In a Poisson regression, the dependent variable being modeled is the log of
    the conditional mean log*[e](λ)*. The regression parameter 0.0227 for `Age` indicates
    that a one-year increase in age is associated with a 0.02 increase in the log
    mean number of seizures, holding baseline seizures and treatment condition constant.
    The intercept is the log mean number of seizures when each of the predictors equals
    0\. Because you can’t have a zero age and none of the participants had a zero
    number of baseline seizures, the intercept isn’t meaningful in this case.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在泊松回归中，被建模的因变量是条件均值对数 log*[e](λ)*。`Age` 的回归参数 0.0227 表示，在基线癫痫发作和治疗条件不变的情况下，年龄每增加一年，对数平均癫痫发作次数增加
    0.02。截距是当每个预测变量等于 0 时的对数平均癫痫发作次数。由于年龄不能为零，且所有参与者基线癫痫发作次数都不是零，因此在这种情况下截距没有意义。
- en: 'It’s usually much easier to interpret the regression coefficients in the original
    scale of the dependent variable (number of seizures, rather than log number of
    seizures). To accomplish this, exponentiate the coefficients:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在因变量的原始尺度（癫痫发作次数，而不是对数癫痫发作次数）上解释回归系数要容易得多。为了完成这个任务，需要将系数进行指数化：
- en: '[PRE25]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Now you see that a one-year increase in age *multiplies* the expected number
    of seizures by 1.023, holding the other variables constant. This means that increased
    age is associated with higher numbers of seizures. More important, a one-unit
    change in `Trt` (that is, moving from placebo to progabide) multiplies the expected
    number of seizures by 0.86\. You’d expect a 14% (i.e., 1–0.86) decrease in the
    number of seizures for the drug group compared with the placebo group, holding
    the baseline number of seizures and age constant.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以看到，在保持其他变量不变的情况下，年龄每增加一年会将预期癫痫发作次数乘以 1.023。这意味着年龄增加与癫痫发作次数增加有关。更重要的是，`Trt`（即从安慰剂转换为普瑞巴林）的每单位变化将预期癫痫发作次数乘以
    0.86。在保持基线癫痫发作次数和年龄不变的情况下，你预计药物组与安慰剂组相比，癫痫发作次数将减少 14%（即，1-0.86）。
- en: It’s important to remember that, like the exponentiated parameters in logistic
    regression, the exponentiated parameters in the Poisson model have a multiplicative
    rather than an additive effect on the response variable. Also, as with logistic
    regression, you must evaluate your model for overdispersion.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要记住，与逻辑回归中的指数化参数一样，泊松模型中的指数化参数对响应变量有乘法效应，而不是加法效应。此外，与逻辑回归一样，你必须评估你的模型是否存在过度离散。
- en: 13.3.2 Overdispersion
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.2 过度离散
- en: In a Poisson distribution, the variance and mean are equal. Overdispersion occurs
    in Poisson regression when the observed variance of the response variable is larger
    than would be predicted by the Poisson distribution. Because overdispersion is
    often encountered when dealing with count data and can have a negative impact
    on the interpretation of the results, we’ll spend some time discussing it.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在泊松分布中，方差和均值是相等的。当响应变量的观测方差大于泊松分布预测的方差时，泊松回归中就会发生过度离散。由于在处理计数数据时经常遇到过度离散，并且可能会对结果的解释产生负面影响，我们将花一些时间来讨论它。
- en: 'There are several reasons why overdispersion may occur (Coxe et al., 2009):'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 过度离散可能发生的原因有几个（Coxe 等人，2009 年）：
- en: The omission of an important predictor variable can lead to overdispersion.
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 忽略一个重要的预测变量可能导致过度离散。
- en: Overdispersion can also be caused by a phenomenon known as *state dependence*.
    Within observations, each event in a count is assumed to be independent. For the
    seizure data, this would imply that for any patient, the probability of a seizure
    is independent of each other seizure. But this assumption is often untenable.
    For a given individual, the probability of having a first seizure is unlikely
    to be the same as the probability of having a 40th seizure, given that they’ve
    already had 39.
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 过度离散也可能由称为 *状态依赖性* 的现象引起。在观测值中，假设计数中的每个事件都是独立的。对于癫痫数据，这意味着对于任何患者，癫痫发作的概率与其他癫痫发作的概率是独立的。但这种假设通常是不成立的。对于一个给定个体，第一次癫痫发作的概率不太可能与已经发作了
    39 次的 40 次癫痫发作的概率相同。
- en: In longitudinal studies, overdispersion can be caused by the clustering inherent
    in repeated measures data. We won’t discuss longitudinal Poisson models here.
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在纵向研究中，过度离散可能由重复测量数据中固有的聚类引起。我们在这里不会讨论纵向泊松模型。
- en: If overdispersion is present and you don’t account for it in your model, you’ll
    get standard errors and confidence intervals that are too small and significance
    tests that are too liberal (that is, you’ll find effects that aren’t really there).
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 如果存在过度离散，而你又没有在模型中考虑它，你将得到标准误差和置信区间太小，显著性检验太宽松（也就是说，你会发现实际上并不存在的影响）。
- en: As with logistic regression, overdispersion is suggested if the ratio of the
    residual deviance to the residual degrees of freedom is much larger than 1\. For
    the seizure data, the ratio is
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 与逻辑回归一样，如果残差偏差与残差自由度的比率远大于1，则表明存在过度离散。对于癫痫数据，这个比率是
- en: '[PRE26]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: which is clearly much larger than 1.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 这显然远大于1。
- en: 'The `qcc` package provides a test for overdispersion in the Poisson case. (Be
    sure to download and install this package before first use.) You can test for
    overdispersion in the seizure data using the following code:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '`qcc`包提供了泊松情况下的过度离散测试。（务必在首次使用前下载并安装此包。）你可以使用以下代码对癫痫数据进行过度离散测试：'
- en: '[PRE27]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Not surprisingly, the significance test has a p-value less than 0.05, strongly
    suggesting the presence of overdispersion.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 毫不奇怪，显著性检验的p值小于0.05，强烈表明存在过度离散。
- en: 'You can still fit a model to your data using the `glm()` function by replacing
    `family="poisson"` with `family="quasipoisson"`. Doing so is analogous to the
    approach to logistic regression when overdispersion is present:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 你仍然可以使用`glm()`函数拟合数据模型，只需将`family="poisson"`替换为`family="quasipoisson"`。这样做与存在过度离散时的逻辑回归方法类似：
- en: '[PRE28]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Notice that the parameter estimates in the quasi-Poisson approach are identical
    to those produced by the Poisson approach, but the standard errors are much larger.
    In this case, the larger standard errors have led to p-values for `Trt` (and `Age`)
    that are greater than 0.05\. When you take overdispersion into account, there’s
    insufficient evidence to declare that the drug regimen reduces seizure counts
    more than receiving a placebo, after controlling for baseline seizure rate and
    age.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，准泊松方法中的参数估计与泊松方法产生的估计相同，但标准误差要大得多。在这种情况下，较大的标准误差导致了`Trt`（和`Age`）的p值大于0.05。当你考虑过度离散时，没有足够的证据表明药物方案在控制基线癫痫发作率和年龄后能比接受安慰剂减少癫痫发作次数。
- en: Please remember that this example is used for demonstration purposes only. The
    results shouldn’t be taken to imply anything about the efficacy of progabide in
    the real world. I’m not a doctor—at least not a medical doctor—and I don’t even
    play one on TV.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，这个例子仅用于演示目的。结果不应被用来推断关于progabide在现实世界中的有效性的任何内容。我不是医生——至少不是医学医生——我甚至不在电视上扮演医生。
- en: We’ll finish this exploration of Poisson regression with a discussion of some
    important variants and extensions.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将通过对一些重要变体和扩展的讨论来结束对泊松回归的探索。
- en: 13.3.3 Extensions
  id: totrans-173
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 13.3.3 扩展
- en: R provides several useful extensions to the basic Poisson regression model,
    including models that allow varying time periods, models that correct for too
    many zeros, and robust models that are useful when data includes outliers and
    influential observations. I’ll describe each separately.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: R为基本的泊松回归模型提供了几个有用的扩展，包括允许变化时间段的模型、纠正过多零值的模型以及当数据包括异常值和有影响力的观测值时有用的稳健模型。我将分别描述每个。
- en: Poisson regression with varying time periods
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 带有不同时间段的泊松回归
- en: Our discussion of Poisson regression has been limited to response variables
    that measure a count over a fixed length of time (for example, number of seizures
    in an eight-week period, number of traffic accidents in the past year, or number
    of pro-social behaviors in a day). The length of time is constant across observations.
    But you can fit Poisson regression models that allow the time period to vary for
    each observation. In this case, the outcome variable is a rate.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 我们对泊松回归的讨论仅限于测量固定时间段内计数的响应变量（例如，八周期间的癫痫发作次数，过去一年的交通事故次数，或一天内的亲社会行为次数）。时间长度在观测值之间是恒定的。但你可以拟合泊松回归模型，允许每个观测值的时间段变化。在这种情况下，结果变量是一个比率。
- en: To analyze rates, you must include a variable (for example, time) that records
    the length of time over which the count occurs for each observation. You then
    change the model from
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 要分析比率，你必须包括一个变量（例如，时间），该变量记录每个观测值计数发生的时间长度。然后你将模型从
- en: '![](Images/CH13_F01_Kabacoff3-EQ06.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH13_F01_Kabacoff3-EQ06.png)'
- en: to
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 到
- en: '![](Images/CH13_F01_Kabacoff3-EQ07.png)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/CH13_F01_Kabacoff3-EQ07.png)'
- en: or, equivalently,
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，等价地，
- en: '![](Images/CH13_F01_Kabacoff3-EQ08.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/CH13_F01_Kabacoff3-EQ08.png)'
- en: To fit this new model, you use the `offset` option in the `glm()` function.
    For example, assume that the length of time that patients participated post-randomization
    in the Breslow study varied from 14 days to 60 days. You could use the rate of
    seizures as the dependent variable (assuming you had recorded time for each patient
    in days) and fit the model
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 为了拟合这个新模型，你需要在`glm()`函数中使用`offset`选项。例如，假设在Breslow研究中，患者在随机分组后参与的时间从14天到60天不等。你可以使用癫痫发作的频率作为因变量（假设你已经记录了每个患者的天数），并拟合以下模型
- en: '[PRE29]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: where `Ysum` is the number of seizures that occurred post-randomization for
    a patient during the time the patient was studied. In this case, you’re assuming
    that rate doesn’t vary over time (for example, 2 seizures in 4 days is equivalent
    to 10 seizures in 20 days).
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 其中`Ysum`是患者在研究期间随机分组后发生的癫痫发作次数。在这种情况下，你假设这种频率不会随时间变化（例如，4天发生2次癫痫发作等同于20天发生10次癫痫发作）。
- en: Zero-inflated Poisson regression
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 零膨胀泊松回归
- en: Sometimes, the number of zero counts in a dataset is larger than would be predicted
    by the Poisson model. This can occur when there’s a subgroup of the population
    that would never engage in the behavior being counted. For example, in the `Affairs`
    dataset described in the section on logistic regression, the original outcome
    variable (affairs) counted the number of extramarital sexual intercourse experiences
    participants had in the past year. It’s likely that there’s a subgroup of faithful
    marital partners who would never have an affair, no matter how long the period
    of time studied. These are called *structural zeros* (primarily by the swingers
    in the group).
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，数据集中零计数的数量大于泊松模型预测的数量。这可能发生在人口中有一个永远不会参与所计数行为的子群体时。例如，在逻辑回归部分中描述的`Affairs`数据集中，原始结果变量（婚外情）计算了参与者过去一年中经历的婚外性交次数。很可能有一个忠诚的婚姻伴侣群体，无论研究的时间长短，他们都不会有婚外情。这些被称为*结构零*（主要是由该群体中的摇摆者）。
- en: In such cases, you can analyze the data using an approach called *zero-inflated
    Poisson regression*, which fits two models simultaneously—one that predicts who
    would or would not have an affair, and one that predicts how many affairs a participant
    would have if you excluded the permanently faithful. Think of this as a model
    that combines a logistic regression (for predicting structural zeros) and a Poisson
    regression model (that predicts counts for observations that aren’t structural
    zeros). Zero-inflated Poisson regression can be fit using the `zeroinfl()` function
    in the `pscl` package.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，你可以使用一种称为*零膨胀泊松回归*的方法来分析数据，该方法同时拟合两个模型——一个预测谁会或不会出轨，另一个预测如果排除了始终忠诚的人，参与者会有多少次出轨。想象一下，这是一个结合了逻辑回归（用于预测结构零）和泊松回归模型（预测非结构零的观察值的计数）的模型。零膨胀泊松回归可以使用`pscl`包中的`zeroinfl()`函数进行拟合。
- en: Robust Poisson regression
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 稳健泊松回归
- en: Finally, the `glmRob()` function in the `robustbase` package can be used to
    fit a robust generalized linear model, including robust Poisson regression. As
    mentioned, this can be helpful in the presence of outliers and influential observations.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，`robustbase`包中的`glmRob()`函数可以用来拟合稳健的广义线性模型，包括稳健的泊松回归。如前所述，这在存在异常值和有影响力的观察值时可能很有帮助。
- en: Going further
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 进一步探讨
- en: Generalized linear models are a complex and mathematically sophisticated subject,
    but many fine resources are available for learning about them. A good, short introduction
    to the topic is Dunteman and Ho (2006). The classic (and advanced) text on generalized
    linear models is provided by McCullagh and Nelder (1989). Comprehensive and accessible
    presentations are provided by Dobson and Barnett (2008) and Fox (2008). Faraway
    (2006) and Fox (2002) provide excellent introductions within the context of R.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 广义线性模型是一个复杂且数学上复杂的主题，但有许多优秀的资源可以帮助你了解它们。关于这个主题的一个很好的简短介绍是Dunteman和Ho（2006）。关于广义线性模型的经典（和高级）文本由McCullagh和Nelder（1989）提供。Dobson和Barnett（2008）以及Fox（2008）提供了全面且易于理解的表达。Faraway（2006）和Fox（2002）在R的背景下提供了出色的介绍。
- en: Summary
  id: totrans-193
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Generalized linear models allow you to analyze response variables that are decidedly
    non-normal, including categorical outcomes and discrete counts.
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 广义线性模型允许你分析决定性非正态的响应变量，包括分类结果和离散计数。
- en: Logistic regression can be used when analyzing studies with a dichotomous (yes/no)
    outcome.
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当分析具有二分（是/否）结果的调查时，可以使用逻辑回归。
- en: Poisson regression can be used to analyze studies when outcomes are measured
    as counts or rates.
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Poisson回归可用于分析当结果以计数或比率进行测量时的研究。
- en: Regression diagnostics can be more difficult for generalized linear models than
    for the linear models described in chapter 8\. In particular, you should evaluate
    logistic and Poisson regression models for overdispersion. If overdispersion is
    found, consider using an alternate error distribution such as quasi-binomial or
    quasi-Poisson when fitting the model.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与第8章中描述的线性模型相比，回归诊断在广义线性模型中可能更困难。特别是，你应该评估逻辑回归和Poisson回归模型是否存在过度分散。如果发现过度分散，在拟合模型时考虑使用如准二项分布或准泊松分布等其他误差分布。
