- en: 10 Doing more with ggplot2
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 10 使用ggplot2做更多操作
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Creating correlation plots, dot plots, and lollipop charts
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建相关图、点图和棒棒糖图
- en: Modifying `ggplot2` labels through transformations and concatenations
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过转换和连接修改`ggplot2`标签
- en: Enhancing `ggplot2` visualizations with legends, annotations, and shapes
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过图例、注释和形状增强`ggplot2`可视化
- en: Changing `ggplot2` colors by groups
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据组别更改`ggplot2`颜色
- en: Revealing Simpson’s Paradox
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 揭示辛普森悖论
- en: Our purpose in this chapter is to quantify and visualize the relationship in
    the NBA between team payrolls and team accomplishments. Along the way, we’ll demonstrate
    ways to go above and beyond with the `ggplot2` graphics package—by experimenting
    with unconventional types of plots; by transforming and augmenting axis labels;
    by adding legends, annotations, and shapes; and by segmenting groups by color.
    When we visualize data instead of relegating it to rows and columns in a table,
    we accelerate our capacity to learn from it and our ability to act on it. We readily
    see correlations between variables, trends over time, unusual patterns, frequencies,
    distributions, and outliers that are near impossible to spot in a spreadsheet
    or some other like output. Sometimes small touches can have major effects on your
    visual content.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的目的是量化并可视化NBA中球队工资和球队成就之间的关系。在这个过程中，我们将展示如何通过`ggplot2`图形包进行超越——通过实验非传统类型的图表；通过转换和增强轴标签；通过添加图例、注释和形状；以及通过颜色分段分组。当我们可视化数据而不是将其限制在表格的行和列中时，我们加快了从数据中学习的能力和采取行动的能力。我们能够轻松地看到变量之间的相关性、时间趋势、异常模式、频率、分布和异常值，这些在电子表格或其他类似输出中几乎无法发现。有时，一些小的改动可以对您的视觉内容产生重大影响。
- en: 'That being said, we need to consider a couple of notes before moving forward.
    First, team payrolls are equal to the sum of player salaries, which doesn’t, therefore,
    include endorsement money and other income sources that typically supplement player
    salaries. We’re only counting the monies that teams pay out to their employees.
    Second, team accomplishments will be measured three ways going forward: by regular
    season wins, postseason appearances, and league championships. Our journey will
    cover several paths:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，在继续之前，我们需要考虑几个注意事项。首先，球队工资总额等于球员工资的总和，因此不包括通常补充球员工资的代言费和其他收入来源。我们只计算球队支付给员工的资金。其次，从现在开始，球队成就将以三种方式衡量：常规赛胜利、季后赛出场和联赛冠军。我们的旅程将涵盖几条路径：
- en: Quantifying and visualizing the year-over-year correlation between team payrolls
    and regular season wins (see section 10.4.1)
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 量化并可视化球队工资和常规赛胜利之间的年度相关性（见第10.4.1节）
- en: Rank ordering team payrolls from one season to the next and classifying their
    end-of-season results across three-level factor variables (see section 10.4.2)
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按赛季对球队工资进行排名排序，并将赛季末的结果分类到三个级别的因子变量中（见第10.4.2节）
- en: Comparing average team payrolls against different season-ending results through
    a series of lollipop charts (see section 10.4.3)
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过一系列棒棒糖图比较平均球队工资和不同的赛季结束结果（见第10.4.3节）
- en: But first, let’s take care of some housecleaning tasks.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 但首先，让我们处理一些清理任务。
- en: 10.1 Loading packages
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.1 加载包
- en: 'To accomplish these goals, we’ll need to go above and beyond base R; thus,
    we call the `library()` function three times to load three packages we’ve used
    before. As a reminder, the `scales` package, which we introduced earlier in chapter
    4, includes functions for converting `ggplot2` label formats:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实现这些目标，我们需要超越基本的R语言；因此，我们三次调用`library()`函数来加载之前使用过的三个包。作为提醒，我们之前在第4章中介绍的`scales`包包括用于转换`ggplot2`标签格式的函数：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Next, we’ll import our data sets.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将导入我们的数据集。
- en: 10.2 Importing and viewing data
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.2 导入和查看数据
- en: We’ll be working with two data sets in this chapter. The first of these, called
    cap, is merely 18 rows long and three columns wide. It contains the real NBA salary
    cap for every season between 2000 and 2017, downloaded from [www.basketball-reference.com](https://www.basketball-reference.com/),
    as well as the salary cap for the same in 2021 dollars, adjusted for inflation
    using a tool from [www.usinflationcalculator.com](https://www.usinflationcalculator.com/).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将使用两个数据集。第一个数据集，称为cap，只有18行，3列宽。它包含了2000年至2017年每个赛季的真实NBA工资帽，以及2021年的工资帽，使用[www.usinflationcalculator.com](https://www.usinflationcalculator.com/)的工具进行了通货膨胀调整，数据来源于[www.basketball-reference.com](https://www.basketball-reference.com/)。
- en: Our second data set, called salaries, contains the real and inflation-adjusted
    payrolls for every NBA team between 2000 and 2017; the real salaries were obtained
    from a Boston Celtics fan site called Celtics Hub ([www.celticshub.com](https://www.celticshub.com/);
    site was under maintenance at time of printing), and the adjusted salaries were
    computed with the help of [www.usinflationcalculator.com](https://www.usinflationcalculator.com/).
    Additionally, the salaries data set contains regular season win totals and postseason
    results for every team and season combination, scraped from [www.basketball-reference.com](https://www.basketball-reference.com/).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二个数据集，称为薪资，包含了2000年至2017年间每个NBA球队的实付和通胀调整后的工资总额；实付工资是从一个名为Celtics Hub的波士顿凯尔特人球迷网站获得的（[www.celticshub.com](https://www.celticshub.com/)；打印时网站处于维护状态），调整后的工资是通过[www.usinflationcalculator.com](https://www.usinflationcalculator.com/)计算得出的。此外，薪资数据集还包含了每个球队和赛季组合的常规赛胜利总数和季后赛结果，这些数据是从[www.basketball-reference.com](https://www.basketball-reference.com/)抓取的。
- en: 'Both of these data sets are .csv files previously stored in our default working
    directory. We therefore make two calls to the `readr` `read_csv()` function to
    import both:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个数据集都是存储在我们默认工作目录中的.csv文件。因此，我们调用`readr`的`read_csv()`函数两次来导入它们：
- en: '[PRE1]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Following are a couple of short notes with respect to the salaries data set:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些关于薪资数据集的简短说明：
- en: The NBA had 29 teams between the 1999-2000 and 2003-04 seasons and 30 teams
    every year thereafter; consequently, our salaries data set contains several Not
    Available (NA) values. We’ll demonstrate how to deal with NAs so that missing
    values don’t get in the way of our analysis.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NBA在1999-2000赛季至2003-2004赛季之间有29支球队，此后每年有30支球队；因此，我们的薪资数据集中包含几个“不可用”（NA）值。我们将展示如何处理NA值，以确保缺失值不会妨碍我们的分析。
- en: We use current team names throughout, despite the fact that some teams previously
    played their home games in another city or maybe even another state. So, for instance,
    the Nets are referred to as the Brooklyn Nets only, even though they previously
    played in New Jersey and were then known as the New Jersey Nets; the Thunder,
    previously known as the Supersonics when they played in Seattle, are referred
    to as the Oklahoma City Thunder only. Teams sometimes move and therefore change
    names, but they are nevertheless the same franchise, usually with the same ownership
    group.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们在整个文档中使用了当前的球队名称，尽管一些球队之前曾在另一个城市甚至另一个州进行主场比赛。例如，篮网队只被称为布鲁克林篮网，尽管他们之前在泽西州比赛时被称为新泽西篮网；雷霆队，当他们在西雅图比赛时被称为超音速，现在只被称为俄克拉荷马城雷霆。球队有时会搬迁并因此更改名称，但它们仍然是同一个特许经营，通常由同一个所有权集团拥有。
- en: 'A call to the `dplyr` `glimpse()` function returns the salaries row and column
    counts plus a transposed view of the data. However, we first make a call to the
    `options()` function so that `glimpse``(),` and, of course, *almost* every operation
    thereafter, returns results in their original or raw format instead of in scientific
    notation. You should expect scientific notation to automatically take effect,
    unless disabled in advance, when working with numbers containing lots of digits.
    Even the most marginal players in the NBA are millionaires many times over; so
    all of our salary or payroll data contains *many* zeroes. Our preference is to
    return payroll data in full digit numerals and then, as necessary, override the
    results with smart and readable transformations:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 调用`dplyr`的`glimpse()`函数会返回薪资行的数量和列的数量，以及数据的转置视图。然而，我们首先调用`options()`函数，以确保`glimpse()`函数以及当然，几乎之后的每一个操作，都以原始或原始格式返回结果，而不是以科学记数法。你应该预期，除非事先禁用，否则在处理包含大量数字的数字时，科学记数法会自动生效。即使是NBA中最边缘的球员也是百万富翁多次；因此，我们所有的薪资或工资数据都包含*很多*零。我们更喜欢以全数字形式返回工资数据，然后，如有必要，用智能和可读的转换覆盖结果：
- en: '[PRE2]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Scientific notation and tibbles
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 科学记数法和tibbles
- en: We mentioned in a previous chapter that tibbles don’t always work with base
    R functions. It turns out that disabling scientific notation works on tibbles
    some of the time, but other times it doesn’t. However, there’s a very easy workaround
    that we’ll demonstrate in section 10.3.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在前面一章提到，tibbles并不总是与基础R函数一起工作。事实证明，在某些时候禁用科学记数法对tibbles有效，但有时则无效。然而，我们将在第10.3节中展示一个非常简单的解决方案。
- en: 'In consideration of space, we pass salaries to the `dplyr select()` function
    to reduce our data so that `glimpse``()` then returns just the variable `Team`
    and a subset of the 2017 data:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到空间，我们将薪资传递给`dplyr select()`函数以减少我们的数据，这样`glimpse()`函数就只返回变量`Team`和2017数据的子集：
- en: '[PRE3]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'A subsequent call to the `dim()` function gets us the full dimension of the
    salaries data set:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 对`dim()`函数的后续调用为我们提供了薪资数据集的完整维度：
- en: '[PRE4]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The salaries data set is almost two and a half times as wide as it is long.
    Here is what you need to immediately know about the data:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 薪资数据集的宽度几乎是长度的两倍半。以下是您需要立即了解的数据信息：
- en: Columns s2017 through s2000 represent annual team payrolls in real dollars where,
    for instance, s2017 equals the 2016-17 season.
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: s2017至s2000列代表年度球队实际薪资，例如，s2017等于2016-17赛季。
- en: Columns sa2017 through sa2000 represent annual team payrolls in dollars adjusted
    for inflation.
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: sa2017至sa2000列代表按通货膨胀调整后的年度球队薪资。
- en: Columns w2017 through w2000 represent annual regular season win totals (all
    NBA teams play an 82-game schedule, minus unplanned disruptions due to strikes
    and pandemics).
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: w2017至w2000列代表年度常规赛胜利总数（所有NBA球队都参加82场比赛的赛程，减去因罢工和流行病等意外事件造成的破坏）。
- en: Columns pc2017 through pc2000 represent annual end-of-season results where 0
    indicates a team failed to make the playoffs, 10 means it qualified for postseason
    play but then lost somewhere along the way, and 11 means it won the league championship.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: pc2017至pc2000列代表年度赛季结束时的结果，其中0表示球队未能进入季后赛，10表示球队有资格参加季后赛但途中输掉了比赛，11表示赢得了联赛冠军。
- en: Now for some time-series analysis on player salaries and the salary cap. The
    cap is the limit teams are allowed to spend on player salaries; the league adjusts
    the cap almost every year, at least to account for inflation.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 现在来分析一下球员薪资和薪资上限的时间序列。薪资上限是球队在球员薪资上允许花费的最高限额；联盟几乎每年都会调整薪资上限，至少是为了应对通货膨胀。
- en: 10.3 Salaries and salary cap analysis
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.3 薪资和薪资上限分析
- en: 'Our first of many visualizations in this chapter is a `ggplot2` line chart
    that displays the NBA salary cap between 2000 and 2017 in both real dollars (USD)
    and inflation-adjusted dollars (2021 USD). The first data set we imported, cap,
    is our data source (see figure 10.1):'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 本章中的第一个可视化是一个`ggplot2`折线图，显示了2000年至2017年NBA薪资上限的实值美元（USD）和通货膨胀调整后的美元（2021 USD）。我们导入的第一个数据集，cap，是我们的数据源（见图10.1）：
- en: We therefore call the `geom_line()` function twice to draw two lines, one solid
    and the other dashed. R defaults all lines to solid unless otherwise instructed;
    there are several alternatives besides dashed.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，我们两次调用`geom_line()`函数来绘制两条线，一条实线，一条虚线。R默认所有线都是实线，除非另有说明；除了虚线之外，还有其他几种选择。
- en: To convert our y-axis labels from, let’s say, 90000000 to a much more readable
    $90,000,000, we call the `scale_y_continuous()` function twice—first, to add commas
    to these large (some might say outrageous) salary figures, and, second, to preface
    these same figures with US dollar signs. Both of these operations are performed
    in tandem with the `scales` package. While the `scales` package is part of the
    `tidyverse` by way of the `ggplot2` package, it’s not uncommon for R to throw
    an error when calling `scales` functions without loading it separately and independently
    from the `tidyverse` or `ggplot2`.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了将我们的y轴标签从，比如说，90000000转换为更易读的$90,000,000，我们两次调用`scale_y_continuous()`函数——首先，为这些大（有些人可能会说是过分的）薪资数字添加逗号，其次，在这些数字前加上美元符号。这两个操作都是通过`scales`包一起完成的。虽然`scales`包是`tidyverse`的一部分，通过`ggplot2`包实现，但R在调用未单独和独立于`tidyverse`或`ggplot2`加载的`scales`函数时抛出错误并不罕见。
- en: Because we’re not adding a legend, we also call the `annotate()` function twice
    to add a pair of labels where the designated x and y coordinates meet; our labels
    take the place of a legend by designating which lines represent which data series.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于我们没有添加图例，我们还两次调用`annotate()`函数，在指定的x和y坐标相遇的位置添加一对标签；我们的标签通过指定哪些线代表哪些数据系列来代替图例。
- en: '![CH10_F01_Sutton](../../OEBPS/Images/CH10_F01_Sutton.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F01_Sutton](../../OEBPS/Images/CH10_F01_Sutton.png)'
- en: Figure 10.1 The NBA salary cap in USD and 2021 USD between 2000 and 2017\. For
    instance, the salary cap in 2010 was just under $60 M. Converting that figure
    to 2021 dollars, the cap becomes approximately $70 M, which is why the two lines
    eventually converge. Whether we view the cap in real dollars or when adjusted
    for inflation, player salaries have more or less skyrocketed since 2000.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.1 2000年至2017年NBA薪资上限（美元）和2021年美元。例如，2010年的薪资上限略低于6000万美元。将这个数字转换为2021年美元，上限变为大约7000万美元，这就是为什么两条线最终会汇合。无论我们是以实际美元还是调整通货膨胀后的美元来查看上限，球员薪资自2000年以来或多或少都急剧上升。
- en: 'Once more, we initialize a `ggplot2` object by first calling the `ggplot()`
    function. We then specify the plot type we want R to draw and accessorize the
    same by subsequently calling other `ggplot2` functions:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们通过首先调用`ggplot()`函数来初始化一个`ggplot2`对象。然后我们指定R要绘制的图表类型，并通过随后调用其他`ggplot2`函数来装饰它：
- en: '[PRE5]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: According to our first plot, the NBA salary cap was approaching $100 M back
    in 2017\. The salary cap represents the most teams are allowed to spend on player
    salaries for the year (though there are allowable exceptions). Most teams carry
    about 15 players on their active roster at any time, which suggests an average
    player could be banking as much as $7 M annually in salary.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们的第一个图表，NBA薪资上限在2017年接近了1亿美元。薪资上限代表了一年中球队在球员薪资上允许花费的最高金额（尽管有一些允许的例外）。大多数球队在任何时候都会在其活跃名单上拥有大约15名球员，这表明平均球员每年可以赚取高达700万美元的薪资。
- en: Working with ggplot2 line types and line widths
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`ggplot2`线型和线宽
- en: 'By default, `ggplot2` line charts are drawn with solid lines; in other words,
    if you want a solid line, `ggplot2` will take care of it for you automatically.
    But `ggplot2` supports other line types as well: dashed, dotted, dotdash, longdash,
    and twodash. You just need to pass the `linetype` argument to the `geom_line()`
    function and indicate within a pair of single or double quotation marks which
    type of line you want or need `ggplot2` to draw in lieu of the default.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`ggplot2`折线图以实线绘制；换句话说，如果你想要实线，`ggplot2`会自动为你处理。但`ggplot2`也支持其他线型：虚线、点线、点划线、长划线和双划线。你只需将`linetype`参数传递给`geom_line()`函数，并在单引号或双引号内指定你想要或需要`ggplot2`绘制的线型即可，而不是默认的线型。
- en: In addition, you can fiddle with the width of any line, regardless of type.
    When, for instance, the size argument passed to `geom_line()` equals `1.5`, you’re
    telling `ggplot2` to draw the line 50% wider than the default. When the size argument
    is set to, let’s say, `0.8`, you’re telling `ggplot2` to draw the line at 80%
    of its default.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你可以调整任何线的宽度，无论其类型如何。例如，当传递给`geom_line()`的大小参数等于`1.5`时，你是在告诉`ggplot2`绘制比默认值宽50%的线。当大小参数设置为，比如说，`0.8`时，你是在告诉`ggplot2`绘制默认值的80%宽度的线。
- en: Our second visualization is another `ggplot2` line chart that requires some
    leading data wrangling. We start by creating a new data set from salaries called
    mean_salaries_real. The `summarize()` function computes the average team payroll
    in real dollars, and the `dplyr across()` function applies the computation to
    a contiguous subset of the salaries variables. The `na.rm` argument is set to
    `TRUE` so that the mean calculation effectively ignores the NA values in the salaries
    data set; R would error out otherwise.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的第二个可视化是另一个需要一些数据整理的`ggplot2`折线图。我们首先从薪资数据创建一个新的数据集，称为`mean_salaries_real`。`summarize()`函数计算实际美元的平均团队薪资，而`dplyr
    across()`函数将计算应用于薪资变量的连续子集。`na.rm`参数设置为`TRUE`，以便平均计算实际上忽略了薪资数据集中的NA值；否则R会出错。
- en: 'In addition, take note that we’ve converted mean_salaries_real from a tibble
    to a classic data frame at the time of print by calling the base R `as.data.frame()`
    function. That’s because R would otherwise have returned results in scientific
    notation; the workaround is to simply convert the object from a tibble to a data
    frame:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，请注意，我们在打印时通过调用基础R的`as.data.frame()`函数，将`mean_salaries_real`从`tibble`转换为经典数据框。这是因为R否则会以科学记数法返回结果；解决方案是将对象从`tibble`转换为数据框：
- en: '[PRE6]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Our new data set has a dimension of one row and 18 columns. Next, we call the
    `pivot_longer()` function from the `tidyr` package to transpose mean_salaries_real
    into a longer and leaner data set containing 18 rows and two columns called year
    and real. The previous columns s2017 through s2000 are converted to values in
    the column year, and the salaries are converted to values in the column real.
    We get a new object called new_mean_salaries_real:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的新数据集有一个行和一个 18 列的维度。接下来，我们调用 `tidyr` 包中的 `pivot_longer()` 函数将 mean_salaries_real
    转换为一个包含 18 行和两列（year 和 real）的长而精简的数据集。之前的列 s2017 到 s2000 转换为 year 列的值，薪资转换为 real
    列的值。我们得到一个新的对象，称为 new_mean_salaries_real：
- en: '[PRE7]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'These two steps are then repeated:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 这两个步骤随后被重复执行：
- en: First, the adjusted salaries variables are substituting for real salaries, and
    the average adjusted team payroll between 2000 and 2017 is computed.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，调整薪资变量替代了实际薪资，并计算了 2000 年至 2017 年间平均调整后的球队工资。
- en: Then, the `pivot_longer()` function is called to transpose the data from a wide
    to a long format. This produces an 18 × 2 data set called new_mean_salaries_adjusted
    where the cells in year_temp are populated with the former columns sa2017 through
    sa2000, and the values in those columns are now values in the adjusted column.
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后，调用 `pivot_longer()` 函数将数据从宽格式转换为长格式。这产生了一个 18 × 2 的数据集，称为 new_mean_salaries_adjusted，其中
    year_temp 中的单元格填充了之前的列 sa2017 到 sa2000，而这些列中的值现在变为调整列中的值。
- en: 'Our code chunk and the results follow:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的代码块和结果如下：
- en: '[PRE8]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We then create a new object, or data set, called salaries_temp, by combining
    new_mean_salaries_real and new_mean_salaries_adjusted with a call to the base
    R `cbind``()`, or column bind, function:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过调用基础 R 的 `cbind()` 函数，或列绑定函数，将 new_mean_salaries_real 和 new_mean_salaries_adjusted
    结合起来创建一个新的对象或数据集，称为 salaries_temp：
- en: '[PRE9]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Because we don’t need the variables year *and* year_temp, we remove year_temp
    by passing the salaries_temp data set to the `dplyr select()` function and essentially
    deselecting it:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们不需要变量 year 和 year_temp，我们通过将 salaries_temp 数据集传递给 `dplyr select()` 函数并实质上取消选择它来移除
    year_temp：
- en: '[PRE10]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'We then convert the variable year to a factor by calling the base R `as.factor()`
    function. At the same time, we pass the values 2017 through 2000 to `as.factor()`
    as a full replacement for s2017 through s2000:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们通过调用基础 R 的 `as.factor()` 函数将变量 year 转换为因子。同时，我们将值 2017 通过 2000 传递给 `as.factor()`，作为
    s2017 通过 s2000 的完全替换：
- en: '[PRE11]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Finally, we can now create our second `ggplot2` line chart (see figure 10.2).
    Here, we’re showing the progression of the average payroll per team in real and
    adjusted dollars from 2000 through 2017; otherwise, our second line chart has
    the exact same fit, form, and function as our first visualization, p1, except
    for the fact that we’ve rotated the x-axis labels 45 degrees by making a second
    call to the `theme()` function:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们现在可以创建第二个 `ggplot2` 线形图（见图 10.2）。在这里，我们展示了从 2000 年至 2017 年平均每支球队工资（实际和调整后）的变化趋势；否则，我们的第二个线形图与第一个可视化（p1）的拟合、形式和功能完全相同，只是我们通过第二次调用
    `theme()` 函数将 x 轴标签旋转了 45 度：
- en: '[PRE12]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![CH10_F02_Sutton](../../OEBPS/Images/CH10_F02_Sutton.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F02_Sutton](../../OEBPS/Images/CH10_F02_Sutton.png)'
- en: Figure 10.2 Average team payrolls from 2000 through 2017 in real and adjusted
    dollars
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.2 2000 年至 2017 年间实际和调整后的平均球队工资
- en: When adjusted for inflation, the average team payroll was actually very stable
    from 2001 through 2014\. It has grown at an increasing rate since then. Now that
    we’ve provided some context, we’ll next get into the heavy lifting.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到通货膨胀的调整，平均球队工资实际上在 2001 年至 2014 年间非常稳定。从那时起，它以递增的速度增长。现在我们已经提供了一些背景信息，接下来我们将进行深入分析。
- en: 10.4 Analysis
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 10.4 分析
- en: 'The more successful teams in the NBA—that is, teams that win more regular season
    games, qualify for postseason play, and win championships—spend more money on
    player salaries than teams that win fewer regular season games and fail to make
    the postseason. For some additional context, especially for those of you not familiar
    with a typical NBA season, consider the following:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在 NBA 中，更成功的球队——即赢得更多常规赛比赛、晋级季后赛并赢得冠军的球队——在球员薪资上的支出比赢得较少常规赛比赛且未能进入季后赛的球队要多。为了提供一些额外的背景信息，特别是对于那些不熟悉典型
    NBA 赛季的各位，请考虑以下内容：
- en: The NBA’s 30 teams are divided into two 15-team conferences; the top eight teams
    from each conference at the end of the regular season qualify for the postseason.
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NBA 的 30 支球队分为两个 15 支球队的联盟；常规赛结束时每个联盟的前八名球队有资格进入季后赛。
- en: The NBA regular season usually starts in mid-October and ends the following
    year in mid-April. It’s equally correct to reference an NBA season that starts,
    let’s say, in October 2021 and ends in April 2022 as the 2021-22 season, the 2022
    season, or the 2022 year. All mean the same and are equally correct, so we’ll
    use these interchangeably.
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NBA常规赛通常在十月中旬开始，并在下一年四月中旬结束。引用一个从10月2021年开始并在4月2022年结束的NBA赛季，无论是作为2021-22赛季、2022赛季还是2022年，都是同样正确的。所有这些意思相同，都是正确的，因此我们将交替使用这些术语。
- en: Playoffs start immediately following the conclusion of the regular season, usually
    ending in early June. Postseason and playoffs are synonymous, so we’ll use these
    additional terms interchangeably.
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 季后赛紧随常规赛结束之后开始，通常在六月初结束。季后赛和赛季后赛是同义的，因此我们将交替使用这些额外术语。
- en: 'Although there are exceptions to almost every rule, we’ll see if it can be
    proven that higher-paid NBA teams are more successful than lesser-paid teams,
    at least between 2000 and 2017\. We’ll do this primarily by summarizing and visualizing
    our data: correlation plots that display the positive and significant year-over-year
    relationship between team payrolls and regular season wins; dot plots that rank
    order team payrolls and classify their season-ending disposition into one of three
    discrete bins, or categories; and lollipop charts that display year-over-year
    average team payrolls broken down by these same categories.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管几乎每条规则都有例外，但我们将看看是否可以证明，至少在2000年至2017年之间，高薪NBA球队比低薪球队更成功。我们将主要通过总结和可视化我们的数据来完成这项工作：显示球队工资与常规赛胜利之间正的、显著年度关系的相关图；显示球队工资排名顺序并将赛季结束情况分类为三个离散的类别或箱子的点图；以及显示按这些相同类别分解的年度平均球队工资的棒棒图。
- en: 10.4.1 Plotting and computing correlations between team payrolls and regular
    season wins
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 10.4.1 绘制球队工资与常规赛胜利之间的相关图和计算相关系数
- en: Our journey begins by computing and plotting the year-over-year correlation
    between team payrolls and regular season wins and performing a correlation test
    across our data.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的旅程从计算和绘制球队工资与常规赛胜利之间的年度相关系数，并在我们的数据中执行相关测试开始。
- en: Computing correlations and performing a correlation test
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 计算相关系数和执行相关测试
- en: 'In R, you can compute the correlation coefficient between numeric variables
    in many ways. The most common and straightforward method of computing the correlation
    coefficient between two numeric variables at a time is to call the base R `cor()`
    function. In the following code, we call the `cor()` function to compute the correlation
    coefficient between salaries and wins from the 2000 season. By adding the `use
    = "complete.obs"` argument, we’re telling R to ignore NAs in the salaries data
    set and return the correlation anyway; R would otherwise return NA rather than
    the correlation coefficient:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在R中，你可以以多种方式计算数值变量之间的相关系数。计算两个数值变量之间相关系数的最常见和直接方法是通过调用基础R的`cor()`函数。在下面的代码中，我们调用`cor()`函数来计算2000赛季的工资和胜利之间的相关系数。通过添加`use
    = "complete.obs"`参数，我们告诉R忽略工资数据集中的NA值并返回相关系数；否则，R会返回NA而不是相关系数。
- en: '[PRE13]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'By default, R returns the *Pearson* correlation coefficient, which evaluates
    the linear relationship between two numeric or continuous variables. If you want
    or need R to instead return the *Spearman* correlation coefficient, which is based
    on ranked values for each variable rather than the raw data, simply add the `method
    = "spearman"` argument to the `cor()` function:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，R返回*皮尔逊*相关系数，它评估两个数值或连续变量之间的线性关系。如果你希望或需要R返回*斯皮尔曼*相关系数，它基于每个变量的排名值而不是原始数据，只需将`method
    = "spearman"`参数添加到`cor()`函数中：
- en: '[PRE14]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Because we’re working with interval data (i.e., data measured along a numeric
    scale where the distances between adjacent values are always the same) and not
    ordinal data (i.e., categorical data that has a natural ordering or hierarchy
    among its categories), we’ll compute Pearson correlations throughout. If and when
    you find it appropriate to compute Spearman correlation coefficients, note that
    like Pearson correlation coefficients, they will always equal some number between
    -1 and +1 and should therefore be interpreted just the same.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们处理的是区间数据（即，沿数值尺度测量的数据，其中相邻值之间的距离始终相同）而不是有序数据（即，在其类别之间具有自然顺序或层级的分类数据），我们将始终计算皮尔逊相关系数。如果你认为计算斯皮尔曼相关系数是合适的，请注意，与皮尔逊相关系数一样，它们总是等于介于-1和+1之间的某个数字，因此应该以相同的方式进行解释。
- en: Of course, we’re interested in the correlation between team payrolls and wins
    for all 18 seasons in our data set, not just for the 2000 season. So while this
    method is simple and straightforward enough, it’s not the most scalable solution.
    Another method is to subset the salaries data set on just the relevant variables
    and then compute the correlation coefficient for every conceivable pair of variables
    with just a single line of code.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，我们对数据集中所有18个赛季的球队工资和胜利之间的相关性感兴趣，而不仅仅是2000年的赛季。因此，虽然这种方法简单直接，但它并不是最可扩展的解决方案。另一种方法是只对salaries数据集的相关变量进行子集化，然后通过一行代码计算每对变量的相关系数。
- en: 'First, we call the `dplyr select()` function to subset the salaries data set
    on just the 18 variables between s2017 and s2000 and the 18 additional variables
    between w2017 and w2000\. We then call the base R `dim()` function to return the
    dimension:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们调用`dplyr select()`函数，对salaries数据集进行子集化，只保留s2017到s2000之间的18个变量和w2017到w2000之间的18个附加变量。然后我们调用基础R的`dim()`函数来返回维度：
- en: '[PRE15]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Our new data set, salaries_cor, has the same row count as salaries, but has
    effectively been reduced width-wise to 36 columns.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的新数据集salaries_cor与salaries的行数相同，但在宽度上已经有效减少到36列。
- en: We can now compute the correlation coefficient for every pair of variables in
    salaries_cor by again the calling the `cor()` function; however, rather than passing
    two variables as arguments, this time, we’ll pass the entire data set.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以通过再次调用`cor()`函数来计算salaries_cor中每对变量的相关系数；然而，这次不是传递两个变量作为参数，而是将整个数据集传递。
- en: 'To limit the result set, we first call the `options()` function where the `"max.print"`
    argument equals `100`; we don’t want to give R the option of returning the correlation
    coefficient between every pair of 36 variables. Additionally, we bound the `cor()`
    function with the base R `round()` function so that R returns correlations with
    only two digits right of the decimal point instead of the default, which is seven
    digits. Still, we’re printing just a subset of the full result set:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 为了限制结果集，我们首先调用`options()`函数，其中`"max.print"`参数等于`100`；我们不希望给R返回每对36个变量的相关系数的选项。此外，我们使用基础R的`round()`函数限制了`cor()`函数，使得R只返回小数点后两位的相关系数，而不是默认的七位。尽管如此，我们只打印了完整结果集的一部分：
- en: '[PRE16]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: This works when every variable is of type numeric, which is why we subset the
    salaries data set first; R would otherwise throw an error if that weren’t the
    case. But it’s too much data. We don’t care, for instance, about the correlation
    between 2017 and 2016 payrolls; likewise, we also don’t care about 2017 payrolls
    and 2014 wins. This makes it difficult to find correlations that are meaningful
    (like the correlation coefficient between s2017 and w2017, e.g., which equals
    0.40).
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 当每个变量都是数值类型时，这种方法才有效，这也是我们首先对salaries数据集进行子集化的原因；如果不是这样，R会抛出一个错误。但是数据量太大。例如，我们并不关心2017年和2016年工资之间的相关性；同样，我们也不关心2017年工资和2014年胜利之间的关系。这使得找到有意义的关联（例如，s2017和w2017之间的相关系数，例如，等于0.40）变得困难。
- en: 'Let’s try another way. In our next code chunk, the following occurs:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试另一种方法。在我们的下一个代码块中，以下情况发生：
- en: We first call the `dplyr select()` function to subset the salaries_cor data
    set on just those variables between s2017 and s2000.
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们首先调用`dplyr select()`函数，对salaries_cor数据集进行子集化，只保留s2017和s2000之间的变量。
- en: Next, we call the `pivot_longer()` function from the `tidyr` package to reshape
    salaries_cor from a wide layout to a thin layout, where the two remaining columns
    assume the variable names of `year1` and `salary`. The results are cast to a tibble
    called salaries_sals.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接下来，我们调用`tidyr`包中的`pivot_longer()`函数，将salaries_cor从宽布局转换为薄布局，其中剩下的两列假设变量名为`year1`和`salary`。结果被转换为名为salaries_sals的tibble。
- en: 'Finally, we run a series of familiar base R commands against salaries_sals
    to examine the results:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们对salaries_sals运行一系列熟悉的base R命令来检查结果：
- en: '[PRE17]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Next, we repeat this exercise in full where the following are true:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们重复这个练习，以下条件成立：
- en: The salaries_cor data set is subset on the variables `w2017` through `w2000`
    in lieu of `s2017` through `s2000`.
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: salaries_cor数据集在变量`w2017`到`w2000`上进行了子集化，而不是在`s2017`到`s2000`上。
- en: The data set is then reshaped from wide to long with variables called `year2`
    and `wins`.
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后将数据集从宽布局转换为长布局，变量名为`year2`和`wins`。
- en: 'The results are cast to a tibble called salaries_wins, and then we call the
    `dim``()`, `head``()`, and `tail()` functions from base R to examine the results
    of our work:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 结果被转换为一个名为 `salaries_wins` 的 tibble，然后我们调用基础 R 的 `dim()`、`head()` 和 `tail()`
    函数来检查我们工作的结果：
- en: '[PRE18]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'We then call the `cbind()` function from base R to combine salaries_sals and
    salaries_ wins into a new data set called salaries_cor2:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用基础 R 的 `cbind()` 函数将 `salaries_sals` 和 `salaries_wins` 合并到一个新的数据集中，称为
    `salaries_cor2`：
- en: '[PRE19]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The salaries_cor2 data set is 540 rows long and four columns wide with the
    following characteristics:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '`salaries_cor2` 数据集共有 540 行，4 列，具有以下特征：'
- en: Every payroll for every team is now consolidated into one column.
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个球队的每份薪资现在都合并到一个列中。
- en: Every regular season win total for every team is consolidated into one column.
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个球队的常规赛胜利总数合并到一个列中。
- en: The variables `year1` or `year2` can be used as group identifiers.
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 变量 `year1` 或 `year2` 可以用作分组标识符。
- en: 'This means we can write a chunk of `dplyr` code where we call the `group_by``()`
    and `summarize()` functions to compute the correlation coefficient between the
    variables `salary` and `wins` for each factor, or unique identifier, in the variable
    `year1` (or `year2` if we wish). The results are cast into a tibble called tbl1:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着我们可以编写一段 `dplyr` 代码，在其中调用 `group_by()` 和 `summarize()` 函数来计算变量 `salary`
    和 `wins` 之间的相关系数，对于变量 `year1`（或如果我们希望，`year2`）中的每个因子或唯一标识符。结果被转换为一个名为 `tbl1` 的
    tibble：
- en: '[PRE20]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: After all that, we now have our 18 correlation coefficients packed into a single
    data object that we will pull from to plot and analyze.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有这些之后，我们现在有了 18 个相关系数打包在一个单一的数据对象中，我们将从中提取以进行绘图和分析。
- en: 'In the meantime, let’s run a correlation test between payrolls and wins. We
    call the base R `cor.test()` function to determine if there is any meaningful
    or statistically significant relationship between the variables `payrolls` and
    `wins`. Our null hypothesis is no, but if our test returns a p-value, or a significance
    level, equal to or less than our predefined threshold of 0.05, we’ll instead conclude
    that there is, in fact, a meaningful relationship between these two variables:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，让我们运行一次薪资和胜利之间的相关性测试。我们调用基础 R 的 `cor.test()` 函数来确定变量 `payrolls` 和 `wins`
    之间是否存在任何有意义或统计上显著的关系。我们的零假设是没有，但如果我们的测试返回的 p 值或显著性水平等于或低于我们预定义的阈值 0.05，我们将得出结论，实际上这两个变量之间确实存在有意义的关系：
- en: '[PRE21]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The p-value is way below the 0.05 threshold for significance; therefore, we
    can reject the null hypothesis and instead accept the alternative hypothesis that
    the association between team payrolls and regular season wins between the 2000
    and 2017 NBA seasons is statistically significant. It’s important to also make
    the distinction between association and causation; our correlation test results,
    especially when considered in isolation of other results and inferences, are evidence
    of the former and not necessarily the latter.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: p 值远低于 0.05 的显著性阈值；因此，我们可以拒绝零假设，并接受备择假设，即 2000 年至 2017 年 NBA 赛季之间球队薪资和常规赛胜利之间的关联在统计上是显著的。区分关联和因果关系也很重要；我们的相关性测试结果，特别是在孤立于其他结果和推论的情况下，是前者的证据，而不一定是后者的证据。
- en: Visualizing year-over-year correlations
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 可视化年度相关性
- en: With that, let’s now visualize the correlation between the variables `s2000`
    and `w2000`, or between real salaries and regular season wins, from the 2000 season.
    We first call the `select()` function to subset the salaries data set on the variables
    `Team`, `s2000`, `w2000`, and `pc2000`, thereby creating a new data set called
    salaries2000\. We then call the base R `na.omit()` function to ignore any and
    all values from salaries2000 that equal NA.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们可视化变量 `s2000` 和 `w2000` 之间的相关性，或者从 2000 赛季开始的真实薪资和常规赛胜利之间的相关性。我们首先调用 `select()`
    函数来对 `Team`、`s2000`、`w2000` 和 `pc2000` 变量进行子集化，从而创建一个名为 `salaries2000` 的新数据集。然后我们调用基础
    R 的 `na.omit()` 函数来忽略 `salaries2000` 中等于 NA 的任何和所有值。
- en: 'Here are the additional parameters:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是额外的参数：
- en: Our x-axis is Team Payrolls (s2000). We twice comingle the `scale_x_continuous()`
    function with the `scales` package to reformat the x-axis labels so that they
    include commas and US dollar signs.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的 x 轴是球队薪资（s2000）。我们两次将 `scale_x_continuous()` 函数与 `scales` 包结合使用，重新格式化 x
    轴标签，以便它们包含逗号和美元符号。
- en: Our y-axis is Wins (w2000).
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的 y 轴是胜利（w2000）。
- en: The data points are increased three times their default size by adding the `size
    = 3` argument to the `geom_point()` function.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过在 `geom_point()` 函数中添加 `size = 3` 参数，数据点的大小增加到默认大小的三倍。
- en: All NBA teams are thrown into one of three groups, depending on how their respective
    2000 seasons ended. Put differently, the three levels in the variable `pc2000`—`0`,
    `10`, and `11`—are more or less converted to equal `No playoffs`, `Made playoffs`,
    and `Won title`, respectively.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有NBA球队根据各自2000赛季的结束情况被分为三个组。换句话说，变量`pc2000`中的三个级别——`0`、`10`和`11`——大致转换为`无季后赛`、`进入季后赛`和`赢得冠军`。
- en: We call the `geom_smooth()` function twice to draw three trendlines without
    confidence intervals. Our first call to `geom_smooth()` draws trendlines for two
    of our three factors; the second call to `geom_smooth()` draws a third trendline
    across the entire data series, disregarding factors.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们两次调用`geom_smooth()`函数来绘制三条趋势线，不包含置信区间。我们第一次调用`geom_smooth()`为三个因素中的两个绘制趋势线；第二次调用`geom_smooth()`在整个数据系列上绘制第三条趋势线，不考虑因素。
- en: A legend is added and affixed to the bottom on the plot.
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在图上添加了一个图例并固定在底部。
- en: Our x-axis labels are rotated 45 degrees for fit.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将x轴标签旋转了45度以适应。
- en: 'Here’s the code for our first plot:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们的第一个图的代码：
- en: '[PRE22]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Let’s now create a similar plot for 2001 by swapping out 2000 variables for
    2001 but otherwise maintaining our previous syntax:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们通过将2000年的变量替换为2001年，但保持之前的语法，为2001年创建一个类似的图：
- en: '[PRE23]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'We then call the `plot_layout()` function from the `patchwork package` to return
    our two correlation plots as a single graphical object (see figure 10.3):'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们随后从`patchwork package`包中调用`plot_layout()`函数，将我们的两个相关图合并为一个单一的图形对象（见图10.3）：
- en: '[PRE24]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '![CH10_F03_Sutton](../../OEBPS/Images/CH10_F03_Sutton.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F03_Sutton](../../OEBPS/Images/CH10_F03_Sutton.png)'
- en: Figure 10.3 A pair of correlation plots, one for 2000 and the other for 2001,
    visualize the relationship between team payrolls and regular season wins.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.3 两个相关图，一个针对2000年，另一个针对2001年，可视化球队工资和常规赛胜利之间的关系。
- en: 'The remaining correlation plots, covering the 2002 to 2017 seasons, are displayed
    in the appendix to this book. All told, other than the statistical significance
    between payrolls and wins, we can draw the following conclusions, bearing in mind
    that correlation coefficients will always equal some number between -1 and +1
    and that results close to those extremes indicate a strong negative or positive
    relationship:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 剩余的相关图，涵盖2002年至2017赛季，显示在本书的附录中。总的来说，除了工资和胜利之间的统计显著性外，考虑到相关系数始终等于-1和+1之间的某个数字，并且接近这些极端的结果表明存在强烈的负相关或正相关关系，我们可以得出以下结论：
- en: Year over year, or season over season, there is a positive correlation between
    team payrolls and regular season wins. In other words, as payrolls increase, regular
    season wins increase.
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 年复一年，或者说赛季复赛季，球队工资和常规赛胜利之间存在正相关关系。换句话说，随着工资的增加，常规赛胜利也会增加。
- en: There appears to be no year-over-year consistency in the correlation coefficients
    and, in fact, a substantial amount of variance in our results. For instance, the
    correlation coefficient between team payrolls and regular season wins was as low
    as 0.02 in 2006 and as high as 0.57 in 2000.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 相关系数在年度间似乎没有一致性，实际上，我们的结果中存在大量的变异性。例如，2006年球队工资和常规赛胜利之间的相关系数低至0.02，而2000年高达0.57。
- en: Additionally, we even see a lack of continuity in correlation coefficients between
    consecutive seasons. Take 2008 and 2009, for example, where the correlation coefficient
    between team payrolls and regular season wins jumped from 0.16 to 0.43.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，我们甚至看到连续赛季之间的相关系数缺乏连续性。以2008年和2009年为例，球队工资和常规赛胜利之间的相关系数从0.16跃升至0.43。
- en: The few teams year over year with the highest payrolls almost always make the
    playoffs, while teams with the absolute lowest payrolls almost always fail to
    qualify for postseason play.
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 几乎每年都有最高工资的球队进入季后赛，而工资最低的球队几乎无法进入季后赛。
- en: Championship-winning teams are usually near the top in both regular season wins
    and payroll.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 赢得冠军的球队通常在常规赛胜利和工资总额方面都接近顶端。
- en: In addition, let’s introduce and very briefly discuss the statistical phenomenon
    known as Simpson’s Paradox. Simpson’s Paradox is in play when the association
    between two variables, when cut into multiple subpopulations, is at odds with
    the association between the same pair of variables when otherwise examining the
    entire data series. Results from the 2012-13 season might be the best example
    (see the appendix). Overall, there is a positive correlation between payrolls
    and regular season wins. However, the relationships between these same variables
    are flat when the data is subset on our season-ending factors. We get this sort
    of insight by cutting the data and assigning different colors to different factors;
    there’s absolutely no way we would see this if we had instead kept the data whole
    and not applied a color scheme.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，让我们简要介绍并讨论一下被称为辛普森悖论（Simpson’s Paradox）的统计现象。当两个变量之间的关联，在分割成多个子群体时，与在考察整个数据系列时相同对变量的关联相矛盾时，辛普森悖论就出现了。2012-13赛季的结果可能是最好的例子（见附录）。总体而言，工资与常规赛胜利之间存在正相关。然而，当数据按赛季结束因素子集时，这些相同变量之间的关系是平的。我们通过分割数据并为不同的因素分配不同的颜色来获得这种见解；如果我们保持数据完整并未应用颜色方案，我们绝对看不到这种情况。
- en: Plotting correlations over time
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 绘制随时间变化的关联性
- en: 'Our next visualization displays the year-over-year correlation coefficient
    between team payrolls and regular season wins using the tibble we created earlier
    as a data source. But first, we call the `dplyr mutate()` function and the built-in
    `replace``()` and `sprintf()` functions to effectively overwrite *all* the values
    in the tbl1 variable `year1` so that, for instance, `s2014` is replaced by `14`:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接下来的可视化显示了使用我们之前创建的tibble作为数据源，团队工资与常规赛胜利之间逐年相关系数。但首先，我们调用 `dplyr mutate()`
    函数和内置的 `replace()` 和 `sprintf()` 函数，有效地覆盖 `tbl1` 变量 `year1` 中的所有值，例如，将 `s2014`
    替换为 `14`：
- en: We’ve previously called the `mutate()` function to create new, or derived, variables;
    here, it’s called to help change out the values in an existing variable.
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们之前调用 `mutate()` 函数来创建新的或派生变量；这里，它是被调用以帮助更改现有变量的值。
- en: 'The `replace()` function takes three arguments: the name of the vector we’re
    modifying (`year1`), the elements we’re replacing (all 18), and the replacement
    values (`00` through `17`).'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`replace()` 函数接受三个参数：我们正在修改的向量名称（`year1`）、我们要替换的元素（所有18个），以及替换值（从 `00` 到 `17`）。'
- en: The `sprintf()` function formats character strings; here, we’re instructing
    R to format the replacement values with two digits left of the decimal point and
    zero digits to the right. R would otherwise return 00 through 09 as 0, 1, 2, 3,
    and so on.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sprintf()` 函数格式化字符字符串；这里，我们指示R以两位小数点左边的数字和零位小数点右边的数字格式化替换值。否则，R会将 `00` 到 `09`
    返回为 0, 1, 2, 3 等等。'
- en: 'We then call the `as.factor()` function to convert `year1` from a character
    string to a factor variable:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用 `as.factor()` 函数将 `year1` 从字符字符串转换为因子变量：
- en: '[PRE25]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'We can now proceed with creating our visualization, a `ggplot2` line chart
    containing multiple trendlines, as follows:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以继续创建我们的可视化，一个包含多个趋势线的 `ggplot2` 线形图，如下所示：
- en: The tibble tbl1 is our data source, where the variable `year1` occupies the
    x-axis and the variable `cor` occupies the y-axis.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: tibble tbl1 是我们的数据源，其中变量 `year1` 占据x轴，变量 `cor` 占据y轴。
- en: Our first call to the `geom_smooth()` function draws one trendline over the
    entire data series. The argument `se = FALSE` tells R to *not* draw confidence
    intervals around the trendline.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们对 `geom_smooth()` 函数的第一次调用在完整的数据系列上绘制了一条趋势线。参数 `se = FALSE` 告诉R不要在趋势线周围绘制置信区间。
- en: Our next and final two calls to the `geom_smooth()` function draw other trendlines
    covering mutually exclusive subsets of the data to accentuate a sharp change in
    trends starting in 2006.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们对 `geom_smooth()` 函数的下一个也是最后的两次调用，绘制了覆盖数据中互斥子集的其他趋势线，以强调从2006年开始趋势的急剧变化。
- en: Finally, we call the `geom_segment``()` and `annotate()` functions in succession
    four times to draw two vertical arrows and two horizontal arrows, and then we
    add complementary text. Arrows are drawn *from* the supplied x and y coordinates
    *to* the supplied xend and yend coordinates. Take note that the forward tip of
    an arrow is the endpoint. Arrows can be vertical, horizontal, or diagonal as well
    as up or down. The x and xend coordinates equal the positions of the x-axis tick
    marks, whereas the y and yend coordinates equal the correlation coefficient. The
    size of an arrow’s head can be manipulated by playing or experimenting with the
    `unit()` function.
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们连续四次调用`geom_segment()`和`annotate()`函数来绘制两条垂直箭头和两条水平箭头，然后添加补充文本。箭头是从提供的x和y坐标*到*提供的xend和yend坐标绘制的。请注意，箭头的尖端是终点。箭头可以是垂直的、水平的、对角线的，也可以是向上的或向下的。x和xend坐标等于x轴刻度的位置，而y和yend坐标等于相关系数。可以通过使用`unit()`函数来调整箭头尖的大小。
- en: By calling the `annotate()` function, we’re adding text where the given x and
    y coordinates are the collective centerpoint. When adding shape and text layers
    to a `ggplot2` object, be prepared to perform a lot of experimentation before
    locking down your code.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过调用`annotate()`函数，我们在给定的x和y坐标处添加文本，这些坐标是集合中心点。当向`ggplot2`对象添加形状和文本层时，请准备好在锁定代码之前进行大量的实验。
- en: 'Our `ggplot` code chunk is shown here:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里展示了`ggplot`代码块：
- en: '[PRE26]'
  id: totrans-156
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The output is next (see figure 10.4). There is a slight upward trend in the
    correlation coefficient between 2000 and 2017\. More significantly, however, two
    trends have been in effect: first, between 2000 and 2006, we see a sharp *downward*
    trend, and second, from 2006 to 2017, we see an equally sharp *upward* trend.
    So while the correlation coefficient fluctuated year over year, sometimes substantially,
    our most important takeaway here is that the association between payrolls and
    wins is stronger post-2006 than it was pre-2006.'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个输出结果（见图10.4）。在2000年至2017年之间，相关系数略有上升趋势。然而，更重要的是，存在两种趋势：首先，在2000年至2006年之间，我们看到一个急剧的*下降*趋势；其次，从2006年至2017年，我们看到一个同样急剧的*上升*趋势。因此，尽管相关系数每年都有波动，有时幅度很大，但我们的最重要的启示是，2006年之后的薪资与胜利之间的关系比2006年之前更强。
- en: '![CH10_F04_Sutton](../../OEBPS/Images/CH10_F04_Sutton.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F04_Sutton](../../OEBPS/Images/CH10_F04_Sutton.png)'
- en: Figure 10.4 The year-over-year correlation coefficient between team payrolls
    and regular season wins, with three trendlines layered on top of the data. Correlation
    coefficients trended downward before the 2006 season and then trended sharply
    upward from 2006 forward.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.4 团队薪资与常规赛胜利之间的年度相关系数，数据上方叠加了三条趋势线。相关系数在2006赛季之前呈下降趋势，然后从2006年开始急剧上升。
- en: Let’s pivot by exploring possible connections between team payrolls and where
    or how teams completed their seasons, regardless of how many games they won during
    the regular season.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过探索团队薪资与球队完成赛季的方式或地点之间的可能联系来进行数据透视，无论他们在常规赛中赢得多少场比赛。
- en: 10.4.2 Payrolls versus end-of-season results
  id: totrans-161
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 10.4.2 薪资与赛季末结果对比
- en: 'Our journey continues with an examination of team payrolls plotted against
    one of three season-ending classifications for each team:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 我们继续通过检查每个球队的三个赛季结束分类之一来绘制团队薪资：
- en: Qualifies for postseason play but fails to win a title
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有资格参加季后赛但未能赢得冠军
- en: Qualifies for postseason play and wins the league championship
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有资格参加季后赛并赢得联赛冠军
- en: Doesn’t win enough regular season games and therefore doesn’t make the playoffs
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 赢得的常规赛比赛不够多，因此没有进入季后赛
- en: 'We’ll visualize our results with a series of dot plots, one for each NBA season,
    where our data source for each is a temporary subset of the salaries data set.
    Following are a few additional notes about our dot plots:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用一系列点图来可视化我们的结果，每个NBA赛季一个点图，每个点图的数据来源是薪资数据集的临时子集。以下是关于我们的点图的几点额外说明：
- en: We’re plotting real team payrolls or salaries, and not adjusted salaries; therefore,
    the x-axis variable in our first dot plot, for instance, is `s2000` rather than
    `sa2000`, where the former contains real 2000 salaries and the latter contains
    adjusted 2000 salaries.
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们绘制的是实际团队薪资或薪水，而不是调整后的薪资；因此，在我们的第一个点图中，x轴变量是`s2000`而不是`sa2000`，前者包含2000年的实际薪资，后者包含调整后的2000年薪资。
- en: As previously mentioned, we’re using current team names throughout for consistency
    and simplicity. In 2000, for instance, the Brooklyn Nets were the New Jersey Nets—same
    franchise, different name—but the salaries data set makes reference only to the
    Brooklyn Nets.
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如前所述，我们为了保持一致性和简单性，在整个文档中使用当前球队名称。例如，在2000年，布鲁克林篮网队曾是新泽西篮网队——同一支球队，不同的名称，但工资数据集只提到了布鲁克林篮网队。
- en: Teams are ranked in descending order by their respective payrolls, hence the
    addition of the `reorder()` function inside the aesthetic.
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 球队根据各自的工资按降序排名，因此 aesthetic 中添加了 `reorder()` 函数。
- en: As with our correlation plots, every team is cast into one of three bins, or
    classifications, that tie back to the three-level variables `pc2000` to `pc2017`
    where the factors `0`, `10`, and `11` are essentially converted to equal `No playoffs`,
    `Made playoffs`, and `Won title`, respectively.
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 就像我们的相关图一样，每个球队都被归入三个类别之一，或称为分类，这些分类与三个级别的变量`pc2000`到`pc2017`相对应，其中因素`0`、`10`和`11`基本上被转换为`No
    playoffs`（无季后赛）、`Made playoffs`（进入季后赛）和`Won title`（赢得冠军）。
- en: 'Our dots are sized just the way our data points in the correlation plots were:
    three times the default size.'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们点的尺寸与相关图中的数据点尺寸相同：默认尺寸的三倍。
- en: We’ve formatted our x-axis labels (rotated again at 45 degrees for fit) so that,
    for instance, we display a much more readable $20 M rather than 20000000\. We
    make this happen by calling the `ggplot2 scale_x_continuous()` function in conjunction
    with the `label_dollar``()` and `cut_short_scale()` functions from the `scales`
    package, where the former adds a US dollar sign as a prefix to the x-axis labels,
    and the latter converts the same labels to millions and adds an M as a suffix.
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们已经格式化了x轴标签（再次旋转45度以适应），例如，我们显示的是更易读的$20 M而不是20000000\. 我们通过调用`ggplot2 scale_x_continuous()`函数以及来自`scales`包的`label_dollar``()`和`cut_short_scale()`函数来实现这一点，其中前者在x轴标签前添加美元符号，后者将相同的标签转换为百万并添加M作为后缀。
- en: A legend is affixed to the bottom of each dot plot.
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个点图的底部都附有图例。
- en: Finally, before calling the `ggplot()` function and creating our dot plots,
    we preface that code by subsetting the salaries data set on just the variables
    required for the succeeding plot and then, when necessary, omitting any and all
    rows with NAs by calling the base R `na.omit()` function. We *don’t* want to permanently
    delete all rows in salaries that might have a few NAs, so we instead create a
    temporary subset and then apply the `na.omit()` function. This is necessary because
    of franchise adds, moves, and changes between 2000 and 2004.
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，在调用`ggplot()`函数并创建我们的点图之前，我们通过子集工资数据集仅包含后续图所需的变量，并在必要时调用基础R的`na.omit()`函数来删除任何包含NAs的行。我们不希望永久删除可能包含一些NAs的工资数据集中的所有行，所以我们创建了一个临时子集，然后应用`na.omit()`函数。这是由于2000年至2004年间的球队增加、搬迁和变更所必需的。
- en: 'That being said, our first dot plot is created with the following chunk of
    code:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，我们的第一个点图是用以下代码块创建的：
- en: '[PRE27]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'We create our second dot plot—this one for the 2000-01 season—by changing out
    variables and creating a new, but temporary, subset of the salaries data set called
    salaries2001\. Everything else remains consistent with our first dot plot:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过更改变量并创建一个新的、临时的工资数据集子集`salaries2001`来创建我们的第二个点图——这是2000-01赛季的点图。其他所有内容都与我们的第一个点图保持一致：
- en: '[PRE28]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'We bring our pair of dot plots together by again calling the `plot_layout()`
    function from the `patchwork` package and printing both visualizations as one
    graphical object (see figure 10.5):'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过再次调用`plot_layout()`函数从`patchwork`包中，并将两个点图作为单个图形对象打印出来，将我们的两个点图放在一起（见图10.5）：
- en: '[PRE29]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '![CH10_F05_Sutton](../../OEBPS/Images/CH10_F05_Sutton.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F05_Sutton](../../OEBPS/Images/CH10_F05_Sutton.png)'
- en: Figure 10.5 NBA team payrolls for the 1999-2000 and 2000-01 seasons ranked in
    descending order where the shades of the dots tie back to season-ending results
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.5 1999-2000和2000-01赛季的NBA球队工资排名，点图的阴影与赛季结束结果相对应
- en: 'Dot plots for the remaining NBA seasons in our data set are in the appendix.
    Here’s what these plots most significantly reveal from our data:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 我们数据集中剩余的NBA赛季的点图在附录中。以下是这些图从我们的数据中显著揭示的内容：
- en: League champions infrequently have the NBA’s highest payroll. In fact, over
    the 18 seasons in our data set, just twice—in 2010 and again in 2016—did the league
    champion have the highest payroll.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联赛冠军很少拥有NBA最高的工资。事实上，在我们的数据集中18个赛季中，只有两次——2010年和2016年——联赛冠军拥有最高的工资。
- en: However, these same teams frequently have payrolls higher than 50% or more of
    the remaining teams and often have one of the NBA’s highest payrolls.
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然而，这些球队通常的薪资高于剩余50%以上的球队，并且经常拥有NBA中最高的薪资之一。
- en: Teams with the highest payrolls usually make the playoffs; in fact, these teams
    usually have payrolls significantly, not just modestly, higher than all other
    teams.
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 薪资最高的球队通常能进入季后赛；实际上，这些球队的薪资通常显著高于所有其他球队。
- en: Teams with the lowest payrolls—teams with payrolls appreciably lower than the
    payrolls from all other teams—usually don’t make the playoffs.
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 薪资最低的球队——其薪资明显低于其他所有球队的薪资——通常无法进入季后赛。
- en: That higher payrolls are mostly associated with successful teams and lower payrolls
    are mostly associated with less successful teams is more obvious and more prevalent
    in recent years than in the early 2000s.
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与成功球队相关的高薪资和与不太成功球队相关的低薪资在近年来比在21世纪初更为明显和普遍。
- en: Next, we’ll compute the mean payroll year over year, comparing and contrasting
    teams that qualified for postseason play versus other teams that didn’t versus
    the league champion. We’ll visualize the results with a series of lollipop charts.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将计算年度平均薪资，比较和对比有资格进入季后赛的球队与其他没有进入季后赛的球队以及联赛冠军。我们将通过一系列棒棒糖图来可视化这些结果。
- en: 10.4.3 Payroll comparisons
  id: totrans-190
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 10.4.3 薪资比较
- en: 'Let’s again pivot and take a year-over-year look at average team payrolls,
    sliced three ways just as before, where every team does one of the following:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们再次转换视角，从年度对比的角度来审视平均球队薪资，就像之前那样，分为三个部分，每个球队都执行以下其中一项：
- en: Qualifies for the playoffs but then fails to win a championship
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有资格进入季后赛但最终未能赢得冠军
- en: Wins the league championship
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 赢得联赛冠军
- en: Fails to even qualify for postseason play
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连季后赛资格都没有获得
- en: We’ll visualize these results for every NBA season between 2000 and 2017 with
    lollipop charts, a contemporary alternative to bar charts. The use cases for bar
    charts that were pitched back in chapter 2 apply just as well to lollipop charts.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用棒棒糖图来可视化2000年至2017年每个NBA赛季的结果，棒棒糖图是条形图的现代替代品。在第二章中提出的条形图用例同样适用于棒棒糖图。
- en: 'First, however, we create a tibble to source each lollipop chart by executing
    the following commands:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们创建一个tibble，通过执行以下命令来为每个棒棒糖图提供数据源：
- en: Tell R to ignore NA values where they exist in any per-season subset of the
    salaries data set.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 告诉R忽略薪资数据集中任何赛季子集中的NA值。
- en: Compute the average salary for that season by each of our three season-ending
    classifications by calling the `dplyr group_by``()` and `summarize()` functions
    and casting the results into a variable called `mean`.
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过调用`dplyr group_by()`和`summarize()`函数，并将结果转换为名为`mean`的变量，计算每个赛季结束分类的平均薪资。
- en: Call the `mutate()` function to create a new variable called `mean2`, where
    the values are essentially transformed versions of what is otherwise contained
    in the variable `mean`. The `paste()` function from base R is called to concatenate
    three terms—a US dollar sign, the corresponding value from the variable `mean`
    rounded to the nearest millionth, and a capital M—without any spaces separating
    each term. Consequently, a value such as `41611202` in `mean` is transformed to
    `$42M` in `mean2`.
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调用`mutate()`函数创建一个名为`mean2`的新变量，其中值本质上是对变量`mean`中其他内容的转换版本。使用基础R中的`paste()`函数将三个术语——一个美元符号、变量`mean`中相应的值四舍五入到最近的百万分之一，以及一个大写M——连接起来，每个术语之间没有空格。因此，`mean`中的`41611202`这样的值在`mean2`中转换为`$42M`。
- en: Convert the factors `0`, `10`, and `11` from the variables `pc2000`, `pc2001`,
    and so forth, to equal `No playoffs`, `Made playoffs`, and `Won title`, respectively.
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将变量`pc2000`、`pc2001`等中的因素`0`、`10`和`11`转换为`No playoffs`（无季后赛）、`Made playoffs`（进入季后赛）和`Won
    title`（赢得冠军）。
- en: 'Our lollipop charts have the following characteristics:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的棒棒糖图具有以下特点：
- en: Our three season-ending classifications run along the x-axis.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们三个赛季结束的分类沿着x轴展开。
- en: The average team payroll is on the y-axis.
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 平均球队薪资位于y轴上。
- en: The `geom_segment()` function draws three lollipops, one for each factor in
    our x-axis variable, with stems starting where y equals 0 and ending where y equals
    the mean payroll.
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_segment()`函数为x轴变量中的每个因素绘制三个棒棒糖，茎从y等于0开始，到y等于平均薪资结束。'
- en: The `geom_point()` function draws circles atop each stem based on our size,
    color, and fill specifications.
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_point()`函数根据我们的大小、颜色和填充规格在每根茎上绘制圆圈。'
- en: Our y-axis labels—which are pulled from the variable `mean` rather than `mean2`—are
    transformed by calls to the `ggplot2` `scale_y_continuous()` function and the
    `scales` `label_dollar``()` and `cut_short_scale()` functions.
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们 y 轴的标签——它们是从变量 `mean` 而不是 `mean2` 中提取的——通过调用 `ggplot2 scale_y_continuous()`
    函数和 `scales label_dollar()` 以及 `cut_short_scale()` 函数进行转换。
- en: The `geom_text()` function adds text inside the top of the lollipops that ties
    back to the variable `mean2`.
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`geom_text()` 函数在棒棒糖图的顶部添加了与变量 `mean2` 相关的文本。'
- en: 'Our data wrangling and data visualization code for our first lollipop chart
    follows:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 我们第一个棒棒糖图的数据处理和可视化代码如下：
- en: '[PRE30]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Following is the data wrangling and data visualization code chunk for our second
    lollipop chart, where we’ve merely swapped out 2000 variables for their 2001 equivalents:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的代码块是第二个棒棒糖图的数据处理和可视化代码，我们只是将 2000 年的变量替换为它们的 2001 年等价物：
- en: '[PRE31]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Once again, we consolidate our two charts by calling the `plot_layout()` function
    from the `patchwork` package and printing both visualizations as a single object
    (see figure 10.6):'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，我们通过调用 `plot_layout()` 函数从 `patchwork` 包中合并我们的两个图表，并将两个可视化作为单个对象打印出来（见图 10.6）：
- en: '[PRE32]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '![CH10_F06_Sutton](../../OEBPS/Images/CH10_F06_Sutton.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F06_Sutton](../../OEBPS/Images/CH10_F06_Sutton.png)'
- en: Figure 10.6 NBA team payroll comparisons for the 1999-2000 and 2000-01 seasons
    broken down by three season-ending classifications. The No playoffs and Made playoffs
    figures represent the average payroll for all teams rolling up to those respective
    classifications, where, of course, the Won title figure is the actual payroll
    for the one team that won the league title.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 图 10.6 NBA 1999-2000 和 2000-01 赛季的球队薪资比较，按三个赛季结束分类细分。无季后赛和进入季后赛的数字代表达到相应分类的所有球队的平均薪资总额，当然，夺冠的数字是赢得联赛冠军的那一支球队的薪资总额。
- en: 'Here’s what our series of lollipop charts tells us about the data (the remainder
    of these, like our correlation plots and dot plots, are in the appendix):'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的一系列棒棒糖图告诉我们关于数据的信息（这些信息，如我们的相关图和点图，都在附录中）：
- en: More frequently than not, championship-winning teams have payrolls equal to
    or greater than the average payroll for all other teams that qualified for postseason
    play. Just as frequently, teams that make the playoffs but don’t win a title have
    payrolls equal to or greater than the average payroll for those teams that fail
    to make the playoffs.
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 比较常见的是，夺冠球队的薪资总额等于或大于所有其他进入季后赛的球队的平均薪资总额。同样常见的是，进入季后赛但未夺冠的球队的薪资总额等于或大于未能进入季后赛的球队的平均薪资总额。
- en: '*Both* conditions are true in 11 of the 18 seasons in our data set, including
    9 of the last 11 seasons.'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在我们的数据集中，有 18 个赛季中的 11 个赛季，包括最后 11 个赛季中的 9 个赛季，*两个*条件都是成立的。
- en: In *every* year between 2000 and 2017, the average payroll for teams that made
    the playoffs but failed to win a title is equal to or (usually) greater than the
    average payroll for teams that failed to make the postseason.
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 2000 年到 2017 年之间的 *每一* 年，进入季后赛但未能夺冠的球队的平均薪资总额等于或（通常是）大于未能进入季后赛的球队的平均薪资总额。
- en: 'Let’s now redirect some of the data wrangling operations we ran earlier toward
    adjusted salaries as a way of summarizing and visualizing in one snapshot the
    average salary spends between our three season-ending classifications and across
    the breadth of the salaries data set. First, we call the `dplyr select()` function
    to subset the salaries data set on the variables between `sa2017` and `sa2000`.
    Then, we call the `tidyr` `pivot_longer()` function to transform our results from
    a wide to a long format. The results are cast to a tibble called salaries_mean,
    which we can view by examining the returns from the `dim``()`, `head``()`, and
    `tail()` functions:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将之前运行的一些数据处理操作重新定向到调整后的薪资上，以便通过一个快照来总结和可视化我们三个赛季结束分类之间的平均薪资支出以及薪资数据集的全面情况。首先，我们调用
    `dplyr select()` 函数来对 `sa2017` 和 `sa2000` 之间的变量进行子集化薪资数据集。然后，我们调用 `tidyr pivot_longer()`
    函数将我们的结果从宽格式转换为长格式。结果被转换为一个名为 salaries_mean 的 tibble，我们可以通过检查 `dim()`、`head()`
    和 `tail()` 函数的返回值来查看：
- en: '[PRE33]'
  id: totrans-221
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'We repeat these very same operations, except this time we swap out the adjusted
    salary variables in favor of the variables `pc2017` through `pc2000`, thereby
    creating yet another tibble, salaries_flag:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 我们重复执行这些完全相同的操作，只是这次我们用变量 `pc2017` 到 `pc2000` 替换了调整后的薪资变量，从而创建了另一个 tibble，名为
    salaries_flag：
- en: '[PRE34]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'We then call the base R `cbind()` function to combine salaries_mean and salaries_flag
    into a single data set called salaries2:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们调用基础R的`cbind()`函数将`salaries_mean`和`salaries_flag`合并成一个名为`salaries2`的单个数据集：
- en: '[PRE35]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Finally, we tell R to ignore NAs in salaries2 by calling the base R `na.omit()`
    function and then write a chunk of `dplyr` code. We call the `group_by``()` and
    `summarize()` functions to compute the average adjusted salary between 2000 and
    2017 by each factor in the salaries2 variable called `flag`, which matches our
    three end-of-season classifications. We then call the `mutate()` function to create
    a variable called `mean2`, which is a transformed yet cleaner version of the variable
    `mean`. Our results are cast to a tibble called tbl3:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们通过调用基础R的`na.omit()`函数来告诉R忽略`salaries2`中的NAs，然后编写一段`dplyr`代码。我们调用`group_by()`和`summarize()`函数来计算2000年至2017年间每个`salaries2`变量中的`flag`因素的平均调整薪资，该因素与我们的三个赛季结束分类相匹配。然后，我们调用`mutate()`函数创建一个名为`mean2`的变量，它是变量`mean`的转换且更简洁的版本。我们的结果被转换为一个名为`tbl3`的tibble：
- en: '[PRE36]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'We next create one more lollipop chart, this time displaying the average team
    payrolls adjusted for inflation between the 2000 and 2017 seasons broken down
    by our three season-ending classifications (see figure 10.7). The one aesthetic
    difference between this lollipop chart and the others we previously created is
    that here we’ve added a light blue border around the plot by calling the `theme()`
    function a second time:'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们创建了一个额外的棒棒糖图，这次显示了2000年至2017赛季之间按我们的三个赛季结束分类调整后的平均球队薪资。这个棒棒糖图与之前创建的其他棒棒糖图之间的美学差异在于，我们通过第二次调用`theme()`函数在图表周围添加了一个浅蓝色边框：
- en: '[PRE37]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: '![CH10_F07_Sutton](../../OEBPS/Images/CH10_F07_Sutton.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![CH10_F07_Sutton](../../OEBPS/Images/CH10_F07_Sutton.png)'
- en: Figure 10.7 Payroll comparisons where the amounts have been adjusted for inflation
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 图10.7 调整通货膨胀后的薪资比较
- en: Teams that win titles, on average, spend more on player salaries than teams
    that make the playoffs but don’t win a championship; and playoff-qualifying teams
    spend, on average, more on player salaries than teams that fail to qualify for
    postseason play. Moreover, the difference in average salaries between teams that
    won a championship versus other teams that make the playoffs is minimal (only
    $3 M), whereas the subsequent difference separating postseason teams and those
    teams that don’t make the postseason is more substantial ($8 M).
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 平均而言，赢得冠军的球队在球员薪资上的支出比那些进入季后赛但未赢得冠军的球队要多；而进入季后赛的球队在球员薪资上的平均支出也比未能进入季后赛的球队要多。此外，赢得冠军的球队与其他进入季后赛的球队之间的平均薪资差异很小（只有300万美元），而季后赛球队与未能进入季后赛的球队之间的后续差异则更为显著（800万美元）。
- en: We’ll work with the same data set in chapter 11, first by quantifying and visualizing
    per-team payrolls for every regular season win, and second by building an unsupervised
    learning algorithm that segments the NBA’s 30 teams into like clusters based on
    a combination of salary spends and their regular season win totals.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 在第11章中，我们将使用相同的数据集，首先通过量化并可视化每个常规赛胜利的球队薪资，其次通过构建一个无监督学习算法，根据薪资支出和常规赛胜利总数将NBA的30支球队分成类似集群。
- en: Summary
  id: totrans-234
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: We demonstrated the full power of R in this chapter. For instance, we called
    on base R functions such as `cor()` and `cor.test()` to deliver some of our most
    significant and nifty results.
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在本章中，我们展示了R的强大功能。例如，我们调用了基础R函数如`cor()`和`cor.test()`来提供我们一些最显著和巧妙的成果。
- en: We then went beyond base R to create compelling but not-so-common visualizations
    such as dot plots and lollipop charts. We even called on other packaged functions
    to transform our `ggplot2` labels to make our visualizations that much more aesthetically
    pleasing. Dare to go beyond conventional visualizations, and never hesitate to
    add or modify aesthetics, such as transforming x- and y-axis labels to more readable
    formats, when and where it adds value for your readers.
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们随后超越了基础R，创建了引人入胜但并不常见的可视化，例如点图和棒棒糖图。我们甚至调用其他包装函数来转换我们的`ggplot2`标签，使我们的可视化更加美观。敢于超越传统可视化，并且不要犹豫在为读者增加价值时添加或修改美学元素，例如将x轴和y轴标签转换为更易读的格式。
- en: Know your options when it comes to NAs in your data. Here, we performed several
    operations by ignoring NAs. In chapters 2 and 3, we removed records that contained
    several NAs, but, in other cases, you may want to impute data.
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当你的数据中出现缺失值（NAs）时，了解你的选项。在这里，我们通过忽略NAs执行了几个操作。在第2章和第3章中，我们移除了包含多个NAs的记录，但在其他情况下，你可能想要进行数据插补。
- en: Don’t rely on just one test when two or more would tell a more compelling story.
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当有两个或更多测试可以讲述一个更有说服力的故事时，不要只依赖一个测试。
- en: Based on our correlation test between team payrolls and regular season wins,
    there is a statistically significant relationship between the two. While correlation
    doesn’t, of course, necessarily mean causation, when bumped up against other evidence,
    it’s hard to avoid the conclusion that payrolls influence wins.
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基于我们团队薪资与常规赛胜利之间的相关性测试，两者之间存在统计学上的显著关系。当然，相关性并不一定意味着因果关系，但当与其他证据相冲突时，很难避免得出薪资影响胜利的结论。
- en: The year-over-year correlation coefficient between payrolls and regular season
    wins trended quite differently before and after 2006\. While hardly consistent
    from one year to the next, the correlation coefficient trended downward and then
    upward, thereby suggesting that payrolls more recently matter more in terms of
    wins and losses than they used to. Make the effort to insert multiple trendlines
    into your time-series plots to tell a complete story.
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 薪资与常规赛胜利之间的年度相关性系数在2006年之前和之后趋势截然不同。虽然相关性系数每年并不完全一致，但趋势是先下降后上升，这表明薪资在最近几年对胜负的影响比以前更大。努力在你的时间序列图中插入多条趋势线，以讲述一个完整的故事。
- en: Our dot plots and lollipop charts also suggest a more definite association between
    payrolls and qualifying or not qualifying for postseason play, especially after
    2006.
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们的点图和棒棒糖图也表明，薪资与是否进入季后赛之间的关联性更加明确，尤其是在2006年之后。
- en: Teams with the absolute highest payrolls, with very few exceptions, reach the
    playoffs.
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 薪资绝对最高的球队，几乎没有例外，都能进入季后赛。
- en: Teams with the absolute lowest payrolls, with even fewer exceptions, fail to
    make the playoffs.
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 薪资绝对最低的球队，几乎没有例外，未能进入季后赛。
- en: Championship-winning teams almost always have one of the league’s highest payrolls,
    especially recently.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获得冠军的球队几乎总是拥有联盟中最高的薪资之一，尤其是最近几年。
- en: Along the way, we demonstrated several techniques that can bump up your `ggplot2`
    visualizations a notch or two—transforming axis labels without having to change
    your data source, adding legends, inserting annotations and shapes, and color-coding
    data points by factor levels. These sorts of touches can avert questions about
    the data and instead allow people to focus on analyzing it.
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在此过程中，我们展示了几个可以提高你的`ggplot2`可视化效果的技巧——无需更改数据源即可转换轴标签，添加图例，插入注释和形状，以及按因子水平对数据点进行着色。这些细节可以避免人们对数据的疑问，并让人们专注于分析。
- en: Finally, we introduced Simpson’s Paradox and demonstrated how to reveal it.
    Simpson’s Paradox, while maybe excessive and not terribly prevalent, is nevertheless
    a critical statistical phenomenon to be familiar with. Conclusions drawn on an
    entire data series may actually be the exact opposite of the truth for every subpopulation
    of the same.
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们介绍了辛普森悖论，并展示了如何揭示它。虽然辛普森悖论可能有些过度，并不十分普遍，但它仍然是一个需要熟悉的临界统计现象。对整个数据系列得出的结论实际上可能正好与每个相同子群体的真相相反。
