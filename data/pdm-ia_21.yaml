- en: Appendix F. Podman on Windows
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 F. Windows 上的 Podman
- en: This appendix covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录涵盖
- en: Installing Podman on Windows
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Windows 上安装 Podman
- en: Using the `podman` `machine` `init` command to create a Fedora-based WSL 2 distribution
    running Podman
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `podman` `machine` `init` 命令创建运行 Podman 的基于 Fedora 的 WSL 2 发行版
- en: Using the `podman` command on Windows to communicate with the Podman service
    running in the WSL 2 instance
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Windows 上使用 `podman` 命令与在 WSL 2 实例中运行的 Podman 服务进行通信
- en: Starting or stopping the WSL 2 instance with the `podman` `machine` start/stop
    commands
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 `podman` `machine` `start/stop` 命令启动或停止 WSL 2 实例
- en: Podman is a tool for launching Linux containers. Linux containers require a
    Linux kernel. As much as I’d love to convince the world to move to the Linux desktop
    like me, most users work on Mac and Windows operating systems—perhaps even you.
    If you use the Linux desktop, hooray! And if you don’t use a Windows machine,
    feel free to skip this appendix.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Podman 是一个用于启动 Linux 容器的工具。Linux 容器需要一个 Linux 内核。尽管我很想说服全世界像我自己一样迁移到 Linux 桌面，但大多数用户在
    Mac 和 Windows 操作系统上工作——也许甚至是你。如果你使用 Linux 桌面，太好了！如果你不使用 Windows 机器，请随意跳过本附录。
- en: Because you did not skip this appendix, I’ll assume you want to create Linux
    containers without having to `ssh` into a Linux machine and create the container
    there. You likely want to use native software development tools and keep their
    software local to their machines.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你没有跳过这个附录，我假设你想要创建 Linux 容器，而不必通过 `ssh` 登录到 Linux 机器并在那里创建容器。你很可能想使用本地的软件开发工具，并将它们的软件保留在本机上。
- en: On Linux, Podman can be run as a service allowing remote connections to launch
    containers. Then, from another system, the `podman` `--remote` command can be
    used to communicate with the remote Podman service to launch a container.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 上，Podman 可以作为服务运行，允许远程连接来启动容器。然后，从另一台系统，可以使用 `podman` `--remote` 命令与远程
    Podman 服务进行通信以启动容器。
- en: Further, you can use `podman` `system` `connection` to configure `podman` `--remote`
    to communicate with a remote Linux machine running the Podman service over SSH,
    without providing a URL to every command. The problem with all of this is that
    someone has to configure the remote machine with the correct version of the Podman
    service, and then you have to configure the SSH session.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你可以使用 `podman` `system` `connection` 来配置 `podman` `--remote` 以通过 SSH 与运行
    Podman 服务的远程 Linux 机器进行通信，而不需要在每个命令中提供 URL。所有这些的问题在于，有人必须配置远程机器以使用正确的 Podman 服务版本，然后你必须配置
    SSH 会话。
- en: 'Realizing that this experience is not optimal for new users of Podman on a
    Windows desktop, Podman added a new command: `podman` `machine`. The `podman`
    `machine` command makes it easy to create and manage a WSL 2-based Linux environment
    with Podman preinstalled and configured. The Podman command on Windows is actually
    a thinned down Podman command with only `podman` `--remote` support. In this appendix,
    you’ll learn how to install Podman onto your Windows machine, and then use the
    `podman` `machine` commands to install, configure, and manage the WSL 2 instance.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 认识到这种体验对于 Windows 桌面上的 Podman 新用户来说并不理想，Podman 添加了一个新的命令：`podman` `machine`。`podman`
    `machine` 命令使得创建和管理基于 WSL 2 的 Linux 环境变得容易，Podman 预先安装并配置好。Windows 上的 Podman 命令实际上是一个精简版的
    Podman 命令，只支持 `podman` `--remote`。在本附录中，你将学习如何在 Windows 机器上安装 Podman，然后使用 `podman`
    `machine` 命令来安装、配置和管理 WSL 2 实例。
- en: F.1 First steps
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: F.1 第一步
- en: The `podman` `machine` command on Windows accepts all the same commands as those
    used on Linux and Mac, with very similar behavior. Still, there are a few differences,
    since the underlying backend on Windows is based on Windows Subsystem for Linux
    ([https://docs.microsoft.com/en-us/windows/wsl/](https://docs.microsoft.com/en-us/windows/wsl/))
    instead of the VM, as in the other operating systems.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 上的 `podman` `machine` 命令接受与 Linux 和 Mac 上使用的所有相同命令，具有非常相似的行为。尽管如此，由于
    Windows 的底层后端基于 Windows Subsystem for Linux ([https://docs.microsoft.com/en-us/windows/wsl/](https://docs.microsoft.com/en-us/windows/wsl/))
    而不是 VM，因此在其他操作系统中有一些差异。
- en: WSL 2 involves using the Windows Hyper-V hypervisor; however, unlike a standard
    VM-based approach, WSL 2 shares the same VM and Linux kernel instance across every
    Linux distribution instance installed by the user. As an example, if you create
    two WSL 2 distributions, and you run `dmesg` on each instance, you see the same
    output, since the same kernel is hosting both.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: WSL 2 涉及使用 Windows Hyper-V 虚拟机管理程序；然而，与基于标准 VM 的方法不同，WSL 2 在用户安装的每个 Linux 发行版实例之间共享相同的
    VM 和 Linux 内核实例。例如，如果你创建了两个 WSL 2 发行版，并且在每个实例上运行 `dmesg`，你会看到相同的输出，因为相同的内核在托管这两个实例。
- en: Note WSL 1 doesn’t work with Podman; you must upgrade your Windows machine to
    an OS version that supports WSL 2\. For x64 systems, you will need Windows version
    1,903 or higher, with build 18,362 or higher. For arm64 systems, you will need
    Windows version 2004 or higher, with build 19,041 or higher.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：WSL 1 与 Podman 不兼容；您必须将您的 Windows 机器升级到支持 WSL 2 的操作系统版本。对于 x64 系统，您需要 Windows
    版本 1,903 或更高版本，构建号 18,362 或更高。对于 arm64 系统，您需要 Windows 版本 2004 或更高版本，构建号 19,041
    或更高。
- en: Running Podman with WSL 2 enables efficient resource sharing between the host
    and all running instances in exchange for less isolation. Keep in mind the `podman`
    `machine` command shares the same kernel with any other distributions you have
    running, and be cautious when manipulating any kernel-level setting (e.g., network
    interfaces and netfilter policy) in any distribution because you may unintentionally
    affect containers executed by Podman.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 WSL 2 运行 Podman 可以在主机和所有运行实例之间实现高效的资源共享，但牺牲了较低的隔离性。请注意，`podman` `machine`
    命令与您运行的任何其他发行版共享相同的内核，因此在任何发行版中操作任何内核级设置（例如，网络接口和 netfilter 策略）时请谨慎，因为您可能会无意中影响
    Podman 执行的容器。
- en: F.1.1 Prerequisites
  id: totrans-16
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F.1.1 前提条件
- en: Podman for Windows requires Windows 10 (build 19,041 or later) or Windows 11\.
    As WSL 2 uses a hypervisor, your computer must have virtualization instructions
    enabled (e.g., Intel VT-x or AMD-V). Additionally, the hypervisor requires second-level
    address translation (SLAT) support. Finally, your system must either have internet
    connectivity or an offline copy of all software to be fetched by the `podman`
    `machine`.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 版本的 Podman 需要 Windows 10（构建号 19,041 或更高）或 Windows 11。由于 WSL 2 使用虚拟机管理程序，您的计算机必须启用虚拟化指令（例如，Intel
    VT-x 或 AMD-V）。此外，虚拟机管理程序需要二级地址转换（SLAT）支持。最后，您的系统必须具有互联网连接或所有要由 `podman` `machine`
    获取的软件的离线副本。
- en: Note If at any time you experience the errors 0x80070003 or 0x80370102 (or any
    error indicating the VM cannot be started), you most likely have virtualization
    disabled. Check your BIOS (or WSL 2 instance) settings to verify VT-x/AMD-V/WSL
    2 instance and SLAT are enabled.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：如果您在任何时候遇到错误 0x80070003 或 0x80370102（或任何表示虚拟机无法启动的错误），您很可能已禁用虚拟化。检查您的 BIOS（或
    WSL 2 实例）设置以验证 VT-x/AMD-V/WSL 2 实例和 SLAT 是否已启用。
- en: 'While not required, installing Windows Terminal (as opposed to the standard
    CMD command application or PowerShell) is strongly recommended (future versions
    of Windows 11 include it by default). In addition to having modern terminal features,
    like transparent cut and paste and tiled screens, it also offers direct WSL and
    PowerShell integration, making it easy to switch between environments. You can
    install it via the Windows store or `winget`:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然不是必需的，但强烈建议安装 Windows Terminal（与标准 CMD 命令应用或 PowerShell 相比），因为 Windows 11
    的未来版本默认包含它。除了拥有现代终端功能，如透明剪切和粘贴以及分格屏幕外，它还提供了直接 WSL 和 PowerShell 集成，使得在不同环境之间切换变得容易。您可以通过
    Windows 商店或 `winget` 来安装它：
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: F.1.2 Installing Podman
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F.1.2 安装 Podman
- en: Installing Podman is straightforward. Go to the Podman site or the Podman GitHub
    repository, and download the latest Podman MSI Windows Installer in the Releases
    section (figure F.1; [https://github.com/containers/podman/releases](https://github.com/containers/podman/releases)).
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 安装 Podman 很简单。访问 Podman 网站或 Podman GitHub 仓库，然后在“发布”部分下载最新的 Podman MSI Windows
    安装程序（图 F.1；[https://github.com/containers/podman/releases](https://github.com/containers/podman/releases)）。
- en: '![](../../OEBPS/Images/F-01.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](../../OEBPS/Images/F-01.png)'
- en: Figure F.1 Downloading and running the Podman installer
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 图 F.1 下载和运行 Podman 安装程序
- en: After running the installer, open a terminal (use the `wt` command if you installed
    Windows Terminal as recommended), and execute your first `podman` command (figure
    F.2).
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 运行安装程序后，打开一个终端（如果您按照建议安装了 Windows Terminal，请使用 `wt` 命令），并执行您的第一个 `podman` 命令（图
    F.2）。
- en: '![](../../OEBPS/Images/F-02.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](../../OEBPS/Images/F-02.png)'
- en: Figure F.2 Podman commands running within the Windows Terminal
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图 F.2 在 Windows Terminal 中运行的 Podman 命令
- en: Automatic WSL installation
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 自动 WSL 安装
- en: 'If WSL is not installed on your Windows system, Podman installs it for you.
    Simply execute the `podman` `machine` `init` command (as illustrated in figure
    F.3) to create your first machine instance, and Podman prompts you for permission
    to install WSL. The WSL install process requires a reboot but resumes execution
    of the machine creation process. (Be sure to wait a few minutes for the terminal
    to relaunch and install.) If you prefer a manual installation, refer to the WSL
    installation guide: [https://docs.microsoft.com/en-us/windows/wsl/install](https://docs.microsoft.com/en-us/windows/wsl/install).'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的Windows系统上没有安装WSL，Podman会为您安装它。只需执行`podman` `machine` `init`命令（如图F.3所示）来创建您的第一个机器实例，然后Podman会提示您安装WSL的权限。WSL安装过程需要重启，但会继续执行机器创建过程。（请确保等待几分钟，以便终端重新启动并安装。）如果您更喜欢手动安装，请参阅WSL安装指南：[https://docs.microsoft.com/en-us/windows/wsl/install](https://docs.microsoft.com/en-us/windows/wsl/install)。
- en: '![](../../OEBPS/Images/F-03.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](../../OEBPS/Images/F-03.png)'
- en: Figure F.3 The podman machine init starts the WSL installation.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图F.3 podman machine init启动WSL安装。
- en: F.2 Using podman machine
  id: totrans-32
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: F.2 使用podman machine
- en: The setup and use of the Linux environment is made easy through the use of `podman`
    `machine` commands. On Windows, these commands create and manage a WSL 2 distribution,
    including downloading a base Linux image and packages from the internet and setting
    everything up for you. The WSL 2 distribution is preconfigured with the Podman
    service, and SSH connection configuration is automatically added to the `podman`
    `system` `connection` datastore. The final result is the ability to easily run
    Podman commands on your Windows desktop as if it was a Linux system. Table F.1
    lists all of the `podman` `machine` commands used to manage the lifecycle of the
    WSL 2-backed Linux environment.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用`podman` `machine`命令，可以轻松设置和使用Linux环境。在Windows上，这些命令创建和管理WSL 2发行版，包括从互联网下载基本Linux镜像和软件包，并为您设置一切。WSL
    2发行版预先配置了Podman服务，并将SSH连接配置自动添加到`podman` `system` `connection`数据存储中。最终结果是您可以在Windows桌面上轻松运行Podman命令，就像在Linux系统上一样。表F.1列出了用于管理WSL
    2支持的Linux环境生命周期的所有`podman` `machine`命令。
- en: Table F.1 `podman` `machine` commands
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 表F.1 `podman` `machine`命令
- en: '| Command | Description |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| 命令 | 描述 |'
- en: '| `init` | Initialize a new WSL 2-based machine instance. |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| `init` | 初始化一个新的基于WSL 2的机器实例。|'
- en: '| `list` | List WSL 2 machines. |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| `list` | 列出WSL 2机器。|'
- en: '| `rm` | Remove a WSL 2 machine instance. |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| `rm` | 删除一个WSL 2机器实例。|'
- en: '| `set` | Set an updatable WSL machine setting. |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| `set` | 设置可更新的WSL机器设置。|'
- en: '| `ssh` | `ssh` into a WSL 2 machine instance. This is useful for entering
    the WSL 2 instance and running the native Podman commands. Some Podman commands
    are not supported remotely, and you might want to change some configurations inside
    the WSL 2 instance. |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| `ssh` | 通过`ssh`连接到WSL 2机器实例。这对于进入WSL 2实例并运行原生Podman命令很有用。一些Podman命令不支持远程执行，您可能需要在WSL
    2实例内部更改一些配置。|'
- en: '| `start` | Start a WSL 2 machine instance. |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| `start` | 启动一个WSL 2机器实例。|'
- en: '| `stop` | Stop a WSL 2 machine instance. If you are not running containers,
    you might want to stop to save system resources. |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| `stop` | 停止一个WSL 2机器实例。如果您没有运行容器，您可能想要停止以节省系统资源。|'
- en: After installing Podman (see section F.1.2), the first step is creating a WSL
    2 machine instance on your system. You will use the `podman` `machine` `init`
    command, described in the following section.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在安装Podman（见F.1.2节）后，第一步是在您的系统上创建一个WSL 2机器实例。您将使用以下部分中描述的`podman` `machine` `init`命令。
- en: F.2.1 podman machine init
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F.2.1 podman machine init
- en: As shown in figure F.4, you can use the `podman` `machine` `init` command to
    automate the installation of a WSL 2-based Linux environment that hosts a Podman
    service for running containers. By default, `podman` `machine` `init` downloads
    a known compatible release of Fedora to create the WSL 2 instance ([https://getfedora.org](https://getfedora.org)).
    Fedora is used, since it is well integrated with Podman and is the operating system
    used by most of the Podman core developers.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 如图F.4所示，您可以使用`podman` `machine` `init`命令来自动安装一个基于WSL 2的Linux环境，该环境托管Podman服务以运行容器。默认情况下，`podman`
    `machine` `init`会下载一个已知的兼容版本的Fedora来创建WSL 2实例（[https://getfedora.org](https://getfedora.org)）。使用Fedora是因为它与Podman集成良好，并且是大多数Podman核心开发者使用的操作系统。
- en: '![](../../OEBPS/Images/F-04.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](../../OEBPS/Images/F-04.png)'
- en: Figure F.4 The podman machine init command creating the WSL 2 distribution and
    configuring SSH connections.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图F.4 podman machine init命令创建WSL 2发行版并配置SSH连接。
- en: Note In addition to the base image, a number of packages must be downloaded
    and installed, which can take several minutes to complete.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：除了基本镜像外，还需要下载和安装一些软件包，这可能需要几分钟才能完成。
- en: 'The following shows the condensed output from running the `podman` `machine`
    `init` command:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是从运行 `podman` `machine` `init` 命令中得到的简化输出：
- en: '[PRE1]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Table F.2 explains the `init` options that allow you to customize the default
    settings.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 表 F.2 解释了允许你自定义默认设置的 `init` 选项。
- en: Table F.2 `podman` `machine` `init` command options
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 表 F.2 `podman` `machine` `init` 命令选项
- en: '| Option | Description |'
  id: totrans-53
  prefs: []
  type: TYPE_TB
  zh: '| 选项 | 描述 |'
- en: '| `--cpus` `uint` | Not used |'
  id: totrans-54
  prefs: []
  type: TYPE_TB
  zh: '| `--cpus` `uint` | 未使用 |'
- en: '| `--disk-size` `uint` | Not used |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| `--disk-size` `uint` | 未使用 |'
- en: '| `--image-path` `string` | On Windows, this option refers to the Fedora distribution
    number (e.g., 35). As with Linux and Mac, you can also specify an arbitrary URL
    or filesystem location with a custom image, but Podman expects a Fedora-derived
    layout. |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| `--image-path` `string` | 在 Windows 上，此选项指的是 Fedora 发行版编号（例如，35）。与 Linux
    和 Mac 一样，你也可以指定一个任意 URL 或文件系统位置，使用自定义镜像，但 Podman 预期的是 Fedora 衍生的布局。|'
- en: '| `--memory` `integer` | Not used |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| `--memory` `integer` | 未使用 |'
- en: '| `--rootful` | Determines whether this machine instance should be rootful
    or rootless |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| `--rootful` | 确定此机器实例是否应该是 rootful 或 rootless |'
- en: Note The physical limits specified in table F.2 (e.g., CPU, memory, and disk)
    are currently ignored on Windows, since the Windows Subsystem for Linux (WSL)
    backend dynamically resizes and shares resources across distributions. If you
    need to constrain resources, you can configure those limits in your users’ .wslconfig
    file. However, they apply globally to all WSL 2 distros, since they share the
    same underlying VM.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 注意：表 F.2 中指定的物理限制（例如，CPU、内存和磁盘）目前在 Windows 上被忽略，因为 Windows Subsystem for Linux
    (WSL) 后端会根据不同的发行版动态调整和共享资源。如果你需要限制资源，你可以在你的用户 .wslconfig 文件中配置这些限制。然而，由于它们共享相同的底层虚拟机，因此它们适用于所有
    WSL 2 发行版。
- en: F.2.2 Podman machine SSH configuration
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F.2.2 Podman machine SSH 配置
- en: The `podman` `machine` `init` command creates an account within the WSL 2 instance.
    By default, the user in Fedora is user@localhost. Podman configures SSH on the
    client machine and the new user account and root within the WSL 2 instance. The
    SSH configuration allows for passwordless SSH commands to the `user` and `root`
    accounts from the client. The `podman` `machine` `init` command also configures
    the Podman system connection information (see section 9.5.4). The system connection
    database is configured for both the rootful user and rootless user within the
    WSL 2 instance. If you do not have any existing connections, the `podman` `machine`
    `init` command creates and sets as a default one of the rootless user connections
    to your WSL 2 instance.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '`podman` `machine` `init` 命令在 WSL 2 实例中创建一个账户。默认情况下，Fedora 中的用户是 user@localhost。Podman
    在客户端机器上配置 SSH，以及 WSL 2 实例中的新用户账户和 root。SSH 配置允许从客户端对 `user` 和 `root` 账户执行无密码 SSH
    命令。`podman` `machine` `init` 命令还配置了 Podman 系统连接信息（见第 9.5.4 节）。系统连接数据库为 WSL 2 实例中的
    rootful 用户和 rootless 用户配置。如果你没有任何现有的连接，`podman` `machine` `init` 命令会创建并设置一个默认的
    rootless 用户连接到你的 WSL 2 实例。'
- en: 'You can examine all of the connections using the `podman` `system` `connection`
    list command. The default connection, `podman-machine-default`, is the rootless
    connection:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 `podman` `system` `connection` list 命令检查所有连接。默认连接 `podman-machine-default`
    是 rootless 连接：
- en: '[PRE2]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Sometimes containers you want to execute require root privileges and cannot
    run in rootless modes. You can change the default connection to rootful by switching
    the default mode for the created machine instance. Modify the default to rootful
    service using the `podman` `machine` `set` command:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，你想要执行的容器需要 root 权限，并且不能在 rootless 模式下运行。你可以通过切换创建的机器实例的默认模式来将默认连接更改为 rootful。使用
    `podman` `machine` `set` 命令将默认服务修改为 rootful：
- en: '[PRE3]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'View the connections again to confirm the default is now `podman-machine-default-root`:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 再次查看连接以确认默认连接现在是 `podman-machine-default-root`：
- en: '[PRE4]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Now all Podman commands connect directly to the Podman service running within
    the root account. Change the default connection back to the rootless user using
    the `podman` `machine` `set` command again:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，所有 Podman 命令都直接连接到在 root 账户中运行的 Podman 服务。再次使用 `podman` `machine` `set` 命令将默认连接更改为
    rootless 用户：
- en: '[PRE5]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: If you attempt to run a Podman container at this point, it fails because the
    machine instance is not actually running. You need to start the machine instance.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你现在尝试运行 Podman 容器，它会失败，因为机器实例实际上并没有运行。你需要启动机器实例。
- en: F.2.3 Starting the WSL 2 instance
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F.2.3 启动 WSL 2 实例
- en: 'Attempting to execute the `podman` `version` command fails because the WSL
    2 instance is not started:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试执行 `podman` `version` 命令失败，因为 WSL 2 实例尚未启动：
- en: '[PRE6]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: As the error points out, the virtualized Linux environment (the WSL 2 machine
    instance) is not running and must be started.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 正如错误信息所指出的，虚拟化 Linux 环境（WSL 2 机器实例）尚未运行，必须启动。
- en: 'You start a single WSL 2 instance using the `podman` `machine` `start` command.
    By default, it starts the default WSL 2 instance: `podman-machine-default`. If
    you have multiple WSL 2 instances and want to start a different WSL 2 instance,
    you can specify the optional machine name for the `podman` `machine` `start` command:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 `podman` `machine` `start` 命令启动单个 WSL 2 实例。默认情况下，它会启动默认的 WSL 2 实例：`podman-machine-default`。如果你有多个
    WSL 2 实例并且想要启动不同的 WSL 2 实例，你可以为 `podman` `machine` `start` 命令指定可选的机器名称：
- en: '[PRE7]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'You are now ready to begin running Podman commands on the host that communicates
    with the Podman service running in the WSL 2 instance. Run the `podman` `version`
    command to confirm the client and server are configured correctly. If not, the
    Podman commands instruct you on how to configure the system:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你已准备好开始在主机上运行 Podman 命令，该主机与在 WSL 2 实例中运行的 Podman 服务进行通信。运行 `podman` `version`
    命令以确认客户端和服务器配置正确。如果不正确，Podman 命令将指导你如何配置系统：
- en: '[PRE8]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Now you can use the Podman commands you learned in the previous chapters directly
    on Windows. Make sure you understand that Podman on Windows is equivalent to `podman`
    `--remote` talking remotely to the Podman service within the WSL 2 instance.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以在 Windows 上直接使用之前章节中学到的 Podman 命令。请确保你理解 Windows 上的 Podman 等同于 `podman`
    `--remote` 远程与 WSL 2 实例内部的 Podman 服务进行通信。
- en: F.2.4 Using podman machine commands
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: F.2.4 使用 podman machine 命令
- en: 'After your machine instance is running, you can perform Podman commands in
    your PowerShell prompt as if running within Windows:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的机器实例运行后，你可以在 PowerShell 提示符下执行 Podman 命令，就像在 Windows 内运行一样：
- en: '[PRE9]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Stopping the WSL 2 instance
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 关闭 WSL 2 实例
- en: 'When you are done using containers on your system, you might want to shut down
    the WSL 2 instance to save on system resources. Use the `podman` `machine` `stop`
    command to shut down all containers within the WSL 2 instance as well as the WSL
    2 instance:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在系统上完成容器使用后，你可能想要关闭 WSL 2 实例以节省系统资源。使用 `podman` `machine` `stop` 命令来关闭 WSL
    2 实例内的所有容器以及 WSL 2 实例：
- en: '[PRE10]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: When you need to start using containers again, launch the WSL 2 instance with
    the `podman` `machine` `start` command.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 当你需要再次开始使用容器时，使用 `podman` `machine` `start` 命令启动 WSL 2 实例。
- en: Note All of the `podman` `machine` commands work on Linux as well and allow
    you to test different versions of Podman at the same time. Podman on Linux is
    the complete command; therefore, you need to use the `--remote` option to communicate
    with the Podman service running within the WSL 2 instance launched by the `podman`
    `machine` command. On non-Linux platforms, the `--remote` option is not required,
    since the client is preconfigured in `--remote` mode.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 注意 所有 `podman` `machine` 命令在 Linux 上也有效，并允许你同时测试 Podman 的不同版本。Linux 上的 Podman
    是完整的命令；因此，你需要使用 `--remote` 选项与由 `podman` `machine` 命令启动的 WSL 2 实例内部的 Podman 服务进行通信。在非
    Linux 平台上，不需要 `--remote` 选项，因为客户端已预先配置为 `--remote` 模式。
- en: Listing machines
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 列出机器
- en: You can list the available machine instances using the `podman` `machine` `ls`
    command. The values returned by this command on Windows reflect current active
    usage, as opposed to fixed resource limits, as is the case on Mac and Linux. Disk
    storage reflects the disk space currently allocated to each machine instance.
    The CPU values convey the number of CPUs on the Windows host (unless limited by
    WSL) repeated per machine instance. The returned memory values are also repeated
    (with slight variation from sampling variability) and reflect the total amount
    of memory used by the Linux kernel for all distributions in use (since it is shared).
    In other words, for total usage, you sum the disk sizes but not memory and CPU.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 `podman` `machine` `ls` 命令列出可用的机器实例。此命令在 Windows 上返回的值反映了当前的活动使用情况，而不是固定的资源限制，这与
    Mac 和 Linux 上的情况不同。磁盘存储反映了分配给每个机器实例的磁盘空间。CPU 值传达了 Windows 主机上的 CPU 数量（除非由 WSL
    限制），每个机器实例重复一次。返回的内存值也重复（略有变化，这是由于采样变异性），反映了所有使用分布的 Linux 内核使用的总内存量（因为它共享）。换句话说，对于总使用量，你将磁盘大小相加，但不包括内存和
    CPU。
- en: '[PRE11]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Using Podman at the WSL prompt
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在 WSL 提示符下使用 Podman
- en: 'In addition to the `podman` `machine` `ssh` command, you can also access the
    `podman` `machine` `guest` using the WSL prompt. If you are running Windows Terminal,
    the `podman` `machine` `guests` (names prefixed by Podman) are in the down-arrow
    dropdown. Alternatively, you can drop into a WSL shell from any PowerShell prompt
    by using the `wsl` command and specifying the backing distribution name. For example,
    the default instance created by `podman` `machine` `init` is `podman-machine-default`.
    You can use either approach to manage the guest and execute Podman commands inside
    a full-featured Linux shell environment:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 除了 `podman` `machine` `ssh` 命令外，您还可以使用 WSL 提示符访问 `podman` `machine` `guest`。如果您正在运行
    Windows Terminal，则 `podman` `machine` `guests`（以 Podman 为前缀的名称）位于向下箭头下拉菜单中。或者，您可以通过使用
    `wsl` 命令并指定支持的分发名称，从任何 PowerShell 提示符进入 WSL shell。例如，`podman` `machine` `init`
    创建的默认实例是 `podman-machine-default`。您可以使用这两种方法来管理虚拟机并在功能齐全的 Linux shell 环境中执行 Podman
    命令：
- en: '[PRE12]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Updating Fedora
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 更新 Fedora
- en: 'Since the Windows machine implementation is based on Fedora, not Fedora CoreOS,
    fixes and enhancements are not automatic. They must be explicitly initiated on
    the guest using Fedora’s package management command: `dnf`. Further, upgrading
    to a new version of Fedora requires exporting any data you need to preserve and
    using `podman` `machine` `init` to create a second machine instance (or replacing
    the existing one after a `podman` `machine` `rm` command).'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 Windows 机器实现基于 Fedora，而不是 Fedora CoreOS，因此修复和增强不是自动的。它们必须在虚拟机中使用 Fedora 的包管理命令
    `dnf` 明确启动。此外，升级到 Fedora 的新版本需要导出您需要保留的所有数据，并使用 `podman` `machine` `init` 创建第二个机器实例（或在执行
    `podman` `machine` `rm` 命令后替换现有的实例）。
- en: Note Currently, it is difficult to run Fedora CoreOS inside of WSL, so it was
    decided to default to Fedora. If Windows support for CoreOS changes in the future,
    `podman` `machine` will move to Fedora CoreOS.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 注意 目前，在 WSL 内运行 Fedora CoreOS 难以实现，因此默认选择 Fedora。如果将来 Windows 对 CoreOS 的支持发生变化，`podman`
    `machine` 将迁移到 Fedora CoreOS。
- en: 'As an example, to pull the latest packages for the version of Fedora running
    on the p`odman` `guest`, perform the following command:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，要获取在 `p`odman` `guest` 上运行的 Fedora 版本的最新软件包，请执行以下命令：
- en: '[PRE13]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Advanced stopping and restarting
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 高级停止和重启
- en: 'Normally, to stop and restart Podman, you would use the respective `podman`
    `machine` `stop` and `podman` `machine` `start` commands. Stopping the machine
    is the preferred approach, since system services can come to a clean stop. However,
    in some cases, you may wish to force a hard restart of the WSL facilities, including
    the shared Linux kernel, which stays active even after a machine stop. To kill
    all processes associated with a WSL distribution, use the `wsl` `--terminate`
    `<machine` `name>` command. To shut down the Linux kernel, killing all running
    distributions, use the `wsl` `--shutdown` command. After these commands are issued,
    you can use a standard `podman` `machine` `start` command to relaunch your instance:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，要停止和重启 Podman，您会使用相应的 `podman` `machine` `stop` 和 `podman` `machine` `start`
    命令。停止机器是首选方法，因为系统服务可以干净地停止。然而，在某些情况下，您可能希望强制重启 WSL 设施，包括共享的 Linux 内核，即使在机器停止后，内核仍然保持活跃。要杀死与
    WSL 发行版相关的所有进程，请使用 `wsl` `--terminate` `<machine` `name>` 命令。要关闭 Linux 内核，杀死所有正在运行的发行版，请使用
    `wsl` `--shutdown` 命令。在发出这些命令后，您可以使用标准的 `podman` `machine` `start` 命令重新启动您的实例：
- en: '[PRE14]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Summary
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Linux containers require a Linux kernel, meaning running containers on a Mac
    or Windows platform requires a VM running Linux.
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux 容器需要一个 Linux 内核，这意味着在 Mac 或 Windows 平台上运行容器需要运行 Linux 的虚拟机。
- en: Podman on Windows does not run containers locally on Windows. The Podman command
    is actually `podman` `--remote` communicating with the Podman service running
    on a Linux machine backed by WSL 2.
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 上的 Podman 不在本地运行容器。实际上，Podman 命令是 `podman` `--remote` 与在 Linux 机器上运行的
    Podman 服务通信，该机器由 WSL 2 支持。
- en: The `podman` `machine` `init` pulls down and installs a virtual Linux environment
    onto your platform, which runs the Podman service.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`podman` `machine` `init` 命令将下载并安装一个虚拟 Linux 环境到您的平台上，该环境运行 Podman 服务。'
- en: The `podman` `machine` `init` command also sets up the SSH environment required
    to allow the Podman remote client to communicate with the Podman server inside
    of the WSL 2 instance.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`podman` `machine` `init` 命令还设置了 SSH 环境，以便 Podman 远程客户端能够与 WSL 2 实例内部的 Podman
    服务器通信。'
- en: Podman on Windows with WSL is the full Podman command. WSL is running the Podman
    commands under the Linux kernel, even though it feels like it is running natively
    on the Windows machine.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在WSL上运行的Windows Podman是完整的Podman命令。WSL在Linux内核下运行Podman命令，尽管它感觉就像是在Windows机器上原生运行一样。
