- en: Appendix D. Training and deploying bots by using Amazon Web Services
  id: totrans-0
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 附录D. 使用亚马逊网络服务进行机器人和部署
- en: 'In this appendix, you’re going to learn how to use the cloud service Amazon
    Web Services (AWS) to build and deploy your deep-learning models. Knowing how
    to use a cloud service and hosting models is a useful skill in general, not only
    for this Go bot use case. You’ll learn the following skills:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本附录中，你将学习如何使用云服务亚马逊网络服务（AWS）来构建和部署你的深度学习模型。了解如何使用云服务和托管模型是一项有用的技能，不仅适用于这个Go机器人用例。你将学习以下技能：
- en: Setting up a virtual server with AWS to train deep-learning models
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用AWS设置虚拟服务器以训练深度学习模型
- en: Running deep-learning experiments in the cloud
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在云中运行深度学习实验
- en: Deploying a Go bot with a web interface on a server to share with others
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在服务器上部署具有Web界面的Go机器人以与他人共享
- en: Although as of this writing AWS is the largest cloud provider in the world and
    provides many benefits, we could’ve chosen many other cloud services for this
    appendix. Because the big cloud providers largely overlap in terms of their offerings,
    getting started with one will help you know the others as well.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管截至本文撰写时，AWS是世界上最大的云服务提供商，并提供了许多好处，但我们本可以选择许多其他云服务来编写本附录。因为大型云服务提供商在提供的产品方面有很大重叠，所以使用其中一个开始将帮助你了解其他云服务。
- en: 'To get started with AWS, head over to [https://aws.amazon.com/](https://aws.amazon.com/)
    to see the large product range AWS has to offer. Amazon’s cloud service gives
    you access to an almost intimidatingly large number of products, but for this
    book you’ll get pretty far by using just a single service: Amazon Elastic Compute
    Cloud (EC2). EC2 gives you easy access to virtual servers in the cloud. Depending
    on your needs, you can equip these servers or instances with various hardware
    specifications. To train deep neural networks efficiently, you need access to
    strong GPUs. Although AWS may not always provide the latest generation of GPUs,
    flexibly buying compute time on a cloud GPU is a good way to get started without
    investing too much in hardware up front.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用AWS，请访问[https://aws.amazon.com/](https://aws.amazon.com/)查看AWS提供的广泛产品。亚马逊的云服务为你提供了几乎令人敬畏的大量产品，但就这本书而言，你只需使用单一服务：亚马逊弹性计算云（EC2）。EC2让你轻松访问云中的虚拟服务器。根据你的需求，你可以为这些服务器或实例配备各种硬件规格。为了高效训练深度神经网络，你需要访问强大的GPU。尽管AWS可能并不总是提供最新一代的GPU，但在云GPU上灵活购买计算时间是一种在不前期投入过多硬件的情况下开始的好方法。
- en: The first thing you need to do is register an account with AWS at [https://portal.aws.amazon.com/billing/signup](https://portal.aws.amazon.com/billing/signup);
    fill out the form shown in [figure D.1](#app04fig01).
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要做的第一件事是在[https://portal.aws.amazon.com/billing/signup](https://portal.aws.amazon.com/billing/signup)注册AWS账户；填写如图D.1所示的表格。
- en: Figure D.1\. Signing up for an AWS account
  id: totrans-8
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图D.1. 注册AWS账户
- en: '![](Images/dfig01.jpg)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![图片描述](Images/dfig01.jpg)'
- en: After signing up, at the top right of the page ([https://aws.amazon.com/](https://aws.amazon.com/))
    you should click Sign in to the Console and enter your account credentials. This
    redirects you to the main dashboard for your account. From the top menu bar, click
    Services, which opens a panel displaying the AWS core products. Click the EC2
    option in the Compute category, as shown in [figure D.2](#app04fig02).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 注册后，在页面右上角（[https://aws.amazon.com/](https://aws.amazon.com/））你应该点击“登录控制台”并输入你的账户凭证。这会把你重定向到你的主要仪表板。从顶部菜单栏，点击“服务”，这将打开一个面板，显示AWS核心产品。在计算类别中点击EC2选项，如图D.2所示。
- en: Figure D.2\. Selecting the Elastic Cloud Compute (EC2) service from the Services
    menu
  id: totrans-11
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图D.2. 从服务菜单中选择弹性云计算（EC2）服务
- en: '![](Images/dfig02.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![图片描述](Images/dfig02.jpg)'
- en: This puts you into the EC2 dashboard, which gives you an overview of your currently
    running instances and their statuses. Given that you just signed up, you should
    see 0 running instances. To launch a new instance, click the Launch Instance button,
    as shown in [figure D.3](#app04fig03).
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 这将把你带到EC2仪表板，它为你提供了当前运行实例及其状态的概览。鉴于你刚刚注册，你应该看到0个正在运行的实例。要启动一个新的实例，点击“启动实例”按钮，如图D.3所示。
- en: Figure D.3\. Launching a new AWS instance
  id: totrans-14
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图D.3. 启动新的AWS实例
- en: '![](Images/dfig03_alt.jpg)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![图片描述](Images/dfig03_alt.jpg)'
- en: At this point, you’re asked to select an Amazon Machine Image (AMI), which is
    a blueprint for the software that will be available to you on your launched instance.
    To get started quickly, you’ll choose an AMI that’s specifically tailored for
    deep-learning applications. On the left sidebar, you’ll find the AWS Marketplace
    (see [figure D.4](#app04fig04)), which has a lot of useful third-party AMIs.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在此阶段，您需要选择一个亚马逊机器镜像（AMI），这是您在启动的实例上可用的软件的蓝图。为了快速开始，您将选择专门针对深度学习应用的 AMI。在左侧边栏中，您会找到
    AWS Marketplace（见 [图 D.4](#app04fig04)），它有很多有用的第三方 AMI。
- en: Figure D.4\. Selecting the AWS Marketplace
  id: totrans-17
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 D.4\. 选择 AWS Marketplace
- en: '![](Images/dfig04.jpg)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/dfig04.jpg)'
- en: In the Marketplace, search for Deep Learning AMI Ubuntu, as shown in [figure
    D.5](#app04fig05). As the name suggests, this instance runs on Ubuntu Linux and
    has many useful components already preinstalled. For instance, on this AMI, you’ll
    find TensorFlow and Keras available, plus all the necessary GPU drivers already
    installed for you. Therefore, when the instance is ready, you can get right into
    your deep-learning application, instead of spending time and effort installing
    software.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Marketplace 中搜索“Deep Learning AMI Ubuntu”，如图 [图 D.5](#app04fig05) 所示。正如其名所示，此实例运行在
    Ubuntu Linux 上，并已预先安装了许多有用的组件。例如，在此 AMI 上，您会发现 TensorFlow 和 Keras 可用，以及为您预先安装的所有必要的
    GPU 驱动程序。因此，当实例准备就绪时，您可以立即开始您的深度学习应用，而不是花费时间和精力安装软件。
- en: Figure D.5\. Choosing an AMI suited for deep learning
  id: totrans-20
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 D.5\. 选择适合深度学习的 AMI
- en: '![](Images/dfig05_alt.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/dfig05_alt.jpg)'
- en: Choosing this particular AMI is cheap but doesn’t come entirely for free. If
    you want to play with a free instance instead, look for the *free tier eligible*
    tag. For example, in the Quick Start section shown previously in [figure D.4](#app04fig04),
    most of the AMIs shown there you *can* get for free.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 选择这个特定的 AMI 成本较低，但并非完全免费。如果您想使用免费实例，请寻找带有 *免费层合格* 标签的选项。例如，在前面显示的快速入门部分 [图 D.4](#app04fig04)
    中，其中大多数显示的 AMI 您 *可以* 免费获得。
- en: After clicking Select for the AMI of your choice, a tab opens that shows you
    the pricing for this AMI, depending on which instance type you choose; see [figure
    D.6](#app04fig06).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择您选择的 AMI 后点击“选择”，将打开一个标签页，显示此 AMI 的定价，具体取决于您选择的实例类型；见 [图 D.6](#app04fig06)。
- en: Figure D.6\. Pricing for your deep-learning AMI, depending on the instance you
    choose
  id: totrans-24
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 D.6\. 根据您选择的实例类型为您的深度学习 AMI 定价
- en: '![](Images/dfig06_alt.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/dfig06_alt.jpg)'
- en: Continuing, you can now choose your instance type. In [figure D.7](#app04fig07),
    you see all instance types optimized for GPU performance. Selecting p2.xlarge
    is a good option to get started, but keep in mind that all GPU instances are comparatively
    expensive. If you first want to get a feel for AWS and familiarize yourself with
    the features presented here, go for an inexpensive t2.small instance first. If
    you’re interested only in deploying and hosting models, a t2.small instance will
    be sufficient anyway; it’s only the model training that requires more-expensive
    GPU instances.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 继续操作，您现在可以选择您的实例类型。在 [图 D.7](#app04fig07) 中，您可以看到所有针对 GPU 性能优化的实例类型。选择 p2.xlarge
    是一个不错的入门选项，但请记住，所有 GPU 实例相对较贵。如果您首先想对 AWS 有所了解，并熟悉这里展示的功能，请首先选择一个价格低廉的 t2.small
    实例。如果您只对部署和托管模型感兴趣，t2.small 实例也足够了；只是模型训练需要更昂贵的 GPU 实例。
- en: Figure D.7\. Selecting the right instance type for your needs
  id: totrans-27
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 D.7\. 选择适合您需求的实例类型
- en: '![](Images/dfig07_alt.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/dfig07_alt.jpg)'
- en: 'After you’ve chosen an instance type, you could directly click the Review and
    Launch button in the lower right to immediately launch the instance. But because
    you still need to configure a few things, you’ll instead opt for Next: Configure
    Instance Details. Steps 3 to 5 in the dialog box that follows can be safely skipped
    for now, but step 6 (Configure Security Group) requires some attention. A *security
    group* on AWS specifies access rights to the instance by defining *rules*. You
    want to grant the following access rights:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在您选择了一个实例类型后，您可以直接点击右下角的“审查和启动”按钮立即启动实例。但因为你还需要配置一些事情，所以您将选择“下一步：配置实例详情”。在随后的对话框中的步骤
    3 到 5 可以现在安全跳过，但步骤 6（配置安全组）需要一些注意。AWS 上的 *安全组* 通过定义 *规则* 来指定实例的访问权限。您希望授予以下访问权限：
- en: Primarily, you want to access your instance by logging in through SSH. The SSH
    port 22 on the instance should already by open (this is the only specified rule
    on new instances), but you need to restrict access and allow connections from
    only your local machine. You do this for security reasons, so that nobody else
    can access your AWS instance; only your IP is granted access. This can be achieved
    by selecting My IP under Source.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主要的，您希望通过SSH登录来访问您的实例。实例上的SSH端口22应该已经打开（这是新实例上唯一指定的规则），但您需要限制访问，只允许从您的本地机器连接。您这样做是出于安全原因，这样其他人就无法访问您的AWS实例；只有您的IP被授予访问权限。这可以通过在源下选择我的IP来实现。
- en: Because you also want to deploy a web application, and later even a bot that
    connects to other Go servers, you’ll also have to open HTTP port 80\. You do so
    by first clicking Add Rule and selecting HTTP as the type. This will automatically
    select port 80 for you. Because you want to allow people to connect to your bot
    from anywhere, you should select Anywhere as the Source.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因为您还想要部署一个Web应用程序，甚至是一个连接到其他Go服务器的机器人，您还必须打开HTTP端口80。您可以通过首先点击添加规则并选择HTTP作为类型来实现这一点。这将自动为您选择端口80。因为您希望人们可以从任何地方连接到您的机器人，所以您应该将源选择为任何地方。
- en: The HTTP Go bot from [chapter 8](kindle_split_020.xhtml#ch08) runs on port 5000,
    so you should open this port as well. In production scenarios, you’d normally
    deploy a suitable web server listening on port 80 (which you configured in the
    preceding step); this internally redirects traffic to port 5000\. To keep things
    simple, you trade security for convenience and open port 5000 directly. You can
    do this by adding another rule and selecting Custom TCP Rule as the type and 5000
    as the port range. As for the HTTP port, you set the source to Anywhere. This
    will prompt a security warning, which you’ll ignore because you’re not dealing
    with any sensitive or proprietary data or application.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 来自第8章的HTTP Go机器人运行在端口5000上，因此您也应该打开这个端口。在生产环境中，您通常会部署一个合适的Web服务器，监听端口80（您在上一步骤中已配置）；它内部将流量重定向到端口5000。为了简化操作，您以方便为代价牺牲了安全性，直接打开了端口5000。您可以通过添加另一条规则，选择自定义TCP规则作为类型，并将5000作为端口范围来实现这一点。至于HTTP端口，您将源设置为任何地方。这将提示一个安全警告，但您可以忽略它，因为您没有处理任何敏感或专有数据或应用程序。
- en: If you configured the access rules as we just described, your settings should
    look like those in [figure D.8](#app04fig08).
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您配置了如我们刚才描述的访问规则，您的设置应该看起来像[图D.8](#app04fig08)中的那样。
- en: Figure D.8\. Configuring security groups for your AWS instance
  id: totrans-34
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图D.8. 配置您的AWS实例的安全组
- en: '![](Images/dfig08_alt.jpg)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/dfig08_alt.jpg)'
- en: After completing security settings, you can click Review and Launch and then
    Launch. This opens a window that will ask you to create a new key pair or select
    an existing one. You need to select Create a New Pair from the drop-down menu.
    The only thing you need to do is select a *key pair name* and then download the
    *secret* key by clicking Download Key Pair. The downloaded key will have the name
    you’ve given it, with a .pem file signature. Make sure to store this private key
    in a secure location. The public key for your private key is managed by AWS and
    will be put on the instance you’re about to launch. With the private key, you
    can then connect to the instance. After you’ve created a key, you can reuse it
    in the future by selecting Choose an Existing Key Pair. In [figure D.9](#app04fig09),
    you see how we created a key pair called maxpumperla_aws.pem.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 完成安全设置后，您可以点击“审查和启动”，然后点击“启动”。这将打开一个窗口，要求您创建一个新的密钥对或选择一个现有的密钥对。您需要从下拉菜单中选择创建一个新的密钥对。您需要做的唯一事情是选择一个*密钥对名称*，然后通过点击下载密钥对来下载*秘密*密钥。下载的密钥将具有您给出的名称，并带有.pem文件签名。请确保将这个私钥存储在安全的位置。您的私钥的公钥由AWS管理，并将放置在您即将启动的实例上。有了私钥，您就可以连接到该实例。创建密钥后，您可以通过选择选择现有的密钥对来在未来重用它。在[图D.9](#app04fig09)中，您可以看到我们如何创建了一个名为maxpumperla_aws.pem的密钥对。
- en: Figure D.9\. Creating a new key pair to access your AWS instance
  id: totrans-37
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图D.9. 创建新的密钥对以访问您的AWS实例
- en: '![](Images/dfig09_alt.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![图片](Images/dfig09_alt.jpg)'
- en: This was the final step, and you can now launch your instance by clicking Launch
    Instance. You’ll see an overview called Launch Status, and you can proceed by
    selecting View Instances in the lower right. This puts you back into the EC2 main
    dashboard from which you started (by selecting Launch Instances). You should see
    your instance listed there. After waiting for a bit, you should see that the instance
    state is “running” and see a green dot next to the state. This means your instance
    is ready, and you can now connect to it. You do so by first selecting the check
    box to the left of the instance, which activates the Connect button on top. Clicking
    this button opens a window that looks like the one shown in [figure D.10](#app04fig10).
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是最后一步，现在您可以通过点击“启动实例”来启动您的实例。您将看到一个名为“启动状态”的概览，您可以通过在右下角选择“查看实例”来继续操作。这将使您回到从“启动实例”开始的主仪表板。您应该在那里看到您的实例列表。等待一段时间后，您应该会看到实例状态为“运行”，并且状态旁边有一个绿色的点。这意味着您的实例已准备好，您现在可以连接到它。您可以通过首先选择实例左侧的复选框来这样做，这将激活顶部的“连接”按钮。点击此按钮将打开一个类似于[图
    D.10](#app04fig10) 中所示的窗口。
- en: Figure D.10\. Creating a new key pair to access your AWS instance
  id: totrans-40
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 图 D.10\. 创建新的密钥对以访问您的 AWS 实例
- en: '![](Images/dfig10_alt.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](Images/dfig10_alt.jpg)'
- en: 'This window contains a lot of useful information for connecting to your instance,
    so read it carefully. In particular, it gives you instructions on how to connect
    to your instance with `ssh`. If you open a terminal and then copy and paste the
    `ssh` command listed under Example, you should establish a connection to your
    AWS instance. This command is as follows:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 此窗口包含许多连接到您的实例的有用信息，因此请仔细阅读。特别是，它提供了如何使用 `ssh` 连接到您的实例的说明。如果您打开一个终端并将示例下列出的
    `ssh` 命令复制并粘贴，您应该能够建立到您的 AWS 实例的连接。此命令如下：
- en: '[PRE0]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'This is a long command that can be a little inconvenient to work with, especially
    when you’re handling many instances or SSH connections to other machines as well.
    To make life easier, we’re going to work with an SSH configuration file. In UNIX
    environments, this configuration file is usually stored at ~/.ssh/config. On other
    systems, this path may vary. Create this file and the .ssh folder, if necessary,
    and put the following content into this file:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个较长的命令，可能有点不便使用，尤其是当您正在处理多个实例或同时处理到其他机器的 SSH 连接时。为了使生活更简单，我们将使用一个 SSH 配置文件。在
    UNIX 环境中，此配置文件通常存储在 ~/.ssh/config。在其他系统中，此路径可能不同。如果需要，创建此文件和 .ssh 文件夹，并将以下内容放入此文件中：
- en: '[PRE1]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Having stored this file, you can now connect to your instance by typing `ssh
    aws` into your terminal. When you first connect, you’re asked whether you want
    to connect. Type `yes` and submit this command by pressing Enter. Your key will
    be added permanently to the instance (which you can check by running `cat ~/.ssh/authorized_keys`
    to return a secure hash of your key pair), and you won’t be asked again.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 存储此文件后，您现在可以通过在终端中输入 `ssh aws` 来连接到您的实例。当您第一次连接时，系统会询问您是否想要连接。键入 `yes` 并通过按
    Enter 键提交此命令。您的密钥将被永久添加到实例中（您可以通过运行 `cat ~/.ssh/authorized_keys` 来检查，这将返回您密钥对的安全散列），并且您将不会被再次询问。
- en: The first time you successfully log into the instance of the Deep Learning AMI
    Ubuntu AMI (in case you went with this one), you’ll be offered a few Python environments
    to choose from. An option that gives you a full Keras and TensorFlow installation
    for Python 3.6\. is `source activate tensorflow_p36`, or `source activate tensorflow_p27`
    if you prefer to go with Python 2.7\. For the rest of this appendix, we assume
    you skip this and work with the basic Python version already provided on this
    instance.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 第一次成功登录到 Deep Learning AMI Ubuntu AMI 的实例（如果您选择了这个选项），您将获得几个 Python 环境供您选择。一个提供
    Python 3.6 完整 Keras 和 TensorFlow 安装的选项是 `source activate tensorflow_p36`，或者如果您更喜欢
    Python 2.7，则使用 `source activate tensorflow_p27`。在本附录的其余部分，我们假设您跳过此步骤，并使用此实例上已提供的基本
    Python 版本进行工作。
- en: Before you proceed to running applications on your instance, let’s quickly discuss
    how to terminate an instance. This is important to know, because if you forget
    to shut down an expensive instance, you can easily end up with a few hundred dollars
    of costs per month. To terminate an instance, you select it (by clicking the check
    box next to it, as you did before) and then click the Actions button at the top
    of the page, followed by Instance State and Terminate. Terminating an instance
    deletes it, including everything you stored on it. Make sure to copy everything
    you need (for instance, the model you trained) before termination (we’ll show
    you how in just a bit). Another option is to Stop the instance, which allows you
    to Start it at a later point. Note, however, that depending on the storage that
    your instance is equipped with, this might still lead to data loss. You’ll be
    prompted with a warning in this situation.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在您开始在实例上运行应用程序之前，让我们快速讨论如何终止实例。这一点很重要，因为如果您忘记关闭昂贵的实例，您可能会轻易地每月产生几百美元的费用。要终止实例，您选择它（通过点击它旁边的复选框，就像您之前做的那样），然后点击页面顶部的“操作”按钮，接着选择“实例状态”和“终止”。终止实例将删除它，包括您存储在其上的所有内容。在终止之前，请确保复制您需要的所有内容（例如，您训练的模型）（我们将在稍后向您展示）。另一个选项是停止实例，这允许您稍后启动它。请注意，然而，根据您的实例配备的存储，这仍然可能导致数据丢失。在这种情况下，您将收到警告提示。
- en: Model training on AWS
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: AWS 上的模型训练
- en: 'Running a deep-learning model on AWS works the same way as running it locally,
    after you have everything in place. You first need to make sure you have all the
    code and data you need on the instance. An easy way to do that is by copying it
    there in a secure way by using `scp`. For example, from your local machine, you
    can run the following commands to compute an end-to-end example:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在 AWS 上运行深度学习模型的方式与在本地运行的方式相同，在您已经设置好所有内容之后。您首先需要确保您在实例上拥有所有需要的代码和数据。一种简单的方法是通过使用
    `scp` 以安全的方式将其复制到那里。例如，从您的本地机器，您可以运行以下命令来计算一个端到端示例：
- en: '[PRE2]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '***1* Copy code from local to your remote AWS instance.**'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***1* 将代码从本地复制到您的远程 AWS 实例。**'
- en: '***2* Log into the instance with ssh.**'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***2* 使用 ssh 登录到实例。**'
- en: '***3* Install your dlgo Python library.**'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***3* 安装您的 dlgo Python 库。**'
- en: '***4* Run an end-to-end example.**'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***4* 运行一个端到端示例。**'
- en: 'In this example, we assume you start fresh by cloning our GitHub repository
    first. In practice, you’ll have done this already and want to build your own experiments
    instead. You do this by creating the deep neural networks you want to train and
    running the examples you want. The example end_to_end.py we just presented will
    produce a serialized deep-learning bot in the following path relative to the examples
    folder: ../agents/deep_bot.h5\. After the example runs, you can either leave the
    model there (for example, to host it or continue working on it) or retrieve it
    from the AWS instance and copy it back to your machine. For instance, from a terminal
    on your local machine, you can copy a bot called deep_bot.h5 from AWS to local
    as follows:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们假设您首先通过克隆我们的 GitHub 仓库来从头开始。在实践中，您可能已经完成了这项工作，并希望构建自己的实验。您可以通过创建您想要训练的深度神经网络并运行您想要的示例来完成此操作。我们刚刚展示的
    end_to_end.py 示例将在以下路径生成一个序列化的深度学习机器人：相对于示例文件夹的 ../agents/deep_bot.h5\. 示例运行完毕后，您可以选择将模型留在那里（例如，托管它或继续工作）或从
    AWS 实例检索它并将其复制回您的机器。例如，从您本地机器的终端，您可以按照以下方式将名为 deep_bot.h5 的机器人从 AWS 复制到本地：
- en: '[PRE3]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'This makes for a relatively lean model-training workflow that we can summarize
    as follows:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这使得模型训练工作流程相对简洁，我们可以总结如下：
- en: Set up and test your deep-learning experiments locally by using the dlgo framework.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 dlgo 框架在本地设置和测试您的深度学习实验。
- en: Securely copy the changes you made to your AWS instance.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安全地复制您对 AWS 实例所做的更改。
- en: Log into the remote machine and start your experiment.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到远程机器并开始您的实验。
- en: After training finishes, evaluate your results, adapt your experiment, and start
    a new experimentation cycle at 1.
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 训练完成后，评估您的结果，调整您的实验，并从步骤 1 开始新的实验周期。
- en: If you wish, copy your trained model to your local machine for future use or
    process it otherwise.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您愿意，可以将您的训练模型复制到您的本地机器以供将来使用或以其他方式处理。
- en: Hosting a bot on AWS over HTTP
  id: totrans-64
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在 AWS 上通过 HTTP 托管机器人
- en: '[Chapter 8](kindle_split_020.xhtml#ch08) showed you how to serve a bot over
    HTTP so you and your friends can play against it through a convenient web interface.
    The drawback was that you simply started a Python web server locally on your machine.
    So for others to test your bot, they’d have to have direct access to your computer.
    By deploying this web application on AWS and opening the necessary ports (as you
    did when setting up the instance), you can share your bot with others by sharing
    a URL.'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '[第8章](kindle_split_020.xhtml#ch08)向您展示了如何通过HTTP服务一个机器人，这样您和您的朋友就可以通过一个便捷的Web界面与之对战。缺点是您只需在您的机器上启动一个Python
    Web服务器。因此，其他人要测试您的机器人，他们必须直接访问您的计算机。通过在AWS上部署这个Web应用程序并打开必要的端口（就像您设置实例时做的那样），您可以通过共享一个URL来与他人分享您的机器人。'
- en: 'Running your HTTP frontend works the same way as before. All you need to do
    is the following:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 运行您的HTTP前端与之前的方式相同。您需要做的只是以下几步：
- en: '[PRE4]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'This hosts a playable demo of your bot on AWS and makes it available under
    the following address:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 这将在AWS上托管您机器人的可玩演示，并在以下地址下提供：
- en: '[PRE5]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: That’s it! In [appendix E](kindle_split_032.xhtml#app05), we’ll go one step
    further and show you how to use the AWS basics presented here to deploy a full-blown
    bot connecting to the Online Go Server (OGS) using the Go Text Protocol (GTP).
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 就这样！在[附录E](kindle_split_032.xhtml#app05)中，我们将进一步展示如何使用这里介绍的AWS基础知识来部署一个完整的机器人，该机器人通过Go文本协议（GTP）连接到在线围棋服务器（OGS）。
