- en: 12 Human-in-the-loop machine learning products
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 12 人机交互机器学习产品
- en: This chapter covers
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖
- en: Defining products for human-in-the-loop machine learning applications
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定义适用于人机交互机器学习应用的产品
- en: Creating a system for exploratory data analysis for short text
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个用于短文本探索性数据分析的系统
- en: Creating an information extraction system to support a human process
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个支持人工流程的信息提取系统
- en: Creating an image labeling system to maximize model accuracy
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个图像标注系统以最大化模型精度
- en: Evaluating options for extending simple systems
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评估扩展简单系统的选项
- en: This final chapter contains three worked examples of human-in-the-loop machine
    learning products. Using everything that you have learned in the first 11 chapters,
    you will implement three examples. You can think of these examples—one for exploratory
    data analysis of news headlines, one for extracting information about food safety
    from text, and one for labeling images containing bicycles—as being first-pass
    systems that you can create in a few days. The examples are similar to the human-in-the-loop
    machine learning system in chapter 2 but slightly more sophisticated, building
    on what you have learned in the chapters since.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 这最后一章包含了三个关于人机交互机器学习产品的实际案例。利用你在前11章中学到的所有知识，你将实现三个示例。你可以将这些示例视为探索性数据分析新闻标题、从文本中提取食品安全信息以及标注包含自行车的图像等作为可以在几天内创建的初步系统。这些示例与第2章中的人机交互机器学习系统类似，但稍微复杂一些，建立在你在后续章节中学到的知识之上。
- en: Like the example in chapter 2, these examples can be starting points for fully
    working systems that you are prototyping. In all cases, you could build out many
    components as the next potential step.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 与第2章中的示例一样，这些示例可以作为你正在原型化的完整工作系统的起点。在所有情况下，你都可以构建许多组件作为下一步的潜在步骤。
- en: 12.1 Defining products for human-in-the-loop machine learning applications
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.1 定义适用于人机交互机器学习应用的产品
- en: 'Good product management for human-in-the-loop machine learning applications
    starts with the problem that you are solving for someone: the actual daily task
    you are supporting. Understanding the human task that you are solving will help
    every aspect of your product design: interface, annotations, and machine learning
    architecture. This section gives you a quick introduction to some good product
    management techniques that we’ll use in this chapter, which will in turn help
    with technical design decisions.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 适用于人机交互机器学习应用的良好产品管理始于你为某人解决的问题：你实际支持的日常任务。理解你正在解决的人类任务将有助于你产品设计的各个方面：界面、标注和机器学习架构。本节为你快速介绍一些在本章中我们将使用的好产品管理技术，这将反过来帮助做出技术设计决策。
- en: 12.1.1 Start with the problem you are solving
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.1 从你正在解决的问题开始
- en: Good product design starts with defining the problem that you are trying to
    solve. It is a common mistake to start talking about a product in terms of the
    technology you are creating instead of the problem you are trying to solve. If
    you are creating autocomplete functionality for an email client, it is too easy
    to define the problem as “People want their sentences autocompleted in emails.”
    A better way to define the problem is “People want to communicate as efficiently
    as possible.” Starting by focusing on the problem you are solving helps with everything
    from creating guidelines for annotators to deciding which product features to
    build or extend next.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 优秀的产品设计始于定义你试图解决的问题。一个常见的错误是开始谈论产品时，从你正在创建的技术角度出发，而不是从你试图解决的问题出发。如果你正在为电子邮件客户端创建自动完成功能，将问题定义为“人们希望在电子邮件中自动完成句子”过于简单。更好的定义方法是“人们希望尽可能高效地沟通。”从关注你正在解决的问题开始，有助于从为标注者创建指南到决定接下来构建或扩展哪些产品功能等各个方面。
- en: It helps to be specific in the problem definition, too. If you are targeting
    marketing people for your email autocomplete product, you might say, “Marketers
    want to communicate with their potential customers as efficiently as possible.”
    If you are creating a consumer product, you might say, “People want to communicate
    with their friends and family as efficiently as possible.” This approach will
    help shape your assumptions when designing the product.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在问题定义上也要具体。如果你正在为电子邮件自动完成产品针对营销人员，你可能会说，“营销人员希望尽可能高效地与潜在客户沟通。”如果你正在创建一个消费产品，你可能会说，“人们希望尽可能高效地与朋友和家人沟通。”这种方法将有助于塑造你在设计产品时的假设。
- en: 'When you have defined the problem you are solving, you can break that general
    problem into specific tasks that people are trying to perform. For the email autocomplete
    product example, tasks could include “I want to double the amount of emails I
    send to potential customers each day” or “I want to clear my inbox by the end
    of each day without reducing the length of my email replies.” Those specific tasks
    can become some of the metrics for product success. With these product management
    guidelines in mind, here are the three problems that we are trying to solve as
    example human-in-the-loop machine learning systems in this chapter:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 当你定义了你正在解决的问题时，你可以将这个一般问题分解成人们试图执行的具体任务。以电子邮件自动完成产品为例，任务可能包括“我希望每天向潜在客户发送的电子邮件数量翻倍”或“我希望在每天结束时清空我的收件箱，同时不缩短我的电子邮件回复的长度。”这些具体任务可以成为产品成功的一些指标。考虑到这些产品管理指南，以下是我们在本章中作为示例人类在环机器学习系统试图解决的三个问题：
- en: Data analysts want to understand the distribution of information in their news
    headline data.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分析师希望了解其新闻标题数据中信息的分布。
- en: “I want to see how many news headlines are related to specific topics.”
  id: totrans-16
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想看看有多少新闻标题与特定主题相关。”
- en: “I want to track the changes in news headline topics over time.”
  id: totrans-17
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望跟踪新闻标题主题随时间的变化。”
- en: “I want to export all the news articles related to a certain topic for further
    analysis.”
  id: totrans-18
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望导出与特定主题相关的所有新闻文章以进行进一步分析。”
- en: Food safety professionals want to collect data about events in which pathogens
    or foreign objects have been detected in food.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 食品安全专业人员希望收集有关在食品中检测到病原体或异物的事件的数据。
- en: “I want to maintain a complete record of all recorded food safety events in
    the EU.”
  id: totrans-20
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望记录欧盟所有已记录的食品安全事件的完整记录。”
- en: “I want to track when different food safety events might have come from the
    same source.”
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望跟踪不同食品安全事件可能来自同一来源的时间。”
- en: “I want to send warnings to specific countries when there are likely to be food
    safety events that have not yet been detected or reported.”
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望在可能存在尚未检测或报告的食品安全事件时向特定国家发出警告。”
- en: Transportation researchers want to estimate the number of people who use bicycles
    on certain streets.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 交通研究人员希望估计在特定街道上使用自行车的乘客数量。
- en: “I want to collect information about how often people are cycling down a street.”
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望收集有关人们骑自行车下街频率的信息。”
- en: “I want to capture this information from thousands of cameras, and I don’t have
    the budget to do it manually.”
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望从数千个摄像头中捕捉这些信息，而我没有足够的预算手动完成。”
- en: “I want my model for bicycle identification to be as accurate as possible.”
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望我的自行车识别模型尽可能准确。”
- en: 12.1.2 Design systems to solve the problem
  id: totrans-27
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.2 设计系统以解决问题
- en: For the three use cases, we can start with the problem definitions and design
    a system that solves those problems. As in chapter 2, we will build a complete
    human-in-the-loop machine learning system for each example. Think of each of these
    examples as proof of concept (PoC) for systems that will be made more scalable
    and more robust later.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这三个用例，我们可以从问题定义开始，设计一个解决这些问题的系统。正如第2章所述，我们将为每个示例构建一个完整的人类在环机器学习系统。将这些示例视为未来将更具可扩展性和鲁棒性的系统的概念验证（PoC）。
- en: Quality control using interannotator agreement
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 使用注释者间一致性进行质量控制
- en: It is not easy to provide a good practical example of interannotator agreement
    in this chapter, because the examples here need to be stand-alone systems that
    a single person can work on, assuming that most people are reading this book solo.
    So this chapter covers most of what was important in the first 11 chapters of
    this book except interannotator agreement.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中提供关于注释者间一致性的良好实际例子并不容易，因为这里的例子需要是独立系统，一个人可以独立工作，假设大多数人都是单独阅读这本书。因此，本章涵盖了本书前11章中除注释者间一致性之外的大部分重要内容。
- en: To give you an example of interannotator agreement, I’ll follow this book with
    a free article about interannotator agreement that uses the example in chapter
    2\. That example includes annotating short text according to whether it was disaster-related,
    using the open-source code that I created for that chapter. The code for that
    chapter collects annotations that people make and (if they opted in) their identities,
    allowing us to compare annotations by different people.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 为了给你一个注释者间一致性的示例，我将在这本书后面附上一篇关于注释者间一致性的免费文章，该文章使用第2章中的示例。该示例包括根据是否与灾难相关对简短文本进行注释，使用我为该章节创建的开源代码。该章节的代码收集了人们所做的注释以及（如果他们选择）他们的身份，使我们能够比较不同人的注释。
- en: So although I can’t provide an example of interannotator agreement while writing
    this book, your own annotations will be contributing to an interannotator agreement
    study that will help people for years to come!
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我在撰写这本书时无法提供一个关于注释者间一致性的示例，但你的注释将有助于进行一项注释者间一致性研究，这项研究将帮助人们多年。
- en: Notice that two of our systems are similar in terms of the machine learning
    problem; one is labeling news headlines, and one is labeling images. But because
    they are supporting different use cases—exploratory data analysis and counting
    objects—the resulting systems will be different.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，我们的两个系统在机器学习问题上相似；一个是标记新闻标题，另一个是标记图像。但因为他们支持不同的用例——探索性数据分析和对物体计数——所以产生的系统将不同。
- en: The food safety example automates an existing human process, so maintaining
    the agency of the person doing this work is important. In particular, they should
    not feel that their work is being slowed now that it is needed to power a machine
    learning algorithm in addition to being part of their daily task. Model accuracy
    is least important in this case, because if the assisted text doesn’t work, the
    person can simply type the field value, which they are already doing. Table 12.1
    summarizes the factors that are most important in these systems.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 食品安全示例自动化了一个现有的人类流程，因此保持从事这项工作的人的自主性很重要。特别是，他们不应该感到，现在他们的工作除了是日常任务的一部分外，还需要为机器学习算法提供动力，而感到工作进度变慢。在这种情况下，模型准确性最不重要，因为如果辅助文本不起作用，人们可以简单地输入字段值，这正是他们已经在做的事情。表12.1总结了这些系统中最重要的因素。
- en: Table 12.1 Factors in the design of the three example systems and their relative
    importance. We are optimizing different factors in different systems based on
    how the systems are being used, and this information will influence our design
    decisions.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 表12.1 三种示例系统设计中的因素及其相对重要性。我们将根据系统的使用方式优化不同系统中的不同因素，这些信息将影响我们的设计决策。
- en: '| Example | Agency | Model accuracy | Annotation accuracy |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 示例 | 代理 | 模型准确性 | 注释准确性 |'
- en: '| Headlines | Medium | Medium | Low |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 标题 | 中等 | 中等 | 低 |'
- en: '| Food safety | High | Low | High |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 食品安全 | 高 | 低 | 高 |'
- en: '| Bicycle detection | Low | High | Medium |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 自行车检测 | 低 | 高 | 中等 |'
- en: In all three cases, some components can be substituted for more sophisticated
    components—more active learning sampling methods, more complicated machine learning
    models, more efficient interfaces, and so on. As you interact with all three examples,
    think about the most useful next step in each case. Based on the goal of the system,
    the data, and the task itself, you may have different ideas about what component
    to expand or add next for each use case.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在所有三种情况下，一些组件可以被更复杂的组件所替代——更活跃的学习采样方法、更复杂的机器学习模型、更高效的界面等等。当你与这三个示例互动时，思考每个案例中最有用的下一步。根据系统的目标、数据和任务本身，你可能会对每个用例中要扩展或添加的组件有不同的想法。
- en: 12.1.3 Connecting Python and HTML
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.1.3 连接Python和HTML
- en: We’ll build web interfaces for the examples, so we’ll need to connect Python
    with HTML/JavaScript. We will use a Python library called eel that allows us to
    build local HTML interfaces for Python applications. Many libraries are available
    for connecting Python to HTML. If you are familiar with another library—flask,
    kivy, pyqt, tkinter, or some other library/framework for HTML application or Python
    APIs that can connect easily with HTML applications—that library might be a better
    choice for you to create a prototype.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将为这些示例构建网络界面，因此我们需要将Python与HTML/JavaScript连接起来。我们将使用一个名为eel的Python库，它允许我们为Python应用程序构建本地HTML界面。有许多库可用于将Python连接到HTML。如果你熟悉另一个库——flask、kivy、pyqt、tkinter或任何其他可以轻松与HTML应用程序连接的库/框架，那么这个库可能更适合你创建原型。
- en: 'We use eel here because it is lightweight and requires little knowledge of
    JavaScript. If you have not coded in JavaScript but know Python and HTML, you
    should still be able to follow all the examples in this chapter. We will use eel
    in a way that puts most of the work in Python for the same reason: this chapter
    assumes that you are more familiar with Python. If you are more familiar with
    JavaScript, you can think about which components in this chapter could be implemented
    in JavaScript.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里使用 eel，因为它轻量级且对 JavaScript 的了解要求很少。如果你没有编写过 JavaScript 但知道 Python 和 HTML，你应该仍然能够跟随本章中的所有示例。我们将使用
    eel 的方式将大部分工作放在 Python 中，原因相同：本章假设你更熟悉 Python。如果你更熟悉 JavaScript，你可以考虑本章中哪些组件可以用
    JavaScript 实现。
- en: 'In each example in this chapter, we’ll have three files with code: one for
    Python (.py), one for JavaScript (.js), and one for the HTML (.html). This format
    keeps things simple for teaching purposes. Your actual distribution of code should
    reflect your organization’s best practices. You can install eel via pip:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的每个示例中，我们将有三个包含代码的文件：一个用于 Python (.py)，一个用于 JavaScript (.js)，一个用于 HTML (.html)。这种格式在教学目的上使事情保持简单。你的实际代码分布应该反映你组织的最佳实践。你可以通过
    pip 安装 eel：
- en: '[PRE0]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You can import eel and expose any Python function to the JavaScript in your
    HTML file with the command `@eel.expose` before the function:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用命令 `@eel.expose` 在函数之前导入 eel 并将任何 Python 函数暴露给 HTML 文件中的 JavaScript：
- en: '[PRE1]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'This code allows you to call this `hello` function from within your JavaScript:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 此代码允许你在 JavaScript 中调用此 `hello` 函数：
- en: '[PRE2]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'If you call the JavaScript function `hello("World")`, it will print `"Hello
    World"` to the JavaScript console because the Python function prepends `"Hello"`.
    Two more lines of code in your Python file ensure that your Python script can
    talk to your HTML file with the JavaScript:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你调用 JavaScript 函数 `hello("World")`，它将在 JavaScript 控制台中打印 `"Hello World"`，因为
    Python 函数在前面添加了 `"Hello"`。在你的 Python 文件中的两行额外代码确保你的 Python 脚本可以使用 JavaScript 与你的
    HTML 文件通信：
- en: '[PRE3]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In the preceding code snippet, we assume that our HTML file is called helloworld.html
    and that it is in the same directory as the Python file—hence, the local path
    `init('./')`. The `start``()` call will open a browser window to launch your application,
    so you typically want this call at the end of your Python script.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的代码片段中，我们假设我们的 HTML 文件名为 helloworld.html，并且它与 Python 文件位于同一目录中——因此，本地路径 `init('./')`。`start()`
    调用将打开一个浏览器窗口以启动你的应用程序，所以你通常希望这个调用在 Python 脚本的末尾。
- en: Note that although we have named the functions `hello``()` in both Python and
    JavaScript, there is no requirement for this naming convention, because your JavaScript
    can call any exposed function in Python by name. We follow the convention of using
    the same function names throughout this chapter to make the code more readable.
    Similarly, we’ll use the same name for our Python, JavaScript, and HTML files
    in each example to keep things simple, changing only the extensions, even though
    there’s no file naming requirement in eel.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，尽管我们在 Python 和 JavaScript 中都命名为 `hello()` 的函数，但这并不是一个强制性的命名约定，因为你的 JavaScript
    可以通过名称调用 Python 中暴露的任何函数。我们遵循在整个章节中使用相同函数名的约定，以便使代码更易于阅读。同样，在每个示例中，我们将使用相同的名称为我们的
    Python、JavaScript 和 HTML 文件，以保持事情简单，只更改扩展名，尽管在 eel 中没有文件命名要求。
- en: The only additional change in regular Python code is that we need to use eel
    for thread management, which is a side effect of how the library interacts with
    HTML. So we’ll use `eel.spawn(some_function_``())` to call `some_function``()`
    as a new Python thread and use `eel.sleep``()` instead of Python’s built-in `sleep()`
    function. These functions perform the same way as the built-in threading and sleep
    functions with which you may be familiar. We’re not going to use threading in
    complicated ways, but for all three examples, we’ll have one thread interacting
    with the HTML interface while a separate thread retrains the model.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在常规 Python 代码中，唯一的额外更改是我们需要使用 eel 进行线程管理，这是库与 HTML 交互的副作用。因此，我们将使用 `eel.spawn(some_function_())`
    来调用 `some_function()` 作为一个新的 Python 线程，并使用 `eel.sleep()` 而不是 Python 内置的 `sleep()`
    函数。这些函数的表现方式与您可能熟悉的内置线程和睡眠函数相同。我们不会以复杂的方式使用线程，但在所有三个示例中，我们将有一个线程与 HTML 界面交互，而另一个线程重新训练模型。
- en: The eel library supports more than the demos here. It also allows you to call
    the JavaScript functions from within Python, for example. We’ll keep our architectures
    simple and have all operations triggered by the user.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: eel库支持的功能不仅限于这里提供的演示。它还允许你从Python内部调用JavaScript函数，例如。我们将保持我们的架构简单，并让所有操作由用户触发。
- en: '12.2 Example 1: Exploratory data analysis for news headlines'
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.2 示例 1：新闻标题的探索性数据分析
- en: 'Exploratory data analysis (EDA) is one of the most common use cases for quickly
    developed machine learning systems. Relatively little research on EDA has been
    cited in the machine learning literature, however, because it does not focus on
    machine learning accuracy. In industry, data scientists usually want to understand
    their data in more detail before deciding what models and products to build. EDA
    in this case allows a data scientist to browse and filter data quickly. For the
    specific EDA example that we’re covering in this section, here is our problem
    statement and three specific problems that are being solved:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 探索性数据分析（EDA）是快速开发的机器学习系统中最常见的用例之一。然而，由于它不关注机器学习准确性，因此在机器学习文献中引用的EDA研究相对较少。在工业界，数据科学家通常在决定要构建哪些模型和产品之前，想要更详细地了解他们的数据。在这种情况下，EDA允许数据科学家快速浏览和筛选数据。在本节中，我们将讨论的特定EDA示例中，以下是我们的问题陈述和三个正在解决的问题：
- en: Data analysts want to understand the distribution of information in their news
    headline data.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分析师想要了解他们新闻标题数据中信息的分布。
- en: “I want to see how many news headlines are related to specific topics.”
  id: totrans-59
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想看看有多少新闻标题与特定主题相关。”
- en: “I want to track the changes in news topic over time.”
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想跟踪新闻主题随时间的变化。”
- en: “I want to export all the news articles related to a certain topic for further
    analysis.”
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想导出与某个特定主题相关的所有新闻文章以进行进一步分析。”
- en: 12.2.1 Assumptions
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.1 假设
- en: Our assumptions for designing this product are
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们设计这个产品的假设是
- en: The headlines are only in English.
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标题只使用英语。
- en: Pretrained language models will help.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预训练语言模型将有所帮助。
- en: The analyst will have some idea of good keywords to bootstrap.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分析师将有一些关于良好关键词的启动想法。
- en: How does your data determine your architecture decisions?
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 你的数据是如何决定你的架构决策的？
- en: The data itself can influence your decision about every part of the architecture.
    We are using the DistilBERT pretrained model, which is trained on English-only
    data from Wikipedia and a collection of public-domain books. Wikipedia includes
    titles that are similar to news headlines and includes some headlines of actual
    news articles. Therefore, this pretrained model is appropriate for our task.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 数据本身可以影响你对架构每个部分的决策。我们正在使用DistilBERT预训练模型，该模型是在维基百科和一系列公共领域书籍的英文数据上训练的。维基百科包括与新闻标题相似的文章标题，还包括一些实际新闻文章的标题。因此，这个预训练模型适合我们的任务。
- en: That decision could change with slightly different data, however. While I was
    writing this book, an organization I was helping, Turn.io, wanted to conduct exploratory
    data analysis on short messages sent to WHO’s COVID-19 information service. These
    messages are in many languages, and the style of writing for direct messages is
    different from the kind of web data on which most pretrained models are built.
    In that case, it was more appropriate to use a multilingual model built on more
    domains of data, such as XLM-R, even though that model requires more processing
    time than DistilBERT does.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这个决定可能会因数据略有不同而改变。在我写这本书的时候，我帮助的一个组织Turn.io想要对世界卫生组织COVID-19信息服务收到的短信进行探索性数据分析。这些短信使用多种语言，直接消息的写作风格与大多数预训练模型构建的网页数据不同。在这种情况下，使用基于更多数据域的多语言模型（如XLM-R）更为合适，尽管这个模型比DistilBERT需要更多的处理时间。
- en: With this in mind, don’t take anything in this chapter as being necessarily
    the best first step for a problem that you are working on. Even a similar task
    might be better built with different architectures and different pretrained models.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到这一点，不要将本章中的任何内容视为你正在处理的问题的必要第一步。即使是类似的任务，也可能需要不同的架构和不同的预训练模型来构建。
- en: 'Important considerations:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 重要考虑事项：
- en: '*Agency*—The analyst using the system should be empowered to browse the data
    by keyword and by year.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*机构*——使用该系统的分析师应该有权通过关键词和年份浏览数据。'
- en: '*Transparency*—The accuracy of the system should be clear across the entire
    dataset and also by year.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*透明度*——系统的准确性应该在整个数据集和按年份清晰可见。'
- en: '*Dense/rich layout*—The analyst should be able to get as much information as
    possible on the screen, so the layout should be information-dense.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*密集/丰富布局*—分析师应该能够在屏幕上获取尽可能多的信息，因此布局应该是信息密集的。'
- en: '*Immediacy*—The interface should be immediately useful for helping the analyst
    understand the data, so the creation of evaluation data should be in parallel
    with the creation of training data.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*即时性*—界面应该立即对分析师理解数据有所帮助，因此评估数据的创建应与训练数据的创建并行进行。'
- en: '*Stratification*—The analyst is interested in per-year accuracy, so we want
    to track accuracy per year in addition to overall.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*分层*—分析师对每年的准确性感兴趣，因此我们除了跟踪整体准确性外，还想跟踪每年的准确性。'
- en: '*Flexibility*—The analyst may want to look at different labels at different
    times.'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*灵活性*—分析师可能希望在不同的时间查看不同的标签。'
- en: '*Extensibility*—The analyst may want to turn this task into a larger-scale
    task later, so they want to track interesting examples of headlines to add to
    future guidelines.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*可扩展性*—分析师可能希望在以后将此任务扩展成更大规模的任务，因此他们希望跟踪有趣的标题示例，以便添加到未来的指南中。'
- en: 12.2.2 Design and implementation
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.2 设计与实现
- en: This task is a binary labeling task, so the choice of uncertainty sampling algorithm
    doesn’t matter. We’ll use least confidence, and we’ll use stratified sampling
    for real-world diversity to target headlines from specific years. We’ll allow
    the analyst to use keywords to filter the data being annotated.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这个任务是一个二进制标签任务，因此不确定性采样算法的选择并不重要。我们将使用最小置信度，并使用分层抽样以实现现实世界的多样性，针对特定年份的新闻标题。我们将允许分析师使用关键词来过滤正在标注的数据。
- en: For annotation, we’ll allow the annotator to make a quick binary choice for
    each headline to optimize for speed. We won’t include items sampled by keywords
    in the evaluation data, as they won’t create a balanced sample.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 对于标注，我们将允许标注者对每个标题快速做出二进制选择以优化速度。我们不会将关键词抽取的项目包括在评估数据中，因为它们不会创建一个平衡的样本。
- en: We’ll use two machine learning models. One model incrementally updates with
    each new annotation, increasing the agency of the analyst by allowing them to
    see the results of their annotations immediately on the model and resulting predictions.
    Incremental models, however, are known to have recency biases and to converge
    on local optimums. The recency bias can be amplified in active learning scenarios
    because the most recent items are not randomly sampled, especially if they are
    sampled by keywords. So a second model will be retrained from scratch across all
    the training data at regular intervals. This model will replace the first model
    when it is more accurate on the held-out data.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用两个机器学习模型。一个模型会随着每个新标注的增量更新，通过允许分析师立即在模型和结果预测上看到他们标注的结果，从而增加分析师的权限。然而，增量模型已知存在近期偏差，并且会收敛到局部最优。在主动学习场景中，近期偏差可能会被放大，因为最新项目不是随机抽取的，尤其是如果它们是通过关键词抽取的。因此，第二个模型将在定期的时间间隔内从所有训练数据从头开始重新训练。当这个模型在保留数据上更准确时，它将替换第一个模型。
- en: For both machine learning models, we will adapt the model from the DistillBERT
    pretrained model. DistillBERT is much smaller than BERT but has comparable accuracy.
    We assume that the faster processing and smaller memory footprint will be net
    positive even with the small loss in accuracy. This architecture is shown in figure
    12.1.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 对于两个机器学习模型，我们将从DistillBERT预训练模型中调整模型。DistillBERT比BERT小得多，但具有可比的准确性。我们假设，即使准确性有所损失，更快的处理速度和更小的内存占用也将是净正面效果。此架构如图12.1所示。
- en: '![](../Images/CH12_F01_Munro.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/CH12_F01_Munro.png)'
- en: Figure 12.1 Architecture for the example system to classify news headlines
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.1 示例系统的新闻标题分类架构
- en: Figure 12.1 is almost identical to the architectures throughout this book but
    has two models that we can optimize for real-time training in addition to training
    that aims to maximize accuracy. You can see the code at [https://github.com/rmunro/headlines](https://github.com/rmunro/headlines).
    See the readme file in the repository for more information about the details of
    the implementation and how to experiment with it.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.1 几乎与本书中的所有架构相同，但它有两个模型，我们可以针对实时训练进行优化，除了旨在最大化准确性的训练。您可以在[https://github.com/rmunro/headlines](https://github.com/rmunro/headlines)中看到代码。有关实现细节和如何进行实验的更多信息，请参阅存储库中的readme文件。
- en: 12.2.3 Potential extensions
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.2.3 可能的扩展
- en: After playing around with the system for a little while, think about what kind
    of changes you might make. Table 12.2 offers examples of potential improvements.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在与系统玩了一段时间后，思考你可能做出的改变。表 12.2 提供了潜在改进的示例。
- en: Every example in table 12.2 could be implemented in fewer than 50 lines of code,
    so there are few barriers to implementing one or two of them. But it would be
    a lot of work to implement all the changes and evaluate which were the most effective.
    So interacting with the system should give you an idea of the most valuable addition
    to make first. This example has an element of machine learning assisting a human,
    which is something that we will double down on in the next example.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 表 12.2 中的每个示例都可以用少于 50 行代码实现，因此实现其中之一或两个几乎没有障碍。但实现所有更改并评估哪些是最有效的将是一项大量工作。因此，与系统交互应该能让你了解首先应添加的最有价值的改进。本例中有一个机器学习辅助人类的元素，这是我们将在下一个示例中加倍投入的。
- en: Table 12.2 Potential extensions to the example and the sections in which they
    are covered in this book
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 表 12.2 本例及其在本书中涵盖的章节中可能的扩展
- en: '| Annotation interface |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| 标注界面 |'
- en: '| Batch annotation(section 11.2.1) | Accepting or rejecting multiple annotations
    at the same time. The set of messages that are already grouped per-year could
    be a good place to start. |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| 批量标注（第 11.2.1 节） | 同时接受或拒绝多个标注。按年度已分组的消息集可能是一个良好的起点。|'
- en: '| More powerful filtering(section 9.5) | The manual filtering is for string
    matching, which could be made more sophisticated to allow regular expression matching
    or combinations of multiple keywords. |'
  id: totrans-93
  prefs: []
  type: TYPE_TB
  zh: '| 更强大的过滤（第 9.5 节） | 手动过滤用于字符串匹配，这可以变得更加复杂，以允许正则表达式匹配或多个关键词的组合。|'
- en: '| Annotation quality control |'
  id: totrans-94
  prefs: []
  type: TYPE_TB
  zh: '| 标注质量控制 |'
- en: '| Using the model as an annotator(section 9.3) | Cross-validate the training
    data to find disagreements between the predicted and the actual annotations as
    potential annotation errors to show the analyst. |'
  id: totrans-95
  prefs: []
  type: TYPE_TB
  zh: '| 将模型用作标注者（第 9.3 节） | 对训练数据进行交叉验证，以找到预测标注与实际标注之间的不一致性，作为潜在的标注错误向分析师展示。|'
- en: '| Annotation aggregation(sections 8.1–8.3) | If multiple people were using
    this, strategize about the ground truth and interannotator agreement methods to
    aggregate that data. You might split the strategy, updating the model incrementally
    for every annotation in real time, but batch-retraining only with items that have
    been annotated multiple times and are confidently labeled. |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '| 标注聚合（第 8.1-8.3 节） | 如果多个人使用此系统，关于真实性和标注者间一致性方法以聚合数据的策略进行规划。你可能将策略拆分，实时为每个标注更新模型，但仅对已多次标注且标记有信心的事项进行批量重新训练。|'
- en: '| Machine learning architecture |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '| 机器学习架构 |'
- en: '| Self-supervised learning(section 9.4) | Use metadata such as the year or
    the subdomain of the URL as labels, and build a model over the entire dataset
    to predict those labels, which in turn can be used as a representation in this
    model. |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '| 自监督学习（第 9.4 节） | 使用元数据，如年份或 URL 的子域作为标签，并在整个数据集上构建模型以预测这些标签，这些标签反过来可以用作此模型中的表示。|'
- en: '| Tune the model to the unlabeled data | Tune DistillBERT to the entire dataset
    of headlines first. This approach adapts the pretrained model to this specific
    domain of text and will likely lead to more accurate results faster. |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '| 调整模型以适应未标记数据 | 首先将 DistillBERT 调整到整个标题数据集。这种方法将预训练模型适应此特定文本领域，并可能导致更快地获得更准确的结果。|'
- en: '| Active learning |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| 活跃学习 |'
- en: '| Ensemble-based sampling(section 3.4) | Maintain multiple models and track
    the uncertainty of a prediction across all the models, sampling items with the
    highest average uncertainty and/or the highest variation in predictions. |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '| 基于集成采样（第 3.4 节） | 维护多个模型，并跟踪所有模型中预测的不确定性，采样具有最高平均不确定性或预测最高变异性的事项。|'
- en: '| Diversity sampling(sections 4.2–4.4) | Explore clustering and model-based
    outliers to ensure that there aren’t parts of the features space that are being
    oversampled or ignored entirely. |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| 多样性采样（第 4.2-4.4 节） | 探索聚类和基于模型的异常值，以确保特征空间中没有部分被过度采样或完全忽略。|'
- en: '12.3 Example 2: Collecting data about food safety events'
  id: totrans-103
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.3 示例 2：收集关于食品安全事件的数据
- en: 'Many people’s daily jobs consist of constructing structured data from unstructured
    data. These workers include marketing professionals looking for the sentiments
    that consumers have expressed about certain aspects of a product, whether online
    or in reviews; health care professionals extracting important information from
    written electronic medical records; and food safety professionals in our example.
    Here is the problem statement and three specific problems that are being solved:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 许多人日常工作的内容是从非结构化数据中构建结构化数据。这些工作者包括寻找消费者对产品某些方面表达的情感的市场专业人士，无论在线还是评论中；从书面电子病历中提取重要信息的医疗保健专业人士；以及我们例子中的食品安全专业人士。以下是问题陈述和正在解决的三个具体问题：
- en: Food safety professionals want to collect data about events in which pathogens
    or foreign objects have been detected in food.
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 食品安全专业人士希望收集有关在食品中检测到病原体或异物的事件的数据。
- en: “I want to maintain a complete record of all recorded food safety events in
    the EU.”
  id: totrans-106
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想维护欧盟所有记录的食品安全事件的完整记录。”
- en: “I want to track when different food safety events might have come from the
    same source.”
  id: totrans-107
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想跟踪不同食品安全事件可能来自同一来源的时间。”
- en: “I want to send warnings to specific countries when there are likely to be food
    safety events that have not yet been detected or reported.”
  id: totrans-108
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “当可能存在尚未被发现或报告的食品安全事件时，我想向特定国家发送警告。”
- en: 12.3.1 Assumptions
  id: totrans-109
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.1 假设
- en: 'Our assumptions for designing this product are:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 我们设计此产品的假设是：
- en: The reports are only in English.
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告仅提供英文版本。
- en: Pretrained language models will help.
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预训练语言模型将有所帮助。
- en: The food safety expert has the domain expertise needed to extract the information.
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 食品安全专家拥有提取所需信息的领域专业知识。
- en: The food safety expert is already performing this task as part of their job.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 食品安全专家已经在他们的工作中执行这项任务。
- en: 'Important considerations:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 重要考虑因素：
- en: '*Agency*—The food safety expert does not want their work processes to be slowed
    by machine learning integration.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*代理*—食品安全专家不希望他们的工作流程因机器学习集成而减慢。'
- en: '*Transparency*—The food safety expert should be able to understand how many
    reports remain, assuming that they want to see every one.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*透明度*—食品安全专家应该能够理解在假设他们想查看每一份报告的情况下，还有多少报告尚未查看。'
- en: '*Consistency and compactness*—The food safety expert should not have to scroll,
    use a mouse, or lose track of elements on the screen.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*一致性和紧凑性*—食品安全专家不应该需要滚动、使用鼠标或失去屏幕上元素的控制。'
- en: '*Ability to track trends*—The analyst is interested in per-country trends,
    so we want to track how the information extracted shows trends in movement between
    countries.'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*追踪趋势的能力*—分析师对各国趋势感兴趣，因此我们希望跟踪提取的信息如何显示国家间移动的趋势。'
- en: 12.3.2 Design and implementation
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.2 设计与实现
- en: For active learning, we assume that confusion between two labels is as bad an
    experience as confusion across all the labels, so we’ll use ratio of confidence
    for uncertainty. The uncertainty score will be used as a threshold to decide whether
    to display the autocomplete suggestions from the model.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 对于主动学习，我们假设两个标签之间的混淆与所有标签之间的混淆一样糟糕，因此我们将使用置信度比率来表示不确定性。不确定性分数将用作阈值，以决定是否显示模型提供的自动完成建议。
- en: For annotation, if there are no predictions from the model, the interface will
    use autocomplete suggestions taken from all matching strings of text in the current
    report. Using the matching strings of text will provide a similar user experience
    to using the predictive labels for autocomplete even when there are no model predictions.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 对于注释，如果没有来自模型的预测，界面将使用从当前报告中所有匹配的文本字符串中获取的自动完成建议。使用匹配的文本字符串将提供与使用预测标签进行自动完成相似的用户体验，即使没有模型预测也是如此。
- en: We’ll use one machine learning model adapted from the DistillBERT pretrained
    model, which is retrained on a regular basis. We could use two models, as in the
    first example in this chapter, in which one model was incrementally updated. Incremental
    updates are not as important here, however, because the back-off behavior of matching
    existing strings is already a good user experience for the food safety professional,
    so we can keep the architecture as simple as possible and consider this extension
    after we have a working prototype. This architecture is shown in figure 12.2.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用一个从DistillBERT预训练模型改编的机器学习模型，该模型定期重新训练。我们可以使用两个模型，就像本章第一个例子中那样，其中一个模型是增量更新的。然而，在这里，增量更新并不那么重要，因为匹配现有字符串的回退行为对于食品安全专业人士来说已经是一个很好的用户体验，因此我们可以尽可能保持架构简单，并在我们有一个工作原型后再考虑这个扩展。该架构如图12.2所示。
    |
- en: '![](../Images/CH12_F02_Munro.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH12_F02_Munro.png) |'
- en: Figure 12.2 Architecture for the example system to extract information about
    food safety events from text
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.2 从文本中提取食品安全事件信息的示例系统架构 |
- en: Notice that figure 12.2 has annotation within the stream of information, which
    makes more sense for a machine-learning assisted task. Otherwise, the loop is
    the same, with that data powering a model that in turn helps the annotation. You
    can see the code at [https://github.com/rmunro/food_safety](https://github.com/rmunro/food_safety).
    See the readme file in the repository for more information about the details of
    the implementation and how to experiment with it.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，图12.2在信息流中包含注释，这对于机器学习辅助任务来说更有意义。否则，循环是相同的，数据驱动一个模型，反过来又帮助注释。您可以在[https://github.com/rmunro/food_safety](https://github.com/rmunro/food_safety)中查看代码。在存储库中的readme文件中可以找到有关实现细节和如何进行实验的更多信息。
    |
- en: 12.3.3 Potential extensions
  id: totrans-127
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.3.3 可能的扩展 |
- en: After playing with the implementation for a little while, think about what kind
    of changes you might make to make the system more efficient. Some possible extensions
    are summarized in table 12.3.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在玩了一段时间的实现之后，考虑一下您可能做出哪些改变以使系统更高效。一些可能的扩展总结在表12.3中。 |
- en: As with our previous example, all the changes in table 12.3 could be implemented
    in fewer than 50 lines of code. Any change could be the right next step based
    on experience with the system.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们之前的例子一样，表12.3中的所有更改都可以用不到50行代码实现。任何更改都可以根据对系统的经验成为正确的下一步。 |
- en: Table 12.3 Potential extensions to the example and the chapters/sections in
    which they are covered in this book
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 表12.3 本例及本书中涵盖的章节/节中可能的扩展 |
- en: '| Annotation interface |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| 注释界面 |'
- en: '| Predictive annotations(section 11.5.4) | Prepopulate the fields with the
    predictions when the model is confident in that prediction. That approach will
    speed annotation but can lead to more errors if the experts are primed to accept
    wrong predictions. |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| 预测性注释（第11.5.4节） | 当模型对预测有信心时，预先填充字段。这种方法将加快注释速度，但如果专家被诱导接受错误的预测，可能会导致更多错误。
    |'
- en: '| Adjudication(sections 8.4 and 11.5.4) | Create a separate interface that
    allows the expert to quickly adjudicate examples that have high value to the model.
    This approach should be implemented as an optional additional strategy for the
    expert, not replacing their daily workflow. |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| 裁决（第8.4节和第11.5.4节） | 创建一个单独的界面，允许专家快速裁决对模型具有高价值的事例。这种方法应作为专家可选的附加策略实现，而不是取代他们的日常工作流程。
    |'
- en: '| Annotation quality control |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| 注释质量控制 |'
- en: '| Intra-annotator agreement(section 8.2) | Domain experts often underestimate
    their own consistency, so it might help to give annotator the same task at different
    times to measure consistency. |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| 注释者间一致性（第8.2节） | 领域专家往往低估了自己的一致性，因此可能有助于让注释者在不同时间执行相同的任务来衡量一致性。 |'
- en: '| Predicting errors(section 9.2.3) | Build a model to explicitly predict where
    the expert is most likely to make errors, based on ground truth data, inter-/intra-annotator
    agreement, and/or the amount of time spent on each report (assuming that more
    time is spent on more complicated tasks). Use this model to flag where errors
    might occur, and ask the expert to pay more attention and/or give those items
    to more people. |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| 预测错误（第9.2.3节） | 基于真实数据、注释者间/内一致性以及每个报告所花费的时间量（假设花费更多时间在更复杂的任务上）来构建一个模型，以明确预测专家最有可能犯错误的地方。使用此模型标记可能发生错误的地方，并要求专家更加注意，或让更多人处理这些项目。
    |'
- en: '| Machine learning architecture |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 机器学习架构 |'
- en: '| Synthetic negative examples(section 9.7) | This dataset comes from templated
    text that is only about food safety events. This approach will make the model
    brittle when the text is not about food safety events, like predicting that any
    word following detected is a pathogen. By asking the experts to make the minimal
    edits to create negative examples with existing contexts such as detected, the
    model is less likely to learn the context erroneously. |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| 合成负例（第9.7节） | 这个数据集来自仅关于食品安全事件的模板化文本。这种方法会使模型在文本不是关于食品安全事件时变得脆弱，例如预测任何跟在检测词后面的词都是病原体。通过要求专家对现有上下文（如检测）进行最小编辑以创建负例，模型不太可能错误地学习上下文。|'
- en: '| Intermediate task training(section 9.4) | If we can create a separate document-labeling
    model to predict “relevant” and “not relevant,” we could use that model as a representation
    in the main model. If the expert already has a first step where they filter out
    the relevant from irrelevant reports, that filtering step can become a predictive
    model in itself. It is likely that such a model will converge on features of detection
    events such as pathogens and locations, thereby improving overall accuracy. |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| 中间任务训练（第9.4节） | 如果我们可以创建一个单独的文档标注模型来预测“相关”和“不相关”，我们就可以将这个模型作为主模型中的表示。如果专家已经有一个第一步，即从相关报告中过滤出不相关报告，那么这个过滤步骤本身就可以成为一个预测模型。这样的模型可能会收敛到检测事件的特征，如病原体和位置，从而提高整体准确性。|'
- en: '| Active learning |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 活跃学习 |'
- en: '| Reordering based on uncertainty(sections 3.2–3.4) | The system orders by
    date today. But if the most uncertain items are ordered first instead, that could
    improve the machine learning model faster and lead to greater speed overall. This
    order will be an additional change to the current practice of the expert, however,
    and is likely to feel slower initially as they tackle harder examples. |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| 基于不确定性的重新排序（第3.2-3.4节） | 系统目前是按日期排序。但如果首先对最不确定的项目进行排序，这可能会更快地提高机器学习模型，并导致整体速度更快。然而，这种排序将是对当前专家实践的一种额外改变，并且在他们处理更难示例时可能会感觉初始速度较慢。|'
- en: '| Other uncertainty metrics(section 3.2) | We use ratio of confidence as the
    basis for our confidence threshold because it seems to be the best fit for this
    problem. We can test empirically whether ratio of confidence is the best uncertainty
    sampling algorithm for this data. |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 其他不确定性度量（第3.2节） | 我们使用置信度比作为置信阈值的基础，因为它似乎是最适合这个问题的。我们可以通过实验来检验置信度比是否是这种数据中最好的不确定性采样算法。|'
- en: '12.4 Example 3: Identifying bicycles in images'
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.4 示例3：在图像中识别自行车
- en: 'Whether it’s traffic management, monitoring production lines, or counting items
    on shelves, counting the number of objects in an image is one of the most common
    use cases in computer vision. In this case, we are assuming that the use case
    is transportation researchers who want to estimate the number of people who use
    bicycles on certain streets. Here is the problem statement and three specific
    problems that are being solved:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 不论是交通管理、监控生产线还是计数货架上的商品，在计算机视觉中，计算图像中物体的数量是最常见的用例之一。在这种情况下，我们假设用例是交通研究人员，他们希望估计某些街道上使用自行车的数量。以下是问题陈述和正在解决的三个具体问题：
- en: Transportation researchers want to estimate the number of people who use bicycles
    on certain streets.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 交通研究人员希望估计某些街道上使用自行车的数量。
- en: “I want to collect information about how often people are cycling down a street.”
  id: totrans-146
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想收集有关人们骑自行车下街的频率的信息。”
- en: “I want to capture this information from thousands of cameras, and I don’t have
    the budget to do it manually.”
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我想从数千个摄像头中捕捉这些信息，但我没有预算手动完成。”
- en: “I want my model for bicycle identification to be as accurate as possible.”
  id: totrans-148
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: “我希望我的自行车识别模型尽可能准确。”
- en: “Bicycle” is not one of the 1,000 most common labels in ImageNet, the most popular
    image classification dataset, so this task is plugging a gap in commonly available
    models (although “Tandems” and “Mountain Bikes” are in ImageNet). Bicycles are
    an interesting problem because they are easily identifiable by a human but at
    different angles will have different feature profiles for a machine learning algorithm.
    Self-indulgently, I cycle everywhere, so I want this technology to be as accurate
    as possible. You could adapt this task to some other label, too.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: “自行车”并不是ImageNet（最受欢迎的图像分类数据集）中最常见的1000个标签之一，因此这项任务是在常见模型中填补了一个空白（尽管“双人自行车”和“山地自行车”在ImageNet中）。自行车是一个有趣的问题，因为它们很容易被人类识别，但不同的角度对于机器学习算法来说会有不同的特征轮廓。我自恋地认为我到处骑自行车，所以我想让这项技术尽可能准确。你也可以将这个任务适应到其他标签上。
- en: 12.4.1 Assumptions
  id: totrans-150
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.4.1 假设
- en: 'Our assumptions for designing this product are:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 我们设计这个产品的假设是：
- en: The images can be taken from any angle.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图片可以从任何角度拍摄。
- en: Existing datasets (such as ImageNet, Open Images, and MS COCO) may be useful
    but might not have coverage of all possible angles and settings for photographs.
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现有的数据集（如ImageNet、Open Images和MS COCO）可能很有用，但可能没有涵盖所有可能的拍摄角度和设置。
- en: Accuracy of the model is the most important outcome.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型的精度是最重要的结果。
- en: 'Important considerations:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 重要考虑因素：
- en: '*Agency*—The transportation researcher does not care about agency in the annotation
    process; they simply want to build the most accurate and robust model as quickly
    as possible.'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*代理*—在注释过程中，交通研究人员不关心代理；他们只想尽快构建最准确、最健壮的模型。'
- en: '*Transparency*—Real-time monitoring of the system’s accuracy is the most important
    metric.'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*透明度*—实时监控系统精度是最重要的指标。'
- en: '*Diversity*—The transportation researcher wants the model to work equally well
    (to the extent possible) in different lighting conditions, at different angles,
    and at different distances from the objects.'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*多样性*—交通研究人员希望模型在不同光照条件、不同角度和不同距离处对物体都能同样有效（尽可能做到）。'
- en: 12.4.2 Design and implementation
  id: totrans-159
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.4.2 设计与实现
- en: We’ll use a machine learning model that relies on two pretrained models built
    on the ImageNet and COCO datasets, two well-known datasets that have images related
    to bicycles and so will give us a head start on creating an accurate model.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用一个依赖于两个基于ImageNet和COCO数据集构建的预训练模型的机器学习模型，这两个数据集都是与自行车相关的知名数据集，这将为我们创建一个准确模型提供一个先发优势。
- en: For active learning, the task is a binary classification task, like the first
    example. The choice of uncertainty sampling algorithm doesn’t matter, so we’ll
    use least confidence. We’ll look for corner cases with model-based outliers in
    which we might have confident predictions but lack strong evidence for that confidence.
    For annotation, we’ll allow the annotator to make a binary choice for each image
    quickly to optimize for speed. This architecture is shown in figure 12.3.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 对于主动学习，任务是一个二元分类任务，就像第一个例子一样。不确定性采样算法的选择并不重要，所以我们将使用最小置信度。我们将寻找基于模型的异常值在角落案例中，我们可能对预测有信心，但缺乏支持这种信心的强有力证据。对于注释，我们将允许注释者快速对每张图像进行二元选择以优化速度。这种架构在图12.3中显示。
- en: '![](../Images/CH12_F03_Munro.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/CH12_F03_Munro.png)'
- en: Figure 12.3 Architecture for the example system to label bicycles
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 图12.3示例系统中标记自行车的架构
- en: Of the three examples in this chapter, figure 12.3 is most similar to the architectures
    that we have seen throughout the book. The only difference is that we are using
    multiple pretrained models because we are focused on model accuracy. You can see
    the code at [https://github.com/rmunro/bicycle_detection](https://github.com/rmunro/bicycle_detection).
    See the readme file in the repository for more information about the details of
    the implementation and how to experiment with it.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的三个例子中，图12.3与我们全书所见的架构最相似。唯一的区别是我们使用多个预训练模型，因为我们专注于模型精度。你可以在[https://github.com/rmunro/bicycle_detection](https://github.com/rmunro/bicycle_detection)中看到代码。在存储库的readme文件中可以找到有关实现细节和如何进行实验的更多信息。
- en: 12.4.3 Potential extensions
  id: totrans-165
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 12.4.3 潜在的扩展
- en: After playing with the system for a little while, think about what kind of changes
    you might make. Table 12.4 has some suggestions.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 在玩了一段时间的系统后，考虑一下你可能做出的改变。表12.4有一些建议。
- en: Table 12.4 Potential extensions to the example and the chapters/sections in
    which they are covered in this book
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 表12.4示例和本书中涵盖的章节/部分的潜在扩展
- en: '| Annotation interface |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| 标注界面 |'
- en: '| Batch annotations(section 11.2.1) | We could speed annotation by allowing
    batch annotation interfaces instead of scrolling. An interface with 10 or so images,
    in which the annotator has to select only images with bicycles in them, might
    be faster than the scrolling interface. |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| 批量标注（第11.2.1节） | 我们可以通过允许批量标注接口而不是滚动来加速标注。一个包含大约10张图片的接口，其中标注者只需选择包含自行车的图片，可能比滚动接口更快。|'
- en: '| Bounding-box annotation(section 11.5.2) | For images containing bicycles
    when the model cannot predict that bicycle correctly, the annotator can annotate
    the bicycle(s). That image can be used as a cropped training data example to help
    guide the model on similar examples. |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| 边界框标注（第11.5.2节） | 对于模型无法正确预测自行车的图像，标注者可以标注自行车（们）。该图像可以用作裁剪后的训练数据示例，以帮助指导模型在类似示例上的表现。|'
- en: '| Annotation quality control |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| 标注质量控制 |'
- en: '| Eliciting subjective judgments(section 9.1) | There are some tough edge cases,
    such as unicycles, bicycle frames, and bicycles with electric motors. It might
    be useful to treat these images as subjective tasks and to apply methods like
    Bayesian Truth Serum (BTS) to find minority but valid interpretations. |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| 引发主观判断（第9.1节） | 有一些棘手的边缘情况，例如独轮车、自行车框架和带电动马达的自行车。将这些图像视为主观任务并应用贝叶斯真理血清（BTS）等方法来寻找少数但有效的解释可能是有用的。|'
- en: '| Synthetic data(section 9.7) | Can we copy and paste bicycles into some images?
    Doing so might improve the diversity of contexts. If we include both positive
    and negative examples, we can help the model focus on the bicycles, not the background.
    |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| 合成数据（第9.7节） | 我们能否将自行车复制粘贴到一些图像中？这样做可能会提高上下文多样性。如果我们包括正负示例，我们可以帮助模型专注于自行车，而不是背景。|'
- en: '| Machine learning architecture |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| 机器学习架构 |'
- en: '| Object detection | If the images can be automatically cropped and/or zoomed
    on the parts of the image where the bicycles are predicted to be located, we could
    improve the speed and accuracy of the annotation process. This technique could
    be used in addition to more common data augmentation techniques such as flipping
    some images during training. |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| 目标检测 | 如果可以自动裁剪和/或放大预测自行车位置的图像部分，我们可以提高标注过程的速度和准确性。这种技术可以与更常见的如训练期间翻转一些图像的数据增强技术一起使用。|'
- en: '| Continuous/contiguous task | The task definition implies that the transportation
    manager is interested in the number of bicycles, not whether or not one or more
    occurs, so the model could be more useful with a continuous or contiguous task
    predicting the exact amount. Note that the annotation will be slower and quality
    control more difficult to implement. |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| 连续/连续任务 | 任务定义意味着交通管理者对自行车数量感兴趣，而不是是否有一个或多个发生，因此模型在预测确切数量时可能更有用。请注意，标注将更慢，质量控制更难实施。|'
- en: '| Active learning |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| 活动学习 |'
- en: '| Ensemble-based sampling(section 3.4) | Maintain multiple models and track
    the uncertainty of a prediction across all the models, sampling items with the
    highest average uncertainty and/or the highest variation in predictions. |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 基于集成采样的方法（第3.4节） | 维护多个模型并跟踪所有模型中预测的不确定性，采样平均不确定性最高或预测变化最大的项目。|'
- en: '| Representative sampling(section 4.4) | We are using pretrained models from
    ImageNet and COCO, but we are applying the model to Open Images. So we could use
    representative sampling to find the images most like Open Images relative to the
    other sources, as errors are more likely to occur there. |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| 代表性采样（第4.4节） | 我们正在使用ImageNet和COCO的预训练模型，但我们正在将模型应用于Open Images。因此，我们可以使用代表性采样来找到与其它来源相比最像Open
    Images的图像，因为错误更有可能在那里发生。|'
- en: As with our previous examples, all the changes in table 12.4 could be implemented
    in fewer than 50 lines of code. Any change might be the right next step based
    on experience with the system.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们之前的例子一样，表12.4中的所有更改都可以用少于50行代码实现。任何更改都可能基于对系统的经验成为正确的下一步。
- en: 12.5 Further reading for building human-in-the-loop machine learning products
  id: totrans-181
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 12.5 构建人机交互式机器学习产品的进一步阅读
- en: Although it is not free, Emmanuel Ameisen’s recent book *Building Machine Learning
    Powered Applications (O’Reilly, 2020)* is a good overview of the factors that
    you need to take into account when building machine learning applications, such
    as defining your product goal, setting up the machine learning problem, and building
    an end-to-end pipeline quickly. Almost all this information applies to human-in-the-loop
    systems.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管不是免费的，但Emmanuel Ameisen最近出版的书籍《构建机器学习应用（O’Reilly，2020）*Building Machine Learning
    Powered Applications*》是构建机器学习应用时需要考虑的因素的良好概述，例如定义您的产品目标、设置机器学习问题以及快速构建端到端管道。几乎所有这些信息都适用于人机交互系统。
- en: Summary
  id: totrans-183
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: When defining products for human-in-the-loop machine learning applications,
    it helps to start with the problem that you are trying to solve and work backward.
    This approach helps frame everything from the technical design to the interface
    design and the guidelines for annotation.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在定义人机交互机器学习应用的产品时，从您试图解决的问题开始并逆向工作是有帮助的。这种方法有助于从技术设计到界面设计以及注释指南的框架。
- en: We created a system for exploratory data analysis for short text, giving an
    analyst the ability to filter news headlines quickly according to different labels
    so that they can see the changes over time.
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们创建了一个用于短文本探索性数据分析的系统，使分析师能够根据不同的标签快速过滤新闻标题，以便他们可以看到随时间的变化。
- en: We created a system to extract information from text, helping a food safety
    expert track information about pathogens and foreign bodies found in food from
    plain reports.
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们创建了一个从文本中提取信息的系统，帮助食品安全专家从普通报告中追踪食品中发现的病原体和异物信息。
- en: We created a system to maximize the accuracy of an image labeling task, assisting
    a data scientist who is making a bicycle identification model as accurate as possible.
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们创建了一个系统来最大化图像标注任务的准确性，帮助一位数据科学家制作尽可能精确的自行车识别模型。
