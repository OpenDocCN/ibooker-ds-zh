- en: Appendix D. Real-world use case
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 D. 现实世界用例
- en: D.1 Fluentd use in a real-world use case
  id: totrans-1
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.1 在现实世界用例中使用 Fluentd
- en: Throughout the book, we have focused on explaining how to use Fluentd. The explanations
    have focused on specific areas rather than providing a holistic view. This appendix
    seeks to redress that by providing a more holistic picture.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在整本书中，我们专注于解释如何使用 Fluentd。解释主要集中在特定领域，而不是提供整体视角。本附录试图纠正这一点，通过提供一个更全面的图景。
- en: This appendix has taken several similar real-world scenarios and blended them
    to avoid giving any client information away. Blending the cases together has allowed
    us to also incorporate more lessons. We won’t go into the specific configuration
    details, as they’re covered in the core of the book, but this should help you
    understand why we value some features.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本附录选取了几个类似的现实世界场景并将它们融合在一起，以避免泄露任何客户信息。将这些案例结合起来，我们还能够融入更多的经验教训。我们不会深入具体配置细节，因为它们已在本书的核心部分有所涵盖，但这应该有助于您理解我们为什么重视某些功能。
- en: D.2 Setting the scene
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.2 设置场景
- en: 'Our organization started about 30 years ago as a single-country retailer that
    has grown rapidly. The growth has been driven by the following:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的组织大约30年前作为一个单一国家的零售商开始，并迅速增长。这种增长是由以下因素驱动的：
- en: Acquiring its own manufacturing capabilities, as its offerings are custom to
    each client.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获得自己的制造能力，因为其产品针对每个客户都是定制的。
- en: Expanding its retail scope to related product lines reflecting changes in the
    market.
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扩大其零售范围至反映市场变化的关联产品线。
- en: Commercially the retail units are established as businesses in their own right
    and are either wholly owned by a subsidiary of the main corporation or are co-owned
    (with store directors); there are also a few traditional franchisees. This structure
    gives the stores a degree of autonomy and individual accountability. This has
    meant independent retailers can become part of the group, and external investment
    (share cost in co-ownership or franchise) has helped growth.
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在商业上，零售单位作为独立的企业建立，要么由主要公司的子公司全资拥有，要么与门店经理共同拥有；还有一些传统的特许经营商。这种结构赋予了商店一定程度的自主性和个人责任。这意味着独立零售商可以成为集团的一部分，外部投资（共同拥有或特许经营权的股份）有助于增长。
- en: Technology adoption has been driven by goals to streamline processes and, therefore,
    more retail throughput. This has meant growth in mobile device adoption and, more
    slowly, engagement with internet-based sales channels.
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 技术采用是由简化流程和因此提高零售吞吐量的目标所驱动的。这意味着移动设备采用的增长，以及与基于互联网的销售渠道的缓慢互动。
- en: International expansion has been driven in Europe, Asia Pacific (including China),
    and North America in the last 20 years.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在过去20年中，国际扩张在欧洲、亚太地区（包括中国）和北美进行。
- en: Internally, the organization is split in terms of geographical business and
    operations. Within each organization, there are vertical domains of
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在内部，组织在地理业务和运营方面是分割的。
- en: Retail
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 零售
- en: Manufacturing and distribution
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 制造和分销
- en: Corporate (which covers marketing, accounting, external supply chain sourcing,
    etc.)
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 企业（涵盖营销、会计、外部供应链采购等）
- en: A central IT function supports corporate systems, core solutions used at a regional
    or manufacturing site level, and retail IT solutions. Still, the level of autonomy
    the verticals have creates conditions where shadow or gray IT exists. This is
    further compounded by the regional operations having their own IT teams aligned
    to the regional businesses. Corporate HQ and the primary IT operations, including
    software development, are based in Europe.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 一个中央IT部门支持企业系统、在区域或制造站点级别使用的核心解决方案，以及零售IT解决方案。尽管如此，垂直部门所拥有的自主性创造了存在影子或灰色IT的条件。这一点进一步由区域运营拥有自己的与区域业务对齐的IT团队而加剧。企业总部和主要的IT运营，包括软件开发，位于欧洲。
- en: Some IT solutions reflect the organization’s age and growth; some corporate
    solutions have seen years of cumulative extension, patching, and customization
    and are clearly aging and brittle. This has led to hesitancy to make changes and
    some significant programs having been started to replace some of the legacy with
    a COTS (commercial-off-the-shelf) or SaaS approach. Shadow IT has meant local
    pockets of SaaS and “integration” have sprung up. European IT is dominated by
    its own on-premises data centers. Still, the newer geographic regions are more
    quickly adopting cloud rather than seeking the capital outlay for their operational
    IT and support centers. Retail currently is an on-premises proposition, as wide
    area network communications are not considered robust enough to allow retail locations
    to continue operating in the event of an outage. In some parts of the world, the
    stores simply don’t have sufficient network quality, reliability, and bandwidth
    to support all the demands of hosting solutions remotely.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 一些IT解决方案反映了组织的年龄和增长；一些企业解决方案已经经历了多年的累积扩展、修补和定制，显然已经过时且脆弱。这导致了人们不愿进行变革，并且已经启动了一些重大计划，用商业现货（COTS）或SaaS方法来替换一些遗留系统。影子IT导致了本地SaaS和“集成”的局部涌现。欧洲IT主要由其自身的本地数据中心主导。然而，较新的地理区域更快速地采用云计算，而不是寻求为运营IT和支持中心投入资本。目前，零售是一个本地化方案，因为广域网通信被认为不够稳健，无法允许零售地点在出现故障时继续运营。在世界的某些部分，商店的网络质量、可靠性和带宽不足以支持远程托管解决方案的所有需求。
- en: In addition to COTS, solutions developed in-house for retail and manufacturing
    often embody corporate IP or streamline business processes. The organization sees
    increasingly connected devices in the manufacturing and retail spaces. The connectivity
    is coming either because of the natural IT evolution or because of parts of the
    organization commissioning third parties to build solutions or unique customizations
    of standard commercial offerings delivered by tablets.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 除了商业现货（COTS）之外，内部开发的零售和制造解决方案通常包含企业知识产权或简化业务流程。组织在制造和零售空间中看到了越来越多的互联设备。这种互联性要么是由于自然的信息技术演变，要么是因为组织委托第三方构建解决方案或对标准商业产品进行独特的定制化，这些产品通过平板电脑提供。
- en: Much of the system integration has been achieved via messaging, shared databases,
    or FTP. The retail and manufacturing capabilities are the most message-based,
    as store orders to manufacturing are time-sensitive and reflect dynamic stock
    allocation (reflecting these solutions have been bespoke built).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 大部分系统集成是通过消息传递、共享数据库或FTP实现的。零售和制造能力最依赖于消息传递，因为商店订单到制造的时间敏感性强，反映了动态库存分配（这些解决方案是定制构建的）。
- en: The rollout of software changes tends to be slow, often coming from nervousness
    about brittle legacy solutions. Delays outside non-European geographies have been
    compounded by the lack of understanding of software change and operational support
    challenges that made people resistant to change. Ironically, this has compounded
    problems, as outward pressure from Europe for upgrades to be rolled out means
    the rollout often entails a lot of change.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 软件变更的推出往往比较缓慢，这通常源于对脆弱的遗留解决方案的担忧。在非欧洲地理区域外的延误，由于对软件变更和运营支持挑战缺乏理解，使得人们抵制变革，这一问题变得更加严重。讽刺的是，这反而加剧了问题，因为来自欧洲的压力要求推出升级，意味着推出往往涉及大量的变更。
- en: Existing operational and monitoring maturity depends upon geography, with Europe
    being the most established and mature. However, monitoring is primarily an infrastructure-only
    engagement. Monitoring at the application level is weaker. Business-level monitoring
    comes through classic retail and supply chain reporting metrics (sales and orders)
    rather than from more contemporary views of how many tasks are at different stages
    of their process.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 现有的运营和监控成熟度取决于地理位置，欧洲是最成熟和发达的。然而，监控主要是基础设施层面的参与。应用层面的监控较弱。业务层面的监控是通过经典的零售和供应链报告指标（如销售额和订单）而不是从更现代的视角来衡量任务在其流程的不同阶段。
- en: Some of the problems have come from the continual drive for growth in terms
    of geography and market leadership (market share, innovation, regulation change).
    These pressures, at times, don’t help with keeping on top of the nonfunctional
    considerations as they evolve with the growth and technical debt. This isn’t unusual
    for many established organizations, but the continued growth embedded into the
    organizational DNA increases the pressure. IT momentum is typically measured through
    new functional capability and certainly creates some challenges in addressing
    debt until debt impacts delivery.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 一些问题来自地理和市场领导力（市场份额、创新、法规变化）的持续增长驱动。有时，这些压力并不有助于跟上非功能性考虑因素，因为它们随着增长和技术债务而演变。这对许多成熟组织来说并不罕见，但嵌入到组织DNA中的持续增长增加了压力。IT动量通常通过新的功能性能力来衡量，当然在解决债务直到债务影响交付时也会带来一些挑战。
- en: As you can see, this is not a cloud-born organization, but it was starting to
    feel its way into the cloud and needs to understand how to solve monitoring both
    for on-premises and when dealing with the cloud.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所见，这不是一个云原生组织，但它开始摸索进入云，需要了解如何解决监控，无论是本地还是处理云。
- en: D.2.1 The operational challenges
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: D.2.1 运营挑战
- en: It’s worth looking at some of the operational problems that the organization
    has struggled with. Addressing such issues will bring business value that can
    be gained through the delivery of monitoring improvements, including the adoption
    of Fluentd.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 值得关注组织在运营中遇到的一些问题。解决这些问题将通过监控改进的交付带来业务价值，包括采用Fluentd。
- en: Third- and fourth-line support for core systems comes from the IT development
    in Europe that doesn’t provide 24/7 support. Regional operations working in different
    time zones have to provide their own support for their own regional retail. Central
    support provided often comes down to organizational politics and the goodwill
    of staff to provide out-of-hours support.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 核心系统的第三线和第四线支持来自欧洲的IT发展，这些地区不提供24/7的支持。在不同时区工作的区域运营必须为自己的区域零售提供自己的支持。中央支持通常归结为组织政治和员工提供加班支持的好意。
- en: European development, which could effectively support local geographies using
    basic DevOps practices, had an insufficient appreciation for the needs of other
    regions. DevOps often was a reason not to write things down, so locally, understanding
    was very much through verbal and collaborative behaviors. The different geographies
    not being an active part of the development process and not benefiting from the
    collaborative knowledge transfer meant they lacked understanding of in-house solutions.
    This has resulted in problems arising from people using solutions in a way they
    were not expected to be used. Fast and dirty processes to recover from problems
    resulting in the loss of insight into operational failures (no logs retained or
    environment imaging/snapshots) made it very difficult for European IT to investigate
    and develop preventative measures.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 欧洲开发，能够有效地使用基本的DevOps实践支持本地地理，但对其他地区的需求认识不足。DevOps往往是避免写下来的原因，因此本地理解很大程度上是通过口头和协作行为。不同的地理区域不是开发过程的积极参与者，也没有从协作知识转移中受益，这意味着他们缺乏对内部解决方案的了解。这导致了人们以他们未预期的方式使用解决方案的问题。快速而简陋的流程来恢复问题，导致对运营失败缺乏洞察力（没有保留日志或环境镜像/快照），这使得欧洲IT难以调查和制定预防措施。
- en: D.3 Introducing monitoring
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.3 引入监控
- en: The IT systems effectively formed a series of star structures from the store
    to regional operational hubs and from regional hubs to the corporate center. This
    can be seen in figure D.1\. The manufacturing and distribution are also connected
    directly to hubs and to the global center. This lends itself to adopting monitoring
    as a series of concentrator networks. This also fits well because most of the
    hubs have the most significant volume of events/transactions passing through,
    meaning problems in these areas have the most significant commercial impact.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: IT系统有效地形成了一系列从店铺到区域运营中心和从区域中心到企业中心的星形结构。这可以在图D.1中看到。制造和分销也直接连接到中心和全球中心。这使其适合采用监控作为一系列集中器网络。这也非常适合，因为大多数中心都有最大量的事件/交易通过，这意味着这些区域的问题具有最大的商业影响。
- en: '![](../Images/APPD_F01_Wilkins.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/APPD_F01_Wilkins.png)'
- en: Figure D.1 The key “actors” in the business and their relationships (and flow
    of information) across the organization
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 图 D.1 商业中的关键“参与者”及其在组织内（以及信息流）的关系
- en: The first goal was getting regional hub systems aggregating and unifying their
    log data. Working on an 80/20 principle, we looked for standard technologies and
    common systems (often those originating from the central IT capability) to create
    standardized log event capture configurations. Metrics data collection was also
    implemented with simple threshold alarms. Alarms reflected significant threshold
    breaches (before they went critical) and had log events generated. When investigating
    a problem through the logs, we could see historically that there might have been
    a performance issue of some sort (typically the most severe being disk storage
    exhaustion).
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个目标是让区域中心系统聚合和统一其日志数据。根据 80/20 原则，我们寻找标准技术和通用系统（通常是源自中央 IT 能力的系统）来创建标准化的日志事件捕获配置。还实施了简单的阈值警报。警报反映了重大阈值违规（在它们变得关键之前）并生成了日志事件。在通过日志调查问题时，我们可以看到历史上可能存在某种性能问题（通常是磁盘存储耗尽最为严重）。
- en: While aligning infrastructure logs with the application logs would have shown
    us these measures, wanting to combine infrastructure monitoring led to conflicting
    politics, as the infrastructure teams felt their monitoring was mature. They weren’t
    the source of the problems. This wasn’t helped by the fact that IaaS activities
    didn’t see the infrastructure teams being involved.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在将基础设施日志与应用程序日志对齐本可以显示这些措施的情况下，想要结合基础设施监控导致了冲突的政治，因为基础设施团队认为他们的监控已经成熟。他们不是问题的来源。IaaS
    活动没有看到基础设施团队参与的事实也没有帮助。
- en: We pressed development teams to catalog exceptions and use error codes as a
    first step to building better support documentation. This provided a vehicle for
    the regional teams to attach and share their own operational processes. Over time,
    we got CI/CD code quality checks to detect the allocation of error codes and gamified
    the adoption.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我们敦促开发团队编制异常情况清单，并使用错误代码作为构建更好的支持文档的第一步。这为区域团队提供了附加和共享他们自己的运营流程的途径。随着时间的推移，我们实现了
    CI/CD 代码质量检查以检测错误代码的分配，并使采用游戏化。
- en: Traction with unifying the logs progressed, and we had a better understanding
    of what might be happening in the different deployments—some of the warning signs
    of problems had been identified and weren’t being recognized until too late. Therefore,
    alerting was provided through the log monitoring for the well-understood indicators
    by using group emails.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在统一日志方面取得进展，我们更好地理解了不同部署中可能发生的情况——一些问题的警告信号已被识别，但直到太晚才被认识到。因此，通过使用分组电子邮件为众所周知的指标提供警报。
- en: Other candidate indicators started being watched, which triggered a script to
    gather more diagnostic information, such as message queue depths, capturing the
    last access time to a queue.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 其他候选指标开始受到关注，这触发了收集更多诊断信息的脚本，例如消息队列深度，捕获对队列的最后访问时间。
- en: As confidence grew that the monitoring was producing results, with both local
    operational teams and central IT resources better seeing what was going on, the
    acceptance of extending monitoring was implemented. Forwarding specific events
    to the central IT team also helped confirm when data distribution processes from
    the corporate center became the source of issues. Some of the problems started
    to be identified by examining logs for what was expected to happen. Along with
    the incorporation of the capacity, flags were things like
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 随着对监控产生结果的信心增强，无论是本地运营团队还是中央 IT 资源都能更好地了解正在发生的事情，扩展监控的接受度得到了实施。将特定事件转发到中央 IT
    团队也有助于确认当企业中心的数据分发过程成为问题来源时。通过检查日志以确定预期发生的事情，一些问题开始被识别。随着能力的整合，标志包括
- en: Housekeeping wasn’t being run on time.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 清理工作没有按时进行。
- en: Software deployments weren’t always followed as recommended by the central teams.
    As a result, automated processes didn’t fire when they were expected or needed
    to.
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 软件部署并不总是遵循中央团队的建议。因此，当预期或需要时，自动化流程并没有触发。
- en: Manual housekeeping wasn’t consistently practiced, often because the additional
    housekeeping steps were passed around by email, which didn’t reach everyone, or
    were not added to documentation as a more structured process.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手动清理工作并不始终得到一致执行，通常是因为额外的清理步骤通过电子邮件传递，没有达到每个人，或者没有作为更结构化的流程添加到文档中。
- en: Some business processes took days or weeks longer than expected in different
    geographies. As a result, staging data built up more than was expected, creating
    issues.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些业务流程在不同地理区域比预期花费了更长的时间。结果，预演数据积累超过了预期，产生了问题。
- en: Indications of warnings were not addressed when they needed to be.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当需要处理警告指示时，并未得到解决。
- en: Some application logic wasn’t very defensive, allowing users to do things that
    weren’t expected in other parts of the enterprise—for example, product images
    were GBs in size when the communication infrastructure assumed such data would
    only be a few Kb.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些应用程序逻辑不够防御性，允许用户执行企业其他部分不期望的操作——例如，当通信基础设施假定此类数据只会是几个Kb大小时，产品图片的大小为GB。
- en: Some of these findings certainly had to be handled with a great deal of care,
    as the mistakes and issues of communication gave anyone with an organizational
    agenda fuel, and often a lot of finger-pointing could occur.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 其中一些发现肯定需要非常小心地处理，因为错误和沟通问题为任何有组织议程的人提供了燃料，并且经常会发生大量的指责。
- en: D.3.1 Extending monitoring
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: D.3.1 监控的扩展
- en: With good progress with the geographical hubs and labs, the same approach was
    repeated for retail operations. This had to be done with more care, as anything
    perceived as impacting retail operations was a sensitive issue. One of the key
    challenges was sending sufficient information back to the hubs to provide suitable
    value while not consuming precious bandwidth.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在地理枢纽和实验室取得良好进展后，相同的做法被重复用于零售运营。这必须更加小心地进行，因为任何被认为会影响零售运营的事情都是一个敏感问题。一个主要挑战是向枢纽发送足够的信息以提供合适的价值，同时不消耗宝贵的带宽。
- en: The log aggregation focused on the store’s server-side solutions rather than
    the mobile platforms with device-native applications. Understanding native applications
    to get meaningful insights ended up being an issue separated from the core monitoring
    efforts. As the store applications handled PII data, the store servers were tightly
    locked down and experienced the occasional erroneous entry to a UI of data that
    shouldn’t be there, resulting in PII data occasionally finding its way into log
    entries. The subsequent need to filter log events further led to applying data
    masking for log events, even locally.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 日志聚合主要集中在商店的服务器端解决方案上，而不是具有设备原生应用的移动平台。为了获得有意义的见解而理解原生应用最终成为一个与核心监控努力分离的问题。由于商店应用程序处理PII数据，商店服务器被紧密锁定，偶尔会出现错误的数据条目进入不应存在的UI，导致PII数据偶尔出现在日志条目中。随后对进一步过滤日志事件的需求导致对日志事件应用数据掩码，甚至是在本地。
- en: D.3.2 Finessing of monitoring
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: D.3.2 监控的精细化
- en: With the operational insights starting to flow back to central IT teams, some
    development teams switched from using Java logging to files to logging directly
    to the Fluentd agent. Where this was adopted, we used a configuration during development
    that ensured the log events got written to a file rather than to a central log
    storage capability. Log centralization varied based on willingness to allow additional
    software to be deployed and who would deploy it. This meant developers didn’t
    see the introduction of Fluentd early in the process as a disruption, because
    they were used to looking at their log files to help confirm code was working
    as expected. But this also helped promote improvement in logging, as we could
    still put filters in to highlight potential issues, such as accidentally logging
    sensitive data items.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 随着运营洞察开始反馈给中央IT团队，一些开发团队从使用Java日志记录到文件转变为直接记录到Fluentd代理。在这些地方采用此方法时，我们在开发期间使用了一种配置，确保日志事件被写入文件而不是中央日志存储能力。日志集中化程度取决于是否愿意部署额外的软件以及由谁部署。这意味着开发者并没有将Fluentd的引入视为过程中的干扰，因为他们习惯于查看日志文件以帮助确认代码按预期工作。但这也有助于促进日志记录的改进，因为我们仍然可以设置过滤器来突出潜在问题，例如意外记录敏感数据项。
- en: D.4 Cloud dilemma
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.4 云困境
- en: While cloud impact was very much a SaaS or IaaS issue, increasingly the challenge
    we are seeing with matured PaaS is the use of Cloud Native services, rather than
    a “low code” style of PaaS, such as MuleSoft, Dell Boomi, and Oracle’s Integration
    Cloud, which are closed ecosystems, to varying degrees. AWS, Azure, Oracle, and
    Google all provide cloud native services that offer Fluentd-like capabilities
    for their Kubernetes services. Therefore, when building with AWS’s Kubernetes
    or Oracle’s Blockchain, should we use the vendor implementations or explicitly
    instantiate Fluentd and configure Kubernetes to use our Fluentd, not the out-of-the-box
    logging and monitoring? We can see this clearly in figure D.2 with a cloud host
    natural solution using cloud native technologies and a cloud host-aligned approach.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然云的影响在很大程度上是SaaS或IaaS的问题，但我们在成熟的PaaS中看到的挑战越来越多，是使用云原生服务，而不是“低代码”风格的PaaS，例如MuleSoft、Dell
    Boomi和Oracle的集成云，这些是程度不同的封闭生态系统。AWS、Azure、Oracle和Google都提供了云原生服务，为他们的Kubernetes服务提供了类似Fluentd的能力。因此，当使用AWS的Kubernetes或Oracle的区块链时，我们应该使用供应商的实现，还是明确实例化Fluentd并配置Kubernetes使用我们的Fluentd，而不是开箱即用的日志和监控？我们可以在图D.2中清楚地看到这一点，其中使用云主机自然解决方案利用云原生技术和云主机对齐的方法。
- en: '![](../Images/APPD_F02_Wilkins.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/APPD_F02_Wilkins.png)'
- en: Figure D.2 This illustrates the difference between a cloud-neutral approach
    to logging using cloud-native solutions (top), where you will need to accommodate
    in the infrastructure as code the networking needs, versus a vendor-specific model,
    where all the log events will go into a transparent monitoring layer handled by
    the cloud vendor.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 图D.2 这说明了使用云原生解决方案进行日志记录的云中立方法（顶部）与特定供应商模型之间的差异，在特定供应商模型中，所有日志事件都将进入由云服务提供商处理的透明监控层，而在云中立方法中，你需要在基础设施即代码中适应网络需求。
- en: 'It isn’t necessarily an easy question to answer. If we use the services provided
    and benefit from integrating, self-scaling, auto-patching, and so on, we must
    accept the consequential vendor lock-in. Or we must go the IaaS approach and deploy
    Fluentd ourselves, meaning any IaaS cloud vendor can be used, but we have to patch
    and scale ourselves. We’ve settled on answering this with several questions:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不是一个容易回答的问题。如果我们使用提供的服务并从集成、自动扩展、自动修补等中受益，我们必须接受随之而来的供应商锁定。或者我们必须采取IaaS方法并自行部署Fluentd，这意味着可以使用任何IaaS云服务提供商，但我们必须自行修补和扩展。我们已经决定通过几个问题来回答这个问题：
- en: What value do you gain by being cloud vendor–agnostic?
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过成为云服务提供商无关，你获得了哪些价值？
- en: For software vendors, the benefit is obvious—maximum potential in terms of the
    consumer base. But the reality is that you’ll probably eventually incorporate
    adaptors into the clouds you support the most, as this benefits the customer.
    There are the high-profile stories of Zoom being able to switch cloud vendors
    quickly to realize substantial savings and Dropbox’s decision to move off AWS
    as they reached a scale that meant private data centers offered a better economy.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于软件供应商来说，好处是显而易见的——在消费者基础方面的最大潜力。但现实是，你最终可能会将适配器集成到你支持最多的云中，因为这有利于客户。有关于Zoom能够快速切换云服务提供商以实现实质性节省的高知名度故事，以及Dropbox决定离开AWS，因为他们达到了一个规模，这意味着私有数据中心提供了更好的经济性。
- en: Are you likely to need multiple cloud vendors or operate in a hybrid manner?
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你是否可能需要多个云服务提供商或以混合方式运营？
- en: For truly global solutions, today’s reality is that you are likely to need to
    deploy to multiple clouds. This is simply because not every vendor has a substantial
    presence in every geography. You may bump up against specific country data restrictions,
    which may mean using a particular vendor (e.g., Azure at the time of writing doesn’t
    have a presence in Eastern Europe, and Google doesn’t have a presence in Africa).
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于真正全球性的解决方案，今天的现实是，你很可能会需要部署到多个云中。这仅仅是因为并非每个供应商在每个地理区域都有实质性存在。你可能会遇到特定的国家数据限制，这可能意味着使用特定的供应商（例如，撰写本文时，Azure在东欧没有存在，而Google在非洲没有存在）。
- en: Also, unless you’re a significant customer with deep pockets, you won’t be using
    the cloud in your data center solutions such as AWS’s Outpost or Oracle’s Cloud
    at Customer, where the entire cloud platform is deployed onto provided racks of
    servers that live in your data center. This means multiple implementation and
    configuration issues. This may not be an option if you want to operate in China,
    as many IT vendors have restrictions on where and what they will offer.
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 此外，除非你是拥有深厚资金的大客户，否则你不会在数据中心解决方案中使用云，例如AWS的Outpost或Oracle的云客户，整个云平台部署到位于你数据中心的服务器机架上。这意味着存在多个实施和配置问题。这可能不是在中国运营的选项，因为许多IT供应商对提供的产品和地点有限制。
- en: How big and capable is your IT team?
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的IT团队有多大，能力如何？
- en: The more variations in how the same problem is solved, the more skills an IT
    team or department will need. Suppose your IT organization needs to be very lean
    in terms of people. In that case, a standard set of technologies has a lot going
    for it. The team can develop their expertise with a smaller, focused set of tools.
    Master those to greater depth and maximize the investment. We’re not suggesting
    that all monitoring problems can be answered by Fluentd, but why master three
    or four log unification tools if one is enough?
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 解决相同问题的方法越多变，IT团队或部门需要的技能就越多。假设你的IT组织在人员方面需要非常精简。在这种情况下，一套标准的技术有很多优势。团队可以使用更小、更专注的工具集来发展他们的专业知识。更深入地掌握这些工具，并最大化投资。我们并不是说所有监控问题都可以通过Fluentd来解决，但为什么需要掌握三四个日志统一工具，如果有一个就足够了呢？
- en: Are your monitoring needs or strategy likely to take you into specialist situations?
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的监控需求或策略是否可能让你进入专业领域？
- en: For those specialist situations, where a restrictive solution is likely to need
    a lot of working around or you’re pushing the boundaries of what is possible with
    standard tools, then a service model from the cloud vendors is likely to create
    more problems than solutions. You won’t be able to tailor their platform around
    your unique circumstances like you can when you have complete control of both
    code and deployment.
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于那些可能需要大量调整或你正在推动标准工具可能性的边界的情况，云服务提供商的服务模式可能比解决方案造成更多问题。你将无法像完全控制代码和部署时那样，根据你独特的环境定制他们的平台。
- en: Exploring these questions will undoubtedly reveal whether adopting Fluentd or
    something like the ELK stack is the way to go.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 探索这些问题无疑会揭示采用Fluentd或类似ELK堆栈是否是正确的选择。
- en: D.5 Solution
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.5 解决方案
- en: The solution that we arrived at on a regional hub level looks like the diagram
    in figure D.3\. The corporate monitoring would look pretty similar, although the
    number of sources grew significantly over time as monitoring became more standard
    practice.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在区域枢纽级别达成的解决方案看起来与图D.3中的图表相似。企业监控看起来会很相似，尽管随着时间的推移，源的数量显著增加，因为监控已成为更标准的实践。
- en: '![](../Images/APPD_F03_Wilkins.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/APPD_F03_Wilkins.png)'
- en: Figure D.3 Overview solution for monitoring laid against the log event life
    cycle
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 图D.3 监控概述解决方案与日志事件生命周期的对比
- en: The stores and manufacturing centers would have some similarities, albeit a
    great deal simpler than the hubs, as they didn’t use containerization and had
    a smaller suite of systems in action.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 仓库和制造中心会有一些相似之处，尽管比枢纽简单得多，因为它们没有使用容器化，并且正在运行的系统套件较小。
- en: D.6 Conclusion
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: D.6 结论
- en: Hopefully you’ll see from this that several of the Fluentd techniques we cover
    in the book helped deliver value to an organization with some challenges. You’ll
    have noticed that the application of Fluentd was not bound to any specific type
    of platform or technology. While Fluentd does come under the governance of the
    CNCF, this reflects the fact that it can help with modern cloud challenges, not
    that it was designed exclusively for this context.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 希望你能从这一点看出，我们在书中涵盖的Fluentd技术中的几个帮助了一个面临挑战的组织实现价值。你会注意到，Fluentd的应用并不局限于任何特定类型的平台或技术。虽然Fluentd受到CNCF的监管，但这反映的是它可以帮助解决现代云挑战的事实，而不是它专门为此背景设计。
- en: One of our biggest takeaways from this lesson is the need for the organization
    implementing the monitoring capability to ensure that the culture and approach
    to implementing monitoring is ready and able to embrace the changes necessary.
    While hardware monitoring is taken as the norm (after all, you’ve made a significant
    capital outlay, so you want to ensure it is paying for itself), application monitoring
    and the use of logs often don’t get the same treatment. In the cases that formed
    this example, things had to become significantly problematic before a significant
    commitment was made to address them.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 从本课程中我们最大的收获之一是，实施监控能力的组织需要确保其文化和实施监控的方法已经准备好并能够接受必要的变革。虽然硬件监控被视为常态（毕竟，你已经投入了大量的资本，所以你希望确保它能够自我回报），但应用监控和日志的使用往往没有得到同样的重视。在形成这个例子的案例中，问题必须变得非常严重，才会在解决这些问题上做出重大承诺。
