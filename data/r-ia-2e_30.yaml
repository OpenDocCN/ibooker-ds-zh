- en: Appendix B. Customizing the startup environment
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 B. 自定义启动环境
- en: One of the first things that programmers like to do is customize their startup
    environment to conform to their preferred way of working. Customizing the startup
    environment allows you to set R options, specify a working directory, load commonly
    used packages, load user-written functions, set a default CRAN download site,
    and perform any number of housekeeping tasks.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 程序员喜欢做的第一件事之一就是自定义他们的启动环境，以符合他们偏好的工作方式。自定义启动环境允许您设置 R 选项、指定工作目录、加载常用包、加载用户编写的函数、设置默认
    CRAN 下载站点，并执行任何数量的维护任务。
- en: You can customize the R environment through either a site-initialization file
    (Rprofile.site) or a directory-initialization file (.Rprofile). These are text
    files containing R code to be executed at startup.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过站点初始化文件 (Rprofile.site) 或目录初始化文件 (.Rprofile) 来自定义 R 环境。这些是包含在启动时执行的 R 代码的文本文件。
- en: At startup, R will source the file Rprofile.site from the R_HOME/etc directory,
    where `R_HOME` is an environment value. It will then look for an .Rprofile file
    to source in the current working directory. If R doesn’t find this file, it will
    look for it in the user’s home directory. You can use `Sys.getenv("R`*_*`HOME")`,
    `Sys.getenv ("HOME")`, and `getwd()` to identify the location of R_HOME, HOME,
    and the current working directory, respectively.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 启动时，R 将从 R_HOME/etc 目录中源文件 Rprofile.site，其中 `R_HOME` 是一个环境变量。然后它将在当前工作目录中寻找要源文件的
    .Rprofile 文件。如果 R 找不到此文件，它将在用户的主目录中寻找。您可以使用 `Sys.getenv("R`*_*`HOME")`、`Sys.getenv
    ("HOME")` 和 `getwd()` 分别识别 R_HOME、HOME 和当前工作目录的位置。
- en: You can place two special functions in these files. The `.First()` function
    is executed at the start of each R session, and the `.Last()` function is executed
    at the end of each session. An example of an Rprofile.site file is shown in listing
    B.1.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在这些文件中放置两个特殊函数。`.First()` 函数在每个 R 会话开始时执行，而 `.Last()` 函数在每个会话结束时执行。Rprofile.site
    文件的示例在列表 B.1 中展示。
- en: Listing B.1 Sample .Rprofile
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 列表 B.1 样本 .Rprofile
- en: '[PRE0]'
  id: totrans-6
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: ❶ Sets common options
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ❶ 设置常用选项
- en: ❷ Sets R interactive prompt
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: ❷ 设置 R 交互式提示符
- en: ❸ Sets CRAN mirror default
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ❸ 设置 CRAN 镜像默认值
- en: ❹ Sets path for local library
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: ❹ 设置本地库路径
- en: ❺ Creates shortcuts
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ❺ 创建快捷键
- en: ❻ Startup function
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: ❻ 启动函数
- en: ❼ Session end function
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: ❼ 会话结束函数
- en: 'Let’s look at what this .Rprofile accomplishes:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看这个 .Rprofile 实现了什么：
- en: Printed output is customized. The number of significant digits is set to 4 (the
    default is 7), stars are not printed on summary tables of coefficients, and scientific
    notation is suppressed.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 打印的输出被定制。有效数字的位数设置为 4（默认为 7），系数摘要表上不打印星号，并且抑制了科学记数法。
- en: The prompt is set to ">" for the first line, and a space for continuation lines
    (rather than the "`+`" sign).
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提示符的第一行设置为 ">", 而续行使用空格（而不是 "+" 符号）。
- en: The default CRAN mirror site for `install.packages()` commands is set to cran.rstudio.com.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`install.packages()` 命令的默认 CRAN 镜像站点设置为 cran.rstudio.com。'
- en: A personal directory is defined for installed packages. Setting a `.libPaths`
    value allows you to create a local library for packages outside of the R directory
    tree. This can be useful for retaining packages during an upgrade.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为已安装的包定义了一个个人目录。设置 `.libPaths` 值允许您在 R 目录树之外为包创建本地库。这在升级期间保留包可能很有用。
- en: One-letter shortcuts are defined for the `tail()`, `head()` and `summary()`
    functions. The new functions `ht()` and `phelp()` are defined. `ht()` combines
    the output of head and tail. `phelp()` lists the functions in a package (with
    linked help).
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为 `tail()`、`head()` 和 `summary()` 函数定义了一键快捷键。定义了新的函数 `ht()` 和 `phelp()`。`ht()`
    结合了 head 和 tail 的输出。`phelp()` 列出包中的函数（带有链接的帮助）。
- en: The `.First()` function
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`.First()` 函数'
- en: 'Replaces the standard welcome message with a shorter customized welcome. On
    my machine, the new welcome message is simply this:'
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用较短的定制欢迎信息替换标准欢迎信息。在我的机器上，新的欢迎信息只是这样：
- en: R version 4.1.0 (2021-05-18)—"Camp Pontanezen"
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: R 版本 4.1.0 (2021-05-18)—"Camp Pontanezen"
- en: 'Platform: x86_64-w64-mingw32/x64 (64-bit)'
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 平台：x86_64-w64-mingw32/x64 (64位)
- en: Loads the `tidyverse` packages into interactive sessions. The `tidyverse` start-up
    message is suppressed.
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将 `tidyverse` 包加载到交互会话中。`tidyverse` 的启动信息被抑制。
- en: The `.Last()` function prints a customized goodbye message. This is also an
    excellent place to execute any cleanup activities, including archiving command
    histories, program output, and data files.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`.Last()` 函数打印一个定制的告别信息。这也是执行任何清理活动的绝佳位置，包括存档命令历史、程序输出和数据文件。'
- en: Warning! If you define functions or load packages in your .Rprofile file rather
    than in your scripts, they’ll be less portable. Your code now depends on your
    startup file to run correctly. They’ll fail on other machines that lack this file.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 警告！如果你在 .Rprofile 文件中定义函数或加载包，而不是在脚本中，它们将变得不太便携。你的代码现在依赖于启动文件才能正确运行。在其他缺少此文件的机器上，它们将无法运行。
- en: If you want to supercharge your .Rprofile, take a look at Jumping Rivers’ `rprofile`
    package ([https://www.jumpingrivers.com/blog/customising-your-rprofile/](https://www.jumpingrivers.com/blog/customising-your-rprofile/)).
    There are other ways to customize the startup environment, including the use of
    command-line options and environment variables. See `help(Startup)` and appendix
    B in the “Introduction to R” manual ([http://cran.r-project.org/doc/manuals/R-intro.pdf](http://cran.r-project.org/doc/manuals/R-intro.pdf))
    for more details.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想给你的 .Rprofile 文件加速，可以看看 Jumping Rivers 的 `rprofile` 包（[https://www.jumpingrivers.com/blog/customising-your-rprofile/](https://www.jumpingrivers.com/blog/customising-your-rprofile/)）。还有其他方法可以自定义启动环境，包括使用命令行选项和环境变量。更多详情请参阅“R
    简介”手册中的 `help(Startup)` 和附录 B（[http://cran.r-project.org/doc/manuals/R-intro.pdf](http://cran.r-project.org/doc/manuals/R-intro.pdf)）。
