- en: 8 Testing and selection
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 8 测试和选择
- en: 'This chapter covers:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖：
- en: Structuring testing environments, then migrating code and artifacts to them
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结构化测试环境，然后将代码和工件迁移到其中
- en: Measuring the properties of models
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测量模型的属性
- en: Understanding how to test ML-discovered models offline and online
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解如何离线和在线测试机器学习发现的模型
- en: Understanding how the test results can be used to select models
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解如何使用测试结果来选择模型
- en: Using qualitative evaluation and selection and quantitative measures
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用定性评估和选择以及定量措施
- en: Avoiding deceptive traps when evaluating your models
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 避免在评估模型时陷入欺骗陷阱
- en: So far in sprint 2, the team designed the model to be developed using their
    understanding of the data, the client’s challenges and context, and the application
    that they expect to build. They’ve used a structured process to develop the model
    and tracked their progress using an experiment tracker and a model repository.
    They’ve also applied their common sense and experience to find and reject models
    that are suspicious or problematic. It’s important now to make sense of the model’s
    outcome and to properly evaluate competitor models to make good choices about
    the models that they take into production and application development.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，在第二阶段冲刺中，团队根据他们对数据的理解、客户的挑战和背景以及他们期望构建的应用，设计了要开发的模型。他们使用了一个结构化的流程来开发模型，并使用实验跟踪器和模型存储库跟踪他们的进度。他们还运用了他们的常识和经验来寻找和拒绝可疑或存在问题的模型。现在，理解模型的成果并正确评估竞争对手的模型，以做出关于将投入生产和应用开发的模型的良好选择，是非常重要的。
- en: Testing is a systematic and discrete process of model evaluation. This process
    provides comprehensible data and the evidence that the team can use to make a
    better choice about what model to use in the next step, selection. *Selection*
    is the process of consuming the data and the evidence and using it to make a deliberate
    and clear decision about their model (or models) that can be justified to end
    users, explained to stakeholders, and audited by regulators. You need to understand
    the appropriate processes for testing and selection, and why the team needs to
    use them. With this knowledge, you can make some good choices with the team about
    what should be done in this phase of the project. Let’s dive in!
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 测试是一个系统化和离散的模型评估过程。这个过程提供了可理解的数据和证据，团队可以使用这些数据来在下一步的选择中做出更好的决策，即选择。*选择*是消耗数据和证据并利用它们来做出明确和清晰的决策的过程，这些决策可以向最终用户证明，向利益相关者解释，并接受监管机构的审计。你需要了解测试和选择的适当流程，以及为什么团队需要使用它们。有了这些知识，你就可以与团队一起做出一些关于项目这一阶段应该做什么的良好选择。让我们深入探讨吧！
- en: 8.1 Why test and select?
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.1 为什么需要测试和选择？
- en: You might be asking why a separate test and selection process, given that the
    data scientists in the development team have already determined which models they
    think are the best candidates for implementation? What is the purpose of carrying
    out the processes laid out in this chapter?
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会问，既然开发团队的数据科学家已经确定了他们认为最适合实施的模型，为什么还需要一个单独的测试和选择流程？本章中阐述的过程的目的是什么？
- en: A rigorous evaluation is essential for creating confidence in the performance
    of the models to be deployed, but it’s time-consuming and expensive to really
    evaluate a model and compare it to others meaningfully. This means that it’s often
    not productive to embed an evaluation into the data scientists’ workflow when,
    perhaps, 30 generations of models might be conceived and developed in the time
    it takes to do one full evaluation. Coming up with good candidate models is often
    economical in terms of the time and effort required, but to evaluate models properly
    is slow and costly.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 对即将部署的模型进行严格的评估对于建立对其性能的信心至关重要，但真正评估一个模型并与其他模型有意义地比较是耗时且昂贵的。这意味着，当可能需要30代模型在完成一次全面评估的时间内构思和开发时，将评估嵌入到数据科学家的工作流程中往往是不
    productive 的。提出好的候选模型在时间和精力上通常是经济的，但正确评估模型是缓慢且昂贵的。
- en: A good evaluation requires fresh, unseen data, or in some cases, the evaluation
    must take place using a live part of the model’s application. Sometimes, you might
    run out of this kind of data. Other times, you might be experimenting on humans
    in ways that could harm them or cost a company money in lost or upset customers.
    There’s not much that’s more expensive than that! The point being, if you’re running
    a live test, it’s not defensible to run it over the first model that the team
    produces or even over all the subsequent generations of models. You’ve got a limited
    tolerance for failure, so evaluations must be run selectively and wisely.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 一个好的评估需要新鲜、未见过的数据，或者在某些情况下，评估必须使用模型应用的实时部分进行。有时，你可能会用完这类数据。其他时候，你可能会在可能伤害他们或使公司因失去或不满的客户而蒙受经济损失的方式上对人类进行实验。没有比这更昂贵的事情了！重点是，如果你正在进行实时测试，不能在团队产生的第一个模型或所有后续模型上运行它。你对于失败的容忍度是有限的，因此评估必须选择性地、明智地进行。
- en: Bear in mind that a release to a test environment (which has appropriate security
    and access controls) may be required to do an evaluation on the wider data set.
    Managing this release process is slow and expensive, even with the fastest DevOps
    teams. Typically, a high-performing DevOps project runs one or two releases a
    day, and a data scientist with a fast algorithm and even faster machine might
    iterate over four or five models in an hour. This equation might be different
    if the models require computationally expensive training. In that case, the team
    may have had a much more limited scope for experimentation, and there will be
    fewer models to deal with.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，为了对更广泛的数据集进行评估（该环境具有适当的安保和访问控制），可能需要在测试环境中发布。管理这一发布过程既缓慢又昂贵，即使是速度最快的DevOps团队也是如此。通常，一个表现优异的DevOps项目每天运行一到两个发布，而一个拥有快速算法甚至更快机器的数据科学家可能在一小时内就能迭代四到五个模型。如果模型需要计算量大的训练，这个等式可能会有所不同。在这种情况下，团队可能进行的实验范围会更加有限，需要处理的模型也会更少。
- en: This chapter presents a picture of the effort that is required to deliver a
    proper evaluation of an ML project. To do that, it’s necessary to describe the
    different testing practices and processes that your team typically needs to apply.
    It’s important to emphasize that you do not need to apply all of these tests in
    each project. You’ll test some projects entirely with offline processes (section
    8.2), and others will rely heavily on online testing (section 8.2.3). It may be
    that the model selection process (section 8.3) is lightweight for some projects.
    Qualitative selection (8.3.3) and calibration (8.3.4) might not come into play
    at all in many of the projects that your team has to deliver.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 本章展示了完成一个ML项目适当评估所需付出的努力。为了做到这一点，有必要描述你的团队通常需要应用的不同测试实践和流程。重要的是强调，你不需要在每个项目中应用所有这些测试。你将完全使用离线流程（第8.2节）测试一些项目，而其他项目将严重依赖在线测试（第8.2.3节）。对于某些项目，模型选择过程（第8.3节）可能非常简单。定性选择（8.3.3）和校准（8.3.4）可能根本不会在许多你团队必须交付的项目中发挥作用。
- en: It is important is that you have a picture of what kind of testing might be
    done and what can work with the people in the team who are focused on it as a
    technical problem. It’s also important that the tests and process are well-documented
    and that they can be reproduced. This can determine how much effort to deploy
    and help make the choice about what testing process to select. The first step
    is to understand the process of testing that’s useful for your project, and that’s
    what’s covered in the next section.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是，你对可能进行的测试类型以及哪些人可以与团队中专注于将其视为技术问题的成员一起工作有一个概念。同样重要的是，测试和流程要有良好的文档记录，并且可以重现。这可以确定需要投入多少努力，并有助于做出选择测试流程的决定。第一步是了解对项目有用的测试流程，这正是下一节要介绍的内容。
- en: 8.2 Testing processes
  id: totrans-17
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.2 测试流程
- en: This section describes different approaches to testing an ML model. Overall,
    the point about these approaches is that test automation and a structured process
    will create confidence and accountability for your models. The evidence that you
    generate in a systematic way will insulate you and the team if there are downstream
    issues with the models, and it will enable documentation to be created that will
    satisfy stakeholders like production engineering teams, operational teams, end
    users, and regulators.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述了测试机器学习模型的不同方法。总的来说，这些方法的要点是测试自动化和结构化流程将为您的模型带来信心和责任。您以系统化方式生成的证据，如果模型在下游出现问题时，将保护您和团队，并能够创建满足生产工程团队、运营团队、最终用户和监管机构等利益相关者的文档。
- en: Let’s reacquaint ourselves with the three sprint 2 tasks for testing our models.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们重新熟悉一下测试我们模型的三个第二阶段任务。
- en: 'Test design ticket: S2.4'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 测试设计票据：S2.4
- en: Implement and commission the test environment.
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实施并启用测试环境。
- en: Determine the process to test the models functionally, including the way that
    you’ll create testing data and how you’ll manage to avoid data leaks.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定测试模型功能的过程，包括您将如何创建测试数据以及您将如何管理避免数据泄露。
- en: 'Test design ticket: S2.5'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 测试设计票据：S2.5
- en: Develop a set of tests to determine the model’s functional performance.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 制定一套测试来评估模型的性能。
- en: Determine the measurements to use over the test scenarios.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定在测试场景中要使用的度量标准。
- en: Design and build an appropriate test environment to support agile and reproducible
    testing.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设计和构建一个合适的测试环境以支持敏捷和可重复的测试。
- en: 'Test design ticket: S2.6'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 测试设计票据：S2.6
- en: Test nonfunctional features.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试非功能性特性。
- en: 8.2.1 Offline testing
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.1 离线测试
- en: Offline testing takes a model and runs it with the data that’s been specially
    collected and reserved for this process. The available data for the project is
    divided into a training set and a test set. These splits are dependent on how
    much data is available to the team and how good it is. For example, you might
    be able to use 70% of the data for training and 30% for testing. The training
    data is further divided into a training set proper, which is shown to the algorithm
    and used to learn the models, and a validation or hold-out set.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 离线测试使用专门收集并保留用于此过程的模型和数据运行。项目可用的数据分为训练集和测试集。这些分割取决于团队可用的数据量及其质量。例如，您可能能够使用70%的数据进行训练，30%的数据进行测试。训练数据进一步分为训练集（用于向算法展示并用于学习模型）和验证集或保留集。
- en: So far, the data scientists in the modelling team have estimated performance
    using hold-out data from the training sets or training stream, which was created
    for the dev environment. In the testing phase of the project, it’s important that
    you test the models using data that wasn’t available to the team during modelling.
    This avoids information from that data leaking into the modelling process. The
    decisions the team made during the iterative processes of model development can
    lead them to optimize the performance of the models from the new data. Because
    they want to get the finest test performance, they should choose algorithms and
    processes that work best on that test data. This, however, doesn’t rule out deceptive
    results when the final testing is done, and this means that when the model goes
    into production, it performs badly. By ensuring that the data in the testing process
    is completely unseen, you can avoid this problem of unconscious optimization.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，建模团队的数据科学家已经使用训练集或训练流中的保留数据来估计性能，这些数据是为开发环境创建的。在项目的测试阶段，使用在建模过程中团队无法获得的数据来测试模型非常重要。这可以避免该数据的信息泄露到建模过程中。团队在模型开发迭代过程中的决策可能导致他们从新数据中优化模型的性能。因为他们想要获得最佳测试性能，所以他们应该选择最适合该测试数据的算法和流程。然而，这并不能排除在最终测试时出现误导性结果，这意味着当模型投入生产时，其表现不佳。通过确保测试过程中的数据完全未见过，您可以避免这种无意识的优化问题。
- en: Cross-validation is an alternative to a simple test/training split. In this
    process, the entire data set is divided into several disjoint test/training sets.
    For a 10-fold cross validation, the data set is split into 10 sets, where nine
    are used to train and one is used to test. For example, table 8.1 uses a data
    set that’s partitioned into eight sets. Set 1 has the test set P1 and a training
    set of P2 through P8\. Set 2 uses P2 as the test set and the other partitions
    (including P1 but excluding P2) as the training set.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 交叉验证是简单测试/训练分割的替代方法。在这个过程中，整个数据集被分成几个不相交的测试/训练集。对于10折交叉验证，数据集被分成10个集合，其中9个用于训练，1个用于测试。例如，表
    8.1 使用的数据集被分成8个集合。集合 1 有测试集 P1 和训练集 P2 到 P8。集合 2 使用 P2 作为测试集，其他分区（包括 P1 但不包括 P2）作为训练集。
- en: Table 8.1 Generating a cross-validation set
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 表 8.1 生成交叉验证集
- en: '|  | P1 | P2 | P3 | P4 | P5 | P6 | P7 | P8 |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '|  | P1 | P2 | P3 | P4 | P5 | P6 | P7 | P8 |'
- en: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- | --- | --- |'
- en: '| Set 1 | **Test** | Train | Train | Train | Train | Train | Train | Train
    |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 集合 1 | **测试** | 训练 | 训练 | 训练 | 训练 | 训练 | 训练 | 训练 |'
- en: '| Set 2 | Train | **Test** | Train | Train | Train | Train | Train | Train
    |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 集合 2 | 训练 | **测试** | 训练 | 训练 | 训练 | 训练 | 训练 | 训练 |'
- en: '| Set 3 | Train | Train | **Test** | Train | Train | Train | Train | Train
    |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| 集合 3 | 训练 | 训练 | **测试** | 训练 | 训练 | 训练 | 训练 | 训练 |'
- en: '| Set 4 | Train | Train | Train | **Test** | Train | Train | Train | Train
    |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 集合 4 | 训练 | 训练 | 训练 | **测试** | 训练 | 训练 | 训练 | 训练 |'
- en: '| Set 5 | Train | Train | Train | Train | **Test** | Train | Train | Train
    |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 集合 5 | 训练 | 训练 | 训练 | 训练 | **测试** | 训练 | 训练 | 训练 |'
- en: '| Set 6 | Train | Train | Train | Train | Train | **Test** | Train | Train
    |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 集合 6 | 训练 | 训练 | 训练 | 训练 | 训练 | **测试** | 训练 | 训练 |'
- en: '| Set 7 | Train | Train | Train | Train | Train | Train | **Test** | Train
    |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| 集合 7 | 训练 | 训练 | 训练 | 训练 | 训练 | 训练 | **测试** | 训练 |'
- en: '| Set 8 | Train | Train | Train | Train | Train | Train | Train | **Test**
    |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| 集合 8 | 训练 | 训练 | 训练 | 训练 | 训练 | 训练 | 训练 | **测试** |'
- en: For each partition, you’ll use the training pipelines to create a model with
    the training set (that means P2, P3,..., P8 for Set 1) and tested with the relevant
    test set (P1 for Set 1, P2 for Set 2, and so on). The performance of each the
    model generated is aggregated and used to create a cross-validated score.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每个分区，您将使用训练管道使用训练集（这意味着集合 1 的 P2、P3、...、P8）创建一个模型，并使用相关的测试集（集合 1 的 P1，集合 2
    的 P2，依此类推）进行测试。每个生成的模型的性能被汇总并用于创建交叉验证分数。
- en: In the extreme case, the test sets can be one example from the overall set with
    every other example used to train the model. For a data set with 1,000 examples,
    you train and evaluate 1,000 models. This is called leave-one-out cross validation
    or *n*-fold cross validation.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在极端情况下，测试集可以是整体集中的一个示例，其余示例用于训练模型。对于一个有1,000个示例的数据集，您将训练和评估1,000个模型。这被称为留一法交叉验证或*n*-折交叉验证。
- en: Cross-validation is an appropriate method when working with simple models and
    small data sets. When training data is sparse, it can estimate the model’s performance,
    created with all the available resources. However, it’s expensive computationally
    when working with complex models and big data sets (or both).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 交叉验证是在处理简单模型和小数据集时的一种合适方法。当训练数据稀疏时，它可以估计使用所有可用资源创建的模型性能。然而，当处理复杂模型和大数据集（或两者兼具）时，计算成本很高。
- en: There is also some resistance to using cross-validation from outside the ML
    community, where it is sometimes perceived as unfounded and unprincipled by hard-core
    statisticians. This is a fair criticism, but in the same way that quite a chunk
    of practice in statistics (such as declaring a value *p* of 0.05 as being significant)
    is unfounded and unprincipled. If you do use cross-validation to provide an evaluation
    metric and are clear about what you are doing, then you are simply presenting
    a transparent fact about a particular result in the selection process. There’s
    nothing wrong with doing that.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 来自机器学习社区之外的一些人反对使用交叉验证，有时他们认为这是没有根据和不合原则的。这是一个公正的批评，但就像统计学中相当一部分实践（例如，将值*p*为0.05宣布为具有显著性）也是没有根据和不合原则的。如果您使用交叉验证来提供评估指标，并且清楚地了解您正在做什么，那么您只是在展示选择过程中的一个特定结果的事实。这样做并没有什么不妥。
- en: Partitioning the data available for testing is just one of the processes required
    to generate repeatable and reliable test outcomes in an offline environment. Implementing
    these processes manually, however, becomes tedious and error-prone. Today’s ML
    projects can require that you evaluate a large number of models, and the burden
    of a poor environment can become unsupportable quickly. If that’s the case, it’s
    worth investing in an automated and robust testing system.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 将可用于测试的数据分区只是生成可重复和可靠的离线环境测试结果所需的过程之一。然而，手动实施这些过程会变得繁琐且容易出错。今天的机器学习项目可能需要评估大量模型，而糟糕的环境可能会迅速变得难以承受。如果是这种情况，投资于自动化和健壮的测试系统是值得的。
- en: 8.2.2 Offline test environments
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.2 离线测试环境
- en: 'In previous chapters, work was done to scope the facilities for the testing
    environment, to determine the extent of the work required to create it, and to
    decide on the approach that needs to be used. The nitty gritty is to now ensure
    that these elements are in service and to use them to move the project forward.
    The actions required are:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们完成了对测试环境设施的规划工作，确定了创建它所需的工作范围，并决定了需要使用的方案。现在，确保这些元素处于服务状态并利用它们推进项目是关键。所需采取的行动包括：
- en: Gain access to the test environment; obtain the credentials and permissions
    needed.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 获取对测试环境的访问权限；获取所需的凭证和权限。
- en: 'Deploy the testing infrastructure to the test environment. This includes:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将测试基础设施部署到测试环境中。这包括：
- en: A data pipeline.
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据管道。
- en: A test harness/mock application.
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试工具/模拟应用程序。
- en: Selected models and associated artifacts for testing.
  id: totrans-55
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于测试的选定模型和相关工件。
- en: Data gathering and feedback collection.
  id: totrans-56
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据收集和反馈收集。
- en: Ensure all the required components are functional (e.g., calibration/smoke test).
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保所有必需的组件都处于功能状态（例如，校准/烟雾测试）。
- en: Run the pipeline to hydrate the environments with data and other required components
    (e.g., initialization weights/transfer models).
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行管道以使用数据和其它所需组件（例如，初始化权重/迁移模型）来激活环境。
- en: Execute the test and gather the results.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 执行测试并收集结果。
- en: This is quite a complex process, and a lot of things could go wrong when going
    through these steps. It’s easy to make a silly mistake, to fail to run the smoke
    tests properly, or to run a pipeline element out of sequence. If that happens,
    then the integrity of the testing is compromised, and doubts will arise. Because
    of this, it’s common nowadays to script or automate the whole process. Let’s look
    at a number of ways to do this.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个相当复杂的过程，在执行这些步骤时可能会出现很多问题。很容易犯愚蠢的错误，无法正确运行烟雾测试，或者管道元素运行顺序错误。如果发生这种情况，测试的完整性就会受损，并会产生怀疑。正因为如此，现在通常会将整个过程脚本化或自动化。让我们看看实现这一目标的一些方法。
- en: You could use a straightforward shell script to copy files and to invoke commands
    on the machine that will run the processes. Because of the complexity of modern
    testing and production environments, and the challenge of managing complex scripting
    processes, this means that using a shared engine for scripting is preferable.
    You can typically share this engine across many different projects with the client,
    and it will become a single well-known point for the client’s architectural teams
    to manage deployments into testing and production.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用简单的shell脚本来复制文件并在将要运行进程的机器上调用命令。然而，由于现代测试和生产环境的复杂性以及管理复杂脚本过程所带来的挑战，这意味着使用共享的脚本引擎是更可取的。你通常可以在与客户的不同项目中共享这个引擎，并成为客户架构团队管理部署到测试和生产环境的单一已知点。
- en: The engine you choose could be Airflow or one of the systems used to implement
    data pipeline DAGs (directed acyclic graphs). Usually, these run the arbitrary
    scripting commands required to invoke infrastructure as code (IaC) or function
    execution to copy files and start executables. Because CI/CD (continuous integration/continuous
    delivery) practices have evolved separately, there are, however, several effective
    and popular tools that you can use as an alternative. This picture is rapidly
    evolving, but currently, GitHub Actions and Jenkins are both potential choices.
    In fact, the client’s organization may mandate one of these as the mechanism for
    promoting a build to test and then on to production.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 你选择的引擎可以是Airflow或用于实现数据管道DAGs（有向无环图）的系统之一。通常，这些系统运行任意脚本命令以调用基础设施即代码（IaC）或函数执行来复制文件和启动可执行文件。由于CI/CD（持续集成/持续交付）实践已经独立发展，因此有几个有效且流行的工具可以作为替代方案。这个领域正在迅速发展，但目前，GitHub
    Actions和Jenkins都是潜在的选择。实际上，客户的组织可能强制要求使用其中之一作为将构建推送到测试环境，然后推送到生产环境的机制。
- en: In most software engineering environments, the test and QA environments are
    segregated from the development and production environment. This is because the
    changes to the software builds can be controlled by the QA team to properly record
    and manage the software elements. In an ML project, it’s also important to consider
    access to the data and models that can be personally confidential or commercially
    sensitive. The extended team probably doesn’t need access to medical records or
    images to test their code, or at least, they may only need a limited set. In the
    worst case, the extended team might post the real medical images to social media
    and land you all in jail. These limitations mean that it can be convenient for
    you to use the partitioned test environment or that it may be necessary to use
    that test environment because it’s the only place that the sensitive data is available.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数软件工程环境中，测试和QA环境与开发和生产环境是隔离的。这是因为软件构建的更改可以由QA团队控制，以正确记录和管理软件元素。在机器学习项目中，考虑对个人保密或商业敏感的数据和模型的可访问性也很重要。扩展团队可能不需要访问医疗记录或图像来测试他们的代码，或者至少他们可能只需要有限的部分。在最坏的情况下，扩展团队可能会将真实的医疗图像发布到社交媒体上，导致你们所有人都会入狱。这些限制意味着使用分区测试环境可能很方便，或者可能有必要使用该测试环境，因为这是唯一可以获取敏感数据的地方。
- en: Based on this, there are three scenarios for test pipeline implementation. Figure
    8.1 illustrates these scenarios. First, in scenario (a), we share the testing
    pipeline across the entire team and use the latest version of the model as part
    of standard integration testing (as any component would be in an CI/CD pipeline).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 基于此，测试管道实现有三种场景。图8.1说明了这些场景。首先，在场景（a）中，我们在整个团队之间共享测试管道，并使用模型的最新版本作为标准集成测试的一部分（就像CI/CD管道中的任何组件一样）。
- en: Second, in scenario (b), we maintain a separate testing pipeline to allow the
    system engineering team to test and release versions of the model to integration
    testing. This pipeline requires artificial data and a dummy model that mocks and
    simulates the behavior of the production model. In this scenario, we maintain
    an integration testing pipeline with confidential data and sensitive models within
    the appropriate security enclave. UI and other supporting code interact with the
    model, feeding it parameters and recovering results from its output for presentation
    to the users.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 第二，在场景（b）中，我们维护一个独立的测试管道，以便系统工程团队能够测试和发布模型的版本进行集成测试。这个管道需要人工数据和模拟生产模型行为的虚拟模型。在这种情况下，我们在适当的网络安全区域内部维护一个包含保密数据和敏感模型的集成测试管道。UI和其他支持代码与模型交互，向其提供参数，并从其输出中恢复结果以向用户展示。
- en: Third, scenario (c) promotes into the confidential test environment from the
    nonconfidential environment for system and integration tests. This is much better
    than our second scenario, option (b), because it allows for more integration testing
    before releasing to production.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 第三，场景（c）将系统测试和集成测试从非保密环境推进到保密测试环境。这比我们的第二个场景，选项（b）要好得多，因为它允许在发布到生产之前进行更多的集成测试。
- en: '![](../Images/08-01.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图8.1](../Images/08-01.png)'
- en: Figure 8.1 Three different flows to production. Option (a) provides a single
    secure environment, where artifacts are promoted from dev to test and then to
    prod. With (b), there is a separate confidential flow that is not accessible from
    some other environments, and components are promoted into prod from both the secured
    and confidential environments. A more desirable setup is (c), where we do integration
    testing after the components are promoted into the confidential environment.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.1 三种不同的生产流程。选项(a)提供了一个单一的安全环境，其中工件从开发到测试，然后到生产。在(b)中，有一个独立的机密流程，无法从某些其他环境中访问，并且组件从受保护的环境和机密环境中提升到生产。更理想的情况是(c)，其中我们在组件提升到机密环境后进行集成测试。
- en: 8.2.3 Online testing
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.3 在线测试
- en: An online test is a live run of the system on a real-world event. In medicine,
    this is the gold standard approach for evaluating the performance of a drug or
    a procedure. In a clinical trial, patients are subjected to a treatment to see
    if it is useful. In some applications, this type of test is desirable because
    the application domain can move so fast that an offline testing campaign builds
    too much latency into the process that an effective model is never collected and
    deployed. In addition, as for medicine, there are domains that are so not amenable
    to an offline test, and the community won’t accept any result that isn’t collected
    in the wild. Let’s look at the three commonly used online testing processes that
    you and your team may want to consider.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在线测试是在真实世界事件上对系统进行的一次实际运行。在医学领域，这是评估药物或程序性能的黄金标准方法。在临床试验中，患者接受治疗以观察其是否有效。在某些应用中，这种测试是可取的，因为应用领域可以发展得非常快，以至于离线测试活动会在过程中引入过多的延迟，导致有效的模型无法收集和部署。此外，正如在医学领域一样，有些领域不适合进行离线测试，社区不会接受任何在野外未收集到的结果。让我们来看看你和你团队可能想要考虑的三个常用的在线测试流程。
- en: 8.2.4 Field trials
  id: totrans-71
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.4 现场试验
- en: The simplest, yet hardest, online test for a model is to be used in a field
    trial. A *field trial* is a managed deployment of the model for a small group
    of users. For example, the model could be trialed for use in one office or department,
    perhaps a small one, or perhaps one that has a friendly and tech-savvy team. Generally,
    consider the trial for a place where the model has the highest chance of success
    and also the least chance of causing a disaster.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 对于模型来说，最简单但也是最难的在线测试是在现场试验中使用。*现场试验*是对一小群用户进行模型的有管理部署。例如，模型可能被试验用于一个办公室或部门，可能是一个小部门，或者是一个友好且技术熟练的团队。通常，考虑在模型成功可能性最高且灾难发生可能性最低的地方进行试验。
- en: 'The team is expected to closely monitor the behavior of the model and its trail.
    In some cases, they will need to check and verify every example of the model being
    used to make sure that nothing dangerous happens. Obviously, this version of model
    will need to be scaled up to a production deployment, but the point of the field
    trial is twofold:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 预计团队将密切监控模型及其轨迹的行为。在某些情况下，他们需要检查和验证所使用的模型每一个示例，以确保不会发生任何危险的事情。显然，这个版本的模型需要扩大到生产部署，但现场试验的目的有两个：
- en: To build confidence in the model’s behavior
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了建立对模型行为的信心
- en: To gather detailed information about what it’s doing and how it performs
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了收集关于其行为和性能的详细信息
- en: It’s also important for the team to review the model’s behavior with users and
    to interview the user group to gather feedback on the performance of the model
    from their perspective. The advantage of a field trial is that it provides information
    about a model’s utility, but there are some drawbacks.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 对于团队来说，审查模型的行为并与用户一起讨论，以及采访用户群体以收集他们对模型性能的反馈，也是非常重要的。现场试验的优势在于它提供了关于模型效用信息，但也有一些缺点。
- en: It’s hard to design and deliver field trials that produce convincing results.
    The necessity of choosing a small and contained set of subjects for the trial
    means that the results may not generalize to the other areas of the application
    that are needed in production. The most important drawback of field trials, though,
    is that they are expensive to develop and slow to implement. A field trial can
    add many months to a project’s timeline. For high-value projects, this is fine,
    and the assurance and confidence that a successful field trial provides is what
    you need. Luckily though, even if you can’t afford the expense and time required
    to mount a full field trial, there are other online tests that you can use to
    measure a model’s performance.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 设计和实施产生令人信服结果的现场试验很困难。选择试验中一小部分受控受试者的必要性意味着结果可能无法推广到生产中需要的其他应用领域。然而，现场试验最重要的缺点是它们开发成本高且实施缓慢。现场试验可能为项目的时间表增加数月。对于高价值项目来说，这很好，成功现场试验提供的保证和信心正是你所需要的。幸运的是，即使你负担不起进行全面现场试验的费用和时间，你还可以使用其他在线测试来衡量模型的表现。
- en: 8.2.5 A/B testing
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.5 A/B 测试
- en: An A/B test puts the model into a more constrained production scenario than
    we saw for the field trial. A small, controlled proportion of real cases is presented
    to the model, and the decisions that the model produces are actually used on those
    cases; this is the A population. The outcomes and progression seen in the A cases
    is then compared to the B case. The B cases are all those that haven’t been processed
    using this model. This is like the process used to validate clinical trials, where
    a blind group receives no treatment, or the old treatment, and the outcome of
    the new treatment is used to assess whether it works or not.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: A/B 测试将模型置于比我们看到的现场试验更为受限的生产场景中。一小部分受控的真实案例被呈现给模型，模型产生的决策实际上被用于这些案例；这是 A 组。然后，将
    A 组中看到的成果和进展与 B 组进行比较。B 组是所有尚未使用此模型处理的案例。这就像验证临床试验所使用的流程，其中盲组不接受任何治疗，或接受旧的治疗，而新治疗的结果被用来评估它是否有效。
- en: A huge advantage of A/B testing is that it is a real-world experiment. The data
    is a fresh draw over the domain, and the evaluation criteria is the control. An
    experiment like this provides strong causal information because performance increases
    due to coincidence, optimization, or data leakage are ruled out. The result is
    strongly linked to the real characteristic of the model.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: A/B 测试的一个巨大优势是它是一个现实世界的实验。数据是在领域内的新抽取，评估标准是控制。这样的实验提供了强大的因果信息，因为由于巧合、优化或数据泄露导致的性能提升被排除在外。结果与模型的实际特征紧密相关。
- en: However, A/B testing is problematic in a number of ways. The most obvious problem,
    which can be difficult to overcome, is that often, there is no infrastructure
    in the business process that allows the intervention and implementation required
    to set up and run the tests. Creating the test environment outlined in section
    8.2 is technically or commercially impossible. This can be due to technical limitations
    or to policy restrictions such as security requirements, or it can be due to some
    physical, legal, or ethical barrier that stops the selection of subjects according
    to the test protocol.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，A/B 测试在多个方面存在问题。最明显的问题，可能难以克服，是业务流程中通常没有基础设施来允许进行干预和实施所需的测试设置和运行。创建第 8.2
    节中概述的测试环境在技术上或商业上是不可能的。这可能是因为技术限制或政策限制，例如安全要求，或者可能是因为某些物理、法律或伦理障碍阻止根据测试协议选择受试者。
- en: Even assuming that it is possible to implement A/B testing, it exposes business
    opportunities or transactions to poor treatment (for example, if the new model
    is the best, yet the control group is being short-changed, or if the new model
    is poor, then the exposure group is being short-changed). In the medical domain,
    this challenge is overcome by the ethical considerations of failing to gather
    proper knowledge about the treatment’s performance for the whole population over
    a potentially infinite future. Basically, one half of the people in the experiment
    are sacrificed for the good of everyone else, and without that sacrifice, no progress
    is made. This may be rational and ethical, but persuading a business owner to
    allow an AI team to experiment on her customers can be challenging.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 即使假设可以实施A/B测试，它也会将商业机会或交易暴露于不良待遇之下（例如，如果新模型是最好的，而对照组却受到了不公平的对待，或者如果新模型很糟糕，那么暴露组也受到了不公平的对待）。在医学领域，通过考虑在可能无限的未来中未能收集到关于治疗性能的适当知识这一伦理考量，来克服这一挑战。基本上，实验中一半的人为了其他人的利益而牺牲，没有这种牺牲，就不会有任何进步。这可能是有理有据且符合伦理的，但说服一个企业主允许AI团队对其客户进行实验可能会很具挑战性。
- en: Given that A/B tests are plausible, and the business owners are persuaded of
    its value, this strategy still suffers from the challenge that it can be a slow
    way to gather information about a model. The model evaluation data created with
    an A/B test is compelling. It has high statistical integrity, and it’s typically
    easy to communicate A/B test results to stakeholders. However, it’s expensive
    and challenging to set up A/B tests, and it takes time to run the tests over the
    traffic in the business process. Sometimes, it will be necessary for the A/B test
    to persist across a business cycle, such as a trading day or an operational quarter,
    in order for the model to be exposed to a representative set of examples and conditions.
    Multi-arm bandits are an alternative approach, developed to get over some of these
    challenges.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑到A/B测试是可行的，并且企业主已经相信其价值，这种策略仍然面临着挑战，即它可能是一个缓慢收集模型信息的方式。使用A/B测试创建的模型评估数据非常有说服力。它具有高度的统计完整性，并且通常很容易向利益相关者传达A/B测试的结果。然而，设置A/B测试既昂贵又具有挑战性，并且需要时间在业务流程中的流量上运行测试。有时，A/B测试可能需要在商业周期内持续进行，例如交易日或运营季度，以便模型能够接触到代表性的示例和条件。多臂老虎机是一种替代方法，旨在克服这些挑战之一。
- en: 8.2.6 Multi-armed bandits (MABs)
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.6 多臂老虎机（MABs）
- en: Multi-arm bandits (MAB) [5] aim to be more efficient and cost-effective than
    A/B tests. The underpinning idea is to only test a model when it’s probable that
    something useful will be learned from the test. This means that you can use this
    opportunity to interact with your users to build more efficient models than you
    might have if you ran an A/B test that doesn’t perform as well. A MAB should quicky
    detect that the model is hopeless and limit its usefulness in the live process.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 多臂老虎机（MAB）[5]旨在比A/B测试更高效和成本效益。其基本思想是只有在测试可能从中学习到有用信息的情况下才进行测试。这意味着你可以利用这个机会与你的用户互动，构建比进行表现不佳的A/B测试时可能构建的更有效的模型。一个MAB应该能够快速检测到模型毫无希望，并限制其在实际过程中的有用性。
- en: Imagine a scenario in which you have three processes, and you want to see if
    they will return a reward. One of them frequently gives the reward, one of them
    sometimes gives a reward, and one never gives a reward. Figure 8.2 shows three
    machines and the payouts that they give when you try them.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 想象一个场景，你拥有三个流程，并想知道它们是否会返回奖励。其中一个是经常给予奖励，另一个有时给予奖励，而另一个则从不给予奖励。图8.2展示了三个机器以及当你尝试它们时它们给出的支付。
- en: '![](../Images/08-02.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/08-02.png)'
- en: Figure 8.2 Three one-arm bandits with pay-out records, where each block represents
    one pull. A light record indicates a zero reward, and a dark one indicates a positive
    reward. Machine A pays frequently, Machine B pays occasionally, and Machine C
    never pays.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.2展示了三个单臂老虎机及其支付记录，其中每个方块代表一次拉动。浅色记录表示零奖励，深色记录表示正奖励。机器A经常支付，机器B偶尔支付，机器C从不支付。
- en: Notice that Machine C only has two pay-out records. That’s because both A and
    B produce a reward on the second pull. We know that only one of the machines is
    a dud, and we know that A and B are paying, so why would we want to put more money
    into C?
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，机器C只有两条支付记录。这是因为A和B在第二次拉动时都产生了奖励。我们知道只有一台机器是坏的，而且我们知道A和B是支付奖励的，那么我们为什么还想往C里投入更多钱呢？
- en: The question after the second pull is which of the machines, A or B, pays the
    best? In the figure, on the fourth pull, machine B fails to pay, and on the fifth
    pull, machine A also fails to pay. By the sixth pull, we have 4/6 fails from machine
    B and 2/6 fails from machine A, so we decide to stop putting money into machine
    B. Our decision is vindicated because machine A keeps on paying.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 第二次拉动之后的问题是，哪台机器，A还是B，支付得最好？在图中，第四次拉动时，机器B未能支付，第五次拉动时，机器A也未能支付。到第六次拉动时，我们从机器B那里有4/6次失败，从机器A那里有2/6次失败，因此我们决定停止向机器B投入资金。我们的决定得到了证实，因为机器A一直在支付。
- en: 'It’s easy to see that if you are putting money into different one-armed bandits,
    there comes a point where it stops being sensible to insert money into one machine
    to see just the payout. This is a problem of balancing exploration versus exploitation:
    which machine pays and how much can we get out of it?'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 很容易看出，如果你正在向不同的单臂老虎机投入资金，总会有一个点，投入资金到一台机器去查看支付结果就不再合理。这是一个平衡探索与利用的问题：哪台机器支付，我们能从中获得多少？
- en: 'We can exploit this theory to evaluate an ML model in production or in a controlled
    test, where real users use the system. There are two ways that information about
    the performance of the model can be collected: explicitly and implicitly.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以利用这个理论来评估在生产环境中或在受控测试中使用的机器学习模型。关于模型性能的信息可以通过两种方式收集：显式和隐式。
- en: An example of explicit feedback is the frequency of purchase of a recommended
    item by a customer. If the customer selects the items recommended by one model
    more frequently, that is a good signal that this model is more effective. The
    explicit aim of the recommender is to create sales, and we can measure the outcome
    more or less directly.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 显式反馈的一个例子是客户购买推荐商品的频率。如果客户更频繁地选择一个模型推荐的商品，那么这是一个很好的信号，表明这个模型更有效。推荐系统的明确目标是创造销售，我们可以或多或少直接地衡量结果。
- en: In contrast, an implicit mechanism (sometimes called a proxy measurement) is
    something like the amount of time a user spends browsing a website. One reading
    about spending time on the site is that the user is enjoying consuming the content
    they are engaging with. Alternatively, it could be the case that the user is frustrated
    and can’t find the content they require. In this case, the available feedback
    gives an indication of the success of the model but doesn’t directly measure it.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 相比之下，隐式机制（有时称为代理测量）类似于用户在网站上花费的时间量。关于在网站上花费时间的阅读是，用户正在享受他们所参与的内容的消费。或者，也可能用户感到沮丧，找不到他们需要的内容。在这种情况下，可用的反馈提供了关于模型成功与否的指示，但并不直接测量它。
- en: Once the mechanism of measuring performance is clear, then you need a method
    to make use of it. A large and systematic literature provides algorithms that
    make optimal choices about when to abandon a particular model (or bandit) [3].
    The epsilon family of simple approximate approaches is an easy and effective way
    to implement a bandit-style online evaluation system [4]
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦性能测量的机制变得清晰，那么你需要一种方法来利用它。大量的系统文献提供了算法，这些算法关于何时放弃特定模型（或老虎机）做出最优选择[3]。ε家族的简单近似方法是一种简单而有效的方法来实现老虎机风格的在线评估系统[4]。
- en: The simplest basic epsilon algorithm tracks the performance of all the machines
    and selects the best one 90% of the time (90% / 0.9 is the epsilon, ε), and then
    chooses a different one as an exploratory test 10% of the time (1 − ε). This can
    be refined by specifying several trials before ε is set to 1 or by specifying
    a decay factor that adjusts ε at every trial (for example, ε ^(’ )= 0.99 * ε).
    The advantage of this strategy and the more complex epsilon strategies is that
    they are intuitive, easy to compute, and yield results with low probability of
    error (choosing the wrong model) at relatively low cost (not many experiments
    with bad models).
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单的ε基本算法跟踪所有机器的性能，90%的时间选择表现最好的机器（90% / 0.9是ε，ε），然后10%的时间选择一个不同的机器作为探索性测试（1
    − ε）。这可以通过在ε设置为1之前指定几个试验来细化，或者通过指定一个衰减因子来调整每次试验中的ε（例如，ε^(‘)= 0.99 * ε）。这种策略和更复杂的ε策略的优势在于它们直观、易于计算，并且以相对较低的成本（不是很多与不良模型进行的实验）产生低错误概率（选择错误模型）的结果。
- en: As the model evaluator, there are big differences between what a test with MABs
    will tell you and what an old-fashioned evaluation on a fresh test set or an A/B
    test will produce. Setting up a MAB system for testing an ML algorithm gives strong
    evidence that one of the algorithms being tested is more successful than the others,
    but it will not provide useful quantification of how much better.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 作为模型评估者，使用多臂老虎机（MABs）进行的测试与在新鲜测试集或A/B测试上进行的老式评估之间存在很大差异。为测试机器学习（ML）算法设置MAB系统提供了强有力的证据，表明正在测试的算法之一比其他算法更成功，但它不会提供关于这种优势多少的有用量化。
- en: MABs can be seen as ML algorithms in that they learn which machine (or oracle)
    is best, and they can be formulated in such a way as to select models dynamically
    as the domain changes. Although MABs won’t arm a model selection team with statistics,
    they do function with a great deal of integrity. A MAB-based test is not susceptible
    to information leakage, and it’s hard for a team to end up kidding themselves
    about the power of the model in the face of its performance and against defaults
    or well-tested incumbent solutions. Either the innovative model wins and comes
    to dominate in the system, or it will be crowded out by the disappointingly traditional
    but effective alternative.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 多臂老虎机（MABs）可以被视为机器学习算法，因为它们学习哪个机器（或预言者）最好，并且可以以这种方式制定，以便随着领域的变化动态选择模型。尽管MABs不会为模型选择团队提供统计数据，但它们确实具有很高的完整性。基于MAB的测试不易受到信息泄露的影响，并且团队很难在面对模型性能、默认或经过充分测试的现有解决方案时欺骗自己关于模型的力量。要么创新模型获胜并在系统中占据主导地位，要么它将被令人失望但有效的传统替代方案所取代。
- en: 8.2.7 Nonfunctional testing
  id: totrans-99
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.2.7 非功能性测试
- en: The nonfunctional properties of the models are obvious test targets, and the
    results of these tests can heavily influence model selection. Highly functional
    models (the ones that do well on function tests) that fail the nonfunctional requirements
    of the client will probably get trashed. Nonfunctionals in ML systems are of interest
    because ML models typically run millions or tens of millions of times and are
    often invoked in line with time-critical processes in user interfaces. Expensive
    ML models can cost you a lot quickly, and slow ML models can annoy all your users.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 模型的非功能性特性是明显的测试目标，这些测试的结果可以极大地影响模型选择。那些在功能测试中表现良好的高度功能性模型（即表现良好的模型）如果未能满足客户非功能性需求，可能会被废弃。在机器学习系统中，非功能性需求值得关注，因为机器学习模型通常运行数百万或数千万次，并且经常与用户界面中时间敏感的过程一起调用。昂贵的机器学习模型可能会迅速消耗你的资源，而缓慢的机器学习模型可能会让所有用户感到烦恼。
- en: 'One example of work looking at this subject highlights some useful nonfunctional
    properties to test [2]. Testability, data access, flexibility, and integrity are
    among the requirements uncovered in the paper. Habibullah and Horkoff note [2]:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 研究这一主题的一个例子突出了一些有用的非功能性特性进行测试[2]。测试性、数据访问、灵活性和完整性是论文中发现的几个要求。Habibullah和Horkoff指出[2]：
- en: '...indicate that both engineers and customers lack knowledge and expertise
    in regards to NFRs for ML. There are a lack of documentation, methods, and benchmarks
    to define and measure NFRs for ML-enabled software.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: '...表明工程师和客户在机器学习非功能性需求（NFRs）方面缺乏知识和专业知识。缺乏文档、方法和基准来定义和衡量机器学习软件的非功能性需求。'
- en: 'You and the team collected nonfunctional requirements at the pre-project/presales
    phase. Nonfunctional requirements include:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在项目/预售阶段，你和团队收集了非功能性需求。非功能性需求包括：
- en: '*Latency:* How long it takes for an instance of the model to run before returning
    a result.'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*延迟*：模型实例运行并返回结果所需的时间。'
- en: '*Throughput:* How many model execution episodes can be run in a certain period
    on the available hardware. This is different from the latency period for several
    reasons:'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*吞吐量*：在特定时间段内在可用硬件上可以运行多少个模型执行场景。这不同于延迟期，原因有几个：'
- en: It may be that the models have a cold start and are slow on the first execution.
  id: totrans-106
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可能是模型在第一次执行时启动较慢。
- en: It may be that highly parallel hardware is available to run the models on, so
    even if a single model can only execute one episode per second, ten models running
    in parallel can have a throughput of nine or so.
  id: totrans-107
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可能存在高度并行的硬件来运行模型，因此即使单个模型每秒只能执行一个场景，十个并行运行的模型也能达到大约九个的吞吐量。
- en: '*Memory footprint:* Modern ML models can be large and may require expensive
    fast memory to run. Determining the size of models is important in determining
    if they can be feasibly deployed.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*内存足迹:* 现代机器学习模型可能很大，并且可能需要昂贵的快速内存来运行。确定模型的大小对于确定它们是否可以实际部署很重要。'
- en: '*Cost:* Models that require the use of licensed subcomponents can be expensive.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*成本:* 需要使用许可子组件的模型可能很昂贵。'
- en: '*Carbon impact:* Running some models creates a big carbon footprint.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*碳足迹:* 运行某些模型会产生很大的碳足迹。'
- en: Of the nonfunctionals listed, memory footprint and cost are the easiest to evaluate.
    There should be no difficulty in creating an inventory of components and their
    scale. Latency and throughput measures are only accurate in test harnesses that
    mirror production conditions.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在列出的非功能性度量中，内存足迹和成本最容易评估。创建组件及其规模的清单应该没有困难。延迟和吞吐量度量仅在反映生产条件的测试工具中才是准确的。
- en: It may be that the relative performance of your model is informative enough
    to influence your decision making. You and the client must be aware, though, that
    there is substantial risk with this approach. Models can behave in unexpected
    ways on new hardware, so beware of relying on parallelism scaling in a linear
    way. It’s common for bottlenecks downstream in the model-serving system, which
    may cause a scaling system to stall. Even prosaic issues such as power supply
    limitations or overheating in the server rack supporting the system can choke
    high performance. For this reason, sustained testing on realistic hardware is
    the only way to ensure that your system is going to perform as well as you need
    it to.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 您的模型的相对性能可能足以影响您的决策。然而，您和客户必须意识到，这种方法存在重大风险。模型在新硬件上可能会以意想不到的方式表现，因此请警惕不要依赖于线性扩展并行性。在模型服务系统中，下游瓶颈很常见，这可能导致扩展系统停滞。即使是像电源限制或服务器机架过热等平凡问题也可能导致高性能受限。因此，在现实硬件上进行持续测试是确保您的系统按您所需的方式运行的唯一方法。
- en: The carbon footprint is even harder to test and measure. There are instrumentation
    mechanisms for code and systems that you can use for this purpose ([https://codecarbon.io/](https://codecarbon.io/)).
    Unfortunately, an ML model in production generally has lots of components like
    databases, network interfaces, and accelerators, which may not be covered by a
    particular type of instrumentation. This can lead to pathological situations,
    where the team optimizes code to be low-carbon intensity by offloading processing
    to subsystems that are more inefficient but not inside the instrumentation.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 碳足迹的测试和测量甚至更困难。您可以使用代码和系统的仪器机制来达到这个目的 ([https://codecarbon.io/](https://codecarbon.io/))。不幸的是，生产中的机器学习模型通常有很多组件，如数据库、网络接口和加速器，这些可能不会被特定类型的仪器覆盖。这可能导致病态情况，团队通过将处理卸载到效率更低但不在仪器内部的子系统来优化代码以降低碳强度。
- en: The functional measures created and obtained in the offline or online testing
    of the models and the nonfunctional measurement discussed in this section provide
    information about which models you should select and use. A decision is still
    to be made using this information, though, and making that decision is the topic
    of the next section.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在模型离线或在线测试中创建和获得的功能性度量以及本节讨论的非功能性度量提供了关于您应该选择和使用哪些模型的信息。尽管如此，仍需使用这些信息做出决定，而做出这个决定是下一节的主题。
- en: 8.3 Model selection
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.3 模型选择
- en: 'Model selection ticket: S2.10'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 模型选择票：S2.10
- en: Use model evaluation data to determine the models to used.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用模型评估数据来确定要使用的模型。
- en: Use an explicit mechanism to use the model test/evaluation data to choose the
    models that are to be used in production.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用显式机制来使用模型测试/评估数据来选择要在生产中使用的模型。
- en: Account for how the models will be combined in your decision.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑模型在您的决策中将如何结合。
- en: Account for nonfunctional requirements.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑非功能性需求。
- en: Account for qualitative aspects of the models.
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑模型的质量方面。
- en: 'Model selection ticket: S2.11'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 模型选择票：S2.11
- en: Determine and document model selections.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定并记录模型选择。
- en: 'Model selection ticket: S2.12'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 模型选择票：S2.12
- en: Review and obtain customer sign-off on model selection.
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 审查并获得客户对模型选择的批准。
- en: Testing and evaluation create information on model performance; however, this
    information needs to be used to determine which model to employ. In the good old
    days, it was straightforward to choose a single model, employed in a well understood
    context; the model that got the highest results won! Now, ML models are often
    employed in complicated systems and configurations, and selecting which model
    based on the result of a single test is rarely appropriate. Instead, all the information
    about the performance of the model must be generated, gathered, and then synthesized
    into a decision. The stakeholders deploying the system need to understand why
    you choose these components, so you document why the choices made are appropriate
    and how the choices were made. Whereas the previous parts of this chapter discussed
    how testing results can be generated and gathered, this section looks at how the
    resulting information can be synthesized into a decision.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 测试和评估为模型性能提供了信息；然而，这些信息需要用来确定要使用哪个模型。在过去的美好时光里，选择一个单一模型，在理解良好的环境中使用，是直截了当的；结果最好的模型就赢了！现在，机器学习模型通常被应用于复杂的系统和配置中，仅基于单一测试的结果来选择模型很少是合适的。相反，必须生成、收集关于模型性能的所有信息，并将其综合成一个决策。部署系统的利益相关者需要了解你为什么选择这些组件，因此你需要记录为什么做出的选择是合适的以及如何做出这些选择。而本章的前几部分讨论了如何生成和收集测试结果，本节将探讨如何将这些信息综合成一个决策。
- en: 'We now have three types of information. First, we accumulated a set of results
    from the testing episodes, and second, we have information about the testing mechanism
    and practice. Finally, we have information on the requirements of our system.
    With this information, we can determine the qualities of the model according to
    the testing results, decide on the quality and informativeness of those results,
    and then rule on the significance of each result. The synthesis of this information
    into a decision or recommendation about which model to use (or not to use) can
    be facilitated by a number of different tools. There are two fundamental approaches:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有三种类型的信息。首先，我们从测试事件中积累了一系列结果，其次，我们有关于测试机制和实践的信息。最后，我们有关于我们系统需求的信息。有了这些信息，我们可以根据测试结果确定模型的质量，决定这些结果的质量和信息量，然后判断每个结果的重要性。将这些信息综合成一个关于使用（或不使用）哪个模型的决策或建议可以通过多种不同的工具来实现。有两种基本方法：
- en: We can aggregate the information quantitatively to satisfy some notion of which
    model is optimal.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以定量地汇总信息，以满足某种关于哪个模型最优的观念。
- en: We can use an administrative/qualitative process to qualify a model from a pool
    as appropriate for use.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们可以使用行政/定性过程来从一组模型中筛选出适合使用的模型。
- en: It is extremely likely that you will need to use both processes. Quantitative
    data can be employed to produce promising candidates for qualitative selection.
    What is important is that the information and process used for selection is carefully
    assembled and recorded—the approach that you and the team decide is the appropriate
    one for your project must be explicitly documented and used to make your decision.
    In this way, you will be able to transparently account for the behavior of the
    model in production because you will have a high integrity answer for the question
    of why did you put that model there to do that?
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 非常可能你需要同时使用这两种过程。定量数据可以被用来产生适合定性选择的候选者。重要的是，用于选择的资料和过程必须仔细汇编并记录——你和团队决定的项目中适当的方案必须明确文档化并用于做出决策。这样，你将能够透明地解释模型在生产中的行为，因为你将有一个高完整性的答案来回答为什么你放置那个模型去执行那个任务？
- en: 8.3.1 Quantitative selection
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.1 定量选择
- en: Quantitative selection is the process of combining the measurements from different
    testing events to create a single, aggregate measure, and then choosing the model
    to be used based on that measure. In this section, we’ll look at three distinct
    scenarios for making your choice, based on the tests that have been developed
    to evaluate the models.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 定量选择是将不同测试事件中的测量结果结合起来创建一个单一、汇总的度量，然后根据该度量选择要使用的模型的过程。在本节中，我们将探讨基于已开发的评估模型测试的三种不同场景来做出选择。
- en: 8.3.2 Choosing With Comparable Tests
  id: totrans-133
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.2 基于可比测试的选择
- en: 'When models are evaluated using several comparable tests, you can use straightforward
    aggregations to combine test results and make a choice. Let’s take the case of
    a model that is to make offers or recommendations to people in many countries.
    In this scenario, the consumers of interest are young adults, aged 18-25\. You
    can query 40 countries to create a panel of several hundred test cases, building
    two data sets of 40 data points each. Each data point is the success of a model
    in a particular country. Each country is equally important to the customer. Here’s
    the dilemma: model A performs well on some of the data points, as does model B.
    Which should be selected for global use?'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用几个可比较的测试来评估模型时，你可以使用简单的聚合来组合测试结果并做出选择。让我们以一个要向许多国家的人提供报价或推荐的建议模型为例。在这种情况下，感兴趣的消费者是18-25岁的年轻人。你可以查询40个国家来创建一个包含数百个测试案例的样本组，构建两个包含40个数据点的数据集。每个数据点是模型在特定国家的成功情况。每个国家对客户来说都同等重要。这里有一个困境：模型A在部分数据点上表现良好，模型B也是如此。哪个应该被选为全球使用？
- en: If, as in this case, the choice is made over two populations of results, generated
    by only two models, it can be simple to decide which model to use. Find the mean
    performances and the standard deviations, then calculate in terms of expectation
    how distant the performance of the models over the tests is.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 如果，像在这个例子中，选择是在由仅两个模型生成的两个结果群体之间进行，那么决定使用哪个模型可能很简单。找到平均性能和标准偏差，然后根据期望计算模型在测试中的性能差异。
- en: If there is low expectation that the models can perform at the same level, then
    this is a clear indicator that a real performance difference exists, and a good
    basis for choosing one over the other is established, especially if the expectation
    goes two ways. If model A’s mean performance is several standard deviations of
    A’s results from model B’s mean performance and also several standard deviations
    of B’s results distant, then both A and B are producing clearly differentiated
    outcomes. The model that is functioning best overall is the rational choice. If,
    on the other hand, model A has a better mean score, but the standard deviation
    of model B’s results includes model A’s mean, then it is obviously possible that
    no real difference between A and B exists.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 如果对模型能够以相同水平表现有低期望，那么这是一个明确的指标，表明存在真正的性能差异，并且为选择一个而不是另一个建立了良好的基础，特别是如果期望是双向的。如果模型A的平均性能与模型B的平均性能相差几个标准偏差，并且B的结果也远离B的平均性能，那么A和B都在产生明显区分的结果。整体表现最好的模型是合理的选择。另一方面，如果模型A的平均得分更高，但模型B的结果的标准偏差包括模型A的平均值，那么显然可能不存在A和B之间的真正差异。
- en: 'These decisions can be framed in Bayesian terms as well: see if the samples
    of model A’s performance and model B’s performance come from the same distribution.
    If the expectation that model B’s mean performance is rarely achieved by a subset
    of model A’s results, then model B is likely to be superior to model A. Conversely,
    if there are common permutations of model A’s results that achieve the same performance
    as model B, perhaps the testing is inconclusive.'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 这些决策也可以用贝叶斯术语来表述：看看模型A的性能样本和模型B的性能样本是否来自同一分布。如果期望是模型B的平均性能很少由模型A的结果子集实现，那么模型B可能优于模型A。相反，如果模型A的结果有共同排列，可以达到与模型B相同的性能，那么测试可能没有结论。
- en: The level of surprise that you require to be convinced that models A and B really
    are different is a matter for you to decide. In general, people choose to believe
    that if 95% of the time the samples drawn from the distribution of model A and
    model B are different, then that means that we should believe that model A and
    model B have different distributions, and therefore, the models have different
    behaviors.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要多少惊喜程度才能确信模型A和模型B确实不同，这是一个由你决定的问题。一般来说，人们会选择相信，如果95%的时间里从模型A和模型B的分布中抽取的样本是不同的，那么这意味着我们应该相信模型A和模型B有不同的分布，因此，模型有不同的行为。
- en: With this use case, however, there are problems. The populations of each country
    may be different, as well as the economy and the demographic distributions in
    each country. Sometimes, it’s possible to use normalization to handle this. In
    the case of the multi-country comparison, this would probably be acceptable for
    something like e-commerce. However, in comparing something like epidemic prevalence
    or the performance of different vaccines, it might be hard to confidently say
    that normalization and direct comparison are safe ways to deal with this data
    and then to make inferences. If so, or if the tests are more obviously different
    and incomparable, then we need different approaches to combining the information
    from the tests into a decision.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，使用这个用例时，也存在问题。每个国家的群体可能不同，以及每个国家的经济和人口分布。有时，可以使用归一化来处理这个问题。在多国比较的情况下，这可能对于像电子商务这样的东西是可接受的。然而，在比较像流行病流行率或不同疫苗的性能时，可能很难自信地说归一化和直接比较是处理这些数据并做出推论的安全方式。如果是这样，或者如果测试更明显地不同且不可比较，那么我们需要不同的方法来将测试信息汇总到决策中。
- en: 8.3.3 Choosing with many tests
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.3 使用多个测试进行选择
- en: How multiple measurements are aggregated has the potential to influence the
    selections made. It’s both natural (and likely) that the testing program you’ve
    come up with yields different measures of performance. For example, if you create
    a separate test set of hard-but-important examples, then generate a simple aggregate
    for the performance of the models, performance on run-of-the-mill data would nullify
    the whole point of doing that in the first place.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 多次测量的汇总方式可能会影响所做的选择。你提出的测试计划产生不同的性能指标是自然而然的（也可能是必然的）。例如，如果你为硬而重要的例子创建一个单独的测试集，然后简单地汇总模型的性能，那么在普通数据上的性能就会使最初做这件事的意义化为乌有。
- en: This problem has been extensively studied in many domains and is known as *multi-criteria
    decision making* [6]. There are many approaches that you could use to aggregate
    diverse and incomparable test results. None of which are definitively the “right”
    choice, but all of which have different strengths that might make them the best
    selection in each scenario. One approach is to use a weighted function to prioritize
    and favor particular members of the test result vector over the others. In plain
    terms, a decision is made that a certain percentage of the overall score for a
    model comes from one test, another percentage comes from a second test, and so
    on, until 100% of the measure is allocated.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 这个问题在许多领域都得到了广泛研究，被称为*多标准决策制定* [6]。你可以使用许多方法来汇总不同且不可比较的测试结果。没有哪一种方法可以肯定是“正确”的选择，但每种方法都有不同的优势，可能在每种情况下都是最佳选择。一种方法是用加权函数来优先考虑并偏袒测试结果向量中的特定成员。简单来说，决定一个模型的总体分数中，一定比例来自一个测试，另一部分来自第二个测试，依此类推，直到100%的指标被分配。
- en: In the example of the hard-but-important (hbi) items versus the example of the
    run-of-the-mill (rotm) data, the choice might be to allocate 50/50\. Let’s say
    there are 200 carefully selected hbi’s and 200,000 rotm’s used in the test set,
    but we weight each hbi as being 1,000 times more important to the selection of
    a model than a rotm. There are problems with this approach, however. The weighting
    selected is arbitrary and hard to explain post hoc. A small change in the hbi
    performance overwhelms a larger change in rotm, and this is by design. On the
    other hand, once you go past two or three measures, it becomes hard to discern
    the source of the model’s performance in the comparison.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在硬而重要（hbi）项目与普通数据（rotm）的例子中，选择可能是50/50。假设测试集中使用了200个精心挑选的hbi和200,000个rotm，但我们把每个hbi的重要性视为rotm的1,000倍，对于模型选择来说。然而，这种方法存在一些问题。选定的权重是任意的，事后难以解释。hbi性能的微小变化会超过rotm的较大变化，这是有意为之。另一方面，一旦超过两三个指标，就很难辨别模型性能比较中的来源。
- en: More sophisticated methods of allocating weight to the different components
    can help. For example, we can define a function that variously allocates weights
    on a more rigorous basis by choosing some optimal allocation and working backward
    or that provides a weighting based on linguistic descriptions of how the balance
    should work. Sometimes these approaches provide good results or clear explanations,
    but often they add yet another layer of mysticism into the process.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 更复杂的分配权重方法可以帮助。例如，我们可以定义一个函数，根据某些最优分配在更严格的基础上分配权重，或者根据对平衡如何工作的语言描述提供权重。有时这些方法可以提供良好的结果或清晰的解释，但通常它们会在过程中增加另一层神秘感。
- en: A popular alternative is to combine rankings of performance rather than the
    raw outcomes. Returning to a simple hbi and rotm scenario, let’s take five models
    and compare them with this lens. Table 8.2 shows the results of this comparison.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 一种流行的替代方案是将性能排名而不是原始结果结合起来。回到简单的hbi和rotm场景，让我们用这个视角比较五个模型。表8.2显示了这次比较的结果。
- en: Table 8.2 Comparing five models with aggregate rankings
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 表8.2 比较五个模型的综合排名
- en: '| Model | hbi (raw) | hbi (rank) | rotm (raw) | rotm (rank) | Aggregate | Rank
    |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| 模型 | hbi（原始） | hbi（排名） | rotm（原始） | rotm（排名） | 综合得分 | 排名 |'
- en: '| --- | --- | --- | --- | --- | --- | --- |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- | --- |'
- en: '| A | 171/200 | 3 | 175342/200000 | 2 | 5 | 3 |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| A | 171/200 | 3 | 175342/200000 | 2 | 5 | 3 |'
- en: '| B | 167/200 | 4 | 172811/200000 | 4 | 8 | 4 |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| B | 167/200 | 4 | 172811/200000 | 4 | 8 | 4 |'
- en: '| C | 132/200 | 5 | 135241/200000 | 5 | 10 | 5 |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| C | 132/200 | 5 | 135241/200000 | 5 | 10 | 5 |'
- en: '| D | 173/200 | 2 | 181122/200000 | 1 | 3 | 1 |'
  id: totrans-152
  prefs: []
  type: TYPE_TB
  zh: '| D | 173/200 | 2 | 181122/200000 | 1 | 3 | 1 |'
- en: '| E | 190/200 | 1 | 175301/200000 | 3 | 4 | 2 |'
  id: totrans-153
  prefs: []
  type: TYPE_TB
  zh: '| E | 190/200 | 1 | 175301/200000 | 3 | 4 | 2 |'
- en: Looking at the results, model D is the winner! It ranks second in the hbi test
    and first in the rotm test, while model E was first for hbi but third for rotm.
    Using a 50/50 weighting on model E yields 365,301 vs. 354,122 for model D, so
    with that, we would have selected method E. A ranking aggregate is not intrinsically
    better, but it yields results that are intuitively understood by stakeholders,
    and it tends to be more useful the more independent tests that you must combine.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 观察结果，模型D是赢家！它在hbi测试中排名第二，在rotm测试中排名第一，而模型E在hbi测试中排名第一，但在rotm测试中排名第三。对模型E使用50/50的权重，得到365,301与模型D的354,122相比，所以我们会选择方法E。排名综合并不是本质上更好，但它产生的结果是利益相关者可以直观理解的，并且当你必须组合更多独立测试时，它通常更有用。
- en: As an alternative to aggregating rankings as in table 8.2, it’s sometimes possible
    to use the idea of Pareto optimality to make decisions about model selection.
    A Pareto efficient set of models is the set that contains all the models that
    have the best outcome under one measure. Where there is a draw (several models
    with the same or broadly similar performance under one test), the model that has
    the best performance in other dimensions is chosen.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 作为表8.2中综合排名的替代方案，有时可以使用帕累托最优性的概念来做出模型选择的决策。一组帕累托有效的模型是包含所有在一个度量下具有最佳结果的模型的集合。在有平局（在某个测试下几个模型具有相同或广泛相似的性能）的情况下，选择在其他维度上表现最好的模型。
- en: In figure 8.3, we see some results from imaginary models evaluated with respect
    to the hbi and rotm test sets. The area inside the dotted lines contains the Pareto
    front for the models. All models in this area have one of the best tradeoffs between
    hbi and rotm that we have found. Note that model F is in the Pareto set but model
    G isn’t because it’s neither as good at hbi or as good at rotm as model F. That
    double whammy knocks it out of consideration.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在图8.3中，我们可以看到使用hbi和rotm测试集评估的想象模型的一些结果。虚线内部包含模型的帕累托前沿。这个区域内的所有模型在hbi和rotm之间的权衡都是我们找到的最佳权衡之一。请注意，模型F在帕累托集中，但模型G不在，因为它在hbi或rotm方面都不如模型F好。这种双重打击使其无法被考虑。
- en: '![](../Images/08-03.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/08-03.png)'
- en: Figure 8.3 A Pareto front for models evaluated from the hard-but-important (hbi)
    and run-of-the-mill (rotm) data sets
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.3 从硬而重要（hbi）和普通（rotm）数据集评估的模型的帕累托前沿
- en: We can use Pareto sets and Pareto fronts to create sets of Pareto optimal candidates
    versus many different tests, not just two, yet Pareto sets still leave room for
    more decision making. Creating a Pareto set narrows the candidates, but it still
    often leaves a choice to be made between set members.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用帕累托集和帕累托前沿来创建与许多不同测试的帕累托最优候选集，而不仅仅是两个，但帕累托集仍然为更多的决策留下了空间。创建帕累托集缩小了候选范围，但它仍然经常需要在集合成员之间做出选择。
- en: 8.3.4 Qualitative selection measures
  id: totrans-160
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 8.3.4 定性选择措施
- en: 'In the introduction to this chapter, some the qualitative metrics from the
    literature were identified. These included:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章的引言中，确定了一些来自文献的定性指标。这些包括：
- en: '*Model security:* Can the model be tricked or attacked intelligently? Can knowledge
    of the way that it works be abused? A good example of this is the way that a small
    change in an image, undetectable by human eyes, can cause a model to confidently
    mislabel it. This has implications for abuse of road traffic signs to fool self-driving
    cars or changes in passport photographs to allow an image that matches the carrier
    for inspectors but also matches another person when fed into a machine.'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*模型安全性:* 模型是否可以被欺骗或智能攻击？对其工作方式的知识是否会被滥用？一个很好的例子是，图像中微小的变化，人类肉眼无法察觉，却可以使模型自信地错误地标记它。这会对滥用交通标志来欺骗自动驾驶汽车或更改护照照片以允许图像在检查员看来与持证人匹配，而在机器中输入时与另一个人匹配造成影响。'
- en: '*Privacy:* Does the model leak information? Could personal data be extracted
    from the model if prompts were given to it? For example, let’s imagine a language
    model is trained on medical cases to provide a helpful chatbot (this is a bad
    idea, but it’s also an example, so bear with me). In that case, what happens if
    I feed a prompt such as medical record for Simon G. Thompson, d.o.b. xxx,...?
    Would the model complete the prompt by regurgitating some private information?
    Although this would be boring in my case, it might be hurtful in other cases,
    possibly causing significant harm. It would also be a serious breach of data protection
    laws in many places.'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*隐私:* 模型是否会泄露信息？如果给它提供提示，是否可以从模型中提取个人信息？例如，让我们想象一个语言模型是在医疗案例上训练的，以提供有用的聊天机器人（这是一个坏主意，但也是一个例子，所以请耐心）。在这种情况下，如果我提供一个提示，比如西蒙·G·汤普森医生的病历，出生日期xxx...，会发生什么？模型是否会通过重复一些私人信息来完成提示？尽管这在我的情况下可能很无聊，但在其他情况下可能会造成伤害，甚至可能造成重大伤害。这也会在许多地方严重违反数据保护法。'
- en: '*Fairness:* Does the model contain biases derived from data that are harmful
    or debunked by common sense or wider domain knowledge? Famously, some language
    models assume that all doctors are male, whereas nurses are female. This is a
    stereotype that could do significant harm to job seekers, for example.'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*公平性:* 模型是否包含来自数据的有害或被常识或更广泛领域知识驳斥的偏见？著名的是，一些语言模型假设所有医生都是男性，而护士是女性。这种刻板印象可能会对求职者造成重大伤害。'
- en: '*Interpretability:* Can the model be inspected or explained to humans? Is the
    explanation true to the actual workings of the model? Can it be used to determine
    that the model’s operation is well-founded and not just due to arbitrary data
    regularities?'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*可解释性:* 模型是否可以被人类检查或解释？解释是否与模型的实际工作原理相符？是否可以用它来确定模型的操作是建立在坚实基础上的，而不是仅仅由于任意数据规律？'
- en: We explicitly mentioned some of these requirements in user stories and in development
    activities with stakeholders. Some of the requirements, such as security, privacy,
    and fairness are red lines; if your models don’t meet these requirements, then
    they can’t be used. Model interpretability is less cut-and-dried, and different
    models may be efficient and interpretable in different ways. It may be that the
    requirements that you assembled during the earlier phases of the project cannot
    be met all at once. Again, in some cases, that’s a hard stop on the project, but
    a less interpretable model may be available that meets nonfunctional performance
    requirements. Sometimes a tradeoff of interpretability for nonfunctional performance
    may be appropriate.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在用户故事和与利益相关者的开发活动中明确提到了一些这些要求。其中一些要求，如安全性、隐私性和公平性是底线；如果你的模型不符合这些要求，那么它们就不能被使用。模型的可解释性并不是那么明确，不同的模型可能以不同的方式高效且可解释。可能的情况是，你在项目早期阶段组装的要求不能一次性全部满足。再次强调，在某些情况下，这可能是项目的硬性停止点，但可能有一个不那么可解释的模型可以满足非功能性性能要求。有时，为了非功能性性能而牺牲可解释性可能是合适的。
- en: After all the talk of multi-criteria decision making in this chapter, and the
    agonizing about the appropriate use of ranking methods and weighted data sets
    and so on, this kind of discussion is maddeningly imprecise. Even fluffier are
    the reasons to choose between decent models based on purely aesthetic concerns.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章关于多标准决策制定的讨论以及关于适当使用排名方法和加权数据集等的纠结之后，这种讨论令人沮丧地不精确。基于纯粹美学考虑选择模型的原因甚至更加模糊。
- en: Some people might think that this is quite an irrational stance; surely the
    model that wins quantitatively should be preferred? But, since approximately 1200
    AD, western science has used the idea of Occam’s razor to prefer simpler models,
    all things being roughly equal. Beauty and elegance are mathematicians’ drivers
    when seeking good theories. In terms of ML models, this translates to a preference
    for low size and high compression with respect to the training set, or simply
    a lower number of parameters optimized for equivalent or near equivalent performance.
    When in doubt, simple and sweet wins out.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 有些人可能认为这种立场相当不合理；当然应该优先选择在数量上获胜的模型？但是，自大约1200年以来，西方科学一直使用奥卡姆剃刀的理念来偏好更简单的模型，在所有事物大致相等的情况下。在寻求好的理论时，美丽和优雅是数学家的驱动力。在机器学习模型方面，这转化为对低尺寸和高压缩率的偏好，相对于训练集而言，或者简单地说，是优化了等效或近似等效性能的参数数量更少。当有疑问时，简单和甜美总是胜出。
- en: 8.4 Post modelling checklist
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.4 模型后检查清单
- en: Sprint 2 is almost complete. The final task is to run through the checklist
    in Table 8.3 and make sure that everyone agrees that everything was completed
    properly. If that’s the case, then you can be confident that you team has created
    a solid set of models and there’s a well-documented set of candidates for application
    integration.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: Sprint 2 几乎完成。最后的任务是运行表8.3中的检查清单，确保每个人都同意一切已适当完成。如果是这样，那么你可以有信心，你的团队已经创建了一套坚实的模型，并且有一套良好的文档记录的候选集用于应用集成。
- en: Table 8.3 Sprint 2 checklist
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 表8.3 Sprint 2 检查清单
- en: '| Ticket # | Item | Notes |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| Ticket # | 项目 | 备注 |'
- en: '| --- | --- | --- |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| S2.1 | Feature engineering is implemented. | Features and design information
    are recorded. |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| S2.1 | 实现了特征工程。 | 记录了特征和设计信息。 |'
- en: '| S2.2 | Models to be used explicitly are designed. | Model design documented.
    |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| S2.2 | 明确要使用的模型已设计。 | 模型设计已记录。 |'
- en: '| S2.3 | Modelling process undertaken and models developed. | Model repository
    used; models identified and captured along with all details required for reproduction.
    |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| S2.3 | 执行了建模过程并开发了模型。 | 使用了模型存储库；识别并捕获了模型以及所有用于复制的详细信息。 |'
- en: '| S2.4 | Model performance in dev was properly assessed by the team, and the
    experimental results are recorded. | Results of experiments are available for
    inspection. |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| S2.4 | 团队对开发中的模型性能进行了适当的评估，并记录了实验结果。 | 实验结果可供检查。 |'
- en: '| S2.5 | Model issues discovered in dev are recorded. | Defects will often
    be noticed in development; check that these were documented and that the documentation
    is available. |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| S2.5 | 在开发中发现的模型问题已记录。 | 缺陷通常会在开发过程中被发现；请检查这些是否已记录，并且文档是可用的。 |'
- en: '| S2.6 | Test environment was commissioned. | The test environment is set up,
    and the required data sources for testing are available. |'
  id: totrans-179
  prefs: []
  type: TYPE_TB
  zh: '| S2.6 | 测试环境已投入使用。 | 测试环境已搭建，并提供了测试所需的数据源。 |'
- en: '| S2.7 | Appropriate tests are designed. | The tests that determine if the
    models are fit for purpose agreed on and documented. |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| S2.7 | 设计了适当的测试。 | 确定模型是否适合目的的测试已达成一致并记录在案。 |'
- en: '| S2.8 | Test data has been gathered. | Tests run in the test environment,
    and results collected and available for evaluation. |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| S2.8 | 已收集测试数据。 | 在测试环境中运行测试，收集结果并可供评估。 |'
- en: '| S2.9 | Model selection is documented. | Model selection methods are documented,
    and the decisions that were made when using them and the testing data are recorded.
    Qualitative factors in the decisions should be recorded and agreed on. |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| S2.9 | 模型选择已记录。 | 模型选择方法已记录，使用它们时所做的决策以及测试数据已记录。决策中的定性因素应记录并达成一致。 |'
- en: It’s worth emphasizing again that the testing process may need to be revisited
    if you discover new problems or constraints in the application integration process.
    It’s possible, or even probable, that the team will need to go back into the activities
    in sprint 1 to reinvestigate the data. Potentially, they will need to onboard
    new sources of data, or they need to correct and clean new sources of data errors.
    The processes and infrastructure used in sprint 1 and sprint 2 provide a good
    framework for the team to do this. You’ve made the investment that allows your
    team to be agile and adapt to problems as they emerge, don’t be afraid to exploit
    it!
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，如果在应用程序集成过程中发现新的问题或限制，可能需要重新审视测试过程。有可能，甚至很可能，团队需要回到冲刺1的活动中进行重新调查数据。可能，他们需要引入新的数据来源，或者他们需要纠正和清理新的数据来源的错误。冲刺1和冲刺2中使用的流程和基础设施为团队提供了良好的框架来完成这项工作。你已经做出了投资，使你的团队能够灵活应对问题，不要害怕利用它！
- en: The flip side, though, is that it’s not a good idea or acceptable practice to
    skip on documenting what’s happening. Iteration and adaptation are inevitable,
    but make sure that the team is transparent about it and that they are professional
    about rebuilding pipelines and processes, rerunning tests, and keeping the documentation
    up to date.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，跳过记录正在发生的事情并不是一个好的想法或可接受的做法。迭代和适应是不可避免的，但请确保团队对此保持透明，并且他们在重建管道和流程、重新运行测试以及保持文档更新方面是专业的。
- en: '8.5 The Bike Shop: sprint 2'
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 8.5 Bike Shop：冲刺2
- en: 'The modelling team was presented with two core challenges: build a customer
    churn prediction system and build a demand prediction system. The work done in
    sprint 1 shows that these models should have geographic and product type granularities.
    The models should be built to work in different locales and over the different
    product types and platforms. In addition, there was a challenge to validate the
    available data as being adequate for the modelling. The team knows they have to
    deepen these requirements with nonfunctional information to be able to choose
    an appropriate modelling technique. The team determines the following:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 模型团队面临两个核心挑战：构建客户流失预测系统和构建需求预测系统。冲刺1的工作表明，这些模型应该具有地理和产品类型粒度。模型应该构建成能够在不同的地区和不同的产品类型和平台上工作。此外，还有一个挑战是验证可用数据是否足够用于建模。团队知道他们必须通过非功能信息来深化这些要求，以便能够选择合适的建模技术。团队确定了以下：
- en: In the bike shop application, efficiency and throughput are unlikely to be an
    issue. There are a small number of users who will expect normal web app latency
    (2 seconds or so).
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在Bike Shop应用程序中，效率和吞吐量不太可能成为问题。只有少数用户会期望正常的Web应用程序延迟（大约2秒）。
- en: Cost of inference is not likely to be an issue. The Bike Shop application will
    be used by scores or hundreds of users, not the tens of thousands that would raise
    concerns. The users will be operating at the speed of business analysis, so two
    or three updates of models per minute can be expected.
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 推理成本不太可能成为问题。Bike Shop应用程序将由成百上千的用户使用，而不是可能引起担忧的数万人。用户将以业务分析的速度操作，因此每分钟可以期望有二到三次模型更新。
- en: Security will adhere to normal corporate standards. Because only users authorized
    to access the raw data (financial and business performance from the sales records)
    are able to access the models and model output, there is no concern about inferences
    that can be drawn.
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全性将遵循正常的公司标准。因为只有有权访问原始数据（来自销售记录的财务和业务绩效）的用户才能访问模型和模型输出，因此无需担心可以得出的推断。
- en: The models need to provide confidence intervals, and the system needs to parameterize
    the models so the users can use them counterfactually. This allows the users to
    try “what if” scenarios and allows the system to show the users a range of prebuilt
    scenarios to inform their decision-making.
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型需要提供置信区间，系统需要参数化模型，以便用户可以反事实地使用它们。这使用户能够尝试“如果”场景，并允许系统向用户展示一系列预构建的场景，以帮助他们做出决策。
- en: The system should provide performance monitoring. This allows The Bike Shop
    to track how well it is doing and lets the users provide feedback on they system’s
    performance. The users can indicate if they think that the model is making egregious
    predictions. If this becomes a problem, a team of professionals can be brought
    in to perform maintenance.
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 系统应提供性能监控。这允许自行车商店跟踪其表现如何，并让用户对系统的性能提供反馈。用户可以表明他们认为模型正在做出严重的预测。如果这成为一个问题，可以引入一个专业团队进行维护。
- en: Having reviewed the information gathered from the business SMEs that was created
    by the EDA exercise, the team now feels that they understand what’s expected from
    the modelling. This understanding can now be brought together to create the overall
    model’s designs.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在审查了由EDA练习创建的商业领域专家收集的信息后，团队现在认为他们已经理解了建模的期望。现在可以将这种理解结合起来，以创建整体模型的设计。
- en: The opportunity to combine open-source news and economic data with The Bike
    Shop data was identified in the presales process. In addition, the team identified
    and selected a language model in sprint 1 and secured it as a project asset. Given
    this, the team made the choice to create models that extracted the current sentiment
    of the news, the unusualness of it (as a proxy for risk), and the historical pattern
    of sales, given data on the economy in the relevant sales territory. It was decided
    to use the same model design for demand forecasting in each region. Combining
    the data from each region with the news feeds and economic data, to the team creates
    an individual instantiated model. The team decides that they will use standard
    techniques to project uncertainty ranges, essentially to multiply uncertainties
    at each step. Figure 8.4 shows this design.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在预售过程中，确定了将开源新闻和经济数据与自行车商店数据相结合的机会。此外，团队在冲刺1中识别并选择了一个语言模型，并将其作为项目资产锁定。鉴于这一点，团队决定创建模型，以提取新闻的当前情绪、其异常性（作为风险的代理），以及相关销售区域经济数据的销售历史模式。决定在每个地区使用相同的模型设计进行需求预测。将每个地区的数据与新闻源和经济数据相结合，团队创建了一个个体实例化的模型。团队决定他们将使用标准技术来预测不确定性范围，本质上是在每个步骤上乘以不确定性。图8.4展示了这种设计。
- en: '![](../Images/08-04.png)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/08-04.png)'
- en: Figure 8.4 Top-level model design for predicting demand at The Bike Shop
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.4预测自行车商店需求的顶级模型设计
- en: 'Because of the limitations of the News data set, it’s decided to create signals
    that would feed independently into the inferences required for the application.
    Effectively, the following three component models are required for each regional
    prediction system. Figure 8.5 illustrates the design for the training model:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 由于新闻数据集的限制，决定创建将独立输入到应用所需推理中的信号。实际上，每个区域预测系统都需要以下三个组件模型。图8.5说明了训练模型的设计：
- en: A News Sentiment indicator that extracts the current sentiment from the available
    news feeds.
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个新闻情绪指标，用于从可用的新闻源中提取当前的情绪。
- en: A News Anomaly detector that determines if a startling or very unusual event
    is being detected in the news feeds.
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个新闻异常检测器，用于确定新闻源中是否检测到令人震惊或非常不寻常的事件。
- en: A Sales Given Economy model that learns patterns of sales, given the state of
    the economy.
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个销售给定经济模型，该模型学习经济状态下的销售模式。
- en: '![](../Images/08-05.png)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/08-05.png)'
- en: Figure 8.5 Model training design for The Bike Shop’s demand prediction system
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.5自行车商店需求预测系统的模型训练设计
- en: The team undertakes the prototyping activity to develop the feature set to use
    in each model (figures 8.4 and 8.5). A representative region, the USA, is identified
    because it has rich data and is significant for The Bike Shop’s business. The
    team feels that if a good model cannot be created for this region, then it’s unlikely
    that work on other regions will be successful. Conversely, if they create a good
    model for the USA region, then if other regions cannot be modelled, the system
    would still have some utility. Table 8.4 shows the list of features developed
    after prototyping and iterative experimentation using a subset of the available
    training data with several model types. Sentiment intensity is determined by fine-training
    a BERT model using a news article sentiment intensity data set [1]. Anomaly detection
    is done by measuring reconstruction errors for each article versus an autoencoder,
    learned over the historical news articles for the region.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 团队进行原型设计活动，以开发每个模型中使用的特征集（图8.4和8.5）。由于美国拥有丰富的数据并且对The Bike Shop的业务具有重要意义，因此将其选为代表性区域。团队认为，如果无法为该区域创建良好的模型，那么在其他区域的工作可能不会成功。相反，如果他们为美国区域创建了一个良好的模型，那么即使其他区域无法建模，系统仍然具有一定的实用性。表8.4显示了在原型设计和迭代实验中使用可用训练数据子集以及几种模型类型后开发的特征列表。情感强度是通过使用新闻文章情感强度数据集[1]对BERT模型进行微调来确定的。异常检测是通过测量每篇文章相对于自动编码器（该自动编码器是在该区域的历史新闻文章上学习得到的）的重构误差来完成的。
- en: Table 8.4 Features generated from the sales data
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 表8.4 从销售数据生成的特征
- en: '| Feature | Description |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| Feature | 描述 |'
- en: '| --- | --- |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Aggregation | Aggregate to monthly; group by client and product level 2.
    |'
  id: totrans-206
  prefs: []
  type: TYPE_TB
  zh: '| Aggregation | 聚合到每月；按客户和产品二级分组。 |'
- en: '| Frequencies | Frequencies of sales. |'
  id: totrans-207
  prefs: []
  type: TYPE_TB
  zh: '| 频率 | 销售频率。 |'
- en: '| Month and year | Monthly and yearly feature. |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| 月和年 | 月度和年度特征。 |'
- en: '| Public data enrichment | “national_income”,”agriculture_value”, “unemployment”,
    “GDP”, for example. |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| 公共数据丰富化 | 例如，“national_income”（国家收入），“agriculture_value”（农业价值），“unemployment”（失业率），“GDP”（国内生产总值）。
    |'
- en: '| Standard deviation indicators | How many standard deviations per client,
    per month, and revenue, volume, and sales frequencies changes? |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| 标准差指标 | 每个客户、每月以及收入、体积和销售频率变化的标准差是多少？ |'
- en: '| Look_back | Data from last n number of trades as a feature. |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| Look_back | 将过去n笔交易的数据作为特征。 |'
- en: '| last_trade | Last trade per client. |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| last_trade | 每个客户的最后交易。 |'
- en: '| ema | Exponential moving average. |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| ema | 指数移动平均。 |'
- en: '| sma | Simple moving average. |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| sma | 简单移动平均。 |'
- en: '| Bollinger Band | Labeling case, which is more than two standard deviation
    points up or down. |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| Bollinger Band | 标记案例，向上或向下超过两个标准差点。 |'
- en: '| rci | Rate of change indicator. |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| rci | 变化率指标。 |'
- en: '| rsi | Relative strength indicator . |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| rsi | 相对强弱指标 . |'
- en: '| diff | Differences between current value and last n values. |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| diff | 当前值与最后n个值的差异。 |'
- en: Now that the team has determined the feature set and selected the model type
    and design, it’s possible for them to build a training pipeline to create a model
    for each region. To do this, they extract data for each region, product platform,
    and product type from the source_table, calculate the features, and pass the resulting
    training set to the ML algorithm (figure 8.6).
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 现在团队已经确定了特征集，并选择了模型类型和设计，他们可以构建一个训练流程来为每个区域创建模型。为此，他们从源表（source_table）中提取每个区域、产品平台和产品类型的数据，计算特征，并将生成的训练集传递给机器学习算法（图8.6）。
- en: '![](../Images/08-06.png)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/08-06.png)'
- en: Figure 8.6 Training data pipeline for The Bike Shop.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6 The Bike Shop的训练数据流程。
- en: Figure 8.6 shows the data-preparation pipeline. Note that steps a and d ensure
    that the relevant team members are notified of a change to the training data and
    that the new training data version is logged. In this pipeline, the last training
    set is archived before anything else happens. This supports reproducibility and
    provides the team with rollback if something goes wrong in the pipeline or a bug
    introduces noise into one of the features. Step b produces the group-by aggregations
    of the data from the sales of individual products in individual countries to all
    sales in a territory, sales of items in a particular product platform in a territory,
    and all sales globally in a particular product platform.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.6展示了数据准备流程。请注意，步骤a和d确保相关团队成员被通知训练数据的变更，并且新的训练数据版本被记录。在这个流程中，在发生任何其他事情之前，最后一批训练集会被存档。这支持了可重复性，并在流程中出现问题或错误引入特征噪声时，为团队提供了回滚的选项。步骤b生成从单个国家单个产品的销售到该地区所有销售的分组聚合，该地区特定产品平台的物品销售，以及特定产品平台在全球范围内的所有销售。
- en: In Step c, various processes are run in the data warehouse in Python code to
    create the features specified in Table 8.4 for the aggregates. In some cases,
    it’s easier to calculate these items for each row before the group-by step. This
    can also be awkward because the data warehouse may not support the addition of
    new columns into an old table. The team does extensive work to understand the
    best division of labor between the data warehouse and the scripting system. The
    training data is now ready for use by the team for creating models.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在步骤c中，使用Python代码在数据仓库中运行各种过程，以创建表8.4中指定的聚合特征。在某些情况下，在分组步骤之前计算这些项对于每一行来说更容易。这也可能有些尴尬，因为数据仓库可能不支持向旧表添加新列。团队进行了大量工作，以了解数据仓库和脚本系统之间最佳劳动分工。现在，训练数据已准备好供团队用于创建模型。
- en: '![](../Images/08-07.png)'
  id: totrans-224
  prefs: []
  type: TYPE_IMG
  zh: '![图片](../Images/08-07.png)'
- en: Figure 8.7 The Bike Shop model training pipeline
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.7 自行车店模型训练流程
- en: Figure 8.7 shows the pipeline for model training. As for the other pipelines,
    a critical feature is that the pipeline isn’t run silently; all of the steps are
    logged on execution. Step c specifies that the training set training and validation
    fits are executed, and in step d, this data is logged in the management system.
    The team creates a dashboard showing the training and validation performance of
    the model sets to understand the overall performance of their approach to the
    problem. They also create a list of deltas and improvements to the models, and
    they get to work dealing with these.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图8.7展示了模型训练的流程。与其他流程一样，一个关键特性是流程不是静默运行的；所有步骤都在执行时被记录。步骤c指定执行训练集的训练和验证拟合，而在步骤d中，这些数据被记录在管理系统。团队创建了一个仪表板，显示模型集的训练和验证性能，以了解他们解决问题的整体方法。他们还创建了一个模型delta和改进列表，并开始处理这些问题。
- en: Danish takes the lead as the expert data scientist in the team, but Sam is interested
    in modelling work, so he and Rob team up to cover some of the tickets that the
    team generates. They chase down the modelling hypothesis and work to get better
    results. Danish and Jenn work together to deal with a different set of tickets,
    and Kate works through issues that come up with the training pipelines and monitoring
    infrastructure. Having organized themselves, the team settles into a steady pattern.
    There’s a lot of frustration at first. The team was optimistic that more sophisticated
    approaches would rapidly outpace the results that Danish got with some quick and
    easy benchmarking at the end of sprint 1, but things aren’t as smooth as they
    hoped.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 丹麦人作为团队中的专家数据科学家带头，但Sam对建模工作感兴趣，所以他和Rob组队来处理团队生成的一些票据。他们追踪建模假设，努力获得更好的结果。Danish和Jenn合作处理另一组票据，而Kate则处理训练管道和监控基础设施中出现的问题。在组织好自己之后，团队逐渐形成了稳定的模式。一开始有很多挫折。团队乐观地认为，更复杂的方法会迅速超越Danish在冲刺1结束时通过快速简单的基准测试获得的结果，但事情并没有像他们希望的那样顺利。
- en: The economy data doesn’t seem to be contributing anything to the quality of
    the time series prediction, nor does the news sentiment or news anomaly flows.
    The team investigates the models in parts, finding definite signals in the economic
    data that should provide predicative information. Danish creates some visualizations
    that show how the economic impact model output is correlated to the changes in
    sales.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 经济数据似乎对时间序列预测的质量没有贡献，新闻情感或新闻异常流也是如此。团队部分调查了模型，发现经济数据中有确切的信号，应该提供预测信息。Danish创建了一些可视化，展示了经济影响模型输出与销售变化的相关性。
- en: The sentiment and anomaly models show similar behaviors. This puzzle is solved
    by Kate when she audits the model training and execution pipeline. She finds that
    the models that the team believed would create the training input for the enhanced
    model are not generating the features that are being used. Old stub code is still
    being invoked because someone failed to update the code.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 情感模型和异常模型表现出类似的行为。当Kate审计模型训练和执行管道时，她解决了这个谜题。她发现团队认为将为增强模型创建训练输入的模型并没有生成正在使用的特征。由于有人未能更新代码，旧的占位符代码仍然被调用。
- en: The culprit feels terrible, but the rest of the team also takes responsibility
    as the code passed their review; they’ve all been staring at it for three days
    and did not notice the bug. Everyone is immensely cheered when the code is fixed
    and a significant uptick in performance is seen as compared to the benchmark model.
    At this point, the team makes the decision that they should properly evaluate
    the model portfolio.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 犯罪者感到非常糟糕，但团队的其他成员也承担责任，因为代码通过了他们的审查；他们都盯着它看了三天，没有注意到错误。当代码被修复并且与基准模型相比性能显著提升时，每个人都感到无比兴奋。在这个时候，团队决定他们应该正确评估模型组合。
- en: The Bike Shop IT team maintains a test environment for evaluating new systems
    before being released into their production environment. The team requires few
    of these facilities for testing in this environment, so Rob takes the test environment
    design that was developed in sprint 1 and works with the IT team to ensure that
    it’s implemented. To ensure that the test is properly executed, Rob writes scripts
    to deploy the data pipeline to the testing environment. Each of the models that
    are selected for evaluation have metadata defining the structure and parameterization
    of the training pipeline that created them. This is used to configure the testing
    data pipelines. However, there are some important changes.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 自行车店IT团队维护一个测试环境，用于在将新系统发布到生产环境之前对其进行评估。该团队在这个环境中进行测试需要少量这些设施，因此Rob采用了在冲刺1中开发的测试环境设计，并与IT团队合作确保其得到实施。为了确保测试得到正确执行，Rob编写了脚本将数据管道部署到测试环境。每个被选用于评估的模型都有元数据定义了创建它们的训练管道的结构和参数化。这被用来配置测试数据管道。然而，有一些重要的变化。
- en: The team holds a meeting to discuss the performance of the models and, based
    on previous discussions, they conclude that the sales model doesn’t overpredict
    demand. Karima is clear that having too much inventory is the real killer for
    the business in the profit-and-loss margins. Overspending on the inventory means
    that there won’t be cash to support other activities, and this means that there’s
    a heavy cost associated with this. Underordering carries penalties as well. The
    business can’t sell what it doesn’t have, but if the cash is unspent and available
    for use, then it can take mitigating action. Danish and Rob work through the data
    determining what characterizes incidents of overordering. They work with Sam to
    build some queries that generate a test set that the benchmark classifiers created
    in the EDA by Danish.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 团队举行会议讨论模型的性能，根据之前的讨论，他们得出结论，销售模型并没有过度预测需求。Karima明确表示，过多的库存是利润和亏损边缘对企业真正的杀手。在库存上的过度支出意味着没有现金来支持其他活动，这意味着与此相关的成本很高。订购不足也会带来惩罚。企业无法销售它没有的东西，但如果现金未使用且可用，那么它可以采取缓解措施。Danish和Rob通过数据确定哪些特征定义了订购过多的案例。他们与Sam合作构建了一些查询，生成由Danish在EDA中创建的基准分类器创建的测试集。
- en: 'At the same time, Jenn builds a test set of clean data with what she calls
    representative distributions. You probe further to get to the bottom of what she
    means by this, and it turns out that she’s created a test with data from the three
    largest countries, Europe, Asia, and the rest of the world (RoW). Her justification
    for this choice is that these are the important markets. After some discussion,
    Jenn agrees that it would be sensible to have test sets that cover all territories,
    including the smallest countries. Overall, that means the models will be tested
    on:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，Jenn建立了一个测试集，其中包含她所说的代表性分布的干净数据。你进一步探究她所说的含义，结果发现她创建了一个包含来自三个最大国家（欧洲、亚洲和世界其他地区）的数据的测试。她选择这一选择的理由是这些是重要的市场。经过一番讨论，Jenn同意建立一个涵盖所有领土的测试集，包括最小的国家。总的来说，这意味着模型将在以下方面进行测试：
- en: '*Data set 1:* Sales periods performance of the benchmark model over predicted
    sales'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数据集1:* 基准模型在预测销售期间的销售额表现'
- en: '*Data set 2:* Performance in large countries'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数据集2:* 大国的性能'
- en: '*Data set 3:* Performance across all countries'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数据集3:* 所有国家的性能'
- en: '*Data set 4:* Performance in small countries'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*数据集4:* 小国的性能'
- en: Kate builds the remaining code required to provide an effective test harness
    in the test environment, and then Jenn and Kate run the tests over the model designs
    that the rest of the team have tagged as candidates for selection. The results
    are interesting. All the models considered to be serviceable by the team perform
    approximately as well on data set 3\. No one is surprised. The relative performance
    of the models is like their relative performance in dev, although a little reduced.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: Kate构建了在测试环境中提供有效测试工具所需的剩余代码，然后Jenn和Kate在团队标记为选择候选人的模型设计上运行测试。结果很有趣。团队认为可用的所有模型在数据集3上的表现都大致相同。没有人感到惊讶。模型之间的相对性能与它们在开发中的相对性能相似，尽管有所降低。
- en: 'There is a big difference in performance in data set 4, though. It turns out
    that the news components are much more predictive in large countries than small
    ones. After some thought and white box testing, the cause becomes clear: large
    countries are the focus of well-funded and well-resourced media. More investigation
    shows that there is a relationship between media freedom and the predictive capabilities
    of the news sources as well. These insights enable the team to select two separate
    models, based on appropriateness per country. They build a table of model-to-country
    mapping and demonstrate how effective it is by retesting it on Jenn’s data sets.'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 在数据集4中，性能差异很大。结果证明，新闻成分在大国比在小国更具预测性。经过一番思考和白盒测试，原因变得清晰：大国是资金充足和资源丰富的媒体的焦点。更多的调查表明，媒体自由与新闻来源的预测能力之间也存在关系。这些见解使团队能够根据每个国家的适当性选择两个不同的模型。他们建立了一个模型到国家的映射表，并通过在Jenn的数据集上重新测试来展示其有效性。
- en: At this point, Rob throws a spanner in the works and points out that they have
    leaked quite a lot of information into the testing process. But there is good
    news. Jenn can select three new small countries and three new large countries.
    She builds data set 5 and data set 6, based on this selection, and the new composite
    model is tested on these. Happily, for everyone, the results on the new, unseen
    data sets mirror the result on data set 2 and data set 4\. This time it’s somewhat
    better, however. Jenn explains that she selected three strong press and three
    weak press candidates to build data set 2 and data set 4\. The team proceeds to
    sprint 3.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个时候，Rob在事情上扔了一个飞轮，指出他们在测试过程中泄露了相当多的信息。但有好消息。Jenn可以选择三个新的小国和三个新的大国。基于这个选择，她建立了数据集5和数据集6，并在这两个数据集上测试了新的复合模型。令人高兴的是，对于每个人来说，新数据集上的结果与数据集2和数据集4上的结果相匹配。然而，这一次结果有所改善。Jenn解释说，她选择了三个强势媒体和三个弱势媒体来构建数据集2和数据集4。团队继续进行第三轮冲刺。
- en: Summary
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: Your test environment needs to accommodate the security and privacy requirements
    of the data that you are handling, allowing access to testing mechanisms for the
    right people in the team.
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的测试环境需要满足你处理的数据的安全性和隐私要求，允许团队中合适的人访问测试机制。
- en: You must deliberately decide what is important to measure about the performance
    of your models. Just as sometimes the fuel economy of a car is more important
    than its acceleration, it can be the case that different performance tests need
    to be evaluated for models in different contexts.
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您必须故意决定关于您模型性能的重要衡量标准。就像有时汽车的燃油经济性比其加速度更重要一样，对于不同情境下的模型，可能需要评估不同的性能测试。
- en: Model accuracy is a poor way to understand model performance. Consider models
    in terms of their precision and recall performance or their F1 score. Even better,
    consider a range of performance measures to get an overall view of what matters
    about the model’s performance on a particular test.
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型准确性是理解模型性能的一个较差的方法。从模型的精确度和召回率性能或其F1分数来考虑模型。更好的是，考虑一系列性能指标，以获得对模型在特定测试中性能的整体看法。
- en: Nonfunctionals need to be tested and considered as well, so you can rate the
    results of those against functional performance.
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非功能性也需要被测试和考虑，这样您就可以将这些结果与功能性性能进行比较。
- en: You can use cross-validation to measure model performance when data is hard
    to get. Models can be tested on live cases using A/B testing or multi-armed bandits.
    You must be aware of the costs and trade-offs of testing in terms of the constraints
    that you face on gathering data or exposing people to the behavior of experimental
    models.
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当数据难以获取时，您可以使用交叉验证来衡量模型性能。模型可以通过A/B测试或多臂老虎机在实时案例上进行测试。您必须意识到测试的成本和权衡，这涉及到您在收集数据或让人们接触到实验模型的行为时所面临的限制。
- en: Model selection is both quantitative (using the results of your tests) and qualitative
    (based on wider considerations and model aesthetics).
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型选择既包括定量（使用您的测试结果）也包括定性（基于更广泛的考虑和模型美学）。
- en: Quantitative selection may require you to compare and weigh tests that are done
    on different bases. Different approaches to doing this are rankings, MCDM (multi-criteria
    decision making), and Pareto fronts. Which approach you use depends on your project.
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定量选择可能需要您比较和权衡在不同基础上进行的测试。不同的方法包括排名、多标准决策制定（MCDM）和帕累托前沿。您使用哪种方法取决于您的项目。
- en: You can test the component parts of your models to reveal how they are failing.
    You can use causal theories of what the model is doing as part of your decision-making.
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您可以通过测试模型的各个部分来揭示它们是如何失败的。您可以将模型的行为的因果理论作为您决策的一部分。
- en: When selecting models and model components, you are often left with a judgement.
    What’s important is that the basis of your decision is transparent, and the decision
    process is recorded and documented. If the decision comes down to selecting *A*
    or *B*, and there is no clear way for you to establish which, document this and
    pick the one that seems best to you.
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在选择模型和模型组件时，您通常会做出判断。重要的是您的决策基础是透明的，决策过程被记录和文档化。如果决策归结为选择 *A* 或 *B*，并且没有明确的方法让您确定哪个，请记录这一点并选择您认为最好的一个。
